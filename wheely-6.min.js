!function(e){function t(){for(var e=0;e<k.length;e++)k[e][0](k[e][1]);k=[],g=!1}function i(e,i){k.push([e,i]),g||(g=!0,w(t,0))}function s(e,t){function i(e){l(t,e)}try{e(function(e){o(t,e)},i)}catch(e){i(e)}}function a(e){var t=(i=e.owner).state_,i=i.data_,s=e[t];if(e=e.then,"function"==typeof s){t=x;try{i=s(i)}catch(t){l(e,t)}}n(e,i)||(t===x&&o(e,i),t===v&&l(e,i))}function n(e,t){var i;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"==typeof t)){var s=t.then;if("function"==typeof s)return s.call(t,function(s){i||(i=!0,t!==s?o(e,s):r(e,s))},function(t){i||(i=!0,l(e,t))}),!0}}catch(t){return i||l(e,t),!0}return!1}function o(e,t){e!==t&&n(e,t)||r(e,t)}function r(e,t){e.state_===y&&(e.state_=b,e.data_=t,i(c,e))}function l(e,t){e.state_===y&&(e.state_=b,e.data_=t,i(p,e))}function h(e){var t=e.then_;for(e.then_=void 0,e=0;e<t.length;e++)a(t[e])}function c(e){e.state_=x,h(e)}function p(e){e.state_=v,h(e)}function d(e){if("function"!=typeof e)throw new TypeError("Promise constructor takes a function argument");if(!1==this instanceof d)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],s(e,this)}var u=e.Promise,m=u&&"resolve"in u&&"reject"in u&&"all"in u&&"race"in u&&function(){var e;return new u(function(t){e=t}),"function"==typeof e}();"undefined"!=typeof exports&&exports?(exports.Promise=m?u:d,exports.Polyfill=d):"function"==typeof define&&define.amd?define(function(){return m?u:d}):m||(e.Promise=d);var g,y="pending",b="sealed",x="fulfilled",v="rejected",f=function(){},w="undefined"!=typeof setImmediate?setImmediate:setTimeout,k=[];d.prototype={constructor:d,state_:y,then_:null,data_:void 0,then:function(e,t){var s={owner:this,then:new this.constructor(f),fulfilled:e,rejected:t};return this.state_===x||this.state_===v?i(a,s):this.then_.push(s),s.then},catch:function(e){return this.then(null,e)}},d.all=function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("You must pass an array to Promise.all().");return new this(function(t,i){for(var s,a=[],n=0,o=0;o<e.length;o++)(s=e[o])&&"function"==typeof s.then?s.then(function(e){return n++,function(i){a[e]=i,--n||t(a)}}(o),i):a[o]=s;n||t(a)})},d.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("You must pass an array to Promise.race().");return new this(function(t,i){for(var s,a=0;a<e.length;a++)(s=e[a])&&"function"==typeof s.then?s.then(t,i):t(s)})},d.resolve=function(e){return e&&"object"==typeof e&&e.constructor===this?e:new this(function(t){t(e)})},d.reject=function(e){return new this(function(t,i){i(e)})}}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this),function(e){if("object"==typeof exports)module.exports=e();else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.p2=e()}}(function(){return function e(t,i,s){function a(o,r){if(!i[o]){if(!t[o]){var l="function"==typeof require&&require;if(!r&&l)return l(o,!0);if(n)return n(o,!0);throw new Error("Cannot find module '"+o+"'")}var h=i[o]={exports:{}};t[o][0].call(h.exports,function(e){var i=t[o][1][e];return a(i||e)},h,h.exports,e,t,i,s)}return i[o].exports}for(var n="function"==typeof require&&require,o=0;o<s.length;o++)a(s[o]);return a}({1:[function(e,t,i){function s(){}var a=e("./Scalar");t.exports=s,s.lineInt=function(e,t,i){i=i||0;var s,n,o,r,l,h,c,p=[0,0];return s=e[1][1]-e[0][1],n=e[0][0]-e[1][0],o=s*e[0][0]+n*e[0][1],r=t[1][1]-t[0][1],l=t[0][0]-t[1][0],h=r*t[0][0]+l*t[0][1],c=s*l-r*n,a.eq(c,0,i)||(p[0]=(l*o-n*h)/c,p[1]=(s*h-r*o)/c),p},s.segmentsIntersect=function(e,t,i,s){var a=t[0]-e[0],n=t[1]-e[1],o=s[0]-i[0],r=s[1]-i[1];if(o*n-r*a==0)return!1;var l=(a*(i[1]-e[1])+n*(e[0]-i[0]))/(o*n-r*a),h=(o*(e[1]-i[1])+r*(i[0]-e[0]))/(r*a-o*n);return l>=0&&l<=1&&h>=0&&h<=1}},{"./Scalar":4}],2:[function(e,t,i){function s(){}t.exports=s,s.area=function(e,t,i){return(t[0]-e[0])*(i[1]-e[1])-(i[0]-e[0])*(t[1]-e[1])},s.left=function(e,t,i){return s.area(e,t,i)>0},s.leftOn=function(e,t,i){return s.area(e,t,i)>=0},s.right=function(e,t,i){return s.area(e,t,i)<0},s.rightOn=function(e,t,i){return s.area(e,t,i)<=0};var a=[],n=[];s.collinear=function(e,t,i,o){if(o){var r=a,l=n;r[0]=t[0]-e[0],r[1]=t[1]-e[1],l[0]=i[0]-t[0],l[1]=i[1]-t[1];var h=r[0]*l[0]+r[1]*l[1],c=Math.sqrt(r[0]*r[0]+r[1]*r[1]),p=Math.sqrt(l[0]*l[0]+l[1]*l[1]);return Math.acos(h/(c*p))<o}return 0==s.area(e,t,i)},s.sqdist=function(e,t){var i=t[0]-e[0],s=t[1]-e[1];return i*i+s*s}},{}],3:[function(e,t,i){function s(){this.vertices=[]}function a(e,t,i,s,a){a=a||0;var n=t[1]-e[1],o=e[0]-t[0],l=n*e[0]+o*e[1],h=s[1]-i[1],c=i[0]-s[0],p=h*i[0]+c*i[1],d=n*c-h*o;return r.eq(d,0,a)?[0,0]:[(c*l-o*p)/d,(n*p-h*l)/d]}var n=e("./Line"),o=e("./Point"),r=e("./Scalar");t.exports=s,s.prototype.at=function(e){var t=this.vertices,i=t.length;return t[e<0?e%i+i:e%i]},s.prototype.first=function(){return this.vertices[0]},s.prototype.last=function(){return this.vertices[this.vertices.length-1]},s.prototype.clear=function(){this.vertices.length=0},s.prototype.append=function(e,t,i){if(void 0===t)throw new Error("From is not given!");if(void 0===i)throw new Error("To is not given!");if(i-1<t)throw new Error("lol1");if(i>e.vertices.length)throw new Error("lol2");if(t<0)throw new Error("lol3");for(var s=t;s<i;s++)this.vertices.push(e.vertices[s])},s.prototype.makeCCW=function(){for(var e=0,t=this.vertices,i=1;i<this.vertices.length;++i)(t[i][1]<t[e][1]||t[i][1]==t[e][1]&&t[i][0]>t[e][0])&&(e=i);o.left(this.at(e-1),this.at(e),this.at(e+1))||this.reverse()},s.prototype.reverse=function(){for(var e=[],t=0,i=this.vertices.length;t!==i;t++)e.push(this.vertices.pop());this.vertices=e},s.prototype.isReflex=function(e){return o.right(this.at(e-1),this.at(e),this.at(e+1))};var l=[],h=[];s.prototype.canSee=function(e,t){var i,s,a=l,r=h;if(o.leftOn(this.at(e+1),this.at(e),this.at(t))&&o.rightOn(this.at(e-1),this.at(e),this.at(t)))return!1;s=o.sqdist(this.at(e),this.at(t));for(var c=0;c!==this.vertices.length;++c)if((c+1)%this.vertices.length!==e&&c!==e&&o.leftOn(this.at(e),this.at(t),this.at(c+1))&&o.rightOn(this.at(e),this.at(t),this.at(c))&&(a[0]=this.at(e),a[1]=this.at(t),r[0]=this.at(c),r[1]=this.at(c+1),i=n.lineInt(a,r),o.sqdist(this.at(e),i)<s))return!1;return!0},s.prototype.copy=function(e,t,i){var a=i||new s;if(a.clear(),e<t)for(n=e;n<=t;n++)a.vertices.push(this.vertices[n]);else{for(n=0;n<=t;n++)a.vertices.push(this.vertices[n]);for(var n=e;n<this.vertices.length;n++)a.vertices.push(this.vertices[n])}return a},s.prototype.getCutEdges=function(){for(var e=[],t=[],i=[],a=new s,n=Number.MAX_VALUE,o=0;o<this.vertices.length;++o)if(this.isReflex(o))for(var r=0;r<this.vertices.length;++r)if(this.canSee(o,r)){t=this.copy(o,r,a).getCutEdges(),i=this.copy(r,o,a).getCutEdges();for(var l=0;l<i.length;l++)t.push(i[l]);t.length<n&&(e=t,n=t.length,e.push([this.at(o),this.at(r)]))}return e},s.prototype.decomp=function(){var e=this.getCutEdges();return e.length>0?this.slice(e):[this]},s.prototype.slice=function(e){if(0==e.length)return[this];if(e instanceof Array&&e.length&&e[0]instanceof Array&&2==e[0].length&&e[0][0]instanceof Array){for(var t=[this],i=0;i<e.length;i++)for(var s=e[i],a=0;a<t.length;a++){var n=t[a].slice(s);if(n){t.splice(a,1),t.push(n[0],n[1]);break}}return t}var s=e,i=this.vertices.indexOf(s[0]),a=this.vertices.indexOf(s[1]);return-1!=i&&-1!=a&&[this.copy(i,a),this.copy(a,i)]},s.prototype.isSimple=function(){for(var e=this.vertices,t=0;t<e.length-1;t++)for(var i=0;i<t-1;i++)if(n.segmentsIntersect(e[t],e[t+1],e[i],e[i+1]))return!1;for(t=1;t<e.length-2;t++)if(n.segmentsIntersect(e[0],e[e.length-1],e[t],e[t+1]))return!1;return!0},s.prototype.quickDecomp=function(e,t,i,n,r,l){r=r||100,l=l||0,n=n||25,e=void 0!==e?e:[],t=t||[],i=i||[];var h=[0,0],c=[0,0],p=[0,0],d=0,u=0,m=0,g=0,y=0,b=0,x=0,v=new s,f=new s,w=this,k=this.vertices;if(k.length<3)return e;if(++l>r)return e;for(var _=0;_<this.vertices.length;++_)if(w.isReflex(_)){t.push(w.vertices[_]),d=u=Number.MAX_VALUE;for(S=0;S<this.vertices.length;++S)o.left(w.at(_-1),w.at(_),w.at(S))&&o.rightOn(w.at(_-1),w.at(_),w.at(S-1))&&(p=a(w.at(_-1),w.at(_),w.at(S),w.at(S-1)),o.right(w.at(_+1),w.at(_),p)&&(m=o.sqdist(w.vertices[_],p))<u&&(u=m,c=p,b=S)),o.left(w.at(_+1),w.at(_),w.at(S+1))&&o.rightOn(w.at(_+1),w.at(_),w.at(S))&&(p=a(w.at(_+1),w.at(_),w.at(S),w.at(S+1)),o.left(w.at(_-1),w.at(_),p)&&(m=o.sqdist(w.vertices[_],p))<d&&(d=m,h=p,y=S));if(b==(y+1)%this.vertices.length)p[0]=(c[0]+h[0])/2,p[1]=(c[1]+h[1])/2,i.push(p),_<y?(v.append(w,_,y+1),v.vertices.push(p),f.vertices.push(p),0!=b&&f.append(w,b,w.vertices.length),f.append(w,0,_+1)):(0!=_&&v.append(w,_,w.vertices.length),v.append(w,0,y+1),v.vertices.push(p),f.vertices.push(p),f.append(w,b,_+1));else{if(b>y&&(y+=this.vertices.length),g=Number.MAX_VALUE,y<b)return e;for(var S=b;S<=y;++S)o.leftOn(w.at(_-1),w.at(_),w.at(S))&&o.rightOn(w.at(_+1),w.at(_),w.at(S))&&(m=o.sqdist(w.at(_),w.at(S)))<g&&(g=m,x=S%this.vertices.length);_<x?(v.append(w,_,x+1),0!=x&&f.append(w,x,k.length),f.append(w,0,_+1)):(0!=_&&v.append(w,_,k.length),v.append(w,0,x+1),f.append(w,x,_+1))}return v.vertices.length<f.vertices.length?(v.quickDecomp(e,t,i,n,r,l),f.quickDecomp(e,t,i,n,r,l)):(f.quickDecomp(e,t,i,n,r,l),v.quickDecomp(e,t,i,n,r,l)),e}return e.push(this),e},s.prototype.removeCollinearPoints=function(e){for(var t=0,i=this.vertices.length-1;this.vertices.length>3&&i>=0;--i)o.collinear(this.at(i-1),this.at(i),this.at(i+1),e)&&(this.vertices.splice(i%this.vertices.length,1),i--,t++);return t}},{"./Line":1,"./Point":2,"./Scalar":4}],4:[function(e,t,i){function s(){}t.exports=s,s.eq=function(e,t,i){return i=i||0,Math.abs(e-t)<i}},{}],5:[function(e,t,i){t.exports={Polygon:e("./Polygon"),Point:e("./Point")}},{"./Point":2,"./Polygon":3}],6:[function(e,t,i){t.exports={name:"p2",version:"0.7.0",description:"A JavaScript 2D physics engine.",author:"Stefan Hedman <schteppe@gmail.com> (http://steffe.se)",keywords:["p2.js","p2","physics","engine","2d"],main:"./src/p2.js",engines:{node:"*"},repository:{type:"git",url:"https://github.com/schteppe/p2.js.git"},bugs:{url:"https://github.com/schteppe/p2.js/issues"},licenses:[{type:"MIT"}],devDependencies:{grunt:"^0.4.5","grunt-contrib-jshint":"^0.11.2","grunt-contrib-nodeunit":"^0.4.1","grunt-contrib-uglify":"~0.4.0","grunt-contrib-watch":"~0.5.0","grunt-browserify":"~2.0.1","grunt-contrib-concat":"^0.4.0"},dependencies:{"poly-decomp":"0.1.0"}}},{}],7:[function(e,t,i){function s(e){this.lowerBound=a.create(),e&&e.lowerBound&&a.copy(this.lowerBound,e.lowerBound),this.upperBound=a.create(),e&&e.upperBound&&a.copy(this.upperBound,e.upperBound)}var a=e("../math/vec2");e("../utils/Utils"),t.exports=s;var n=a.create();s.prototype.setFromPoints=function(e,t,i,s){var o=this.lowerBound,r=this.upperBound;"number"!=typeof i&&(i=0),0!==i?a.rotate(o,e[0],i):a.copy(o,e[0]),a.copy(r,o);for(var l=Math.cos(i),h=Math.sin(i),c=1;c<e.length;c++){var p=e[c];if(0!==i){var d=p[0],u=p[1];n[0]=l*d-h*u,n[1]=h*d+l*u,p=n}for(var m=0;m<2;m++)p[m]>r[m]&&(r[m]=p[m]),p[m]<o[m]&&(o[m]=p[m])}t&&(a.add(this.lowerBound,this.lowerBound,t),a.add(this.upperBound,this.upperBound,t)),s&&(this.lowerBound[0]-=s,this.lowerBound[1]-=s,this.upperBound[0]+=s,this.upperBound[1]+=s)},s.prototype.copy=function(e){a.copy(this.lowerBound,e.lowerBound),a.copy(this.upperBound,e.upperBound)},s.prototype.extend=function(e){for(var t=2;t--;){var i=e.lowerBound[t];this.lowerBound[t]>i&&(this.lowerBound[t]=i);var s=e.upperBound[t];this.upperBound[t]<s&&(this.upperBound[t]=s)}},s.prototype.overlaps=function(e){var t=this.lowerBound,i=this.upperBound,s=e.lowerBound,a=e.upperBound;return(s[0]<=i[0]&&i[0]<=a[0]||t[0]<=a[0]&&a[0]<=i[0])&&(s[1]<=i[1]&&i[1]<=a[1]||t[1]<=a[1]&&a[1]<=i[1])},s.prototype.containsPoint=function(e){var t=this.lowerBound,i=this.upperBound;return t[0]<=e[0]&&e[0]<=i[0]&&t[1]<=e[1]&&e[1]<=i[1]},s.prototype.overlapsRay=function(e){var t=1/e.direction[0],i=1/e.direction[1],s=(this.lowerBound[0]-e.from[0])*t,a=(this.upperBound[0]-e.from[0])*t,n=(this.lowerBound[1]-e.from[1])*i,o=(this.upperBound[1]-e.from[1])*i,r=Math.max(Math.max(Math.min(s,a),Math.min(n,o))),l=Math.min(Math.min(Math.max(s,a),Math.max(n,o)));return l<0?-1:r>l?-1:r}},{"../math/vec2":30,"../utils/Utils":57}],8:[function(e,t,i){function s(e){this.type=e,this.result=[],this.world=null,this.boundingVolumeType=s.AABB}var a=e("../math/vec2"),n=e("../objects/Body");t.exports=s,s.AABB=1,s.BOUNDING_CIRCLE=2,s.prototype.setWorld=function(e){this.world=e},s.prototype.getCollisionPairs=function(e){};var o=a.create();s.boundingRadiusCheck=function(e,t){a.sub(o,e.position,t.position);var i=a.squaredLength(o),s=e.boundingRadius+t.boundingRadius;return i<=s*s},s.aabbCheck=function(e,t){return e.getAABB().overlaps(t.getAABB())},s.prototype.boundingVolumeCheck=function(e,t){var i;switch(this.boundingVolumeType){case s.BOUNDING_CIRCLE:i=s.boundingRadiusCheck(e,t);break;case s.AABB:i=s.aabbCheck(e,t);break;default:throw new Error("Bounding volume type not recognized: "+this.boundingVolumeType)}return i},s.canCollide=function(e,t){var i=n.KINEMATIC,s=n.STATIC;return!(e.type===s&&t.type===s||e.type===i&&t.type===s||e.type===s&&t.type===i||e.type===i&&t.type===i||e.sleepState===n.SLEEPING&&t.sleepState===n.SLEEPING||e.sleepState===n.SLEEPING&&t.type===s||t.sleepState===n.SLEEPING&&e.type===s)},s.NAIVE=1,s.SAP=2},{"../math/vec2":30,"../objects/Body":31}],9:[function(e,t,i){function s(){a.call(this,a.NAIVE)}var a=(e("../shapes/Circle"),e("../shapes/Plane"),e("../shapes/Shape"),e("../shapes/Particle"),e("../collision/Broadphase"));e("../math/vec2"),t.exports=s,(s.prototype=new a).constructor=s,s.prototype.getCollisionPairs=function(e){var t=e.bodies,i=this.result;i.length=0;for(var s=0,n=t.length;s!==n;s++)for(var o=t[s],r=0;r<s;r++){var l=t[r];a.canCollide(o,l)&&this.boundingVolumeCheck(o,l)&&i.push(o,l)}return i},s.prototype.aabbQuery=function(e,t,i){i=i||[];for(var s=e.bodies,a=0;a<s.length;a++){var n=s[a];n.aabbNeedsUpdate&&n.updateAABB(),n.aabb.overlaps(t)&&i.push(n)}return i}},{"../collision/Broadphase":8,"../math/vec2":30,"../shapes/Circle":39,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45}],10:[function(e,t,i){function s(){this.contactEquations=[],this.frictionEquations=[],this.enableFriction=!0,this.enabledEquations=!0,this.slipForce=10,this.frictionCoefficient=.3,this.surfaceVelocity=0,this.contactEquationPool=new c({size:32}),this.frictionEquationPool=new p({size:64}),this.restitution=0,this.stiffness=u.DEFAULT_STIFFNESS,this.relaxation=u.DEFAULT_RELAXATION,this.frictionStiffness=u.DEFAULT_STIFFNESS,this.frictionRelaxation=u.DEFAULT_RELAXATION,this.enableFrictionReduction=!0,this.collidingBodiesLastStep=new d,this.contactSkinSize=.01}function a(e,t){o.set(e.vertices[0],.5*-t.length,-t.radius),o.set(e.vertices[1],.5*t.length,-t.radius),o.set(e.vertices[2],.5*t.length,t.radius),o.set(e.vertices[3],.5*-t.length,t.radius)}function n(e,t,i,s){for(var a=J,n=q,h=j,c=H,p=e,d=t.vertices,u=null,m=0;m!==d.length+1;m++){var g=d[m%d.length],y=d[(m+1)%d.length];o.rotate(a,g,s),o.rotate(n,y,s),l(a,a,i),l(n,n,i),r(h,a,p),r(c,n,p);var b=o.crossLength(h,c);if(null===u&&(u=b),b*u<=0)return!1;u=b}return!0}var o=e("../math/vec2"),r=o.sub,l=o.add,h=o.dot,c=(e("../utils/Utils"),e("../utils/ContactEquationPool")),p=e("../utils/FrictionEquationPool"),d=e("../utils/TupleDictionary"),u=e("../equations/Equation"),m=(e("../equations/ContactEquation"),e("../equations/FrictionEquation"),e("../shapes/Circle")),g=e("../shapes/Convex"),y=e("../shapes/Shape"),b=(e("../objects/Body"),e("../shapes/Box"));t.exports=s;var x=o.fromValues(0,1),v=o.fromValues(0,0),f=o.fromValues(0,0),w=o.fromValues(0,0),k=o.fromValues(0,0),_=o.fromValues(0,0),S=o.fromValues(0,0),M=o.fromValues(0,0),A=o.fromValues(0,0),C=o.fromValues(0,0),P=o.fromValues(0,0),T=o.fromValues(0,0),X=o.fromValues(0,0),Y=o.fromValues(0,0),G=o.fromValues(0,0),B=o.fromValues(0,0),L=o.fromValues(0,0),E=o.fromValues(0,0),R=o.fromValues(0,0),D=[],F=o.create(),I=o.create();s.prototype.bodiesOverlap=function(e,t){for(var i=F,s=I,a=0,n=e.shapes.length;a!==n;a++){var o=e.shapes[a];e.toWorldFrame(i,o.position);for(var r=0,l=t.shapes.length;r!==l;r++){var h=t.shapes[r];if(t.toWorldFrame(s,h.position),this[o.type|h.type](e,o,i,o.angle+e.angle,t,h,s,h.angle+t.angle,!0))return!0}}return!1},s.prototype.collidedLastStep=function(e,t){var i=0|e.id,s=0|t.id;return!!this.collidingBodiesLastStep.get(i,s)},s.prototype.reset=function(){this.collidingBodiesLastStep.reset();for(var e=this.contactEquations,t=e.length;t--;){var i=e[t],s=i.bodyA.id,a=i.bodyB.id;this.collidingBodiesLastStep.set(s,a,!0)}for(var n=this.contactEquations,o=this.frictionEquations,r=0;r<n.length;r++)this.contactEquationPool.release(n[r]);for(r=0;r<o.length;r++)this.frictionEquationPool.release(o[r]);this.contactEquations.length=this.frictionEquations.length=0},s.prototype.createContactEquation=function(e,t,i,s){var a=this.contactEquationPool.get();return a.bodyA=e,a.bodyB=t,a.shapeA=i,a.shapeB=s,a.restitution=this.restitution,a.firstImpact=!this.collidedLastStep(e,t),a.stiffness=this.stiffness,a.relaxation=this.relaxation,a.needsUpdate=!0,a.enabled=this.enabledEquations,a.offset=this.contactSkinSize,a},s.prototype.createFrictionEquation=function(e,t,i,s){var a=this.frictionEquationPool.get();return a.bodyA=e,a.bodyB=t,a.shapeA=i,a.shapeB=s,a.setSlipForce(this.slipForce),a.frictionCoefficient=this.frictionCoefficient,a.relativeVelocity=this.surfaceVelocity,a.enabled=this.enabledEquations,a.needsUpdate=!0,a.stiffness=this.frictionStiffness,a.relaxation=this.frictionRelaxation,a.contactEquations.length=0,a},s.prototype.createFrictionFromContact=function(e){var t=this.createFrictionEquation(e.bodyA,e.bodyB,e.shapeA,e.shapeB);return o.copy(t.contactPointA,e.contactPointA),o.copy(t.contactPointB,e.contactPointB),o.rotate90cw(t.t,e.normalA),t.contactEquations.push(e),t},s.prototype.createFrictionFromAverage=function(e){var t=this.contactEquations[this.contactEquations.length-1],i=this.createFrictionEquation(t.bodyA,t.bodyB,t.shapeA,t.shapeB),s=t.bodyA;t.bodyB,o.set(i.contactPointA,0,0),o.set(i.contactPointB,0,0),o.set(i.t,0,0);for(var a=0;a!==e;a++)(t=this.contactEquations[this.contactEquations.length-1-a]).bodyA===s?(o.add(i.t,i.t,t.normalA),o.add(i.contactPointA,i.contactPointA,t.contactPointA),o.add(i.contactPointB,i.contactPointB,t.contactPointB)):(o.sub(i.t,i.t,t.normalA),o.add(i.contactPointA,i.contactPointA,t.contactPointB),o.add(i.contactPointB,i.contactPointB,t.contactPointA)),i.contactEquations.push(t);var n=1/e;return o.scale(i.contactPointA,i.contactPointA,n),o.scale(i.contactPointB,i.contactPointB,n),o.normalize(i.t,i.t),o.rotate90cw(i.t,i.t),i},s.prototype[y.LINE|y.CONVEX]=s.prototype.convexLine=function(e,t,i,s,a,n,o,r,l){return!l&&0},s.prototype[y.LINE|y.BOX]=s.prototype.lineBox=function(e,t,i,s,a,n,o,r,l){return!l&&0};var V=new b({width:1,height:1}),W=o.create();s.prototype[y.CAPSULE|y.CONVEX]=s.prototype[y.CAPSULE|y.BOX]=s.prototype.convexCapsule=function(e,t,i,s,n,r,l,h,c){var p=W;o.set(p,r.length/2,0),o.rotate(p,p,h),o.add(p,p,l);var d=this.circleConvex(n,r,p,h,e,t,i,s,c,r.radius);o.set(p,-r.length/2,0),o.rotate(p,p,h),o.add(p,p,l);var u=this.circleConvex(n,r,p,h,e,t,i,s,c,r.radius);if(c&&(d||u))return!0;var m=V;return a(m,r),this.convexConvex(e,t,i,s,n,m,l,h,c)+d+u},s.prototype[y.CAPSULE|y.LINE]=s.prototype.lineCapsule=function(e,t,i,s,a,n,o,r,l){return!l&&0};var O=o.create(),N=o.create(),U=new b({width:1,height:1});s.prototype[y.CAPSULE|y.CAPSULE]=s.prototype.capsuleCapsule=function(e,t,i,s,n,r,l,h,c){for(var p=O,d=N,u=0,m=0;m<2;m++){o.set(p,(0===m?-1:1)*t.length/2,0),o.rotate(p,p,s),o.add(p,p,i);for(var g=0;g<2;g++){o.set(d,(0===g?-1:1)*r.length/2,0),o.rotate(d,d,h),o.add(d,d,l),this.enableFrictionReduction&&(v=this.enableFriction,this.enableFriction=!1);var y=this.circleCircle(e,t,p,s,n,r,d,h,c,t.radius,r.radius);if(this.enableFrictionReduction&&(this.enableFriction=v),c&&y)return!0;u+=y}}this.enableFrictionReduction&&(v=this.enableFriction,this.enableFriction=!1);var b=U;a(b,t);var x=this.convexCapsule(e,b,i,s,n,r,l,h,c);if(this.enableFrictionReduction&&(this.enableFriction=v),c&&x)return!0;if(u+=x,this.enableFrictionReduction){var v=this.enableFriction;this.enableFriction=!1}a(b,r);var f=this.convexCapsule(n,b,l,h,e,t,i,s,c);return this.enableFrictionReduction&&(this.enableFriction=v),!(!c||!f)||(u+=f,this.enableFrictionReduction&&u&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(u)),u)},s.prototype[y.LINE|y.LINE]=s.prototype.lineLine=function(e,t,i,s,a,n,o,r,l){return!l&&0},s.prototype[y.PLANE|y.LINE]=s.prototype.planeLine=function(e,t,i,s,a,n,c,p,d){var u=v,m=f,g=w,y=k,b=_,P=S,T=M,X=A,Y=C,G=D,B=0;o.set(u,-n.length/2,0),o.set(m,n.length/2,0),o.rotate(g,u,p),o.rotate(y,m,p),l(g,g,c),l(y,y,c),o.copy(u,g),o.copy(m,y),r(b,m,u),o.normalize(P,b),o.rotate90cw(Y,P),o.rotate(X,x,s),G[0]=u,G[1]=m;for(var L=0;L<G.length;L++){var E=G[L];r(T,E,i);var R=h(T,X);if(R<0){if(d)return!0;var F=this.createContactEquation(e,a,t,n);B++,o.copy(F.normalA,X),o.normalize(F.normalA,F.normalA),o.scale(T,X,R),r(F.contactPointA,E,T),r(F.contactPointA,F.contactPointA,e.position),r(F.contactPointB,E,c),l(F.contactPointB,F.contactPointB,c),r(F.contactPointB,F.contactPointB,a.position),this.contactEquations.push(F),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(F))}}return!d&&(this.enableFrictionReduction||B&&this.enableFriction&&this.frictionEquations.push(this.createFrictionFromAverage(B)),B)},s.prototype[y.PARTICLE|y.CAPSULE]=s.prototype.particleCapsule=function(e,t,i,s,a,n,o,r,l){return this.circleLine(e,t,i,s,a,n,o,r,l,n.radius,0)},s.prototype[y.CIRCLE|y.LINE]=s.prototype.circleLine=function(e,t,i,s,a,n,c,p,d,u,m){var u=u||0,m=void 0!==m?m:t.radius,g=v,y=f,b=w,x=k,B=_,L=S,E=M,R=A,F=C,I=P,V=T,W=X,O=Y,N=G,U=D;o.set(R,-n.length/2,0),o.set(F,n.length/2,0),o.rotate(I,R,p),o.rotate(V,F,p),l(I,I,c),l(V,V,c),o.copy(R,I),o.copy(F,V),r(L,F,R),o.normalize(E,L),o.rotate90cw(B,E),r(W,i,R);var J=h(W,B);r(x,R,c),r(O,i,c);var q=m+u;if(Math.abs(J)<q){o.scale(g,B,J),r(b,i,g),o.scale(y,B,h(B,O)),o.normalize(y,y),o.scale(y,y,u),l(b,b,y);var j=h(E,b),H=h(E,R),z=h(E,F);if(j>H&&j<z){if(d)return!0;Z=this.createContactEquation(e,a,t,n);return o.scale(Z.normalA,g,-1),o.normalize(Z.normalA,Z.normalA),o.scale(Z.contactPointA,Z.normalA,m),l(Z.contactPointA,Z.contactPointA,i),r(Z.contactPointA,Z.contactPointA,e.position),r(Z.contactPointB,b,c),l(Z.contactPointB,Z.contactPointB,c),r(Z.contactPointB,Z.contactPointB,a.position),this.contactEquations.push(Z),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Z)),1}}U[0]=R,U[1]=F;for(var K=0;K<U.length;K++){var Q=U[K];if(r(W,Q,i),o.squaredLength(W)<Math.pow(q,2)){if(d)return!0;var Z=this.createContactEquation(e,a,t,n);return o.copy(Z.normalA,W),o.normalize(Z.normalA,Z.normalA),o.scale(Z.contactPointA,Z.normalA,m),l(Z.contactPointA,Z.contactPointA,i),r(Z.contactPointA,Z.contactPointA,e.position),r(Z.contactPointB,Q,c),o.scale(N,Z.normalA,-u),l(Z.contactPointB,Z.contactPointB,N),l(Z.contactPointB,Z.contactPointB,c),r(Z.contactPointB,Z.contactPointB,a.position),this.contactEquations.push(Z),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Z)),1}}return 0},s.prototype[y.CIRCLE|y.CAPSULE]=s.prototype.circleCapsule=function(e,t,i,s,a,n,o,r,l){return this.circleLine(e,t,i,s,a,n,o,r,l,n.radius)},s.prototype[y.CIRCLE|y.CONVEX]=s.prototype[y.CIRCLE|y.BOX]=s.prototype.circleConvex=function(e,t,i,s,a,h,c,p,d,u){for(var u="number"==typeof u?u:t.radius,m=v,g=f,y=w,b=k,x=_,S=P,M=T,A=Y,C=G,X=B,E=L,R=!1,D=Number.MAX_VALUE,F=h.vertices,I=0;I!==F.length+1;I++){var V=F[I%F.length],W=F[(I+1)%F.length];if(o.rotate(m,V,p),o.rotate(g,W,p),l(m,m,c),l(g,g,c),r(y,g,m),o.normalize(b,y),o.rotate90cw(x,b),o.scale(C,x,-t.radius),l(C,C,i),n(C,h,c,p)){o.sub(X,m,C);var O=Math.abs(o.dot(X,x));O<D&&(o.copy(E,C),D=O,o.scale(A,x,O),o.add(A,A,C),R=!0)}}if(R){if(d)return!0;U=this.createContactEquation(e,a,t,h);return o.sub(U.normalA,E,i),o.normalize(U.normalA,U.normalA),o.scale(U.contactPointA,U.normalA,u),l(U.contactPointA,U.contactPointA,i),r(U.contactPointA,U.contactPointA,e.position),r(U.contactPointB,A,c),l(U.contactPointB,U.contactPointB,c),r(U.contactPointB,U.contactPointB,a.position),this.contactEquations.push(U),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(U)),1}if(u>0)for(I=0;I<F.length;I++){var N=F[I];if(o.rotate(M,N,p),l(M,M,c),r(S,M,i),o.squaredLength(S)<Math.pow(u,2)){if(d)return!0;var U=this.createContactEquation(e,a,t,h);return o.copy(U.normalA,S),o.normalize(U.normalA,U.normalA),o.scale(U.contactPointA,U.normalA,u),l(U.contactPointA,U.contactPointA,i),r(U.contactPointA,U.contactPointA,e.position),r(U.contactPointB,M,c),l(U.contactPointB,U.contactPointB,c),r(U.contactPointB,U.contactPointB,a.position),this.contactEquations.push(U),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(U)),1}}return 0};var J=o.create(),q=o.create(),j=o.create(),H=o.create();s.prototype[y.PARTICLE|y.CONVEX]=s.prototype[y.PARTICLE|y.BOX]=s.prototype.particleConvex=function(e,t,i,s,a,c,p,d,u){var m=v,g=f,y=w,b=k,x=_,A=S,C=M,T=P,X=Y,G=E,B=R,L=Number.MAX_VALUE,D=!1,F=c.vertices;if(!n(i,c,p,d))return 0;if(u)return!0;for(var I=0;I!==F.length+1;I++){var V=F[I%F.length],W=F[(I+1)%F.length];o.rotate(m,V,d),o.rotate(g,W,d),l(m,m,p),l(g,g,p),r(y,g,m),o.normalize(b,y),o.rotate90cw(x,b),r(T,i,m),h(T,x),r(A,m,p),r(C,i,p),o.sub(G,m,i);var O=Math.abs(o.dot(G,x));O<L&&(L=O,o.scale(X,x,O),o.add(X,X,i),o.copy(B,x),D=!0)}if(D){var N=this.createContactEquation(e,a,t,c);return o.scale(N.normalA,B,-1),o.normalize(N.normalA,N.normalA),o.set(N.contactPointA,0,0),l(N.contactPointA,N.contactPointA,i),r(N.contactPointA,N.contactPointA,e.position),r(N.contactPointB,X,p),l(N.contactPointB,N.contactPointB,p),r(N.contactPointB,N.contactPointB,a.position),this.contactEquations.push(N),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(N)),1}return 0},s.prototype[y.CIRCLE]=s.prototype.circleCircle=function(e,t,i,s,a,n,h,c,p,d,u){var m=v,d=d||t.radius,u=u||n.radius;r(m,i,h);var g=d+u;if(o.squaredLength(m)>Math.pow(g,2))return 0;if(p)return!0;var y=this.createContactEquation(e,a,t,n);return r(y.normalA,h,i),o.normalize(y.normalA,y.normalA),o.scale(y.contactPointA,y.normalA,d),o.scale(y.contactPointB,y.normalA,-u),l(y.contactPointA,y.contactPointA,i),r(y.contactPointA,y.contactPointA,e.position),l(y.contactPointB,y.contactPointB,h),r(y.contactPointB,y.contactPointB,a.position),this.contactEquations.push(y),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(y)),1},s.prototype[y.PLANE|y.CONVEX]=s.prototype[y.PLANE|y.BOX]=s.prototype.planeConvex=function(e,t,i,s,a,n,c,p,d){var u=v,m=f,g=w,y=0;o.rotate(m,x,s);for(var b=0;b!==n.vertices.length;b++){var k=n.vertices[b];if(o.rotate(u,k,p),l(u,u,c),r(g,u,i),h(g,m)<=0){if(d)return!0;y++;var _=this.createContactEquation(e,a,t,n);r(g,u,i),o.copy(_.normalA,m);var S=h(g,_.normalA);o.scale(g,_.normalA,S),r(_.contactPointB,u,a.position),r(_.contactPointA,u,g),r(_.contactPointA,_.contactPointA,e.position),this.contactEquations.push(_),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(_))}}return this.enableFrictionReduction&&this.enableFriction&&y&&this.frictionEquations.push(this.createFrictionFromAverage(y)),y},s.prototype[y.PARTICLE|y.PLANE]=s.prototype.particlePlane=function(e,t,i,s,a,n,l,c,p){var d=v,u=f;c=c||0,r(d,i,l),o.rotate(u,x,c);var m=h(d,u);if(m>0)return 0;if(p)return!0;var g=this.createContactEquation(a,e,n,t);return o.copy(g.normalA,u),o.scale(d,g.normalA,m),r(g.contactPointA,i,d),r(g.contactPointA,g.contactPointA,a.position),r(g.contactPointB,i,e.position),this.contactEquations.push(g),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(g)),1},s.prototype[y.CIRCLE|y.PARTICLE]=s.prototype.circleParticle=function(e,t,i,s,a,n,h,c,p){var d=v;if(r(d,h,i),o.squaredLength(d)>Math.pow(t.radius,2))return 0;if(p)return!0;var u=this.createContactEquation(e,a,t,n);return o.copy(u.normalA,d),o.normalize(u.normalA,u.normalA),o.scale(u.contactPointA,u.normalA,t.radius),l(u.contactPointA,u.contactPointA,i),r(u.contactPointA,u.contactPointA,e.position),r(u.contactPointB,h,a.position),this.contactEquations.push(u),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(u)),1};var z=new m({radius:1}),K=o.create(),Q=o.create();o.create(),s.prototype[y.PLANE|y.CAPSULE]=s.prototype.planeCapsule=function(e,t,i,s,a,n,r,h,c){var p=K,d=Q,u=z;o.set(p,-n.length/2,0),o.rotate(p,p,h),l(p,p,r),o.set(d,n.length/2,0),o.rotate(d,d,h),l(d,d,r),u.radius=n.radius;var m;this.enableFrictionReduction&&(m=this.enableFriction,this.enableFriction=!1);var g=this.circlePlane(a,u,p,0,e,t,i,s,c),y=this.circlePlane(a,u,d,0,e,t,i,s,c);if(this.enableFrictionReduction&&(this.enableFriction=m),c)return g||y;var b=g+y;return this.enableFrictionReduction&&b&&this.frictionEquations.push(this.createFrictionFromAverage(b)),b},s.prototype[y.CIRCLE|y.PLANE]=s.prototype.circlePlane=function(e,t,i,s,a,n,c,p,d){var u=e,m=t,g=i,y=a,b=c,k=p;k=k||0;var _=v,S=f,M=w;r(_,g,b),o.rotate(S,x,k);var A=h(S,_);if(A>m.radius)return 0;if(d)return!0;var C=this.createContactEquation(y,u,n,t);return o.copy(C.normalA,S),o.scale(C.contactPointB,C.normalA,-m.radius),l(C.contactPointB,C.contactPointB,g),r(C.contactPointB,C.contactPointB,u.position),o.scale(M,C.normalA,A),r(C.contactPointA,_,M),l(C.contactPointA,C.contactPointA,b),r(C.contactPointA,C.contactPointA,y.position),this.contactEquations.push(C),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(C)),1},s.prototype[y.CONVEX]=s.prototype[y.CONVEX|y.BOX]=s.prototype[y.BOX]=s.prototype.convexConvex=function(e,t,i,a,n,c,p,d,u,m){var g=v,y=f,b=w,x=k,S=_,P=M,T=A,X=C,Y=0,m="number"==typeof m?m:0;if(!s.findSeparatingAxis(t,i,a,c,p,d,g))return 0;r(T,p,i),h(g,T)>0&&o.scale(g,g,-1);var G=s.getClosestEdge(t,a,g,!0),B=s.getClosestEdge(c,d,g);if(-1===G||-1===B)return 0;for(var L=0;L<2;L++){var E=G,R=B,D=t,F=c,I=i,V=p,W=a,O=d,N=e,U=n;if(0===L){var J;J=E,E=R,R=J,J=D,D=F,F=J,J=I,I=V,V=J,J=W,W=O,O=J,J=N,N=U,U=J}for(var q=R;q<R+2;q++){var j=F.vertices[(q+F.vertices.length)%F.vertices.length];o.rotate(y,j,O),l(y,y,V);for(var H=0,z=E-1;z<E+2;z++){var K=D.vertices[(z+D.vertices.length)%D.vertices.length],Q=D.vertices[(z+1+D.vertices.length)%D.vertices.length];o.rotate(b,K,W),o.rotate(x,Q,W),l(b,b,I),l(x,x,I),r(S,x,b),o.rotate90cw(X,S),o.normalize(X,X),r(T,y,b);$=h(X,T);(z===E&&$<=m||z!==E&&$<=0)&&H++}if(H>=3){if(u)return!0;var Z=this.createContactEquation(N,U,D,F);Y++;var K=D.vertices[E%D.vertices.length],Q=D.vertices[(E+1)%D.vertices.length];o.rotate(b,K,W),o.rotate(x,Q,W),l(b,b,I),l(x,x,I),r(S,x,b),o.rotate90cw(Z.normalA,S),o.normalize(Z.normalA,Z.normalA),r(T,y,b);var $=h(Z.normalA,T);o.scale(P,Z.normalA,$),r(Z.contactPointA,y,I),r(Z.contactPointA,Z.contactPointA,P),l(Z.contactPointA,Z.contactPointA,I),r(Z.contactPointA,Z.contactPointA,N.position),r(Z.contactPointB,y,V),l(Z.contactPointB,Z.contactPointB,V),r(Z.contactPointB,Z.contactPointB,U.position),this.contactEquations.push(Z),this.enableFrictionReduction||this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(Z))}}}return this.enableFrictionReduction&&this.enableFriction&&Y&&this.frictionEquations.push(this.createFrictionFromAverage(Y)),Y};var Z=o.fromValues(0,0);s.projectConvexOntoAxis=function(e,t,i,s,a){var n,r,l=null,c=null,p=Z;o.rotate(p,s,-i);for(var d=0;d<e.vertices.length;d++)n=e.vertices[d],r=h(n,p),(null===l||r>l)&&(l=r),(null===c||r<c)&&(c=r);if(c>l){var u=c;c=l,l=u}var m=h(t,s);o.set(a,c+m,l+m)};var $=o.fromValues(0,0),ee=o.fromValues(0,0),te=o.fromValues(0,0),ie=o.fromValues(0,0),se=o.fromValues(0,0),ae=o.fromValues(0,0);s.findSeparatingAxis=function(e,t,i,a,n,l,h){var c=null,p=!1,d=!1,u=$,m=ee,g=te,y=ie,x=se,v=ae;if(e instanceof b&&a instanceof b)for(S=0;2!==S;S++){var f=e,w=i;1===S&&(f=a,w=l);for(M=0;2!==M;M++){0===M?o.set(y,0,1):1===M&&o.set(y,1,0),0!==w&&o.rotate(y,y,w),s.projectConvexOntoAxis(e,t,i,y,x),s.projectConvexOntoAxis(a,n,l,y,v);var k=x,_=v;x[0]>v[0]&&(_=x,k=v,!0),p=(A=_[0]-k[1])<=0,(null===c||A>c)&&(o.copy(h,y),c=A,d=p)}}else for(var S=0;2!==S;S++){var f=e,w=i;1===S&&(f=a,w=l);for(var M=0;M!==f.vertices.length;M++){o.rotate(m,f.vertices[M],w),o.rotate(g,f.vertices[(M+1)%f.vertices.length],w),r(u,g,m),o.rotate90cw(y,u),o.normalize(y,y),s.projectConvexOntoAxis(e,t,i,y,x),s.projectConvexOntoAxis(a,n,l,y,v);var k=x,_=v;x[0]>v[0]&&(_=x,k=v,!0);var A=_[0]-k[1];p=A<=0,(null===c||A>c)&&(o.copy(h,y),c=A,d=p)}}return d};var ne=o.fromValues(0,0),oe=o.fromValues(0,0),re=o.fromValues(0,0);s.getClosestEdge=function(e,t,i,s){var a=ne,n=oe,l=re;o.rotate(a,i,-t),s&&o.scale(a,a,-1);for(var c=-1,p=e.vertices.length,d=-1,u=0;u!==p;u++){r(n,e.vertices[(u+1)%p],e.vertices[u%p]),o.rotate90cw(l,n),o.normalize(l,l);var m=h(l,a);(-1===c||m>d)&&(c=u%p,d=m)}return c};var le=o.create(),he=o.create(),ce=o.create(),pe=o.create(),de=o.create(),ue=o.create(),me=o.create();s.prototype[y.CIRCLE|y.HEIGHTFIELD]=s.prototype.circleHeightfield=function(e,t,i,s,a,n,h,c,p,d){var u=n.heights,d=d||t.radius,m=n.elementWidth,g=he,y=le,b=de,x=me,v=ue,f=ce,w=pe,k=Math.floor((i[0]-d-h[0])/m),_=Math.ceil((i[0]+d-h[0])/m);k<0&&(k=0),_>=u.length&&(_=u.length-1);for(var S=u[k],M=u[_],A=k;A<_;A++)u[A]<M&&(M=u[A]),u[A]>S&&(S=u[A]);if(i[1]-d>S)return!p&&0;for(var C=!1,A=k;A<_;A++){o.set(f,A*m,u[A]),o.set(w,(A+1)*m,u[A+1]),o.add(f,f,h),o.add(w,w,h),o.sub(v,w,f),o.rotate(v,v,Math.PI/2),o.normalize(v,v),o.scale(y,v,-d),o.add(y,y,i),o.sub(g,y,f);var P=o.dot(g,v);if(y[0]>=f[0]&&y[0]<w[0]&&P<=0){if(p)return!0;C=!0,o.scale(g,v,-P),o.add(b,y,g),o.copy(x,v);T=this.createContactEquation(a,e,n,t);o.copy(T.normalA,x),o.scale(T.contactPointB,T.normalA,-d),l(T.contactPointB,T.contactPointB,i),r(T.contactPointB,T.contactPointB,e.position),o.copy(T.contactPointA,b),o.sub(T.contactPointA,T.contactPointA,a.position),this.contactEquations.push(T),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(T))}}if(C=!1,d>0)for(A=k;A<=_;A++)if(o.set(f,A*m,u[A]),o.add(f,f,h),o.sub(g,i,f),o.squaredLength(g)<Math.pow(d,2)){if(p)return!0;C=!0;var T=this.createContactEquation(a,e,n,t);o.copy(T.normalA,g),o.normalize(T.normalA,T.normalA),o.scale(T.contactPointB,T.normalA,-d),l(T.contactPointB,T.contactPointB,i),r(T.contactPointB,T.contactPointB,e.position),r(T.contactPointA,f,h),l(T.contactPointA,T.contactPointA,h),r(T.contactPointA,T.contactPointA,a.position),this.contactEquations.push(T),this.enableFriction&&this.frictionEquations.push(this.createFrictionFromContact(T))}return C?1:0};var ge=o.create(),ye=o.create(),be=o.create(),xe=new g({vertices:[o.create(),o.create(),o.create(),o.create()]});s.prototype[y.BOX|y.HEIGHTFIELD]=s.prototype[y.CONVEX|y.HEIGHTFIELD]=s.prototype.convexHeightfield=function(e,t,i,s,a,n,r,l,h){var c=n.heights,p=n.elementWidth,d=ge,u=ye,m=be,g=xe,y=Math.floor((e.aabb.lowerBound[0]-r[0])/p),b=Math.ceil((e.aabb.upperBound[0]-r[0])/p);y<0&&(y=0),b>=c.length&&(b=c.length-1);for(var x=c[y],v=c[b],f=y;f<b;f++)c[f]<v&&(v=c[f]),c[f]>x&&(x=c[f]);if(e.aabb.lowerBound[1]>x)return!h&&0;for(var w=0,f=y;f<b;f++){o.set(d,f*p,c[f]),o.set(u,(f+1)*p,c[f+1]),o.add(d,d,r),o.add(u,u,r);o.set(m,.5*(u[0]+d[0]),.5*(u[1]+d[1]-100)),o.sub(g.vertices[0],u,m),o.sub(g.vertices[1],d,m),o.copy(g.vertices[2],g.vertices[1]),o.copy(g.vertices[3],g.vertices[0]),g.vertices[2][1]-=100,g.vertices[3][1]-=100,w+=this.convexConvex(e,t,i,s,a,g,m,0,h)}return w}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../shapes/Box":37,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Shape":45,"../utils/ContactEquationPool":48,"../utils/FrictionEquationPool":49,"../utils/TupleDictionary":56,"../utils/Utils":57}],11:[function(e,t,i){function s(e){e=e||{},this.from=e.from?n.fromValues(e.from[0],e.from[1]):n.create(),this.to=e.to?n.fromValues(e.to[0],e.to[1]):n.create(),this.checkCollisionResponse=void 0===e.checkCollisionResponse||e.checkCollisionResponse,this.skipBackfaces=!!e.skipBackfaces,this.collisionMask=void 0!==e.collisionMask?e.collisionMask:-1,this.collisionGroup=void 0!==e.collisionGroup?e.collisionGroup:-1,this.mode=void 0!==e.mode?e.mode:s.ANY,this.callback=e.callback||function(e){},this.direction=n.create(),this.length=1,this.update()}function a(e,t,i){n.sub(r,i,e);var s=n.dot(r,t);return n.scale(l,t,s),n.add(l,l,e),n.squaredDistance(i,l)}t.exports=s;var n=e("../math/vec2");e("../collision/RaycastResult"),e("../shapes/Shape"),e("../collision/AABB"),s.prototype.constructor=s,s.CLOSEST=1,s.ANY=2,s.ALL=4,s.prototype.update=function(){var e=this.direction;n.sub(e,this.to,this.from),this.length=n.length(e),n.normalize(e,e)},s.prototype.intersectBodies=function(e,t){for(var i=0,s=t.length;!e.shouldStop(this)&&i<s;i++){var a=t[i],n=a.getAABB();(n.overlapsRay(this)>=0||n.containsPoint(this.from))&&this.intersectBody(e,a)}};var o=n.create();s.prototype.intersectBody=function(e,t){var i=this.checkCollisionResponse;if(!i||t.collisionResponse)for(var s=o,a=0,r=t.shapes.length;a<r;a++){var l=t.shapes[a];if((!i||l.collisionResponse)&&0!=(this.collisionGroup&l.collisionMask)&&0!=(l.collisionGroup&this.collisionMask)){n.rotate(s,l.position,t.angle),n.add(s,s,t.position);var h=l.angle+t.angle;if(this.intersectShape(e,l,h,s,t),e.shouldStop(this))break}}},s.prototype.intersectShape=function(e,t,i,s,n){a(this.from,this.direction,s)>t.boundingRadius*t.boundingRadius||(this._currentBody=n,this._currentShape=t,t.raycast(e,this,s,i),this._currentBody=this._currentShape=null)},s.prototype.getAABB=function(e){var t=this.to,i=this.from;n.set(e.lowerBound,Math.min(t[0],i[0]),Math.min(t[1],i[1])),n.set(e.upperBound,Math.max(t[0],i[0]),Math.max(t[1],i[1]))},n.create(),s.prototype.reportIntersection=function(e,t,i,a){var o=(this.from,this.to,this._currentShape),r=this._currentBody;if(!(this.skipBackfaces&&n.dot(i,this.direction)>0))switch(this.mode){case s.ALL:e.set(i,o,r,t,a),this.callback(e);break;case s.CLOSEST:(t<e.fraction||!e.hasHit())&&e.set(i,o,r,t,a);break;case s.ANY:e.set(i,o,r,t,a)}};var r=n.create(),l=n.create()},{"../collision/AABB":7,"../collision/RaycastResult":12,"../math/vec2":30,"../shapes/Shape":45}],12:[function(e,t,i){function s(){this.normal=a.create(),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1}var a=e("../math/vec2"),n=e("../collision/Ray");t.exports=s,s.prototype.reset=function(){a.set(this.normal,0,0),this.shape=null,this.body=null,this.faceIndex=-1,this.fraction=-1,this.isStopped=!1},s.prototype.getHitDistance=function(e){return a.distance(e.from,e.to)*this.fraction},s.prototype.hasHit=function(){return-1!==this.fraction},s.prototype.getHitPoint=function(e,t){a.lerp(e,t.from,t.to,this.fraction)},s.prototype.stop=function(){this.isStopped=!0},s.prototype.shouldStop=function(e){return this.isStopped||-1!==this.fraction&&e.mode===n.ANY},s.prototype.set=function(e,t,i,s,n){a.copy(this.normal,e),this.shape=t,this.body=i,this.fraction=s,this.faceIndex=n}},{"../collision/Ray":11,"../math/vec2":30}],13:[function(e,t,i){function s(){n.call(this,n.SAP),this.axisList=[],this.axisIndex=0;var e=this;this._addBodyHandler=function(t){e.axisList.push(t.body)},this._removeBodyHandler=function(t){var i=e.axisList.indexOf(t.body);-1!==i&&e.axisList.splice(i,1)}}var a=e("../utils/Utils"),n=e("../collision/Broadphase");t.exports=s,(s.prototype=new n).constructor=s,s.prototype.setWorld=function(e){this.axisList.length=0,a.appendArray(this.axisList,e.bodies),e.off("addBody",this._addBodyHandler).off("removeBody",this._removeBodyHandler),e.on("addBody",this._addBodyHandler).on("removeBody",this._removeBodyHandler),this.world=e},s.sortAxisList=function(e,t){t|=0;for(var i=1,s=e.length;i<s;i++){for(var a=e[i],n=i-1;n>=0&&!(e[n].aabb.lowerBound[t]<=a.aabb.lowerBound[t]);n--)e[n+1]=e[n];e[n+1]=a}return e},s.prototype.sortList=function(){var e=this.axisList,t=this.axisIndex;s.sortAxisList(e,t)},s.prototype.getCollisionPairs=function(e){var t=this.axisList,i=this.result,s=this.axisIndex;i.length=0;for(var a=t.length;a--;){var o=t[a];o.aabbNeedsUpdate&&o.updateAABB()}this.sortList();for(var r=0,l=0|t.length;r!==l;r++)for(var h=t[r],c=r+1;c<l;c++){var p=t[c];if(!(p.aabb.lowerBound[s]<=h.aabb.upperBound[s]))break;n.canCollide(h,p)&&this.boundingVolumeCheck(h,p)&&i.push(h,p)}return i},s.prototype.aabbQuery=function(e,t,i){i=i||[],this.sortList();var s=this.axisIndex,a="x";1===s&&(a="y"),2===s&&(a="z");for(var n=this.axisList,o=(t.lowerBound[a],t.upperBound[a],0);o<n.length;o++){var r=n[o];r.aabbNeedsUpdate&&r.updateAABB(),r.aabb.overlaps(t)&&i.push(r)}return i}},{"../collision/Broadphase":8,"../utils/Utils":57}],14:[function(e,t,i){function s(e,t,i,s){this.type=i,s=a.defaults(s,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=e,this.bodyB=t,this.collideConnected=s.collideConnected,s.wakeUpBodies&&(e&&e.wakeUp(),t&&t.wakeUp())}t.exports=s;var a=e("../utils/Utils");s.prototype.update=function(){throw new Error("method update() not implmemented in this Constraint subclass!")},s.DISTANCE=1,s.GEAR=2,s.LOCK=3,s.PRISMATIC=4,s.REVOLUTE=5,s.prototype.setStiffness=function(e){for(var t=this.equations,i=0;i!==t.length;i++){var s=t[i];s.stiffness=e,s.needsUpdate=!0}},s.prototype.setRelaxation=function(e){for(var t=this.equations,i=0;i!==t.length;i++){var s=t[i];s.relaxation=e,s.needsUpdate=!0}}},{"../utils/Utils":57}],15:[function(e,t,i){function s(e,t,i){i=r.defaults(i,{localAnchorA:[0,0],localAnchorB:[0,0]}),a.call(this,e,t,a.DISTANCE,i),this.localAnchorA=o.fromValues(i.localAnchorA[0],i.localAnchorA[1]),this.localAnchorB=o.fromValues(i.localAnchorB[0],i.localAnchorB[1]);var s=this.localAnchorA,l=this.localAnchorB;if(this.distance=0,"number"==typeof i.distance)this.distance=i.distance;else{var h=o.create(),c=o.create(),p=o.create();o.rotate(h,s,e.angle),o.rotate(c,l,t.angle),o.add(p,t.position,c),o.sub(p,p,h),o.sub(p,p,e.position),this.distance=o.length(p)}var d;d=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce;var u=new n(e,t,-d,d);this.equations=[u],this.maxForce=d;var p=o.create(),m=o.create(),g=o.create(),y=this;u.computeGq=function(){var e=this.bodyA,t=this.bodyB,i=e.position,a=t.position;return o.rotate(m,s,e.angle),o.rotate(g,l,t.angle),o.add(p,a,g),o.sub(p,p,m),o.sub(p,p,i),o.length(p)-y.distance},this.setMaxForce(d),this.upperLimitEnabled=!1,this.upperLimit=1,this.lowerLimitEnabled=!1,this.lowerLimit=0,this.position=0}var a=e("./Constraint"),n=e("../equations/Equation"),o=e("../math/vec2"),r=e("../utils/Utils");t.exports=s,(s.prototype=new a).constructor=s;var l=o.create(),h=o.create(),c=o.create();s.prototype.update=function(){var e=this.equations[0],t=this.bodyA,i=this.bodyB,s=(this.distance,t.position),a=i.position,n=this.equations[0],r=e.G;o.rotate(h,this.localAnchorA,t.angle),o.rotate(c,this.localAnchorB,i.angle),o.add(l,a,c),o.sub(l,l,h),o.sub(l,l,s),this.position=o.length(l);var p=!1;if(this.upperLimitEnabled&&this.position>this.upperLimit&&(n.maxForce=0,n.minForce=-this.maxForce,this.distance=this.upperLimit,p=!0),this.lowerLimitEnabled&&this.position<this.lowerLimit&&(n.maxForce=this.maxForce,n.minForce=0,this.distance=this.lowerLimit,p=!0),!this.lowerLimitEnabled&&!this.upperLimitEnabled||p){n.enabled=!0,o.normalize(l,l);var d=o.crossLength(h,l),u=o.crossLength(c,l);r[0]=-l[0],r[1]=-l[1],r[2]=-d,r[3]=l[0],r[4]=l[1],r[5]=u}else n.enabled=!1},s.prototype.setMaxForce=function(e){var t=this.equations[0];t.minForce=-e,t.maxForce=e},s.prototype.getMaxForce=function(){return this.equations[0].maxForce}},{"../equations/Equation":22,"../math/vec2":30,"../utils/Utils":57,"./Constraint":14}],16:[function(e,t,i){function s(e,t,i){i=i||{},a.call(this,e,t,a.GEAR,i),this.ratio=void 0!==i.ratio?i.ratio:1,this.angle=void 0!==i.angle?i.angle:t.angle-this.ratio*e.angle,i.angle=this.angle,i.ratio=this.ratio,this.equations=[new n(e,t,i)],void 0!==i.maxTorque&&this.setMaxTorque(i.maxTorque)}var a=e("./Constraint"),n=(e("../equations/Equation"),e("../equations/AngleLockEquation"));e("../math/vec2"),t.exports=s,(s.prototype=new a).constructor=s,s.prototype.update=function(){var e=this.equations[0];e.ratio!==this.ratio&&e.setRatio(this.ratio),e.angle=this.angle},s.prototype.setMaxTorque=function(e){this.equations[0].setMaxTorque(e)},s.prototype.getMaxTorque=function(e){return this.equations[0].maxForce}},{"../equations/AngleLockEquation":20,"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],17:[function(e,t,i){function s(e,t,i){i=i||{},a.call(this,e,t,a.LOCK,i);var s=void 0===i.maxForce?Number.MAX_VALUE:i.maxForce,r=(i.localAngleB,new o(e,t,-s,s)),l=new o(e,t,-s,s),h=new o(e,t,-s,s),c=n.create(),p=n.create(),d=this;r.computeGq=function(){return n.rotate(c,d.localOffsetB,e.angle),n.sub(p,t.position,e.position),n.sub(p,p,c),p[0]},l.computeGq=function(){return n.rotate(c,d.localOffsetB,e.angle),n.sub(p,t.position,e.position),n.sub(p,p,c),p[1]};var u=n.create(),m=n.create();h.computeGq=function(){return n.rotate(u,d.localOffsetB,t.angle-d.localAngleB),n.scale(u,u,-1),n.sub(p,e.position,t.position),n.add(p,p,u),n.rotate(m,u,-Math.PI/2),n.normalize(m,m),n.dot(p,m)},this.localOffsetB=n.create(),i.localOffsetB?n.copy(this.localOffsetB,i.localOffsetB):(n.sub(this.localOffsetB,t.position,e.position),n.rotate(this.localOffsetB,this.localOffsetB,-e.angle)),this.localAngleB=0,"number"==typeof i.localAngleB?this.localAngleB=i.localAngleB:this.localAngleB=t.angle-e.angle,this.equations.push(r,l,h),this.setMaxForce(s)}var a=e("./Constraint"),n=e("../math/vec2"),o=e("../equations/Equation");t.exports=s,(s.prototype=new a).constructor=s,s.prototype.setMaxForce=function(e){for(var t=this.equations,i=0;i<this.equations.length;i++)t[i].maxForce=e,t[i].minForce=-e},s.prototype.getMaxForce=function(){return this.equations[0].maxForce};var r=n.create(),l=n.create(),h=n.create(),c=n.fromValues(1,0),p=n.fromValues(0,1);s.prototype.update=function(){var e=this.equations[0],t=this.equations[1],i=this.equations[2],s=this.bodyA,a=this.bodyB;n.rotate(r,this.localOffsetB,s.angle),n.rotate(l,this.localOffsetB,a.angle-this.localAngleB),n.scale(l,l,-1),n.rotate(h,l,Math.PI/2),n.normalize(h,h),e.G[0]=-1,e.G[1]=0,e.G[2]=-n.crossLength(r,c),e.G[3]=1,t.G[0]=0,t.G[1]=-1,t.G[2]=-n.crossLength(r,p),t.G[4]=1,i.G[0]=-h[0],i.G[1]=-h[1],i.G[3]=h[0],i.G[4]=h[1],i.G[5]=n.crossLength(l,h)}},{"../equations/Equation":22,"../math/vec2":30,"./Constraint":14}],18:[function(e,t,i){function s(e,t,i){i=i||{},a.call(this,e,t,a.PRISMATIC,i);var s=r.fromValues(0,0),h=r.fromValues(1,0),c=r.fromValues(0,0);i.localAnchorA&&r.copy(s,i.localAnchorA),i.localAxisA&&r.copy(h,i.localAxisA),i.localAnchorB&&r.copy(c,i.localAnchorB),this.localAnchorA=s,this.localAnchorB=c,this.localAxisA=h;var p=this.maxForce=void 0!==i.maxForce?i.maxForce:Number.MAX_VALUE,d=new o(e,t,-p,p),u=new r.create,m=new r.create,g=new r.create,y=new r.create;if(d.computeGq=function(){return r.dot(g,y)},d.updateJacobian=function(){var i=this.G,a=e.position,n=t.position;r.rotate(u,s,e.angle),r.rotate(m,c,t.angle),r.add(g,n,m),r.sub(g,g,a),r.sub(g,g,u),r.rotate(y,h,e.angle+Math.PI/2),i[0]=-y[0],i[1]=-y[1],i[2]=-r.crossLength(u,y)+r.crossLength(y,g),i[3]=y[0],i[4]=y[1],i[5]=r.crossLength(m,y)},this.equations.push(d),!i.disableRotationalLock){var b=new l(e,t,-p,p);this.equations.push(b)}this.position=0,this.velocity=0,this.lowerLimitEnabled=void 0!==i.lowerLimit,this.upperLimitEnabled=void 0!==i.upperLimit,this.lowerLimit=void 0!==i.lowerLimit?i.lowerLimit:0,this.upperLimit=void 0!==i.upperLimit?i.upperLimit:1,this.upperLimitEquation=new n(e,t),this.lowerLimitEquation=new n(e,t),this.upperLimitEquation.minForce=this.lowerLimitEquation.minForce=0,this.upperLimitEquation.maxForce=this.lowerLimitEquation.maxForce=p,this.motorEquation=new o(e,t),this.motorEnabled=!1,this.motorSpeed=0;var x=this,v=this.motorEquation;v.computeGW,v.computeGq=function(){return 0},v.computeGW=function(){var e=this.G,t=this.bodyA,i=this.bodyB,s=t.velocity,a=i.velocity,n=t.angularVelocity,o=i.angularVelocity;return this.gmult(e,s,n,a,o)+x.motorSpeed}}var a=e("./Constraint"),n=e("../equations/ContactEquation"),o=e("../equations/Equation"),r=e("../math/vec2"),l=e("../equations/RotationalLockEquation");t.exports=s,(s.prototype=new a).constructor=s;var h=r.create(),c=r.create(),p=r.create(),d=r.create(),u=r.create(),m=r.create();s.prototype.update=function(){var e=this.equations,t=e[0],i=this.upperLimit,s=this.lowerLimit,a=this.upperLimitEquation,n=this.lowerLimitEquation,o=this.bodyA,l=this.bodyB,g=this.localAxisA,y=this.localAnchorA,b=this.localAnchorB;t.updateJacobian(),r.rotate(h,g,o.angle),r.rotate(d,y,o.angle),r.add(c,d,o.position),r.rotate(u,b,l.angle),r.add(p,u,l.position);var x=this.position=r.dot(p,h)-r.dot(c,h);if(this.motorEnabled){var v=this.motorEquation.G;v[0]=h[0],v[1]=h[1],v[2]=r.crossLength(h,u),v[3]=-h[0],v[4]=-h[1],v[5]=-r.crossLength(h,d)}if(this.upperLimitEnabled&&x>i?(r.scale(a.normalA,h,-1),r.sub(a.contactPointA,c,o.position),r.sub(a.contactPointB,p,l.position),r.scale(m,h,i),r.add(a.contactPointA,a.contactPointA,m),-1===e.indexOf(a)&&e.push(a)):-1!==(f=e.indexOf(a))&&e.splice(f,1),this.lowerLimitEnabled&&x<s)r.scale(n.normalA,h,1),r.sub(n.contactPointA,c,o.position),r.sub(n.contactPointB,p,l.position),r.scale(m,h,s),r.sub(n.contactPointB,n.contactPointB,m),-1===e.indexOf(n)&&e.push(n);else{var f=e.indexOf(n);-1!==f&&e.splice(f,1)}},s.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},s.prototype.disableMotor=function(){if(this.motorEnabled){var e=this.equations.indexOf(this.motorEquation);this.equations.splice(e,1),this.motorEnabled=!1}},s.prototype.setLimits=function(e,t){"number"==typeof e?(this.lowerLimit=e,this.lowerLimitEnabled=!0):(this.lowerLimit=e,this.lowerLimitEnabled=!1),"number"==typeof t?(this.upperLimit=t,this.upperLimitEnabled=!0):(this.upperLimit=t,this.upperLimitEnabled=!1)}},{"../equations/ContactEquation":21,"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../math/vec2":30,"./Constraint":14}],19:[function(e,t,i){function s(e,t,i){i=i||{},a.call(this,e,t,a.REVOLUTE,i);var s=this.maxForce=void 0!==i.maxForce?i.maxForce:Number.MAX_VALUE;this.pivotA=l.create(),this.pivotB=l.create(),i.worldPivot?(l.sub(this.pivotA,i.worldPivot,e.position),l.sub(this.pivotB,i.worldPivot,t.position),l.rotate(this.pivotA,this.pivotA,-e.angle),l.rotate(this.pivotB,this.pivotB,-t.angle)):(l.copy(this.pivotA,i.localPivotA),l.copy(this.pivotB,i.localPivotB));var m=this.equations=[new n(e,t,-s,s),new n(e,t,-s,s)],g=m[0],y=m[1],b=this;g.computeGq=function(){return l.rotate(h,b.pivotA,e.angle),l.rotate(c,b.pivotB,t.angle),l.add(u,t.position,c),l.sub(u,u,e.position),l.sub(u,u,h),l.dot(u,p)},y.computeGq=function(){return l.rotate(h,b.pivotA,e.angle),l.rotate(c,b.pivotB,t.angle),l.add(u,t.position,c),l.sub(u,u,e.position),l.sub(u,u,h),l.dot(u,d)},y.minForce=g.minForce=-s,y.maxForce=g.maxForce=s,this.motorEquation=new o(e,t),this.motorEnabled=!1,this.angle=0,this.lowerLimitEnabled=!1,this.upperLimitEnabled=!1,this.lowerLimit=0,this.upperLimit=0,this.upperLimitEquation=new r(e,t),this.lowerLimitEquation=new r(e,t),this.upperLimitEquation.minForce=0,this.lowerLimitEquation.maxForce=0}var a=e("./Constraint"),n=e("../equations/Equation"),o=e("../equations/RotationalVelocityEquation"),r=e("../equations/RotationalLockEquation"),l=e("../math/vec2");t.exports=s;var h=l.create(),c=l.create(),p=l.fromValues(1,0),d=l.fromValues(0,1),u=l.create();(s.prototype=new a).constructor=s,s.prototype.setLimits=function(e,t){"number"==typeof e?(this.lowerLimit=e,this.lowerLimitEnabled=!0):(this.lowerLimit=e,this.lowerLimitEnabled=!1),"number"==typeof t?(this.upperLimit=t,this.upperLimitEnabled=!0):(this.upperLimit=t,this.upperLimitEnabled=!1)},s.prototype.update=function(){var e=this.bodyA,t=this.bodyB,i=this.pivotA,s=this.pivotB,a=this.equations,n=(a[0],a[1],a[0]),o=a[1],r=this.upperLimit,u=this.lowerLimit,m=this.upperLimitEquation,g=this.lowerLimitEquation,y=this.angle=t.angle-e.angle;if(this.upperLimitEnabled&&y>r?(m.angle=r,-1===a.indexOf(m)&&a.push(m)):-1!==(b=a.indexOf(m))&&a.splice(b,1),this.lowerLimitEnabled&&y<u)g.angle=u,-1===a.indexOf(g)&&a.push(g);else{var b=a.indexOf(g);-1!==b&&a.splice(b,1)}l.rotate(h,i,e.angle),l.rotate(c,s,t.angle),n.G[0]=-1,n.G[1]=0,n.G[2]=-l.crossLength(h,p),n.G[3]=1,n.G[4]=0,n.G[5]=l.crossLength(c,p),o.G[0]=0,o.G[1]=-1,o.G[2]=-l.crossLength(h,d),o.G[3]=0,o.G[4]=1,o.G[5]=l.crossLength(c,d)},s.prototype.enableMotor=function(){this.motorEnabled||(this.equations.push(this.motorEquation),this.motorEnabled=!0)},s.prototype.disableMotor=function(){if(this.motorEnabled){var e=this.equations.indexOf(this.motorEquation);this.equations.splice(e,1),this.motorEnabled=!1}},s.prototype.motorIsEnabled=function(){return!!this.motorEnabled},s.prototype.setMotorSpeed=function(e){if(this.motorEnabled){var t=this.equations.indexOf(this.motorEquation);this.equations[t].relativeVelocity=e}},s.prototype.getMotorSpeed=function(){return!!this.motorEnabled&&this.motorEquation.relativeVelocity}},{"../equations/Equation":22,"../equations/RotationalLockEquation":24,"../equations/RotationalVelocityEquation":25,"../math/vec2":30,"./Constraint":14}],20:[function(e,t,i){function s(e,t,i){i=i||{},a.call(this,e,t,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0,this.ratio="number"==typeof i.ratio?i.ratio:1,this.setRatio(this.ratio)}var a=e("./Equation");e("../math/vec2"),t.exports=s,(s.prototype=new a).constructor=s,s.prototype.computeGq=function(){return this.ratio*this.bodyA.angle-this.bodyB.angle+this.angle},s.prototype.setRatio=function(e){var t=this.G;t[2]=e,t[5]=-1,this.ratio=e},s.prototype.setMaxTorque=function(e){this.maxForce=e,this.minForce=-e}},{"../math/vec2":30,"./Equation":22}],21:[function(e,t,i){function s(e,t){a.call(this,e,t,0,Number.MAX_VALUE),this.contactPointA=n.create(),this.penetrationVec=n.create(),this.contactPointB=n.create(),this.normalA=n.create(),this.restitution=0,this.firstImpact=!1,this.shapeA=null,this.shapeB=null}var a=e("./Equation"),n=e("../math/vec2");t.exports=s,(s.prototype=new a).constructor=s,s.prototype.computeB=function(e,t,i){var s=this.bodyA,a=this.bodyB,o=this.contactPointA,r=this.contactPointB,l=s.position,h=a.position,c=this.penetrationVec,p=this.normalA,d=this.G,u=n.crossLength(o,p),m=n.crossLength(r,p);d[0]=-p[0],d[1]=-p[1],d[2]=-u,d[3]=p[0],d[4]=p[1],d[5]=m,n.add(c,h,r),n.sub(c,c,l),n.sub(c,c,o);var g,y;return this.firstImpact&&0!==this.restitution?(y=0,g=1/t*(1+this.restitution)*this.computeGW()):(y=n.dot(p,c)+this.offset,g=this.computeGW()),-y*e-g*t-i*this.computeGiMf()}},{"../math/vec2":30,"./Equation":22}],22:[function(e,t,i){function s(e,t,i,a){this.minForce=void 0===i?-Number.MAX_VALUE:i,this.maxForce=void 0===a?Number.MAX_VALUE:a,this.bodyA=e,this.bodyB=t,this.stiffness=s.DEFAULT_STIFFNESS,this.relaxation=s.DEFAULT_RELAXATION,this.G=new n.ARRAY_TYPE(6);for(var o=0;o<6;o++)this.G[o]=0;this.offset=0,this.a=0,this.b=0,this.epsilon=0,this.timeStep=1/60,this.needsUpdate=!0,this.multiplier=0,this.relativeVelocity=0,this.enabled=!0}t.exports=s;var a=e("../math/vec2"),n=e("../utils/Utils");e("../objects/Body"),s.prototype.constructor=s,s.DEFAULT_STIFFNESS=1e6,s.DEFAULT_RELAXATION=4,s.prototype.update=function(){var e=this.stiffness,t=this.relaxation,i=this.timeStep;this.a=4/(i*(1+4*t)),this.b=4*t/(1+4*t),this.epsilon=4/(i*i*e*(1+4*t)),this.needsUpdate=!1},s.prototype.gmult=function(e,t,i,s,a){return e[0]*t[0]+e[1]*t[1]+e[2]*i+e[3]*s[0]+e[4]*s[1]+e[5]*a},s.prototype.computeB=function(e,t,i){var s=this.computeGW();return-this.computeGq()*e-s*t-this.computeGiMf()*i};var o=a.create(),r=a.create();s.prototype.computeGq=function(){var e=this.G,t=this.bodyA,i=this.bodyB,s=(t.position,i.position,t.angle),a=i.angle;return this.gmult(e,o,s,r,a)+this.offset},s.prototype.computeGW=function(){var e=this.G,t=this.bodyA,i=this.bodyB,s=t.velocity,a=i.velocity,n=t.angularVelocity,o=i.angularVelocity;return this.gmult(e,s,n,a,o)+this.relativeVelocity},s.prototype.computeGWlambda=function(){var e=this.G,t=this.bodyA,i=this.bodyB,s=t.vlambda,a=i.vlambda,n=t.wlambda,o=i.wlambda;return this.gmult(e,s,n,a,o)};var l=a.create(),h=a.create();s.prototype.computeGiMf=function(){var e=this.bodyA,t=this.bodyB,i=e.force,s=e.angularForce,n=t.force,o=t.angularForce,r=e.invMassSolve,c=t.invMassSolve,p=e.invInertiaSolve,d=t.invInertiaSolve,u=this.G;return a.scale(l,i,r),a.multiply(l,e.massMultiplier,l),a.scale(h,n,c),a.multiply(h,t.massMultiplier,h),this.gmult(u,l,s*p,h,o*d)},s.prototype.computeGiMGt=function(){var e=this.bodyA,t=this.bodyB,i=e.invMassSolve,s=t.invMassSolve,a=e.invInertiaSolve,n=t.invInertiaSolve,o=this.G;return o[0]*o[0]*i*e.massMultiplier[0]+o[1]*o[1]*i*e.massMultiplier[1]+o[2]*o[2]*a+o[3]*o[3]*s*t.massMultiplier[0]+o[4]*o[4]*s*t.massMultiplier[1]+o[5]*o[5]*n};var c=a.create(),p=a.create(),d=a.create();a.create(),a.create(),a.create(),s.prototype.addToWlambda=function(e){var t=this.bodyA,i=this.bodyB,s=c,n=p,o=d,r=t.invMassSolve,l=i.invMassSolve,h=t.invInertiaSolve,u=i.invInertiaSolve,m=this.G;n[0]=m[0],n[1]=m[1],o[0]=m[3],o[1]=m[4],a.scale(s,n,r*e),a.multiply(s,s,t.massMultiplier),a.add(t.vlambda,t.vlambda,s),t.wlambda+=h*m[2]*e,a.scale(s,o,l*e),a.multiply(s,s,i.massMultiplier),a.add(i.vlambda,i.vlambda,s),i.wlambda+=u*m[5]*e},s.prototype.computeInvC=function(e){return 1/(this.computeGiMGt()+e)}},{"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],23:[function(e,t,i){function s(e,t,i){n.call(this,e,t,-i,i),this.contactPointA=a.create(),this.contactPointB=a.create(),this.t=a.create(),this.contactEquations=[],this.shapeA=null,this.shapeB=null,this.frictionCoefficient=.3}var a=e("../math/vec2"),n=e("./Equation");e("../utils/Utils"),t.exports=s,(s.prototype=new n).constructor=s,s.prototype.setSlipForce=function(e){this.maxForce=e,this.minForce=-e},s.prototype.getSlipForce=function(){return this.maxForce},s.prototype.computeB=function(e,t,i){var s=(this.bodyA,this.bodyB,this.contactPointA),n=this.contactPointB,o=this.t,r=this.G;return r[0]=-o[0],r[1]=-o[1],r[2]=-a.crossLength(s,o),r[3]=o[0],r[4]=o[1],r[5]=a.crossLength(n,o),-this.computeGW()*t-i*this.computeGiMf()}},{"../math/vec2":30,"../utils/Utils":57,"./Equation":22}],24:[function(e,t,i){function s(e,t,i){i=i||{},a.call(this,e,t,-Number.MAX_VALUE,Number.MAX_VALUE),this.angle=i.angle||0;var s=this.G;s[2]=1,s[5]=-1}var a=e("./Equation"),n=e("../math/vec2");t.exports=s,(s.prototype=new a).constructor=s;var o=n.create(),r=n.create(),l=n.fromValues(1,0),h=n.fromValues(0,1);s.prototype.computeGq=function(){return n.rotate(o,l,this.bodyA.angle+this.angle),n.rotate(r,h,this.bodyB.angle),n.dot(o,r)}},{"../math/vec2":30,"./Equation":22}],25:[function(e,t,i){function s(e,t){a.call(this,e,t,-Number.MAX_VALUE,Number.MAX_VALUE),this.relativeVelocity=1,this.ratio=1}var a=e("./Equation");e("../math/vec2"),t.exports=s,(s.prototype=new a).constructor=s,s.prototype.computeB=function(e,t,i){var s=this.G;s[2]=-1,s[5]=this.ratio;var a=this.computeGiMf();return-this.computeGW()*t-i*a}},{"../math/vec2":30,"./Equation":22}],26:[function(e,t,i){var s=function(){};t.exports=s,s.prototype={constructor:s,on:function(e,t,i){t.context=i||this,void 0===this._listeners&&(this._listeners={});var s=this._listeners;return void 0===s[e]&&(s[e]=[]),-1===s[e].indexOf(t)&&s[e].push(t),this},has:function(e,t){if(void 0===this._listeners)return!1;var i=this._listeners;if(t){if(void 0!==i[e]&&-1!==i[e].indexOf(t))return!0}else if(void 0!==i[e])return!0;return!1},off:function(e,t){if(void 0===this._listeners)return this;var i=this._listeners,s=i[e].indexOf(t);return-1!==s&&i[e].splice(s,1),this},emit:function(e){if(void 0===this._listeners)return this;var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var i=0,s=t.length;i<s;i++){var a=t[i];a.call(a.context,e)}}return this}}},{}],27:[function(e,t,i){function s(e,t,i){if(i=i||{},!(e instanceof a&&t instanceof a))throw new Error("First two arguments must be Material instances.");this.id=s.idCounter++,this.materialA=e,this.materialB=t,this.friction=void 0!==i.friction?Number(i.friction):.3,this.restitution=void 0!==i.restitution?Number(i.restitution):0,this.stiffness=void 0!==i.stiffness?Number(i.stiffness):n.DEFAULT_STIFFNESS,this.relaxation=void 0!==i.relaxation?Number(i.relaxation):n.DEFAULT_RELAXATION,this.frictionStiffness=void 0!==i.frictionStiffness?Number(i.frictionStiffness):n.DEFAULT_STIFFNESS,this.frictionRelaxation=void 0!==i.frictionRelaxation?Number(i.frictionRelaxation):n.DEFAULT_RELAXATION,this.surfaceVelocity=void 0!==i.surfaceVelocity?Number(i.surfaceVelocity):0,this.contactSkinSize=.005}var a=e("./Material"),n=e("../equations/Equation");t.exports=s,s.idCounter=0},{"../equations/Equation":22,"./Material":28}],28:[function(e,t,i){function s(e){this.id=e||s.idCounter++}t.exports=s,s.idCounter=0},{}],29:[function(e,t,i){var s={};s.GetArea=function(e){if(e.length<6)return 0;for(var t=e.length-2,i=0,s=0;s<t;s+=2)i+=(e[s+2]-e[s])*(e[s+1]+e[s+3]);return.5*-(i+=(e[0]-e[t])*(e[t+1]+e[1]))},s.Triangulate=function(e){var t=e.length>>1;if(t<3)return[];for(var i=[],a=[],n=0;n<t;n++)a.push(n);for(var n=0,o=t;o>3;){var r=a[(n+0)%o],l=a[(n+1)%o],h=a[(n+2)%o],c=e[2*r],p=e[2*r+1],d=e[2*l],u=e[2*l+1],m=e[2*h],g=e[2*h+1],y=!1;if(s._convex(c,p,d,u,m,g)){y=!0;for(var b=0;b<o;b++){var x=a[b];if(x!=r&&x!=l&&x!=h&&s._PointInTriangle(e[2*x],e[2*x+1],c,p,d,u,m,g)){y=!1;break}}}if(y)i.push(r,l,h),a.splice((n+1)%o,1),o--,n=0;else if(n++>3*o)break}return i.push(a[0],a[1],a[2]),i},s._PointInTriangle=function(e,t,i,s,a,n,o,r){var l=o-i,h=r-s,c=a-i,p=n-s,d=e-i,u=t-s,m=l*l+h*h,g=l*c+h*p,y=l*d+h*u,b=c*c+p*p,x=c*d+p*u,v=1/(m*b-g*g),f=(b*y-g*x)*v,w=(m*x-g*y)*v;return f>=0&&w>=0&&f+w<1},s._convex=function(e,t,i,s,a,n){return(t-s)*(a-i)+(i-e)*(n-s)>=0},t.exports=s},{}],30:[function(e,t,i){var s=t.exports={},a=e("../utils/Utils");s.crossLength=function(e,t){return e[0]*t[1]-e[1]*t[0]},s.crossVZ=function(e,t,i){return s.rotate(e,t,-Math.PI/2),s.scale(e,e,i),e},s.crossZV=function(e,t,i){return s.rotate(e,i,Math.PI/2),s.scale(e,e,t),e},s.rotate=function(e,t,i){if(0!==i){var s=Math.cos(i),a=Math.sin(i),n=t[0],o=t[1];e[0]=s*n-a*o,e[1]=a*n+s*o}else e[0]=t[0],e[1]=t[1]},s.rotate90cw=function(e,t){var i=t[0],s=t[1];e[0]=s,e[1]=-i},s.toLocalFrame=function(e,t,i,a){s.copy(e,t),s.sub(e,e,i),s.rotate(e,e,-a)},s.toGlobalFrame=function(e,t,i,a){s.copy(e,t),s.rotate(e,e,a),s.add(e,e,i)},s.vectorToLocalFrame=function(e,t,i){s.rotate(e,t,-i)},s.vectorToGlobalFrame=function(e,t,i){s.rotate(e,t,i)},s.centroid=function(e,t,i,a){return s.add(e,t,i),s.add(e,e,a),s.scale(e,e,1/3),e},s.create=function(){var e=new a.ARRAY_TYPE(2);return e[0]=0,e[1]=0,e},s.clone=function(e){var t=new a.ARRAY_TYPE(2);return t[0]=e[0],t[1]=e[1],t},s.fromValues=function(e,t){var i=new a.ARRAY_TYPE(2);return i[0]=e,i[1]=t,i},s.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},s.set=function(e,t,i){return e[0]=t,e[1]=i,e},s.add=function(e,t,i){return e[0]=t[0]+i[0],e[1]=t[1]+i[1],e},s.subtract=function(e,t,i){return e[0]=t[0]-i[0],e[1]=t[1]-i[1],e},s.sub=s.subtract,s.multiply=function(e,t,i){return e[0]=t[0]*i[0],e[1]=t[1]*i[1],e},s.mul=s.multiply,s.divide=function(e,t,i){return e[0]=t[0]/i[0],e[1]=t[1]/i[1],e},s.div=s.divide,s.scale=function(e,t,i){return e[0]=t[0]*i,e[1]=t[1]*i,e},s.distance=function(e,t){var i=t[0]-e[0],s=t[1]-e[1];return Math.sqrt(i*i+s*s)},s.dist=s.distance,s.squaredDistance=function(e,t){var i=t[0]-e[0],s=t[1]-e[1];return i*i+s*s},s.sqrDist=s.squaredDistance,s.length=function(e){var t=e[0],i=e[1];return Math.sqrt(t*t+i*i)},s.len=s.length,s.squaredLength=function(e){var t=e[0],i=e[1];return t*t+i*i},s.sqrLen=s.squaredLength,s.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},s.normalize=function(e,t){var i=t[0],s=t[1],a=i*i+s*s;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a),e},s.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},s.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},s.lerp=function(e,t,i,s){var a=t[0],n=t[1];return e[0]=a+s*(i[0]-a),e[1]=n+s*(i[1]-n),e},s.reflect=function(e,t,i){var s=t[0]*i[0]+t[1]*i[1];e[0]=t[0]-2*i[0]*s,e[1]=t[1]-2*i[1]*s},s.getLineSegmentsIntersection=function(e,t,i,a,n){var o=s.getLineSegmentsIntersectionFraction(t,i,a,n);return!(o<0||(e[0]=t[0]+o*(i[0]-t[0]),e[1]=t[1]+o*(i[1]-t[1]),0))},s.getLineSegmentsIntersectionFraction=function(e,t,i,s){var a,n,o=t[0]-e[0],r=t[1]-e[1],l=s[0]-i[0],h=s[1]-i[1];return a=(-r*(e[0]-i[0])+o*(e[1]-i[1]))/(-l*r+o*h),n=(l*(e[1]-i[1])-h*(e[0]-i[0]))/(-l*r+o*h),a>=0&&a<=1&&n>=0&&n<=1?n:-1}},{"../utils/Utils":57}],31:[function(e,t,i){function s(e){e=e||{},c.call(this),this.id=e.id||++s._idCounter,this.world=null,this.shapes=[],this.mass=e.mass||0,this.invMass=0,this.inertia=0,this.invInertia=0,this.invMassSolve=0,this.invInertiaSolve=0,this.fixedRotation=!!e.fixedRotation,this.fixedX=!!e.fixedX,this.fixedY=!!e.fixedY,this.massMultiplier=a.create(),this.position=a.fromValues(0,0),e.position&&a.copy(this.position,e.position),this.interpolatedPosition=a.fromValues(0,0),this.interpolatedAngle=0,this.previousPosition=a.fromValues(0,0),this.previousAngle=0,this.velocity=a.fromValues(0,0),e.velocity&&a.copy(this.velocity,e.velocity),this.vlambda=a.fromValues(0,0),this.wlambda=0,this.angle=e.angle||0,this.angularVelocity=e.angularVelocity||0,this.force=a.create(),e.force&&a.copy(this.force,e.force),this.angularForce=e.angularForce||0,this.damping="number"==typeof e.damping?e.damping:.1,this.angularDamping="number"==typeof e.angularDamping?e.angularDamping:.1,this.type=s.STATIC,void 0!==e.type?this.type=e.type:e.mass?this.type=s.DYNAMIC:this.type=s.STATIC,this.boundingRadius=0,this.aabb=new h,this.aabbNeedsUpdate=!0,this.allowSleep=void 0===e.allowSleep||e.allowSleep,this.wantsToSleep=!1,this.sleepState=s.AWAKE,this.sleepSpeedLimit=void 0!==e.sleepSpeedLimit?e.sleepSpeedLimit:.2,this.sleepTimeLimit=void 0!==e.sleepTimeLimit?e.sleepTimeLimit:1,this.gravityScale=void 0!==e.gravityScale?e.gravityScale:1,this.collisionResponse=void 0===e.collisionResponse||e.collisionResponse,this.idleTime=0,this.timeLastSleepy=0,this.ccdSpeedThreshold=void 0!==e.ccdSpeedThreshold?e.ccdSpeedThreshold:-1,this.ccdIterations=void 0!==e.ccdIterations?e.ccdIterations:10,this.concavePath=null,this._wakeUpAfterNarrowphase=!1,this.updateMassProperties()}var a=e("../math/vec2"),n=e("poly-decomp"),o=e("../shapes/Convex"),r=e("../collision/RaycastResult"),l=e("../collision/Ray"),h=e("../collision/AABB"),c=e("../events/EventEmitter");t.exports=s,s.prototype=new c,s.prototype.constructor=s,s._idCounter=0,s.prototype.updateSolveMassProperties=function(){this.sleepState===s.SLEEPING||this.type===s.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve=0):(this.invMassSolve=this.invMass,this.invInertiaSolve=this.invInertia)},s.prototype.setDensity=function(e){var t=this.getArea();this.mass=t*e,this.updateMassProperties()},s.prototype.getArea=function(){for(var e=0,t=0;t<this.shapes.length;t++)e+=this.shapes[t].area;return e},s.prototype.getAABB=function(){return this.aabbNeedsUpdate&&this.updateAABB(),this.aabb};var p=new h,d=a.create();s.prototype.updateAABB=function(){for(var e=this.shapes,t=e.length,i=d,s=this.angle,n=0;n!==t;n++){var o=e[n],r=o.angle+s;a.rotate(i,o.position,s),a.add(i,i,this.position),o.computeAABB(p,i,r),0===n?this.aabb.copy(p):this.aabb.extend(p)}this.aabbNeedsUpdate=!1},s.prototype.updateBoundingRadius=function(){for(var e=this.shapes,t=e.length,i=0,s=0;s!==t;s++){var n=e[s],o=a.length(n.position),r=n.boundingRadius;o+r>i&&(i=o+r)}this.boundingRadius=i},s.prototype.addShape=function(e,t,i){if(e.body)throw new Error("A shape can only be added to one body.");e.body=this,t?a.copy(e.position,t):a.set(e.position,0,0),e.angle=i||0,this.shapes.push(e),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0},s.prototype.removeShape=function(e){var t=this.shapes.indexOf(e);return-1!==t&&(this.shapes.splice(t,1),this.aabbNeedsUpdate=!0,e.body=null,!0)},s.prototype.updateMassProperties=function(){if(this.type===s.STATIC||this.type===s.KINEMATIC)this.mass=Number.MAX_VALUE,this.invMass=0,this.inertia=Number.MAX_VALUE,this.invInertia=0;else{var e=this.shapes,t=e.length,i=this.mass/t,n=0;if(this.fixedRotation)this.inertia=Number.MAX_VALUE,this.invInertia=0;else{for(var o=0;o<t;o++){var r=e[o],l=a.squaredLength(r.position);n+=r.computeMomentOfInertia(i)+i*l}this.inertia=n,this.invInertia=n>0?1/n:0}this.invMass=1/this.mass,a.set(this.massMultiplier,this.fixedX?0:1,this.fixedY?0:1)}},a.create(),s.prototype.applyForce=function(e,t){if(a.add(this.force,this.force,e),t){var i=a.crossLength(t,e);this.angularForce+=i}};var u=a.create(),m=a.create(),g=a.create();s.prototype.applyForceLocal=function(e,t){t=t||g;var i=u,s=m;this.vectorToWorldFrame(i,e),this.vectorToWorldFrame(s,t),this.applyForce(i,s)};var y=a.create();s.prototype.applyImpulse=function(e,t){if(this.type===s.DYNAMIC){var i=y;if(a.scale(i,e,this.invMass),a.multiply(i,this.massMultiplier,i),a.add(this.velocity,i,this.velocity),t){var n=a.crossLength(t,e);n*=this.invInertia,this.angularVelocity+=n}}};var b=a.create(),x=a.create(),v=a.create();s.prototype.applyImpulseLocal=function(e,t){t=t||v;var i=b,s=x;this.vectorToWorldFrame(i,e),this.vectorToWorldFrame(s,t),this.applyImpulse(i,s)},s.prototype.toLocalFrame=function(e,t){a.toLocalFrame(e,t,this.position,this.angle)},s.prototype.toWorldFrame=function(e,t){a.toGlobalFrame(e,t,this.position,this.angle)},s.prototype.vectorToLocalFrame=function(e,t){a.vectorToLocalFrame(e,t,this.angle)},s.prototype.vectorToWorldFrame=function(e,t){a.vectorToGlobalFrame(e,t,this.angle)},s.prototype.fromPolygon=function(e,t){t=t||{};for(l=this.shapes.length;l>=0;--l)this.removeShape(this.shapes[l]);var i=new n.Polygon;if(i.vertices=e,i.makeCCW(),"number"==typeof t.removeCollinearPoints&&i.removeCollinearPoints(t.removeCollinearPoints),void 0===t.skipSimpleCheck&&!i.isSimple())return!1;this.concavePath=i.vertices.slice(0);for(l=0;l<this.concavePath.length;l++){p=[0,0];a.copy(p,this.concavePath[l]),this.concavePath[l]=p}var s;s=t.optimalDecomp?i.decomp():i.quickDecomp();for(var r=a.create(),l=0;l!==s.length;l++){for(var h=new o({vertices:s[l].vertices}),c=0;c!==h.vertices.length;c++){var p=h.vertices[c];a.sub(p,p,h.centerOfMass)}a.scale(r,h.centerOfMass,1),h.updateTriangles(),h.updateCenterOfMass(),h.updateBoundingRadius(),this.addShape(h,r)}return this.adjustCenterOfMass(),this.aabbNeedsUpdate=!0,!0};var f=(a.fromValues(0,0),a.fromValues(0,0)),w=a.fromValues(0,0),k=a.fromValues(0,0);s.prototype.adjustCenterOfMass=function(){var e=f,t=w,i=k,s=0;a.set(t,0,0);for(o=0;o!==this.shapes.length;o++){n=this.shapes[o];a.scale(e,n.position,n.area),a.add(t,t,e),s+=n.area}a.scale(i,t,1/s);for(o=0;o!==this.shapes.length;o++){var n=this.shapes[o];a.sub(n.position,n.position,i)}a.add(this.position,this.position,i);for(var o=0;this.concavePath&&o<this.concavePath.length;o++)a.sub(this.concavePath[o],this.concavePath[o],i);this.updateMassProperties(),this.updateBoundingRadius()},s.prototype.setZeroForce=function(){a.set(this.force,0,0),this.angularForce=0},s.prototype.resetConstraintVelocity=function(){var e=this,t=e.vlambda;a.set(t,0,0),e.wlambda=0},s.prototype.addConstraintVelocity=function(){var e=this,t=e.velocity;a.add(t,t,e.vlambda),e.angularVelocity+=e.wlambda},s.prototype.applyDamping=function(e){if(this.type===s.DYNAMIC){var t=this.velocity;a.scale(t,t,Math.pow(1-this.damping,e)),this.angularVelocity*=Math.pow(1-this.angularDamping,e)}},s.prototype.wakeUp=function(){var e=this.sleepState;this.sleepState=s.AWAKE,this.idleTime=0,e!==s.AWAKE&&this.emit(s.wakeUpEvent)},s.prototype.sleep=function(){this.sleepState=s.SLEEPING,this.angularVelocity=0,this.angularForce=0,a.set(this.velocity,0,0),a.set(this.force,0,0),this.emit(s.sleepEvent)},s.prototype.sleepTick=function(e,t,i){this.allowSleep&&this.type!==s.SLEEPING&&(this.wantsToSleep=!1,(this.sleepState,a.squaredLength(this.velocity)+Math.pow(this.angularVelocity,2))>=Math.pow(this.sleepSpeedLimit,2)?(this.idleTime=0,this.sleepState=s.AWAKE):(this.idleTime+=i,this.sleepState=s.SLEEPY),this.idleTime>this.sleepTimeLimit&&(t?this.wantsToSleep=!0:this.sleep()))},s.prototype.overlaps=function(e){return this.world.overlapKeeper.bodiesAreOverlapping(this,e)};var _=a.create(),S=a.create();s.prototype.integrate=function(e){var t=this.invMass,i=this.force,s=this.position,n=this.velocity;a.copy(this.previousPosition,this.position),this.previousAngle=this.angle,this.fixedRotation||(this.angularVelocity+=this.angularForce*this.invInertia*e),a.scale(_,i,e*t),a.multiply(_,this.massMultiplier,_),a.add(n,_,n),this.integrateToTimeOfImpact(e)||(a.scale(S,n,e),a.add(s,s,S),this.fixedRotation||(this.angle+=this.angularVelocity*e)),this.aabbNeedsUpdate=!0};var M=new r,A=new l({mode:l.ALL}),C=a.create(),P=a.create(),T=a.create(),X=a.create();s.prototype.integrateToTimeOfImpact=function(e){if(this.ccdSpeedThreshold<0||a.squaredLength(this.velocity)<Math.pow(this.ccdSpeedThreshold,2))return!1;a.normalize(C,this.velocity),a.scale(P,this.velocity,e),a.add(P,P,this.position),a.sub(T,P,this.position);var t,i=this.angularVelocity*e,s=a.length(T),n=1,o=this;if(M.reset(),A.callback=function(e){e.body!==o&&(t=e.body,e.getHitPoint(P,A),a.sub(T,P,o.position),n=a.length(T)/s,e.stop())},a.copy(A.from,this.position),a.copy(A.to,P),A.update(),this.world.raycast(M,A),!t)return!1;var r=this.angle;a.copy(X,this.position);for(var l=0,h=0,c=0,p=n;p>=h&&l<this.ccdIterations;)l++,c=(p-h)/2,a.scale(S,T,n),a.add(this.position,X,S),this.angle=r+i*n,this.updateAABB(),this.aabb.overlaps(t.aabb)&&this.world.narrowphase.bodiesOverlap(this,t)?h=c:p=c;return n=c,a.copy(this.position,X),this.angle=r,a.scale(S,T,n),a.add(this.position,this.position,S),this.fixedRotation||(this.angle+=i*n),!0},s.prototype.getVelocityAtPoint=function(e,t){return a.crossVZ(e,t,this.angularVelocity),a.subtract(e,this.velocity,e),e},s.sleepyEvent={type:"sleepy"},s.sleepEvent={type:"sleep"},s.wakeUpEvent={type:"wakeup"},s.DYNAMIC=1,s.STATIC=2,s.KINEMATIC=4,s.AWAKE=0,s.SLEEPY=1,s.SLEEPING=2},{"../collision/AABB":7,"../collision/Ray":11,"../collision/RaycastResult":12,"../events/EventEmitter":26,"../math/vec2":30,"../shapes/Convex":40,"poly-decomp":5}],32:[function(e,t,i){function s(e,t,i){i=i||{},n.call(this,e,t,i),this.localAnchorA=a.fromValues(0,0),this.localAnchorB=a.fromValues(0,0),i.localAnchorA&&a.copy(this.localAnchorA,i.localAnchorA),i.localAnchorB&&a.copy(this.localAnchorB,i.localAnchorB),i.worldAnchorA&&this.setWorldAnchorA(i.worldAnchorA),i.worldAnchorB&&this.setWorldAnchorB(i.worldAnchorB);var s=a.create(),o=a.create();this.getWorldAnchorA(s),this.getWorldAnchorB(o);var r=a.distance(s,o);this.restLength="number"==typeof i.restLength?i.restLength:r}var a=e("../math/vec2"),n=e("./Spring");e("../utils/Utils"),t.exports=s,(s.prototype=new n).constructor=s,s.prototype.setWorldAnchorA=function(e){this.bodyA.toLocalFrame(this.localAnchorA,e)},s.prototype.setWorldAnchorB=function(e){this.bodyB.toLocalFrame(this.localAnchorB,e)},s.prototype.getWorldAnchorA=function(e){this.bodyA.toWorldFrame(e,this.localAnchorA)},s.prototype.getWorldAnchorB=function(e){this.bodyB.toWorldFrame(e,this.localAnchorB)};var o=a.create(),r=a.create(),l=a.create(),h=a.create(),c=a.create(),p=a.create(),d=a.create(),u=a.create(),m=a.create();s.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,i=this.restLength,s=this.bodyA,n=this.bodyB,g=o,y=r,b=l,x=h,v=m,f=c,w=p,k=d,_=u;this.getWorldAnchorA(f),this.getWorldAnchorB(w),a.sub(k,f,s.position),a.sub(_,w,n.position),a.sub(g,w,f);var S=a.len(g);a.normalize(y,g),a.sub(b,n.velocity,s.velocity),a.crossZV(v,n.angularVelocity,_),a.add(b,b,v),a.crossZV(v,s.angularVelocity,k),a.sub(b,b,v),a.scale(x,y,-e*(S-i)-t*a.dot(b,y)),a.sub(s.force,s.force,x),a.add(n.force,n.force,x);var M=a.crossLength(k,x),A=a.crossLength(_,x);s.angularForce-=M,n.angularForce+=A}},{"../math/vec2":30,"../utils/Utils":57,"./Spring":34}],33:[function(e,t,i){function s(e,t,i){i=i||{},a.call(this,e,t,i),this.restAngle="number"==typeof i.restAngle?i.restAngle:t.angle-e.angle}var a=(e("../math/vec2"),e("./Spring"));t.exports=s,(s.prototype=new a).constructor=s,s.prototype.applyForce=function(){var e=this.stiffness,t=this.damping,i=this.restAngle,s=this.bodyA,a=this.bodyB,n=-e*(a.angle-s.angle-i)-t*(a.angularVelocity-s.angularVelocity)*0;s.angularForce-=n,a.angularForce+=n}},{"../math/vec2":30,"./Spring":34}],34:[function(e,t,i){function s(e,t,i){i=a.defaults(i,{stiffness:100,damping:1}),this.stiffness=i.stiffness,this.damping=i.damping,this.bodyA=e,this.bodyB=t}var a=(e("../math/vec2"),e("../utils/Utils"));t.exports=s,s.prototype.applyForce=function(){}},{"../math/vec2":30,"../utils/Utils":57}],35:[function(e,t,i){function s(e,t){t=t||{},this.chassisBody=e,this.wheels=[],this.groundBody=new l({mass:0}),this.world=null;var i=this;this.preStepCallback=function(){i.update()}}function a(e,t){t=t||{},this.vehicle=e,this.forwardEquation=new r(e.chassisBody,e.groundBody),this.sideEquation=new r(e.chassisBody,e.groundBody),this.steerValue=0,this.engineForce=0,this.setSideFriction(void 0!==t.sideFriction?t.sideFriction:5),this.localForwardVector=n.fromValues(0,1),t.localForwardVector&&n.copy(this.localForwardVector,t.localForwardVector),this.localPosition=n.fromValues(0,0),t.localPosition&&n.copy(this.localPosition,t.localPosition),o.apply(this,e.chassisBody,e.groundBody),this.equations.push(this.forwardEquation,this.sideEquation),this.setBrakeForce(0)}var n=e("../math/vec2"),o=(e("../utils/Utils"),e("../constraints/Constraint")),r=e("../equations/FrictionEquation"),l=e("../objects/Body");t.exports=s,s.prototype.addToWorld=function(e){this.world=e,e.addBody(this.groundBody),e.on("preStep",this.preStepCallback);for(var t=0;t<this.wheels.length;t++){var i=this.wheels[t];e.addConstraint(i)}},s.prototype.removeFromWorld=function(){var e=this.world;e.removeBody(this.groundBody),e.off("preStep",this.preStepCallback);for(var t=0;t<this.wheels.length;t++){var i=this.wheels[t];e.removeConstraint(i)}this.world=null},s.prototype.addWheel=function(e){var t=new a(this,e);return this.wheels.push(t),t},s.prototype.update=function(){for(var e=0;e<this.wheels.length;e++)this.wheels[e].update()},(a.prototype=new o).setBrakeForce=function(e){this.forwardEquation.setSlipForce(e)},a.prototype.setSideFriction=function(e){this.sideEquation.setSlipForce(e)};var h=n.create(),c=n.create();a.prototype.getSpeed=function(){return this.vehicle.chassisBody.vectorToWorldFrame(c,this.localForwardVector),this.vehicle.chassisBody.getVelocityAtPoint(h,c),n.dot(h,c)};var p=n.create();a.prototype.update=function(){this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.t,this.localForwardVector),n.rotate(this.sideEquation.t,this.localForwardVector,Math.PI/2),this.vehicle.chassisBody.vectorToWorldFrame(this.sideEquation.t,this.sideEquation.t),n.rotate(this.forwardEquation.t,this.forwardEquation.t,this.steerValue),n.rotate(this.sideEquation.t,this.sideEquation.t,this.steerValue),this.vehicle.chassisBody.toWorldFrame(this.forwardEquation.contactPointB,this.localPosition),n.copy(this.sideEquation.contactPointB,this.forwardEquation.contactPointB),this.vehicle.chassisBody.vectorToWorldFrame(this.forwardEquation.contactPointA,this.localPosition),n.copy(this.sideEquation.contactPointA,this.forwardEquation.contactPointA),n.normalize(p,this.forwardEquation.t),n.scale(p,p,this.engineForce),this.vehicle.chassisBody.applyForce(p,this.forwardEquation.contactPointA)}},{"../constraints/Constraint":14,"../equations/FrictionEquation":23,"../math/vec2":30,"../objects/Body":31,"../utils/Utils":57}],36:[function(e,t,i){var s=t.exports={AABB:e("./collision/AABB"),AngleLockEquation:e("./equations/AngleLockEquation"),Body:e("./objects/Body"),Broadphase:e("./collision/Broadphase"),Capsule:e("./shapes/Capsule"),Circle:e("./shapes/Circle"),Constraint:e("./constraints/Constraint"),ContactEquation:e("./equations/ContactEquation"),ContactEquationPool:e("./utils/ContactEquationPool"),ContactMaterial:e("./material/ContactMaterial"),Convex:e("./shapes/Convex"),DistanceConstraint:e("./constraints/DistanceConstraint"),Equation:e("./equations/Equation"),EventEmitter:e("./events/EventEmitter"),FrictionEquation:e("./equations/FrictionEquation"),FrictionEquationPool:e("./utils/FrictionEquationPool"),GearConstraint:e("./constraints/GearConstraint"),GSSolver:e("./solver/GSSolver"),Heightfield:e("./shapes/Heightfield"),Line:e("./shapes/Line"),LockConstraint:e("./constraints/LockConstraint"),Material:e("./material/Material"),Narrowphase:e("./collision/Narrowphase"),NaiveBroadphase:e("./collision/NaiveBroadphase"),Particle:e("./shapes/Particle"),Plane:e("./shapes/Plane"),Pool:e("./utils/Pool"),RevoluteConstraint:e("./constraints/RevoluteConstraint"),PrismaticConstraint:e("./constraints/PrismaticConstraint"),Ray:e("./collision/Ray"),RaycastResult:e("./collision/RaycastResult"),Box:e("./shapes/Box"),RotationalVelocityEquation:e("./equations/RotationalVelocityEquation"),SAPBroadphase:e("./collision/SAPBroadphase"),Shape:e("./shapes/Shape"),Solver:e("./solver/Solver"),Spring:e("./objects/Spring"),TopDownVehicle:e("./objects/TopDownVehicle"),LinearSpring:e("./objects/LinearSpring"),RotationalSpring:e("./objects/RotationalSpring"),Utils:e("./utils/Utils"),World:e("./world/World"),vec2:e("./math/vec2"),version:e("../package.json").version};Object.defineProperty(s,"Rectangle",{get:function(){return this.Box}})},{"../package.json":6,"./collision/AABB":7,"./collision/Broadphase":8,"./collision/NaiveBroadphase":9,"./collision/Narrowphase":10,"./collision/Ray":11,"./collision/RaycastResult":12,"./collision/SAPBroadphase":13,"./constraints/Constraint":14,"./constraints/DistanceConstraint":15,"./constraints/GearConstraint":16,"./constraints/LockConstraint":17,"./constraints/PrismaticConstraint":18,"./constraints/RevoluteConstraint":19,"./equations/AngleLockEquation":20,"./equations/ContactEquation":21,"./equations/Equation":22,"./equations/FrictionEquation":23,"./equations/RotationalVelocityEquation":25,"./events/EventEmitter":26,"./material/ContactMaterial":27,"./material/Material":28,"./math/vec2":30,"./objects/Body":31,"./objects/LinearSpring":32,"./objects/RotationalSpring":33,"./objects/Spring":34,"./objects/TopDownVehicle":35,"./shapes/Box":37,"./shapes/Capsule":38,"./shapes/Circle":39,"./shapes/Convex":40,"./shapes/Heightfield":41,"./shapes/Line":42,"./shapes/Particle":43,"./shapes/Plane":44,"./shapes/Shape":45,"./solver/GSSolver":46,"./solver/Solver":47,"./utils/ContactEquationPool":48,"./utils/FrictionEquationPool":49,"./utils/Pool":55,"./utils/Utils":57,"./world/World":61}],37:[function(e,t,i){function s(e){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(e={width:arguments[0],height:arguments[1]}),e=e||{};var t=this.width=e.width||1,i=this.height=e.height||1,s=[a.fromValues(-t/2,-i/2),a.fromValues(t/2,-i/2),a.fromValues(t/2,i/2),a.fromValues(-t/2,i/2)],r=[a.fromValues(1,0),a.fromValues(0,1)];e.vertices=s,e.axes=r,e.type=n.BOX,o.call(this,e)}var a=e("../math/vec2"),n=e("./Shape"),o=e("./Convex");t.exports=s,(s.prototype=new o).constructor=s,s.prototype.computeMomentOfInertia=function(e){var t=this.width,i=this.height;return e*(i*i+t*t)/12},s.prototype.updateBoundingRadius=function(){var e=this.width,t=this.height;this.boundingRadius=Math.sqrt(e*e+t*t)/2},a.create(),a.create(),a.create(),a.create(),s.prototype.computeAABB=function(e,t,i){e.setFromPoints(this.vertices,t,i,0)},s.prototype.updateArea=function(){this.area=this.width*this.height}},{"../math/vec2":30,"./Convex":40,"./Shape":45}],38:[function(e,t,i){function s(e){"number"==typeof arguments[0]&&"number"==typeof arguments[1]&&(e={length:arguments[0],radius:arguments[1]}),e=e||{},this.length=e.length||1,this.radius=e.radius||1,e.type=a.CAPSULE,a.call(this,e)}var a=e("./Shape"),n=e("../math/vec2");t.exports=s,(s.prototype=new a).constructor=s,s.prototype.computeMomentOfInertia=function(e){var t=this.radius,i=this.length+t,s=2*t;return e*(s*s+i*i)/12},s.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius+this.length/2},s.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius+2*this.radius*this.length};var o=n.create();s.prototype.computeAABB=function(e,t,i){var s=this.radius;n.set(o,this.length/2,0),0!==i&&n.rotate(o,o,i),n.set(e.upperBound,Math.max(o[0]+s,-o[0]+s),Math.max(o[1]+s,-o[1]+s)),n.set(e.lowerBound,Math.min(o[0]-s,-o[0]-s),Math.min(o[1]-s,-o[1]-s)),n.add(e.lowerBound,e.lowerBound,t),n.add(e.upperBound,e.upperBound,t)};var r=n.create(),l=n.create(),h=n.create(),c=n.create(),p=n.fromValues(0,1);s.prototype.raycast=function(e,t,i,s){for(var a=t.from,o=t.to,d=(t.direction,r),u=l,m=h,g=c,y=this.length/2,b=0;b<2;b++){var x=this.radius*(2*b-1);if(n.set(m,-y,x),n.set(g,y,x),n.toGlobalFrame(m,m,i,s),n.toGlobalFrame(g,g,i,s),(_=n.getLineSegmentsIntersectionFraction(a,o,m,g))>=0&&(n.rotate(u,p,s),n.scale(u,u,2*b-1),t.reportIntersection(e,_,u,-1),e.shouldStop(t)))return}for(var v=Math.pow(this.radius,2)+Math.pow(y,2),b=0;b<2;b++){n.set(m,y*(2*b-1),0),n.toGlobalFrame(m,m,i,s);var f=Math.pow(o[0]-a[0],2)+Math.pow(o[1]-a[1],2),w=2*((o[0]-a[0])*(a[0]-m[0])+(o[1]-a[1])*(a[1]-m[1])),k=Math.pow(a[0]-m[0],2)+Math.pow(a[1]-m[1],2)-Math.pow(this.radius,2),_=Math.pow(w,2)-4*f*k;if(!(_<0))if(0===_){if(n.lerp(d,a,o,_),n.squaredDistance(d,i)>v&&(n.sub(u,d,m),n.normalize(u,u),t.reportIntersection(e,_,u,-1),e.shouldStop(t)))return}else{var S=Math.sqrt(_),M=1/(2*f),A=(-w-S)*M,C=(-w+S)*M;if(A>=0&&A<=1&&(n.lerp(d,a,o,A),n.squaredDistance(d,i)>v&&(n.sub(u,d,m),n.normalize(u,u),t.reportIntersection(e,A,u,-1),e.shouldStop(t))))return;if(C>=0&&C<=1&&(n.lerp(d,a,o,C),n.squaredDistance(d,i)>v&&(n.sub(u,d,m),n.normalize(u,u),t.reportIntersection(e,C,u,-1),e.shouldStop(t))))return}}}},{"../math/vec2":30,"./Shape":45}],39:[function(e,t,i){function s(e){"number"==typeof arguments[0]&&(e={radius:arguments[0]}),e=e||{},this.radius=e.radius||1,e.type=a.CIRCLE,a.call(this,e)}var a=e("./Shape"),n=e("../math/vec2");t.exports=s,(s.prototype=new a).constructor=s,s.prototype.computeMomentOfInertia=function(e){var t=this.radius;return e*t*t/2},s.prototype.updateBoundingRadius=function(){this.boundingRadius=this.radius},s.prototype.updateArea=function(){this.area=Math.PI*this.radius*this.radius},s.prototype.computeAABB=function(e,t,i){var s=this.radius;n.set(e.upperBound,s,s),n.set(e.lowerBound,-s,-s),t&&(n.add(e.lowerBound,e.lowerBound,t),n.add(e.upperBound,e.upperBound,t))};var o=n.create(),r=n.create();s.prototype.raycast=function(e,t,i,s){var a=t.from,l=t.to,h=this.radius,c=Math.pow(l[0]-a[0],2)+Math.pow(l[1]-a[1],2),p=2*((l[0]-a[0])*(a[0]-i[0])+(l[1]-a[1])*(a[1]-i[1])),d=Math.pow(a[0]-i[0],2)+Math.pow(a[1]-i[1],2)-Math.pow(h,2),u=Math.pow(p,2)-4*c*d,m=o,g=r;if(!(u<0))if(0===u)n.lerp(m,a,l,u),n.sub(g,m,i),n.normalize(g,g),t.reportIntersection(e,u,g,-1);else{var y=Math.sqrt(u),b=1/(2*c),x=(-p-y)*b,v=(-p+y)*b;if(x>=0&&x<=1&&(n.lerp(m,a,l,x),n.sub(g,m,i),n.normalize(g,g),t.reportIntersection(e,x,g,-1),e.shouldStop(t)))return;v>=0&&v<=1&&(n.lerp(m,a,l,v),n.sub(g,m,i),n.normalize(g,g),t.reportIntersection(e,v,g,-1))}}},{"../math/vec2":30,"./Shape":45}],40:[function(e,t,i){function s(e){Array.isArray(arguments[0])&&(e={vertices:arguments[0],axes:arguments[1]}),e=e||{},this.vertices=[];for(var t=void 0!==e.vertices?e.vertices:[],i=0;i<t.length;i++){var s=n.create();n.copy(s,t[i]),this.vertices.push(s)}if(this.axes=[],e.axes)for(i=0;i<e.axes.length;i++){var o=n.create();n.copy(o,e.axes[i]),this.axes.push(o)}else for(i=0;i<this.vertices.length;i++){var r=this.vertices[i],l=this.vertices[(i+1)%this.vertices.length],h=n.create();n.sub(h,l,r),n.rotate90cw(h,h),n.normalize(h,h),this.axes.push(h)}if(this.centerOfMass=n.fromValues(0,0),this.triangles=[],this.vertices.length&&(this.updateTriangles(),this.updateCenterOfMass()),this.boundingRadius=0,e.type=a.CONVEX,a.call(this,e),this.updateBoundingRadius(),this.updateArea(),this.area<0)throw new Error("Convex vertices must be given in conter-clockwise winding.")}var a=e("./Shape"),n=e("../math/vec2"),o=e("../math/polyk");e("poly-decomp"),t.exports=s,(s.prototype=new a).constructor=s;var r=n.create(),l=n.create();s.prototype.projectOntoLocalAxis=function(e,t){for(var i,s,a=null,o=null,e=r,l=0;l<this.vertices.length;l++)i=this.vertices[l],s=n.dot(i,e),(null===a||s>a)&&(a=s),(null===o||s<o)&&(o=s);if(o>a){var h=o;o=a,a=h}n.set(t,o,a)},s.prototype.projectOntoWorldAxis=function(e,t,i,s){var a=l;this.projectOntoLocalAxis(e,s),0!==i?n.rotate(a,e,i):a=e;var o=n.dot(t,a);n.set(s,s[0]+o,s[1]+o)},s.prototype.updateTriangles=function(){this.triangles.length=0;for(var e=[],t=0;t<this.vertices.length;t++){var i=this.vertices[t];e.push(i[0],i[1])}for(var s=o.Triangulate(e),t=0;t<s.length;t+=3){var a=s[t],n=s[t+1],r=s[t+2];this.triangles.push([a,n,r])}};var h=n.create(),c=n.create(),p=n.create(),d=n.create(),u=n.create();n.create(),n.create(),n.create(),n.create(),s.prototype.updateCenterOfMass=function(){var e=this.triangles,t=this.vertices,i=this.centerOfMass,a=h,o=p,r=d,l=u,m=c;n.set(i,0,0);for(var g=0,y=0;y!==e.length;y++){var b=e[y],o=t[b[0]],r=t[b[1]],l=t[b[2]];n.centroid(a,o,r,l);var x=s.triangleArea(o,r,l);g+=x,n.scale(m,a,x),n.add(i,i,m)}n.scale(i,i,1/g)},s.prototype.computeMomentOfInertia=function(e){for(var t=0,i=0,s=this.vertices.length,a=s-1,o=0;o<s;a=o,o++){var r=this.vertices[a],l=this.vertices[o],h=Math.abs(n.crossLength(r,l));t+=h*(n.dot(l,l)+n.dot(l,r)+n.dot(r,r)),i+=h}return e/6*(t/i)},s.prototype.updateBoundingRadius=function(){for(var e=this.vertices,t=0,i=0;i!==e.length;i++){var s=n.squaredLength(e[i]);s>t&&(t=s)}this.boundingRadius=Math.sqrt(t)},s.triangleArea=function(e,t,i){return.5*((t[0]-e[0])*(i[1]-e[1])-(i[0]-e[0])*(t[1]-e[1]))},s.prototype.updateArea=function(){this.updateTriangles(),this.area=0;for(var e=this.triangles,t=this.vertices,i=0;i!==e.length;i++){var a=e[i],n=t[a[0]],o=t[a[1]],r=t[a[2]],l=s.triangleArea(n,o,r);this.area+=l}},s.prototype.computeAABB=function(e,t,i){e.setFromPoints(this.vertices,t,i,0)};var m=n.create(),g=n.create(),y=n.create();s.prototype.raycast=function(e,t,i,s){var a=m,o=g,r=y,l=this.vertices;n.toLocalFrame(a,t.from,i,s),n.toLocalFrame(o,t.to,i,s);for(var h=l.length,c=0;c<h&&!e.shouldStop(t);c++){var p=l[c],d=l[(c+1)%h],u=n.getLineSegmentsIntersectionFraction(a,o,p,d);u>=0&&(n.sub(r,d,p),n.rotate(r,r,-Math.PI/2+s),n.normalize(r,r),t.reportIntersection(e,u,r,c))}}},{"../math/polyk":29,"../math/vec2":30,"./Shape":45,"poly-decomp":5}],41:[function(e,t,i){function s(e){if(Array.isArray(arguments[0])&&(e={heights:arguments[0]},"object"==typeof arguments[1]))for(var t in arguments[1])e[t]=arguments[1][t];e=e||{},this.heights=e.heights?e.heights.slice(0):[],this.maxValue=e.maxValue||null,this.minValue=e.minValue||null,this.elementWidth=e.elementWidth||.1,void 0!==e.maxValue&&void 0!==e.minValue||this.updateMaxMinValues(),e.type=a.HEIGHTFIELD,a.call(this,e)}var a=e("./Shape"),n=e("../math/vec2");e("../utils/Utils"),t.exports=s,(s.prototype=new a).constructor=s,s.prototype.updateMaxMinValues=function(){for(var e=this.heights,t=e[0],i=e[0],s=0;s!==e.length;s++){var a=e[s];a>t&&(t=a),a<i&&(i=a)}this.maxValue=t,this.minValue=i},s.prototype.computeMomentOfInertia=function(e){return Number.MAX_VALUE},s.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},s.prototype.updateArea=function(){for(var e=this.heights,t=0,i=0;i<e.length-1;i++)t+=(e[i]+e[i+1])/2*this.elementWidth;this.area=t};var o=[n.create(),n.create(),n.create(),n.create()];s.prototype.computeAABB=function(e,t,i){n.set(o[0],0,this.maxValue),n.set(o[1],this.elementWidth*this.heights.length,this.maxValue),n.set(o[2],this.elementWidth*this.heights.length,this.minValue),n.set(o[3],0,this.minValue),e.setFromPoints(o,t,i)},s.prototype.getLineSegment=function(e,t,i){var s=this.heights,a=this.elementWidth;n.set(e,i*a,s[i]),n.set(t,(i+1)*a,s[i+1])},s.prototype.getSegmentIndex=function(e){return Math.floor(e[0]/this.elementWidth)},s.prototype.getClampedSegmentIndex=function(e){var t=this.getSegmentIndex(e);return t=Math.min(this.heights.length,Math.max(t,0))};var r=(n.create(),n.create()),l=n.create(),h=n.create(),c=n.create(),p=n.create();n.fromValues(0,1),s.prototype.raycast=function(e,t,i,s){var a=t.from,o=t.to,d=(t.direction,r),u=l,m=h,g=c,y=p;n.toLocalFrame(g,a,i,s),n.toLocalFrame(y,o,i,s);var b=this.getClampedSegmentIndex(g),x=this.getClampedSegmentIndex(y);if(b>x){var v=b;b=x,x=v}for(var f=0;f<this.heights.length-1;f++){this.getLineSegment(u,m,f);var w=n.getLineSegmentsIntersectionFraction(g,y,u,m);if(w>=0&&(n.sub(d,m,u),n.rotate(d,d,s+Math.PI/2),n.normalize(d,d),t.reportIntersection(e,w,d,-1),e.shouldStop(t)))return}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],42:[function(e,t,i){function s(e){"number"==typeof arguments[0]&&(e={length:arguments[0]}),e=e||{},this.length=e.length||1,e.type=a.LINE,a.call(this,e)}var a=e("./Shape"),n=e("../math/vec2");t.exports=s,(s.prototype=new a).constructor=s,s.prototype.computeMomentOfInertia=function(e){return e*Math.pow(this.length,2)/12},s.prototype.updateBoundingRadius=function(){this.boundingRadius=this.length/2};var o=[n.create(),n.create()];s.prototype.computeAABB=function(e,t,i){var s=this.length/2;n.set(o[0],-s,0),n.set(o[1],s,0),e.setFromPoints(o,t,i,0)};var r=(n.create(),n.create()),l=n.create(),h=n.create(),c=n.fromValues(0,1);s.prototype.raycast=function(e,t,i,s){var a=t.from,o=t.to,p=l,d=h,u=this.length/2;n.set(p,-u,0),n.set(d,u,0),n.toGlobalFrame(p,p,i,s),n.toGlobalFrame(d,d,i,s);var m=n.getLineSegmentsIntersectionFraction(p,d,a,o);if(m>=0){var g=r;n.rotate(g,c,s),t.reportIntersection(e,m,g,-1)}}},{"../math/vec2":30,"./Shape":45}],43:[function(e,t,i){function s(e){(e=e||{}).type=a.PARTICLE,a.call(this,e)}var a=e("./Shape"),n=e("../math/vec2");t.exports=s,(s.prototype=new a).constructor=s,s.prototype.computeMomentOfInertia=function(e){return 0},s.prototype.updateBoundingRadius=function(){this.boundingRadius=0},s.prototype.computeAABB=function(e,t,i){n.copy(e.lowerBound,t),n.copy(e.upperBound,t)}},{"../math/vec2":30,"./Shape":45}],44:[function(e,t,i){function s(e){(e=e||{}).type=a.PLANE,a.call(this,e)}var a=e("./Shape"),n=e("../math/vec2");e("../utils/Utils"),t.exports=s,(s.prototype=new a).constructor=s,s.prototype.computeMomentOfInertia=function(e){return 0},s.prototype.updateBoundingRadius=function(){this.boundingRadius=Number.MAX_VALUE},s.prototype.computeAABB=function(e,t,i){var s=i%(2*Math.PI),a=n.set,o=Number.MAX_VALUE,r=e.lowerBound,l=e.upperBound;0===s?(a(r,-o,-o),a(l,o,0)):s===Math.PI/2?(a(r,0,-o),a(l,o,o)):s===Math.PI?(a(r,-o,0),a(l,o,o)):s===3*Math.PI/2?(a(r,-o,-o),a(l,0,o)):(a(r,-o,-o),a(l,o,o)),n.add(r,r,t),n.add(l,l,t)},s.prototype.updateArea=function(){this.area=Number.MAX_VALUE};var o=n.create(),r=(n.create(),n.create(),n.create()),l=n.create();s.prototype.raycast=function(e,t,i,s){var a=t.from,h=t.to,c=t.direction,p=o,d=r,u=l;n.set(d,0,1),n.rotate(d,d,s),n.sub(u,a,i);var m=n.dot(u,d);if(n.sub(u,h,i),!(m*n.dot(u,d)>0||n.squaredDistance(a,h)<m*m)){var g=n.dot(d,c);n.sub(p,a,i);var y=-n.dot(d,p)/g/t.length;t.reportIntersection(e,y,d,-1)}}},{"../math/vec2":30,"../utils/Utils":57,"./Shape":45}],45:[function(e,t,i){function s(e){e=e||{},this.body=null,this.position=a.fromValues(0,0),e.position&&a.copy(this.position,e.position),this.angle=e.angle||0,this.type=e.type||0,this.id=s.idCounter++,this.boundingRadius=0,this.collisionGroup=void 0!==e.collisionGroup?e.collisionGroup:1,this.collisionResponse=void 0===e.collisionResponse||e.collisionResponse,this.collisionMask=void 0!==e.collisionMask?e.collisionMask:1,this.material=e.material||null,this.area=0,this.sensor=void 0!==e.sensor&&e.sensor,this.type&&this.updateBoundingRadius(),this.updateArea()}t.exports=s;var a=e("../math/vec2");s.idCounter=0,s.CIRCLE=1,s.PARTICLE=2,s.PLANE=4,s.CONVEX=8,s.LINE=16,s.BOX=32,Object.defineProperty(s,"RECTANGLE",{get:function(){return s.BOX}}),s.CAPSULE=64,s.HEIGHTFIELD=128,s.prototype.computeMomentOfInertia=function(e){},s.prototype.updateBoundingRadius=function(){},s.prototype.updateArea=function(){},s.prototype.computeAABB=function(e,t,i){},s.prototype.raycast=function(e,t,i,s){}},{"../math/vec2":30}],46:[function(e,t,i){function s(e){o.call(this,e,o.GS),e=e||{},this.iterations=e.iterations||10,this.tolerance=e.tolerance||1e-7,this.arrayStep=30,this.lambda=new r.ARRAY_TYPE(this.arrayStep),this.Bs=new r.ARRAY_TYPE(this.arrayStep),this.invCs=new r.ARRAY_TYPE(this.arrayStep),this.useZeroRHS=!1,this.frictionIterations=0,this.usedIterations=0}function a(e){for(var t=e.length;t--;)e[t]=0}var n=e("../math/vec2"),o=e("./Solver"),r=e("../utils/Utils"),l=e("../equations/FrictionEquation");t.exports=s,(s.prototype=new o).constructor=s,s.prototype.solve=function(e,t){this.sortEquations();var i=0,o=this.iterations,h=this.frictionIterations,c=this.equations,p=c.length,d=Math.pow(this.tolerance*p,2),u=t.bodies,m=t.bodies.length,g=(n.add,n.set,this.useZeroRHS),y=this.lambda;if(this.usedIterations=0,p)for(v=0;v!==m;v++)(_=u[v]).updateSolveMassProperties();y.length<p&&(y=this.lambda=new r.ARRAY_TYPE(p+this.arrayStep),this.Bs=new r.ARRAY_TYPE(p+this.arrayStep),this.invCs=new r.ARRAY_TYPE(p+this.arrayStep)),a(y);for(var b=this.invCs,x=this.Bs,y=this.lambda,v=0;v!==c.length;v++)((f=c[v]).timeStep!==e||f.needsUpdate)&&(f.timeStep=e,f.update()),x[v]=f.computeB(f.a,f.b,e),b[v]=f.computeInvC(f.epsilon);var f,w,k;if(0!==p){for(v=0;v!==m;v++){var _=u[v];_.resetConstraintVelocity()}if(h){for(i=0;i!==h;i++){for(w=0,k=0;k!==p;k++){f=c[k];C=s.iterateEquation(k,f,f.epsilon,x,b,y,g,e,i);w+=Math.abs(C)}if(this.usedIterations++,w*w<=d)break}for(s.updateMultipliers(c,y,1/e),k=0;k!==p;k++){var S=c[k];if(S instanceof l){for(var M=0,A=0;A!==S.contactEquations.length;A++)M+=S.contactEquations[A].multiplier;M*=S.frictionCoefficient/S.contactEquations.length,S.maxForce=M,S.minForce=-M}}}for(i=0;i!==o;i++){for(w=0,k=0;k!==p;k++){f=c[k];var C=s.iterateEquation(k,f,f.epsilon,x,b,y,g,e,i);w+=Math.abs(C)}if(this.usedIterations++,w*w<=d)break}for(v=0;v!==m;v++)u[v].addConstraintVelocity();s.updateMultipliers(c,y,1/e)}},s.updateMultipliers=function(e,t,i){for(var s=e.length;s--;)e[s].multiplier=t[s]*i},s.iterateEquation=function(e,t,i,s,a,n,o,r,l){var h=s[e],c=a[e],p=n[e],d=t.computeGWlambda(),u=t.maxForce,m=t.minForce;o&&(h=0);var g=c*(h-d-i*p),y=p+g;return y<m*r?g=m*r-p:y>u*r&&(g=u*r-p),n[e]+=g,t.addToWlambda(g),g}},{"../equations/FrictionEquation":23,"../math/vec2":30,"../utils/Utils":57,"./Solver":47}],47:[function(e,t,i){function s(e,t){e=e||{},a.call(this),this.type=t,this.equations=[],this.equationSortFunction=e.equationSortFunction||!1}var a=(e("../utils/Utils"),e("../events/EventEmitter"));t.exports=s,(s.prototype=new a).constructor=s,s.prototype.solve=function(e,t){throw new Error("Solver.solve should be implemented by subclasses!")};var n={bodies:[]};s.prototype.solveIsland=function(e,t){this.removeAllEquations(),t.equations.length&&(this.addEquations(t.equations),n.bodies.length=0,t.getBodies(n.bodies),n.bodies.length&&this.solve(e,n))},s.prototype.sortEquations=function(){this.equationSortFunction&&this.equations.sort(this.equationSortFunction)},s.prototype.addEquation=function(e){e.enabled&&this.equations.push(e)},s.prototype.addEquations=function(e){for(var t=0,i=e.length;t!==i;t++){var s=e[t];s.enabled&&this.equations.push(s)}},s.prototype.removeEquation=function(e){var t=this.equations.indexOf(e);-1!==t&&this.equations.splice(t,1)},s.prototype.removeAllEquations=function(){this.equations.length=0},s.GS=1,s.ISLAND=2},{"../events/EventEmitter":26,"../utils/Utils":57}],48:[function(e,t,i){function s(){n.apply(this,arguments)}var a=e("../equations/ContactEquation"),n=e("./Pool");t.exports=s,(s.prototype=new n).constructor=s,s.prototype.create=function(){return new a},s.prototype.destroy=function(e){return e.bodyA=e.bodyB=null,this}},{"../equations/ContactEquation":21,"./Pool":55}],49:[function(e,t,i){function s(){n.apply(this,arguments)}var a=e("../equations/FrictionEquation"),n=e("./Pool");t.exports=s,(s.prototype=new n).constructor=s,s.prototype.create=function(){return new a},s.prototype.destroy=function(e){return e.bodyA=e.bodyB=null,this}},{"../equations/FrictionEquation":23,"./Pool":55}],50:[function(e,t,i){function s(){n.apply(this,arguments)}var a=e("../world/IslandNode"),n=e("./Pool");t.exports=s,(s.prototype=new n).constructor=s,s.prototype.create=function(){return new a},s.prototype.destroy=function(e){return e.reset(),this}},{"../world/IslandNode":60,"./Pool":55}],51:[function(e,t,i){function s(){n.apply(this,arguments)}var a=e("../world/Island"),n=e("./Pool");t.exports=s,(s.prototype=new n).constructor=s,s.prototype.create=function(){return new a},s.prototype.destroy=function(e){return e.reset(),this}},{"../world/Island":58,"./Pool":55}],52:[function(e,t,i){function s(){this.overlappingShapesLastState=new a,this.overlappingShapesCurrentState=new a,this.recordPool=new n({size:16}),this.tmpDict=new a,this.tmpArray1=[]}var a=e("./TupleDictionary"),n=(e("./OverlapKeeperRecord"),e("./OverlapKeeperRecordPool"));e("./Utils"),t.exports=s,s.prototype.tick=function(){for(var e=this.overlappingShapesLastState,t=this.overlappingShapesCurrentState,i=e.keys.length;i--;){var s=e.keys[i],a=e.getByKey(s);t.getByKey(s),a&&this.recordPool.release(a)}e.reset(),e.copy(t),t.reset()},s.prototype.setOverlapping=function(e,t,i,s){var a=(this.overlappingShapesLastState,this.overlappingShapesCurrentState);if(!a.get(t.id,s.id)){var n=this.recordPool.get();n.set(e,t,i,s),a.set(t.id,s.id,n)}},s.prototype.getNewOverlaps=function(e){return this.getDiff(this.overlappingShapesLastState,this.overlappingShapesCurrentState,e)},s.prototype.getEndOverlaps=function(e){return this.getDiff(this.overlappingShapesCurrentState,this.overlappingShapesLastState,e)},s.prototype.bodiesAreOverlapping=function(e,t){for(var i=this.overlappingShapesCurrentState,s=i.keys.length;s--;){var a=i.keys[s],n=i.data[a];if(n.bodyA===e&&n.bodyB===t||n.bodyA===t&&n.bodyB===e)return!0}return!1},s.prototype.getDiff=function(e,t,i){var s=e,a=t;(i=i||[]).length=0;for(var n=a.keys.length;n--;){var o=a.keys[n],r=a.data[o];if(!r)throw new Error("Key "+o+" had no data!");s.data[o]||i.push(r)}return i},s.prototype.isNewOverlap=function(e,t){var i=0|e.id,s=0|t.id,a=this.overlappingShapesLastState,n=this.overlappingShapesCurrentState;return!a.get(i,s)&&!!n.get(i,s)},s.prototype.getNewBodyOverlaps=function(e){this.tmpArray1.length=0;var t=this.getNewOverlaps(this.tmpArray1);return this.getBodyDiff(t,e)},s.prototype.getEndBodyOverlaps=function(e){this.tmpArray1.length=0;var t=this.getEndOverlaps(this.tmpArray1);return this.getBodyDiff(t,e)},s.prototype.getBodyDiff=function(e,t){t=t||[];for(var i=this.tmpDict,s=e.length;s--;){var a=e[s];i.set(0|a.bodyA.id,0|a.bodyB.id,a)}for(s=i.keys.length;s--;)(a=i.getByKey(i.keys[s]))&&t.push(a.bodyA,a.bodyB);return i.reset(),t}},{"./OverlapKeeperRecord":53,"./OverlapKeeperRecordPool":54,"./TupleDictionary":56,"./Utils":57}],53:[function(e,t,i){function s(e,t,i,s){this.shapeA=t,this.shapeB=s,this.bodyA=e,this.bodyB=i}t.exports=s,s.prototype.set=function(e,t,i,a){s.call(this,e,t,i,a)}},{}],54:[function(e,t,i){function s(){n.apply(this,arguments)}var a=e("./OverlapKeeperRecord"),n=e("./Pool");t.exports=s,(s.prototype=new n).constructor=s,s.prototype.create=function(){return new a},s.prototype.destroy=function(e){return e.bodyA=e.bodyB=e.shapeA=e.shapeB=null,this}},{"./OverlapKeeperRecord":53,"./Pool":55}],55:[function(e,t,i){function s(e){e=e||{},this.objects=[],void 0!==e.size&&this.resize(e.size)}t.exports=s,s.prototype.resize=function(e){for(var t=this.objects;t.length>e;)t.pop();for(;t.length<e;)t.push(this.create());return this},s.prototype.get=function(){var e=this.objects;return e.length?e.pop():this.create()},s.prototype.release=function(e){return this.destroy(e),this.objects.push(e),this}},{}],56:[function(e,t,i){function s(){this.data={},this.keys=[]}var a=e("./Utils");t.exports=s,s.prototype.getKey=function(e,t){return e|=0,t|=0,(0|e)==(0|t)?-1:0|((0|e)>(0|t)?e<<16|65535&t:t<<16|65535&e)},s.prototype.getByKey=function(e){return e|=0,this.data[e]},s.prototype.get=function(e,t){return this.data[this.getKey(e,t)]},s.prototype.set=function(e,t,i){if(!i)throw new Error("No data!");var s=this.getKey(e,t);return this.data[s]||this.keys.push(s),this.data[s]=i,s},s.prototype.reset=function(){for(var e=this.data,t=this.keys,i=t.length;i--;)delete e[t[i]];t.length=0},s.prototype.copy=function(e){this.reset(),a.appendArray(this.keys,e.keys);for(var t=e.keys.length;t--;){var i=e.keys[t];this.data[i]=e.data[i]}}},{"./Utils":57}],57:[function(e,t,i){function s(){}t.exports=s,s.appendArray=function(e,t){if(t.length<15e4)e.push.apply(e,t);else for(var i=0,s=t.length;i!==s;++i)e.push(t[i])},s.splice=function(e,t,i){i=i||1;for(var s=t,a=e.length-i;s<a;s++)e[s]=e[s+i];e.length=a},s.ARRAY_TYPE="undefined"!=typeof P2_ARRAY_TYPE?P2_ARRAY_TYPE:"undefined"!=typeof Float32Array?Float32Array:Array,s.extend=function(e,t){for(var i in t)e[i]=t[i]},s.defaults=function(e,t){e=e||{};for(var i in t)i in e||(e[i]=t[i]);return e}},{}],58:[function(e,t,i){function s(){this.equations=[],this.bodies=[]}var a=e("../objects/Body");t.exports=s,s.prototype.reset=function(){this.equations.length=this.bodies.length=0};var n=[];s.prototype.getBodies=function(e){var t=e||[],i=this.equations;n.length=0;for(var s=0;s!==i.length;s++){var a=i[s];-1===n.indexOf(a.bodyA.id)&&(t.push(a.bodyA),n.push(a.bodyA.id)),-1===n.indexOf(a.bodyB.id)&&(t.push(a.bodyB),n.push(a.bodyB.id))}return t},s.prototype.wantsToSleep=function(){for(var e=0;e<this.bodies.length;e++){var t=this.bodies[e];if(t.type===a.DYNAMIC&&!t.wantsToSleep)return!1}return!0},s.prototype.sleep=function(){for(var e=0;e<this.bodies.length;e++)this.bodies[e].sleep();return!0}},{"../objects/Body":31}],59:[function(e,t,i){function s(e){this.nodePool=new a({size:16}),this.islandPool=new n({size:8}),this.equations=[],this.islands=[],this.nodes=[],this.queue=[]}var a=(e("../math/vec2"),e("./Island"),e("./IslandNode"),e("./../utils/IslandNodePool")),n=e("./../utils/IslandPool"),o=e("../objects/Body");t.exports=s,s.getUnvisitedNode=function(e){for(var t=e.length,i=0;i!==t;i++){var s=e[i];if(!s.visited&&s.body.type===o.DYNAMIC)return s}return!1},s.prototype.visit=function(e,t,i){t.push(e.body);for(var s=e.equations.length,a=0;a!==s;a++){var n=e.equations[a];-1===i.indexOf(n)&&i.push(n)}},s.prototype.bfs=function(e,t,i){var a=this.queue;for(a.length=0,a.push(e),e.visited=!0,this.visit(e,t,i);a.length;)for(var n,r=a.pop();n=s.getUnvisitedNode(r.neighbors);)n.visited=!0,this.visit(n,t,i),n.body.type===o.DYNAMIC&&a.push(n)},s.prototype.split=function(e){for(var t=e.bodies,i=this.nodes,a=this.equations;i.length;)this.nodePool.release(i.pop());for(l=0;l!==t.length;l++){var n=this.nodePool.get();n.body=t[l],i.push(n)}for(var o=0;o!==a.length;o++){var r=a[o],l=t.indexOf(r.bodyA),h=t.indexOf(r.bodyB),c=i[l],p=i[h];c.neighbors.push(p),p.neighbors.push(c),c.equations.push(r),p.equations.push(r)}for(var d=this.islands,l=0;l<d.length;l++)this.islandPool.release(d[l]);d.length=0;for(var u;u=s.getUnvisitedNode(i);){var m=this.islandPool.get();this.bfs(u,m.bodies,m.equations),d.push(m)}return d}},{"../math/vec2":30,"../objects/Body":31,"./../utils/IslandNodePool":50,"./../utils/IslandPool":51,"./Island":58,"./IslandNode":60}],60:[function(e,t,i){function s(e){this.body=e,this.neighbors=[],this.equations=[],this.visited=!1}t.exports=s,s.prototype.reset=function(){this.equations.length=0,this.neighbors.length=0,this.visited=!1,this.body=null}},{}],61:[function(e,t,i){function s(e){p.apply(this),e=e||{},this.springs=[],this.bodies=[],this.disabledBodyCollisionPairs=[],this.solver=e.solver||new a,this.narrowphase=new b(this),this.islandManager=new f,this.gravity=n.fromValues(0,-9.78),e.gravity&&n.copy(this.gravity,e.gravity),this.frictionGravity=n.length(this.gravity)||10,this.useWorldGravityAsFrictionGravity=!0,this.useFrictionGravityOnZeroGravity=!0,this.broadphase=e.broadphase||new y,this.broadphase.setWorld(this),this.constraints=[],this.defaultMaterial=new u,this.defaultContactMaterial=new m(this.defaultMaterial,this.defaultMaterial),this.lastTimeStep=1/60,this.applySpringForces=!0,this.applyDamping=!0,this.applyGravity=!0,this.solveConstraints=!0,this.contactMaterials=[],this.time=0,this.accumulator=0,this.stepping=!1,this.bodiesToBeRemoved=[],this.islandSplit=void 0===e.islandSplit||!!e.islandSplit,this.emitImpactEvent=!0,this._constraintIdCounter=0,this._bodyIdCounter=0,this.postStepEvent={type:"postStep"},this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.addSpringEvent={type:"addSpring",spring:null},this.impactEvent={type:"impact",bodyA:null,bodyB:null,shapeA:null,shapeB:null,contactEquation:null},this.postBroadphaseEvent={type:"postBroadphase",pairs:null},this.sleepMode=s.NO_SLEEPING,this.beginContactEvent={type:"beginContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null,contactEquations:[]},this.endContactEvent={type:"endContact",shapeA:null,shapeB:null,bodyA:null,bodyB:null},this.preSolveEvent={type:"preSolve",contactEquations:null,frictionEquations:null},this.overlappingShapesLastState={keys:[]},this.overlappingShapesCurrentState={keys:[]},this.overlapKeeper=new v}var a=e("../solver/GSSolver"),n=(e("../solver/Solver"),e("../collision/Ray"),e("../math/vec2")),o=e("../shapes/Circle"),r=e("../shapes/Convex"),l=(e("../shapes/Line"),e("../shapes/Plane")),h=e("../shapes/Capsule"),c=e("../shapes/Particle"),p=e("../events/EventEmitter"),d=e("../objects/Body"),u=(e("../shapes/Shape"),e("../objects/LinearSpring"),e("../material/Material")),m=e("../material/ContactMaterial"),g=(e("../constraints/DistanceConstraint"),e("../constraints/Constraint"),e("../constraints/LockConstraint"),e("../constraints/RevoluteConstraint"),e("../constraints/PrismaticConstraint"),e("../constraints/GearConstraint"),e("../../package.json"),e("../collision/Broadphase"),e("../collision/AABB")),y=e("../collision/SAPBroadphase"),b=e("../collision/Narrowphase"),x=e("../utils/Utils"),v=e("../utils/OverlapKeeper"),f=e("./IslandManager");e("../objects/RotationalSpring"),t.exports=s,s.prototype=new Object(p.prototype),s.prototype.constructor=s,s.NO_SLEEPING=1,s.BODY_SLEEPING=2,s.ISLAND_SLEEPING=4,s.prototype.addConstraint=function(e){this.constraints.push(e)},s.prototype.addContactMaterial=function(e){this.contactMaterials.push(e)},s.prototype.removeContactMaterial=function(e){var t=this.contactMaterials.indexOf(e);-1!==t&&x.splice(this.contactMaterials,t,1)},s.prototype.getContactMaterial=function(e,t){for(var i=this.contactMaterials,s=0,a=i.length;s!==a;s++){var n=i[s];if(n.materialA.id===e.id&&n.materialB.id===t.id||n.materialA.id===t.id&&n.materialB.id===e.id)return n}return!1},s.prototype.removeConstraint=function(e){var t=this.constraints.indexOf(e);-1!==t&&x.splice(this.constraints,t,1)};var w=(n.create(),n.create(),n.create(),n.create(),n.create(),n.create(),n.create()),k=n.fromValues(0,0),_=n.fromValues(0,0);n.fromValues(0,0),n.fromValues(0,0),s.prototype.step=function(e,t,i){if(i=i||10,0===(t=t||0))this.internalStep(e),this.time+=e;else{this.accumulator+=t;for(var s=0;this.accumulator>=e&&s<i;)this.internalStep(e),this.time+=e,this.accumulator-=e,s++;for(var a=this.accumulator%e/e,o=0;o!==this.bodies.length;o++){var r=this.bodies[o];n.lerp(r.interpolatedPosition,r.previousPosition,r.position,a),r.interpolatedAngle=r.previousAngle+a*(r.angle-r.previousAngle)}}};var S=[];s.prototype.internalStep=function(e){this.stepping=!0;var t=this.springs.length,i=this.springs,a=this.bodies,o=this.gravity,r=this.solver,l=this.bodies.length,h=this.broadphase,c=this.narrowphase,p=this.constraints,u=w,m=(n.scale,n.add),g=(n.rotate,this.islandManager);if(this.overlapKeeper.tick(),this.lastTimeStep=e,this.useWorldGravityAsFrictionGravity){var y=n.length(this.gravity);0===y&&this.useFrictionGravityOnZeroGravity||(this.frictionGravity=y)}if(this.applyGravity)for(_=0;_!==l;_++){var b=(v=a[_]).force;v.type===d.DYNAMIC&&v.sleepState!==d.SLEEPING&&(n.scale(u,o,v.mass*v.gravityScale),m(b,b,u))}if(this.applySpringForces)for(_=0;_!==t;_++)i[_].applyForce();if(this.applyDamping)for(_=0;_!==l;_++){var v=a[_];v.type===d.DYNAMIC&&v.applyDamping(e)}for(var f=h.getCollisionPairs(this),k=this.disabledBodyCollisionPairs,_=k.length-2;_>=0;_-=2)for(A=f.length-2;A>=0;A-=2)(k[_]===f[A]&&k[_+1]===f[A+1]||k[_+1]===f[A]&&k[_]===f[A+1])&&f.splice(A,2);J=p.length;for(_=0;_!==J;_++){var M=p[_];if(!M.collideConnected)for(var A=f.length-2;A>=0;A-=2)(M.bodyA===f[A]&&M.bodyB===f[A+1]||M.bodyB===f[A]&&M.bodyA===f[A+1])&&f.splice(A,2)}this.postBroadphaseEvent.pairs=f,this.emit(this.postBroadphaseEvent),this.postBroadphaseEvent.pairs=null,c.reset(this);for(var _=0,C=f.length;_!==C;_+=2)for(var P=f[_],T=f[_+1],X=0,Y=P.shapes.length;X!==Y;X++)for(var G=P.shapes[X],B=G.position,L=G.angle,E=0,R=T.shapes.length;E!==R;E++){var D=T.shapes[E],F=D.position,I=D.angle,V=this.defaultContactMaterial;if(G.material&&D.material){var W=this.getContactMaterial(G.material,D.material);W&&(V=W)}this.runNarrowphase(c,P,G,B,L,T,D,F,I,V,this.frictionGravity)}for(_=0;_!==l;_++)(q=a[_])._wakeUpAfterNarrowphase&&(q.wakeUp(),q._wakeUpAfterNarrowphase=!1);if(this.has("endContact")){this.overlapKeeper.getEndOverlaps(S);for(var O=this.endContactEvent,E=S.length;E--;){var N=S[E];O.shapeA=N.shapeA,O.shapeB=N.shapeB,O.bodyA=N.bodyA,O.bodyB=N.bodyB,this.emit(O)}S.length=0}var U=this.preSolveEvent;U.contactEquations=c.contactEquations,U.frictionEquations=c.frictionEquations,this.emit(U),U.contactEquations=U.frictionEquations=null;var J=p.length;for(_=0;_!==J;_++)p[_].update();if(c.contactEquations.length||c.frictionEquations.length||J)if(this.islandSplit){for(g.equations.length=0,x.appendArray(g.equations,c.contactEquations),x.appendArray(g.equations,c.frictionEquations),_=0;_!==J;_++)x.appendArray(g.equations,p[_].equations);g.split(this);for(_=0;_!==g.islands.length;_++)(z=g.islands[_]).equations.length&&r.solveIsland(e,z)}else{for(r.addEquations(c.contactEquations),r.addEquations(c.frictionEquations),_=0;_!==J;_++)r.addEquations(p[_].equations);this.solveConstraints&&r.solve(e,this),r.removeAllEquations()}for(_=0;_!==l;_++){var q=a[_];q.integrate(e)}for(_=0;_!==l;_++)a[_].setZeroForce();if(this.emitImpactEvent&&this.has("impact"))for(var j=this.impactEvent,_=0;_!==c.contactEquations.length;_++){var H=c.contactEquations[_];H.firstImpact&&(j.bodyA=H.bodyA,j.bodyB=H.bodyB,j.shapeA=H.shapeA,j.shapeB=H.shapeB,j.contactEquation=H,this.emit(j))}if(this.sleepMode===s.BODY_SLEEPING)for(_=0;_!==l;_++)a[_].sleepTick(this.time,!1,e);else if(this.sleepMode===s.ISLAND_SLEEPING&&this.islandSplit){for(_=0;_!==l;_++)a[_].sleepTick(this.time,!0,e);for(_=0;_<this.islandManager.islands.length;_++){var z=this.islandManager.islands[_];z.wantsToSleep()&&z.sleep()}}this.stepping=!1;for(var K=this.bodiesToBeRemoved,_=0;_!==K.length;_++)this.removeBody(K[_]);K.length=0,this.emit(this.postStepEvent)},s.prototype.runNarrowphase=function(e,t,i,s,a,o,r,l,h,c,p){if(0!=(i.collisionGroup&r.collisionMask)&&0!=(r.collisionGroup&i.collisionMask)){n.rotate(k,s,t.angle),n.rotate(_,l,o.angle),n.add(k,k,t.position),n.add(_,_,o.position);var u=a+t.angle,m=h+o.angle;e.enableFriction=c.friction>0,e.frictionCoefficient=c.friction;var g;g=t.type===d.STATIC||t.type===d.KINEMATIC?o.mass:o.type===d.STATIC||o.type===d.KINEMATIC?t.mass:t.mass*o.mass/(t.mass+o.mass),e.slipForce=c.friction*p*g,e.restitution=c.restitution,e.surfaceVelocity=c.surfaceVelocity,e.frictionStiffness=c.frictionStiffness,e.frictionRelaxation=c.frictionRelaxation,e.stiffness=c.stiffness,e.relaxation=c.relaxation,e.contactSkinSize=c.contactSkinSize,e.enabledEquations=t.collisionResponse&&o.collisionResponse&&i.collisionResponse&&r.collisionResponse;var y=e[i.type|r.type],b=0;if(y){var x=i.sensor||r.sensor,v=e.frictionEquations.length;b=i.type<r.type?y.call(e,t,i,k,u,o,r,_,m,x):y.call(e,o,r,_,m,t,i,k,u,x);var f=e.frictionEquations.length-v;if(b){if(t.allowSleep&&t.type===d.DYNAMIC&&t.sleepState===d.SLEEPING&&o.sleepState===d.AWAKE&&o.type!==d.STATIC&&n.squaredLength(o.velocity)+Math.pow(o.angularVelocity,2)>=2*Math.pow(o.sleepSpeedLimit,2)&&(t._wakeUpAfterNarrowphase=!0),o.allowSleep&&o.type===d.DYNAMIC&&o.sleepState===d.SLEEPING&&t.sleepState===d.AWAKE&&t.type!==d.STATIC&&n.squaredLength(t.velocity)+Math.pow(t.angularVelocity,2)>=2*Math.pow(t.sleepSpeedLimit,2)&&(o._wakeUpAfterNarrowphase=!0),this.overlapKeeper.setOverlapping(t,i,o,r),this.has("beginContact")&&this.overlapKeeper.isNewOverlap(i,r)){var w=this.beginContactEvent;if(w.shapeA=i,w.shapeB=r,w.bodyA=t,w.bodyB=o,w.contactEquations.length=0,"number"==typeof b)for(S=e.contactEquations.length-b;S<e.contactEquations.length;S++)w.contactEquations.push(e.contactEquations[S]);this.emit(w)}if("number"==typeof b&&f>1)for(var S=e.frictionEquations.length-f;S<e.frictionEquations.length;S++){var M=e.frictionEquations[S];M.setSlipForce(M.getSlipForce()/f)}}}}},s.prototype.addSpring=function(e){this.springs.push(e);var t=this.addSpringEvent;t.spring=e,this.emit(t),t.spring=null},s.prototype.removeSpring=function(e){var t=this.springs.indexOf(e);-1!==t&&x.splice(this.springs,t,1)},s.prototype.addBody=function(e){if(-1===this.bodies.indexOf(e)){this.bodies.push(e),e.world=this;var t=this.addBodyEvent;t.body=e,this.emit(t),t.body=null}},s.prototype.removeBody=function(e){if(this.stepping)this.bodiesToBeRemoved.push(e);else{e.world=null;var t=this.bodies.indexOf(e);-1!==t&&(x.splice(this.bodies,t,1),this.removeBodyEvent.body=e,e.resetConstraintVelocity(),this.emit(this.removeBodyEvent),this.removeBodyEvent.body=null)}},s.prototype.getBodyById=function(e){for(var t=this.bodies,i=0;i<t.length;i++){var s=t[i];if(s.id===e)return s}return!1},s.prototype.disableBodyCollision=function(e,t){this.disabledBodyCollisionPairs.push(e,t)},s.prototype.enableBodyCollision=function(e,t){for(var i=this.disabledBodyCollisionPairs,s=0;s<i.length;s+=2)if(i[s]===e&&i[s+1]===t||i[s+1]===e&&i[s]===t)return void i.splice(s,2)},s.prototype.clear=function(){this.time=0,this.solver&&this.solver.equations.length&&this.solver.removeAllEquations();for(var e=this.constraints,t=e.length-1;t>=0;t--)this.removeConstraint(e[t]);for(var i=this.bodies,t=i.length-1;t>=0;t--)this.removeBody(i[t]);for(var a=this.springs,t=a.length-1;t>=0;t--)this.removeSpring(a[t]);for(var n=this.contactMaterials,t=n.length-1;t>=0;t--)this.removeContactMaterial(n[t]);s.apply(this)};var M=n.create(),A=(n.fromValues(0,0),n.fromValues(0,0));s.prototype.hitTest=function(e,t,i){i=i||0;var s=new d({position:e}),a=new c,p=e,u=M,m=A;s.addShape(a);for(var g=this.narrowphase,y=[],b=0,x=t.length;b!==x;b++)for(var v=t[b],f=0,w=v.shapes.length;f!==w;f++){var k=v.shapes[f];n.rotate(u,k.position,v.angle),n.add(u,u,v.position);var _=k.angle+v.angle;(k instanceof o&&g.circleParticle(v,k,u,_,s,a,p,0,!0)||k instanceof r&&g.particleConvex(s,a,p,0,v,k,u,_,!0)||k instanceof l&&g.particlePlane(s,a,p,0,v,k,u,_,!0)||k instanceof h&&g.particleCapsule(s,a,p,0,v,k,u,_,!0)||k instanceof c&&n.squaredLength(n.sub(m,u,e))<i*i)&&y.push(v)}return y},s.prototype.setGlobalStiffness=function(e){for(var t=this.constraints,i=0;i!==t.length;i++)for(var s=t[i],a=0;a!==s.equations.length;a++){var n=s.equations[a];n.stiffness=e,n.needsUpdate=!0}for(var o=this.contactMaterials,i=0;i!==o.length;i++)(s=o[i]).stiffness=s.frictionStiffness=e;(s=this.defaultContactMaterial).stiffness=s.frictionStiffness=e},s.prototype.setGlobalRelaxation=function(e){for(a=0;a!==this.constraints.length;a++)for(var t=this.constraints[a],i=0;i!==t.equations.length;i++){var s=t.equations[i];s.relaxation=e,s.needsUpdate=!0}for(var a=0;a!==this.contactMaterials.length;a++)(t=this.contactMaterials[a]).relaxation=t.frictionRelaxation=e;(t=this.defaultContactMaterial).relaxation=t.frictionRelaxation=e};var C=new g,P=[];s.prototype.raycast=function(e,t){return t.getAABB(C),this.broadphase.aabbQuery(this,C,P),t.intersectBodies(e,P),P.length=0,e.hasHit()}},{"../../package.json":6,"../collision/AABB":7,"../collision/Broadphase":8,"../collision/Narrowphase":10,"../collision/Ray":11,"../collision/SAPBroadphase":13,"../constraints/Constraint":14,"../constraints/DistanceConstraint":15,"../constraints/GearConstraint":16,"../constraints/LockConstraint":17,"../constraints/PrismaticConstraint":18,"../constraints/RevoluteConstraint":19,"../events/EventEmitter":26,"../material/ContactMaterial":27,"../material/Material":28,"../math/vec2":30,"../objects/Body":31,"../objects/LinearSpring":32,"../objects/RotationalSpring":33,"../shapes/Capsule":38,"../shapes/Circle":39,"../shapes/Convex":40,"../shapes/Line":42,"../shapes/Particle":43,"../shapes/Plane":44,"../shapes/Shape":45,"../solver/GSSolver":46,"../solver/Solver":47,"../utils/OverlapKeeper":52,"../utils/Utils":57,"./IslandManager":59}]},{},[36])(36)}),function(){var e=this,t=t||{};return t.game=null,t.WEBGL_RENDERER=0,t.CANVAS_RENDERER=1,t.VERSION="v2.2.9",t._UID=0,"undefined"!=typeof Float32Array?(t.Float32Array=Float32Array,t.Uint16Array=Uint16Array,t.Uint32Array=Uint32Array,t.ArrayBuffer=ArrayBuffer):(t.Float32Array=Array,t.Uint16Array=Array),t.PI_2=2*Math.PI,t.RAD_TO_DEG=180/Math.PI,t.DEG_TO_RAD=Math.PI/180,t.RETINA_PREFIX="@2x",t.DisplayObject=function(){this.position=new t.Point(0,0),this.scale=new t.Point(1,1),this.pivot=new t.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.hitArea=null,this.renderable=!1,this.parent=null,this.worldAlpha=1,this.worldTransform=new t.Matrix,this.worldPosition=new t.Point(0,0),this.worldScale=new t.Point(1,1),this.worldRotation=0,this.filterArea=null,this._sr=0,this._cr=1,this._bounds=new t.Rectangle(0,0,0,0),this._currentBounds=null,this._mask=null,this._cacheAsBitmap=!1,this._cacheIsDirty=!1},t.DisplayObject.prototype.constructor=t.DisplayObject,t.DisplayObject.prototype={destroy:function(){if(this.children){for(var e=this.children.length;e--;)this.children[e].destroy();this.children=[]}this.hitArea=null,this.parent=null,this.worldTransform=null,this.filterArea=null,this.renderable=!1,this._bounds=null,this._currentBounds=null,this._mask=null,this._destroyCachedSprite()},updateTransform:function(e){if(!e&&!this.parent&&!this.game)return this;var i=this.parent;e?i=e:this.parent||(i=this.game.world);var s,a,n,o,r,l,h=i.worldTransform,c=this.worldTransform;return this.rotation%t.PI_2?(this.rotation!==this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation)),s=this._cr*this.scale.x,a=this._sr*this.scale.x,n=-this._sr*this.scale.y,o=this._cr*this.scale.y,r=this.position.x,l=this.position.y,(this.pivot.x||this.pivot.y)&&(r-=this.pivot.x*s+this.pivot.y*n,l-=this.pivot.x*a+this.pivot.y*o),c.a=s*h.a+a*h.c,c.b=s*h.b+a*h.d,c.c=n*h.a+o*h.c,c.d=n*h.b+o*h.d,c.tx=r*h.a+l*h.c+h.tx,c.ty=r*h.b+l*h.d+h.ty):(s=this.scale.x,o=this.scale.y,r=this.position.x-this.pivot.x*s,l=this.position.y-this.pivot.y*o,c.a=s*h.a,c.b=s*h.b,c.c=o*h.c,c.d=o*h.d,c.tx=r*h.a+l*h.c+h.tx,c.ty=r*h.b+l*h.d+h.ty),this.worldAlpha=this.alpha*i.worldAlpha,this.worldPosition.set(c.tx,c.ty),this.worldScale.set(this.scale.x*Math.sqrt(c.a*c.a+c.c*c.c),this.scale.y*Math.sqrt(c.b*c.b+c.d*c.d)),this.worldRotation=Math.atan2(-c.c,c.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,c,h),this},preUpdate:function(){},generateTexture:function(e,i,s){var a=this.getLocalBounds(),n=new t.RenderTexture(0|a.width,0|a.height,s,i,e);return t.DisplayObject._tempMatrix.tx=-a.x,t.DisplayObject._tempMatrix.ty=-a.y,n.render(this,t.DisplayObject._tempMatrix),n},updateCache:function(){return this._generateCachedSprite(),this},toGlobal:function(e){return this.updateTransform(),this.worldTransform.apply(e)},toLocal:function(e,t){return t&&(e=t.toGlobal(e)),this.updateTransform(),this.worldTransform.applyInverse(e)},_renderCachedSprite:function(e){this._cachedSprite.worldAlpha=this.worldAlpha,e.gl?t.Sprite.prototype._renderWebGL.call(this._cachedSprite,e):t.Sprite.prototype._renderCanvas.call(this._cachedSprite,e)},_generateCachedSprite:function(){this._cacheAsBitmap=!1;var e=this.getLocalBounds();if(e.width=Math.max(1,Math.ceil(e.width)),e.height=Math.max(1,Math.ceil(e.height)),this.updateTransform(),this._cachedSprite)this._cachedSprite.texture.resize(e.width,e.height);else{var i=new t.RenderTexture(e.width,e.height);this._cachedSprite=new t.Sprite(i),this._cachedSprite.worldTransform=this.worldTransform}var s=this._filters;this._filters=null,this._cachedSprite.filters=s,t.DisplayObject._tempMatrix.tx=-e.x,t.DisplayObject._tempMatrix.ty=-e.y,this._cachedSprite.texture.render(this,t.DisplayObject._tempMatrix,!0),this._cachedSprite.anchor.x=-e.x/e.width,this._cachedSprite.anchor.y=-e.y/e.height,this._filters=s,this._cacheAsBitmap=!0},_destroyCachedSprite:function(){this._cachedSprite&&(this._cachedSprite.texture.destroy(!0),this._cachedSprite=null)}},t.DisplayObject.prototype.displayObjectUpdateTransform=t.DisplayObject.prototype.updateTransform,Object.defineProperties(t.DisplayObject.prototype,{x:{get:function(){return this.position.x},set:function(e){this.position.x=e}},y:{get:function(){return this.position.y},set:function(e){this.position.y=e}},worldVisible:{get:function(){if(this.visible){var e=this.parent;if(!e)return this.visible;do{if(!e.visible)return!1;e=e.parent}while(e);return!0}return!1}},mask:{get:function(){return this._mask},set:function(e){this._mask&&(this._mask.isMask=!1),this._mask=e,e&&(this._mask.isMask=!0)}},filters:{get:function(){return this._filters},set:function(e){if(Array.isArray(e)){for(var i=[],s=0;s<e.length;s++)for(var a=e[s].passes,n=0;n<a.length;n++)i.push(a[n]);this._filterBlock={target:this,filterPasses:i}}this._filters=e,this.blendMode&&this.blendMode===t.blendModes.MULTIPLY&&(this.blendMode=t.blendModes.NORMAL)}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap!==e&&(e?this._generateCachedSprite():this._destroyCachedSprite(),this._cacheAsBitmap=e)}}}),t.DisplayObjectContainer=function(){t.DisplayObject.call(this),this.children=[],this.ignoreChildInput=!1},t.DisplayObjectContainer.prototype=Object.create(t.DisplayObject.prototype),t.DisplayObjectContainer.prototype.constructor=t.DisplayObjectContainer,t.DisplayObjectContainer.prototype.addChild=function(e){return this.addChildAt(e,this.children.length)},t.DisplayObjectContainer.prototype.addChildAt=function(e,t){if(t>=0&&t<=this.children.length)return e.parent&&e.parent.removeChild(e),e.parent=this,this.children.splice(t,0,e),e;throw new Error(e+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length)},t.DisplayObjectContainer.prototype.swapChildren=function(e,t){if(e!==t){var i=this.getChildIndex(e),s=this.getChildIndex(t);if(i<0||s<0)throw new Error("swapChildren: Both the supplied DisplayObjects must be a child of the caller.");this.children[i]=t,this.children[s]=e}},t.DisplayObjectContainer.prototype.getChildIndex=function(e){var t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t},t.DisplayObjectContainer.prototype.setChildIndex=function(e,t){if(t<0||t>=this.children.length)throw new Error("The supplied index is out of bounds");var i=this.getChildIndex(e);this.children.splice(i,1),this.children.splice(t,0,e)},t.DisplayObjectContainer.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Supplied index "+e+" does not exist in the child list, or the supplied DisplayObject must be a child of the caller");return this.children[e]},t.DisplayObjectContainer.prototype.removeChild=function(e){var t=this.children.indexOf(e);if(-1!==t)return this.removeChildAt(t)},t.DisplayObjectContainer.prototype.removeChildAt=function(e){var t=this.getChildAt(e);return t&&(t.parent=void 0,this.children.splice(e,1)),t},t.DisplayObjectContainer.prototype.removeChildren=function(e,t){void 0===e&&(e=0),void 0===t&&(t=this.children.length);var i=t-e;if(i>0&&i<=t){for(var s=this.children.splice(begin,i),a=0;a<s.length;a++)s[a].parent=void 0;return s}if(0===i&&0===this.children.length)return[];throw new Error("removeChildren: Range Error, numeric values are outside the acceptable range")},t.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible&&(this.displayObjectUpdateTransform(),!this._cacheAsBitmap))for(var e=0;e<this.children.length;e++)this.children[e].updateTransform()},t.DisplayObjectContainer.prototype.displayObjectContainerUpdateTransform=t.DisplayObjectContainer.prototype.updateTransform,t.DisplayObjectContainer.prototype.getBounds=function(e){var i=e&&e instanceof t.DisplayObject,s=!0;i?s=e instanceof t.DisplayObjectContainer&&e.contains(this):e=this;var a;if(i){var n=e.worldTransform;for(e.worldTransform=t.identityMatrix,a=0;a<e.children.length;a++)e.children[a].updateTransform()}var o,r,l,h=1/0,c=1/0,p=-1/0,d=-1/0,u=!1;for(a=0;a<this.children.length;a++)this.children[a].visible&&(u=!0,o=this.children[a].getBounds(),h=h<o.x?h:o.x,c=c<o.y?c:o.y,r=o.width+o.x,l=o.height+o.y,p=p>r?p:r,d=d>l?d:l);var m=this._bounds;if(!u){var g=(m=new t.Rectangle).x,y=m.width+m.x,b=m.y,x=m.height+m.y,v=this.worldTransform,f=v.a,w=v.b,k=v.c,_=v.d,S=v.tx,M=v.ty,A=f*y+k*x+S,C=_*x+w*y+M,P=f*g+k*x+S,T=_*x+w*g+M,X=f*g+k*b+S,Y=_*b+w*g+M,G=f*y+k*b+S,B=_*b+w*y+M;p=A,d=C,c=C,h=G<(h=X<(h=P<(h=A)?P:h)?X:h)?G:h,c=B<(c=Y<(c=T<c?T:c)?Y:c)?B:c,p=G>(p=X>(p=P>p?P:p)?X:p)?G:p,d=B>(d=Y>(d=T>d?T:d)?Y:d)?B:d}if(m.x=h,m.y=c,m.width=p-h,m.height=d-c,i)for(e.worldTransform=n,a=0;a<e.children.length;a++)e.children[a].updateTransform();if(!s){var L=e.getBounds();m.x-=L.x,m.y-=L.y}return m},t.DisplayObjectContainer.prototype.getLocalBounds=function(){return this.getBounds(this)},t.DisplayObjectContainer.prototype.contains=function(e){return!!e&&(e===this||this.contains(e.parent))},t.DisplayObjectContainer.prototype._renderWebGL=function(e){if(this.visible&&!(this.alpha<=0)){if(this._cacheAsBitmap)return void this._renderCachedSprite(e);var t;if(this._mask||this._filters){for(this._filters&&(e.spriteBatch.flush(),e.filterManager.pushFilter(this._filterBlock)),this._mask&&(e.spriteBatch.stop(),e.maskManager.pushMask(this.mask,e),e.spriteBatch.start()),t=0;t<this.children.length;t++)this.children[t]._renderWebGL(e);e.spriteBatch.stop(),this._mask&&e.maskManager.popMask(this._mask,e),this._filters&&e.filterManager.popFilter(),e.spriteBatch.start()}else for(t=0;t<this.children.length;t++)this.children[t]._renderWebGL(e)}},t.DisplayObjectContainer.prototype._renderCanvas=function(e){if(!1!==this.visible&&0!==this.alpha){if(this._cacheAsBitmap)return void this._renderCachedSprite(e);this._mask&&e.maskManager.pushMask(this._mask,e);for(var t=0;t<this.children.length;t++)this.children[t]._renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},Object.defineProperty(t.DisplayObjectContainer.prototype,"width",{get:function(){return this.getLocalBounds().width*this.scale.x},set:function(e){var t=this.getLocalBounds().width;this.scale.x=0!==t?e/t:1,this._width=e}}),Object.defineProperty(t.DisplayObjectContainer.prototype,"height",{get:function(){return this.getLocalBounds().height*this.scale.y},set:function(e){var t=this.getLocalBounds().height;this.scale.y=0!==t?e/t:1,this._height=e}}),t.Sprite=function(e){t.DisplayObjectContainer.call(this),this.anchor=new t.Point,this.texture=e||t.Texture.emptyTexture,this._width=0,this._height=0,this.tint=16777215,this.cachedTint=-1,this.tintedTexture=null,this.blendMode=t.blendModes.NORMAL,this.shader=null,this.exists=!0,this.texture.baseTexture.hasLoaded&&this.onTextureUpdate(),this.renderable=!0},t.Sprite.prototype=Object.create(t.DisplayObjectContainer.prototype),t.Sprite.prototype.constructor=t.Sprite,Object.defineProperty(t.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(e){this.scale.x=e/this.texture.frame.width,this._width=e}}),Object.defineProperty(t.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(e){this.scale.y=e/this.texture.frame.height,this._height=e}}),t.Sprite.prototype.setTexture=function(e,t){void 0!==t&&this.texture.baseTexture.destroy(),this.texture.baseTexture.skipRender=!1,this.texture=e,this.texture.valid=!0,this.cachedTint=-1},t.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height)},t.Sprite.prototype.getBounds=function(e){var t=this.texture.frame.width,i=this.texture.frame.height,s=t*(1-this.anchor.x),a=t*-this.anchor.x,n=i*(1-this.anchor.y),o=i*-this.anchor.y,r=e||this.worldTransform,l=r.a,h=r.b,c=r.c,p=r.d,d=r.tx,u=r.ty,m=-1/0,g=-1/0,y=1/0,b=1/0;if(0===h&&0===c){if(l<0){l*=-1;x=s;s=-a,a=-x}if(p<0){p*=-1;var x=n;n=-o,o=-x}y=l*a+d,m=l*s+d,b=p*o+u,g=p*n+u}else{var v=l*a+c*o+d,f=p*o+h*a+u,w=l*s+c*o+d,k=p*o+h*s+u,_=l*s+c*n+d,S=p*n+h*s+u,M=l*a+c*n+d,A=p*n+h*a+u;y=M<(y=_<(y=w<(y=v<y?v:y)?w:y)?_:y)?M:y,b=A<(b=S<(b=k<(b=f<b?f:b)?k:b)?S:b)?A:b,m=M>(m=_>(m=w>(m=v>m?v:m)?w:m)?_:m)?M:m,g=A>(g=S>(g=k>(g=f>g?f:g)?k:g)?S:g)?A:g}var C=this._bounds;return C.x=y,C.width=m-y,C.y=b,C.height=g-b,this._currentBounds=C,C},t.Sprite.prototype.getLocalBounds=function(){var e=this.worldTransform;this.worldTransform=t.identityMatrix;for(var i=0;i<this.children.length;i++)this.children[i].updateTransform();var s=this.getBounds();for(this.worldTransform=e,i=0;i<this.children.length;i++)this.children[i].updateTransform();return s},t.Sprite.prototype._renderWebGL=function(e,t){if(this.visible&&!(this.alpha<=0)&&this.renderable){var i=this.worldTransform;if(t&&(i=t),this._mask||this._filters){var s=e.spriteBatch;this._filters&&(s.flush(),e.filterManager.pushFilter(this._filterBlock)),this._mask&&(s.stop(),e.maskManager.pushMask(this.mask,e),s.start()),s.render(this);for(a=0;a<this.children.length;a++)this.children[a]._renderWebGL(e);s.stop(),this._mask&&e.maskManager.popMask(this._mask,e),this._filters&&e.filterManager.popFilter(),s.start()}else{e.spriteBatch.render(this);for(var a=0;a<this.children.length;a++)this.children[a]._renderWebGL(e,i)}}},t.Sprite.prototype._renderCanvas=function(e,i){if(!(!this.visible||0===this.alpha||!this.renderable||this.texture.crop.width<=0||this.texture.crop.height<=0)){var s=this.worldTransform;if(i&&(s=i),this.blendMode!==e.currentBlendMode&&(e.currentBlendMode=this.blendMode,e.context.globalCompositeOperation=t.blendModesCanvas[e.currentBlendMode]),this._mask&&e.maskManager.pushMask(this._mask,e),this.texture.valid){var a=this.texture.baseTexture.resolution/e.resolution;e.context.globalAlpha=this.worldAlpha,e.smoothProperty&&e.scaleMode!==this.texture.baseTexture.scaleMode&&(e.scaleMode=this.texture.baseTexture.scaleMode,e.context[e.smoothProperty]=e.scaleMode===t.scaleModes.LINEAR);var n=this.texture.trim?this.texture.trim.x-this.anchor.x*this.texture.trim.width:this.anchor.x*-this.texture.frame.width,o=this.texture.trim?this.texture.trim.y-this.anchor.y*this.texture.trim.height:this.anchor.y*-this.texture.frame.height,r=s.tx*e.resolution+e.shakeX,l=s.ty*e.resolution+e.shakeY;e.roundPixels?(e.context.setTransform(s.a,s.b,s.c,s.d,0|r,0|l),n|=0,o|=0):e.context.setTransform(s.a,s.b,s.c,s.d,r,l);var h=this.texture.crop.width,c=this.texture.crop.height;if(n/=a,o/=a,16777215!==this.tint)(this.texture.requiresReTint||this.cachedTint!==this.tint)&&(this.tintedTexture=t.CanvasTinter.getTintedTexture(this,this.tint),this.cachedTint=this.tint,this.texture.requiresReTint=!1),e.context.drawImage(this.tintedTexture,0,0,h,c,n,o,h/a,c/a);else{var p=this.texture.crop.x,d=this.texture.crop.y;e.context.drawImage(this.texture.baseTexture.source,p,d,h,c,n,o,h/a,c/a)}}for(var u=0;u<this.children.length;u++)this.children[u]._renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},t.SpriteBatch=function(e){t.DisplayObjectContainer.call(this),this.textureThing=e,this.ready=!1},t.SpriteBatch.prototype=Object.create(t.DisplayObjectContainer.prototype),t.SpriteBatch.prototype.constructor=t.SpriteBatch,t.SpriteBatch.prototype.initWebGL=function(e){this.fastSpriteBatch=new t.WebGLFastSpriteBatch(e),this.ready=!0},t.SpriteBatch.prototype.updateTransform=function(){this.displayObjectUpdateTransform()},t.SpriteBatch.prototype._renderWebGL=function(e){!this.visible||this.alpha<=0||!this.children.length||(this.ready||this.initWebGL(e.gl),this.fastSpriteBatch.gl!==e.gl&&this.fastSpriteBatch.setContext(e.gl),e.spriteBatch.stop(),e.shaderManager.setShader(e.shaderManager.fastShader),this.fastSpriteBatch.begin(this,e),this.fastSpriteBatch.render(this),e.spriteBatch.start())},t.SpriteBatch.prototype._renderCanvas=function(e){if(this.visible&&!(this.alpha<=0)&&this.children.length){var t=e.context;t.globalAlpha=this.worldAlpha,this.displayObjectUpdateTransform();for(var i=this.worldTransform,s=!0,a=0;a<this.children.length;a++){var n=this.children[a];if(n.visible){var o=n.texture,r=o.frame;if(t.globalAlpha=this.worldAlpha*n.alpha,n.rotation%(2*Math.PI)==0)s&&(t.setTransform(i.a,i.b,i.c,i.d,i.tx,i.ty),s=!1),t.drawImage(o.baseTexture.source,r.x,r.y,r.width,r.height,n.anchor.x*(-r.width*n.scale.x)+n.position.x+.5+e.shakeX|0,n.anchor.y*(-r.height*n.scale.y)+n.position.y+.5+e.shakeY|0,r.width*n.scale.x,r.height*n.scale.y);else{s||(s=!0),n.displayObjectUpdateTransform();var l=n.worldTransform,h=l.tx*e.resolution+e.shakeX,c=l.ty*e.resolution+e.shakeY;e.roundPixels?t.setTransform(l.a,l.b,l.c,l.d,0|h,0|c):t.setTransform(l.a,l.b,l.c,l.d,h,c),t.drawImage(o.baseTexture.source,r.x,r.y,r.width,r.height,n.anchor.x*-r.width+.5|0,n.anchor.y*-r.height+.5|0,r.width,r.height)}}}}},t.hex2rgb=function(e){return[(e>>16&255)/255,(e>>8&255)/255,(255&e)/255]},t.rgb2hex=function(e){return(255*e[0]<<16)+(255*e[1]<<8)+255*e[2]},t.canUseNewCanvasBlendModes=function(){if(void 0===document)return!1;var e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAABAQMAAADD8p2OAAAAA1BMVEX/",i="AAAACklEQVQI12NgAAAAAgAB4iG8MwAAAABJRU5ErkJggg==",s=new Image;s.src=e+"AP804Oa6"+i;var a=new Image;a.src=e+"/wCKxvRF"+i;var n=t.CanvasPool.create(this,6,1).getContext("2d");if(n.globalCompositeOperation="multiply",n.drawImage(s,0,0),n.drawImage(a,2,0),!n.getImageData(2,0,1,1))return!1;var o=n.getImageData(2,0,1,1).data;return t.CanvasPool.remove(this),255===o[0]&&0===o[1]&&0===o[2]},t.getNextPowerOfTwo=function(e){if(e>0&&0==(e&e-1))return e;for(var t=1;t<e;)t<<=1;return t},t.isPowerOfTwo=function(e,t){return e>0&&0==(e&e-1)&&t>0&&0==(t&t-1)},t.CanvasPool={create:function(e,i,s){var a,n=t.CanvasPool.getFirst();if(-1===n){var o={parent:e,canvas:document.createElement("canvas")};t.CanvasPool.pool.push(o),a=o.canvas}else t.CanvasPool.pool[n].parent=e,a=t.CanvasPool.pool[n].canvas;return void 0!==i&&(a.width=i,a.height=s),a},getFirst:function(){for(var e=t.CanvasPool.pool,i=0;i<e.length;i++)if(!e[i].parent)return i;return-1},remove:function(e){for(var i=t.CanvasPool.pool,s=0;s<i.length;s++)i[s].parent===e&&(i[s].parent=null,i[s].canvas.width=1,i[s].canvas.height=1)},removeByCanvas:function(e){for(var i=t.CanvasPool.pool,s=0;s<i.length;s++)i[s].canvas===e&&(i[s].parent=null,i[s].canvas.width=1,i[s].canvas.height=1)},getTotal:function(){for(var e=t.CanvasPool.pool,i=0,s=0;s<e.length;s++)e[s].parent&&i++;return i},getFree:function(){for(var e=t.CanvasPool.pool,i=0,s=0;s<e.length;s++)e[s].parent||i++;return i}},t.CanvasPool.pool=[],t.initDefaultShaders=function(){},t.CompileVertexShader=function(e,i){return t._CompileShader(e,i,e.VERTEX_SHADER)},t.CompileFragmentShader=function(e,i){return t._CompileShader(e,i,e.FRAGMENT_SHADER)},t._CompileShader=function(e,t,i){var s=t;Array.isArray(t)&&(s=t.join("\n"));var a=e.createShader(i);return e.shaderSource(a,s),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(window.console.log(e.getShaderInfoLog(a)),null)},t.compileProgram=function(e,i,s){var a=t.CompileFragmentShader(e,s),n=t.CompileVertexShader(e,i),o=e.createProgram();return e.attachShader(o,n),e.attachShader(o,a),e.linkProgram(o),e.getProgramParameter(o,e.LINK_STATUS)||(window.console.log(e.getProgramInfoLog(o)),window.console.log("Could not initialise shaders")),o},t.PixiShader=function(e){this._UID=t._UID++,this.gl=e,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.textureCount=0,this.firstRun=!0,this.dirty=!0,this.attributes=[],this.init()},t.PixiShader.prototype.constructor=t.PixiShader,t.PixiShader.prototype.init=function(){var e=this.gl,i=t.compileProgram(e,this.vertexSrc||t.PixiShader.defaultVertexSrc,this.fragmentSrc);e.useProgram(i),this.uSampler=e.getUniformLocation(i,"uSampler"),this.projectionVector=e.getUniformLocation(i,"projectionVector"),this.offsetVector=e.getUniformLocation(i,"offsetVector"),this.dimensions=e.getUniformLocation(i,"dimensions"),this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=e.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=e.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var s in this.uniforms)this.uniforms[s].uniformLocation=e.getUniformLocation(i,s);this.initUniforms(),this.program=i},t.PixiShader.prototype.initUniforms=function(){this.textureCount=1;var e,t=this.gl;for(var i in this.uniforms){var s=(e=this.uniforms[i]).type;"sampler2D"===s?(e._init=!1,null!==e.value&&this.initSampler2D(e)):"mat2"===s||"mat3"===s||"mat4"===s?(e.glMatrix=!0,e.glValueLength=1,"mat2"===s?e.glFunc=t.uniformMatrix2fv:"mat3"===s?e.glFunc=t.uniformMatrix3fv:"mat4"===s&&(e.glFunc=t.uniformMatrix4fv)):(e.glFunc=t["uniform"+s],e.glValueLength="2f"===s||"2i"===s?2:"3f"===s||"3i"===s?3:"4f"===s||"4i"===s?4:1)}},t.PixiShader.prototype.initSampler2D=function(e){if(e.value&&e.value.baseTexture&&e.value.baseTexture.hasLoaded){var t=this.gl;if(t.activeTexture(t["TEXTURE"+this.textureCount]),t.bindTexture(t.TEXTURE_2D,e.value.baseTexture._glTextures[t.id]),e.textureData){var i=e.textureData,s=i.magFilter?i.magFilter:t.LINEAR,a=i.minFilter?i.minFilter:t.LINEAR,n=i.wrapS?i.wrapS:t.CLAMP_TO_EDGE,o=i.wrapT?i.wrapT:t.CLAMP_TO_EDGE,r=i.luminance?t.LUMINANCE:t.RGBA;if(i.repeat&&(n=t.REPEAT,o=t.REPEAT),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!!i.flipY),i.width){var l=i.width?i.width:512,h=i.height?i.height:2,c=i.border?i.border:0;t.texImage2D(t.TEXTURE_2D,0,r,l,h,c,r,t.UNSIGNED_BYTE,null)}else t.texImage2D(t.TEXTURE_2D,0,r,t.RGBA,t.UNSIGNED_BYTE,e.value.baseTexture.source);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,s),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,a),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,o)}t.uniform1i(e.uniformLocation,this.textureCount),e._init=!0,this.textureCount++}},t.PixiShader.prototype.syncUniforms=function(){this.textureCount=1;var e,i=this.gl;for(var s in this.uniforms)1===(e=this.uniforms[s]).glValueLength?!0===e.glMatrix?e.glFunc.call(i,e.uniformLocation,e.transpose,e.value):e.glFunc.call(i,e.uniformLocation,e.value):2===e.glValueLength?e.glFunc.call(i,e.uniformLocation,e.value.x,e.value.y):3===e.glValueLength?e.glFunc.call(i,e.uniformLocation,e.value.x,e.value.y,e.value.z):4===e.glValueLength?e.glFunc.call(i,e.uniformLocation,e.value.x,e.value.y,e.value.z,e.value.w):"sampler2D"===e.type&&(e._init?(i.activeTexture(i["TEXTURE"+this.textureCount]),e.value.baseTexture._dirty[i.id]?t.instances[i.id].updateTexture(e.value.baseTexture):i.bindTexture(i.TEXTURE_2D,e.value.baseTexture._glTextures[i.id]),i.uniform1i(e.uniformLocation,this.textureCount),this.textureCount++):this.initSampler2D(e))},t.PixiShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},t.PixiShader.defaultVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute vec4 aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","varying vec4 vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   gl_Position = vec4( ((aVertexPosition + offsetVector) / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = vec4(aColor.rgb * aColor.a, aColor.a);","}"],t.PixiFastShader=function(e){this._UID=t._UID++,this.gl=e,this.program=null,this.fragmentSrc=["precision lowp float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aPositionCoord;","attribute vec2 aScale;","attribute float aRotation;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform mat3 uMatrix;","varying vec2 vTextureCoord;","varying float vColor;","const vec2 center = vec2(-1.0, 1.0);","void main(void) {","   vec2 v;","   vec2 sv = aVertexPosition * aScale;","   v.x = (sv.x) * cos(aRotation) - (sv.y) * sin(aRotation);","   v.y = (sv.x) * sin(aRotation) + (sv.y) * cos(aRotation);","   v = ( uMatrix * vec3(v + aPositionCoord , 1.0) ).xy ;","   gl_Position = vec4( ( v / projectionVector) + center , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","   vColor = aColor;","}"],this.textureCount=0,this.init()},t.PixiFastShader.prototype.constructor=t.PixiFastShader,t.PixiFastShader.prototype.init=function(){var e=this.gl,i=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(i),this.uSampler=e.getUniformLocation(i,"uSampler"),this.projectionVector=e.getUniformLocation(i,"projectionVector"),this.offsetVector=e.getUniformLocation(i,"offsetVector"),this.dimensions=e.getUniformLocation(i,"dimensions"),this.uMatrix=e.getUniformLocation(i,"uMatrix"),this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition"),this.aPositionCoord=e.getAttribLocation(i,"aPositionCoord"),this.aScale=e.getAttribLocation(i,"aScale"),this.aRotation=e.getAttribLocation(i,"aRotation"),this.aTextureCoord=e.getAttribLocation(i,"aTextureCoord"),this.colorAttribute=e.getAttribLocation(i,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aPositionCoord,this.aScale,this.aRotation,this.aTextureCoord,this.colorAttribute],this.program=i},t.PixiFastShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},t.StripShader=function(e){this._UID=t._UID++,this.gl=e,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform float alpha;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y)) * alpha;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","varying vec2 vTextureCoord;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, v.y / -projectionVector.y + 1.0 , 0.0, 1.0);","   vTextureCoord = aTextureCoord;","}"],this.init()},t.StripShader.prototype.constructor=t.StripShader,t.StripShader.prototype.init=function(){var e=this.gl,i=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(i),this.uSampler=e.getUniformLocation(i,"uSampler"),this.projectionVector=e.getUniformLocation(i,"projectionVector"),this.offsetVector=e.getUniformLocation(i,"offsetVector"),this.colorAttribute=e.getAttribLocation(i,"aColor"),this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition"),this.aTextureCoord=e.getAttribLocation(i,"aTextureCoord"),this.attributes=[this.aVertexPosition,this.aTextureCoord],this.translationMatrix=e.getUniformLocation(i,"translationMatrix"),this.alpha=e.getUniformLocation(i,"alpha"),this.program=i},t.StripShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},t.PrimitiveShader=function(e){this._UID=t._UID++,this.gl=e,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","attribute vec4 aColor;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform float alpha;","uniform float flipY;","uniform vec3 tint;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = aColor * vec4(tint * alpha, alpha);","}"],this.init()},t.PrimitiveShader.prototype.constructor=t.PrimitiveShader,t.PrimitiveShader.prototype.init=function(){var e=this.gl,i=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(i),this.projectionVector=e.getUniformLocation(i,"projectionVector"),this.offsetVector=e.getUniformLocation(i,"offsetVector"),this.tintColor=e.getUniformLocation(i,"tint"),this.flipY=e.getUniformLocation(i,"flipY"),this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition"),this.colorAttribute=e.getAttribLocation(i,"aColor"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=e.getUniformLocation(i,"translationMatrix"),this.alpha=e.getUniformLocation(i,"alpha"),this.program=i},t.PrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attributes=null},t.ComplexPrimitiveShader=function(e){this._UID=t._UID++,this.gl=e,this.program=null,this.fragmentSrc=["precision mediump float;","varying vec4 vColor;","void main(void) {","   gl_FragColor = vColor;","}"],this.vertexSrc=["attribute vec2 aVertexPosition;","uniform mat3 translationMatrix;","uniform vec2 projectionVector;","uniform vec2 offsetVector;","uniform vec3 tint;","uniform float alpha;","uniform vec3 color;","uniform float flipY;","varying vec4 vColor;","void main(void) {","   vec3 v = translationMatrix * vec3(aVertexPosition , 1.0);","   v -= offsetVector.xyx;","   gl_Position = vec4( v.x / projectionVector.x -1.0, (v.y / projectionVector.y * -flipY) + flipY , 0.0, 1.0);","   vColor = vec4(color * alpha * tint, alpha);","}"],this.init()},t.ComplexPrimitiveShader.prototype.constructor=t.ComplexPrimitiveShader,t.ComplexPrimitiveShader.prototype.init=function(){var e=this.gl,i=t.compileProgram(e,this.vertexSrc,this.fragmentSrc);e.useProgram(i),this.projectionVector=e.getUniformLocation(i,"projectionVector"),this.offsetVector=e.getUniformLocation(i,"offsetVector"),this.tintColor=e.getUniformLocation(i,"tint"),this.color=e.getUniformLocation(i,"color"),this.flipY=e.getUniformLocation(i,"flipY"),this.aVertexPosition=e.getAttribLocation(i,"aVertexPosition"),this.attributes=[this.aVertexPosition,this.colorAttribute],this.translationMatrix=e.getUniformLocation(i,"translationMatrix"),this.alpha=e.getUniformLocation(i,"alpha"),this.program=i},t.ComplexPrimitiveShader.prototype.destroy=function(){this.gl.deleteProgram(this.program),this.uniforms=null,this.gl=null,this.attribute=null},t.glContexts=[],t.instances=[],t.WebGLRenderer=function(e){this.game=e,t.defaultRenderer||(t.defaultRenderer=this),this.type=t.WEBGL_RENDERER,this.resolution=e.resolution,this.transparent=e.transparent,this.autoResize=!1,this.preserveDrawingBuffer=e.preserveDrawingBuffer,this.clearBeforeRender=e.clearBeforeRender,this.width=e.width,this.height=e.height,this.view=e.canvas,this._contextOptions={alpha:this.transparent,antialias:e.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:this.preserveDrawingBuffer},this.projection=new t.Point,this.offset=new t.Point,this.shaderManager=new t.WebGLShaderManager,this.spriteBatch=new t.WebGLSpriteBatch,this.maskManager=new t.WebGLMaskManager,this.filterManager=new t.WebGLFilterManager,this.stencilManager=new t.WebGLStencilManager,this.blendModeManager=new t.WebGLBlendModeManager,this.renderSession={},this.renderSession.game=this.game,this.renderSession.gl=this.gl,this.renderSession.drawCount=0,this.renderSession.shaderManager=this.shaderManager,this.renderSession.maskManager=this.maskManager,this.renderSession.filterManager=this.filterManager,this.renderSession.blendModeManager=this.blendModeManager,this.renderSession.spriteBatch=this.spriteBatch,this.renderSession.stencilManager=this.stencilManager,this.renderSession.renderer=this,this.renderSession.resolution=this.resolution,this.initContext(),this.mapBlendModes()},t.WebGLRenderer.prototype.constructor=t.WebGLRenderer,t.WebGLRenderer.prototype.initContext=function(){var e=this.view.getContext("webgl",this._contextOptions)||this.view.getContext("experimental-webgl",this._contextOptions);if(this.gl=e,!e)throw new Error("This browser does not support webGL. Try using the canvas renderer");this.glContextId=e.id=t.WebGLRenderer.glContextId++,t.glContexts[this.glContextId]=e,t.instances[this.glContextId]=this,e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),this.shaderManager.setContext(e),this.spriteBatch.setContext(e),this.maskManager.setContext(e),this.filterManager.setContext(e),this.blendModeManager.setContext(e),this.stencilManager.setContext(e),this.renderSession.gl=this.gl,this.resize(this.width,this.height)},t.WebGLRenderer.prototype.render=function(e){if(!this.contextLost){var t=this.gl;t.viewport(0,0,this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,null),this.game.clearBeforeRender&&(t.clearColor(e._bgColor.r,e._bgColor.g,e._bgColor.b,e._bgColor.a),t.clear(t.COLOR_BUFFER_BIT)),this.offset.x=this.game.camera._shake.x,this.offset.y=this.game.camera._shake.y,this.renderDisplayObject(e,this.projection)}},t.WebGLRenderer.prototype.renderDisplayObject=function(e,i,s,a){this.renderSession.blendModeManager.setBlendMode(t.blendModes.NORMAL),this.renderSession.drawCount=0,this.renderSession.flipY=s?-1:1,this.renderSession.projection=i,this.renderSession.offset=this.offset,this.spriteBatch.begin(this.renderSession),this.filterManager.begin(this.renderSession,s),e._renderWebGL(this.renderSession,a),this.spriteBatch.end()},t.WebGLRenderer.prototype.resize=function(e,t){this.width=e*this.resolution,this.height=t*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.gl.viewport(0,0,this.width,this.height),this.projection.x=this.width/2/this.resolution,this.projection.y=-this.height/2/this.resolution},t.WebGLRenderer.prototype.updateTexture=function(e){if(!e.hasLoaded)return!1;var i=this.gl;return e._glTextures[i.id]||(e._glTextures[i.id]=i.createTexture()),i.bindTexture(i.TEXTURE_2D,e._glTextures[i.id]),i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultipliedAlpha),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,e.source),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,e.scaleMode===t.scaleModes.LINEAR?i.LINEAR:i.NEAREST),e.mipmap&&t.isPowerOfTwo(e.width,e.height)?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,e.scaleMode===t.scaleModes.LINEAR?i.LINEAR_MIPMAP_LINEAR:i.NEAREST_MIPMAP_NEAREST),i.generateMipmap(i.TEXTURE_2D)):i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,e.scaleMode===t.scaleModes.LINEAR?i.LINEAR:i.NEAREST),e._powerOf2?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.REPEAT),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.REPEAT)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE)),e._dirty[i.id]=!1,!0},t.WebGLRenderer.prototype.destroy=function(){t.glContexts[this.glContextId]=null,this.projection=null,this.offset=null,this.shaderManager.destroy(),this.spriteBatch.destroy(),this.maskManager.destroy(),this.filterManager.destroy(),this.shaderManager=null,this.spriteBatch=null,this.maskManager=null,this.filterManager=null,this.gl=null,this.renderSession=null,t.CanvasPool.remove(this),t.instances[this.glContextId]=null,t.WebGLRenderer.glContextId--},t.WebGLRenderer.prototype.mapBlendModes=function(){var e=this.gl;if(!t.blendModesWebGL){var i=[],s=t.blendModes;i[s.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.ADD]=[e.SRC_ALPHA,e.DST_ALPHA],i[s.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA],i[s.SCREEN]=[e.SRC_ALPHA,e.ONE],i[s.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],i[s.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t.blendModesWebGL=i}},t.WebGLRenderer.glContextId=0,t.WebGLBlendModeManager=function(){this.currentBlendMode=99999},t.WebGLBlendModeManager.prototype.constructor=t.WebGLBlendModeManager,t.WebGLBlendModeManager.prototype.setContext=function(e){this.gl=e},t.WebGLBlendModeManager.prototype.setBlendMode=function(e){if(this.currentBlendMode===e)return!1;this.currentBlendMode=e;var i=t.blendModesWebGL[this.currentBlendMode];return i&&this.gl.blendFunc(i[0],i[1]),!0},t.WebGLBlendModeManager.prototype.destroy=function(){this.gl=null},t.WebGLMaskManager=function(){},t.WebGLMaskManager.prototype.constructor=t.WebGLMaskManager,t.WebGLMaskManager.prototype.setContext=function(e){this.gl=e},t.WebGLMaskManager.prototype.pushMask=function(e,i){var s=i.gl;e.dirty&&t.WebGLGraphics.updateGraphics(e,s),void 0!==e._webGL[s.id]&&void 0!==e._webGL[s.id].data&&0!==e._webGL[s.id].data.length&&i.stencilManager.pushStencil(e,e._webGL[s.id].data[0],i)},t.WebGLMaskManager.prototype.popMask=function(e,t){var i=this.gl;void 0!==e._webGL[i.id]&&void 0!==e._webGL[i.id].data&&0!==e._webGL[i.id].data.length&&t.stencilManager.popStencil(e,e._webGL[i.id].data[0],t)},t.WebGLMaskManager.prototype.destroy=function(){this.gl=null},t.WebGLStencilManager=function(){this.stencilStack=[],this.reverse=!0,this.count=0},t.WebGLStencilManager.prototype.setContext=function(e){this.gl=e},t.WebGLStencilManager.prototype.pushStencil=function(e,t,i){var s=this.gl;this.bindGraphics(e,t,i),0===this.stencilStack.length&&(s.enable(s.STENCIL_TEST),s.clear(s.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(t);var a=this.count;s.colorMask(!1,!1,!1,!1),s.stencilFunc(s.ALWAYS,0,255),s.stencilOp(s.KEEP,s.KEEP,s.INVERT),1===t.mode?(s.drawElements(s.TRIANGLE_FAN,t.indices.length-4,s.UNSIGNED_SHORT,0),this.reverse?(s.stencilFunc(s.EQUAL,255-a,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)):(s.stencilFunc(s.EQUAL,a,255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)),s.drawElements(s.TRIANGLE_FAN,4,s.UNSIGNED_SHORT,2*(t.indices.length-4)),this.reverse?s.stencilFunc(s.EQUAL,255-(a+1),255):s.stencilFunc(s.EQUAL,a+1,255),this.reverse=!this.reverse):(this.reverse?(s.stencilFunc(s.EQUAL,a,255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)):(s.stencilFunc(s.EQUAL,255-a,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)),s.drawElements(s.TRIANGLE_STRIP,t.indices.length,s.UNSIGNED_SHORT,0),this.reverse?s.stencilFunc(s.EQUAL,a+1,255):s.stencilFunc(s.EQUAL,255-(a+1),255)),s.colorMask(!0,!0,!0,!0),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),this.count++},t.WebGLStencilManager.prototype.bindGraphics=function(e,i,s){this._currentGraphics=e;var a,n=this.gl,o=s.projection,r=s.offset;1===i.mode?(a=s.shaderManager.complexPrimitiveShader,s.shaderManager.setShader(a),n.uniform1f(a.flipY,s.flipY),n.uniformMatrix3fv(a.translationMatrix,!1,e.worldTransform.toArray(!0)),n.uniform2f(a.projectionVector,o.x,-o.y),n.uniform2f(a.offsetVector,-r.x,-r.y),n.uniform3fv(a.tintColor,t.hex2rgb(e.tint)),n.uniform3fv(a.color,i.color),n.uniform1f(a.alpha,e.worldAlpha*i.alpha),n.bindBuffer(n.ARRAY_BUFFER,i.buffer),n.vertexAttribPointer(a.aVertexPosition,2,n.FLOAT,!1,8,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i.indexBuffer)):(a=s.shaderManager.primitiveShader,s.shaderManager.setShader(a),n.uniformMatrix3fv(a.translationMatrix,!1,e.worldTransform.toArray(!0)),n.uniform1f(a.flipY,s.flipY),n.uniform2f(a.projectionVector,o.x,-o.y),n.uniform2f(a.offsetVector,-r.x,-r.y),n.uniform3fv(a.tintColor,t.hex2rgb(e.tint)),n.uniform1f(a.alpha,e.worldAlpha),n.bindBuffer(n.ARRAY_BUFFER,i.buffer),n.vertexAttribPointer(a.aVertexPosition,2,n.FLOAT,!1,24,0),n.vertexAttribPointer(a.colorAttribute,4,n.FLOAT,!1,24,8),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,i.indexBuffer))},t.WebGLStencilManager.prototype.popStencil=function(e,t,i){var s=this.gl;if(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)s.disable(s.STENCIL_TEST);else{var a=this.count;this.bindGraphics(e,t,i),s.colorMask(!1,!1,!1,!1),1===t.mode?(this.reverse=!this.reverse,this.reverse?(s.stencilFunc(s.EQUAL,255-(a+1),255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)):(s.stencilFunc(s.EQUAL,a+1,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)),s.drawElements(s.TRIANGLE_FAN,4,s.UNSIGNED_SHORT,2*(t.indices.length-4)),s.stencilFunc(s.ALWAYS,0,255),s.stencilOp(s.KEEP,s.KEEP,s.INVERT),s.drawElements(s.TRIANGLE_FAN,t.indices.length-4,s.UNSIGNED_SHORT,0),this.reverse?s.stencilFunc(s.EQUAL,a,255):s.stencilFunc(s.EQUAL,255-a,255)):(this.reverse?(s.stencilFunc(s.EQUAL,a+1,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)):(s.stencilFunc(s.EQUAL,255-(a+1),255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)),s.drawElements(s.TRIANGLE_STRIP,t.indices.length,s.UNSIGNED_SHORT,0),this.reverse?s.stencilFunc(s.EQUAL,a,255):s.stencilFunc(s.EQUAL,255-a,255)),s.colorMask(!0,!0,!0,!0),s.stencilOp(s.KEEP,s.KEEP,s.KEEP)}},t.WebGLStencilManager.prototype.destroy=function(){this.stencilStack=null,this.gl=null},t.WebGLShaderManager=function(){this.maxAttibs=10,this.attribState=[],this.tempAttribState=[];for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.stack=[]},t.WebGLShaderManager.prototype.constructor=t.WebGLShaderManager,t.WebGLShaderManager.prototype.setContext=function(e){this.gl=e,this.primitiveShader=new t.PrimitiveShader(e),this.complexPrimitiveShader=new t.ComplexPrimitiveShader(e),this.defaultShader=new t.PixiShader(e),this.fastShader=new t.PixiFastShader(e),this.stripShader=new t.StripShader(e),this.setShader(this.defaultShader)},t.WebGLShaderManager.prototype.setAttribs=function(e){var t;for(t=0;t<this.tempAttribState.length;t++)this.tempAttribState[t]=!1;for(t=0;t<e.length;t++){var i=e[t];this.tempAttribState[i]=!0}var s=this.gl;for(t=0;t<this.attribState.length;t++)this.attribState[t]!==this.tempAttribState[t]&&(this.attribState[t]=this.tempAttribState[t],this.tempAttribState[t]?s.enableVertexAttribArray(t):s.disableVertexAttribArray(t))},t.WebGLShaderManager.prototype.setShader=function(e){return this._currentId!==e._UID&&(this._currentId=e._UID,this.currentShader=e,this.gl.useProgram(e.program),this.setAttribs(e.attributes),!0)},t.WebGLShaderManager.prototype.destroy=function(){this.attribState=null,this.tempAttribState=null,this.primitiveShader.destroy(),this.complexPrimitiveShader.destroy(),this.defaultShader.destroy(),this.fastShader.destroy(),this.stripShader.destroy(),this.gl=null},t.WebGLSpriteBatch=function(){this.vertSize=5,this.size=2e3;var e=4*this.size*4*this.vertSize,i=6*this.size;this.vertices=new t.ArrayBuffer(e),this.positions=new t.Float32Array(this.vertices),this.colors=new t.Uint32Array(this.vertices),this.indices=new t.Uint16Array(i),this.lastIndexCount=0;for(var s=0,a=0;s<i;s+=6,a+=4)this.indices[s+0]=a+0,this.indices[s+1]=a+1,this.indices[s+2]=a+2,this.indices[s+3]=a+0,this.indices[s+4]=a+2,this.indices[s+5]=a+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.dirty=!0,this.textures=[],this.blendModes=[],this.shaders=[],this.sprites=[],this.defaultShader=new t.AbstractFilter(["precision lowp float;","varying vec2 vTextureCoord;","varying vec4 vColor;","uniform sampler2D uSampler;","void main(void) {","   gl_FragColor = texture2D(uSampler, vTextureCoord) * vColor ;","}"])},t.WebGLSpriteBatch.prototype.setContext=function(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW),this.currentBlendMode=99999;var i=new t.PixiShader(e);i.fragmentSrc=this.defaultShader.fragmentSrc,i.uniforms={},i.init(),this.defaultShader.shaders[e.id]=i},t.WebGLSpriteBatch.prototype.begin=function(e){this.renderSession=e,this.shader=this.renderSession.shaderManager.defaultShader,this.start()},t.WebGLSpriteBatch.prototype.end=function(){this.flush()},t.WebGLSpriteBatch.prototype.render=function(e,t){var i=e.texture,s=e.worldTransform;t&&(s=t),this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=i.baseTexture);var a=i._uvs;if(a){var n,o,r,l,h=e.anchor.x,c=e.anchor.y;if(i.trim){var p=i.trim;n=(o=p.x-h*p.width)+i.crop.width,r=(l=p.y-c*p.height)+i.crop.height}else n=i.frame.width*(1-h),o=i.frame.width*-h,r=i.frame.height*(1-c),l=i.frame.height*-c;var d=4*this.currentBatchSize*this.vertSize,u=i.baseTexture.resolution,m=s.a/u,g=s.b/u,y=s.c/u,b=s.d/u,x=s.tx,v=s.ty,f=this.colors,w=this.positions;this.renderSession.roundPixels?(w[d]=m*o+y*l+x|0,w[d+1]=b*l+g*o+v|0,w[d+5]=m*n+y*l+x|0,w[d+6]=b*l+g*n+v|0,w[d+10]=m*n+y*r+x|0,w[d+11]=b*r+g*n+v|0,w[d+15]=m*o+y*r+x|0,w[d+16]=b*r+g*o+v|0):(w[d]=m*o+y*l+x,w[d+1]=b*l+g*o+v,w[d+5]=m*n+y*l+x,w[d+6]=b*l+g*n+v,w[d+10]=m*n+y*r+x,w[d+11]=b*r+g*n+v,w[d+15]=m*o+y*r+x,w[d+16]=b*r+g*o+v),w[d+2]=a.x0,w[d+3]=a.y0,w[d+7]=a.x1,w[d+8]=a.y1,w[d+12]=a.x2,w[d+13]=a.y2,w[d+17]=a.x3,w[d+18]=a.y3;var k=e.tint;f[d+4]=f[d+9]=f[d+14]=f[d+19]=(k>>16)+(65280&k)+((255&k)<<16)+(255*e.worldAlpha<<24),this.sprites[this.currentBatchSize++]=e}},t.WebGLSpriteBatch.prototype.renderTilingSprite=function(e){var i=e.tilingTexture;this.currentBatchSize>=this.size&&(this.flush(),this.currentBaseTexture=i.baseTexture),e._uvs||(e._uvs=new t.TextureUvs);var s=e._uvs,a=i.baseTexture.width,n=i.baseTexture.height;e.tilePosition.x%=a*e.tileScaleOffset.x,e.tilePosition.y%=n*e.tileScaleOffset.y;var o=e.tilePosition.x/(a*e.tileScaleOffset.x),r=e.tilePosition.y/(n*e.tileScaleOffset.y),l=e.width/a/(e.tileScale.x*e.tileScaleOffset.x),h=e.height/n/(e.tileScale.y*e.tileScaleOffset.y);s.x0=0-o,s.y0=0-r,s.x1=1*l-o,s.y1=0-r,s.x2=1*l-o,s.y2=1*h-r,s.x3=0-o,s.y3=1*h-r;var c=e.tint,p=(c>>16)+(65280&c)+((255&c)<<16)+(255*e.worldAlpha<<24),d=this.positions,u=this.colors,m=e.width,g=e.height,y=e.anchor.x,b=e.anchor.y,x=m*(1-y),v=m*-y,f=g*(1-b),w=g*-b,k=4*this.currentBatchSize*this.vertSize,_=i.baseTexture.resolution,S=e.worldTransform,M=S.a/_,A=S.b/_,C=S.c/_,P=S.d/_,T=S.tx,X=S.ty;d[k++]=M*v+C*w+T,d[k++]=P*w+A*v+X,d[k++]=s.x0,d[k++]=s.y0,u[k++]=p,d[k++]=M*x+C*w+T,d[k++]=P*w+A*x+X,d[k++]=s.x1,d[k++]=s.y1,u[k++]=p,d[k++]=M*x+C*f+T,d[k++]=P*f+A*x+X,d[k++]=s.x2,d[k++]=s.y2,u[k++]=p,d[k++]=M*v+C*f+T,d[k++]=P*f+A*v+X,d[k++]=s.x3,d[k++]=s.y3,u[k++]=p,this.sprites[this.currentBatchSize++]=e},t.WebGLSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var e,i=this.gl;if(this.dirty){this.dirty=!1,i.activeTexture(i.TEXTURE0),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e=this.defaultShader.shaders[i.id];var s=4*this.vertSize;i.vertexAttribPointer(e.aVertexPosition,2,i.FLOAT,!1,s,0),i.vertexAttribPointer(e.aTextureCoord,2,i.FLOAT,!1,s,8),i.vertexAttribPointer(e.colorAttribute,4,i.UNSIGNED_BYTE,!0,s,16)}if(this.currentBatchSize>.5*this.size)i.bufferSubData(i.ARRAY_BUFFER,0,this.vertices);else{var a=this.positions.subarray(0,4*this.currentBatchSize*this.vertSize);i.bufferSubData(i.ARRAY_BUFFER,0,a)}for(var n,o,r,l,h=0,c=0,p=null,d=this.renderSession.blendModeManager.currentBlendMode,u=null,m=!1,g=!1,y=0,b=this.currentBatchSize;y<b;y++){n=(l=this.sprites[y]).tilingTexture?l.tilingTexture.baseTexture:l.texture.baseTexture,m=d!==(o=l.blendMode),g=u!==(r=l.shader||this.defaultShader);var x=n.skipRender;if(x&&l.children.length>0&&(x=!1),(p!==n&&!x||m||g)&&(this.renderBatch(p,h,c),c=y,h=0,p=n,m&&(d=o,this.renderSession.blendModeManager.setBlendMode(d)),g)){(e=(u=r).shaders[i.id])||(e=new t.PixiShader(i),e.fragmentSrc=u.fragmentSrc,e.uniforms=u.uniforms,e.init(),u.shaders[i.id]=e),this.renderSession.shaderManager.setShader(e),e.dirty&&e.syncUniforms();var v=this.renderSession.projection;i.uniform2f(e.projectionVector,v.x,v.y);var f=this.renderSession.offset;i.uniform2f(e.offsetVector,f.x,f.y)}h++}this.renderBatch(p,h,c),this.currentBatchSize=0}},t.WebGLSpriteBatch.prototype.renderBatch=function(e,t,i){if(0!==t){var s=this.gl;if(e._dirty[s.id]){if(!this.renderSession.renderer.updateTexture(e))return}else s.bindTexture(s.TEXTURE_2D,e._glTextures[s.id]);s.drawElements(s.TRIANGLES,6*t,s.UNSIGNED_SHORT,6*i*2),this.renderSession.drawCount++}},t.WebGLSpriteBatch.prototype.stop=function(){this.flush(),this.dirty=!0},t.WebGLSpriteBatch.prototype.start=function(){this.dirty=!0},t.WebGLSpriteBatch.prototype.destroy=function(){this.vertices=null,this.indices=null,this.gl.deleteBuffer(this.vertexBuffer),this.gl.deleteBuffer(this.indexBuffer),this.currentBaseTexture=null,this.gl=null},t.WebGLFastSpriteBatch=function(e){this.vertSize=10,this.maxSize=6e3,this.size=this.maxSize;var i=4*this.size*this.vertSize,s=6*this.maxSize;this.vertices=new t.Float32Array(i),this.indices=new t.Uint16Array(s),this.vertexBuffer=null,this.indexBuffer=null,this.lastIndexCount=0;for(var a=0,n=0;a<s;a+=6,n+=4)this.indices[a+0]=n+0,this.indices[a+1]=n+1,this.indices[a+2]=n+2,this.indices[a+3]=n+0,this.indices[a+4]=n+2,this.indices[a+5]=n+3;this.drawing=!1,this.currentBatchSize=0,this.currentBaseTexture=null,this.currentBlendMode=0,this.renderSession=null,this.shader=null,this.matrix=null,this.setContext(e)},t.WebGLFastSpriteBatch.prototype.constructor=t.WebGLFastSpriteBatch,t.WebGLFastSpriteBatch.prototype.setContext=function(e){this.gl=e,this.vertexBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertices,e.DYNAMIC_DRAW)},t.WebGLFastSpriteBatch.prototype.begin=function(e,t){this.renderSession=t,this.shader=this.renderSession.shaderManager.fastShader,this.matrix=e.worldTransform.toArray(!0),this.start()},t.WebGLFastSpriteBatch.prototype.end=function(){this.flush()},t.WebGLFastSpriteBatch.prototype.render=function(e){var t=e.children,i=t[0];if(i.texture._uvs){this.currentBaseTexture=i.texture.baseTexture,i.blendMode!==this.renderSession.blendModeManager.currentBlendMode&&(this.flush(),this.renderSession.blendModeManager.setBlendMode(i.blendMode));for(var s=0,a=t.length;s<a;s++)this.renderSprite(t[s]);this.flush()}},t.WebGLFastSpriteBatch.prototype.renderSprite=function(e){if(e.visible&&(e.texture.baseTexture===this.currentBaseTexture||e.texture.baseTexture.skipRender||(this.flush(),this.currentBaseTexture=e.texture.baseTexture,e.texture._uvs))){var t,i,s,a,n,o,r=this.vertices;if(t=e.texture._uvs,e.texture.frame.width,e.texture.frame.height,e.texture.trim){var l=e.texture.trim;i=(s=l.x-e.anchor.x*l.width)+e.texture.crop.width,a=(n=l.y-e.anchor.y*l.height)+e.texture.crop.height}else i=e.texture.frame.width*(1-e.anchor.x),s=e.texture.frame.width*-e.anchor.x,a=e.texture.frame.height*(1-e.anchor.y),n=e.texture.frame.height*-e.anchor.y;o=4*this.currentBatchSize*this.vertSize,r[o++]=s,r[o++]=n,r[o++]=e.position.x,r[o++]=e.position.y,r[o++]=e.scale.x,r[o++]=e.scale.y,r[o++]=e.rotation,r[o++]=t.x0,r[o++]=t.y1,r[o++]=e.alpha,r[o++]=i,r[o++]=n,r[o++]=e.position.x,r[o++]=e.position.y,r[o++]=e.scale.x,r[o++]=e.scale.y,r[o++]=e.rotation,r[o++]=t.x1,r[o++]=t.y1,r[o++]=e.alpha,r[o++]=i,r[o++]=a,r[o++]=e.position.x,r[o++]=e.position.y,r[o++]=e.scale.x,r[o++]=e.scale.y,r[o++]=e.rotation,r[o++]=t.x2,r[o++]=t.y2,r[o++]=e.alpha,r[o++]=s,r[o++]=a,r[o++]=e.position.x,r[o++]=e.position.y,r[o++]=e.scale.x,r[o++]=e.scale.y,r[o++]=e.rotation,r[o++]=t.x3,r[o++]=t.y3,r[o++]=e.alpha,++this.currentBatchSize>=this.size&&this.flush()}},t.WebGLFastSpriteBatch.prototype.flush=function(){if(0!==this.currentBatchSize){var e=this.gl;if(this.currentBaseTexture._glTextures[e.id]||this.renderSession.renderer.updateTexture(this.currentBaseTexture,e),e.bindTexture(e.TEXTURE_2D,this.currentBaseTexture._glTextures[e.id]),this.currentBatchSize>.5*this.size)e.bufferSubData(e.ARRAY_BUFFER,0,this.vertices);else{var t=this.vertices.subarray(0,4*this.currentBatchSize*this.vertSize);e.bufferSubData(e.ARRAY_BUFFER,0,t)}e.drawElements(e.TRIANGLES,6*this.currentBatchSize,e.UNSIGNED_SHORT,0),this.currentBatchSize=0,this.renderSession.drawCount++}},t.WebGLFastSpriteBatch.prototype.stop=function(){this.flush()},t.WebGLFastSpriteBatch.prototype.start=function(){var e=this.gl;e.activeTexture(e.TEXTURE0),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var t=this.renderSession.projection;e.uniform2f(this.shader.projectionVector,t.x,t.y),e.uniformMatrix3fv(this.shader.uMatrix,!1,this.matrix);var i=4*this.vertSize;e.vertexAttribPointer(this.shader.aVertexPosition,2,e.FLOAT,!1,i,0),e.vertexAttribPointer(this.shader.aPositionCoord,2,e.FLOAT,!1,i,8),e.vertexAttribPointer(this.shader.aScale,2,e.FLOAT,!1,i,16),e.vertexAttribPointer(this.shader.aRotation,1,e.FLOAT,!1,i,24),e.vertexAttribPointer(this.shader.aTextureCoord,2,e.FLOAT,!1,i,28),e.vertexAttribPointer(this.shader.colorAttribute,1,e.FLOAT,!1,i,36)},t.WebGLFilterManager=function(){this.filterStack=[],this.offsetX=0,this.offsetY=0},t.WebGLFilterManager.prototype.constructor=t.WebGLFilterManager,t.WebGLFilterManager.prototype.setContext=function(e){this.gl=e,this.texturePool=[],this.initShaderBuffers()},t.WebGLFilterManager.prototype.begin=function(e,t){this.renderSession=e,this.defaultShader=e.shaderManager.defaultShader;var i=this.renderSession.projection;this.width=2*i.x,this.height=2*-i.y,this.buffer=t},t.WebGLFilterManager.prototype.pushFilter=function(e){var i=this.gl,s=this.renderSession.projection,a=this.renderSession.offset;e._filterArea=e.target.filterArea||e.target.getBounds(),e._previous_stencil_mgr=this.renderSession.stencilManager,this.renderSession.stencilManager=new t.WebGLStencilManager,this.renderSession.stencilManager.setContext(i),i.disable(i.STENCIL_TEST),this.filterStack.push(e);var n=e.filterPasses[0];this.offsetX+=e._filterArea.x,this.offsetY+=e._filterArea.y;var o=this.texturePool.pop();o?o.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution):o=new t.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution),i.bindTexture(i.TEXTURE_2D,o.texture);var r=e._filterArea,l=n.padding;r.x-=l,r.y-=l,r.width+=2*l,r.height+=2*l,r.x<0&&(r.x=0),r.width>this.width&&(r.width=this.width),r.y<0&&(r.y=0),r.height>this.height&&(r.height=this.height),i.bindFramebuffer(i.FRAMEBUFFER,o.frameBuffer),i.viewport(0,0,r.width*this.renderSession.resolution,r.height*this.renderSession.resolution),s.x=r.width/2,s.y=-r.height/2,a.x=-r.x,a.y=-r.y,i.colorMask(!0,!0,!0,!0),i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT),e._glFilterTexture=o},t.WebGLFilterManager.prototype.popFilter=function(){var e=this.gl,i=this.filterStack.pop(),s=i._filterArea,a=i._glFilterTexture,n=this.renderSession.projection,o=this.renderSession.offset;if(i.filterPasses.length>1){e.viewport(0,0,s.width*this.renderSession.resolution,s.height*this.renderSession.resolution),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=0,this.vertexArray[1]=s.height,this.vertexArray[2]=s.width,this.vertexArray[3]=s.height,this.vertexArray[4]=0,this.vertexArray[5]=0,this.vertexArray[6]=s.width,this.vertexArray[7]=0,e.bufferSubData(e.ARRAY_BUFFER,0,this.vertexArray),e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=s.width/this.width,this.uvArray[5]=s.height/this.height,this.uvArray[6]=s.width/this.width,this.uvArray[7]=s.height/this.height,e.bufferSubData(e.ARRAY_BUFFER,0,this.uvArray);var r=a,l=this.texturePool.pop();l||(l=new t.FilterTexture(this.gl,this.width*this.renderSession.resolution,this.height*this.renderSession.resolution)),l.resize(this.width*this.renderSession.resolution,this.height*this.renderSession.resolution),e.bindFramebuffer(e.FRAMEBUFFER,l.frameBuffer),e.clear(e.COLOR_BUFFER_BIT),e.disable(e.BLEND);for(var h=0;h<i.filterPasses.length-1;h++){var c=i.filterPasses[h];e.bindFramebuffer(e.FRAMEBUFFER,l.frameBuffer),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,r.texture),this.applyFilterPass(c,s,s.width,s.height);var p=r;r=l,l=p}e.enable(e.BLEND),a=r,this.texturePool.push(l)}var d=i.filterPasses[i.filterPasses.length-1];this.offsetX-=s.x,this.offsetY-=s.y;var u=this.width,m=this.height,g=0,y=0,b=this.buffer;if(0===this.filterStack.length)e.colorMask(!0,!0,!0,!0);else{var x=this.filterStack[this.filterStack.length-1];u=(s=x._filterArea).width,m=s.height,g=s.x,y=s.y,b=x._glFilterTexture.frameBuffer}n.x=u/2,n.y=-m/2,o.x=g,o.y=y;var v=(s=i._filterArea).x-g,f=s.y-y;e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),this.vertexArray[0]=v,this.vertexArray[1]=f+s.height,this.vertexArray[2]=v+s.width,this.vertexArray[3]=f+s.height,this.vertexArray[4]=v,this.vertexArray[5]=f,this.vertexArray[6]=v+s.width,this.vertexArray[7]=f,e.bufferSubData(e.ARRAY_BUFFER,0,this.vertexArray),e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),this.uvArray[2]=s.width/this.width,this.uvArray[5]=s.height/this.height,this.uvArray[6]=s.width/this.width,this.uvArray[7]=s.height/this.height,e.bufferSubData(e.ARRAY_BUFFER,0,this.uvArray),e.viewport(0,0,u*this.renderSession.resolution,m*this.renderSession.resolution),e.bindFramebuffer(e.FRAMEBUFFER,b),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,a.texture),this.renderSession.stencilManager&&this.renderSession.stencilManager.destroy(),this.renderSession.stencilManager=i._previous_stencil_mgr,i._previous_stencil_mgr=null,this.renderSession.stencilManager.count>0?e.enable(e.STENCIL_TEST):e.disable(e.STENCIL_TEST),this.applyFilterPass(d,s,u,m),this.texturePool.push(a),i._glFilterTexture=null},t.WebGLFilterManager.prototype.applyFilterPass=function(e,i,s,a){var n=this.gl,o=e.shaders[n.id];o||(o=new t.PixiShader(n),o.fragmentSrc=e.fragmentSrc,o.uniforms=e.uniforms,o.init(),e.shaders[n.id]=o),this.renderSession.shaderManager.setShader(o),n.uniform2f(o.projectionVector,s/2,-a/2),n.uniform2f(o.offsetVector,0,0),e.uniforms.dimensions&&(e.uniforms.dimensions.value[0]=this.width,e.uniforms.dimensions.value[1]=this.height,e.uniforms.dimensions.value[2]=this.vertexArray[0],e.uniforms.dimensions.value[3]=this.vertexArray[5]),o.syncUniforms(),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.vertexAttribPointer(o.aVertexPosition,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,this.uvBuffer),n.vertexAttribPointer(o.aTextureCoord,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ARRAY_BUFFER,this.colorBuffer),n.vertexAttribPointer(o.colorAttribute,2,n.FLOAT,!1,0,0),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),n.drawElements(n.TRIANGLES,6,n.UNSIGNED_SHORT,0),this.renderSession.drawCount++},t.WebGLFilterManager.prototype.initShaderBuffers=function(){var e=this.gl;this.vertexBuffer=e.createBuffer(),this.uvBuffer=e.createBuffer(),this.colorBuffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.vertexArray=new t.Float32Array([0,0,1,0,0,1,1,1]),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,this.vertexArray,e.STATIC_DRAW),this.uvArray=new t.Float32Array([0,0,1,0,0,1,1,1]),e.bindBuffer(e.ARRAY_BUFFER,this.uvBuffer),e.bufferData(e.ARRAY_BUFFER,this.uvArray,e.STATIC_DRAW),this.colorArray=new t.Float32Array([1,16777215,1,16777215,1,16777215,1,16777215]),e.bindBuffer(e.ARRAY_BUFFER,this.colorBuffer),e.bufferData(e.ARRAY_BUFFER,this.colorArray,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,1,3,2]),e.STATIC_DRAW)},t.WebGLFilterManager.prototype.destroy=function(){var e=this.gl;this.filterStack=null,this.offsetX=0,this.offsetY=0;for(var t=0;t<this.texturePool.length;t++)this.texturePool[t].destroy();this.texturePool=null,e.deleteBuffer(this.vertexBuffer),e.deleteBuffer(this.uvBuffer),e.deleteBuffer(this.colorBuffer),e.deleteBuffer(this.indexBuffer)},t.FilterTexture=function(e,i,s,a){this.gl=e,this.frameBuffer=e.createFramebuffer(),this.texture=e.createTexture(),a=a||t.scaleModes.DEFAULT,e.bindTexture(e.TEXTURE_2D,this.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,a===t.scaleModes.LINEAR?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,a===t.scaleModes.LINEAR?e.LINEAR:e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.bindFramebuffer(e.FRAMEBUFFER,this.frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,this.texture,0),this.renderBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,this.renderBuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,this.renderBuffer),this.resize(i,s)},t.FilterTexture.prototype.constructor=t.FilterTexture,t.FilterTexture.prototype.clear=function(){var e=this.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)},t.FilterTexture.prototype.resize=function(e,t){if(this.width!==e||this.height!==t){this.width=e,this.height=t;var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,e,t,0,i.RGBA,i.UNSIGNED_BYTE,null),i.bindRenderbuffer(i.RENDERBUFFER,this.renderBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,e,t)}},t.FilterTexture.prototype.destroy=function(){var e=this.gl;e.deleteFramebuffer(this.frameBuffer),e.deleteTexture(this.texture),this.frameBuffer=null,this.texture=null},t.CanvasBuffer=function(e,i){this.width=e,this.height=i,this.canvas=t.CanvasPool.create(this,this.width,this.height),this.context=this.canvas.getContext("2d"),this.canvas.width=e,this.canvas.height=i},t.CanvasBuffer.prototype.constructor=t.CanvasBuffer,t.CanvasBuffer.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height)},t.CanvasBuffer.prototype.resize=function(e,t){this.width=this.canvas.width=e,this.height=this.canvas.height=t},t.CanvasBuffer.prototype.destroy=function(){t.CanvasPool.remove(this)},t.CanvasMaskManager=function(){},t.CanvasMaskManager.prototype.constructor=t.CanvasMaskManager,t.CanvasMaskManager.prototype.pushMask=function(e,i){var s=i.context;s.save();var a=e.alpha,n=e.worldTransform,o=i.resolution;s.setTransform(n.a*o,n.b*o,n.c*o,n.d*o,n.tx*o,n.ty*o),t.CanvasGraphics.renderGraphicsMask(e,s),s.clip(),e.worldAlpha=a},t.CanvasMaskManager.prototype.popMask=function(e){e.context.restore()},t.CanvasTinter=function(){},t.CanvasTinter.getTintedTexture=function(e,i){var s=e.tintedTexture||t.CanvasPool.create(this);return t.CanvasTinter.tintMethod(e.texture,i,s),s},t.CanvasTinter.tintWithMultiply=function(e,t,i){var s=i.getContext("2d"),a=e.crop;i.width===a.width&&i.height===a.height||(i.width=a.width,i.height=a.height),s.clearRect(0,0,a.width,a.height),s.fillStyle="#"+("00000"+(0|t).toString(16)).substr(-6),s.fillRect(0,0,a.width,a.height),s.globalCompositeOperation="multiply",s.drawImage(e.baseTexture.source,a.x,a.y,a.width,a.height,0,0,a.width,a.height),s.globalCompositeOperation="destination-atop",s.drawImage(e.baseTexture.source,a.x,a.y,a.width,a.height,0,0,a.width,a.height)},t.CanvasTinter.tintWithPerPixel=function(e,i,s){var a=s.getContext("2d"),n=e.crop;s.width=n.width,s.height=n.height,a.globalCompositeOperation="copy",a.drawImage(e.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height);for(var o=t.hex2rgb(i),r=o[0],l=o[1],h=o[2],c=a.getImageData(0,0,n.width,n.height),p=c.data,d=0;d<p.length;d+=4)if(p[d+0]*=r,p[d+1]*=l,p[d+2]*=h,!t.CanvasTinter.canHandleAlpha){var u=p[d+3];p[d+0]/=255/u,p[d+1]/=255/u,p[d+2]/=255/u}a.putImageData(c,0,0)},t.CanvasTinter.checkInverseAlpha=function(){var e=new t.CanvasBuffer(2,1);e.context.fillStyle="rgba(10, 20, 30, 0.5)",e.context.fillRect(0,0,1,1);var i=e.context.getImageData(0,0,1,1);if(null===i)return!1;e.context.putImageData(i,1,0);var s=e.context.getImageData(1,0,1,1);return s.data[0]===i.data[0]&&s.data[1]===i.data[1]&&s.data[2]===i.data[2]&&s.data[3]===i.data[3]},t.CanvasTinter.canHandleAlpha=t.CanvasTinter.checkInverseAlpha(),t.CanvasTinter.canUseMultiply=t.canUseNewCanvasBlendModes(),t.CanvasTinter.tintMethod=t.CanvasTinter.canUseMultiply?t.CanvasTinter.tintWithMultiply:t.CanvasTinter.tintWithPerPixel,t.CanvasRenderer=function(e){this.game=e,t.defaultRenderer||(t.defaultRenderer=this),this.type=t.CANVAS_RENDERER,this.resolution=e.resolution,this.clearBeforeRender=e.clearBeforeRender,this.transparent=e.transparent,this.autoResize=!1,this.width=e.width*this.resolution,this.height=e.height*this.resolution,this.view=e.canvas,this.context=this.view.getContext("2d",{alpha:this.transparent}),this.refresh=!0,this.count=0,this.maskManager=new t.CanvasMaskManager,this.renderSession={context:this.context,maskManager:this.maskManager,scaleMode:null,smoothProperty:Phaser.Canvas.getSmoothingPrefix(this.context),roundPixels:!1},this.mapBlendModes(),this.resize(this.width,this.height)},t.CanvasRenderer.prototype.constructor=t.CanvasRenderer,t.CanvasRenderer.prototype.render=function(e){this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1,this.renderSession.currentBlendMode=0,this.renderSession.shakeX=this.game.camera._shake.x,this.renderSession.shakeY=this.game.camera._shake.y,this.context.globalCompositeOperation="source-over",navigator.isCocoonJS&&this.view.screencanvas&&(this.context.fillStyle="black",this.context.clear()),this.clearBeforeRender&&(this.transparent?this.context.clearRect(0,0,this.width,this.height):e._bgColor&&(this.context.fillStyle=e._bgColor.rgba,this.context.fillRect(0,0,this.width,this.height))),this.renderDisplayObject(e)},t.CanvasRenderer.prototype.destroy=function(e){void 0===e&&(e=!0),e&&this.view.parent&&this.view.parent.removeChild(this.view),this.view=null,this.context=null,this.maskManager=null,this.renderSession=null},t.CanvasRenderer.prototype.resize=function(e,i){this.width=e*this.resolution,this.height=i*this.resolution,this.view.width=this.width,this.view.height=this.height,this.autoResize&&(this.view.style.width=this.width/this.resolution+"px",this.view.style.height=this.height/this.resolution+"px"),this.renderSession.smoothProperty&&(this.context[this.renderSession.smoothProperty]=this.renderSession.scaleMode===t.scaleModes.LINEAR)},t.CanvasRenderer.prototype.renderDisplayObject=function(e,t,i){this.renderSession.context=t||this.context,this.renderSession.resolution=this.resolution,e._renderCanvas(this.renderSession,i)},t.CanvasRenderer.prototype.mapBlendModes=function(){if(!t.blendModesCanvas){var e=[],i=t.blendModes,s=t.canUseNewCanvasBlendModes();e[i.NORMAL]="source-over",e[i.ADD]="lighter",e[i.MULTIPLY]=s?"multiply":"source-over",e[i.SCREEN]=s?"screen":"source-over",e[i.OVERLAY]=s?"overlay":"source-over",e[i.DARKEN]=s?"darken":"source-over",e[i.LIGHTEN]=s?"lighten":"source-over",e[i.COLOR_DODGE]=s?"color-dodge":"source-over",e[i.COLOR_BURN]=s?"color-burn":"source-over",e[i.HARD_LIGHT]=s?"hard-light":"source-over",e[i.SOFT_LIGHT]=s?"soft-light":"source-over",e[i.DIFFERENCE]=s?"difference":"source-over",e[i.EXCLUSION]=s?"exclusion":"source-over",e[i.HUE]=s?"hue":"source-over",e[i.SATURATION]=s?"saturation":"source-over",e[i.COLOR]=s?"color":"source-over",e[i.LUMINOSITY]=s?"luminosity":"source-over",t.blendModesCanvas=e}},t.BaseTexture=function(e,i){this.resolution=1,this.width=100,this.height=100,this.scaleMode=i||t.scaleModes.DEFAULT,this.hasLoaded=!1,this.source=e,this.premultipliedAlpha=!0,this._glTextures=[],this.mipmap=!1,this._dirty=[!0,!0,!0,!0],e&&((this.source.complete||this.source.getContext)&&this.source.width&&this.source.height&&(this.hasLoaded=!0,this.width=this.source.naturalWidth||this.source.width,this.height=this.source.naturalHeight||this.source.height,this.dirty()),this.skipRender=!1,this._powerOf2=!1)},t.BaseTexture.prototype.constructor=t.BaseTexture,t.BaseTexture.prototype.forceLoaded=function(e,t){this.hasLoaded=!0,this.width=e,this.height=t,this.dirty()},t.BaseTexture.prototype.destroy=function(){this.source&&t.CanvasPool.removeByCanvas(this.source),this.source=null,this.unloadFromGPU()},t.BaseTexture.prototype.updateSourceImage=function(e){},t.BaseTexture.prototype.dirty=function(){for(var e=0;e<this._glTextures.length;e++)this._dirty[e]=!0},t.BaseTexture.prototype.unloadFromGPU=function(){this.dirty();for(var e=this._glTextures.length-1;e>=0;e--){var i=this._glTextures[e],s=t.glContexts[e];s&&i&&s.deleteTexture(i)}this._glTextures.length=0,this.dirty()},t.BaseTexture.fromCanvas=function(e,i){return 0===e.width&&(e.width=1),0===e.height&&(e.height=1),new t.BaseTexture(e,i)},t.TextureSilentFail=!1,t.Texture=function(e,i,s,a){this.noFrame=!1,i||(this.noFrame=!0,i=new t.Rectangle(0,0,1,1)),e instanceof t.Texture&&(e=e.baseTexture),this.baseTexture=e,this.frame=i,this.trim=a,this.valid=!1,this.isTiling=!1,this.requiresUpdate=!1,this.requiresReTint=!1,this._uvs=null,this.width=0,this.height=0,this.crop=s||new t.Rectangle(0,0,1,1),e.hasLoaded&&(this.noFrame&&(i=new t.Rectangle(0,0,e.width,e.height)),this.setFrame(i))},t.Texture.prototype.constructor=t.Texture,t.Texture.prototype.onBaseTextureLoaded=function(){var e=this.baseTexture;this.noFrame&&(this.frame=new t.Rectangle(0,0,e.width,e.height)),this.setFrame(this.frame)},t.Texture.prototype.destroy=function(e){e&&this.baseTexture.destroy(),this.valid=!1},t.Texture.prototype.setFrame=function(e){if(this.noFrame=!1,this.frame=e,this.width=e.width,this.height=e.height,this.crop.x=e.x,this.crop.y=e.y,this.crop.width=e.width,this.crop.height=e.height,this.trim||!(e.x+e.width>this.baseTexture.width||e.y+e.height>this.baseTexture.height))this.valid=e&&e.width&&e.height&&this.baseTexture.source&&this.baseTexture.hasLoaded,this.trim&&(this.width=this.trim.width,this.height=this.trim.height,this.frame.width=this.trim.width,this.frame.height=this.trim.height),this.valid&&this._updateUvs();else{if(!t.TextureSilentFail)throw new Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.valid=!1}},t.Texture.prototype._updateUvs=function(){this._uvs||(this._uvs=new t.TextureUvs);var e=this.crop,i=this.baseTexture.width,s=this.baseTexture.height;this._uvs.x0=e.x/i,this._uvs.y0=e.y/s,this._uvs.x1=(e.x+e.width)/i,this._uvs.y1=e.y/s,this._uvs.x2=(e.x+e.width)/i,this._uvs.y2=(e.y+e.height)/s,this._uvs.x3=e.x/i,this._uvs.y3=(e.y+e.height)/s},t.Texture.fromCanvas=function(e,i){var s=t.BaseTexture.fromCanvas(e,i);return new t.Texture(s)},t.TextureUvs=function(){this.x0=0,this.y0=0,this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.x3=0,this.y3=0},t.RenderTexture=function(e,i,s,a,n){if(this.width=e||100,this.height=i||100,this.resolution=n||1,this.frame=new t.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.crop=new t.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution),this.baseTexture=new t.BaseTexture,this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution,this.baseTexture._glTextures=[],this.baseTexture.resolution=this.resolution,this.baseTexture.scaleMode=a||t.scaleModes.DEFAULT,this.baseTexture.hasLoaded=!0,t.Texture.call(this,this.baseTexture,new t.Rectangle(0,0,this.width*this.resolution,this.height*this.resolution)),this.renderer=s||t.defaultRenderer,this.renderer.type===t.WEBGL_RENDERER){var o=this.renderer.gl;this.baseTexture._dirty[o.id]=!1,this.textureBuffer=new t.FilterTexture(o,this.width,this.height,this.baseTexture.scaleMode),this.baseTexture._glTextures[o.id]=this.textureBuffer.texture,this.render=this.renderWebGL,this.projection=new t.Point(.5*this.width,.5*-this.height)}else this.render=this.renderCanvas,this.textureBuffer=new t.CanvasBuffer(this.width*this.resolution,this.height*this.resolution),this.baseTexture.source=this.textureBuffer.canvas;this.valid=!0,this.tempMatrix=new Phaser.Matrix,this._updateUvs()},t.RenderTexture.prototype=Object.create(t.Texture.prototype),t.RenderTexture.prototype.constructor=t.RenderTexture,t.RenderTexture.prototype.resize=function(e,i,s){e===this.width&&i===this.height||(this.valid=e>0&&i>0,this.width=e,this.height=i,this.frame.width=this.crop.width=e*this.resolution,this.frame.height=this.crop.height=i*this.resolution,s&&(this.baseTexture.width=this.width*this.resolution,this.baseTexture.height=this.height*this.resolution),this.renderer.type===t.WEBGL_RENDERER&&(this.projection.x=this.width/2,this.projection.y=-this.height/2),this.valid&&this.textureBuffer.resize(this.width,this.height))},t.RenderTexture.prototype.clear=function(){this.valid&&(this.renderer.type===t.WEBGL_RENDERER&&this.renderer.gl.bindFramebuffer(this.renderer.gl.FRAMEBUFFER,this.textureBuffer.frameBuffer),this.textureBuffer.clear())},t.RenderTexture.prototype.renderWebGL=function(e,t,i){if(this.valid&&0!==e.alpha){var s=e.worldTransform;s.identity(),s.translate(0,2*this.projection.y),t&&s.append(t),s.scale(1,-1);for(var a=0;a<e.children.length;a++)e.children[a].updateTransform();var n=this.renderer.gl;n.viewport(0,0,this.width*this.resolution,this.height*this.resolution),n.bindFramebuffer(n.FRAMEBUFFER,this.textureBuffer.frameBuffer),i&&this.textureBuffer.clear(),this.renderer.spriteBatch.dirty=!0,this.renderer.renderDisplayObject(e,this.projection,this.textureBuffer.frameBuffer,t),this.renderer.spriteBatch.dirty=!0}},t.RenderTexture.prototype.renderCanvas=function(e,t,i){if(this.valid&&0!==e.alpha){var s=e.worldTransform;s.identity(),t&&s.append(t);for(var a=0;a<e.children.length;a++)e.children[a].updateTransform();i&&this.textureBuffer.clear();var n=this.renderer.resolution;this.renderer.resolution=this.resolution,this.renderer.renderDisplayObject(e,this.textureBuffer.context,t),this.renderer.resolution=n}},t.RenderTexture.prototype.getImage=function(){var e=new Image;return e.src=this.getBase64(),e},t.RenderTexture.prototype.getBase64=function(){return this.getCanvas().toDataURL()},t.RenderTexture.prototype.getCanvas=function(){if(this.renderer.type===t.WEBGL_RENDERER){var e=this.renderer.gl,i=this.textureBuffer.width,s=this.textureBuffer.height,a=new Uint8Array(4*i*s);e.bindFramebuffer(e.FRAMEBUFFER,this.textureBuffer.frameBuffer),e.readPixels(0,0,i,s,e.RGBA,e.UNSIGNED_BYTE,a),e.bindFramebuffer(e.FRAMEBUFFER,null);var n=new t.CanvasBuffer(i,s),o=n.context.getImageData(0,0,i,s);return o.data.set(a),n.context.putImageData(o,0,0),n.canvas}return this.textureBuffer.canvas},t.AbstractFilter=function(e,t){this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.uniforms=t||{},this.fragmentSrc=e||[]},t.AbstractFilter.prototype.constructor=t.AbstractFilter,t.AbstractFilter.prototype.syncUniforms=function(){for(var e=0,t=this.shaders.length;e<t;e++)this.shaders[e].dirty=!0},t.Strip=function(e){t.DisplayObjectContainer.call(this),this.texture=e,this.uvs=new t.Float32Array([0,1,1,1,1,0,0,1]),this.vertices=new t.Float32Array([0,0,100,0,100,100,0,100]),this.colors=new t.Float32Array([1,1,1,1]),this.indices=new t.Uint16Array([0,1,2,3]),this.dirty=!0,this.blendMode=t.blendModes.NORMAL,this.canvasPadding=0,this.drawMode=t.Strip.DrawModes.TRIANGLE_STRIP},t.Strip.prototype=Object.create(t.DisplayObjectContainer.prototype),t.Strip.prototype.constructor=t.Strip,t.Strip.prototype._renderWebGL=function(e){!this.visible||this.alpha<=0||(e.spriteBatch.stop(),this._vertexBuffer||this._initWebGL(e),e.shaderManager.setShader(e.shaderManager.stripShader),this._renderStrip(e),e.spriteBatch.start())},t.Strip.prototype._initWebGL=function(e){var t=e.gl;this._vertexBuffer=t.createBuffer(),this._indexBuffer=t.createBuffer(),this._uvBuffer=t.createBuffer(),this._colorBuffer=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,this._vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.DYNAMIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvs,t.STATIC_DRAW),t.bindBuffer(t.ARRAY_BUFFER,this._colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colors,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this._indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)},t.Strip.prototype._renderStrip=function(e){var i=e.gl,s=e.projection,a=e.offset,n=e.shaderManager.stripShader,o=this.drawMode===t.Strip.DrawModes.TRIANGLE_STRIP?i.TRIANGLE_STRIP:i.TRIANGLES;e.blendModeManager.setBlendMode(this.blendMode),i.uniformMatrix3fv(n.translationMatrix,!1,this.worldTransform.toArray(!0)),i.uniform2f(n.projectionVector,s.x,-s.y),i.uniform2f(n.offsetVector,-a.x,-a.y),i.uniform1f(n.alpha,this.worldAlpha),this.dirty?(this.dirty=!1,i.bindBuffer(i.ARRAY_BUFFER,this._vertexBuffer),i.bufferData(i.ARRAY_BUFFER,this.vertices,i.STATIC_DRAW),i.vertexAttribPointer(n.aVertexPosition,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this._uvBuffer),i.bufferData(i.ARRAY_BUFFER,this.uvs,i.STATIC_DRAW),i.vertexAttribPointer(n.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),this.texture.baseTexture._dirty[i.id]?e.renderer.updateTexture(this.texture.baseTexture):i.bindTexture(i.TEXTURE_2D,this.texture.baseTexture._glTextures[i.id]),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,this.indices,i.STATIC_DRAW)):(i.bindBuffer(i.ARRAY_BUFFER,this._vertexBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,this.vertices),i.vertexAttribPointer(n.aVertexPosition,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this._uvBuffer),i.vertexAttribPointer(n.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),this.texture.baseTexture._dirty[i.id]?e.renderer.updateTexture(this.texture.baseTexture):i.bindTexture(i.TEXTURE_2D,this.texture.baseTexture._glTextures[i.id]),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this._indexBuffer)),i.drawElements(o,this.indices.length,i.UNSIGNED_SHORT,0)},t.Strip.prototype._renderCanvas=function(e){var i=e.context,s=this.worldTransform,a=s.tx*e.resolution+e.shakeX,n=s.ty*e.resolution+e.shakeY;e.roundPixels?i.setTransform(s.a,s.b,s.c,s.d,0|a,0|n):i.setTransform(s.a,s.b,s.c,s.d,a,n),this.drawMode===t.Strip.DrawModes.TRIANGLE_STRIP?this._renderCanvasTriangleStrip(i):this._renderCanvasTriangles(i)},t.Strip.prototype._renderCanvasTriangleStrip=function(e){var t=this.vertices,i=this.uvs,s=t.length/2;this.count++;for(var a=0;a<s-2;a++){var n=2*a;this._renderCanvasDrawTriangle(e,t,i,n,n+2,n+4)}},t.Strip.prototype._renderCanvasTriangles=function(e){var t=this.vertices,i=this.uvs,s=this.indices,a=s.length;this.count++;for(var n=0;n<a;n+=3){var o=2*s[n],r=2*s[n+1],l=2*s[n+2];this._renderCanvasDrawTriangle(e,t,i,o,r,l)}},t.Strip.prototype._renderCanvasDrawTriangle=function(e,t,i,s,a,n){var o=this.texture.baseTexture.source,r=this.texture.width,l=this.texture.height,h=t[s],c=t[a],p=t[n],d=t[s+1],u=t[a+1],m=t[n+1],g=i[s]*r,y=i[a]*r,b=i[n]*r,x=i[s+1]*l,v=i[a+1]*l,f=i[n+1]*l;if(this.canvasPadding>0){var w=this.canvasPadding/this.worldTransform.a,k=this.canvasPadding/this.worldTransform.d,_=(h+c+p)/3,S=(d+u+m)/3,M=h-_,A=d-S,C=Math.sqrt(M*M+A*A);h=_+M/C*(C+w),d=S+A/C*(C+k),A=u-S,c=_+(M=c-_)/(C=Math.sqrt(M*M+A*A))*(C+w),u=S+A/C*(C+k),A=m-S,p=_+(M=p-_)/(C=Math.sqrt(M*M+A*A))*(C+w),m=S+A/C*(C+k)}e.save(),e.beginPath(),e.moveTo(h,d),e.lineTo(c,u),e.lineTo(p,m),e.closePath(),e.clip();var P=g*v+x*b+y*f-v*b-x*y-g*f,T=h*v+x*p+c*f-v*p-x*c-h*f,X=g*c+h*b+y*p-c*b-h*y-g*p,Y=g*v*p+x*c*b+h*y*f-h*v*b-x*y*p-g*c*f,G=d*v+x*m+u*f-v*m-x*u-d*f,B=g*u+d*b+y*m-u*b-d*y-g*m,L=g*v*m+x*u*b+d*y*f-d*v*b-x*y*m-g*u*f;e.transform(T/P,G/P,X/P,B/P,Y/P,L/P),e.drawImage(o,0,0),e.restore()},t.Strip.prototype.renderStripFlat=function(e){var t=this.context,i=e.vertices,s=i.length/2;this.count++,t.beginPath();for(var a=1;a<s-2;a++){var n=2*a,o=i[n],r=i[n+2],l=i[n+4],h=i[n+1],c=i[n+3],p=i[n+5];t.moveTo(o,h),t.lineTo(r,c),t.lineTo(l,p)}t.fillStyle="#FF0000",t.fill(),t.closePath()},t.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},t.Strip.prototype.getBounds=function(e){for(var i=e||this.worldTransform,s=i.a,a=i.b,n=i.c,o=i.d,r=i.tx,l=i.ty,h=-1/0,c=-1/0,p=1/0,d=1/0,u=this.vertices,m=0,g=u.length;m<g;m+=2){var y=u[m],b=u[m+1],x=s*y+n*b+r,v=o*b+a*y+l;p=x<p?x:p,d=v<d?v:d,h=x>h?x:h,c=v>c?v:c}if(p===-1/0||c===1/0)return t.EmptyRectangle;var f=this._bounds;return f.x=p,f.width=h-p,f.y=d,f.height=c-d,this._currentBounds=f,f},t.Strip.DrawModes={TRIANGLE_STRIP:0,TRIANGLES:1},t.Rope=function(e,i){t.Strip.call(this,e),this.points=i,this.vertices=new t.Float32Array(4*i.length),this.uvs=new t.Float32Array(4*i.length),this.colors=new t.Float32Array(2*i.length),this.indices=new t.Uint16Array(2*i.length),this.refresh()},t.Rope.prototype=Object.create(t.Strip.prototype),t.Rope.prototype.constructor=t.Rope,t.Rope.prototype.refresh=function(){var e=this.points;if(!(e.length<1)){var t=this.uvs,i=(e[0],this.indices),s=this.colors;this.count-=.2,t[0]=0,t[1]=0,t[2]=0,t[3]=1,s[0]=1,s[1]=1,i[0]=0,i[1]=1;for(var a,n,o,r=e.length,l=1;l<r;l++)a=e[l],n=4*l,o=l/(r-1),t[n]=o,t[n+1]=0,t[n+2]=o,t[n+3]=1,n=2*l,s[n]=1,s[n+1]=1,n=2*l,i[n]=n,i[n+1]=n+1,a}},t.Rope.prototype.updateTransform=function(){var e=this.points;if(!(e.length<1)){var i,s=e[0],a={x:0,y:0};this.count-=.2;for(var n,o,r,l,h=this.vertices,c=e.length,p=0;p<c;p++)n=e[p],o=4*p,i=p<e.length-1?e[p+1]:n,a.y=-(i.x-s.x),a.x=i.y-s.y,10*(1-p/(c-1))>1&&1,r=Math.sqrt(a.x*a.x+a.y*a.y),l=this.texture.height/2,a.x/=r,a.y/=r,a.x*=l,a.y*=l,h[o]=n.x+a.x,h[o+1]=n.y+a.y,h[o+2]=n.x-a.x,h[o+3]=n.y-a.y,s=n;t.DisplayObjectContainer.prototype.updateTransform.call(this)}},t.Rope.prototype.setTexture=function(e){this.texture=e},t.TilingSprite=function(e,i,s){t.Sprite.call(this,e),this._width=i||128,this._height=s||128,this.tileScale=new t.Point(1,1),this.tileScaleOffset=new t.Point(1,1),this.tilePosition=new t.Point,this.renderable=!0,this.tint=16777215,this.textureDebug=!1,this.blendMode=t.blendModes.NORMAL,this.canvasBuffer=null,this.tilingTexture=null,this.tilePattern=null,this.refreshTexture=!0,this.frameWidth=0,this.frameHeight=0},t.TilingSprite.prototype=Object.create(t.Sprite.prototype),t.TilingSprite.prototype.constructor=t.TilingSprite,t.TilingSprite.prototype.setTexture=function(e){this.texture!==e&&(this.texture=e,this.refreshTexture=!0,this.cachedTint=16777215)},t.TilingSprite.prototype._renderWebGL=function(e){if(this.visible&&this.renderable&&0!==this.alpha){if(this._mask&&(e.spriteBatch.stop(),e.maskManager.pushMask(this.mask,e),e.spriteBatch.start()),this._filters&&(e.spriteBatch.flush(),e.filterManager.pushFilter(this._filterBlock)),this.refreshTexture){if(this.generateTilingTexture(!0,e),!this.tilingTexture)return;this.tilingTexture.needsUpdate&&(e.renderer.updateTexture(this.tilingTexture.baseTexture),this.tilingTexture.needsUpdate=!1)}e.spriteBatch.renderTilingSprite(this);for(var t=0;t<this.children.length;t++)this.children[t]._renderWebGL(e);e.spriteBatch.stop(),this._filters&&e.filterManager.popFilter(),this._mask&&e.maskManager.popMask(this._mask,e),e.spriteBatch.start()}},t.TilingSprite.prototype._renderCanvas=function(e){if(this.visible&&this.renderable&&0!==this.alpha){var i=e.context;this._mask&&e.maskManager.pushMask(this._mask,e),i.globalAlpha=this.worldAlpha;var s=this.worldTransform,a=e.resolution,n=s.tx*a+e.shakeX,o=s.ty*a+e.shakeY;if(i.setTransform(s.a*a,s.b*a,s.c*a,s.d*a,n,o),this.refreshTexture){if(this.generateTilingTexture(!1,e),!this.tilingTexture)return;this.tilePattern=i.createPattern(this.tilingTexture.baseTexture.source,"repeat")}var r=e.currentBlendMode;this.blendMode!==e.currentBlendMode&&(e.currentBlendMode=this.blendMode,i.globalCompositeOperation=t.blendModesCanvas[e.currentBlendMode]);var l=this.tilePosition,h=this.tileScale;l.x%=this.tilingTexture.baseTexture.width,l.y%=this.tilingTexture.baseTexture.height,i.scale(h.x,h.y),i.translate(l.x+this.anchor.x*-this._width,l.y+this.anchor.y*-this._height),i.fillStyle=this.tilePattern;var n=-l.x,o=-l.y,c=this._width/h.x,p=this._height/h.y;e.roundPixels&&(n|=0,o|=0,c|=0,p|=0),i.fillRect(n,o,c,p),i.scale(1/h.x,1/h.y),i.translate(-l.x+this.anchor.x*this._width,-l.y+this.anchor.y*this._height),this._mask&&e.maskManager.popMask(e);for(var d=0;d<this.children.length;d++)this.children[d]._renderCanvas(e);r!==this.blendMode&&(e.currentBlendMode=r,i.globalCompositeOperation=t.blendModesCanvas[r])}},t.TilingSprite.prototype.onTextureUpdate=function(){},t.TilingSprite.prototype.generateTilingTexture=function(e,i){if(this.texture.baseTexture.hasLoaded){var s=this.texture,a=s.frame,n=this._frame.sourceSizeW||this._frame.width,o=this._frame.sourceSizeH||this._frame.height,r=0,l=0;this._frame.trimmed&&(r=this._frame.spriteSourceSizeX,l=this._frame.spriteSourceSizeY),e&&(n=t.getNextPowerOfTwo(n),o=t.getNextPowerOfTwo(o)),this.canvasBuffer?(this.canvasBuffer.resize(n,o),this.tilingTexture.baseTexture.width=n,this.tilingTexture.baseTexture.height=o,this.tilingTexture.needsUpdate=!0):(this.canvasBuffer=new t.CanvasBuffer(n,o),this.tilingTexture=t.Texture.fromCanvas(this.canvasBuffer.canvas),this.tilingTexture.isTiling=!0,this.tilingTexture.needsUpdate=!0),this.textureDebug&&(this.canvasBuffer.context.strokeStyle="#00ff00",this.canvasBuffer.context.strokeRect(0,0,n,o));var h=s.crop.width,c=s.crop.height;h===n&&c===o||(h=n,c=o),this.canvasBuffer.context.drawImage(s.baseTexture.source,s.crop.x,s.crop.y,s.crop.width,s.crop.height,r,l,h,c),this.tileScaleOffset.x=a.width/n,this.tileScaleOffset.y=a.height/o,this.refreshTexture=!1,this.tilingTexture.baseTexture._powerOf2=!0}},t.TilingSprite.prototype.getBounds=function(){var e=this._width,t=this._height,i=e*(1-this.anchor.x),s=e*-this.anchor.x,a=t*(1-this.anchor.y),n=t*-this.anchor.y,o=this.worldTransform,r=o.a,l=o.b,h=o.c,c=o.d,p=o.tx,d=o.ty,u=r*s+h*n+p,m=c*n+l*s+d,g=r*i+h*n+p,y=c*n+l*i+d,b=r*i+h*a+p,x=c*a+l*i+d,v=r*s+h*a+p,f=c*a+l*s+d,w=-1/0,k=-1/0,_=1/0,S=1/0;_=v<(_=b<(_=g<(_=u<_?u:_)?g:_)?b:_)?v:_,S=f<(S=x<(S=y<(S=m<S?m:S)?y:S)?x:S)?f:S,w=v>(w=b>(w=g>(w=u>w?u:w)?g:w)?b:w)?v:w,k=f>(k=x>(k=y>(k=m>k?m:k)?y:k)?x:k)?f:k;var M=this._bounds;return M.x=_,M.width=w-_,M.y=S,M.height=k-S,this._currentBounds=M,M},t.TilingSprite.prototype.destroy=function(){t.Sprite.prototype.destroy.call(this),this.canvasBuffer&&(this.canvasBuffer.destroy(),this.canvasBuffer=null),this.tileScale=null,this.tileScaleOffset=null,this.tilePosition=null,this.tilingTexture&&(this.tilingTexture.destroy(!0),this.tilingTexture=null)},Object.defineProperty(t.TilingSprite.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e}}),Object.defineProperty(t.TilingSprite.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e}}),"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=t),exports.PIXI=t):"undefined"!=typeof define&&define.amd?define("PIXI",e.PIXI=t):e.PIXI=t,t}.call(this),function(){function e(e,t){this._scaleFactor=e,this._deltaMode=t,this.originalEvent=null}var t=this,i=i||{VERSION:"2.6.2",GAMES:[],AUTO:0,CANVAS:1,WEBGL:2,HEADLESS:3,NONE:0,LEFT:1,RIGHT:2,UP:3,DOWN:4,SPRITE:0,BUTTON:1,IMAGE:2,GRAPHICS:3,TEXT:4,TILESPRITE:5,BITMAPTEXT:6,GROUP:7,RENDERTEXTURE:8,TILEMAP:9,TILEMAPLAYER:10,EMITTER:11,POLYGON:12,BITMAPDATA:13,CANVAS_FILTER:14,WEBGL_FILTER:15,ELLIPSE:16,SPRITEBATCH:17,RETROFONT:18,POINTER:19,ROPE:20,CIRCLE:21,RECTANGLE:22,LINE:23,MATRIX:24,POINT:25,ROUNDEDRECTANGLE:26,CREATURE:27,VIDEO:28,PENDING_ATLAS:-1,HORIZONTAL:0,VERTICAL:1,LANDSCAPE:0,PORTRAIT:1,ANGLE_UP:270,ANGLE_DOWN:90,ANGLE_LEFT:180,ANGLE_RIGHT:0,ANGLE_NORTH_EAST:315,ANGLE_NORTH_WEST:225,ANGLE_SOUTH_EAST:45,ANGLE_SOUTH_WEST:135,TOP_LEFT:0,TOP_CENTER:1,TOP_RIGHT:2,LEFT_TOP:3,LEFT_CENTER:4,LEFT_BOTTOM:5,CENTER:6,RIGHT_TOP:7,RIGHT_CENTER:8,RIGHT_BOTTOM:9,BOTTOM_LEFT:10,BOTTOM_CENTER:11,BOTTOM_RIGHT:12,blendModes:{NORMAL:0,ADD:1,MULTIPLY:2,SCREEN:3,OVERLAY:4,DARKEN:5,LIGHTEN:6,COLOR_DODGE:7,COLOR_BURN:8,HARD_LIGHT:9,SOFT_LIGHT:10,DIFFERENCE:11,EXCLUSION:12,HUE:13,SATURATION:14,COLOR:15,LUMINOSITY:16},scaleModes:{DEFAULT:0,LINEAR:0,NEAREST:1},PIXI:PIXI||{}};if(Math.trunc||(Math.trunc=function(e){return e<0?Math.ceil(e):Math.floor(e)}),Function.prototype.bind||(Function.prototype.bind=function(){var e=Array.prototype.slice;return function(t){function i(){var n=a.concat(e.call(arguments));s.apply(this instanceof i?this:t,n)}var s=this,a=e.call(arguments,1);if("function"!=typeof s)throw new TypeError;return i.prototype=function e(t){if(t&&(e.prototype=t),!(this instanceof e))return new e}(s.prototype),i}}()),Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),Array.prototype.forEach||(Array.prototype.forEach=function(e){"use strict";if(void 0===this||null===this)throw new TypeError;var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var s=arguments.length>=2?arguments[1]:void 0,a=0;a<i;a++)a in t&&e.call(s,t[a],a,t)}),"function"!=typeof window.Uint32Array&&"object"!=typeof window.Uint32Array){var s=function(e){var t=new Array;window[e]=function(e){if("number"==typeof e){Array.call(this,e),this.length=e;for(t=0;t<this.length;t++)this[t]=0}else{Array.call(this,e.length),this.length=e.length;for(var t=0;t<this.length;t++)this[t]=e[t]}},window[e].prototype=t,window[e].constructor=window[e]};s("Uint32Array"),s("Int16Array")}window.console||(window.console={},window.console.log=window.console.assert=function(){},window.console.warn=window.console.assert=function(){}),i.Utils={reverseString:function(e){return e.split("").reverse().join("")},getProperty:function(e,t){for(var i=t.split("."),s=i.pop(),a=i.length,n=1,o=i[0];n<a&&(e=e[o]);)o=i[n],n++;return e?e[s]:null},setProperty:function(e,t,i){for(var s=t.split("."),a=s.pop(),n=s.length,o=1,r=s[0];o<n&&(e=e[r]);)r=s[o],o++;return e&&(e[a]=i),e},chanceRoll:function(e){return void 0===e&&(e=50),e>0&&100*Math.random()<=e},randomChoice:function(e,t){return Math.random()<.5?e:t},parseDimension:function(e,t){var i=0,s=0;return"string"==typeof e?"%"===e.substr(-1)?(i=parseInt(e,10)/100,s=0===t?window.innerWidth*i:window.innerHeight*i):s=parseInt(e,10):s=e,s},pad:function(e,t,i,s){if(void 0===t)var t=0;if(void 0===i)var i=" ";if(void 0===s)var s=3;var a=0;if(t+1>=(e=e.toString()).length)switch(s){case 1:e=new Array(t+1-e.length).join(i)+e;break;case 3:var n=Math.ceil((a=t-e.length)/2),o=a-n;e=new Array(o+1).join(i)+e+new Array(n+1).join(i);break;default:e+=new Array(t+1-e.length).join(i)}return e},isPlainObject:function(e){if("object"!=typeof e||e.nodeType||e===e.window)return!1;try{if(e.constructor&&!{}.hasOwnProperty.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}return!0},extend:function(){var e,t,s,a,n,o,r=arguments[0]||{},l=1,h=arguments.length,c=!1;for("boolean"==typeof r&&(c=r,r=arguments[1]||{},l=2),h===l&&(r=this,--l);l<h;l++)if(null!=(e=arguments[l]))for(t in e)s=r[t],a=e[t],r!==a&&(c&&a&&(i.Utils.isPlainObject(a)||(n=Array.isArray(a)))?(n?(n=!1,o=s&&Array.isArray(s)?s:[]):o=s&&i.Utils.isPlainObject(s)?s:{},r[t]=i.Utils.extend(c,o,a)):void 0!==a&&(r[t]=a));return r},mixinPrototype:function(e,t,i){void 0===i&&(i=!1);for(var s=Object.keys(t),a=0;a<s.length;a++){var n=s[a],o=t[n];!i&&n in e||(!o||"function"!=typeof o.get&&"function"!=typeof o.set?e[n]=o:"function"==typeof o.clone?e[n]=o.clone():Object.defineProperty(e,n,o))}},mixin:function(e,t){if(!e||"object"!=typeof e)return t;for(var s in e){var a=e[s];if(!a.childNodes&&!a.cloneNode){var n=typeof e[s];e[s]&&"object"===n?typeof t[s]===n?t[s]=i.Utils.mixin(e[s],t[s]):t[s]=i.Utils.mixin(e[s],new a.constructor):t[s]=e[s]}}return t}},i.Circle=function(e,t,s){e=e||0,t=t||0,s=s||0,this.x=e,this.y=t,this._diameter=s,this._radius=0,s>0&&(this._radius=.5*s),this.type=i.CIRCLE},i.Circle.prototype={circumference:function(){return Math.PI*this._radius*2},random:function(e){void 0===e&&(e=new i.Point);var t=2*Math.PI*Math.random(),s=Math.random()+Math.random(),a=s>1?2-s:s,n=a*Math.cos(t),o=a*Math.sin(t);return e.x=this.x+n*this.radius,e.y=this.y+o*this.radius,e},getBounds:function(){return new i.Rectangle(this.x-this.radius,this.y-this.radius,this.diameter,this.diameter)},setTo:function(e,t,i){return this.x=e,this.y=t,this._diameter=i,this._radius=.5*i,this},copyFrom:function(e){return this.setTo(e.x,e.y,e.diameter)},copyTo:function(e){return e.x=this.x,e.y=this.y,e.diameter=this._diameter,e},distance:function(e,t){var s=i.Math.distance(this.x,this.y,e.x,e.y);return t?Math.round(s):s},clone:function(e){return void 0===e||null===e?e=new i.Circle(this.x,this.y,this.diameter):e.setTo(this.x,this.y,this.diameter),e},contains:function(e,t){return i.Circle.contains(this,e,t)},circumferencePoint:function(e,t,s){return i.Circle.circumferencePoint(this,e,t,s)},offset:function(e,t){return this.x+=e,this.y+=t,this},offsetPoint:function(e){return this.offset(e.x,e.y)},toString:function(){return"[{Phaser.Circle (x="+this.x+" y="+this.y+" diameter="+this.diameter+" radius="+this.radius+")}]"}},i.Circle.prototype.constructor=i.Circle,Object.defineProperty(i.Circle.prototype,"diameter",{get:function(){return this._diameter},set:function(e){e>0&&(this._diameter=e,this._radius=.5*e)}}),Object.defineProperty(i.Circle.prototype,"radius",{get:function(){return this._radius},set:function(e){e>0&&(this._radius=e,this._diameter=2*e)}}),Object.defineProperty(i.Circle.prototype,"left",{get:function(){return this.x-this._radius},set:function(e){e>this.x?(this._radius=0,this._diameter=0):this.radius=this.x-e}}),Object.defineProperty(i.Circle.prototype,"right",{get:function(){return this.x+this._radius},set:function(e){e<this.x?(this._radius=0,this._diameter=0):this.radius=e-this.x}}),Object.defineProperty(i.Circle.prototype,"top",{get:function(){return this.y-this._radius},set:function(e){e>this.y?(this._radius=0,this._diameter=0):this.radius=this.y-e}}),Object.defineProperty(i.Circle.prototype,"bottom",{get:function(){return this.y+this._radius},set:function(e){e<this.y?(this._radius=0,this._diameter=0):this.radius=e-this.y}}),Object.defineProperty(i.Circle.prototype,"area",{get:function(){return this._radius>0?Math.PI*this._radius*this._radius:0}}),Object.defineProperty(i.Circle.prototype,"empty",{get:function(){return 0===this._diameter},set:function(e){!0===e&&this.setTo(0,0,0)}}),i.Circle.contains=function(e,t,i){return e.radius>0&&t>=e.left&&t<=e.right&&i>=e.top&&i<=e.bottom&&(e.x-t)*(e.x-t)+(e.y-i)*(e.y-i)<=e.radius*e.radius},i.Circle.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.diameter===t.diameter},i.Circle.intersects=function(e,t){return i.Math.distance(e.x,e.y,t.x,t.y)<=e.radius+t.radius},i.Circle.circumferencePoint=function(e,t,s,a){return void 0===s&&(s=!1),void 0===a&&(a=new i.Point),!0===s&&(t=i.Math.degToRad(t)),a.x=e.x+e.radius*Math.cos(t),a.y=e.y+e.radius*Math.sin(t),a},i.Circle.intersectsRectangle=function(e,t){var i=Math.abs(e.x-t.x-t.halfWidth);if(i>t.halfWidth+e.radius)return!1;var s=Math.abs(e.y-t.y-t.halfHeight);if(s>t.halfHeight+e.radius)return!1;if(i<=t.halfWidth||s<=t.halfHeight)return!0;var a=i-t.halfWidth,n=s-t.halfHeight;return a*a+n*n<=e.radius*e.radius},PIXI.Circle=i.Circle,i.Ellipse=function(e,t,s,a){e=e||0,t=t||0,s=s||0,a=a||0,this.x=e,this.y=t,this.width=s,this.height=a,this.type=i.ELLIPSE},i.Ellipse.prototype={setTo:function(e,t,i,s){return this.x=e,this.y=t,this.width=i,this.height=s,this},getBounds:function(){return new i.Rectangle(this.x-this.width,this.y-this.height,this.width,this.height)},copyFrom:function(e){return this.setTo(e.x,e.y,e.width,e.height)},copyTo:function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},clone:function(e){return void 0===e||null===e?e=new i.Ellipse(this.x,this.y,this.width,this.height):e.setTo(this.x,this.y,this.width,this.height),e},contains:function(e,t){return i.Ellipse.contains(this,e,t)},random:function(e){void 0===e&&(e=new i.Point);var t=Math.random()*Math.PI*2,s=Math.random();return e.x=Math.sqrt(s)*Math.cos(t),e.y=Math.sqrt(s)*Math.sin(t),e.x=this.x+e.x*this.width/2,e.y=this.y+e.y*this.height/2,e},toString:function(){return"[{Phaser.Ellipse (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+")}]"}},i.Ellipse.prototype.constructor=i.Ellipse,Object.defineProperty(i.Ellipse.prototype,"left",{get:function(){return this.x},set:function(e){this.x=e}}),Object.defineProperty(i.Ellipse.prototype,"right",{get:function(){return this.x+this.width},set:function(e){e<this.x?this.width=0:this.width=e-this.x}}),Object.defineProperty(i.Ellipse.prototype,"top",{get:function(){return this.y},set:function(e){this.y=e}}),Object.defineProperty(i.Ellipse.prototype,"bottom",{get:function(){return this.y+this.height},set:function(e){e<this.y?this.height=0:this.height=e-this.y}}),Object.defineProperty(i.Ellipse.prototype,"empty",{get:function(){return 0===this.width||0===this.height},set:function(e){!0===e&&this.setTo(0,0,0,0)}}),i.Ellipse.contains=function(e,t,i){if(e.width<=0||e.height<=0)return!1;var s=(t-e.x)/e.width-.5,a=(i-e.y)/e.height-.5;return s*=s,a*=a,s+a<.25},PIXI.Ellipse=i.Ellipse,i.Line=function(e,t,s,a){e=e||0,t=t||0,s=s||0,a=a||0,this.start=new i.Point(e,t),this.end=new i.Point(s,a),this.type=i.LINE},i.Line.prototype={setTo:function(e,t,i,s){return this.start.setTo(e,t),this.end.setTo(i,s),this},fromSprite:function(e,t,i){return void 0===i&&(i=!1),i?this.setTo(e.center.x,e.center.y,t.center.x,t.center.y):this.setTo(e.x,e.y,t.x,t.y)},fromAngle:function(e,t,i,s){return this.start.setTo(e,t),this.end.setTo(e+Math.cos(i)*s,t+Math.sin(i)*s),this},rotate:function(e,t){var i=(this.start.x+this.end.x)/2,s=(this.start.y+this.end.y)/2;return this.start.rotate(i,s,e,t),this.end.rotate(i,s,e,t),this},rotateAround:function(e,t,i,s){return this.start.rotate(e,t,i,s),this.end.rotate(e,t,i,s),this},intersects:function(e,t,s){return i.Line.intersectsPoints(this.start,this.end,e.start,e.end,t,s)},reflect:function(e){return i.Line.reflect(this,e)},midPoint:function(e){return void 0===e&&(e=new i.Point),e.x=(this.start.x+this.end.x)/2,e.y=(this.start.y+this.end.y)/2,e},centerOn:function(e,t){var i=e-(this.start.x+this.end.x)/2,s=t-(this.start.y+this.end.y)/2;this.start.add(i,s),this.end.add(i,s)},pointOnLine:function(e,t){return(e-this.start.x)*(this.end.y-this.start.y)==(this.end.x-this.start.x)*(t-this.start.y)},pointOnSegment:function(e,t){var i=Math.min(this.start.x,this.end.x),s=Math.max(this.start.x,this.end.x),a=Math.min(this.start.y,this.end.y),n=Math.max(this.start.y,this.end.y);return this.pointOnLine(e,t)&&e>=i&&e<=s&&t>=a&&t<=n},random:function(e){void 0===e&&(e=new i.Point);var t=Math.random();return e.x=this.start.x+t*(this.end.x-this.start.x),e.y=this.start.y+t*(this.end.y-this.start.y),e},coordinatesOnLine:function(e,t){void 0===e&&(e=1),void 0===t&&(t=[]);var i=Math.round(this.start.x),s=Math.round(this.start.y),a=Math.round(this.end.x),n=Math.round(this.end.y),o=Math.abs(a-i),r=Math.abs(n-s),l=i<a?1:-1,h=s<n?1:-1,c=o-r;t.push([i,s]);for(var p=1;i!==a||s!==n;){var d=c<<1;d>-r&&(c-=r,i+=l),d<o&&(c+=o,s+=h),p%e==0&&t.push([i,s]),p++}return t},clone:function(e){return void 0===e||null===e?e=new i.Line(this.start.x,this.start.y,this.end.x,this.end.y):e.setTo(this.start.x,this.start.y,this.end.x,this.end.y),e}},Object.defineProperty(i.Line.prototype,"length",{get:function(){return Math.sqrt((this.end.x-this.start.x)*(this.end.x-this.start.x)+(this.end.y-this.start.y)*(this.end.y-this.start.y))}}),Object.defineProperty(i.Line.prototype,"angle",{get:function(){return Math.atan2(this.end.y-this.start.y,this.end.x-this.start.x)}}),Object.defineProperty(i.Line.prototype,"slope",{get:function(){return(this.end.y-this.start.y)/(this.end.x-this.start.x)}}),Object.defineProperty(i.Line.prototype,"perpSlope",{get:function(){return-(this.end.x-this.start.x)/(this.end.y-this.start.y)}}),Object.defineProperty(i.Line.prototype,"x",{get:function(){return Math.min(this.start.x,this.end.x)}}),Object.defineProperty(i.Line.prototype,"y",{get:function(){return Math.min(this.start.y,this.end.y)}}),Object.defineProperty(i.Line.prototype,"left",{get:function(){return Math.min(this.start.x,this.end.x)}}),Object.defineProperty(i.Line.prototype,"right",{get:function(){return Math.max(this.start.x,this.end.x)}}),Object.defineProperty(i.Line.prototype,"top",{get:function(){return Math.min(this.start.y,this.end.y)}}),Object.defineProperty(i.Line.prototype,"bottom",{get:function(){return Math.max(this.start.y,this.end.y)}}),Object.defineProperty(i.Line.prototype,"width",{get:function(){return Math.abs(this.start.x-this.end.x)}}),Object.defineProperty(i.Line.prototype,"height",{get:function(){return Math.abs(this.start.y-this.end.y)}}),Object.defineProperty(i.Line.prototype,"normalX",{get:function(){return Math.cos(this.angle-1.5707963267948966)}}),Object.defineProperty(i.Line.prototype,"normalY",{get:function(){return Math.sin(this.angle-1.5707963267948966)}}),Object.defineProperty(i.Line.prototype,"normalAngle",{get:function(){return i.Math.wrap(this.angle-1.5707963267948966,-Math.PI,Math.PI)}}),i.Line.intersectsPoints=function(e,t,s,a,n,o){void 0===n&&(n=!0),void 0===o&&(o=new i.Point);var r=t.y-e.y,l=a.y-s.y,h=e.x-t.x,c=s.x-a.x,p=t.x*e.y-e.x*t.y,d=a.x*s.y-s.x*a.y,u=r*c-l*h;if(0===u)return null;if(o.x=(h*d-c*p)/u,o.y=(l*p-r*d)/u,n){var m=(a.y-s.y)*(t.x-e.x)-(a.x-s.x)*(t.y-e.y),g=((a.x-s.x)*(e.y-s.y)-(a.y-s.y)*(e.x-s.x))/m,y=((t.x-e.x)*(e.y-s.y)-(t.y-e.y)*(e.x-s.x))/m;return g>=0&&g<=1&&y>=0&&y<=1?o:null}return o},i.Line.intersects=function(e,t,s,a){return i.Line.intersectsPoints(e.start,e.end,t.start,t.end,s,a)},i.Line.intersectsRectangle=function(e,t){if(!i.Rectangle.intersects(e,t))return!1;var s=e.start.x,a=e.start.y,n=e.end.x,o=e.end.y,r=t.x,l=t.y,h=t.right,c=t.bottom,p=0;if(s>=r&&s<=h&&a>=l&&a<=c||n>=r&&n<=h&&o>=l&&o<=c)return!0;if(s<r&&n>=r){if((p=a+(o-a)*(r-s)/(n-s))>l&&p<=c)return!0}else if(s>h&&n<=h&&(p=a+(o-a)*(h-s)/(n-s))>=l&&p<=c)return!0;if(a<l&&o>=l){if((p=s+(n-s)*(l-a)/(o-a))>=r&&p<=h)return!0}else if(a>c&&o<=c&&(p=s+(n-s)*(c-a)/(o-a))>=r&&p<=h)return!0;return!1},i.Line.reflect=function(e,t){return 2*t.normalAngle-3.141592653589793-e.angle},i.Matrix=function(e,t,s,a,n,o){void 0!==e&&null!==e||(e=1),void 0!==t&&null!==t||(t=0),void 0!==s&&null!==s||(s=0),void 0!==a&&null!==a||(a=1),void 0!==n&&null!==n||(n=0),void 0!==o&&null!==o||(o=0),this.a=e,this.b=t,this.c=s,this.d=a,this.tx=n,this.ty=o,this.type=i.MATRIX},i.Matrix.prototype={fromArray:function(e){return this.setTo(e[0],e[1],e[3],e[4],e[2],e[5])},setTo:function(e,t,i,s,a,n){return this.a=e,this.b=t,this.c=i,this.d=s,this.tx=a,this.ty=n,this},clone:function(e){return void 0===e||null===e?e=new i.Matrix(this.a,this.b,this.c,this.d,this.tx,this.ty):(e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty),e},copyTo:function(e){return e.copyFrom(this),e},copyFrom:function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},toArray:function(e,t){return void 0===t&&(t=new PIXI.Float32Array(9)),e?(t[0]=this.a,t[1]=this.b,t[2]=0,t[3]=this.c,t[4]=this.d,t[5]=0,t[6]=this.tx,t[7]=this.ty,t[8]=1):(t[0]=this.a,t[1]=this.c,t[2]=this.tx,t[3]=this.b,t[4]=this.d,t[5]=this.ty,t[6]=0,t[7]=0,t[8]=1),t},apply:function(e,t){return void 0===t&&(t=new i.Point),t.x=this.a*e.x+this.c*e.y+this.tx,t.y=this.b*e.x+this.d*e.y+this.ty,t},applyInverse:function(e,t){void 0===t&&(t=new i.Point);var s=1/(this.a*this.d+this.c*-this.b),a=e.x,n=e.y;return t.x=this.d*s*a+-this.c*s*n+(this.ty*this.c-this.tx*this.d)*s,t.y=this.a*s*n+-this.b*s*a+(-this.ty*this.a+this.tx*this.b)*s,t},translate:function(e,t){return this.tx+=e,this.ty+=t,this},scale:function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},rotate:function(e){var t=Math.cos(e),i=Math.sin(e),s=this.a,a=this.c,n=this.tx;return this.a=s*t-this.b*i,this.b=s*i+this.b*t,this.c=a*t-this.d*i,this.d=a*i+this.d*t,this.tx=n*t-this.ty*i,this.ty=n*i+this.ty*t,this},append:function(e){var t=this.a,i=this.b,s=this.c,a=this.d;return this.a=e.a*t+e.b*s,this.b=e.a*i+e.b*a,this.c=e.c*t+e.d*s,this.d=e.c*i+e.d*a,this.tx=e.tx*t+e.ty*s+this.tx,this.ty=e.tx*i+e.ty*a+this.ty,this},identity:function(){return this.setTo(1,0,0,1,0,0)}},i.identityMatrix=new i.Matrix,PIXI.Matrix=i.Matrix,PIXI.identityMatrix=i.identityMatrix,i.Point=function(e,t){e=e||0,t=t||0,this.x=e,this.y=t,this.type=i.POINT},i.Point.prototype={copyFrom:function(e){return this.setTo(e.x,e.y)},invert:function(){return this.setTo(this.y,this.x)},setTo:function(e,t){return this.x=e||0,this.y=t||(0!==t?this.x:0),this},set:function(e,t){return this.x=e||0,this.y=t||(0!==t?this.x:0),this},add:function(e,t){return this.x+=e,this.y+=t,this},subtract:function(e,t){return this.x-=e,this.y-=t,this},multiply:function(e,t){return this.x*=e,this.y*=t,this},divide:function(e,t){return this.x/=e,this.y/=t,this},clampX:function(e,t){return this.x=i.Math.clamp(this.x,e,t),this},clampY:function(e,t){return this.y=i.Math.clamp(this.y,e,t),this},clamp:function(e,t){return this.x=i.Math.clamp(this.x,e,t),this.y=i.Math.clamp(this.y,e,t),this},clone:function(e){return void 0===e||null===e?e=new i.Point(this.x,this.y):e.setTo(this.x,this.y),e},copyTo:function(e){return e.x=this.x,e.y=this.y,e},distance:function(e,t){return i.Point.distance(this,e,t)},equals:function(e){return e.x===this.x&&e.y===this.y},angle:function(e,t){return void 0===t&&(t=!1),t?i.Math.radToDeg(Math.atan2(e.y-this.y,e.x-this.x)):Math.atan2(e.y-this.y,e.x-this.x)},rotate:function(e,t,s,a,n){return i.Point.rotate(this,e,t,s,a,n)},getMagnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},getMagnitudeSq:function(){return this.x*this.x+this.y*this.y},setMagnitude:function(e){return this.normalize().multiply(e,e)},normalize:function(){if(!this.isZero()){var e=this.getMagnitude();this.x/=e,this.y/=e}return this},isZero:function(){return 0===this.x&&0===this.y},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},perp:function(){return this.setTo(-this.y,this.x)},rperp:function(){return this.setTo(this.y,-this.x)},normalRightHand:function(){return this.setTo(-1*this.y,this.x)},floor:function(){return this.setTo(Math.floor(this.x),Math.floor(this.y))},ceil:function(){return this.setTo(Math.ceil(this.x),Math.ceil(this.y))},toString:function(){return"[{Point (x="+this.x+" y="+this.y+")}]"}},i.Point.prototype.constructor=i.Point,i.Point.add=function(e,t,s){return void 0===s&&(s=new i.Point),s.x=e.x+t.x,s.y=e.y+t.y,s},i.Point.subtract=function(e,t,s){return void 0===s&&(s=new i.Point),s.x=e.x-t.x,s.y=e.y-t.y,s},i.Point.multiply=function(e,t,s){return void 0===s&&(s=new i.Point),s.x=e.x*t.x,s.y=e.y*t.y,s},i.Point.divide=function(e,t,s){return void 0===s&&(s=new i.Point),s.x=e.x/t.x,s.y=e.y/t.y,s},i.Point.equals=function(e,t){return e.x===t.x&&e.y===t.y},i.Point.angle=function(e,t){return Math.atan2(e.y-t.y,e.x-t.x)},i.Point.negative=function(e,t){return void 0===t&&(t=new i.Point),t.setTo(-e.x,-e.y)},i.Point.multiplyAdd=function(e,t,s,a){return void 0===a&&(a=new i.Point),a.setTo(e.x+t.x*s,e.y+t.y*s)},i.Point.interpolate=function(e,t,s,a){return void 0===a&&(a=new i.Point),a.setTo(e.x+(t.x-e.x)*s,e.y+(t.y-e.y)*s)},i.Point.perp=function(e,t){return void 0===t&&(t=new i.Point),t.setTo(-e.y,e.x)},i.Point.rperp=function(e,t){return void 0===t&&(t=new i.Point),t.setTo(e.y,-e.x)},i.Point.distance=function(e,t,s){var a=i.Math.distance(e.x,e.y,t.x,t.y);return s?Math.round(a):a},i.Point.project=function(e,t,s){void 0===s&&(s=new i.Point);var a=e.dot(t)/t.getMagnitudeSq();return 0!==a&&s.setTo(a*t.x,a*t.y),s},i.Point.projectUnit=function(e,t,s){void 0===s&&(s=new i.Point);var a=e.dot(t);return 0!==a&&s.setTo(a*t.x,a*t.y),s},i.Point.normalRightHand=function(e,t){return void 0===t&&(t=new i.Point),t.setTo(-1*e.y,e.x)},i.Point.normalize=function(e,t){void 0===t&&(t=new i.Point);var s=e.getMagnitude();return 0!==s&&t.setTo(e.x/s,e.y/s),t},i.Point.rotate=function(e,t,s,a,n,o){if(n&&(a=i.Math.degToRad(a)),void 0===o){e.subtract(t,s);var r=Math.sin(a),l=Math.cos(a),h=l*e.x-r*e.y,c=r*e.x+l*e.y;e.x=h+t,e.y=c+s}else{var p=a+Math.atan2(e.y-s,e.x-t);e.x=t+o*Math.cos(p),e.y=s+o*Math.sin(p)}return e},i.Point.centroid=function(e,t){if(void 0===t&&(t=new i.Point),"[object Array]"!==Object.prototype.toString.call(e))throw new Error("Phaser.Point. Parameter 'points' must be an array");var s=e.length;if(s<1)throw new Error("Phaser.Point. Parameter 'points' array must not be empty");if(1===s)return t.copyFrom(e[0]),t;for(var a=0;a<s;a++)i.Point.add(t,e[a],t);return t.divide(s,s),t},i.Point.parse=function(e,t,s){t=t||"x",s=s||"y";var a=new i.Point;return e[t]&&(a.x=parseInt(e[t],10)),e[s]&&(a.y=parseInt(e[s],10)),a},PIXI.Point=i.Point,i.Polygon=function(){this.area=0,this._points=[],arguments.length>0&&this.setTo.apply(this,arguments),this.closed=!0,this.flattened=!1,this.type=i.POLYGON},i.Polygon.prototype={toNumberArray:function(e){void 0===e&&(e=[]);for(var t=0;t<this._points.length;t++)"number"==typeof this._points[t]?(e.push(this._points[t]),e.push(this._points[t+1]),t++):(e.push(this._points[t].x),e.push(this._points[t].y));return e},flatten:function(){return this._points=this.toNumberArray(),this.flattened=!0,this},clone:function(e){var t=this._points.slice();return void 0===e||null===e?e=new i.Polygon(t):e.setTo(t),e},contains:function(e,t){var i=!1;if(this.flattened)for(var s=-2,a=this._points.length-2;(s+=2)<this._points.length;a=s){var n=this._points[s],o=this._points[s+1],r=this._points[a],l=this._points[a+1];(o<=t&&t<l||l<=t&&t<o)&&e<(r-n)*(t-o)/(l-o)+n&&(i=!i)}else for(var s=-1,a=this._points.length-1;++s<this._points.length;a=s){var n=this._points[s].x,o=this._points[s].y,r=this._points[a].x,l=this._points[a].y;(o<=t&&t<l||l<=t&&t<o)&&e<(r-n)*(t-o)/(l-o)+n&&(i=!i)}return i},setTo:function(e){if(this.area=0,this._points=[],arguments.length>0){Array.isArray(e)||(e=Array.prototype.slice.call(arguments));for(var t=Number.MAX_VALUE,i=0,s=e.length;i<s;i++){if("number"==typeof e[i]){a=new PIXI.Point(e[i],e[i+1]);i++}else if(Array.isArray(e[i]))a=new PIXI.Point(e[i][0],e[i][1]);else var a=new PIXI.Point(e[i].x,e[i].y);this._points.push(a),a.y<t&&(t=a.y)}this.calculateArea(t)}return this},calculateArea:function(e){for(var t,i,s,a,n=0,o=this._points.length;n<o;n++)t=this._points[n],i=n===o-1?this._points[0]:this._points[n+1],s=(t.y-e+(i.y-e))/2,a=t.x-i.x,this.area+=s*a;return this.area}},i.Polygon.prototype.constructor=i.Polygon,Object.defineProperty(i.Polygon.prototype,"points",{get:function(){return this._points},set:function(e){null!=e?this.setTo(e):this.setTo()}}),PIXI.Polygon=i.Polygon,i.Rectangle=function(e,t,s,a){e=e||0,t=t||0,s=s||0,a=a||0,this.x=e,this.y=t,this.width=s,this.height=a,this.type=i.RECTANGLE},i.Rectangle.prototype={offset:function(e,t){return this.x+=e,this.y+=t,this},offsetPoint:function(e){return this.offset(e.x,e.y)},setTo:function(e,t,i,s){return this.x=e,this.y=t,this.width=i,this.height=s,this},scale:function(e,t){return void 0===t&&(t=e),this.width*=e,this.height*=t,this},centerOn:function(e,t){return this.centerX=e,this.centerY=t,this},floor:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},floorAll:function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=Math.floor(this.width),this.height=Math.floor(this.height)},ceil:function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y)},ceilAll:function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.width=Math.ceil(this.width),this.height=Math.ceil(this.height)},copyFrom:function(e){return this.setTo(e.x,e.y,e.width,e.height)},copyTo:function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},inflate:function(e,t){return i.Rectangle.inflate(this,e,t)},size:function(e){return i.Rectangle.size(this,e)},resize:function(e,t){return this.width=e,this.height=t,this},clone:function(e){return i.Rectangle.clone(this,e)},contains:function(e,t){return i.Rectangle.contains(this,e,t)},containsRect:function(e){return i.Rectangle.containsRect(e,this)},equals:function(e){return i.Rectangle.equals(this,e)},intersection:function(e,t){return i.Rectangle.intersection(this,e,t)},intersects:function(e){return i.Rectangle.intersects(this,e)},intersectsRaw:function(e,t,s,a,n){return i.Rectangle.intersectsRaw(this,e,t,s,a,n)},union:function(e,t){return i.Rectangle.union(this,e,t)},random:function(e){return void 0===e&&(e=new i.Point),e.x=this.randomX,e.y=this.randomY,e},getPoint:function(e,t){switch(void 0===t&&(t=new i.Point),e){default:case i.TOP_LEFT:return t.set(this.x,this.y);case i.TOP_CENTER:return t.set(this.centerX,this.y);case i.TOP_RIGHT:return t.set(this.right,this.y);case i.LEFT_CENTER:return t.set(this.x,this.centerY);case i.CENTER:return t.set(this.centerX,this.centerY);case i.RIGHT_CENTER:return t.set(this.right,this.centerY);case i.BOTTOM_LEFT:return t.set(this.x,this.bottom);case i.BOTTOM_CENTER:return t.set(this.centerX,this.bottom);case i.BOTTOM_RIGHT:return t.set(this.right,this.bottom)}},toString:function(){return"[{Rectangle (x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+" empty="+this.empty+")}]"}},Object.defineProperty(i.Rectangle.prototype,"halfWidth",{get:function(){return Math.round(this.width/2)}}),Object.defineProperty(i.Rectangle.prototype,"halfHeight",{get:function(){return Math.round(this.height/2)}}),Object.defineProperty(i.Rectangle.prototype,"bottom",{get:function(){return this.y+this.height},set:function(e){e<=this.y?this.height=0:this.height=e-this.y}}),Object.defineProperty(i.Rectangle.prototype,"bottomLeft",{get:function(){return new i.Point(this.x,this.bottom)},set:function(e){this.x=e.x,this.bottom=e.y}}),Object.defineProperty(i.Rectangle.prototype,"bottomRight",{get:function(){return new i.Point(this.right,this.bottom)},set:function(e){this.right=e.x,this.bottom=e.y}}),Object.defineProperty(i.Rectangle.prototype,"left",{get:function(){return this.x},set:function(e){e>=this.right?this.width=0:this.width=this.right-e,this.x=e}}),Object.defineProperty(i.Rectangle.prototype,"right",{get:function(){return this.x+this.width},set:function(e){e<=this.x?this.width=0:this.width=e-this.x}}),Object.defineProperty(i.Rectangle.prototype,"volume",{get:function(){return this.width*this.height}}),Object.defineProperty(i.Rectangle.prototype,"perimeter",{get:function(){return 2*this.width+2*this.height}}),Object.defineProperty(i.Rectangle.prototype,"centerX",{get:function(){return this.x+this.halfWidth},set:function(e){this.x=e-this.halfWidth}}),Object.defineProperty(i.Rectangle.prototype,"centerY",{get:function(){return this.y+this.halfHeight},set:function(e){this.y=e-this.halfHeight}}),Object.defineProperty(i.Rectangle.prototype,"randomX",{get:function(){return this.x+Math.random()*this.width}}),Object.defineProperty(i.Rectangle.prototype,"randomY",{get:function(){return this.y+Math.random()*this.height}}),Object.defineProperty(i.Rectangle.prototype,"top",{get:function(){return this.y},set:function(e){e>=this.bottom?(this.height=0,this.y=e):this.height=this.bottom-e}}),Object.defineProperty(i.Rectangle.prototype,"topLeft",{get:function(){return new i.Point(this.x,this.y)},set:function(e){this.x=e.x,this.y=e.y}}),Object.defineProperty(i.Rectangle.prototype,"topRight",{get:function(){return new i.Point(this.x+this.width,this.y)},set:function(e){this.right=e.x,this.y=e.y}}),Object.defineProperty(i.Rectangle.prototype,"empty",{get:function(){return!this.width||!this.height},set:function(e){!0===e&&this.setTo(0,0,0,0)}}),i.Rectangle.prototype.constructor=i.Rectangle,i.Rectangle.inflate=function(e,t,i){return e.x-=t,e.width+=2*t,e.y-=i,e.height+=2*i,e},i.Rectangle.inflatePoint=function(e,t){return i.Rectangle.inflate(e,t.x,t.y)},i.Rectangle.size=function(e,t){return void 0===t||null===t?t=new i.Point(e.width,e.height):t.setTo(e.width,e.height),t},i.Rectangle.clone=function(e,t){return void 0===t||null===t?t=new i.Rectangle(e.x,e.y,e.width,e.height):t.setTo(e.x,e.y,e.width,e.height),t},i.Rectangle.contains=function(e,t,i){return!(e.width<=0||e.height<=0)&&t>=e.x&&t<e.right&&i>=e.y&&i<e.bottom},i.Rectangle.containsRaw=function(e,t,i,s,a,n){return a>=e&&a<e+i&&n>=t&&n<t+s},i.Rectangle.containsPoint=function(e,t){return i.Rectangle.contains(e,t.x,t.y)},i.Rectangle.containsRect=function(e,t){return!(e.volume>t.volume)&&e.x>=t.x&&e.y>=t.y&&e.right<t.right&&e.bottom<t.bottom},i.Rectangle.equals=function(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height},i.Rectangle.sameDimensions=function(e,t){return e.width===t.width&&e.height===t.height},i.Rectangle.intersection=function(e,t,s){return void 0===s&&(s=new i.Rectangle),i.Rectangle.intersects(e,t)&&(s.x=Math.max(e.x,t.x),s.y=Math.max(e.y,t.y),s.width=Math.min(e.right,t.right)-s.x,s.height=Math.min(e.bottom,t.bottom)-s.y),s},i.Rectangle.intersects=function(e,t){return!(e.width<=0||e.height<=0||t.width<=0||t.height<=0||e.right<t.x||e.bottom<t.y||e.x>t.right||e.y>t.bottom)},i.Rectangle.intersectsRaw=function(e,t,i,s,a,n){return void 0===n&&(n=0),!(t>e.right+n||i<e.left-n||s>e.bottom+n||a<e.top-n)},i.Rectangle.union=function(e,t,s){return void 0===s&&(s=new i.Rectangle),s.setTo(Math.min(e.x,t.x),Math.min(e.y,t.y),Math.max(e.right,t.right)-Math.min(e.left,t.left),Math.max(e.bottom,t.bottom)-Math.min(e.top,t.top))},i.Rectangle.aabb=function(e,t){void 0===t&&(t=new i.Rectangle);var s=Number.NEGATIVE_INFINITY,a=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,o=Number.POSITIVE_INFINITY;return e.forEach(function(e){e.x>s&&(s=e.x),e.x<a&&(a=e.x),e.y>n&&(n=e.y),e.y<o&&(o=e.y)}),t.setTo(a,o,s-a,n-o),t},PIXI.Rectangle=i.Rectangle,PIXI.EmptyRectangle=new i.Rectangle(0,0,0,0),i.RoundedRectangle=function(e,t,s,a,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===n&&(n=20),this.x=e,this.y=t,this.width=s,this.height=a,this.radius=n||20,this.type=i.ROUNDEDRECTANGLE},i.RoundedRectangle.prototype={clone:function(){return new i.RoundedRectangle(this.x,this.y,this.width,this.height,this.radius)},contains:function(e,t){if(this.width<=0||this.height<=0)return!1;var i=this.x;if(e>=i&&e<=i+this.width){var s=this.y;if(t>=s&&t<=s+this.height)return!0}return!1}},i.RoundedRectangle.prototype.constructor=i.RoundedRectangle,PIXI.RoundedRectangle=i.RoundedRectangle,i.Camera=function(e,t,s,a,n,o){this.game=e,this.world=e.world,this.id=0,this.view=new i.Rectangle(s,a,n,o),this.bounds=new i.Rectangle(s,a,n,o),this.deadzone=null,this.visible=!0,this.roundPx=!0,this.atLimit={x:!1,y:!1},this.target=null,this.displayObject=null,this.scale=null,this.totalInView=0,this.lerp=new i.Point(1,1),this.onShakeComplete=new i.Signal,this.onFlashComplete=new i.Signal,this.onFadeComplete=new i.Signal,this.fx=null,this._targetPosition=new i.Point,this._edge=0,this._position=new i.Point,this._shake={intensity:0,duration:0,horizontal:!1,vertical:!1,shakeBounds:!0,x:0,y:0},this._fxDuration=0,this._fxType=0},i.Camera.FOLLOW_LOCKON=0,i.Camera.FOLLOW_PLATFORMER=1,i.Camera.FOLLOW_TOPDOWN=2,i.Camera.FOLLOW_TOPDOWN_TIGHT=3,i.Camera.SHAKE_BOTH=4,i.Camera.SHAKE_HORIZONTAL=5,i.Camera.SHAKE_VERTICAL=6,i.Camera.ENABLE_FX=!0,i.Camera.prototype={boot:function(){this.displayObject=this.game.world,this.scale=this.game.world.scale,this.game.camera=this,i.Graphics&&i.Camera.ENABLE_FX&&(this.fx=new i.Graphics(this.game),this.game.stage.addChild(this.fx))},preUpdate:function(){this.totalInView=0},follow:function(e,t,s,a){void 0===t&&(t=i.Camera.FOLLOW_LOCKON),void 0===s&&(s=1),void 0===a&&(a=1),this.target=e,this.lerp.set(s,a);var n;switch(t){case i.Camera.FOLLOW_PLATFORMER:var o=this.width/8,r=this.height/3;this.deadzone=new i.Rectangle((this.width-o)/2,(this.height-r)/2-.25*r,o,r);break;case i.Camera.FOLLOW_TOPDOWN:n=Math.max(this.width,this.height)/4,this.deadzone=new i.Rectangle((this.width-n)/2,(this.height-n)/2,n,n);break;case i.Camera.FOLLOW_TOPDOWN_TIGHT:n=Math.max(this.width,this.height)/8,this.deadzone=new i.Rectangle((this.width-n)/2,(this.height-n)/2,n,n);break;case i.Camera.FOLLOW_LOCKON:this.deadzone=null;break;default:this.deadzone=null}},unfollow:function(){this.target=null},focusOn:function(e){this.setPosition(Math.round(e.x-this.view.halfWidth),Math.round(e.y-this.view.halfHeight))},focusOnXY:function(e,t){this.setPosition(Math.round(e-this.view.halfWidth),Math.round(t-this.view.halfHeight))},shake:function(e,t,s,a,n){return void 0===e&&(e=.05),void 0===t&&(t=500),void 0===s&&(s=!0),void 0===a&&(a=i.Camera.SHAKE_BOTH),void 0===n&&(n=!0),!(!s&&this._shake.duration>0||(this._shake.intensity=e,this._shake.duration=t,this._shake.shakeBounds=n,this._shake.x=0,this._shake.y=0,this._shake.horizontal=a===i.Camera.SHAKE_BOTH||a===i.Camera.SHAKE_HORIZONTAL,this._shake.vertical=a===i.Camera.SHAKE_BOTH||a===i.Camera.SHAKE_VERTICAL,0))},flash:function(e,t,i){return void 0===e&&(e=16777215),void 0===t&&(t=500),void 0===i&&(i=!1),!(!this.fx||!i&&this._fxDuration>0||(this.fx.clear(),this.fx.beginFill(e),this.fx.drawRect(0,0,this.width,this.height),this.fx.endFill(),this.fx.alpha=1,this._fxDuration=t,this._fxType=0,0))},fade:function(e,t,i){return void 0===e&&(e=0),void 0===t&&(t=500),void 0===i&&(i=!1),!(!this.fx||!i&&this._fxDuration>0||(this.fx.clear(),this.fx.beginFill(e),this.fx.drawRect(0,0,this.width,this.height),this.fx.endFill(),this.fx.alpha=0,this._fxDuration=t,this._fxType=1,0))},update:function(){this._fxDuration>0&&this.updateFX(),this._shake.duration>0&&this.updateShake(),this.bounds&&this.checkBounds(),this.roundPx&&(this.view.floor(),this._shake.x=Math.floor(this._shake.x),this._shake.y=Math.floor(this._shake.y)),this.displayObject.position.x=-this.view.x,this.displayObject.position.y=-this.view.y},updateFX:function(){0===this._fxType?(this.fx.alpha-=this.game.time.elapsedMS/this._fxDuration,this.fx.alpha<=0&&(this._fxDuration=0,this.fx.alpha=0,this.onFlashComplete.dispatch())):(this.fx.alpha+=this.game.time.elapsedMS/this._fxDuration,this.fx.alpha>=1&&(this._fxDuration=0,this.fx.alpha=1,this.onFadeComplete.dispatch()))},updateShake:function(){this._shake.duration-=this.game.time.elapsedMS,this._shake.duration<=0?(this.onShakeComplete.dispatch(),this._shake.x=0,this._shake.y=0):(this._shake.horizontal&&(this._shake.x=this.game.rnd.frac()*this._shake.intensity*this.view.width*2-this._shake.intensity*this.view.width),this._shake.vertical&&(this._shake.y=this.game.rnd.frac()*this._shake.intensity*this.view.height*2-this._shake.intensity*this.view.height))},updateTarget:function(){this._targetPosition.x=this.view.x+this.target.worldPosition.x,this._targetPosition.y=this.view.y+this.target.worldPosition.y,this.deadzone?(this._edge=this._targetPosition.x-this.view.x,this._edge<this.deadzone.left?this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.left,this.lerp.x):this._edge>this.deadzone.right&&(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.deadzone.right,this.lerp.x)),this._edge=this._targetPosition.y-this.view.y,this._edge<this.deadzone.top?this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.top,this.lerp.y):this._edge>this.deadzone.bottom&&(this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.deadzone.bottom,this.lerp.y))):(this.view.x=this.game.math.linear(this.view.x,this._targetPosition.x-this.view.halfWidth,this.lerp.x),this.view.y=this.game.math.linear(this.view.y,this._targetPosition.y-this.view.halfHeight,this.lerp.y)),this.bounds&&this.checkBounds(),this.roundPx&&this.view.floor(),this.displayObject.position.x=-this.view.x,this.displayObject.position.y=-this.view.y},setBoundsToWorld:function(){this.bounds&&this.bounds.copyFrom(this.game.world.bounds)},checkBounds:function(){this.atLimit.x=!1,this.atLimit.y=!1;var e=this.view.x+this._shake.x,t=this.view.right+this._shake.x,i=this.view.y+this._shake.y,s=this.view.bottom+this._shake.y;e<=this.bounds.x*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.x*this.scale.x,this._shake.shakeBounds||(this._shake.x=0)),t>=this.bounds.right*this.scale.x&&(this.atLimit.x=!0,this.view.x=this.bounds.right*this.scale.x-this.width,this._shake.shakeBounds||(this._shake.x=0)),i<=this.bounds.top*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.top*this.scale.y,this._shake.shakeBounds||(this._shake.y=0)),s>=this.bounds.bottom*this.scale.y&&(this.atLimit.y=!0,this.view.y=this.bounds.bottom*this.scale.y-this.height,this._shake.shakeBounds||(this._shake.y=0))},setPosition:function(e,t){this.view.x=e,this.view.y=t,this.bounds&&this.checkBounds()},setSize:function(e,t){this.view.width=e,this.view.height=t},reset:function(){this.target=null,this.view.x=0,this.view.y=0,this._shake.duration=0,this.resetFX()},resetFX:function(){this.fx.clear(),this.fx.alpha=0,this._fxDuration=0}},i.Camera.prototype.constructor=i.Camera,Object.defineProperty(i.Camera.prototype,"x",{get:function(){return this.view.x},set:function(e){this.view.x=e,this.bounds&&this.checkBounds()}}),Object.defineProperty(i.Camera.prototype,"y",{get:function(){return this.view.y},set:function(e){this.view.y=e,this.bounds&&this.checkBounds()}}),Object.defineProperty(i.Camera.prototype,"position",{get:function(){return this._position.set(this.view.x,this.view.y),this._position},set:function(e){void 0!==e.x&&(this.view.x=e.x),void 0!==e.y&&(this.view.y=e.y),this.bounds&&this.checkBounds()}}),Object.defineProperty(i.Camera.prototype,"width",{get:function(){return this.view.width},set:function(e){this.view.width=e}}),Object.defineProperty(i.Camera.prototype,"height",{get:function(){return this.view.height},set:function(e){this.view.height=e}}),Object.defineProperty(i.Camera.prototype,"shakeIntensity",{get:function(){return this._shake.intensity},set:function(e){this._shake.intensity=e}}),i.State=function(){this.game=null,this.key="",this.add=null,this.make=null,this.camera=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.sound=null,this.scale=null,this.stage=null,this.state=null,this.time=null,this.tweens=null,this.world=null,this.particles=null,this.physics=null,this.rnd=null},i.State.prototype={init:function(){},preload:function(){},loadUpdate:function(){},loadRender:function(){},create:function(){},update:function(){},preRender:function(){},render:function(){},resize:function(){},paused:function(){},resumed:function(){},pauseUpdate:function(){},shutdown:function(){}},i.State.prototype.constructor=i.State,i.StateManager=function(e,t){this.game=e,this.states={},this._pendingState=null,void 0!==t&&null!==t&&(this._pendingState=t),this._clearWorld=!1,this._clearCache=!1,this._created=!1,this._args=[],this.current="",this.onStateChange=new i.Signal,this.onInitCallback=null,this.onPreloadCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onResizeCallback=null,this.onPreRenderCallback=null,this.onLoadUpdateCallback=null,this.onLoadRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null,this.onShutDownCallback=null},i.StateManager.prototype={boot:function(){this.game.onPause.add(this.pause,this),this.game.onResume.add(this.resume,this),null!==this._pendingState&&"string"!=typeof this._pendingState&&this.add("default",this._pendingState,!0)},add:function(e,t,s){void 0===s&&(s=!1);var a;return t instanceof i.State?a=t:"object"==typeof t?(a=t,a.game=this.game):"function"==typeof t&&(a=new t(this.game)),this.states[e]=a,s&&(this.game.isBooted?this.start(e):this._pendingState=e),a},remove:function(e){this.current===e&&(this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onPreRenderCallback=null,this.onRenderCallback=null,this.onResizeCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null),delete this.states[e]},start:function(e,t,i){void 0===t&&(t=!0),void 0===i&&(i=!1),this.checkState(e)&&(this._pendingState=e,this._clearWorld=t,this._clearCache=i,arguments.length>3&&(this._args=Array.prototype.splice.call(arguments,3)))},restart:function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!1),this._pendingState=this.current,this._clearWorld=e,this._clearCache=t,arguments.length>2&&(this._args=Array.prototype.slice.call(arguments,2))},dummy:function(){},preUpdate:function(){if(this._pendingState&&this.game.isBooted){var e=this.current;if(this.clearCurrentState(),this.setCurrentState(this._pendingState),this.onStateChange.dispatch(this.current,e),this.current!==this._pendingState)return;this._pendingState=null,this.onPreloadCallback?(this.game.load.reset(!0),this.onPreloadCallback.call(this.callbackContext,this.game),0===this.game.load.totalQueuedFiles()&&0===this.game.load.totalQueuedPacks()?this.loadComplete():this.game.load.start()):this.loadComplete()}},clearCurrentState:function(){this.current&&(this.onShutDownCallback&&this.onShutDownCallback.call(this.callbackContext,this.game),this.game.tweens.removeAll(),this.game.camera.reset(),this.game.input.reset(!0),this.game.physics.clear(),this.game.time.removeAll(),this.game.scale.reset(this._clearWorld),this.game.debug&&this.game.debug.reset(),this._clearWorld&&(this.game.world.shutdown(),this._clearCache&&this.game.cache.destroy()))},checkState:function(e){return!!this.states[e]&&(!!(this.states[e].preload||this.states[e].create||this.states[e].update||this.states[e].render)||!1)},link:function(e){this.states[e].game=this.game,this.states[e].add=this.game.add,this.states[e].make=this.game.make,this.states[e].camera=this.game.camera,this.states[e].cache=this.game.cache,this.states[e].input=this.game.input,this.states[e].load=this.game.load,this.states[e].math=this.game.math,this.states[e].sound=this.game.sound,this.states[e].scale=this.game.scale,this.states[e].state=this,this.states[e].stage=this.game.stage,this.states[e].time=this.game.time,this.states[e].tweens=this.game.tweens,this.states[e].world=this.game.world,this.states[e].particles=this.game.particles,this.states[e].rnd=this.game.rnd,this.states[e].physics=this.game.physics,this.states[e].key=e},unlink:function(e){this.states[e]&&(this.states[e].game=null,this.states[e].add=null,this.states[e].make=null,this.states[e].camera=null,this.states[e].cache=null,this.states[e].input=null,this.states[e].load=null,this.states[e].math=null,this.states[e].sound=null,this.states[e].scale=null,this.states[e].state=null,this.states[e].stage=null,this.states[e].time=null,this.states[e].tweens=null,this.states[e].world=null,this.states[e].particles=null,this.states[e].rnd=null,this.states[e].physics=null)},setCurrentState:function(e){this.callbackContext=this.states[e],this.link(e),this.onInitCallback=this.states[e].init||this.dummy,this.onPreloadCallback=this.states[e].preload||null,this.onLoadRenderCallback=this.states[e].loadRender||null,this.onLoadUpdateCallback=this.states[e].loadUpdate||null,this.onCreateCallback=this.states[e].create||null,this.onUpdateCallback=this.states[e].update||null,this.onPreRenderCallback=this.states[e].preRender||null,this.onRenderCallback=this.states[e].render||null,this.onResizeCallback=this.states[e].resize||null,this.onPausedCallback=this.states[e].paused||null,this.onResumedCallback=this.states[e].resumed||null,this.onPauseUpdateCallback=this.states[e].pauseUpdate||null,this.onShutDownCallback=this.states[e].shutdown||this.dummy,""!==this.current&&this.game.physics.reset(),this.current=e,this._created=!1,this.onInitCallback.apply(this.callbackContext,this._args),e===this._pendingState&&(this._args=[]),this.game._kickstart=!0},getCurrentState:function(){return this.states[this.current]},loadComplete:function(){!1===this._created&&this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game),!1===this._created&&this.onCreateCallback?(this._created=!0,this.onCreateCallback.call(this.callbackContext,this.game)):this._created=!0},pause:function(){this._created&&this.onPausedCallback&&this.onPausedCallback.call(this.callbackContext,this.game)},resume:function(){this._created&&this.onResumedCallback&&this.onResumedCallback.call(this.callbackContext,this.game)},update:function(){this._created?this.onUpdateCallback&&this.onUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},pauseUpdate:function(){this._created?this.onPauseUpdateCallback&&this.onPauseUpdateCallback.call(this.callbackContext,this.game):this.onLoadUpdateCallback&&this.onLoadUpdateCallback.call(this.callbackContext,this.game)},preRender:function(e){this._created&&this.onPreRenderCallback&&this.onPreRenderCallback.call(this.callbackContext,this.game,e)},resize:function(e,t){this.onResizeCallback&&this.onResizeCallback.call(this.callbackContext,e,t)},render:function(){this._created?this.onRenderCallback&&(this.game.renderType===i.CANVAS?(this.game.context.save(),this.game.context.setTransform(1,0,0,1,0,0),this.onRenderCallback.call(this.callbackContext,this.game),this.game.context.restore()):this.onRenderCallback.call(this.callbackContext,this.game)):this.onLoadRenderCallback&&this.onLoadRenderCallback.call(this.callbackContext,this.game)},destroy:function(){this._clearWorld=!0,this._clearCache=!0,this.clearCurrentState(),this.callbackContext=null,this.onInitCallback=null,this.onShutDownCallback=null,this.onPreloadCallback=null,this.onLoadRenderCallback=null,this.onLoadUpdateCallback=null,this.onCreateCallback=null,this.onUpdateCallback=null,this.onRenderCallback=null,this.onPausedCallback=null,this.onResumedCallback=null,this.onPauseUpdateCallback=null,this.game=null,this.states={},this._pendingState=null,this.current=""}},i.StateManager.prototype.constructor=i.StateManager,Object.defineProperty(i.StateManager.prototype,"created",{get:function(){return this._created}}),i.Signal=function(){},i.Signal.prototype={_bindings:null,_prevParams:null,memorize:!1,_shouldPropagate:!0,active:!0,_boundDispatch:!1,validateListener:function(e,t){if("function"!=typeof e)throw new Error("Phaser.Signal: listener is a required param of {fn}() and should be a Function.".replace("{fn}",t))},_registerListener:function(e,t,s,a,n){var o,r=this._indexOfListener(e,s);if(-1!==r){if((o=this._bindings[r]).isOnce()!==t)throw new Error("You cannot add"+(t?"":"Once")+"() then add"+(t?"Once":"")+"() the same listener without removing the relationship first.")}else o=new i.SignalBinding(this,e,t,s,a,n),this._addBinding(o);return this.memorize&&this._prevParams&&o.execute(this._prevParams),o},_addBinding:function(e){this._bindings||(this._bindings=[]);var t=this._bindings.length;do{t--}while(this._bindings[t]&&e._priority<=this._bindings[t]._priority);this._bindings.splice(t+1,0,e)},_indexOfListener:function(e,t){if(!this._bindings)return-1;void 0===t&&(t=null);for(var i,s=this._bindings.length;s--;)if((i=this._bindings[s])._listener===e&&i.context===t)return s;return-1},has:function(e,t){return-1!==this._indexOfListener(e,t)},add:function(e,t,i){this.validateListener(e,"add");var s=[];if(arguments.length>3)for(var a=3;a<arguments.length;a++)s.push(arguments[a]);return this._registerListener(e,!1,t,i,s)},addOnce:function(e,t,i){this.validateListener(e,"addOnce");var s=[];if(arguments.length>3)for(var a=3;a<arguments.length;a++)s.push(arguments[a]);return this._registerListener(e,!0,t,i,s)},remove:function(e,t){this.validateListener(e,"remove");var i=this._indexOfListener(e,t);return-1!==i&&(this._bindings[i]._destroy(),this._bindings.splice(i,1)),e},removeAll:function(e){if(void 0===e&&(e=null),this._bindings){for(var t=this._bindings.length;t--;)e?this._bindings[t].context===e&&(this._bindings[t]._destroy(),this._bindings.splice(t,1)):this._bindings[t]._destroy();e||(this._bindings.length=0)}},getNumListeners:function(){return this._bindings?this._bindings.length:0},halt:function(){this._shouldPropagate=!1},dispatch:function(){if(this.active&&this._bindings){var e,t=Array.prototype.slice.call(arguments),i=this._bindings.length;if(this.memorize&&(this._prevParams=t),i){e=this._bindings.slice(),this._shouldPropagate=!0;do{i--}while(e[i]&&this._shouldPropagate&&!1!==e[i].execute(t))}}},forget:function(){this._prevParams&&(this._prevParams=null)},dispose:function(){this.removeAll(),this._bindings=null,this._prevParams&&(this._prevParams=null)},toString:function(){return"[Phaser.Signal active:"+this.active+" numListeners:"+this.getNumListeners()+"]"}},Object.defineProperty(i.Signal.prototype,"boundDispatch",{get:function(){var e=this;return this._boundDispatch||(this._boundDispatch=function(){return e.dispatch.apply(e,arguments)})}}),i.Signal.prototype.constructor=i.Signal,i.SignalBinding=function(e,t,i,s,a,n){this._listener=t,i&&(this._isOnce=!0),null!=s&&(this.context=s),this._signal=e,a&&(this._priority=a),n&&n.length&&(this._args=n)},i.SignalBinding.prototype={context:null,_isOnce:!1,_priority:0,_args:null,callCount:0,active:!0,params:null,execute:function(e){var t,i;return this.active&&this._listener&&(i=this.params?this.params.concat(e):e,this._args&&(i=i.concat(this._args)),t=this._listener.apply(this.context,i),this.callCount++,this._isOnce&&this.detach()),t},detach:function(){return this.isBound()?this._signal.remove(this._listener,this.context):null},isBound:function(){return!!this._signal&&!!this._listener},isOnce:function(){return this._isOnce},getListener:function(){return this._listener},getSignal:function(){return this._signal},_destroy:function(){delete this._signal,delete this._listener,delete this.context},toString:function(){return"[Phaser.SignalBinding isOnce:"+this._isOnce+", isBound:"+this.isBound()+", active:"+this.active+"]"}},i.SignalBinding.prototype.constructor=i.SignalBinding,i.Filter=function(e,t,s){this.game=e,this.type=i.WEBGL_FILTER,this.passes=[this],this.shaders=[],this.dirty=!0,this.padding=0,this.prevPoint=new i.Point;var a=new Date;if(this.uniforms={resolution:{type:"2f",value:{x:256,y:256}},time:{type:"1f",value:0},mouse:{type:"2f",value:{x:0,y:0}},date:{type:"4fv",value:[a.getFullYear(),a.getMonth(),a.getDate(),60*a.getHours()*60+60*a.getMinutes()+a.getSeconds()]},sampleRate:{type:"1f",value:44100},iChannel0:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel1:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel2:{type:"sampler2D",value:null,textureData:{repeat:!0}},iChannel3:{type:"sampler2D",value:null,textureData:{repeat:!0}}},t)for(var n in t)this.uniforms[n]=t[n];this.fragmentSrc=s||""},i.Filter.prototype={init:function(){},setResolution:function(e,t){this.uniforms.resolution.value.x=e,this.uniforms.resolution.value.y=t},update:function(e){if(void 0!==e){var t=e.x/this.game.width,i=1-e.y/this.game.height;t===this.prevPoint.x&&i===this.prevPoint.y||(this.uniforms.mouse.value.x=t.toFixed(2),this.uniforms.mouse.value.y=i.toFixed(2),this.prevPoint.set(t,i))}this.uniforms.time.value=this.game.time.totalElapsedSeconds()},addToWorld:function(e,t,i,s,a,n){void 0===a&&(a=0),void 0===n&&(n=0),void 0!==i&&null!==i?this.width=i:i=this.width,void 0!==s&&null!==s?this.height=s:s=this.height;var o=this.game.add.image(e,t,"__default");return o.width=i,o.height=s,o.anchor.set(a,n),o.filters=[this],o},destroy:function(){this.game=null}},i.Filter.prototype.constructor=i.Filter,Object.defineProperty(i.Filter.prototype,"width",{get:function(){return this.uniforms.resolution.value.x},set:function(e){this.uniforms.resolution.value.x=e}}),Object.defineProperty(i.Filter.prototype,"height",{get:function(){return this.uniforms.resolution.value.y},set:function(e){this.uniforms.resolution.value.y=e}}),i.Plugin=function(e,t){void 0===t&&(t=null),this.game=e,this.parent=t,this.active=!1,this.visible=!1,this.hasPreUpdate=!1,this.hasUpdate=!1,this.hasPostUpdate=!1,this.hasRender=!1,this.hasPostRender=!1},i.Plugin.prototype={preUpdate:function(){},update:function(){},render:function(){},postRender:function(){},destroy:function(){this.game=null,this.parent=null,this.active=!1,this.visible=!1}},i.Plugin.prototype.constructor=i.Plugin,i.PluginManager=function(e){this.game=e,this.plugins=[],this._len=0,this._i=0},i.PluginManager.prototype={add:function(e){var t=Array.prototype.slice.call(arguments,1),i=!1;return"function"==typeof e?e=new e(this.game,this):(e.game=this.game,e.parent=this),"function"==typeof e.preUpdate&&(e.hasPreUpdate=!0,i=!0),"function"==typeof e.update&&(e.hasUpdate=!0,i=!0),"function"==typeof e.postUpdate&&(e.hasPostUpdate=!0,i=!0),"function"==typeof e.render&&(e.hasRender=!0,i=!0),"function"==typeof e.postRender&&(e.hasPostRender=!0,i=!0),i?((e.hasPreUpdate||e.hasUpdate||e.hasPostUpdate)&&(e.active=!0),(e.hasRender||e.hasPostRender)&&(e.visible=!0),this._len=this.plugins.push(e),"function"==typeof e.init&&e.init.apply(e,t),e):null},remove:function(e,t){for(void 0===t&&(t=!0),this._i=this._len;this._i--;)if(this.plugins[this._i]===e)return t&&e.destroy(),this.plugins.splice(this._i,1),void this._len--},removeAll:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].destroy();this.plugins.length=0,this._len=0},preUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPreUpdate&&this.plugins[this._i].preUpdate()},update:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasUpdate&&this.plugins[this._i].update()},postUpdate:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].active&&this.plugins[this._i].hasPostUpdate&&this.plugins[this._i].postUpdate()},render:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasRender&&this.plugins[this._i].render()},postRender:function(){for(this._i=this._len;this._i--;)this.plugins[this._i].visible&&this.plugins[this._i].hasPostRender&&this.plugins[this._i].postRender()},destroy:function(){this.removeAll(),this.game=null}},i.PluginManager.prototype.constructor=i.PluginManager,i.Stage=function(e){this.game=e,PIXI.DisplayObjectContainer.call(this),this.name="_stage_root",this.disableVisibilityChange=!1,this.exists=!0,this.worldTransform=new PIXI.Matrix,this.stage=this,this.currentRenderOrderID=0,this._hiddenVar="hidden",this._onChange=null,this._bgColor={r:0,g:0,b:0,a:0,color:0,rgba:"#000000"},this.game.transparent||(this._bgColor.a=1),e.config&&this.parseConfig(e.config)},i.Stage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),i.Stage.prototype.constructor=i.Stage,i.Stage.prototype.parseConfig=function(e){e.disableVisibilityChange&&(this.disableVisibilityChange=e.disableVisibilityChange),e.backgroundColor&&this.setBackgroundColor(e.backgroundColor)},i.Stage.prototype.boot=function(){i.DOM.getOffset(this.game.canvas,this.offset),i.Canvas.setUserSelect(this.game.canvas,"none"),i.Canvas.setTouchAction(this.game.canvas,"none"),this.checkVisibility()},i.Stage.prototype.preUpdate=function(){this.currentRenderOrderID=0;for(var e=0;e<this.children.length;e++)this.children[e].preUpdate()},i.Stage.prototype.update=function(){for(var e=this.children.length;e--;)this.children[e].update()},i.Stage.prototype.postUpdate=function(){this.game.camera.update(),this.game.camera.target&&(this.game.camera.target.postUpdate(),this.updateTransform(),this.game.camera.updateTarget());for(var e=0;e<this.children.length;e++)this.children[e].postUpdate();this.updateTransform()},i.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var e=0;e<this.children.length;e++)this.children[e].updateTransform()},i.Stage.prototype.checkVisibility=function(){void 0!==document.hidden?this._hiddenVar="visibilitychange":void 0!==document.webkitHidden?this._hiddenVar="webkitvisibilitychange":void 0!==document.mozHidden?this._hiddenVar="mozvisibilitychange":void 0!==document.msHidden?this._hiddenVar="msvisibilitychange":this._hiddenVar=null;var e=this;this._onChange=function(t){return e.visibilityChange(t)},this._hiddenVar&&document.addEventListener(this._hiddenVar,this._onChange,!1),window.onblur=this._onChange,window.onfocus=this._onChange,window.onpagehide=this._onChange,window.onpageshow=this._onChange,this.game.device.cocoonJSApp&&(CocoonJS.App.onSuspended.addEventListener(function(){i.Stage.prototype.visibilityChange.call(e,{type:"pause"})}),CocoonJS.App.onActivated.addEventListener(function(){i.Stage.prototype.visibilityChange.call(e,{type:"resume"})}))},i.Stage.prototype.visibilityChange=function(e){return"pagehide"===e.type||"blur"===e.type||"pageshow"===e.type||"focus"===e.type?void("pagehide"===e.type||"blur"===e.type?this.game.focusLoss(e):"pageshow"!==e.type&&"focus"!==e.type||this.game.focusGain(e)):void(this.disableVisibilityChange||(document.hidden||document.mozHidden||document.msHidden||document.webkitHidden||"pause"===e.type?this.game.gamePaused(e):this.game.gameResumed(e)))},i.Stage.prototype.setBackgroundColor=function(e){this.game.transparent||(i.Color.valueToColor(e,this._bgColor),i.Color.updateColor(this._bgColor),this._bgColor.r/=255,this._bgColor.g/=255,this._bgColor.b/=255,this._bgColor.a=1)},i.Stage.prototype.destroy=function(){this._hiddenVar&&document.removeEventListener(this._hiddenVar,this._onChange,!1),window.onpagehide=null,window.onpageshow=null,window.onblur=null,window.onfocus=null},Object.defineProperty(i.Stage.prototype,"backgroundColor",{get:function(){return this._bgColor.color},set:function(e){this.setBackgroundColor(e)}}),Object.defineProperty(i.Stage.prototype,"smoothed",{get:function(){return PIXI.scaleModes.DEFAULT===PIXI.scaleModes.LINEAR},set:function(e){PIXI.scaleModes.DEFAULT=e?PIXI.scaleModes.LINEAR:PIXI.scaleModes.NEAREST}}),i.Group=function(e,t,s,a,n,o){void 0===a&&(a=!1),void 0===n&&(n=!1),void 0===o&&(o=i.Physics.ARCADE),this.game=e,void 0===t&&(t=e.world),this.name=s||"group",this.z=0,PIXI.DisplayObjectContainer.call(this),a?(this.game.stage.addChild(this),this.z=this.game.stage.children.length):t&&(t.addChild(this),this.z=t.children.length),this.type=i.GROUP,this.physicsType=i.GROUP,this.alive=!0,this.exists=!0,this.ignoreDestroy=!1,this.pendingDestroy=!1,this.classType=i.Sprite,this.cursor=null,this.inputEnableChildren=!1,this.onChildInputDown=new i.Signal,this.onChildInputUp=new i.Signal,this.onChildInputOver=new i.Signal,this.onChildInputOut=new i.Signal,this.enableBody=n,this.enableBodyDebug=!1,this.physicsBodyType=o,this.physicsSortDirection=null,this.onDestroy=new i.Signal,this.cursorIndex=0,this.fixedToCamera=!1,this.cameraOffset=new i.Point,this.hash=[],this._sortProperty="z"},i.Group.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),i.Group.prototype.constructor=i.Group,i.Group.RETURN_NONE=0,i.Group.RETURN_TOTAL=1,i.Group.RETURN_CHILD=2,i.Group.RETURN_ALL=3,i.Group.SORT_ASCENDING=-1,i.Group.SORT_DESCENDING=1,i.Group.prototype.add=function(e,t,i){return void 0===t&&(t=!1),e.parent===this?e:(e.body&&e.parent&&e.parent.hash&&e.parent.removeFromHash(e),void 0===i?(e.z=this.children.length,this.addChild(e)):(this.addChildAt(e,i),this.updateZ()),this.enableBody&&e.hasOwnProperty("body")&&null===e.body?this.game.physics.enable(e,this.physicsBodyType):e.body&&this.addToHash(e),!this.inputEnableChildren||e.input&&!e.inputEnabled||(e.inputEnabled=!0),!t&&e.events&&e.events.onAddedToGroup$dispatch(e,this),null===this.cursor&&(this.cursor=e),e)},i.Group.prototype.addAt=function(e,t,i){this.add(e,i,t)},i.Group.prototype.addToHash=function(e){return e.parent===this&&-1===this.hash.indexOf(e)&&(this.hash.push(e),!0)},i.Group.prototype.removeFromHash=function(e){if(e){var t=this.hash.indexOf(e);if(-1!==t)return this.hash.splice(t,1),!0}return!1},i.Group.prototype.addMultiple=function(e,t){if(e instanceof i.Group)e.moveAll(this,t);else if(Array.isArray(e))for(var s=0;s<e.length;s++)this.add(e[s],t);return e},i.Group.prototype.getAt=function(e){return e<0||e>=this.children.length?-1:this.getChildAt(e)},i.Group.prototype.create=function(e,t,i,s,a,n){void 0===a&&(a=!0);var o=new this.classType(this.game,e,t,i,s);return o.exists=a,o.visible=a,o.alive=a,this.add(o,!1,n)},i.Group.prototype.createMultiple=function(e,t,i,s){void 0===i&&(i=0),void 0===s&&(s=!1),Array.isArray(t)||(t=[t]),Array.isArray(i)||(i=[i]);var a=this,n=[];return t.forEach(function(t){i.forEach(function(i){for(var o=0;o<e;o++)n.push(a.create(0,0,t,i,s))})}),n},i.Group.prototype.updateZ=function(){for(var e=this.children.length;e--;)this.children[e].z=e},i.Group.prototype.align=function(e,t,s,a,n,o){if(void 0===n&&(n=i.TOP_LEFT),void 0===o&&(o=0),0===this.children.length||o>this.children.length||-1===e&&-1===t)return!1;for(var r=new i.Rectangle(0,0,s,a),l=e*s,h=t*a,c=o;c<this.children.length;c++){var p=this.children[c];if(p.alignIn)if(p.alignIn(r,n),-1===e)r.y+=a,r.y===h&&(r.x+=s,r.y=0);else if(-1===t)r.x+=s,r.x===l&&(r.x=0,r.y+=a);else if(r.x+=s,r.x===l&&(r.x=0,r.y+=a,r.y===h))return!0}return!0},i.Group.prototype.resetCursor=function(e){if(void 0===e&&(e=0),e>this.children.length-1&&(e=0),this.cursor)return this.cursorIndex=e,this.cursor=this.children[this.cursorIndex],this.cursor},i.Group.prototype.next=function(){if(this.cursor)return this.cursorIndex>=this.children.length-1?this.cursorIndex=0:this.cursorIndex++,this.cursor=this.children[this.cursorIndex],this.cursor},i.Group.prototype.previous=function(){if(this.cursor)return 0===this.cursorIndex?this.cursorIndex=this.children.length-1:this.cursorIndex--,this.cursor=this.children[this.cursorIndex],this.cursor},i.Group.prototype.swap=function(e,t){this.swapChildren(e,t),this.updateZ()},i.Group.prototype.bringToTop=function(e){return e.parent===this&&this.getIndex(e)<this.children.length&&(this.remove(e,!1,!0),this.add(e,!0)),e},i.Group.prototype.sendToBack=function(e){return e.parent===this&&this.getIndex(e)>0&&(this.remove(e,!1,!0),this.addAt(e,0,!0)),e},i.Group.prototype.moveUp=function(e){if(e.parent===this&&this.getIndex(e)<this.children.length-1){var t=this.getIndex(e),i=this.getAt(t+1);i&&this.swap(e,i)}return e},i.Group.prototype.moveDown=function(e){if(e.parent===this&&this.getIndex(e)>0){var t=this.getIndex(e),i=this.getAt(t-1);i&&this.swap(e,i)}return e},i.Group.prototype.xy=function(e,t,i){return e<0||e>this.children.length?-1:(this.getChildAt(e).x=t,void(this.getChildAt(e).y=i))},i.Group.prototype.reverse=function(){this.children.reverse(),this.updateZ()},i.Group.prototype.getIndex=function(e){return this.children.indexOf(e)},i.Group.prototype.getByName=function(e){for(var t=0;t<this.children.length;t++)if(this.children[t].name===e)return this.children[t];return null},i.Group.prototype.replace=function(e,t){var s=this.getIndex(e);if(-1!==s)return t.parent&&(t.parent instanceof i.Group?t.parent.remove(t):t.parent.removeChild(t)),this.remove(e),this.addAt(t,s),e},i.Group.prototype.hasProperty=function(e,t){var i=t.length;return 1===i&&t[0]in e||2===i&&t[0]in e&&t[1]in e[t[0]]||3===i&&t[0]in e&&t[1]in e[t[0]]&&t[2]in e[t[0]][t[1]]||4===i&&t[0]in e&&t[1]in e[t[0]]&&t[2]in e[t[0]][t[1]]&&t[3]in e[t[0]][t[1]][t[2]]},i.Group.prototype.setProperty=function(e,t,i,s,a){if(void 0===a&&(a=!1),s=s||0,!this.hasProperty(e,t)&&(!a||s>0))return!1;var n=t.length;return 1===n?0===s?e[t[0]]=i:1===s?e[t[0]]+=i:2===s?e[t[0]]-=i:3===s?e[t[0]]*=i:4===s&&(e[t[0]]/=i):2===n?0===s?e[t[0]][t[1]]=i:1===s?e[t[0]][t[1]]+=i:2===s?e[t[0]][t[1]]-=i:3===s?e[t[0]][t[1]]*=i:4===s&&(e[t[0]][t[1]]/=i):3===n?0===s?e[t[0]][t[1]][t[2]]=i:1===s?e[t[0]][t[1]][t[2]]+=i:2===s?e[t[0]][t[1]][t[2]]-=i:3===s?e[t[0]][t[1]][t[2]]*=i:4===s&&(e[t[0]][t[1]][t[2]]/=i):4===n&&(0===s?e[t[0]][t[1]][t[2]][t[3]]=i:1===s?e[t[0]][t[1]][t[2]][t[3]]+=i:2===s?e[t[0]][t[1]][t[2]][t[3]]-=i:3===s?e[t[0]][t[1]][t[2]][t[3]]*=i:4===s&&(e[t[0]][t[1]][t[2]][t[3]]/=i)),!0},i.Group.prototype.checkProperty=function(e,t,s,a){return void 0===a&&(a=!1),!(!i.Utils.getProperty(e,t)&&a)&&i.Utils.getProperty(e,t)===s},i.Group.prototype.set=function(e,t,i,s,a,n,o){if(void 0===o&&(o=!1),t=t.split("."),void 0===s&&(s=!1),void 0===a&&(a=!1),(!1===s||s&&e.alive)&&(!1===a||a&&e.visible))return this.setProperty(e,t,i,n,o)},i.Group.prototype.setAll=function(e,t,i,s,a,n){void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===n&&(n=!1),e=e.split("."),a=a||0;for(var o=0;o<this.children.length;o++)(!i||i&&this.children[o].alive)&&(!s||s&&this.children[o].visible)&&this.setProperty(this.children[o],e,t,a,n)},i.Group.prototype.setAllChildren=function(e,t,s,a,n,o){void 0===s&&(s=!1),void 0===a&&(a=!1),void 0===o&&(o=!1),n=n||0;for(var r=0;r<this.children.length;r++)(!s||s&&this.children[r].alive)&&(!a||a&&this.children[r].visible)&&(this.children[r]instanceof i.Group?this.children[r].setAllChildren(e,t,s,a,n,o):this.setProperty(this.children[r],e.split("."),t,n,o))},i.Group.prototype.checkAll=function(e,t,i,s,a){void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!1);for(var n=0;n<this.children.length;n++)if((!i||i&&this.children[n].alive)&&(!s||s&&this.children[n].visible)&&!this.checkProperty(this.children[n],e,t,a))return!1;return!0},i.Group.prototype.addAll=function(e,t,i,s){this.setAll(e,t,i,s,1)},i.Group.prototype.subAll=function(e,t,i,s){this.setAll(e,t,i,s,2)},i.Group.prototype.multiplyAll=function(e,t,i,s){this.setAll(e,t,i,s,3)},i.Group.prototype.divideAll=function(e,t,i,s){this.setAll(e,t,i,s,4)},i.Group.prototype.callAllExists=function(e,t){var i;if(arguments.length>2){i=[];for(s=2;s<arguments.length;s++)i.push(arguments[s])}for(var s=0;s<this.children.length;s++)this.children[s].exists===t&&this.children[s][e]&&this.children[s][e].apply(this.children[s],i)},i.Group.prototype.callbackFromArray=function(e,t,i){if(1===i){if(e[t[0]])return e[t[0]]}else if(2===i){if(e[t[0]][t[1]])return e[t[0]][t[1]]}else if(3===i){if(e[t[0]][t[1]][t[2]])return e[t[0]][t[1]][t[2]]}else if(4===i){if(e[t[0]][t[1]][t[2]][t[3]])return e[t[0]][t[1]][t[2]][t[3]]}else if(e[t])return e[t];return!1},i.Group.prototype.callAll=function(e,t){if(void 0!==e){var i=(e=e.split(".")).length;if(void 0===t||null===t||""===t)t=null;else if("string"==typeof t)var s=(t=t.split(".")).length;var a;if(arguments.length>2){a=[];for(r=2;r<arguments.length;r++)a.push(arguments[r])}for(var n=null,o=null,r=0;r<this.children.length;r++)n=this.callbackFromArray(this.children[r],e,i),t&&n?(o=this.callbackFromArray(this.children[r],t,s),n&&n.apply(o,a)):n&&n.apply(this.children[r],a)}},i.Group.prototype.preUpdate=function(){if(this.pendingDestroy)return this.destroy(),!1;if(!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;for(var e=0;e<this.children.length;e++)this.children[e].preUpdate();return!0},i.Group.prototype.update=function(){for(var e=this.children.length;e--;)this.children[e].update()},i.Group.prototype.postUpdate=function(){this.fixedToCamera&&(this.x=this.game.camera.view.x+this.cameraOffset.x,this.y=this.game.camera.view.y+this.cameraOffset.y);for(var e=0;e<this.children.length;e++)this.children[e].postUpdate()},i.Group.prototype.filter=function(e,t){for(var s=-1,a=this.children.length,n=[];++s<a;){var o=this.children[s];(!t||t&&o.exists)&&e(o,s,this.children)&&n.push(o)}return new i.ArraySet(n)},i.Group.prototype.forEach=function(e,t,i){if(void 0===i&&(i=!1),arguments.length<=3)for(a=0;a<this.children.length;a++)(!i||i&&this.children[a].exists)&&e.call(t,this.children[a]);else{for(var s=[null],a=3;a<arguments.length;a++)s.push(arguments[a]);for(a=0;a<this.children.length;a++)(!i||i&&this.children[a].exists)&&(s[0]=this.children[a],e.apply(t,s))}},i.Group.prototype.forEachExists=function(e,t){var s;if(arguments.length>2){s=[null];for(var a=2;a<arguments.length;a++)s.push(arguments[a])}this.iterate("exists",!0,i.Group.RETURN_TOTAL,e,t,s)},i.Group.prototype.forEachAlive=function(e,t){var s;if(arguments.length>2){s=[null];for(var a=2;a<arguments.length;a++)s.push(arguments[a])}this.iterate("alive",!0,i.Group.RETURN_TOTAL,e,t,s)},i.Group.prototype.forEachDead=function(e,t){var s;if(arguments.length>2){s=[null];for(var a=2;a<arguments.length;a++)s.push(arguments[a])}this.iterate("alive",!1,i.Group.RETURN_TOTAL,e,t,s)},i.Group.prototype.sort=function(e,t){this.children.length<2||(void 0===e&&(e="z"),void 0===t&&(t=i.Group.SORT_ASCENDING),this._sortProperty=e,t===i.Group.SORT_ASCENDING?this.children.sort(this.ascendingSortHandler.bind(this)):this.children.sort(this.descendingSortHandler.bind(this)),this.updateZ())},i.Group.prototype.customSort=function(e,t){this.children.length<2||(this.children.sort(e.bind(t)),this.updateZ())},i.Group.prototype.ascendingSortHandler=function(e,t){return e[this._sortProperty]<t[this._sortProperty]?-1:e[this._sortProperty]>t[this._sortProperty]?1:e.z<t.z?-1:1},i.Group.prototype.descendingSortHandler=function(e,t){return e[this._sortProperty]<t[this._sortProperty]?1:e[this._sortProperty]>t[this._sortProperty]?-1:0},i.Group.prototype.iterate=function(e,t,s,a,n,o){if(0===this.children.length){if(s===i.Group.RETURN_TOTAL)return 0;if(s===i.Group.RETURN_ALL)return[]}var r=0;if(s===i.Group.RETURN_ALL)var l=[];for(var h=0;h<this.children.length;h++)if(this.children[h][e]===t){if(r++,a&&(o?(o[0]=this.children[h],a.apply(n,o)):a.call(n,this.children[h])),s===i.Group.RETURN_CHILD)return this.children[h];s===i.Group.RETURN_ALL&&l.push(this.children[h])}return s===i.Group.RETURN_TOTAL?r:s===i.Group.RETURN_ALL?l:null},i.Group.prototype.getFirstExists=function(e,t,s,a,n,o){void 0===t&&(t=!1),"boolean"!=typeof e&&(e=!0);var r=this.iterate("exists",e,i.Group.RETURN_CHILD);return null===r&&t?this.create(s,a,n,o):this.resetChild(r,s,a,n,o)},i.Group.prototype.getFirstAlive=function(e,t,s,a,n){void 0===e&&(e=!1);var o=this.iterate("alive",!0,i.Group.RETURN_CHILD);return null===o&&e?this.create(t,s,a,n):this.resetChild(o,t,s,a,n)},i.Group.prototype.getFirstDead=function(e,t,s,a,n){void 0===e&&(e=!1);var o=this.iterate("alive",!1,i.Group.RETURN_CHILD);return null===o&&e?this.create(t,s,a,n):this.resetChild(o,t,s,a,n)},i.Group.prototype.resetChild=function(e,t,i,s,a){return null===e?null:(void 0===t&&(t=null),void 0===i&&(i=null),null!==t&&null!==i&&e.reset(t,i),void 0!==s&&e.loadTexture(s,a),e)},i.Group.prototype.getTop=function(){if(this.children.length>0)return this.children[this.children.length-1]},i.Group.prototype.getBottom=function(){if(this.children.length>0)return this.children[0]},i.Group.prototype.getClosestTo=function(e,t,s){for(var a=Number.MAX_VALUE,n=0,o=null,r=0;r<this.children.length;r++){var l=this.children[r];l.exists&&(n=Math.abs(i.Point.distance(e,l)))<a&&(!t||t.call(s,l,n))&&(a=n,o=l)}return o},i.Group.prototype.getFurthestFrom=function(e,t,s){for(var a=0,n=0,o=null,r=0;r<this.children.length;r++){var l=this.children[r];l.exists&&(n=Math.abs(i.Point.distance(e,l)))>a&&(!t||t.call(s,l,n))&&(a=n,o=l)}return o},i.Group.prototype.countLiving=function(){return this.iterate("alive",!0,i.Group.RETURN_TOTAL)},i.Group.prototype.countDead=function(){return this.iterate("alive",!1,i.Group.RETURN_TOTAL)},i.Group.prototype.getRandom=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.children.length),0===t?null:i.ArrayUtils.getRandomItem(this.children,e,t)},i.Group.prototype.getRandomExists=function(e,t){var i=this.getAll("exists",!0,e,t);return this.game.rnd.pick(i)},i.Group.prototype.getAll=function(e,t,i,s){void 0===i&&(i=0),void 0===s&&(s=this.children.length);for(var a=[],n=i;n<s;n++){var o=this.children[n];e&&o[e]===t&&a.push(o)}return a},i.Group.prototype.remove=function(e,t,i){if(void 0===t&&(t=!1),void 0===i&&(i=!1),0===this.children.length||-1===this.children.indexOf(e))return!1;i||!e.events||e.destroyPhase||e.events.onRemovedFromGroup$dispatch(e,this);var s=this.removeChild(e);return this.removeFromHash(e),this.updateZ(),this.cursor===e&&this.next(),t&&s&&s.destroy(!0),!0},i.Group.prototype.moveAll=function(e,t){if(void 0===t&&(t=!1),this.children.length>0&&e instanceof i.Group){do{e.add(this.children[0],t)}while(this.children.length>0);this.hash=[],this.cursor=null}return e},i.Group.prototype.removeAll=function(e,t,i){if(void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===i&&(i=!1),0!==this.children.length){do{!t&&this.children[0].events&&this.children[0].events.onRemovedFromGroup$dispatch(this.children[0],this);var s=this.removeChild(this.children[0]);this.removeFromHash(s),e&&s&&s.destroy(!0,i)}while(this.children.length>0);this.hash=[],this.cursor=null}},i.Group.prototype.removeBetween=function(e,t,i,s){if(void 0===t&&(t=this.children.length-1),void 0===i&&(i=!1),void 0===s&&(s=!1),0!==this.children.length){if(e>t||e<0||t>this.children.length)return!1;for(var a=t;a>=e;){!s&&this.children[a].events&&this.children[a].events.onRemovedFromGroup$dispatch(this.children[a],this);var n=this.removeChild(this.children[a]);this.removeFromHash(n),i&&n&&n.destroy(!0),this.cursor===this.children[a]&&(this.cursor=null),a--}this.updateZ()}},i.Group.prototype.destroy=function(e,t){null===this.game||this.ignoreDestroy||(void 0===e&&(e=!0),void 0===t&&(t=!1),this.onDestroy.dispatch(this,e,t),this.removeAll(e),this.cursor=null,this.filters=null,this.pendingDestroy=!1,t||(this.parent&&this.parent.removeChild(this),this.game=null,this.exists=!1))},Object.defineProperty(i.Group.prototype,"total",{get:function(){return this.iterate("exists",!0,i.Group.RETURN_TOTAL)}}),Object.defineProperty(i.Group.prototype,"length",{get:function(){return this.children.length}}),Object.defineProperty(i.Group.prototype,"angle",{get:function(){return i.Math.radToDeg(this.rotation)},set:function(e){this.rotation=i.Math.degToRad(e)}}),Object.defineProperty(i.Group.prototype,"centerX",{get:function(){return this.getBounds(this.parent).centerX},set:function(e){var t=this.getBounds(this.parent),i=this.x-t.x;this.x=e+i-t.halfWidth}}),Object.defineProperty(i.Group.prototype,"centerY",{get:function(){return this.getBounds(this.parent).centerY},set:function(e){var t=this.getBounds(this.parent),i=this.y-t.y;this.y=e+i-t.halfHeight}}),Object.defineProperty(i.Group.prototype,"left",{get:function(){return this.getBounds(this.parent).left},set:function(e){var t=this.getBounds(this.parent),i=this.x-t.x;this.x=e+i}}),Object.defineProperty(i.Group.prototype,"right",{get:function(){return this.getBounds(this.parent).right},set:function(e){var t=this.getBounds(this.parent),i=this.x-t.x;this.x=e+i-t.width}}),Object.defineProperty(i.Group.prototype,"top",{get:function(){return this.getBounds(this.parent).top},set:function(e){var t=this.getBounds(this.parent),i=this.y-t.y;this.y=e+i}}),Object.defineProperty(i.Group.prototype,"bottom",{get:function(){return this.getBounds(this.parent).bottom},set:function(e){var t=this.getBounds(this.parent),i=this.y-t.y;this.y=e+i-t.height}}),i.World=function(e){i.Group.call(this,e,null,"__world",!1),this.bounds=new i.Rectangle(0,0,e.width,e.height),this.camera=null,this._definedSize=!1,this._width=e.width,this._height=e.height,this.game.state.onStateChange.add(this.stateChange,this)},i.World.prototype=Object.create(i.Group.prototype),i.World.prototype.constructor=i.World,i.World.prototype.boot=function(){this.camera=new i.Camera(this.game,0,0,0,this.game.width,this.game.height),this.game.stage.addChild(this),this.camera.boot()},i.World.prototype.stateChange=function(){this.x=0,this.y=0,this.camera.reset()},i.World.prototype.setBounds=function(e,t,i,s){this._definedSize=!0,this._width=i,this._height=s,this.bounds.setTo(e,t,i,s),this.x=e,this.y=t,this.camera.bounds&&this.camera.bounds.setTo(e,t,Math.max(i,this.game.width),Math.max(s,this.game.height)),this.game.physics.setBoundsToWorld()},i.World.prototype.resize=function(e,t){this._definedSize&&(e<this._width&&(e=this._width),t<this._height&&(t=this._height)),this.bounds.width=e,this.bounds.height=t,this.game.camera.setBoundsToWorld(),this.game.physics.setBoundsToWorld()},i.World.prototype.shutdown=function(){this.destroy(!0,!0)},i.World.prototype.wrap=function(e,t,i,s,a){void 0===t&&(t=0),void 0===i&&(i=!1),void 0===s&&(s=!0),void 0===a&&(a=!0),i?(e.getBounds(),s&&(e.x+e._currentBounds.width<this.bounds.x?e.x=this.bounds.right:e.x>this.bounds.right&&(e.x=this.bounds.left)),a&&(e.y+e._currentBounds.height<this.bounds.top?e.y=this.bounds.bottom:e.y>this.bounds.bottom&&(e.y=this.bounds.top))):(s&&e.x+t<this.bounds.x?e.x=this.bounds.right+t:s&&e.x-t>this.bounds.right&&(e.x=this.bounds.left-t),a&&e.y+t<this.bounds.top?e.y=this.bounds.bottom+t:a&&e.y-t>this.bounds.bottom&&(e.y=this.bounds.top-t))},Object.defineProperty(i.World.prototype,"width",{get:function(){return this.bounds.width},set:function(e){e<this.game.width&&(e=this.game.width),this.bounds.width=e,this._width=e,this._definedSize=!0}}),Object.defineProperty(i.World.prototype,"height",{get:function(){return this.bounds.height},set:function(e){e<this.game.height&&(e=this.game.height),this.bounds.height=e,this._height=e,this._definedSize=!0}}),Object.defineProperty(i.World.prototype,"centerX",{get:function(){return this.bounds.halfWidth+this.bounds.x}}),Object.defineProperty(i.World.prototype,"centerY",{get:function(){return this.bounds.halfHeight+this.bounds.y}}),Object.defineProperty(i.World.prototype,"randomX",{get:function(){return this.bounds.x<0?this.game.rnd.between(this.bounds.x,this.bounds.width-Math.abs(this.bounds.x)):this.game.rnd.between(this.bounds.x,this.bounds.width)}}),Object.defineProperty(i.World.prototype,"randomY",{get:function(){return this.bounds.y<0?this.game.rnd.between(this.bounds.y,this.bounds.height-Math.abs(this.bounds.y)):this.game.rnd.between(this.bounds.y,this.bounds.height)}}),i.Game=function(e,t,s,a,n,o,r,l){return this.id=i.GAMES.push(this)-1,this.config=null,this.physicsConfig=l,this.parent="",this.width=800,this.height=600,this.resolution=1,this._width=800,this._height=600,this.transparent=!1,this.antialias=!0,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!0,this.renderer=null,this.renderType=i.AUTO,this.state=null,this.isBooted=!1,this.isRunning=!1,this.raf=null,this.add=null,this.make=null,this.cache=null,this.input=null,this.load=null,this.math=null,this.net=null,this.scale=null,this.sound=null,this.stage=null,this.time=null,this.tweens=null,this.world=null,this.physics=null,this.plugins=null,this.rnd=null,this.device=i.Device,this.camera=null,this.canvas=null,this.context=null,this.debug=null,this.particles=null,this.create=null,this.lockRender=!1,this.stepping=!1,this.pendingStep=!1,this.stepCount=0,this.onPause=null,this.onResume=null,this.onBlur=null,this.onFocus=null,this._paused=!1,this._codePaused=!1,this.currentUpdateID=0,this.updatesThisFrame=1,this._deltaTime=0,this._lastCount=0,this._spiraling=0,this._kickstart=!0,this.fpsProblemNotifier=new i.Signal,this.forceSingleUpdate=!0,this._nextFpsNotification=0,1===arguments.length&&"object"==typeof arguments[0]?this.parseConfig(arguments[0]):(this.config={enableDebug:!0},void 0!==e&&(this._width=e),void 0!==t&&(this._height=t),void 0!==s&&(this.renderType=s),void 0!==a&&(this.parent=a),void 0!==o&&(this.transparent=o),void 0!==r&&(this.antialias=r),this.rnd=new i.RandomDataGenerator([(Date.now()*Math.random()).toString()]),this.state=new i.StateManager(this,n)),this.device.whenReady(this.boot,this),this},i.Game.prototype={parseConfig:function(e){this.config=e,void 0===e.enableDebug&&(this.config.enableDebug=!0),e.width&&(this._width=e.width),e.height&&(this._height=e.height),e.renderer&&(this.renderType=e.renderer),e.parent&&(this.parent=e.parent),void 0!==e.transparent&&(this.transparent=e.transparent),void 0!==e.antialias&&(this.antialias=e.antialias),e.resolution&&(this.resolution=e.resolution),void 0!==e.preserveDrawingBuffer&&(this.preserveDrawingBuffer=e.preserveDrawingBuffer),e.physicsConfig&&(this.physicsConfig=e.physicsConfig);var t=[(Date.now()*Math.random()).toString()];e.seed&&(t=e.seed),this.rnd=new i.RandomDataGenerator(t);var s=null;e.state&&(s=e.state),this.state=new i.StateManager(this,s)},boot:function(){this.isBooted||(this.onPause=new i.Signal,this.onResume=new i.Signal,this.onBlur=new i.Signal,this.onFocus=new i.Signal,this.isBooted=!0,PIXI.game=this,this.math=i.Math,this.scale=new i.ScaleManager(this,this._width,this._height),this.stage=new i.Stage(this),this.setUpRenderer(),this.world=new i.World(this),this.add=new i.GameObjectFactory(this),this.make=new i.GameObjectCreator(this),this.cache=new i.Cache(this),this.load=new i.Loader(this),this.time=new i.Time(this),this.tweens=new i.TweenManager(this),this.input=new i.Input(this),this.sound=new i.SoundManager(this),this.physics=new i.Physics(this,this.physicsConfig),this.particles=new i.Particles(this),this.create=new i.Create(this),this.plugins=new i.PluginManager(this),this.net=new i.Net(this),this.time.boot(),this.stage.boot(),this.world.boot(),this.scale.boot(),this.input.boot(),this.sound.boot(),this.state.boot(),this.config.enableDebug?(this.debug=new i.Utils.Debug(this),this.debug.boot()):this.debug={preUpdate:function(){},update:function(){},reset:function(){}},this.showDebugHeader(),this.isRunning=!0,this.config&&this.config.forceSetTimeOut?this.raf=new i.RequestAnimationFrame(this,this.config.forceSetTimeOut):this.raf=new i.RequestAnimationFrame(this,!1),this._kickstart=!0,window.focus&&(!window.PhaserGlobal||window.PhaserGlobal&&!window.PhaserGlobal.stopFocus)&&window.focus(),this.raf.start())},showDebugHeader:function(){if(!window.PhaserGlobal||!window.PhaserGlobal.hideBanner){var e=i.VERSION,t="Canvas",s="HTML Audio",a=1;if(this.renderType===i.WEBGL?(t="WebGL",a++):this.renderType===i.HEADLESS&&(t="Headless"),this.device.webAudio&&(s="WebAudio",a++),this.device.chrome)for(var n=["%c %c %c Phaser v"+e+" | Pixi.js | "+t+" | "+s+"  %c %c %c http://phaser.io %c♥%c♥%c♥","background: #fb8cb3","background: #d44a52","color: #ffffff; background: #871905;","background: #d44a52","background: #fb8cb3","background: #ffffff"],o=0;o<3;o++)o<a?n.push("color: #ff2424; background: #fff"):n.push("color: #959595; background: #fff");else window.console}},setUpRenderer:function(){if(this.config.canvas?this.canvas=this.config.canvas:this.canvas=i.Canvas.create(this,this.width,this.height,this.config.canvasID,!0),this.config.canvasStyle?this.canvas.style=this.config.canvasStyle:this.canvas.style["-webkit-full-screen"]="width: 100%; height: 100%",this.renderType===i.HEADLESS||this.renderType===i.CANVAS||this.renderType===i.AUTO&&!this.device.webGL){if(!this.device.canvas)throw new Error("Phaser.Game - Cannot create Canvas or WebGL context, aborting.");this.renderType=i.CANVAS,this.renderer=new PIXI.CanvasRenderer(this),this.context=this.renderer.context}else this.renderType=i.WEBGL,this.renderer=new PIXI.WebGLRenderer(this),this.context=null,this.canvas.addEventListener("webglcontextlost",this.contextLost.bind(this),!1),this.canvas.addEventListener("webglcontextrestored",this.contextRestored.bind(this),!1);this.device.cocoonJS&&(this.canvas.screencanvas=this.renderType===i.CANVAS),this.renderType!==i.HEADLESS&&(this.stage.smoothed=this.antialias,i.Canvas.addToDOM(this.canvas,this.parent,!1),i.Canvas.setTouchAction(this.canvas))},contextLost:function(e){e.preventDefault(),this.renderer.contextLost=!0},contextRestored:function(){this.renderer.initContext(),this.cache.clearGLTextures(),this.renderer.contextLost=!1},update:function(e){if(this.time.update(e),this._kickstart)return this.updateLogic(this.time.desiredFpsMult),this.updateRender(this.time.slowMotion*this.time.desiredFps),void(this._kickstart=!1);if(this._spiraling>1&&!this.forceSingleUpdate)this.time.time>this._nextFpsNotification&&(this._nextFpsNotification=this.time.time+1e4,this.fpsProblemNotifier.dispatch()),this._deltaTime=0,this._spiraling=0,this.updateRender(this.time.slowMotion*this.time.desiredFps);else{var t=1e3*this.time.slowMotion/this.time.desiredFps;this._deltaTime+=Math.max(Math.min(3*t,this.time.elapsed),0);var i=0;for(this.updatesThisFrame=Math.floor(this._deltaTime/t),this.forceSingleUpdate&&(this.updatesThisFrame=Math.min(1,this.updatesThisFrame));this._deltaTime>=t&&(this._deltaTime-=t,this.currentUpdateID=i,this.updateLogic(this.time.desiredFpsMult),i++,!this.forceSingleUpdate||1!==i);)this.time.refresh();i>this._lastCount?this._spiraling++:i<this._lastCount&&(this._spiraling=0),this._lastCount=i,this.updateRender(this._deltaTime/t)}},updateLogic:function(e){this._paused||this.pendingStep?(this.scale.pauseUpdate(),this.state.pauseUpdate(),this.debug.preUpdate()):(this.stepping&&(this.pendingStep=!0),this.scale.preUpdate(),this.debug.preUpdate(),this.camera.preUpdate(),this.physics.preUpdate(),this.state.preUpdate(e),this.plugins.preUpdate(e),this.stage.preUpdate(),this.state.update(),this.stage.update(),this.tweens.update(),this.sound.update(),this.input.update(),this.physics.update(),this.particles.update(),this.plugins.update(),this.stage.postUpdate(),this.plugins.postUpdate()),this.stage.updateTransform()},updateRender:function(e){this.lockRender||(this.state.preRender(e),this.renderType!==i.HEADLESS&&(this.renderer.render(this.stage),this.plugins.render(e),this.state.render(e)),this.plugins.postRender(e))},enableStep:function(){this.stepping=!0,this.pendingStep=!1,this.stepCount=0},disableStep:function(){this.stepping=!1,this.pendingStep=!1},step:function(){this.pendingStep=!1,this.stepCount++},destroy:function(){this.raf.stop(),this.state.destroy(),this.sound.destroy(),this.scale.destroy(),this.stage.destroy(),this.input.destroy(),this.physics.destroy(),this.plugins.destroy(),this.state=null,this.sound=null,this.scale=null,this.stage=null,this.input=null,this.physics=null,this.plugins=null,this.cache=null,this.load=null,this.time=null,this.world=null,this.isBooted=!1,this.renderer.destroy(!1),i.Canvas.removeFromDOM(this.canvas),PIXI.defaultRenderer=null,i.GAMES[this.id]=null},gamePaused:function(e){this._paused||(this._paused=!0,this.time.gamePaused(),this.sound.muteOnPause&&this.sound.setMute(),this.onPause.dispatch(e),this.device.cordova&&this.device.iOS&&(this.lockRender=!0))},gameResumed:function(e){this._paused&&!this._codePaused&&(this._paused=!1,this.time.gameResumed(),this.input.reset(),this.sound.muteOnPause&&this.sound.unsetMute(),this.onResume.dispatch(e),this.device.cordova&&this.device.iOS&&(this.lockRender=!1))},focusLoss:function(e){this.onBlur.dispatch(e),this.stage.disableVisibilityChange||this.gamePaused(e)},focusGain:function(e){this.onFocus.dispatch(e),this.stage.disableVisibilityChange||this.gameResumed(e)}},i.Game.prototype.constructor=i.Game,Object.defineProperty(i.Game.prototype,"paused",{get:function(){return this._paused},set:function(e){!0===e?(!1===this._paused&&(this._paused=!0,this.sound.setMute(),this.time.gamePaused(),this.onPause.dispatch(this)),this._codePaused=!0):(this._paused&&(this._paused=!1,this.input.reset(),this.sound.unsetMute(),this.time.gameResumed(),this.onResume.dispatch(this)),this._codePaused=!1)}}),i.Input=function(e){this.game=e,this.hitCanvas=null,this.hitContext=null,this.moveCallbacks=[],this.customCandidateHandler=null,this.customCandidateHandlerContext=null,this.pollRate=0,this.enabled=!0,this.multiInputOverride=i.Input.MOUSE_TOUCH_COMBINE,this.position=null,this.speed=null,this.circle=null,this.scale=null,this.maxPointers=-1,this.tapRate=200,this.doubleTapRate=300,this.holdRate=2e3,this.justPressedRate=200,this.justReleasedRate=200,this.recordPointerHistory=!1,this.recordRate=100,this.recordLimit=100,this.pointer1=null,this.pointer2=null,this.pointer3=null,this.pointer4=null,this.pointer5=null,this.pointer6=null,this.pointer7=null,this.pointer8=null,this.pointer9=null,this.pointer10=null,this.pointers=[],this.activePointer=null,this.mousePointer=null,this.mouse=null,this.keyboard=null,this.touch=null,this.mspointer=null,this.gamepad=null,this.resetLocked=!1,this.onDown=null,this.onUp=null,this.onTap=null,this.onHold=null,this.minPriorityID=0,this.interactiveItems=new i.ArraySet,this._localPoint=new i.Point,this._pollCounter=0,this._oldPosition=null,this._x=0,this._y=0},i.Input.MOUSE_OVERRIDES_TOUCH=0,i.Input.TOUCH_OVERRIDES_MOUSE=1,i.Input.MOUSE_TOUCH_COMBINE=2,i.Input.MAX_POINTERS=10,i.Input.prototype={boot:function(){this.mousePointer=new i.Pointer(this.game,0,i.PointerMode.CURSOR),this.addPointer(),this.addPointer(),this.mouse=new i.Mouse(this.game),this.touch=new i.Touch(this.game),this.mspointer=new i.MSPointer(this.game),i.Keyboard&&(this.keyboard=new i.Keyboard(this.game)),i.Gamepad&&(this.gamepad=new i.Gamepad(this.game)),this.onDown=new i.Signal,this.onUp=new i.Signal,this.onTap=new i.Signal,this.onHold=new i.Signal,this.scale=new i.Point(1,1),this.speed=new i.Point,this.position=new i.Point,this._oldPosition=new i.Point,this.circle=new i.Circle(0,0,44),this.activePointer=this.mousePointer,this.hitCanvas=PIXI.CanvasPool.create(this,1,1),this.hitContext=this.hitCanvas.getContext("2d"),this.mouse.start(),this.touch.start(),this.mspointer.start(),this.mousePointer.active=!0,this.keyboard&&this.keyboard.start();var e=this;this._onClickTrampoline=function(t){e.onClickTrampoline(t)},this.game.canvas.addEventListener("click",this._onClickTrampoline,!1)},destroy:function(){this.mouse.stop(),this.touch.stop(),this.mspointer.stop(),this.keyboard&&this.keyboard.stop(),this.gamepad&&this.gamepad.stop(),this.moveCallbacks=[],PIXI.CanvasPool.remove(this),this.game.canvas.removeEventListener("click",this._onClickTrampoline)},setInteractiveCandidateHandler:function(e,t){this.customCandidateHandler=e,this.customCandidateHandlerContext=t},addMoveCallback:function(e,t){this.moveCallbacks.push({callback:e,context:t})},deleteMoveCallback:function(e,t){for(var i=this.moveCallbacks.length;i--;)if(this.moveCallbacks[i].callback===e&&this.moveCallbacks[i].context===t)return void this.moveCallbacks.splice(i,1)},addPointer:function(){if(this.pointers.length>=i.Input.MAX_POINTERS)return null;var e=this.pointers.length+1,t=new i.Pointer(this.game,e,i.PointerMode.TOUCH);return this.pointers.push(t),this["pointer"+e]=t,t},update:function(){if(this.keyboard&&this.keyboard.update(),this.pollRate>0&&this._pollCounter<this.pollRate)this._pollCounter++;else{this.speed.x=this.position.x-this._oldPosition.x,this.speed.y=this.position.y-this._oldPosition.y,this._oldPosition.copyFrom(this.position),this.mousePointer.update(),this.gamepad&&this.gamepad.active&&this.gamepad.update();for(var e=0;e<this.pointers.length;e++)this.pointers[e].update();this._pollCounter=0}},reset:function(e){if(this.game.isBooted&&!this.resetLocked){void 0===e&&(e=!1),this.mousePointer.reset(),this.keyboard&&this.keyboard.reset(e),this.gamepad&&this.gamepad.reset();for(var t=0;t<this.pointers.length;t++)this.pointers[t].reset();"none"!==this.game.canvas.style.cursor&&(this.game.canvas.style.cursor="inherit"),e&&(this.onDown.dispose(),this.onUp.dispose(),this.onTap.dispose(),this.onHold.dispose(),this.onDown=new i.Signal,this.onUp=new i.Signal,this.onTap=new i.Signal,this.onHold=new i.Signal,this.moveCallbacks=[]),this._pollCounter=0}},resetSpeed:function(e,t){this._oldPosition.setTo(e,t),this.speed.setTo(0,0)},startPointer:function(e){if(this.maxPointers>=0&&this.countActivePointers(this.maxPointers)>=this.maxPointers)return null;if(!this.pointer1.active)return this.pointer1.start(e);if(!this.pointer2.active)return this.pointer2.start(e);for(var t=2;t<this.pointers.length;t++){var i=this.pointers[t];if(!i.active)return i.start(e)}return null},updatePointer:function(e){if(this.pointer1.active&&this.pointer1.identifier===e.identifier)return this.pointer1.move(e);if(this.pointer2.active&&this.pointer2.identifier===e.identifier)return this.pointer2.move(e);for(var t=2;t<this.pointers.length;t++){var i=this.pointers[t];if(i.active&&i.identifier===e.identifier)return i.move(e)}return null},stopPointer:function(e){if(this.pointer1.active&&this.pointer1.identifier===e.identifier)return this.pointer1.stop(e);if(this.pointer2.active&&this.pointer2.identifier===e.identifier)return this.pointer2.stop(e);for(var t=2;t<this.pointers.length;t++){var i=this.pointers[t];if(i.active&&i.identifier===e.identifier)return i.stop(e)}return null},countActivePointers:function(e){void 0===e&&(e=this.pointers.length);for(var t=e,i=0;i<this.pointers.length&&t>0;i++)this.pointers[i].active&&t--;return e-t},getPointer:function(e){void 0===e&&(e=!1);for(var t=0;t<this.pointers.length;t++){var i=this.pointers[t];if(i.active===e)return i}return null},getPointerFromIdentifier:function(e){for(var t=0;t<this.pointers.length;t++){var i=this.pointers[t];if(i.identifier===e)return i}return null},getPointerFromId:function(e){for(var t=0;t<this.pointers.length;t++){var i=this.pointers[t];if(i.pointerId===e)return i}return null},getLocalPosition:function(e,t,s){void 0===s&&(s=new i.Point);var a=e.worldTransform,n=1/(a.a*a.d+a.c*-a.b);return s.setTo(a.d*n*t.x+-a.c*n*t.y+(a.ty*a.c-a.tx*a.d)*n,a.a*n*t.y+-a.b*n*t.x+(-a.ty*a.a+a.tx*a.b)*n)},hitTest:function(e,t,s){if(!e.worldVisible)return!1;if(this.getLocalPosition(e,t,this._localPoint),s.copyFrom(this._localPoint),e.hitArea&&e.hitArea.contains)return e.hitArea.contains(this._localPoint.x,this._localPoint.y);if(e instanceof i.TileSprite){var a=e.width,n=e.height,o=-a*e.anchor.x;if(this._localPoint.x>=o&&this._localPoint.x<o+a){r=-n*e.anchor.y;if(this._localPoint.y>=r&&this._localPoint.y<r+n)return!0}}else if(e instanceof PIXI.Sprite){var a=e.texture.frame.width,n=e.texture.frame.height,o=-a*e.anchor.x;if(this._localPoint.x>=o&&this._localPoint.x<o+a){var r=-n*e.anchor.y;if(this._localPoint.y>=r&&this._localPoint.y<r+n)return!0}}else if(e instanceof i.Graphics)for(h=0;h<e.graphicsData.length;h++){var l=e.graphicsData[h];if(l.fill&&l.shape&&l.shape.contains(this._localPoint.x,this._localPoint.y))return!0}for(var h=0;h<e.children.length;h++)if(this.hitTest(e.children[h],t,s))return!0;return!1},onClickTrampoline:function(){this.activePointer.processClickTrampolines()}},i.Input.prototype.constructor=i.Input,Object.defineProperty(i.Input.prototype,"x",{get:function(){return this._x},set:function(e){this._x=Math.floor(e)}}),Object.defineProperty(i.Input.prototype,"y",{get:function(){return this._y},set:function(e){this._y=Math.floor(e)}}),Object.defineProperty(i.Input.prototype,"pollLocked",{get:function(){return this.pollRate>0&&this._pollCounter<this.pollRate}}),Object.defineProperty(i.Input.prototype,"totalInactivePointers",{get:function(){return this.pointers.length-this.countActivePointers()}}),Object.defineProperty(i.Input.prototype,"totalActivePointers",{get:function(){return this.countActivePointers()}}),Object.defineProperty(i.Input.prototype,"worldX",{get:function(){return this.game.camera.view.x+this.x}}),Object.defineProperty(i.Input.prototype,"worldY",{get:function(){return this.game.camera.view.y+this.y}}),i.Mouse=function(e){this.game=e,this.input=e.input,this.callbackContext=this.game,this.mouseDownCallback=null,this.mouseUpCallback=null,this.mouseOutCallback=null,this.mouseOverCallback=null,this.mouseWheelCallback=null,this.capture=!1,this.button=-1,this.wheelDelta=0,this.enabled=!0,this.locked=!1,this.stopOnGameOut=!1,this.pointerLock=new i.Signal,this.event=null,this._onMouseDown=null,this._onMouseMove=null,this._onMouseUp=null,this._onMouseOut=null,this._onMouseOver=null,this._onMouseWheel=null,this._wheelEvent=null},i.Mouse.NO_BUTTON=-1,i.Mouse.LEFT_BUTTON=0,i.Mouse.MIDDLE_BUTTON=1,i.Mouse.RIGHT_BUTTON=2,i.Mouse.BACK_BUTTON=3,i.Mouse.FORWARD_BUTTON=4,i.Mouse.WHEEL_UP=1,i.Mouse.WHEEL_DOWN=-1,i.Mouse.prototype={start:function(){if((!this.game.device.android||!1!==this.game.device.chrome)&&null===this._onMouseDown){var t=this;this._onMouseDown=function(e){return t.onMouseDown(e)},this._onMouseMove=function(e){return t.onMouseMove(e)},this._onMouseUp=function(e){return t.onMouseUp(e)},this._onMouseUpGlobal=function(e){return t.onMouseUpGlobal(e)},this._onMouseOutGlobal=function(e){return t.onMouseOutGlobal(e)},this._onMouseOut=function(e){return t.onMouseOut(e)},this._onMouseOver=function(e){return t.onMouseOver(e)},this._onMouseWheel=function(e){return t.onMouseWheel(e)};var i=this.game.canvas;i.addEventListener("mousedown",this._onMouseDown,!0),i.addEventListener("mousemove",this._onMouseMove,!0),i.addEventListener("mouseup",this._onMouseUp,!0),this.game.device.cocoonJS||(window.addEventListener("mouseup",this._onMouseUpGlobal,!0),window.addEventListener("mouseout",this._onMouseOutGlobal,!0),i.addEventListener("mouseover",this._onMouseOver,!0),i.addEventListener("mouseout",this._onMouseOut,!0));var s=this.game.device.wheelEvent;s&&(i.addEventListener(s,this._onMouseWheel,!0),"mousewheel"===s?this._wheelEvent=new e(-.025,1):"DOMMouseScroll"===s&&(this._wheelEvent=new e(1,1)))}},onMouseDown:function(e){this.event=e,this.capture&&e.preventDefault(),this.mouseDownCallback&&this.mouseDownCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=0,this.input.mousePointer.start(e))},onMouseMove:function(e){this.event=e,this.capture&&e.preventDefault(),this.mouseMoveCallback&&this.mouseMoveCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=0,this.input.mousePointer.move(e))},onMouseUp:function(e){this.event=e,this.capture&&e.preventDefault(),this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=0,this.input.mousePointer.stop(e))},onMouseUpGlobal:function(e){this.input.mousePointer.withinGame||(this.mouseUpCallback&&this.mouseUpCallback.call(this.callbackContext,e),e.identifier=0,this.input.mousePointer.stop(e))},onMouseOutGlobal:function(e){this.event=e,this.capture&&e.preventDefault(),this.input.mousePointer.withinGame=!1,this.input.enabled&&this.enabled&&(this.input.mousePointer.stop(e),this.input.mousePointer.leftButton.stop(e),this.input.mousePointer.rightButton.stop(e))},onMouseOut:function(e){this.event=e,this.capture&&e.preventDefault(),this.input.mousePointer.withinGame=!1,this.mouseOutCallback&&this.mouseOutCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&this.stopOnGameOut&&(e.identifier=0,this.input.mousePointer.stop(e))},onMouseOver:function(e){this.event=e,this.capture&&e.preventDefault(),this.input.mousePointer.withinGame=!0,this.mouseOverCallback&&this.mouseOverCallback.call(this.callbackContext,e)},onMouseWheel:function(e){this._wheelEvent&&(e=this._wheelEvent.bindEvent(e)),this.event=e,this.capture&&e.preventDefault(),this.wheelDelta=i.Math.clamp(-e.deltaY,-1,1),this.mouseWheelCallback&&this.mouseWheelCallback.call(this.callbackContext,e)},requestPointerLock:function(){if(this.game.device.pointerLock){var e=this.game.canvas;e.requestPointerLock=e.requestPointerLock||e.mozRequestPointerLock||e.webkitRequestPointerLock,e.requestPointerLock();var t=this;this._pointerLockChange=function(e){return t.pointerLockChange(e)},document.addEventListener("pointerlockchange",this._pointerLockChange,!0),document.addEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.addEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}},pointerLockChange:function(e){var t=this.game.canvas;document.pointerLockElement===t||document.mozPointerLockElement===t||document.webkitPointerLockElement===t?(this.locked=!0,this.pointerLock.dispatch(!0,e)):(this.locked=!1,this.pointerLock.dispatch(!1,e))},releasePointerLock:function(){document.exitPointerLock=document.exitPointerLock||document.mozExitPointerLock||document.webkitExitPointerLock,document.exitPointerLock(),document.removeEventListener("pointerlockchange",this._pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)},stop:function(){var e=this.game.canvas;e.removeEventListener("mousedown",this._onMouseDown,!0),e.removeEventListener("mousemove",this._onMouseMove,!0),e.removeEventListener("mouseup",this._onMouseUp,!0),e.removeEventListener("mouseover",this._onMouseOver,!0),e.removeEventListener("mouseout",this._onMouseOut,!0);var t=this.game.device.wheelEvent;t&&e.removeEventListener(t,this._onMouseWheel,!0),window.removeEventListener("mouseup",this._onMouseUpGlobal,!0),window.removeEventListener("mouseout",this._onMouseOutGlobal,!0),document.removeEventListener("pointerlockchange",this._pointerLockChange,!0),document.removeEventListener("mozpointerlockchange",this._pointerLockChange,!0),document.removeEventListener("webkitpointerlockchange",this._pointerLockChange,!0)}},i.Mouse.prototype.constructor=i.Mouse,(e.prototype={}).constructor=e,e.prototype.bindEvent=function(t){if(!e._stubsGenerated&&t){for(var i in t)i in e.prototype||Object.defineProperty(e.prototype,i,{get:function(e){return function(){var t=this.originalEvent[e];return"function"!=typeof t?t:t.bind(this.originalEvent)}}(i)});e._stubsGenerated=!0}return this.originalEvent=t,this},Object.defineProperties(e.prototype,{type:{value:"wheel"},deltaMode:{get:function(){return this._deltaMode}},deltaY:{get:function(){return this._scaleFactor*(this.originalEvent.wheelDelta||this.originalEvent.detail)||0}},deltaX:{get:function(){return this._scaleFactor*this.originalEvent.wheelDeltaX||0}},deltaZ:{value:0}}),i.MSPointer=function(e){this.game=e,this.input=e.input,this.callbackContext=this.game,this.pointerDownCallback=null,this.pointerMoveCallback=null,this.pointerUpCallback=null,this.capture=!0,this.button=-1,this.event=null,this.enabled=!0,this._onMSPointerDown=null,this._onMSPointerMove=null,this._onMSPointerUp=null,this._onMSPointerUpGlobal=null,this._onMSPointerOut=null,this._onMSPointerOver=null},i.MSPointer.prototype={start:function(){if(null===this._onMSPointerDown){var e=this;if(this.game.device.mspointer){this._onMSPointerDown=function(t){return e.onPointerDown(t)},this._onMSPointerMove=function(t){return e.onPointerMove(t)},this._onMSPointerUp=function(t){return e.onPointerUp(t)},this._onMSPointerUpGlobal=function(t){return e.onPointerUpGlobal(t)},this._onMSPointerOut=function(t){return e.onPointerOut(t)},this._onMSPointerOver=function(t){return e.onPointerOver(t)};var t=this.game.canvas;t.addEventListener("MSPointerDown",this._onMSPointerDown,!1),t.addEventListener("MSPointerMove",this._onMSPointerMove,!1),t.addEventListener("MSPointerUp",this._onMSPointerUp,!1),t.addEventListener("pointerdown",this._onMSPointerDown,!1),t.addEventListener("pointermove",this._onMSPointerMove,!1),t.addEventListener("pointerup",this._onMSPointerUp,!1),t.style["-ms-content-zooming"]="none",t.style["-ms-touch-action"]="none",this.game.device.cocoonJS||(window.addEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0),t.addEventListener("MSPointerOver",this._onMSPointerOver,!0),t.addEventListener("MSPointerOut",this._onMSPointerOut,!0),window.addEventListener("pointerup",this._onMSPointerUpGlobal,!0),t.addEventListener("pointerover",this._onMSPointerOver,!0),t.addEventListener("pointerout",this._onMSPointerOut,!0))}}},onPointerDown:function(e){this.event=e,this.capture&&e.preventDefault(),this.pointerDownCallback&&this.pointerDownCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=e.pointerId,"mouse"===e.pointerType||4===e.pointerType?this.input.mousePointer.start(e):this.input.startPointer(e))},onPointerMove:function(e){this.event=e,this.capture&&e.preventDefault(),this.pointerMoveCallback&&this.pointerMoveCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=e.pointerId,"mouse"===e.pointerType||4===e.pointerType?this.input.mousePointer.move(e):this.input.updatePointer(e))},onPointerUp:function(e){this.event=e,this.capture&&e.preventDefault(),this.pointerUpCallback&&this.pointerUpCallback.call(this.callbackContext,e),this.input.enabled&&this.enabled&&(e.identifier=e.pointerId,"mouse"===e.pointerType||4===e.pointerType?this.input.mousePointer.stop(e):this.input.stopPointer(e))},onPointerUpGlobal:function(e){if("mouse"!==e.pointerType&&4!==e.pointerType||this.input.mousePointer.withinGame){var t=this.input.getPointerFromIdentifier(e.identifier);t&&t.withinGame&&this.onPointerUp(e)}else this.onPointerUp(e)},onPointerOut:function(e){if(this.event=e,this.capture&&e.preventDefault(),"mouse"===e.pointerType||4===e.pointerType)this.input.mousePointer.withinGame=!1;else{var t=this.input.getPointerFromIdentifier(e.identifier);t&&(t.withinGame=!1)}this.input.mouse.mouseOutCallback&&this.input.mouse.mouseOutCallback.call(this.input.mouse.callbackContext,e),this.input.enabled&&this.enabled&&this.input.mouse.stopOnGameOut&&(e.identifier=0,t?t.stop(e):this.input.mousePointer.stop(e))},onPointerOver:function(e){if(this.event=e,this.capture&&e.preventDefault(),"mouse"===e.pointerType||4===e.pointerType)this.input.mousePointer.withinGame=!0;else{var t=this.input.getPointerFromIdentifier(e.identifier);t&&(t.withinGame=!0)}this.input.mouse.mouseOverCallback&&this.input.mouse.mouseOverCallback.call(this.input.mouse.callbackContext,e)},stop:function(){var e=this.game.canvas;e.removeEventListener("MSPointerDown",this._onMSPointerDown,!1),e.removeEventListener("MSPointerMove",this._onMSPointerMove,!1),e.removeEventListener("MSPointerUp",this._onMSPointerUp,!1),e.removeEventListener("pointerdown",this._onMSPointerDown,!1),e.removeEventListener("pointermove",this._onMSPointerMove,!1),e.removeEventListener("pointerup",this._onMSPointerUp,!1),window.removeEventListener("MSPointerUp",this._onMSPointerUpGlobal,!0),e.removeEventListener("MSPointerOver",this._onMSPointerOver,!0),e.removeEventListener("MSPointerOut",this._onMSPointerOut,!0),window.removeEventListener("pointerup",this._onMSPointerUpGlobal,!0),e.removeEventListener("pointerover",this._onMSPointerOver,!0),e.removeEventListener("pointerout",this._onMSPointerOut,!0)}},i.MSPointer.prototype.constructor=i.MSPointer,i.DeviceButton=function(e,t){this.parent=e,this.game=e.game,this.event=null,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.timeUp=0,this.repeats=0,this.altKey=!1,this.shiftKey=!1,this.ctrlKey=!1,this.value=0,this.buttonCode=t,this.onDown=new i.Signal,this.onUp=new i.Signal,this.onFloat=new i.Signal},i.DeviceButton.prototype={start:function(e,t){this.isDown||(this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.repeats=0,this.event=e,this.value=t,e&&(this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.ctrlKey=e.ctrlKey),this.onDown.dispatch(this,t))},stop:function(e,t){this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.event=e,this.value=t,e&&(this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.ctrlKey=e.ctrlKey),this.onUp.dispatch(this,t))},padFloat:function(e){this.value=e,this.onFloat.dispatch(this,e)},justPressed:function(e){return e=e||250,this.isDown&&this.timeDown+e>this.game.time.time},justReleased:function(e){return e=e||250,this.isUp&&this.timeUp+e>this.game.time.time},reset:function(){this.isDown=!1,this.isUp=!0,this.timeDown=this.game.time.time,this.repeats=0,this.altKey=!1,this.shiftKey=!1,this.ctrlKey=!1},destroy:function(){this.onDown.dispose(),this.onUp.dispose(),this.onFloat.dispose(),this.parent=null,this.game=null}},i.DeviceButton.prototype.constructor=i.DeviceButton,Object.defineProperty(i.DeviceButton.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}}),i.Pointer=function(e,t,s){this.game=e,this.id=t,this.type=i.POINTER,this.exists=!0,this.identifier=0,this.pointerId=null,this.pointerMode=s||i.PointerMode.CURSOR|i.PointerMode.CONTACT,this.target=null,this.button=null,this.leftButton=new i.DeviceButton(this,i.Pointer.LEFT_BUTTON),this.middleButton=new i.DeviceButton(this,i.Pointer.MIDDLE_BUTTON),this.rightButton=new i.DeviceButton(this,i.Pointer.RIGHT_BUTTON),this.backButton=new i.DeviceButton(this,i.Pointer.BACK_BUTTON),this.forwardButton=new i.DeviceButton(this,i.Pointer.FORWARD_BUTTON),this.eraserButton=new i.DeviceButton(this,i.Pointer.ERASER_BUTTON),this._holdSent=!1,this._history=[],this._nextDrop=0,this._stateReset=!1,this.withinGame=!1,this.clientX=-1,this.clientY=-1,this.pageX=-1,this.pageY=-1,this.screenX=-1,this.screenY=-1,this.rawMovementX=0,this.rawMovementY=0,this.movementX=0,this.movementY=0,this.x=-1,this.y=-1,this.isMouse=0===t,this.isDown=!1,this.isUp=!0,this.timeDown=0,this.timeUp=0,this.previousTapTime=0,this.totalTouches=0,this.msSinceLastClick=Number.MAX_VALUE,this.targetObject=null,this.interactiveCandidates=[],this.active=!1,this.dirty=!1,this.position=new i.Point,this.positionDown=new i.Point,this.positionUp=new i.Point,this.circle=new i.Circle(0,0,44),this._clickTrampolines=null,this._trampolineTargetObject=null},i.Pointer.NO_BUTTON=0,i.Pointer.LEFT_BUTTON=1,i.Pointer.RIGHT_BUTTON=2,i.Pointer.MIDDLE_BUTTON=4,i.Pointer.BACK_BUTTON=8,i.Pointer.FORWARD_BUTTON=16,i.Pointer.ERASER_BUTTON=32,i.Pointer.prototype={resetButtons:function(){this.isDown=!1,this.isUp=!0,this.isMouse&&(this.leftButton.reset(),this.middleButton.reset(),this.rightButton.reset(),this.backButton.reset(),this.forwardButton.reset(),this.eraserButton.reset())},processButtonsDown:function(e,t){i.Pointer.LEFT_BUTTON&e&&this.leftButton.start(t),i.Pointer.RIGHT_BUTTON&e&&this.rightButton.start(t),i.Pointer.MIDDLE_BUTTON&e&&this.middleButton.start(t),i.Pointer.BACK_BUTTON&e&&this.backButton.start(t),i.Pointer.FORWARD_BUTTON&e&&this.forwardButton.start(t),i.Pointer.ERASER_BUTTON&e&&this.eraserButton.start(t)},processButtonsUp:function(e,t){e===i.Mouse.LEFT_BUTTON&&this.leftButton.stop(t),e===i.Mouse.RIGHT_BUTTON&&this.rightButton.stop(t),e===i.Mouse.MIDDLE_BUTTON&&this.middleButton.stop(t),e===i.Mouse.BACK_BUTTON&&this.backButton.stop(t),e===i.Mouse.FORWARD_BUTTON&&this.forwardButton.stop(t),5===e&&this.eraserButton.stop(t)},updateButtons:function(e){this.button=e.button;var t="down"===e.type.toLowerCase().substr(-4);void 0!==e.buttons?t?this.processButtonsDown(e.buttons,e):this.processButtonsUp(e.button,e):t?this.leftButton.start(e):(this.leftButton.stop(e),this.rightButton.stop(e)),1===e.buttons&&e.ctrlKey&&this.leftButton.isDown&&(this.leftButton.stop(e),this.rightButton.start(e)),this.isUp=!0,this.isDown=!1,(this.leftButton.isDown||this.rightButton.isDown||this.middleButton.isDown||this.backButton.isDown||this.forwardButton.isDown||this.eraserButton.isDown)&&(this.isUp=!1,this.isDown=!0)},start:function(e){var t=this.game.input;return e.pointerId&&(this.pointerId=e.pointerId),this.identifier=e.identifier,this.target=e.target,this.isMouse?this.updateButtons(e):(this.isDown=!0,this.isUp=!1),this.active=!0,this.withinGame=!0,this.dirty=!1,this._history=[],this._clickTrampolines=null,this._trampolineTargetObject=null,this.msSinceLastClick=this.game.time.time-this.timeDown,this.timeDown=this.game.time.time,this._holdSent=!1,this.move(e,!0),this.positionDown.setTo(this.x,this.y),(t.multiInputOverride===i.Input.MOUSE_OVERRIDES_TOUCH||t.multiInputOverride===i.Input.MOUSE_TOUCH_COMBINE||t.multiInputOverride===i.Input.TOUCH_OVERRIDES_MOUSE&&0===t.totalActivePointers)&&(t.x=this.x,t.y=this.y,t.position.setTo(this.x,this.y),t.onDown.dispatch(this,e),t.resetSpeed(this.x,this.y)),this._stateReset=!1,this.totalTouches++,null!==this.targetObject&&this.targetObject._touchedHandler(this),this},update:function(){var e=this.game.input;this.active&&(this.dirty&&(e.interactiveItems.total>0&&this.processInteractiveObjects(!1),this.dirty=!1),!1===this._holdSent&&this.duration>=e.holdRate&&((e.multiInputOverride===i.Input.MOUSE_OVERRIDES_TOUCH||e.multiInputOverride===i.Input.MOUSE_TOUCH_COMBINE||e.multiInputOverride===i.Input.TOUCH_OVERRIDES_MOUSE&&0===e.totalActivePointers)&&e.onHold.dispatch(this),this._holdSent=!0),e.recordPointerHistory&&this.game.time.time>=this._nextDrop&&(this._nextDrop=this.game.time.time+e.recordRate,this._history.push({x:this.position.x,y:this.position.y}),this._history.length>e.recordLimit&&this._history.shift()))},move:function(e,t){var s=this.game.input;if(!s.pollLocked){if(void 0===t&&(t=!1),void 0!==e.button&&(this.button=e.button),t&&this.isMouse&&this.updateButtons(e),this.clientX=e.clientX,this.clientY=e.clientY,this.pageX=e.pageX,this.pageY=e.pageY,this.screenX=e.screenX,this.screenY=e.screenY,this.isMouse&&s.mouse.locked&&!t&&(this.rawMovementX=e.movementX||e.mozMovementX||e.webkitMovementX||0,this.rawMovementY=e.movementY||e.mozMovementY||e.webkitMovementY||0,this.movementX+=this.rawMovementX,this.movementY+=this.rawMovementY),this.x=(this.pageX-this.game.scale.offset.x)*s.scale.x,this.y=(this.pageY-this.game.scale.offset.y)*s.scale.y,this.position.setTo(this.x,this.y),this.circle.x=this.x,this.circle.y=this.y,(s.multiInputOverride===i.Input.MOUSE_OVERRIDES_TOUCH||s.multiInputOverride===i.Input.MOUSE_TOUCH_COMBINE||s.multiInputOverride===i.Input.TOUCH_OVERRIDES_MOUSE&&0===s.totalActivePointers)&&(s.activePointer=this,s.x=this.x,s.y=this.y,s.position.setTo(s.x,s.y),s.circle.x=s.x,s.circle.y=s.y),this.withinGame=this.game.scale.bounds.contains(this.pageX,this.pageY),this.game.paused)return this;for(var a=s.moveCallbacks.length;a--;)s.moveCallbacks[a].callback.call(s.moveCallbacks[a].context,this,this.x,this.y,t);return null!==this.targetObject&&!0===this.targetObject.isDragged?!1===this.targetObject.update(this)&&(this.targetObject=null):s.interactiveItems.total>0&&this.processInteractiveObjects(t),this}},processInteractiveObjects:function(e){var t=0,i=-1,s=null,a=this.game.input.interactiveItems.first;for(this.interactiveCandidates=[];a;)a.checked=!1,a.validForInput(i,t,!1)&&(a.checked=!0,(e&&a.checkPointerDown(this,!0)||!e&&a.checkPointerOver(this,!0))&&(t=a.sprite.renderOrderID,i=a.priorityID,s=a,this.interactiveCandidates.push(a))),a=this.game.input.interactiveItems.next;for(a=this.game.input.interactiveItems.first;a;)!a.checked&&a.validForInput(i,t,!0)&&(e&&a.checkPointerDown(this,!1)||!e&&a.checkPointerOver(this,!1))&&(t=a.sprite.renderOrderID,i=a.priorityID,s=a,this.interactiveCandidates.push(a)),a=this.game.input.interactiveItems.next;return this.game.input.customCandidateHandler&&(s=this.game.input.customCandidateHandler.call(this.game.input.customCandidateHandlerContext,this,this.interactiveCandidates,s)),this.swapTarget(s,!1),null!==this.targetObject},swapTarget:function(e,t){void 0===t&&(t=!1),null===e?this.targetObject&&(this.targetObject._pointerOutHandler(this,t),this.targetObject=null):null===this.targetObject?(this.targetObject=e,e._pointerOverHandler(this,t)):this.targetObject===e?!1===e.update(this)&&(this.targetObject=null):(this.targetObject._pointerOutHandler(this,t),this.targetObject=e,this.targetObject._pointerOverHandler(this,t))},leave:function(e){this.withinGame=!1,this.move(e,!1)},stop:function(e){var t=this.game.input;return this._stateReset&&this.withinGame?void e.preventDefault():(this.timeUp=this.game.time.time,(t.multiInputOverride===i.Input.MOUSE_OVERRIDES_TOUCH||t.multiInputOverride===i.Input.MOUSE_TOUCH_COMBINE||t.multiInputOverride===i.Input.TOUCH_OVERRIDES_MOUSE&&0===t.totalActivePointers)&&(t.onUp.dispatch(this,e),this.duration>=0&&this.duration<=t.tapRate&&(this.timeUp-this.previousTapTime<t.doubleTapRate?t.onTap.dispatch(this,!0):t.onTap.dispatch(this,!1),this.previousTapTime=this.timeUp)),this.isMouse?this.updateButtons(e):(this.isDown=!1,this.isUp=!0),this.id>0&&(this.active=!1),this.withinGame=this.game.scale.bounds.contains(e.pageX,e.pageY),this.pointerId=null,this.identifier=null,this.positionUp.setTo(this.x,this.y),!1===this.isMouse&&t.currentPointers--,t.interactiveItems.callAll("_releasedHandler",this),this._clickTrampolines&&(this._trampolineTargetObject=this.targetObject),this.targetObject=null,this)},justPressed:function(e){return e=e||this.game.input.justPressedRate,!0===this.isDown&&this.timeDown+e>this.game.time.time},justReleased:function(e){return e=e||this.game.input.justReleasedRate,this.isUp&&this.timeUp+e>this.game.time.time},addClickTrampoline:function(e,t,i,s){if(this.isDown){for(var a=this._clickTrampolines=this._clickTrampolines||[],n=0;n<a.length;n++)if(a[n].name===e){a.splice(n,1);break}a.push({name:e,targetObject:this.targetObject,callback:t,callbackContext:i,callbackArgs:s})}},processClickTrampolines:function(){var e=this._clickTrampolines;if(e){for(var t=0;t<e.length;t++){var i=e[t];i.targetObject===this._trampolineTargetObject&&i.callback.apply(i.callbackContext,i.callbackArgs)}this._clickTrampolines=null,this._trampolineTargetObject=null}},reset:function(){!1===this.isMouse&&(this.active=!1),this.pointerId=null,this.identifier=null,this.dirty=!1,this.totalTouches=0,this._holdSent=!1,this._history.length=0,this._stateReset=!0,this.resetButtons(),this.targetObject&&this.targetObject._releasedHandler(this),this.targetObject=null},resetMovement:function(){this.movementX=0,this.movementY=0}},i.Pointer.prototype.constructor=i.Pointer,Object.defineProperty(i.Pointer.prototype,"duration",{get:function(){return this.isUp?-1:this.game.time.time-this.timeDown}}),Object.defineProperty(i.Pointer.prototype,"worldX",{get:function(){return this.game.world.camera.x+this.x}}),Object.defineProperty(i.Pointer.prototype,"worldY",{get:function(){return this.game.world.camera.y+this.y}}),i.PointerMode={CURSOR:1,CONTACT:2},i.Touch=function(e){this.game=e,this.enabled=!0,this.touchLockCallbacks=[],this.callbackContext=this.game,this.touchStartCallback=null,this.touchMoveCallback=null,this.touchEndCallback=null,this.touchEnterCallback=null,this.touchLeaveCallback=null,this.touchCancelCallback=null,this.preventDefault=!0,this.event=null,this._onTouchStart=null,this._onTouchMove=null,this._onTouchEnd=null,this._onTouchEnter=null,this._onTouchLeave=null,this._onTouchCancel=null,this._onTouchMove=null},i.Touch.prototype={start:function(){if(null===this._onTouchStart){var e=this;this.game.device.touch&&(this._onTouchStart=function(t){return e.onTouchStart(t)},this._onTouchMove=function(t){return e.onTouchMove(t)},this._onTouchEnd=function(t){return e.onTouchEnd(t)},this._onTouchEnter=function(t){return e.onTouchEnter(t)},this._onTouchLeave=function(t){return e.onTouchLeave(t)},this._onTouchCancel=function(t){return e.onTouchCancel(t)},this.game.canvas.addEventListener("touchstart",this._onTouchStart,!1),this.game.canvas.addEventListener("touchmove",this._onTouchMove,!1),this.game.canvas.addEventListener("touchend",this._onTouchEnd,!1),this.game.canvas.addEventListener("touchcancel",this._onTouchCancel,!1),this.game.device.cocoonJS||(this.game.canvas.addEventListener("touchenter",this._onTouchEnter,!1),this.game.canvas.addEventListener("touchleave",this._onTouchLeave,!1)))}},consumeDocumentTouches:function(){this._documentTouchMove=function(e){e.preventDefault()},document.addEventListener("touchmove",this._documentTouchMove,!1)},addTouchLockCallback:function(e,t,i){void 0===i&&(i=!1),this.touchLockCallbacks.push({callback:e,context:t,onEnd:i})},removeTouchLockCallback:function(e,t){for(var i=this.touchLockCallbacks.length;i--;)if(this.touchLockCallbacks[i].callback===e&&this.touchLockCallbacks[i].context===t)return this.touchLockCallbacks.splice(i,1),!0;return!1},onTouchStart:function(e){for(i=this.touchLockCallbacks.length;i--;){var t=this.touchLockCallbacks[i];!t.onEnd&&t.callback.call(t.context,this,e)&&this.touchLockCallbacks.splice(i,1)}if(this.event=e,this.game.input.enabled&&this.enabled){this.touchStartCallback&&this.touchStartCallback.call(this.callbackContext,e),this.preventDefault&&e.preventDefault();for(var i=0;i<e.changedTouches.length;i++)this.game.input.startPointer(e.changedTouches[i])}},onTouchCancel:function(e){if(this.event=e,this.touchCancelCallback&&this.touchCancelCallback.call(this.callbackContext,e),this.game.input.enabled&&this.enabled){this.preventDefault&&e.preventDefault();for(var t=0;t<e.changedTouches.length;t++)this.game.input.stopPointer(e.changedTouches[t])}},onTouchEnter:function(e){this.event=e,this.touchEnterCallback&&this.touchEnterCallback.call(this.callbackContext,e),this.game.input.enabled&&this.enabled&&this.preventDefault&&e.preventDefault()},onTouchLeave:function(e){this.event=e,this.touchLeaveCallback&&this.touchLeaveCallback.call(this.callbackContext,e),this.preventDefault&&e.preventDefault()},onTouchMove:function(e){this.event=e,this.touchMoveCallback&&this.touchMoveCallback.call(this.callbackContext,e),this.preventDefault&&e.preventDefault();for(var t=0;t<e.changedTouches.length;t++)this.game.input.updatePointer(e.changedTouches[t])},onTouchEnd:function(e){for(i=this.touchLockCallbacks.length;i--;){var t=this.touchLockCallbacks[i];t.onEnd&&t.callback.call(t.context,this,e)&&this.touchLockCallbacks.splice(i,1)}this.event=e,this.touchEndCallback&&this.touchEndCallback.call(this.callbackContext,e),this.preventDefault&&e.preventDefault();for(var i=0;i<e.changedTouches.length;i++)this.game.input.stopPointer(e.changedTouches[i])},stop:function(){this.game.device.touch&&(this.game.canvas.removeEventListener("touchstart",this._onTouchStart),this.game.canvas.removeEventListener("touchmove",this._onTouchMove),this.game.canvas.removeEventListener("touchend",this._onTouchEnd),this.game.canvas.removeEventListener("touchenter",this._onTouchEnter),this.game.canvas.removeEventListener("touchleave",this._onTouchLeave),this.game.canvas.removeEventListener("touchcancel",this._onTouchCancel))}},i.Touch.prototype.constructor=i.Touch,i.InputHandler=function(e){this.sprite=e,this.game=e.game,this.enabled=!1,this.checked=!1,this.priorityID=0,this.useHandCursor=!1,this._setHandCursor=!1,this.isDragged=!1,this.allowHorizontalDrag=!0,this.allowVerticalDrag=!0,this.bringToTop=!1,this.snapOffset=null,this.snapOnDrag=!1,this.snapOnRelease=!1,this.snapX=0,this.snapY=0,this.snapOffsetX=0,this.snapOffsetY=0,this.pixelPerfectOver=!1,this.pixelPerfectClick=!1,this.pixelPerfectAlpha=255,this.draggable=!1,this.boundsRect=null,this.boundsSprite=null,this.scaleLayer=!1,this.dragOffset=new i.Point,this.dragFromCenter=!1,this.dragStopBlocksInputUp=!1,this.dragStartPoint=new i.Point,this.dragDistanceThreshold=0,this.dragTimeThreshold=0,this.downPoint=new i.Point,this.snapPoint=new i.Point,this._dragPoint=new i.Point,this._dragPhase=!1,this._pendingDrag=!1,this._dragTimePass=!1,this._dragDistancePass=!1,this._wasEnabled=!1,this._tempPoint=new i.Point,this._pointerData=[],this._pointerData.push({id:0,x:0,y:0,camX:0,camY:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1})},i.InputHandler.prototype={start:function(e,t){if(e=e||0,void 0===t&&(t=!1),!1===this.enabled){this.game.input.interactiveItems.add(this),this.useHandCursor=t,this.priorityID=e;for(var s=0;s<10;s++)this._pointerData[s]={id:s,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1};this.snapOffset=new i.Point,this.enabled=!0,this._wasEnabled=!0}return this.sprite.events.onAddedToGroup.add(this.addedToGroup,this),this.sprite.events.onRemovedFromGroup.add(this.removedFromGroup,this),this.sprite},addedToGroup:function(){this._dragPhase||this._wasEnabled&&!this.enabled&&this.start()},removedFromGroup:function(){this._dragPhase||(this.enabled?(this._wasEnabled=!0,this.stop()):this._wasEnabled=!1)},reset:function(){this.enabled=!1;for(var e=0;e<10;e++)this._pointerData[e]={id:e,x:0,y:0,isDown:!1,isUp:!1,isOver:!1,isOut:!1,timeOver:0,timeOut:0,timeDown:0,timeUp:0,downDuration:0,isDragged:!1}},stop:function(){!1!==this.enabled&&(this.enabled=!1,this.game.input.interactiveItems.remove(this))},destroy:function(){this.sprite&&(this._setHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),this.enabled=!1,this.game.input.interactiveItems.remove(this),this._pointerData.length=0,this.boundsRect=null,this.boundsSprite=null,this.sprite=null)},validForInput:function(e,t,i){return void 0===i&&(i=!0),!(!this.enabled||0===this.sprite.scale.x||0===this.sprite.scale.y||this.priorityID<this.game.input.minPriorityID||this.sprite.parent&&this.sprite.parent.ignoreChildInput||!i&&(this.pixelPerfectClick||this.pixelPerfectOver)||!(this.priorityID>e||this.priorityID===e&&this.sprite.renderOrderID>t))},isPixelPerfect:function(){return this.pixelPerfectClick||this.pixelPerfectOver},pointerX:function(e){return e=e||0,this._pointerData[e].x},pointerY:function(e){return e=e||0,this._pointerData[e].y},pointerDown:function(e){return e=e||0,this._pointerData[e].isDown},pointerUp:function(e){return e=e||0,this._pointerData[e].isUp},pointerTimeDown:function(e){return e=e||0,this._pointerData[e].timeDown},pointerTimeUp:function(e){return e=e||0,this._pointerData[e].timeUp},pointerOver:function(e){if(!this.enabled)return!1;if(void 0===e){for(var t=0;t<10;t++)if(this._pointerData[t].isOver)return!0;return!1}return this._pointerData[e].isOver},pointerOut:function(e){if(!this.enabled)return!1;if(void 0!==e)return this._pointerData[e].isOut;for(var t=0;t<10;t++)if(this._pointerData[t].isOut)return!0},pointerTimeOver:function(e){return e=e||0,this._pointerData[e].timeOver},pointerTimeOut:function(e){return e=e||0,this._pointerData[e].timeOut},pointerDragged:function(e){return e=e||0,this._pointerData[e].isDragged},checkPointerDown:function(e,t){return!!(e.isDown&&this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&0!==this.sprite.worldScale.x&&0!==this.sprite.worldScale.y)&&!!this.game.input.hitTest(this.sprite,e,this._tempPoint)&&(void 0===t&&(t=!1),!(!t&&this.pixelPerfectClick)||this.checkPixel(this._tempPoint.x,this._tempPoint.y))},checkPointerOver:function(e,t){return!!(this.enabled&&this.sprite&&this.sprite.parent&&this.sprite.visible&&this.sprite.parent.visible&&0!==this.sprite.worldScale.x&&0!==this.sprite.worldScale.y)&&!!this.game.input.hitTest(this.sprite,e,this._tempPoint)&&(void 0===t&&(t=!1),!(!t&&this.pixelPerfectOver)||this.checkPixel(this._tempPoint.x,this._tempPoint.y))},checkPixel:function(e,t,i){if(this.sprite.texture.baseTexture.source){if(null===e&&null===t){this.game.input.getLocalPosition(this.sprite,i,this._tempPoint);var e=this._tempPoint.x,t=this._tempPoint.y}if(0!==this.sprite.anchor.x&&(e-=-this.sprite.texture.frame.width*this.sprite.anchor.x),0!==this.sprite.anchor.y&&(t-=-this.sprite.texture.frame.height*this.sprite.anchor.y),e+=this.sprite.texture.frame.x,t+=this.sprite.texture.frame.y,this.sprite.texture.trim&&(e-=this.sprite.texture.trim.x,t-=this.sprite.texture.trim.y,e<this.sprite.texture.crop.x||e>this.sprite.texture.crop.right||t<this.sprite.texture.crop.y||t>this.sprite.texture.crop.bottom))return this._dx=e,this._dy=t,!1;if(this._dx=e,this._dy=t,this.game.input.hitContext.clearRect(0,0,1,1),this.game.input.hitContext.drawImage(this.sprite.texture.baseTexture.source,e,t,1,1,0,0,1,1),this.game.input.hitContext.getImageData(0,0,1,1).data[3]>=this.pixelPerfectAlpha)return!0}return!1},update:function(e){if(null!==this.sprite&&void 0!==this.sprite.parent)return this.enabled&&this.sprite.visible&&this.sprite.parent.visible?this._pendingDrag?(this._dragDistancePass||(this._dragDistancePass=i.Math.distance(e.x,e.y,this.downPoint.x,this.downPoint.y)>=this.dragDistanceThreshold),this._dragDistancePass&&this._dragTimePass&&this.startDrag(e),!0):this.draggable&&this._draggedPointerID===e.id?this.updateDrag(e,!1):this._pointerData[e.id].isOver?this.checkPointerOver(e)?(this._pointerData[e.id].x=e.x-this.sprite.x,this._pointerData[e.id].y=e.y-this.sprite.y,!0):(this._pointerOutHandler(e),!1):void 0:(this._pointerOutHandler(e),!1)},_pointerOverHandler:function(e,t){if(null!==this.sprite){var s=this._pointerData[e.id];if(!1===s.isOver||e.dirty){var a=!1===s.isOver;s.isOver=!0,s.isOut=!1,s.timeOver=this.game.time.time,s.x=e.x-this.sprite.x,s.y=e.y-this.sprite.y,this.useHandCursor&&!1===s.isDragged&&(this.game.canvas.style.cursor="pointer",this._setHandCursor=!0),!t&&a&&this.sprite&&this.sprite.events&&this.sprite.events.onInputOver$dispatch(this.sprite,e),this.sprite.parent&&this.sprite.parent.type===i.GROUP&&this.sprite.parent.onChildInputOver.dispatch(this.sprite,e)}}},_pointerOutHandler:function(e,t){if(null!==this.sprite){var s=this._pointerData[e.id];s.isOver=!1,s.isOut=!0,s.timeOut=this.game.time.time,this.useHandCursor&&!1===s.isDragged&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),!t&&this.sprite&&this.sprite.events&&(this.sprite.events.onInputOut$dispatch(this.sprite,e),this.sprite&&this.sprite.parent&&this.sprite.parent.type===i.GROUP&&this.sprite.parent.onChildInputOut.dispatch(this.sprite,e))}},_touchedHandler:function(e){if(null!==this.sprite){var t=this._pointerData[e.id];if(!t.isDown&&t.isOver){if(this.pixelPerfectClick&&!this.checkPixel(null,null,e))return;if(t.isDown=!0,t.isUp=!1,t.timeDown=this.game.time.time,this.downPoint.set(e.x,e.y),e.dirty=!0,this.sprite&&this.sprite.events&&(this.sprite.events.onInputDown$dispatch(this.sprite,e),this.sprite&&this.sprite.parent&&this.sprite.parent.type===i.GROUP&&this.sprite.parent.onChildInputDown.dispatch(this.sprite,e),null===this.sprite))return;this.draggable&&!1===this.isDragged&&(0===this.dragTimeThreshold&&0===this.dragDistanceThreshold?this.startDrag(e):(this._pendingDrag=!0,this._dragDistancePass=0===this.dragDistanceThreshold,this.dragTimeThreshold>0?(this._dragTimePass=!1,this.game.time.events.add(this.dragTimeThreshold,this.dragTimeElapsed,this,e)):this._dragTimePass=!0)),this.bringToTop&&this.sprite.bringToTop()}}},dragTimeElapsed:function(e){this._dragTimePass=!0,this._pendingDrag&&this.sprite&&this._dragDistancePass&&this.startDrag(e)},_releasedHandler:function(e){if(null!==this.sprite){var t=this._pointerData[e.id];if(t.isDown&&e.isUp){t.isDown=!1,t.isUp=!0,t.timeUp=this.game.time.time,t.downDuration=t.timeUp-t.timeDown;var s=this.checkPointerOver(e);this.sprite&&this.sprite.events&&(this.dragStopBlocksInputUp&&(!this.dragStopBlocksInputUp||this.draggable&&this.isDragged&&this._draggedPointerID===e.id)||this.sprite.events.onInputUp$dispatch(this.sprite,e,s),this.sprite&&this.sprite.parent&&this.sprite.parent.type===i.GROUP&&this.sprite.parent.onChildInputUp.dispatch(this.sprite,e,s),s&&(s=this.checkPointerOver(e))),t.isOver=s,!s&&this.useHandCursor&&(this.game.canvas.style.cursor="default",this._setHandCursor=!1),e.dirty=!0,this._pendingDrag=!1,this.draggable&&this.isDragged&&this._draggedPointerID===e.id&&this.stopDrag(e)}}},updateDrag:function(e,t){if(void 0===t&&(t=!1),e.isUp)return this.stopDrag(e),!1;var i=this.globalToLocalX(e.x)+this._dragPoint.x+this.dragOffset.x,s=this.globalToLocalY(e.y)+this._dragPoint.y+this.dragOffset.y;if(this.sprite.fixedToCamera)this.allowHorizontalDrag&&(this.sprite.cameraOffset.x=i),this.allowVerticalDrag&&(this.sprite.cameraOffset.y=s),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.cameraOffset.x,this.sprite.cameraOffset.y));else{var a=this.game.camera.x-this._pointerData[e.id].camX,n=this.game.camera.y-this._pointerData[e.id].camY;this.allowHorizontalDrag&&(this.sprite.x=i+a),this.allowVerticalDrag&&(this.sprite.y=s+n),this.boundsRect&&this.checkBoundsRect(),this.boundsSprite&&this.checkBoundsSprite(),this.snapOnDrag&&(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY,this.snapPoint.set(this.sprite.x,this.sprite.y))}return this.sprite.events.onDragUpdate.dispatch(this.sprite,e,i,s,this.snapPoint,t),!0},justOver:function(e,t){return e=e||0,t=t||500,this._pointerData[e].isOver&&this.overDuration(e)<t},justOut:function(e,t){return e=e||0,t=t||500,this._pointerData[e].isOut&&this.game.time.time-this._pointerData[e].timeOut<t},justPressed:function(e,t){return e=e||0,t=t||500,this._pointerData[e].isDown&&this.downDuration(e)<t},justReleased:function(e,t){return e=e||0,t=t||500,this._pointerData[e].isUp&&this.game.time.time-this._pointerData[e].timeUp<t},overDuration:function(e){return e=e||0,this._pointerData[e].isOver?this.game.time.time-this._pointerData[e].timeOver:-1},downDuration:function(e){return e=e||0,this._pointerData[e].isDown?this.game.time.time-this._pointerData[e].timeDown:-1},enableDrag:function(e,t,s,a,n,o){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===s&&(s=!1),void 0===a&&(a=255),void 0===n&&(n=null),void 0===o&&(o=null),this._dragPoint=new i.Point,this.draggable=!0,this.bringToTop=t,this.dragOffset=new i.Point,this.dragFromCenter=e,this.pixelPerfectClick=s,this.pixelPerfectAlpha=a,n&&(this.boundsRect=n),o&&(this.boundsSprite=o)},disableDrag:function(){if(this._pointerData)for(var e=0;e<10;e++)this._pointerData[e].isDragged=!1;this.draggable=!1,this.isDragged=!1,this._draggedPointerID=-1,this._pendingDrag=!1},startDrag:function(e){var t=this.sprite.x,i=this.sprite.y;if(this.isDragged=!0,this._draggedPointerID=e.id,this._pointerData[e.id].camX=this.game.camera.x,this._pointerData[e.id].camY=this.game.camera.y,this._pointerData[e.id].isDragged=!0,this.sprite.fixedToCamera){if(this.dragFromCenter){s=this.sprite.getBounds();this.sprite.cameraOffset.x=this.globalToLocalX(e.x)+(this.sprite.cameraOffset.x-s.centerX),this.sprite.cameraOffset.y=this.globalToLocalY(e.y)+(this.sprite.cameraOffset.y-s.centerY)}this._dragPoint.setTo(this.sprite.cameraOffset.x-e.x,this.sprite.cameraOffset.y-e.y)}else{if(this.dragFromCenter){var s=this.sprite.getBounds();this.sprite.x=this.globalToLocalX(e.x)+(this.sprite.x-s.centerX),this.sprite.y=this.globalToLocalY(e.y)+(this.sprite.y-s.centerY)}this._dragPoint.setTo(this.sprite.x-this.globalToLocalX(e.x),this.sprite.y-this.globalToLocalY(e.y))}this.updateDrag(e,!0),this.bringToTop&&(this._dragPhase=!0,this.sprite.bringToTop()),this.dragStartPoint.set(t,i),this.sprite.events.onDragStart$dispatch(this.sprite,e,t,i),this._pendingDrag=!1},globalToLocalX:function(e){return this.scaleLayer&&(e-=this.game.scale.grid.boundsFluid.x,e*=this.game.scale.grid.scaleFluidInversed.x),e},globalToLocalY:function(e){return this.scaleLayer&&(e-=this.game.scale.grid.boundsFluid.y,e*=this.game.scale.grid.scaleFluidInversed.y),e},stopDrag:function(e){this.isDragged=!1,this._draggedPointerID=-1,this._pointerData[e.id].isDragged=!1,this._dragPhase=!1,this._pendingDrag=!1,this.snapOnRelease&&(this.sprite.fixedToCamera?(this.sprite.cameraOffset.x=Math.round((this.sprite.cameraOffset.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.cameraOffset.y=Math.round((this.sprite.cameraOffset.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY):(this.sprite.x=Math.round((this.sprite.x-this.snapOffsetX%this.snapX)/this.snapX)*this.snapX+this.snapOffsetX%this.snapX,this.sprite.y=Math.round((this.sprite.y-this.snapOffsetY%this.snapY)/this.snapY)*this.snapY+this.snapOffsetY%this.snapY)),this.sprite.events.onDragStop$dispatch(this.sprite,e),!1===this.checkPointerOver(e)&&this._pointerOutHandler(e)},setDragLock:function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this.allowHorizontalDrag=e,this.allowVerticalDrag=t},enableSnap:function(e,t,i,s,a,n){void 0===i&&(i=!0),void 0===s&&(s=!1),void 0===a&&(a=0),void 0===n&&(n=0),this.snapX=e,this.snapY=t,this.snapOffsetX=a,this.snapOffsetY=n,this.snapOnDrag=i,this.snapOnRelease=s},disableSnap:function(){this.snapOnDrag=!1,this.snapOnRelease=!1},checkBoundsRect:function(){this.sprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsRect.left?this.sprite.cameraOffset.x=this.boundsRect.left:this.sprite.cameraOffset.x+this.sprite.width>this.boundsRect.right&&(this.sprite.cameraOffset.x=this.boundsRect.right-this.sprite.width),this.sprite.cameraOffset.y<this.boundsRect.top?this.sprite.cameraOffset.y=this.boundsRect.top:this.sprite.cameraOffset.y+this.sprite.height>this.boundsRect.bottom&&(this.sprite.cameraOffset.y=this.boundsRect.bottom-this.sprite.height)):(this.sprite.left<this.boundsRect.left?this.sprite.x=this.boundsRect.x+this.sprite.offsetX:this.sprite.right>this.boundsRect.right&&(this.sprite.x=this.boundsRect.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsRect.top?this.sprite.y=this.boundsRect.top+this.sprite.offsetY:this.sprite.bottom>this.boundsRect.bottom&&(this.sprite.y=this.boundsRect.bottom-(this.sprite.height-this.sprite.offsetY)))},checkBoundsSprite:function(){this.sprite.fixedToCamera&&this.boundsSprite.fixedToCamera?(this.sprite.cameraOffset.x<this.boundsSprite.cameraOffset.x?this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x:this.sprite.cameraOffset.x+this.sprite.width>this.boundsSprite.cameraOffset.x+this.boundsSprite.width&&(this.sprite.cameraOffset.x=this.boundsSprite.cameraOffset.x+this.boundsSprite.width-this.sprite.width),this.sprite.cameraOffset.y<this.boundsSprite.cameraOffset.y?this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y:this.sprite.cameraOffset.y+this.sprite.height>this.boundsSprite.cameraOffset.y+this.boundsSprite.height&&(this.sprite.cameraOffset.y=this.boundsSprite.cameraOffset.y+this.boundsSprite.height-this.sprite.height)):(this.sprite.left<this.boundsSprite.left?this.sprite.x=this.boundsSprite.left+this.sprite.offsetX:this.sprite.right>this.boundsSprite.right&&(this.sprite.x=this.boundsSprite.right-(this.sprite.width-this.sprite.offsetX)),this.sprite.top<this.boundsSprite.top?this.sprite.y=this.boundsSprite.top+this.sprite.offsetY:this.sprite.bottom>this.boundsSprite.bottom&&(this.sprite.y=this.boundsSprite.bottom-(this.sprite.height-this.sprite.offsetY)))}},i.InputHandler.prototype.constructor=i.InputHandler,i.Gamepad=function(e){this.game=e,this._gamepadIndexMap={},this._rawPads=[],this._active=!1,this.enabled=!0,this._gamepadSupportAvailable=!!navigator.webkitGetGamepads||!!navigator.webkitGamepads||-1!==navigator.userAgent.indexOf("Firefox/")||!!navigator.getGamepads,this._prevRawGamepadTypes=[],this._prevTimestamps=[],this.callbackContext=this,this.onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null,this._ongamepadconnected=null,this._gamepaddisconnected=null,this._gamepads=[new i.SinglePad(e,this),new i.SinglePad(e,this),new i.SinglePad(e,this),new i.SinglePad(e,this)]},i.Gamepad.prototype={addCallbacks:function(e,t){void 0!==t&&(this.onConnectCallback="function"==typeof t.onConnect?t.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof t.onDisconnect?t.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof t.onDown?t.onDown:this.onDownCallback,this.onUpCallback="function"==typeof t.onUp?t.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof t.onAxis?t.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof t.onFloat?t.onFloat:this.onFloatCallback,this.callbackContext=e)},start:function(){if(!this._active){this._active=!0;var e=this;this._onGamepadConnected=function(t){return e.onGamepadConnected(t)},this._onGamepadDisconnected=function(t){return e.onGamepadDisconnected(t)},window.addEventListener("gamepadconnected",this._onGamepadConnected,!1),window.addEventListener("gamepaddisconnected",this._onGamepadDisconnected,!1)}},onGamepadConnected:function(e){var t=e.gamepad;this._rawPads.push(t),this._gamepads[t.index].connect(t)},onGamepadDisconnected:function(e){var t=e.gamepad;for(var i in this._rawPads)this._rawPads[i].index===t.index&&this._rawPads.splice(i,1);this._gamepads[t.index].disconnect()},update:function(){this._pollGamepads(),this.pad1.pollStatus(),this.pad2.pollStatus(),this.pad3.pollStatus(),this.pad4.pollStatus()},_pollGamepads:function(){if(this._active){if(navigator.getGamepads)e=navigator.getGamepads();else if(navigator.webkitGetGamepads)e=navigator.webkitGetGamepads();else if(navigator.webkitGamepads)var e=navigator.webkitGamepads();if(e){this._rawPads=[];for(var t=!1,i=0;i<e.length&&(typeof e[i]!==this._prevRawGamepadTypes[i]&&(t=!0,this._prevRawGamepadTypes[i]=typeof e[i]),e[i]&&this._rawPads.push(e[i]),3!==i);i++);for(var s=0;s<this._gamepads.length;s++)this._gamepads[s]._rawPad=this._rawPads[s];if(t){for(var a,n={rawIndices:{},padIndices:{}},o=0;o<this._gamepads.length;o++)if((a=this._gamepads[o]).connected)for(var r=0;r<this._rawPads.length;r++)this._rawPads[r].index===a.index&&(n.rawIndices[a.index]=!0,n.padIndices[o]=!0);for(var l=0;l<this._gamepads.length;l++)if(a=this._gamepads[l],!n.padIndices[l]){this._rawPads.length<1&&a.disconnect();for(var h=0;h<this._rawPads.length&&!n.padIndices[l];h++){var c=this._rawPads[h];if(c){if(n.rawIndices[c.index]){a.disconnect();continue}a.connect(c),n.rawIndices[c.index]=!0,n.padIndices[l]=!0}else a.disconnect()}}}}}},setDeadZones:function(e){for(var t=0;t<this._gamepads.length;t++)this._gamepads[t].deadZone=e},stop:function(){this._active=!1,window.removeEventListener("gamepadconnected",this._onGamepadConnected),window.removeEventListener("gamepaddisconnected",this._onGamepadDisconnected)},reset:function(){this.update();for(var e=0;e<this._gamepads.length;e++)this._gamepads[e].reset()},justPressed:function(e,t){for(var i=0;i<this._gamepads.length;i++)if(!0===this._gamepads[i].justPressed(e,t))return!0;return!1},justReleased:function(e,t){for(var i=0;i<this._gamepads.length;i++)if(!0===this._gamepads[i].justReleased(e,t))return!0;return!1},isDown:function(e){for(var t=0;t<this._gamepads.length;t++)if(!0===this._gamepads[t].isDown(e))return!0;return!1},destroy:function(){this.stop();for(var e=0;e<this._gamepads.length;e++)this._gamepads[e].destroy()}},i.Gamepad.prototype.constructor=i.Gamepad,Object.defineProperty(i.Gamepad.prototype,"active",{get:function(){return this._active}}),Object.defineProperty(i.Gamepad.prototype,"supported",{get:function(){return this._gamepadSupportAvailable}}),Object.defineProperty(i.Gamepad.prototype,"padsConnected",{get:function(){return this._rawPads.length}}),Object.defineProperty(i.Gamepad.prototype,"pad1",{get:function(){return this._gamepads[0]}}),Object.defineProperty(i.Gamepad.prototype,"pad2",{get:function(){return this._gamepads[1]}}),Object.defineProperty(i.Gamepad.prototype,"pad3",{get:function(){return this._gamepads[2]}}),Object.defineProperty(i.Gamepad.prototype,"pad4",{get:function(){return this._gamepads[3]}}),i.Gamepad.BUTTON_0=0,i.Gamepad.BUTTON_1=1,i.Gamepad.BUTTON_2=2,i.Gamepad.BUTTON_3=3,i.Gamepad.BUTTON_4=4,i.Gamepad.BUTTON_5=5,i.Gamepad.BUTTON_6=6,i.Gamepad.BUTTON_7=7,i.Gamepad.BUTTON_8=8,i.Gamepad.BUTTON_9=9,i.Gamepad.BUTTON_10=10,i.Gamepad.BUTTON_11=11,i.Gamepad.BUTTON_12=12,i.Gamepad.BUTTON_13=13,i.Gamepad.BUTTON_14=14,i.Gamepad.BUTTON_15=15,i.Gamepad.AXIS_0=0,i.Gamepad.AXIS_1=1,i.Gamepad.AXIS_2=2,i.Gamepad.AXIS_3=3,i.Gamepad.AXIS_4=4,i.Gamepad.AXIS_5=5,i.Gamepad.AXIS_6=6,i.Gamepad.AXIS_7=7,i.Gamepad.AXIS_8=8,i.Gamepad.AXIS_9=9,i.Gamepad.XBOX360_A=0,i.Gamepad.XBOX360_B=1,i.Gamepad.XBOX360_X=2,i.Gamepad.XBOX360_Y=3,i.Gamepad.XBOX360_LEFT_BUMPER=4,i.Gamepad.XBOX360_RIGHT_BUMPER=5,i.Gamepad.XBOX360_LEFT_TRIGGER=6,i.Gamepad.XBOX360_RIGHT_TRIGGER=7,i.Gamepad.XBOX360_BACK=8,i.Gamepad.XBOX360_START=9,i.Gamepad.XBOX360_STICK_LEFT_BUTTON=10,i.Gamepad.XBOX360_STICK_RIGHT_BUTTON=11,i.Gamepad.XBOX360_DPAD_LEFT=14,i.Gamepad.XBOX360_DPAD_RIGHT=15,i.Gamepad.XBOX360_DPAD_UP=12,i.Gamepad.XBOX360_DPAD_DOWN=13,i.Gamepad.XBOX360_STICK_LEFT_X=0,i.Gamepad.XBOX360_STICK_LEFT_Y=1,i.Gamepad.XBOX360_STICK_RIGHT_X=2,i.Gamepad.XBOX360_STICK_RIGHT_Y=3,i.Gamepad.PS3XC_X=0,i.Gamepad.PS3XC_CIRCLE=1,i.Gamepad.PS3XC_SQUARE=2,i.Gamepad.PS3XC_TRIANGLE=3,i.Gamepad.PS3XC_L1=4,i.Gamepad.PS3XC_R1=5,i.Gamepad.PS3XC_L2=6,i.Gamepad.PS3XC_R2=7,i.Gamepad.PS3XC_SELECT=8,i.Gamepad.PS3XC_START=9,i.Gamepad.PS3XC_STICK_LEFT_BUTTON=10,i.Gamepad.PS3XC_STICK_RIGHT_BUTTON=11,i.Gamepad.PS3XC_DPAD_UP=12,i.Gamepad.PS3XC_DPAD_DOWN=13,i.Gamepad.PS3XC_DPAD_LEFT=14,i.Gamepad.PS3XC_DPAD_RIGHT=15,i.Gamepad.PS3XC_STICK_LEFT_X=0,i.Gamepad.PS3XC_STICK_LEFT_Y=1,i.Gamepad.PS3XC_STICK_RIGHT_X=2,i.Gamepad.PS3XC_STICK_RIGHT_Y=3,i.SinglePad=function(e,t){this.game=e,this.index=null,this.connected=!1,this.callbackContext=this,this.onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null,this.deadZone=.26,this._padParent=t,this._rawPad=null,this._prevTimestamp=null,this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0},i.SinglePad.prototype={addCallbacks:function(e,t){void 0!==t&&(this.onConnectCallback="function"==typeof t.onConnect?t.onConnect:this.onConnectCallback,this.onDisconnectCallback="function"==typeof t.onDisconnect?t.onDisconnect:this.onDisconnectCallback,this.onDownCallback="function"==typeof t.onDown?t.onDown:this.onDownCallback,this.onUpCallback="function"==typeof t.onUp?t.onUp:this.onUpCallback,this.onAxisCallback="function"==typeof t.onAxis?t.onAxis:this.onAxisCallback,this.onFloatCallback="function"==typeof t.onFloat?t.onFloat:this.onFloatCallback,this.callbackContext=e)},getButton:function(e){return this._buttons[e]?this._buttons[e]:null},pollStatus:function(){if(this.connected&&this.game.input.enabled&&this.game.input.gamepad.enabled&&(!this._rawPad.timestamp||this._rawPad.timestamp!==this._prevTimestamp)){for(var e=0;e<this._buttonsLen;e++){var t=isNaN(this._rawPad.buttons[e])?this._rawPad.buttons[e].value:this._rawPad.buttons[e];t!==this._buttons[e].value&&(1===t?this.processButtonDown(e,t):0===t?this.processButtonUp(e,t):this.processButtonFloat(e,t))}for(var i=0;i<this._axesLen;i++){var s=this._rawPad.axes[i];s>0&&s>this.deadZone||s<0&&s<-this.deadZone?this.processAxisChange(i,s):this.processAxisChange(i,0)}this._prevTimestamp=this._rawPad.timestamp}},connect:function(e){var t=!this.connected;this.connected=!0,this.index=e.index,this._rawPad=e,this._buttons=[],this._buttonsLen=e.buttons.length,this._axes=[],this._axesLen=e.axes.length;for(var s=0;s<this._axesLen;s++)this._axes[s]=e.axes[s];for(var a in e.buttons)a=parseInt(a,10),this._buttons[a]=new i.DeviceButton(this,a);t&&this._padParent.onConnectCallback&&this._padParent.onConnectCallback.call(this._padParent.callbackContext,this.index),t&&this.onConnectCallback&&this.onConnectCallback.call(this.callbackContext)},disconnect:function(){var e=this.connected,t=this.index;this.connected=!1,this.index=null,this._rawPad=void 0;for(var i=0;i<this._buttonsLen;i++)this._buttons[i].destroy();this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0,e&&this._padParent.onDisconnectCallback&&this._padParent.onDisconnectCallback.call(this._padParent.callbackContext,t),e&&this.onDisconnectCallback&&this.onDisconnectCallback.call(this.callbackContext)},destroy:function(){this._rawPad=void 0;for(var e=0;e<this._buttonsLen;e++)this._buttons[e].destroy();this._buttons=[],this._buttonsLen=0,this._axes=[],this._axesLen=0,this.onConnectCallback=null,this.onDisconnectCallback=null,this.onDownCallback=null,this.onUpCallback=null,this.onAxisCallback=null,this.onFloatCallback=null},processAxisChange:function(e,t){this._axes[e]!==t&&(this._axes[e]=t,this._padParent.onAxisCallback&&this._padParent.onAxisCallback.call(this._padParent.callbackContext,this,e,t),this.onAxisCallback&&this.onAxisCallback.call(this.callbackContext,this,e,t))},processButtonDown:function(e,t){this._buttons[e]&&this._buttons[e].start(null,t),this._padParent.onDownCallback&&this._padParent.onDownCallback.call(this._padParent.callbackContext,e,t,this.index),this.onDownCallback&&this.onDownCallback.call(this.callbackContext,e,t)},processButtonUp:function(e,t){this._padParent.onUpCallback&&this._padParent.onUpCallback.call(this._padParent.callbackContext,e,t,this.index),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,e,t),this._buttons[e]&&this._buttons[e].stop(null,t)},processButtonFloat:function(e,t){this._padParent.onFloatCallback&&this._padParent.onFloatCallback.call(this._padParent.callbackContext,e,t,this.index),this.onFloatCallback&&this.onFloatCallback.call(this.callbackContext,e,t),this._buttons[e]&&this._buttons[e].padFloat(t)},axis:function(e){return!!this._axes[e]&&this._axes[e]},isDown:function(e){return!!this._buttons[e]&&this._buttons[e].isDown},isUp:function(e){return!!this._buttons[e]&&this._buttons[e].isUp},justReleased:function(e,t){if(this._buttons[e])return this._buttons[e].justReleased(t)},justPressed:function(e,t){if(this._buttons[e])return this._buttons[e].justPressed(t)},buttonValue:function(e){return this._buttons[e]?this._buttons[e].value:null},reset:function(){for(var e=0;e<this._axes.length;e++)this._axes[e]=0}},i.SinglePad.prototype.constructor=i.SinglePad,i.Key=function(e,t){this.game=e,this._enabled=!0,this.event=null,this.isDown=!1,this.isUp=!0,this.altKey=!1,this.ctrlKey=!1,this.shiftKey=!1,this.timeDown=0,this.duration=0,this.timeUp=-2500,this.repeats=0,this.keyCode=t,this.onDown=new i.Signal,this.onHoldCallback=null,this.onHoldContext=null,this.onUp=new i.Signal,this._justDown=!1,this._justUp=!1},i.Key.prototype={update:function(){this._enabled&&this.isDown&&(this.duration=this.game.time.time-this.timeDown,this.repeats++,this.onHoldCallback&&this.onHoldCallback.call(this.onHoldContext,this))},processKeyDown:function(e){this._enabled&&(this.event=e,this.isDown||(this.altKey=e.altKey,this.ctrlKey=e.ctrlKey,this.shiftKey=e.shiftKey,this.isDown=!0,this.isUp=!1,this.timeDown=this.game.time.time,this.duration=0,this.repeats=0,this._justDown=!0,this.onDown.dispatch(this)))},processKeyUp:function(e){this._enabled&&(this.event=e,this.isUp||(this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=this.game.time.time-this.timeDown,this._justUp=!0,this.onUp.dispatch(this)))},reset:function(e){void 0===e&&(e=!0),this.isDown=!1,this.isUp=!0,this.timeUp=this.game.time.time,this.duration=0,this._enabled=!0,this._justDown=!1,this._justUp=!1,e&&(this.onDown.removeAll(),this.onUp.removeAll(),this.onHoldCallback=null,this.onHoldContext=null)},downDuration:function(e){return void 0===e&&(e=50),this.isDown&&this.duration<e},upDuration:function(e){return void 0===e&&(e=50),!this.isDown&&this.game.time.time-this.timeUp<e}},Object.defineProperty(i.Key.prototype,"justDown",{get:function(){var e=this._justDown;return this._justDown=!1,e}}),Object.defineProperty(i.Key.prototype,"justUp",{get:function(){var e=this._justUp;return this._justUp=!1,e}}),Object.defineProperty(i.Key.prototype,"enabled",{get:function(){return this._enabled},set:function(e){(e=!!e)!==this._enabled&&(e||this.reset(!1),this._enabled=e)}}),i.Key.prototype.constructor=i.Key,i.Keyboard=function(e){this.game=e,this.enabled=!0,this.event=null,this.pressEvent=null,this.callbackContext=this,this.onDownCallback=null,this.onPressCallback=null,this.onUpCallback=null,this._keys=[],this._capture=[],this._onKeyDown=null,this._onKeyPress=null,this._onKeyUp=null,this._i=0,this._k=0},i.Keyboard.prototype={addCallbacks:function(e,t,i,s){this.callbackContext=e,void 0!==t&&null!==t&&(this.onDownCallback=t),void 0!==i&&null!==i&&(this.onUpCallback=i),void 0!==s&&null!==s&&(this.onPressCallback=s)},addKey:function(e){return this._keys[e]||(this._keys[e]=new i.Key(this.game,e),this.addKeyCapture(e)),this._keys[e]},addKeys:function(e){var t={};for(var i in e)t[i]=this.addKey(e[i]);return t},removeKey:function(e){this._keys[e]&&(this._keys[e]=null,this.removeKeyCapture(e))},createCursorKeys:function(){return this.addKeys({up:i.KeyCode.UP,down:i.KeyCode.DOWN,left:i.KeyCode.LEFT,right:i.KeyCode.RIGHT})},start:function(){if(!this.game.device.cocoonJS&&null===this._onKeyDown){var e=this;this._onKeyDown=function(t){return e.processKeyDown(t)},this._onKeyUp=function(t){return e.processKeyUp(t)},this._onKeyPress=function(t){return e.processKeyPress(t)},window.addEventListener("keydown",this._onKeyDown,!1),window.addEventListener("keyup",this._onKeyUp,!1),window.addEventListener("keypress",this._onKeyPress,!1)}},stop:function(){window.removeEventListener("keydown",this._onKeyDown),window.removeEventListener("keyup",this._onKeyUp),window.removeEventListener("keypress",this._onKeyPress),this._onKeyDown=null,this._onKeyUp=null,this._onKeyPress=null},destroy:function(){this.stop(),this.clearCaptures(),this._keys.length=0,this._i=0},addKeyCapture:function(e){if("object"==typeof e)for(var t in e)this._capture[e[t]]=!0;else this._capture[e]=!0},removeKeyCapture:function(e){delete this._capture[e]},clearCaptures:function(){this._capture={}},update:function(){for(this._i=this._keys.length;this._i--;)this._keys[this._i]&&this._keys[this._i].update()},processKeyDown:function(e){if(this.event=e,this.game.input.enabled&&this.enabled){var t=e.keyCode;this._capture[t]&&e.preventDefault(),this._keys[t]||(this._keys[t]=new i.Key(this.game,t)),this._keys[t].processKeyDown(e),this._k=t,this.onDownCallback&&this.onDownCallback.call(this.callbackContext,e)}},processKeyPress:function(e){this.pressEvent=e,this.game.input.enabled&&this.enabled&&this.onPressCallback&&this.onPressCallback.call(this.callbackContext,String.fromCharCode(e.charCode),e)},processKeyUp:function(e){if(this.event=e,this.game.input.enabled&&this.enabled){var t=e.keyCode;this._capture[t]&&e.preventDefault(),this._keys[t]||(this._keys[t]=new i.Key(this.game,t)),this._keys[t].processKeyUp(e),this.onUpCallback&&this.onUpCallback.call(this.callbackContext,e)}},reset:function(e){void 0===e&&(e=!0),this.event=null;for(var t=this._keys.length;t--;)this._keys[t]&&this._keys[t].reset(e)},downDuration:function(e,t){return this._keys[e]?this._keys[e].downDuration(t):null},upDuration:function(e,t){return this._keys[e]?this._keys[e].upDuration(t):null},isDown:function(e){return this._keys[e]?this._keys[e].isDown:null}},Object.defineProperty(i.Keyboard.prototype,"lastChar",{get:function(){return 32===this.event.charCode?"":String.fromCharCode(this.pressEvent.charCode)}}),Object.defineProperty(i.Keyboard.prototype,"lastKey",{get:function(){return this._keys[this._k]}}),i.Keyboard.prototype.constructor=i.Keyboard,i.KeyCode={A:"A".charCodeAt(0),B:"B".charCodeAt(0),C:"C".charCodeAt(0),D:"D".charCodeAt(0),E:"E".charCodeAt(0),F:"F".charCodeAt(0),G:"G".charCodeAt(0),H:"H".charCodeAt(0),I:"I".charCodeAt(0),J:"J".charCodeAt(0),K:"K".charCodeAt(0),L:"L".charCodeAt(0),M:"M".charCodeAt(0),N:"N".charCodeAt(0),O:"O".charCodeAt(0),P:"P".charCodeAt(0),Q:"Q".charCodeAt(0),R:"R".charCodeAt(0),S:"S".charCodeAt(0),T:"T".charCodeAt(0),U:"U".charCodeAt(0),V:"V".charCodeAt(0),W:"W".charCodeAt(0),X:"X".charCodeAt(0),Y:"Y".charCodeAt(0),Z:"Z".charCodeAt(0),ZERO:"0".charCodeAt(0),ONE:"1".charCodeAt(0),TWO:"2".charCodeAt(0),THREE:"3".charCodeAt(0),FOUR:"4".charCodeAt(0),FIVE:"5".charCodeAt(0),SIX:"6".charCodeAt(0),SEVEN:"7".charCodeAt(0),EIGHT:"8".charCodeAt(0),NINE:"9".charCodeAt(0),NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,NUMPAD_MULTIPLY:106,NUMPAD_ADD:107,NUMPAD_ENTER:108,NUMPAD_SUBTRACT:109,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,COLON:186,EQUALS:187,COMMA:188,UNDERSCORE:189,PERIOD:190,QUESTION_MARK:191,TILDE:192,OPEN_BRACKET:219,BACKWARD_SLASH:220,CLOSED_BRACKET:221,QUOTES:222,BACKSPACE:8,TAB:9,CLEAR:12,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,CAPS_LOCK:20,ESC:27,SPACEBAR:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,PLUS:43,MINUS:44,INSERT:45,DELETE:46,HELP:47,NUM_LOCK:144};for(var a in i.KeyCode)i.KeyCode.hasOwnProperty(a)&&!a.match(/[a-z]/)&&(i.Keyboard[a]=i.KeyCode[a]);i.Component=function(){},i.Component.Angle=function(){},i.Component.Angle.prototype={angle:{get:function(){return i.Math.wrapAngle(i.Math.radToDeg(this.rotation))},set:function(e){this.rotation=i.Math.degToRad(i.Math.wrapAngle(e))}}},i.Component.Animation=function(){},i.Component.Animation.prototype={play:function(e,t,i,s){if(this.animations)return this.animations.play(e,t,i,s)}},i.Component.AutoCull=function(){},i.Component.AutoCull.prototype={autoCull:!1,inCamera:{get:function(){return this.autoCull||this.checkWorldBounds||(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y),this.game.world.camera.view.intersects(this._bounds)}}},i.Component.Bounds=function(){},i.Component.Bounds.prototype={offsetX:{get:function(){return this.anchor.x*this.width}},offsetY:{get:function(){return this.anchor.y*this.height}},centerX:{get:function(){return this.x-this.offsetX+.5*this.width},set:function(e){this.x=e+this.offsetX-.5*this.width}},centerY:{get:function(){return this.y-this.offsetY+.5*this.height},set:function(e){this.y=e+this.offsetY-.5*this.height}},left:{get:function(){return this.x-this.offsetX},set:function(e){this.x=e+this.offsetX}},right:{get:function(){return this.x+this.width-this.offsetX},set:function(e){this.x=e-this.width+this.offsetX}},top:{get:function(){return this.y-this.offsetY},set:function(e){this.y=e+this.offsetY}},bottom:{get:function(){return this.y+this.height-this.offsetY},set:function(e){this.y=e-this.height+this.offsetY}},alignIn:function(e,t,s,a){switch(void 0===s&&(s=0),void 0===a&&(a=0),t){default:case i.TOP_LEFT:this.left=e.left-s,this.top=e.top-a;break;case i.TOP_CENTER:this.centerX=e.centerX+s,this.top=e.top-a;break;case i.TOP_RIGHT:this.right=e.right+s,this.top=e.top-a;break;case i.LEFT_CENTER:this.left=e.left-s,this.centerY=e.centerY+a;break;case i.CENTER:this.centerX=e.centerX+s,this.centerY=e.centerY+a;break;case i.RIGHT_CENTER:this.right=e.right+s,this.centerY=e.centerY+a;break;case i.BOTTOM_LEFT:this.left=e.left-s,this.bottom=e.bottom+a;break;case i.BOTTOM_CENTER:this.centerX=e.centerX+s,this.bottom=e.bottom+a;break;case i.BOTTOM_RIGHT:this.right=e.right+s,this.bottom=e.bottom+a}return this},alignTo:function(e,t,s,a){switch(void 0===s&&(s=0),void 0===a&&(a=0),t){default:case i.TOP_LEFT:this.left=e.left-s,this.bottom=e.top-a;break;case i.TOP_CENTER:this.centerX=e.centerX+s,this.bottom=e.top-a;break;case i.TOP_RIGHT:this.right=e.right+s,this.bottom=e.top-a;break;case i.LEFT_TOP:this.right=e.left-s,this.top=e.top-a;break;case i.LEFT_CENTER:this.right=e.left-s,this.centerY=e.centerY+a;break;case i.LEFT_BOTTOM:this.right=e.left-s,this.bottom=e.bottom+a;break;case i.RIGHT_TOP:this.left=e.right+s,this.top=e.top-a;break;case i.RIGHT_CENTER:this.left=e.right+s,this.centerY=e.centerY+a;break;case i.RIGHT_BOTTOM:this.left=e.right+s,this.bottom=e.bottom+a;break;case i.BOTTOM_LEFT:this.left=e.left-s,this.top=e.bottom+a;break;case i.BOTTOM_CENTER:this.centerX=e.centerX+s,this.top=e.bottom+a;break;case i.BOTTOM_RIGHT:this.right=e.right+s,this.top=e.bottom+a}return this}},i.Group.prototype.alignIn=i.Component.Bounds.prototype.alignIn,i.Group.prototype.alignTo=i.Component.Bounds.prototype.alignTo,i.Component.BringToTop=function(){},i.Component.BringToTop.prototype.bringToTop=function(){return this.parent&&this.parent.bringToTop(this),this},i.Component.BringToTop.prototype.sendToBack=function(){return this.parent&&this.parent.sendToBack(this),this},i.Component.BringToTop.prototype.moveUp=function(){return this.parent&&this.parent.moveUp(this),this},i.Component.BringToTop.prototype.moveDown=function(){return this.parent&&this.parent.moveDown(this),this},i.Component.Core=function(){},i.Component.Core.install=function(e){i.Utils.mixinPrototype(this,i.Component.Core.prototype),this.components={};for(var t=0;t<e.length;t++){var s=e[t],a=!1;"Destroy"===s&&(a=!0),i.Utils.mixinPrototype(this,i.Component[s].prototype,a),this.components[s]=!0}},i.Component.Core.init=function(e,t,s,a,n){this.game=e,this.key=a,this.data={},this.position.set(t,s),this.world=new i.Point(t,s),this.previousPosition=new i.Point(t,s),this.events=new i.Events(this),this._bounds=new i.Rectangle,this.components.PhysicsBody&&(this.body=this.body),this.components.Animation&&(this.animations=new i.AnimationManager(this)),this.components.LoadTexture&&null!==a&&this.loadTexture(a,n),this.components.FixedToCamera&&(this.cameraOffset=new i.Point(t,s))},i.Component.Core.preUpdate=function(){if(!this.pendingDestroy){if(this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,!this.exists||!this.parent.exists)return this.renderOrderID=-1,!1;this.world.setTo(this.game.camera.x+this.worldTransform.tx,this.game.camera.y+this.worldTransform.ty),this.visible&&(this.renderOrderID=this.game.stage.currentRenderOrderID++),this.animations&&this.animations.update(),this.body&&this.body.preUpdate();for(var e=0;e<this.children.length;e++)this.children[e].preUpdate();return!0}this.destroy()},i.Component.Core.prototype={game:null,name:"",data:{},components:{},z:0,events:void 0,animations:void 0,key:"",world:null,debug:!1,previousPosition:null,previousRotation:0,renderOrderID:0,fresh:!0,pendingDestroy:!1,_bounds:null,_exists:!0,exists:{get:function(){return this._exists},set:function(e){e?(this._exists=!0,this.body&&this.body.type===i.Physics.P2JS&&this.body.addToWorld(),this.visible=!0):(this._exists=!1,this.body&&this.body.type===i.Physics.P2JS&&this.body.removeFromWorld(),this.visible=!1)}},update:function(){},postUpdate:function(){this.customRender&&this.key.render(),this.components.PhysicsBody&&i.Component.PhysicsBody.postUpdate.call(this),this.components.FixedToCamera&&i.Component.FixedToCamera.postUpdate.call(this);for(var e=0;e<this.children.length;e++)this.children[e].postUpdate()}},i.Component.Crop=function(){},i.Component.Crop.prototype={cropRect:null,_crop:null,crop:function(e,t){void 0===t&&(t=!1),e?(t&&null!==this.cropRect?this.cropRect.setTo(e.x,e.y,e.width,e.height):t&&null===this.cropRect?this.cropRect=new i.Rectangle(e.x,e.y,e.width,e.height):this.cropRect=e,this.updateCrop()):(this._crop=null,this.cropRect=null,this.resetFrame())},updateCrop:function(){if(this.cropRect){var e=this.texture.crop.x,t=this.texture.crop.y,s=this.texture.crop.width,a=this.texture.crop.height;this._crop=i.Rectangle.clone(this.cropRect,this._crop),this._crop.x+=this._frame.x,this._crop.y+=this._frame.y;var n=Math.max(this._frame.x,this._crop.x),o=Math.max(this._frame.y,this._crop.y),r=Math.min(this._frame.right,this._crop.right)-n,l=Math.min(this._frame.bottom,this._crop.bottom)-o;this.texture.crop.x=n,this.texture.crop.y=o,this.texture.crop.width=r,this.texture.crop.height=l,this.texture.frame.width=Math.min(r,this.cropRect.width),this.texture.frame.height=Math.min(l,this.cropRect.height),this.texture.width=this.texture.frame.width,this.texture.height=this.texture.frame.height,this.texture._updateUvs(),16777215===this.tint||e===n&&t===o&&s===r&&a===l||(this.texture.requiresReTint=!0)}}},i.Component.Delta=function(){},i.Component.Delta.prototype={deltaX:{get:function(){return this.world.x-this.previousPosition.x}},deltaY:{get:function(){return this.world.y-this.previousPosition.y}},deltaZ:{get:function(){return this.rotation-this.previousRotation}}},i.Component.Destroy=function(){},i.Component.Destroy.prototype={destroyPhase:!1,destroy:function(e,t){if(null!==this.game&&!this.destroyPhase){void 0===e&&(e=!0),void 0===t&&(t=!1),this.destroyPhase=!0,this.events&&this.events.onDestroy$dispatch(this),this.parent&&(this.parent instanceof i.Group?this.parent.remove(this):this.parent.removeChild(this)),this.input&&this.input.destroy(),this.animations&&this.animations.destroy(),this.body&&this.body.destroy(),this.events&&this.events.destroy(),this.game.tweens.removeFrom(this);var s=this.children.length;if(e)for(;s--;)this.children[s].destroy(e);else for(;s--;)this.removeChild(this.children[s]);this._crop&&(this._crop=null,this.cropRect=null),this._frame&&(this._frame=null),i.Video&&this.key instanceof i.Video&&this.key.onChangeSource.remove(this.resizeFrame,this),i.BitmapText&&this._glyphs&&(this._glyphs=[]),this.alive=!1,this.exists=!1,this.visible=!1,this.filters=null,this.mask=null,this.game=null,this.data={},this.renderable=!1,this.transformCallback&&(this.transformCallback=null,this.transformCallbackContext=null),this.hitArea=null,this.parent=null,this.stage=null,this.worldTransform=null,this.filterArea=null,this._bounds=null,this._currentBounds=null,this._mask=null,this._destroyCachedSprite(),t&&this.texture.destroy(!0),this.destroyPhase=!1,this.pendingDestroy=!1}}},i.Events=function(e){this.parent=e},i.Events.prototype={destroy:function(){this._parent=null,this._onDestroy&&this._onDestroy.dispose(),this._onAddedToGroup&&this._onAddedToGroup.dispose(),this._onRemovedFromGroup&&this._onRemovedFromGroup.dispose(),this._onRemovedFromWorld&&this._onRemovedFromWorld.dispose(),this._onKilled&&this._onKilled.dispose(),this._onRevived&&this._onRevived.dispose(),this._onEnterBounds&&this._onEnterBounds.dispose(),this._onOutOfBounds&&this._onOutOfBounds.dispose(),this._onInputOver&&this._onInputOver.dispose(),this._onInputOut&&this._onInputOut.dispose(),this._onInputDown&&this._onInputDown.dispose(),this._onInputUp&&this._onInputUp.dispose(),this._onDragStart&&this._onDragStart.dispose(),this._onDragUpdate&&this._onDragUpdate.dispose(),this._onDragStop&&this._onDragStop.dispose(),this._onAnimationStart&&this._onAnimationStart.dispose(),this._onAnimationComplete&&this._onAnimationComplete.dispose(),this._onAnimationLoop&&this._onAnimationLoop.dispose()},onAddedToGroup:null,onRemovedFromGroup:null,onRemovedFromWorld:null,onDestroy:null,onKilled:null,onRevived:null,onOutOfBounds:null,onEnterBounds:null,onInputOver:null,onInputOut:null,onInputDown:null,onInputUp:null,onDragStart:null,onDragUpdate:null,onDragStop:null,onAnimationStart:null,onAnimationComplete:null,onAnimationLoop:null},i.Events.prototype.constructor=i.Events;for(var n in i.Events.prototype)i.Events.prototype.hasOwnProperty(n)&&0===n.indexOf("on")&&null===i.Events.prototype[n]&&function(e,t){"use strict";Object.defineProperty(i.Events.prototype,e,{get:function(){return this[t]||(this[t]=new i.Signal)}}),i.Events.prototype[e+"$dispatch"]=function(){return this[t]?this[t].dispatch.apply(this[t],arguments):null}}(n,"_"+n);i.Component.FixedToCamera=function(){},i.Component.FixedToCamera.postUpdate=function(){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y)},i.Component.FixedToCamera.prototype={_fixedToCamera:!1,fixedToCamera:{get:function(){return this._fixedToCamera},set:function(e){e?(this._fixedToCamera=!0,this.cameraOffset.set(this.x,this.y)):this._fixedToCamera=!1}},cameraOffset:new i.Point},i.Component.Health=function(){},i.Component.Health.prototype={health:1,maxHealth:100,damage:function(e){return this.alive&&(this.health-=e,this.health<=0&&this.kill()),this},setHealth:function(e){return this.health=e,this.health>this.maxHealth&&(this.health=this.maxHealth),this},heal:function(e){return this.alive&&(this.health+=e,this.health>this.maxHealth&&(this.health=this.maxHealth)),this}},i.Component.InCamera=function(){},i.Component.InCamera.prototype={inCamera:{get:function(){return this.game.world.camera.view.intersects(this._bounds)}}},i.Component.InputEnabled=function(){},i.Component.InputEnabled.prototype={input:null,inputEnabled:{get:function(){return this.input&&this.input.enabled},set:function(e){e?null===this.input?(this.input=new i.InputHandler(this),this.input.start()):this.input&&!this.input.enabled&&this.input.start():this.input&&this.input.enabled&&this.input.stop()}}},i.Component.InWorld=function(){},i.Component.InWorld.preUpdate=function(){if(this.autoCull||this.checkWorldBounds){if(this._bounds.copyFrom(this.getBounds()),this._bounds.x+=this.game.camera.view.x,this._bounds.y+=this.game.camera.view.y,this.autoCull)if(this.game.world.camera.view.intersects(this._bounds))this.renderable=!0,this.game.world.camera.totalInView++;else if(this.renderable=!1,this.outOfCameraBoundsKill)return this.kill(),!1;if(this.checkWorldBounds)if(this._outOfBoundsFired&&this.game.world.bounds.intersects(this._bounds))this._outOfBoundsFired=!1,this.events.onEnterBounds$dispatch(this);else if(!this._outOfBoundsFired&&!this.game.world.bounds.intersects(this._bounds)&&(this._outOfBoundsFired=!0,this.events.onOutOfBounds$dispatch(this),this.outOfBoundsKill))return this.kill(),!1}return!0},i.Component.InWorld.prototype={checkWorldBounds:!1,outOfBoundsKill:!1,outOfCameraBoundsKill:!1,_outOfBoundsFired:!1,inWorld:{get:function(){return this.game.world.bounds.intersects(this.getBounds())}}},i.Component.LifeSpan=function(){},i.Component.LifeSpan.preUpdate=function(){return!(this.lifespan>0&&(this.lifespan-=this.game.time.physicsElapsedMS,this.lifespan<=0)&&(this.kill(),1))},i.Component.LifeSpan.prototype={alive:!0,lifespan:0,revive:function(e){return void 0===e&&(e=100),this.alive=!0,this.exists=!0,this.visible=!0,"function"==typeof this.setHealth&&this.setHealth(e),this.events&&this.events.onRevived$dispatch(this),this},kill:function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.events&&this.events.onKilled$dispatch(this),this}},i.Component.LoadTexture=function(){},i.Component.LoadTexture.prototype={customRender:!1,_frame:null,loadTexture:function(e,t,s){e===i.PENDING_ATLAS?(e=t,t=0):t=t||0,(s||void 0===s)&&this.animations&&this.animations.stop(),this.key=e,this.customRender=!1;var a=this.game.cache,n=!0,o=!this.texture.baseTexture.scaleMode;if(i.RenderTexture&&e instanceof i.RenderTexture)this.key=e.key,this.setTexture(e);else if(i.BitmapData&&e instanceof i.BitmapData)this.customRender=!0,this.setTexture(e.texture),n=a.hasFrameData(e.key,i.Cache.BITMAPDATA)?!this.animations.loadFrameData(a.getFrameData(e.key,i.Cache.BITMAPDATA),t):!this.animations.loadFrameData(e.frameData,0);else if(i.Video&&e instanceof i.Video){this.customRender=!0;var r=e.texture.valid;this.setTexture(e.texture),this.setFrame(e.texture.frame.clone()),e.onChangeSource.add(this.resizeFrame,this),this.texture.valid=r}else if(i.Tilemap&&e instanceof i.TilemapLayer)this.setTexture(PIXI.Texture.fromCanvas(e.canvas));else if(e instanceof PIXI.Texture)this.setTexture(e);else{var l=a.getImage(e,!0);this.key=l.key,this.setTexture(new PIXI.Texture(l.base)),this.texture.baseTexture.skipRender="__default"===e,n=!this.animations.loadFrameData(l.frameData,t)}n&&(this._frame=i.Rectangle.clone(this.texture.frame)),o||(this.texture.baseTexture.scaleMode=1)},setFrame:function(e){this._frame=e,this.texture.frame.x=e.x,this.texture.frame.y=e.y,this.texture.frame.width=e.width,this.texture.frame.height=e.height,this.texture.crop.x=e.x,this.texture.crop.y=e.y,this.texture.crop.width=e.width,this.texture.crop.height=e.height,e.trimmed?(this.texture.trim?(this.texture.trim.x=e.spriteSourceSizeX,this.texture.trim.y=e.spriteSourceSizeY,this.texture.trim.width=e.sourceSizeW,this.texture.trim.height=e.sourceSizeH):this.texture.trim={x:e.spriteSourceSizeX,y:e.spriteSourceSizeY,width:e.sourceSizeW,height:e.sourceSizeH},this.texture.width=e.sourceSizeW,this.texture.height=e.sourceSizeH,this.texture.frame.width=e.sourceSizeW,this.texture.frame.height=e.sourceSizeH):!e.trimmed&&this.texture.trim&&(this.texture.trim=null),this.cropRect&&this.updateCrop(),this.texture.requiresReTint=!0,this.texture._updateUvs(),this.tilingTexture&&(this.refreshTexture=!0)},resizeFrame:function(e,t,i){this.texture.frame.resize(t,i),this.texture.setFrame(this.texture.frame)},resetFrame:function(){this._frame&&this.setFrame(this._frame)},frame:{get:function(){return this.animations.frame},set:function(e){this.animations.frame=e}},frameName:{get:function(){return this.animations.frameName},set:function(e){this.animations.frameName=e}}},i.Component.Overlap=function(){},i.Component.Overlap.prototype={overlap:function(e){return i.Rectangle.intersects(this.getBounds(),e.getBounds())}},i.Component.PhysicsBody=function(){},i.Component.PhysicsBody.preUpdate=function(){return this.fresh&&this.exists?(this.world.setTo(this.parent.position.x+this.position.x,this.parent.position.y+this.position.y),this.worldTransform.tx=this.world.x,this.worldTransform.ty=this.world.y,this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,this.body&&this.body.preUpdate(),this.fresh=!1,!1):(this.previousPosition.set(this.world.x,this.world.y),this.previousRotation=this.rotation,!(!this._exists||!this.parent.exists)||(this.renderOrderID=-1,!1))},i.Component.PhysicsBody.postUpdate=function(){this.exists&&this.body&&this.body.postUpdate()},i.Component.PhysicsBody.prototype={body:null,x:{get:function(){return this.position.x},set:function(e){this.position.x=e,this.body&&!this.body.dirty&&(this.body._reset=!0)}},y:{get:function(){return this.position.y},set:function(e){this.position.y=e,this.body&&!this.body.dirty&&(this.body._reset=!0)}}},i.Component.Reset=function(){},i.Component.Reset.prototype.reset=function(e,t,i){return void 0===i&&(i=1),this.world.set(e,t),this.position.set(e,t),this.fresh=!0,this.exists=!0,this.visible=!0,this.renderable=!0,this.components.InWorld&&(this._outOfBoundsFired=!1),this.components.LifeSpan&&(this.alive=!0,this.health=i),this.components.PhysicsBody&&this.body&&this.body.reset(e,t,!1,!1),this},i.Component.ScaleMinMax=function(){},i.Component.ScaleMinMax.prototype={transformCallback:null,transformCallbackContext:this,scaleMin:null,scaleMax:null,checkTransform:function(e){this.scaleMin&&(e.a<this.scaleMin.x&&(e.a=this.scaleMin.x),e.d<this.scaleMin.y&&(e.d=this.scaleMin.y)),this.scaleMax&&(e.a>this.scaleMax.x&&(e.a=this.scaleMax.x),e.d>this.scaleMax.y&&(e.d=this.scaleMax.y))},setScaleMinMax:function(e,t,s,a){void 0===t?t=s=a=e:void 0===s&&(s=a=t,t=e),null===e?this.scaleMin=null:this.scaleMin?this.scaleMin.set(e,t):this.scaleMin=new i.Point(e,t),null===s?this.scaleMax=null:this.scaleMax?this.scaleMax.set(s,a):this.scaleMax=new i.Point(s,a),null===this.scaleMin?this.transformCallback=null:(this.transformCallback=this.checkTransform,this.transformCallbackContext=this)}},i.Component.Smoothed=function(){},i.Component.Smoothed.prototype={smoothed:{get:function(){return!this.texture.baseTexture.scaleMode},set:function(e){e?this.texture&&(this.texture.baseTexture.scaleMode=0):this.texture&&(this.texture.baseTexture.scaleMode=1)}}},i.GameObjectFactory=function(e){this.game=e,this.world=this.game.world},i.GameObjectFactory.prototype={existing:function(e){return this.world.add(e)},weapon:function(e,t,s,a){var n=this.game.plugins.add(i.Weapon);return n.createBullets(e,t,s,a),n},image:function(e,t,s,a,n){return void 0===n&&(n=this.world),n.add(new i.Image(this.game,e,t,s,a))},sprite:function(e,t,i,s,a){return void 0===a&&(a=this.world),a.create(e,t,i,s)},creature:function(e,t,s,a,n){void 0===n&&(n=this.world);var o=new i.Creature(this.game,e,t,s,a);return n.add(o),o},tween:function(e){return this.game.tweens.create(e)},group:function(e,t,s,a,n){return new i.Group(this.game,e,t,s,a,n)},physicsGroup:function(e,t,s,a){return new i.Group(this.game,t,s,a,!0,e)},spriteBatch:function(e,t,s){return void 0===e&&(e=null),void 0===t&&(t="group"),void 0===s&&(s=!1),new i.SpriteBatch(this.game,e,t,s)},audio:function(e,t,i,s){return this.game.sound.add(e,t,i,s)},sound:function(e,t,i,s){return this.game.sound.add(e,t,i,s)},audioSprite:function(e){return this.game.sound.addSprite(e)},tileSprite:function(e,t,s,a,n,o,r){return void 0===r&&(r=this.world),r.add(new i.TileSprite(this.game,e,t,s,a,n,o))},rope:function(e,t,s,a,n,o){return void 0===o&&(o=this.world),o.add(new i.Rope(this.game,e,t,s,a,n))},text:function(e,t,s,a,n){return void 0===n&&(n=this.world),n.add(new i.Text(this.game,e,t,s,a))},button:function(e,t,s,a,n,o,r,l,h,c){return void 0===c&&(c=this.world),c.add(new i.Button(this.game,e,t,s,a,n,o,r,l,h))},graphics:function(e,t,s){return void 0===s&&(s=this.world),s.add(new i.Graphics(this.game,e,t))},emitter:function(e,t,s){return this.game.particles.add(new i.Particles.Arcade.Emitter(this.game,e,t,s))},retroFont:function(e,t,s,a,n,o,r,l,h){return new i.RetroFont(this.game,e,t,s,a,n,o,r,l,h)},bitmapText:function(e,t,s,a,n,o){return void 0===o&&(o=this.world),o.add(new i.BitmapText(this.game,e,t,s,a,n))},tilemap:function(e,t,s,a,n){return new i.Tilemap(this.game,e,t,s,a,n)},renderTexture:function(e,t,s,a){void 0!==s&&""!==s||(s=this.game.rnd.uuid()),void 0===a&&(a=!1);var n=new i.RenderTexture(this.game,e,t,s);return a&&this.game.cache.addRenderTexture(s,n),n},video:function(e,t){return new i.Video(this.game,e,t)},bitmapData:function(e,t,s,a){void 0===a&&(a=!1),void 0!==s&&""!==s||(s=this.game.rnd.uuid());var n=new i.BitmapData(this.game,s,e,t);return a&&this.game.cache.addBitmapData(s,n),n},filter:function(e){var t=Array.prototype.slice.call(arguments,1);return(e=new i.Filter[e](this.game)).init.apply(e,t),e},plugin:function(e){return this.game.plugins.add(e)}},i.GameObjectFactory.prototype.constructor=i.GameObjectFactory,i.GameObjectCreator=function(e){this.game=e,this.world=this.game.world},i.GameObjectCreator.prototype={image:function(e,t,s,a){return new i.Image(this.game,e,t,s,a)},sprite:function(e,t,s,a){return new i.Sprite(this.game,e,t,s,a)},tween:function(e){return new i.Tween(e,this.game,this.game.tweens)},group:function(e,t,s,a,n){return new i.Group(this.game,e,t,s,a,n)},spriteBatch:function(e,t,s){return void 0===t&&(t="group"),void 0===s&&(s=!1),new i.SpriteBatch(this.game,e,t,s)},audio:function(e,t,i,s){return this.game.sound.add(e,t,i,s)},audioSprite:function(e){return this.game.sound.addSprite(e)},sound:function(e,t,i,s){return this.game.sound.add(e,t,i,s)},tileSprite:function(e,t,s,a,n,o){return new i.TileSprite(this.game,e,t,s,a,n,o)},rope:function(e,t,s,a,n){return new i.Rope(this.game,e,t,s,a,n)},text:function(e,t,s,a){return new i.Text(this.game,e,t,s,a)},button:function(e,t,s,a,n,o,r,l,h){return new i.Button(this.game,e,t,s,a,n,o,r,l,h)},graphics:function(e,t){return new i.Graphics(this.game,e,t)},emitter:function(e,t,s){return new i.Particles.Arcade.Emitter(this.game,e,t,s)},retroFont:function(e,t,s,a,n,o,r,l,h){return new i.RetroFont(this.game,e,t,s,a,n,o,r,l,h)},bitmapText:function(e,t,s,a,n,o){return new i.BitmapText(this.game,e,t,s,a,n,o)},tilemap:function(e,t,s,a,n){return new i.Tilemap(this.game,e,t,s,a,n)},renderTexture:function(e,t,s,a){void 0!==s&&""!==s||(s=this.game.rnd.uuid()),void 0===a&&(a=!1);var n=new i.RenderTexture(this.game,e,t,s);return a&&this.game.cache.addRenderTexture(s,n),n},bitmapData:function(e,t,s,a){void 0===a&&(a=!1),void 0!==s&&""!==s||(s=this.game.rnd.uuid());var n=new i.BitmapData(this.game,s,e,t);return a&&this.game.cache.addBitmapData(s,n),n},filter:function(e){var t=Array.prototype.slice.call(arguments,1);return(e=new i.Filter[e](this.game)).init.apply(e,t),e}},i.GameObjectCreator.prototype.constructor=i.GameObjectCreator,i.Sprite=function(e,t,s,a,n){t=t||0,s=s||0,a=a||null,n=n||null,this.type=i.SPRITE,this.physicsType=i.SPRITE,PIXI.Sprite.call(this,i.Cache.DEFAULT),i.Component.Core.init.call(this,e,t,s,a,n)},i.Sprite.prototype=Object.create(PIXI.Sprite.prototype),i.Sprite.prototype.constructor=i.Sprite,i.Component.Core.install.call(i.Sprite.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Delta","Destroy","FixedToCamera","Health","InCamera","InputEnabled","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","ScaleMinMax","Smoothed"]),i.Sprite.prototype.preUpdatePhysics=i.Component.PhysicsBody.preUpdate,i.Sprite.prototype.preUpdateLifeSpan=i.Component.LifeSpan.preUpdate,i.Sprite.prototype.preUpdateInWorld=i.Component.InWorld.preUpdate,i.Sprite.prototype.preUpdateCore=i.Component.Core.preUpdate,i.Sprite.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},i.Image=function(e,t,s,a,n){t=t||0,s=s||0,a=a||null,n=n||null,this.type=i.IMAGE,PIXI.Sprite.call(this,i.Cache.DEFAULT),i.Component.Core.init.call(this,e,t,s,a,n)},i.Image.prototype=Object.create(PIXI.Sprite.prototype),i.Image.prototype.constructor=i.Image,i.Component.Core.install.call(i.Image.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Destroy","FixedToCamera","InputEnabled","LifeSpan","LoadTexture","Overlap","Reset","ScaleMinMax","Smoothed"]),i.Image.prototype.preUpdateInWorld=i.Component.InWorld.preUpdate,i.Image.prototype.preUpdateCore=i.Component.Core.preUpdate,i.Image.prototype.preUpdate=function(){return!!this.preUpdateInWorld()&&this.preUpdateCore()},i.Button=function(e,t,s,a,n,o,r,l,h,c){t=t||0,s=s||0,a=a||null,n=n||null,o=o||this,i.Image.call(this,e,t,s,a,l),this.type=i.BUTTON,this.physicsType=i.SPRITE,this._onOverFrame=null,this._onOutFrame=null,this._onDownFrame=null,this._onUpFrame=null,this.onOverSound=null,this.onOutSound=null,this.onDownSound=null,this.onUpSound=null,this.onOverSoundMarker="",this.onOutSoundMarker="",this.onDownSoundMarker="",this.onUpSoundMarker="",this.onInputOver=new i.Signal,this.onInputOut=new i.Signal,this.onInputDown=new i.Signal,this.onInputUp=new i.Signal,this.onOverMouseOnly=!0,this.justReleasedPreventsOver=i.PointerMode.TOUCH,this.freezeFrames=!1,this.forceOut=!1,this.inputEnabled=!0,this.input.start(0,!0),this.input.useHandCursor=!0,this.setFrames(r,l,h,c),null!==n&&this.onInputUp.add(n,o),this.events.onInputOver.add(this.onInputOverHandler,this),this.events.onInputOut.add(this.onInputOutHandler,this),this.events.onInputDown.add(this.onInputDownHandler,this),this.events.onInputUp.add(this.onInputUpHandler,this),this.events.onRemovedFromWorld.add(this.removedFromWorld,this)},i.Button.prototype=Object.create(i.Image.prototype),i.Button.prototype.constructor=i.Button;var o="Over",r="Out",l="Down",h="Up";i.Button.prototype.clearFrames=function(){this.setFrames(null,null,null,null)},i.Button.prototype.removedFromWorld=function(){this.inputEnabled=!1},i.Button.prototype.setStateFrame=function(e,t,i){var s="_on"+e+"Frame";null!==t?(this[s]=t,i&&this.changeStateFrame(e)):this[s]=null},i.Button.prototype.changeStateFrame=function(e){if(this.freezeFrames)return!1;var t=this["_on"+e+"Frame"];return"string"==typeof t?(this.frameName=t,!0):"number"==typeof t&&(this.frame=t,!0)},i.Button.prototype.setFrames=function(e,t,i,s){this.setStateFrame(o,e,this.input.pointerOver()),this.setStateFrame(r,t,!this.input.pointerOver()),this.setStateFrame(l,i,this.input.pointerDown()),this.setStateFrame(h,s,this.input.pointerUp())},i.Button.prototype.setStateSound=function(e,t,s){var a="on"+e+"Sound",n="on"+e+"SoundMarker";t instanceof i.Sound||t instanceof i.AudioSprite?(this[a]=t,this[n]="string"==typeof s?s:""):(this[a]=null,this[n]="")},i.Button.prototype.playStateSound=function(e){var t=this["on"+e+"Sound"];if(t){var i=this["on"+e+"SoundMarker"];return t.play(i),!0}return!1},i.Button.prototype.setSounds=function(e,t,i,s,a,n,c,p){this.setStateSound(o,e,t),this.setStateSound(r,a,n),this.setStateSound(l,i,s),this.setStateSound(h,c,p)},i.Button.prototype.setOverSound=function(e,t){this.setStateSound(o,e,t)},i.Button.prototype.setOutSound=function(e,t){this.setStateSound(r,e,t)},i.Button.prototype.setDownSound=function(e,t){this.setStateSound(l,e,t)},i.Button.prototype.setUpSound=function(e,t){this.setStateSound(h,e,t)},i.Button.prototype.onInputOverHandler=function(e,t){t.justReleased()&&(this.justReleasedPreventsOver&t.pointerMode)===t.pointerMode||(this.changeStateFrame(o),this.onOverMouseOnly&&!t.isMouse||(this.playStateSound(o),this.onInputOver&&this.onInputOver.dispatch(this,t)))},i.Button.prototype.onInputOutHandler=function(e,t){this.changeStateFrame(r),this.playStateSound(r),this.onInputOut&&this.onInputOut.dispatch(this,t)},i.Button.prototype.onInputDownHandler=function(e,t){this.changeStateFrame(l),this.playStateSound(l),this.onInputDown&&this.onInputDown.dispatch(this,t)},i.Button.prototype.onInputUpHandler=function(e,t,i){this.playStateSound(h),this.onInputUp&&this.onInputUp.dispatch(this,t,i),this.freezeFrames||(!0===this.forceOut||(this.forceOut&t.pointerMode)===t.pointerMode?this.changeStateFrame(r):this.changeStateFrame(h)||(i?this.changeStateFrame(o):this.changeStateFrame(r)))},i.SpriteBatch=function(e,t,s,a){void 0!==t&&null!==t||(t=e.world),PIXI.SpriteBatch.call(this),i.Group.call(this,e,t,s,a),this.type=i.SPRITEBATCH},i.SpriteBatch.prototype=i.Utils.extend(!0,i.SpriteBatch.prototype,PIXI.SpriteBatch.prototype,i.Group.prototype),i.SpriteBatch.prototype.constructor=i.SpriteBatch,i.BitmapData=function(e,t,s,a,n){void 0!==s&&0!==s||(s=256),void 0!==a&&0!==a||(a=256),void 0===n&&(n=!1),this.game=e,this.key=t,this.width=s,this.height=a,this.canvas=i.Canvas.create(this,s,a,null,n),this.context=this.canvas.getContext("2d",{alpha:!0}),this.ctx=this.context,this.smoothProperty=e.renderType===i.CANVAS?e.renderer.renderSession.smoothProperty:i.Canvas.getSmoothingPrefix(this.context),this.imageData=this.context.getImageData(0,0,s,a),this.data=null,this.imageData&&(this.data=this.imageData.data),this.pixels=null,this.data&&(this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data),this.baseTexture=new PIXI.BaseTexture(this.canvas),this.texture=new PIXI.Texture(this.baseTexture),this.frameData=new i.FrameData,this.textureFrame=this.frameData.addFrame(new i.Frame(0,0,0,s,a,"bitmapData")),this.texture.frame=this.textureFrame,this.type=i.BITMAPDATA,this.disableTextureUpload=!1,this.dirty=!1,this.cls=this.clear,this._image=null,this._pos=new i.Point,this._size=new i.Point,this._scale=new i.Point,this._rotate=0,this._alpha={prev:1,current:1},this._anchor=new i.Point,this._tempR=0,this._tempG=0,this._tempB=0,this._circle=new i.Circle,this._swapCanvas=void 0},i.BitmapData.prototype={move:function(e,t,i){return 0!==e&&this.moveH(e,i),0!==t&&this.moveV(t,i),this},moveH:function(e,t){void 0===t&&(t=!0),void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var i=this._swapCanvas.getContext("2d"),s=this.height,a=this.canvas;if(i.clearRect(0,0,this.width,this.height),e<0){e=Math.abs(e);n=this.width-e;t&&i.drawImage(a,0,0,e,s,n,0,e,s),i.drawImage(a,e,0,n,s,0,0,n,s)}else{var n=this.width-e;t&&i.drawImage(a,n,0,e,s,0,0,e,s),i.drawImage(a,0,0,n,s,e,0,n,s)}return this.clear(),this.copy(this._swapCanvas)},moveV:function(e,t){void 0===t&&(t=!0),void 0===this._swapCanvas&&(this._swapCanvas=PIXI.CanvasPool.create(this,this.width,this.height));var i=this._swapCanvas.getContext("2d"),s=this.width,a=this.canvas;if(i.clearRect(0,0,this.width,this.height),e<0){e=Math.abs(e);n=this.height-e;t&&i.drawImage(a,0,0,s,e,0,n,s,e),i.drawImage(a,0,e,s,n,0,0,s,n)}else{var n=this.height-e;t&&i.drawImage(a,0,n,s,e,0,0,s,e),i.drawImage(a,0,0,s,n,0,e,s,n)}return this.clear(),this.copy(this._swapCanvas)},add:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t].loadTexture&&e[t].loadTexture(this);else e.loadTexture(this);return this},load:function(e){if("string"==typeof e&&(e=this.game.cache.getImage(e)),e)return this.resize(e.width,e.height),this.cls(),this.draw(e),this.update(),this},clear:function(e,t,i,s){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=this.width),void 0===s&&(s=this.height),this.context.clearRect(e,t,i,s),this.dirty=!0,this},fill:function(e,t,i,s){return void 0===s&&(s=1),this.context.fillStyle="rgba("+e+","+t+","+i+","+s+")",this.context.fillRect(0,0,this.width,this.height),this.dirty=!0,this},generateTexture:function(e){var t=new Image;t.src=this.canvas.toDataURL("image/png");var i=this.game.cache.addImage(e,"",t);return new PIXI.Texture(i.base)},resize:function(e,t){return e===this.width&&t===this.height||(this.width=e,this.height=t,this.canvas.width=e,this.canvas.height=t,void 0!==this._swapCanvas&&(this._swapCanvas.width=e,this._swapCanvas.height=t),this.baseTexture.width=e,this.baseTexture.height=t,this.textureFrame.width=e,this.textureFrame.height=t,this.texture.width=e,this.texture.height=t,this.texture.crop.width=e,this.texture.crop.height=t,this.update(),this.dirty=!0),this},update:function(e,t,i,s){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=Math.max(1,this.width)),void 0===s&&(s=Math.max(1,this.height)),this.imageData=this.context.getImageData(e,t,i,s),this.data=this.imageData.data,this.imageData.data.buffer?(this.buffer=this.imageData.data.buffer,this.pixels=new Uint32Array(this.buffer)):window.ArrayBuffer?(this.buffer=new ArrayBuffer(this.imageData.data.length),this.pixels=new Uint32Array(this.buffer)):this.pixels=this.imageData.data,this},processPixelRGB:function(e,t,s,a,n,o){void 0===s&&(s=0),void 0===a&&(a=0),void 0===n&&(n=this.width),void 0===o&&(o=this.height);for(var r=s+n,l=a+o,h=i.Color.createColor(),c={r:0,g:0,b:0,a:0},p=!1,d=a;d<l;d++)for(var u=s;u<r;u++)i.Color.unpackPixel(this.getPixel32(u,d),h),!1!==(c=e.call(t,h,u,d))&&null!==c&&void 0!==c&&(this.setPixel32(u,d,c.r,c.g,c.b,c.a,!1),p=!0);return p&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0),this},processPixel:function(e,t,i,s,a,n){void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=this.width),void 0===n&&(n=this.height);for(var o=i+a,r=s+n,l=0,h=0,c=!1,p=s;p<r;p++)for(var d=i;d<o;d++)l=this.getPixel32(d,p),(h=e.call(t,l,d,p))!==l&&(this.pixels[p*this.width+d]=h,c=!0);return c&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0),this},replaceRGB:function(e,t,s,a,n,o,r,l,h){var c=0,p=0,d=this.width,u=this.height,m=i.Color.packPixel(e,t,s,a);void 0!==h&&h instanceof i.Rectangle&&(c=h.x,p=h.y,d=h.width,u=h.height);for(var g=0;g<u;g++)for(var y=0;y<d;y++)this.getPixel32(c+y,p+g)===m&&this.setPixel32(c+y,p+g,n,o,r,l,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this},setHSL:function(e,t,s,a){var n=e||0===e,o=t||0===t,r=s||0===s;if(n||o||r){void 0===a&&(a=new i.Rectangle(0,0,this.width,this.height));for(var l=i.Color.createColor(),h=a.y;h<a.bottom;h++)for(var c=a.x;c<a.right;c++)i.Color.unpackPixel(this.getPixel32(c,h),l,!0),n&&(l.h=e),o&&(l.s=t),r&&(l.l=s),i.Color.HSLtoRGB(l.h,l.s,l.l,l),this.setPixel32(c,h,l.r,l.g,l.b,l.a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this}},shiftHSL:function(e,t,s,a){if(void 0!==e&&null!==e||(e=!1),void 0!==t&&null!==t||(t=!1),void 0!==s&&null!==s||(s=!1),e||t||s){void 0===a&&(a=new i.Rectangle(0,0,this.width,this.height));for(var n=i.Color.createColor(),o=a.y;o<a.bottom;o++)for(var r=a.x;r<a.right;r++)i.Color.unpackPixel(this.getPixel32(r,o),n,!0),e&&(n.h=this.game.math.wrap(n.h+e,0,1)),t&&(n.s=this.game.math.clamp(n.s+t,0,1)),s&&(n.l=this.game.math.clamp(n.l+s,0,1)),i.Color.HSLtoRGB(n.h,n.s,n.l,n),this.setPixel32(r,o,n.r,n.g,n.b,n.a,!1);return this.context.putImageData(this.imageData,0,0),this.dirty=!0,this}},setPixel32:function(e,t,s,a,n,o,r){return void 0===r&&(r=!0),e>=0&&e<=this.width&&t>=0&&t<=this.height&&(i.Device.LITTLE_ENDIAN?this.pixels[t*this.width+e]=o<<24|n<<16|a<<8|s:this.pixels[t*this.width+e]=s<<24|a<<16|n<<8|o,r&&(this.context.putImageData(this.imageData,0,0),this.dirty=!0)),this},setPixel:function(e,t,i,s,a,n){return this.setPixel32(e,t,i,s,a,255,n)},getPixel:function(e,t,s){s||(s=i.Color.createColor());var a=~~(e+t*this.width);return a*=4,s.r=this.data[a],s.g=this.data[++a],s.b=this.data[++a],s.a=this.data[++a],s},getPixel32:function(e,t){if(e>=0&&e<=this.width&&t>=0&&t<=this.height)return this.pixels[t*this.width+e]},getPixelRGB:function(e,t,s,a,n){return i.Color.unpackPixel(this.getPixel32(e,t),s,a,n)},getPixels:function(e){return this.context.getImageData(e.x,e.y,e.width,e.height)},getFirstPixel:function(e){void 0===e&&(e=0);var t=i.Color.createColor(),s=0,a=0,n=1,o=!1;1===e?(n=-1,a=this.height):3===e&&(n=-1,s=this.width);do{i.Color.unpackPixel(this.getPixel32(s,a),t),0===e||1===e?++s===this.width&&(s=0,((a+=n)>=this.height||a<=0)&&(o=!0)):2!==e&&3!==e||++a===this.height&&(a=0,((s+=n)>=this.width||s<=0)&&(o=!0))}while(0===t.a&&!o);return t.x=s,t.y=a,t},getBounds:function(e){return void 0===e&&(e=new i.Rectangle),e.x=this.getFirstPixel(2).x,e.x===this.width?e.setTo(0,0,0,0):(e.y=this.getFirstPixel(0).y,e.width=this.getFirstPixel(3).x-e.x+1,e.height=this.getFirstPixel(1).y-e.y+1,e)},addToWorld:function(e,t,i,s,a,n){a=a||1,n=n||1;var o=this.game.add.image(e,t,this);return o.anchor.set(i,s),o.scale.set(a,n),o},copy:function(e,t,s,a,n,o,r,l,h,c,p,d,u,m,g,y,b){if(void 0!==e&&null!==e||(e=this),(e instanceof i.RenderTexture||e instanceof PIXI.RenderTexture)&&(e=e.getCanvas()),this._image=e,e instanceof i.Sprite||e instanceof i.Image||e instanceof i.Text||e instanceof PIXI.Sprite)this._pos.set(e.texture.crop.x,e.texture.crop.y),this._size.set(e.texture.crop.width,e.texture.crop.height),this._scale.set(e.scale.x,e.scale.y),this._anchor.set(e.anchor.x,e.anchor.y),this._rotate=e.rotation,this._alpha.current=e.alpha,e.texture instanceof i.RenderTexture||e.texture instanceof PIXI.RenderTexture?this._image=e.texture.getCanvas():this._image=e.texture.baseTexture.source,void 0!==o&&null!==o||(o=e.x),void 0!==r&&null!==r||(r=e.y),e.texture.trim&&(o+=e.texture.trim.x-e.anchor.x*e.texture.trim.width,r+=e.texture.trim.y-e.anchor.y*e.texture.trim.height),16777215!==e.tint&&(e.cachedTint!==e.tint&&(e.cachedTint=e.tint,e.tintedTexture=PIXI.CanvasTinter.getTintedTexture(e,e.tint)),this._image=e.tintedTexture,this._pos.set(0));else{if(this._pos.set(0),this._scale.set(1),this._anchor.set(0),this._rotate=0,this._alpha.current=1,e instanceof i.BitmapData)this._image=e.canvas;else if("string"==typeof e){if(null===(e=this.game.cache.getImage(e)))return;this._image=e}this._size.set(this._image.width,this._image.height)}if(void 0!==t&&null!==t||(t=0),void 0!==s&&null!==s||(s=0),a&&(this._size.x=a),n&&(this._size.y=n),void 0!==o&&null!==o||(o=t),void 0!==r&&null!==r||(r=s),void 0!==l&&null!==l||(l=this._size.x),void 0!==h&&null!==h||(h=this._size.y),"number"==typeof c&&(this._rotate=c),"number"==typeof p&&(this._anchor.x=p),"number"==typeof d&&(this._anchor.y=d),"number"==typeof u&&(this._scale.x=u),"number"==typeof m&&(this._scale.y=m),"number"==typeof g&&(this._alpha.current=g),void 0===y&&(y=null),void 0===b&&(b=!1),!(this._alpha.current<=0||0===this._scale.x||0===this._scale.y||0===this._size.x||0===this._size.y)){var x=this.context;return this._alpha.prev=x.globalAlpha,x.save(),x.globalAlpha=this._alpha.current,y&&(this.op=y),b&&(o|=0,r|=0),x.translate(o,r),x.scale(this._scale.x,this._scale.y),x.rotate(this._rotate),x.drawImage(this._image,this._pos.x+t,this._pos.y+s,this._size.x,this._size.y,-l*this._anchor.x,-h*this._anchor.y,l,h),x.restore(),x.globalAlpha=this._alpha.prev,this.dirty=!0,this}},copyTransform:function(e,t,s){if(void 0===t&&(t=null),void 0===s&&(s=!1),!e.hasOwnProperty("worldTransform")||!e.worldVisible||0===e.worldAlpha)return this;var a=e.worldTransform;if(this._pos.set(e.texture.crop.x,e.texture.crop.y),this._size.set(e.texture.crop.width,e.texture.crop.height),0===a.a||0===a.d||0===this._size.x||0===this._size.y)return this;e.texture instanceof i.RenderTexture||e.texture instanceof PIXI.RenderTexture?this._image=e.texture.getCanvas():this._image=e.texture.baseTexture.source;var n=a.tx,o=a.ty;e.texture.trim&&(n+=e.texture.trim.x-e.anchor.x*e.texture.trim.width,o+=e.texture.trim.y-e.anchor.y*e.texture.trim.height),16777215!==e.tint&&(e.cachedTint!==e.tint&&(e.cachedTint=e.tint,e.tintedTexture=PIXI.CanvasTinter.getTintedTexture(e,e.tint)),this._image=e.tintedTexture,this._pos.set(0)),s&&(n|=0,o|=0);var r=this.context;return this._alpha.prev=r.globalAlpha,r.save(),r.globalAlpha=this._alpha.current,t&&(this.op=t),r[this.smoothProperty]=e.texture.baseTexture.scaleMode===PIXI.scaleModes.LINEAR,r.setTransform(a.a,a.b,a.c,a.d,n,o),r.drawImage(this._image,this._pos.x,this._pos.y,this._size.x,this._size.y,-this._size.x*e.anchor.x,-this._size.y*e.anchor.y,this._size.x,this._size.y),r.restore(),r.globalAlpha=this._alpha.prev,this.dirty=!0,this},copyRect:function(e,t,i,s,a,n,o){return this.copy(e,t.x,t.y,t.width,t.height,i,s,t.width,t.height,0,0,0,1,1,a,n,o)},draw:function(e,t,i,s,a,n,o){return this.copy(e,null,null,null,null,t,i,s,a,null,null,null,null,null,null,n,o)},drawGroup:function(e,t,i){return e.total>0&&e.forEachExists(this.drawGroupProxy,this,t,i),this},drawGroupProxy:function(e,t,s){if(e.hasOwnProperty("texture")&&this.copyTransform(e,t,s),e.type===i.GROUP&&e.exists)this.drawGroup(e,t,s);else if(e.hasOwnProperty("children")&&e.children.length>0)for(var a=0;a<e.children.length;a++)e.children[a].exists&&this.copyTransform(e.children[a],t,s)},drawFull:function(e,t,s){if(!1===e.worldVisible||0===e.worldAlpha||e.hasOwnProperty("exists")&&!1===e.exists)return this;if(e.type!==i.GROUP&&e.type!==i.EMITTER&&e.type!==i.BITMAPTEXT)if(e.type===i.GRAPHICS){var a=e.getBounds();this.ctx.save(),this.ctx.translate(a.x,a.y),PIXI.CanvasGraphics.renderGraphics(e,this.ctx),this.ctx.restore()}else this.copy(e,null,null,null,null,e.worldPosition.x,e.worldPosition.y,null,null,e.worldRotation,null,null,e.worldScale.x,e.worldScale.y,e.worldAlpha,t,s);if(e.children)for(var n=0;n<e.children.length;n++)this.drawFull(e.children[n],t,s);return this},shadow:function(e,t,i,s){var a=this.context;return void 0===e||null===e?a.shadowColor="rgba(0,0,0,0)":(a.shadowColor=e,a.shadowBlur=t||5,a.shadowOffsetX=i||10,a.shadowOffsetY=s||10),this},alphaMask:function(e,t,i,s){return void 0===s||null===s?this.draw(t).blendSourceAtop():this.draw(t,s.x,s.y,s.width,s.height).blendSourceAtop(),void 0===i||null===i?this.draw(e).blendReset():this.draw(e,i.x,i.y,i.width,i.height).blendReset(),this},extract:function(e,t,i,s,a,n,o,r,l){return void 0===a&&(a=255),void 0===n&&(n=!1),void 0===o&&(o=t),void 0===r&&(r=i),void 0===l&&(l=s),n&&e.resize(this.width,this.height),this.processPixelRGB(function(n,h,c){return n.r===t&&n.g===i&&n.b===s&&e.setPixel32(h,c,o,r,l,a,!1),!1},this),e.context.putImageData(e.imageData,0,0),e.dirty=!0,e},rect:function(e,t,i,s,a){return void 0!==a&&(this.context.fillStyle=a),this.context.fillRect(e,t,i,s),this},text:function(e,t,i,s,a,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===s&&(s="14px Courier"),void 0===a&&(a="rgb(255,255,255)"),void 0===n&&(n=!0);var o=this.context,r=o.font;return o.font=s,n&&(o.fillStyle="rgb(0,0,0)",o.fillText(e,t+1,i+1)),o.fillStyle=a,o.fillText(e,t,i),o.font=r,this},circle:function(e,t,i,s){var a=this.context;return void 0!==s&&(a.fillStyle=s),a.beginPath(),a.arc(e,t,i,0,2*Math.PI,!1),a.closePath(),a.fill(),this},line:function(e,t,i,s,a,n){void 0===a&&(a="#fff"),void 0===n&&(n=1);var o=this.context;return o.beginPath(),o.moveTo(e,t),o.lineTo(i,s),o.lineWidth=n,o.strokeStyle=a,o.stroke(),o.closePath(),this},textureLine:function(e,t,s){if(void 0===s&&(s="repeat-x"),"string"!=typeof t||(t=this.game.cache.getImage(t))){var a=e.length;"no-repeat"===s&&a>t.width&&(a=t.width);var n=this.context;return n.fillStyle=n.createPattern(t,s),this._circle=new i.Circle(e.start.x,e.start.y,t.height),this._circle.circumferencePoint(e.angle-1.5707963267948966,!1,this._pos),n.save(),n.translate(this._pos.x,this._pos.y),n.rotate(e.angle),n.fillRect(0,0,a,t.height),n.restore(),this.dirty=!0,this}},render:function(){return!this.disableTextureUpload&&this.dirty&&(this.baseTexture.dirty(),this.dirty=!1),this},destroy:function(){this.frameData.destroy(),this.texture.destroy(!0),PIXI.CanvasPool.remove(this)},blendReset:function(){return this.op="source-over",this},blendSourceOver:function(){return this.op="source-over",this},blendSourceIn:function(){return this.op="source-in",this},blendSourceOut:function(){return this.op="source-out",this},blendSourceAtop:function(){return this.op="source-atop",this},blendDestinationOver:function(){return this.op="destination-over",this},blendDestinationIn:function(){return this.op="destination-in",this},blendDestinationOut:function(){return this.op="destination-out",this},blendDestinationAtop:function(){return this.op="destination-atop",this},blendXor:function(){return this.op="xor",this},blendAdd:function(){return this.op="lighter",this},blendMultiply:function(){return this.op="multiply",this},blendScreen:function(){return this.op="screen",this},blendOverlay:function(){return this.op="overlay",this},blendDarken:function(){return this.op="darken",this},blendLighten:function(){return this.op="lighten",this},blendColorDodge:function(){return this.op="color-dodge",this},blendColorBurn:function(){return this.op="color-burn",this},blendHardLight:function(){return this.op="hard-light",this},blendSoftLight:function(){return this.op="soft-light",this},blendDifference:function(){return this.op="difference",this},blendExclusion:function(){return this.op="exclusion",this},blendHue:function(){return this.op="hue",this},blendSaturation:function(){return this.op="saturation",this},blendColor:function(){return this.op="color",this},blendLuminosity:function(){return this.op="luminosity",this}},Object.defineProperty(i.BitmapData.prototype,"smoothed",{get:function(){i.Canvas.getSmoothingEnabled(this.context)},set:function(e){i.Canvas.setSmoothingEnabled(this.context,e)}}),Object.defineProperty(i.BitmapData.prototype,"op",{get:function(){return this.context.globalCompositeOperation},set:function(e){this.context.globalCompositeOperation=e}}),i.BitmapData.getTransform=function(e,t,i,s,a,n){return"number"!=typeof e&&(e=0),"number"!=typeof t&&(t=0),"number"!=typeof i&&(i=1),"number"!=typeof s&&(s=1),"number"!=typeof a&&(a=0),"number"!=typeof n&&(n=0),{sx:i,sy:s,scaleX:i,scaleY:s,skewX:a,skewY:n,translateX:e,translateY:t,tx:e,ty:t}},i.BitmapData.prototype.constructor=i.BitmapData,PIXI.Graphics=function(){PIXI.DisplayObjectContainer.call(this),this.renderable=!0,this.fillAlpha=1,this.lineWidth=0,this.lineColor=0,this.graphicsData=[],this.tint=16777215,this.blendMode=PIXI.blendModes.NORMAL,this.currentPath=null,this._webGL=[],this.isMask=!1,this.boundsPadding=0,this._localBounds=new PIXI.Rectangle(0,0,1,1),this.dirty=!0,this._boundsDirty=!1,this.webGLDirty=!1,this.cachedSpriteDirty=!1},PIXI.Graphics.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Graphics.prototype.constructor=PIXI.Graphics,PIXI.Graphics.prototype.lineStyle=function(e,t,i){return this.lineWidth=e||0,this.lineColor=t||0,this.lineAlpha=void 0===i?1:i,this.currentPath&&(this.currentPath.shape.points.length?this.drawShape(new PIXI.Polygon(this.currentPath.shape.points.slice(-2))):(this.currentPath.lineWidth=this.lineWidth,this.currentPath.lineColor=this.lineColor,this.currentPath.lineAlpha=this.lineAlpha)),this},PIXI.Graphics.prototype.moveTo=function(e,t){return this.drawShape(new PIXI.Polygon([e,t])),this},PIXI.Graphics.prototype.lineTo=function(e,t){return this.currentPath||this.moveTo(0,0),this.currentPath.shape.points.push(e,t),this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.quadraticCurveTo=function(e,t,i,s){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);var a,n,o=this.currentPath.shape.points;0===o.length&&this.moveTo(0,0);for(var r=o[o.length-2],l=o[o.length-1],h=0,c=1;c<=20;++c)h=c/20,a=r+(e-r)*h,n=l+(t-l)*h,o.push(a+(e+(i-e)*h-a)*h,n+(t+(s-t)*h-n)*h);return this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.bezierCurveTo=function(e,t,i,s,a,n){this.currentPath?0===this.currentPath.shape.points.length&&(this.currentPath.shape.points=[0,0]):this.moveTo(0,0);for(var o,r,l,h,c,p=this.currentPath.shape.points,d=p[p.length-2],u=p[p.length-1],m=0,g=1;g<=20;++g)m=g/20,o=1-m,r=o*o,l=r*o,h=m*m,c=h*m,p.push(l*d+3*r*m*e+3*o*h*i+c*a,l*u+3*r*m*t+3*o*h*s+c*n);return this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.arcTo=function(e,t,i,s,a){this.currentPath?0===this.currentPath.shape.points.length&&this.currentPath.shape.points.push(e,t):this.moveTo(e,t);var n=this.currentPath.shape.points,o=n[n.length-2],r=n[n.length-1]-t,l=o-e,h=s-t,c=i-e,p=Math.abs(r*c-l*h);if(p<1e-8||0===a)n[n.length-2]===e&&n[n.length-1]===t||n.push(e,t);else{var d=r*r+l*l,u=h*h+c*c,m=r*h+l*c,g=a*Math.sqrt(d)/p,y=a*Math.sqrt(u)/p,b=g*m/d,x=y*m/u,v=g*c+y*l,f=g*h+y*r,w=l*(y+b),k=r*(y+b),_=c*(g+x),S=h*(g+x),M=Math.atan2(k-f,w-v),A=Math.atan2(S-f,_-v);this.arc(v+e,f+t,a,M,A,l*h>c*r)}return this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.arc=function(e,t,i,s,a,n,o){if(s===a)return this;void 0===n&&(n=!1),void 0===o&&(o=40),!n&&a<=s?a+=2*Math.PI:n&&s<=a&&(s+=2*Math.PI);var r=n?-1*(s-a):a-s,l=Math.ceil(Math.abs(r)/(2*Math.PI))*o;if(0===r)return this;var h=e+Math.cos(s)*i,c=t+Math.sin(s)*i;n&&this.filling?this.moveTo(e,t):this.moveTo(h,c);for(var p=this.currentPath.shape.points,d=r/(2*l),u=2*d,m=Math.cos(d),g=Math.sin(d),y=l-1,b=y%1/y,x=0;x<=y;x++){var v=d+s+u*(x+b*x),f=Math.cos(v),w=-Math.sin(v);p.push((m*f+g*w)*i+e,(m*-w+g*f)*i+t)}return this.dirty=!0,this._boundsDirty=!0,this},PIXI.Graphics.prototype.beginFill=function(e,t){return this.filling=!0,this.fillColor=e||0,this.fillAlpha=void 0===t?1:t,this.currentPath&&this.currentPath.shape.points.length<=2&&(this.currentPath.fill=this.filling,this.currentPath.fillColor=this.fillColor,this.currentPath.fillAlpha=this.fillAlpha),this},PIXI.Graphics.prototype.endFill=function(){return this.filling=!1,this.fillColor=null,this.fillAlpha=1,this},PIXI.Graphics.prototype.drawRect=function(e,t,i,s){return this.drawShape(new PIXI.Rectangle(e,t,i,s)),this},PIXI.Graphics.prototype.drawRoundedRect=function(e,t,i,s,a){return this.drawShape(new PIXI.RoundedRectangle(e,t,i,s,a)),this},PIXI.Graphics.prototype.drawCircle=function(e,t,i){return this.drawShape(new PIXI.Circle(e,t,i)),this},PIXI.Graphics.prototype.drawEllipse=function(e,t,i,s){return this.drawShape(new PIXI.Ellipse(e,t,i,s)),this},PIXI.Graphics.prototype.drawPolygon=function(e){(e instanceof i.Polygon||e instanceof PIXI.Polygon)&&(e=e.points);var t=e;if(!Array.isArray(t)){t=new Array(arguments.length);for(var s=0;s<t.length;++s)t[s]=arguments[s]}return this.drawShape(new i.Polygon(t)),this},PIXI.Graphics.prototype.clear=function(){return this.lineWidth=0,this.filling=!1,this.dirty=!0,this._boundsDirty=!0,this.clearDirty=!0,this.graphicsData=[],this.updateLocalBounds(),this},PIXI.Graphics.prototype.generateTexture=function(e,t,i){void 0===e&&(e=1),void 0===t&&(t=PIXI.scaleModes.DEFAULT),void 0===i&&(i=0);var s=this.getBounds();s.width+=i,s.height+=i;var a=new PIXI.CanvasBuffer(s.width*e,s.height*e),n=PIXI.Texture.fromCanvas(a.canvas,t);return n.baseTexture.resolution=e,a.context.scale(e,e),a.context.translate(-s.x,-s.y),PIXI.CanvasGraphics.renderGraphics(this,a.context),n},PIXI.Graphics.prototype._renderWebGL=function(e){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask){if(this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.worldAlpha=this.worldAlpha,void PIXI.Sprite.prototype._renderWebGL.call(this._cachedSprite,e);if(e.spriteBatch.stop(),e.blendModeManager.setBlendMode(this.blendMode),this._mask&&e.maskManager.pushMask(this._mask,e),this._filters&&e.filterManager.pushFilter(this._filterBlock),this.blendMode!==e.spriteBatch.currentBlendMode){e.spriteBatch.currentBlendMode=this.blendMode;var t=PIXI.blendModesWebGL[e.spriteBatch.currentBlendMode];e.spriteBatch.gl.blendFunc(t[0],t[1])}if(this.webGLDirty&&(this.dirty=!0,this.webGLDirty=!1),PIXI.WebGLGraphics.renderGraphics(this,e),this.children.length){e.spriteBatch.start();for(var i=0;i<this.children.length;i++)this.children[i]._renderWebGL(e);e.spriteBatch.stop()}this._filters&&e.filterManager.popFilter(),this._mask&&e.maskManager.popMask(this.mask,e),e.drawCount++,e.spriteBatch.start()}},PIXI.Graphics.prototype._renderCanvas=function(e){if(!1!==this.visible&&0!==this.alpha&&!0!==this.isMask){if(this._prevTint!==this.tint&&(this.dirty=!0,this._prevTint=this.tint),this._cacheAsBitmap)return(this.dirty||this.cachedSpriteDirty)&&(this._generateCachedSprite(),this.updateCachedSpriteTexture(),this.cachedSpriteDirty=!1,this.dirty=!1),this._cachedSprite.alpha=this.alpha,void PIXI.Sprite.prototype._renderCanvas.call(this._cachedSprite,e);var t=e.context,i=this.worldTransform;this.blendMode!==e.currentBlendMode&&(e.currentBlendMode=this.blendMode,t.globalCompositeOperation=PIXI.blendModesCanvas[e.currentBlendMode]),this._mask&&e.maskManager.pushMask(this._mask,e);var s=e.resolution,a=i.tx*e.resolution+e.shakeX,n=i.ty*e.resolution+e.shakeY;t.setTransform(i.a*s,i.b*s,i.c*s,i.d*s,a,n),PIXI.CanvasGraphics.renderGraphics(this,t);for(var o=0;o<this.children.length;o++)this.children[o]._renderCanvas(e);this._mask&&e.maskManager.popMask(e)}},PIXI.Graphics.prototype.getBounds=function(e){if(!this._currentBounds){if(!this.renderable)return PIXI.EmptyRectangle;this.dirty&&(this.updateLocalBounds(),this.webGLDirty=!0,this.cachedSpriteDirty=!0,this.dirty=!1);var t=this._localBounds,i=t.x,s=t.width+t.x,a=t.y,n=t.height+t.y,o=e||this.worldTransform,r=o.a,l=o.b,h=o.c,c=o.d,p=o.tx,d=o.ty,u=r*s+h*n+p,m=c*n+l*s+d,g=r*i+h*n+p,y=c*n+l*i+d,b=r*i+h*a+p,x=c*a+l*i+d,v=r*s+h*a+p,f=c*a+l*s+d,w=u,k=m,_=u,S=m;_=v<(_=b<(_=g<_?g:_)?b:_)?v:_,S=f<(S=x<(S=y<S?y:S)?x:S)?f:S,w=v>(w=b>(w=g>w?g:w)?b:w)?v:w,k=f>(k=x>(k=y>k?y:k)?x:k)?f:k,this._bounds.x=_,this._bounds.width=w-_,this._bounds.y=S,this._bounds.height=k-S,this._currentBounds=this._bounds}return this._currentBounds},PIXI.Graphics.prototype.getLocalBounds=function(){var e=this.worldTransform;this.worldTransform=PIXI.identityMatrix;for(var t=0;t<this.children.length;t++)this.children[t].updateTransform();var i=this.getBounds();for(this.worldTransform=e,t=0;t<this.children.length;t++)this.children[t].updateTransform();return i},PIXI.Graphics.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,tempPoint);for(var t=this.graphicsData,i=0;i<t.length;i++){var s=t[i];if(s.fill&&s.shape&&s.shape.contains(tempPoint.x,tempPoint.y))return!0}return!1},PIXI.Graphics.prototype.updateLocalBounds=function(){var e=1/0,t=-1/0,s=1/0,a=-1/0;if(this.graphicsData.length)for(var n,o,r,l,h,c,p=0;p<this.graphicsData.length;p++){var d=this.graphicsData[p],u=d.type,m=d.lineWidth;if(n=d.shape,u===PIXI.Graphics.RECT||u===PIXI.Graphics.RREC)r=n.x-m/2,l=n.y-m/2,h=n.width+m,c=n.height+m,e=r<e?r:e,t=r+h>t?r+h:t,s=l<s?l:s,a=l+c>a?l+c:a;else if(u===PIXI.Graphics.CIRC)r=n.x,l=n.y,h=n.radius+m/2,c=n.radius+m/2,e=r-h<e?r-h:e,t=r+h>t?r+h:t,s=l-c<s?l-c:s,a=l+c>a?l+c:a;else if(u===PIXI.Graphics.ELIP)r=n.x,l=n.y,h=n.width+m/2,c=n.height+m/2,e=r-h<e?r-h:e,t=r+h>t?r+h:t,s=l-c<s?l-c:s,a=l+c>a?l+c:a;else{o=n.points;for(var g=0;g<o.length;g++)o[g]instanceof i.Point?(r=o[g].x,l=o[g].y):(r=o[g],l=o[g+1],g<o.length-1&&g++),e=r-m<e?r-m:e,t=r+m>t?r+m:t,s=l-m<s?l-m:s,a=l+m>a?l+m:a}}else e=0,t=0,s=0,a=0;var y=this.boundsPadding;this._localBounds.x=e-y,this._localBounds.width=t-e+2*y,this._localBounds.y=s-y,this._localBounds.height=a-s+2*y},PIXI.Graphics.prototype._generateCachedSprite=function(){var e=this.getLocalBounds();if(this._cachedSprite)this._cachedSprite.buffer.resize(e.width,e.height);else{var t=new PIXI.CanvasBuffer(e.width,e.height),i=PIXI.Texture.fromCanvas(t.canvas);this._cachedSprite=new PIXI.Sprite(i),this._cachedSprite.buffer=t,this._cachedSprite.worldTransform=this.worldTransform}this._cachedSprite.anchor.x=-e.x/e.width,this._cachedSprite.anchor.y=-e.y/e.height,this._cachedSprite.buffer.context.translate(-e.x,-e.y),this.worldAlpha=1,PIXI.CanvasGraphics.renderGraphics(this,this._cachedSprite.buffer.context),this._cachedSprite.alpha=this.alpha},PIXI.Graphics.prototype.updateCachedSpriteTexture=function(){var e=this._cachedSprite,t=e.texture,i=e.buffer.canvas;t.baseTexture.width=i.width,t.baseTexture.height=i.height,t.crop.width=t.frame.width=i.width,t.crop.height=t.frame.height=i.height,e._width=i.width,e._height=i.height,t.baseTexture.dirty()},PIXI.Graphics.prototype.destroyCachedSprite=function(){this._cachedSprite.texture.destroy(!0),this._cachedSprite=null},PIXI.Graphics.prototype.drawShape=function(e){this.currentPath&&this.currentPath.shape.points.length<=2&&this.graphicsData.pop(),this.currentPath=null,e instanceof i.Polygon&&(e=e.clone()).flatten();var t=new PIXI.GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.filling,e);return this.graphicsData.push(t),t.type===PIXI.Graphics.POLY&&(t.shape.closed=this.filling,this.currentPath=t),this.dirty=!0,this._boundsDirty=!0,t},Object.defineProperty(PIXI.Graphics.prototype,"cacheAsBitmap",{get:function(){return this._cacheAsBitmap},set:function(e){this._cacheAsBitmap=e,this._cacheAsBitmap?this._generateCachedSprite():this.destroyCachedSprite(),this.dirty=!0,this.webGLDirty=!0}}),PIXI.GraphicsData=function(e,t,i,s,a,n,o){this.lineWidth=e,this.lineColor=t,this.lineAlpha=i,this._lineTint=t,this.fillColor=s,this.fillAlpha=a,this._fillTint=s,this.fill=n,this.shape=o,this.type=o.type},PIXI.GraphicsData.prototype.constructor=PIXI.GraphicsData,PIXI.GraphicsData.prototype.clone=function(){return new GraphicsData(this.lineWidth,this.lineColor,this.lineAlpha,this.fillColor,this.fillAlpha,this.fill,this.shape)},PIXI.EarCut={},PIXI.EarCut.Triangulate=function(e,t,i){i=i||2;var s=t&&t.length,a=s?t[0]*i:e.length,n=PIXI.EarCut.linkedList(e,0,a,i,!0),o=[];if(!n)return o;var r,l,h,c,p,d,u;if(s&&(n=PIXI.EarCut.eliminateHoles(e,t,n,i)),e.length>80*i){r=h=e[0],l=c=e[1];for(var m=i;m<a;m+=i)p=e[m],d=e[m+1],p<r&&(r=p),d<l&&(l=d),p>h&&(h=p),d>c&&(c=d);u=Math.max(h-r,c-l)}return PIXI.EarCut.earcutLinked(n,o,i,r,l,u),o},PIXI.EarCut.linkedList=function(e,t,i,s,a){var n,o,r,l=0;for(n=t,o=i-s;n<i;n+=s)l+=(e[o]-e[n])*(e[n+1]+e[o+1]),o=n;if(a===l>0)for(n=t;n<i;n+=s)r=PIXI.EarCut.insertNode(n,e[n],e[n+1],r);else for(n=i-s;n>=t;n-=s)r=PIXI.EarCut.insertNode(n,e[n],e[n+1],r);return r},PIXI.EarCut.filterPoints=function(e,t){if(!e)return e;t||(t=e);var i,s=e;do{if(i=!1,s.steiner||!PIXI.EarCut.equals(s,s.next)&&0!==PIXI.EarCut.area(s.prev,s,s.next))s=s.next;else{if(PIXI.EarCut.removeNode(s),(s=t=s.prev)===s.next)return null;i=!0}}while(i||s!==t);return t},PIXI.EarCut.earcutLinked=function(e,t,i,s,a,n,o){if(e){!o&&n&&PIXI.EarCut.indexCurve(e,s,a,n);for(var r,l,h=e;e.prev!==e.next;)if(r=e.prev,l=e.next,n?PIXI.EarCut.isEarHashed(e,s,a,n):PIXI.EarCut.isEar(e))t.push(r.i/i),t.push(e.i/i),t.push(l.i/i),PIXI.EarCut.removeNode(e),e=l.next,h=l.next;else if((e=l)===h){o?1===o?(e=PIXI.EarCut.cureLocalIntersections(e,t,i),PIXI.EarCut.earcutLinked(e,t,i,s,a,n,2)):2===o&&PIXI.EarCut.splitEarcut(e,t,i,s,a,n):PIXI.EarCut.earcutLinked(PIXI.EarCut.filterPoints(e),t,i,s,a,n,1);break}}},PIXI.EarCut.isEar=function(e){var t=e.prev,i=e,s=e.next;if(PIXI.EarCut.area(t,i,s)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(PIXI.EarCut.pointInTriangle(t.x,t.y,i.x,i.y,s.x,s.y,a.x,a.y)&&PIXI.EarCut.area(a.prev,a,a.next)>=0)return!1;a=a.next}return!0},PIXI.EarCut.isEarHashed=function(e,t,i,s){var a=e.prev,n=e,o=e.next;if(PIXI.EarCut.area(a,n,o)>=0)return!1;for(var r=a.x<n.x?a.x<o.x?a.x:o.x:n.x<o.x?n.x:o.x,l=a.y<n.y?a.y<o.y?a.y:o.y:n.y<o.y?n.y:o.y,h=a.x>n.x?a.x>o.x?a.x:o.x:n.x>o.x?n.x:o.x,c=a.y>n.y?a.y>o.y?a.y:o.y:n.y>o.y?n.y:o.y,p=PIXI.EarCut.zOrder(r,l,t,i,s),d=PIXI.EarCut.zOrder(h,c,t,i,s),u=e.nextZ;u&&u.z<=d;){if(u!==e.prev&&u!==e.next&&PIXI.EarCut.pointInTriangle(a.x,a.y,n.x,n.y,o.x,o.y,u.x,u.y)&&PIXI.EarCut.area(u.prev,u,u.next)>=0)return!1;u=u.nextZ}for(u=e.prevZ;u&&u.z>=p;){if(u!==e.prev&&u!==e.next&&PIXI.EarCut.pointInTriangle(a.x,a.y,n.x,n.y,o.x,o.y,u.x,u.y)&&PIXI.EarCut.area(u.prev,u,u.next)>=0)return!1;u=u.prevZ}return!0},PIXI.EarCut.cureLocalIntersections=function(e,t,i){var s=e;do{var a=s.prev,n=s.next.next;PIXI.EarCut.intersects(a,s,s.next,n)&&PIXI.EarCut.locallyInside(a,n)&&PIXI.EarCut.locallyInside(n,a)&&(t.push(a.i/i),t.push(s.i/i),t.push(n.i/i),PIXI.EarCut.removeNode(s),PIXI.EarCut.removeNode(s.next),s=e=n),s=s.next}while(s!==e);return s},PIXI.EarCut.splitEarcut=function(e,t,i,s,a,n){var o=e;do{for(var r=o.next.next;r!==o.prev;){if(o.i!==r.i&&PIXI.EarCut.isValidDiagonal(o,r)){var l=PIXI.EarCut.splitPolygon(o,r);return o=PIXI.EarCut.filterPoints(o,o.next),l=PIXI.EarCut.filterPoints(l,l.next),PIXI.EarCut.earcutLinked(o,t,i,s,a,n),void PIXI.EarCut.earcutLinked(l,t,i,s,a,n)}r=r.next}o=o.next}while(o!==e)},PIXI.EarCut.eliminateHoles=function(e,t,i,s){var a,n,o,r,l,h=[];for(a=0,n=t.length;a<n;a++)o=t[a]*s,r=a<n-1?t[a+1]*s:e.length,(l=PIXI.EarCut.linkedList(e,o,r,s,!1))===l.next&&(l.steiner=!0),h.push(PIXI.EarCut.getLeftmost(l));for(h.sort(compareX),a=0;a<h.length;a++)PIXI.EarCut.eliminateHole(h[a],i),i=PIXI.EarCut.filterPoints(i,i.next);return i},PIXI.EarCut.compareX=function(e,t){return e.x-t.x},PIXI.EarCut.eliminateHole=function(e,t){if(t=PIXI.EarCut.findHoleBridge(e,t)){var i=PIXI.EarCut.splitPolygon(t,e);PIXI.EarCut.filterPoints(i,i.next)}},PIXI.EarCut.findHoleBridge=function(e,t){var i,s=t,a=e.x,n=e.y,o=-1/0;do{if(n<=s.y&&n>=s.next.y){var r=s.x+(n-s.y)*(s.next.x-s.x)/(s.next.y-s.y);r<=a&&r>o&&(o=r,i=s.x<s.next.x?s:s.next)}s=s.next}while(s!==t);if(!i)return null;if(e.x===i.x)return i.prev;var l,h=i,c=1/0;for(s=i.next;s!==h;)a>=s.x&&s.x>=i.x&&PIXI.EarCut.pointInTriangle(n<i.y?a:o,n,i.x,i.y,n<i.y?o:a,n,s.x,s.y)&&((l=Math.abs(n-s.y)/(a-s.x))<c||l===c&&s.x>i.x)&&PIXI.EarCut.locallyInside(s,e)&&(i=s,c=l),s=s.next;return i},PIXI.EarCut.indexCurve=function(e,t,i,s){var a=e;do{null===a.z&&(a.z=PIXI.EarCut.zOrder(a.x,a.y,t,i,s)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,PIXI.EarCut.sortLinked(a)},PIXI.EarCut.sortLinked=function(e){var t,i,s,a,n,o,r,l,h=1;do{for(i=e,e=null,n=null,o=0;i;){for(o++,s=i,r=0,t=0;t<h&&(r++,s=s.nextZ);t++);for(l=h;r>0||l>0&&s;)0===r?(a=s,s=s.nextZ,l--):0!==l&&s?i.z<=s.z?(a=i,i=i.nextZ,r--):(a=s,s=s.nextZ,l--):(a=i,i=i.nextZ,r--),n?n.nextZ=a:e=a,a.prevZ=n,n=a;i=s}n.nextZ=null,h*=2}while(o>1);return e},PIXI.EarCut.zOrder=function(e,t,i,s,a){return e=32767*(e-i)/a,t=32767*(t-s)/a,e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e|t<<1},PIXI.EarCut.getLeftmost=function(e){var t=e,i=e;do{t.x<i.x&&(i=t),t=t.next}while(t!==e);return i},PIXI.EarCut.pointInTriangle=function(e,t,i,s,a,n,o,r){return(a-o)*(t-r)-(e-o)*(n-r)>=0&&(e-o)*(s-r)-(i-o)*(t-r)>=0&&(i-o)*(n-r)-(a-o)*(s-r)>=0},PIXI.EarCut.isValidDiagonal=function(e,t){return PIXI.EarCut.equals(e,t)||e.next.i!==t.i&&e.prev.i!==t.i&&!PIXI.EarCut.intersectsPolygon(e,t)&&PIXI.EarCut.locallyInside(e,t)&&PIXI.EarCut.locallyInside(t,e)&&PIXI.EarCut.middleInside(e,t)},PIXI.EarCut.area=function(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)},PIXI.EarCut.equals=function(e,t){return e.x===t.x&&e.y===t.y},PIXI.EarCut.intersects=function(e,t,i,s){return PIXI.EarCut.area(e,t,i)>0!=PIXI.EarCut.area(e,t,s)>0&&PIXI.EarCut.area(i,s,e)>0!=PIXI.EarCut.area(i,s,t)>0},PIXI.EarCut.intersectsPolygon=function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&PIXI.EarCut.intersects(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1},PIXI.EarCut.locallyInside=function(e,t){return PIXI.EarCut.area(e.prev,e,e.next)<0?PIXI.EarCut.area(e,t,e.next)>=0&&PIXI.EarCut.area(e,e.prev,t)>=0:PIXI.EarCut.area(e,t,e.prev)<0||PIXI.EarCut.area(e,e.next,t)<0},PIXI.EarCut.middleInside=function(e,t){var i=e,s=!1,a=(e.x+t.x)/2,n=(e.y+t.y)/2;do{i.y>n!=i.next.y>n&&a<(i.next.x-i.x)*(n-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next}while(i!==e);return s},PIXI.EarCut.splitPolygon=function(e,t){var i=new PIXI.EarCut.Node(e.i,e.x,e.y),s=new PIXI.EarCut.Node(t.i,t.x,t.y),a=e.next,n=t.prev;return e.next=t,t.prev=e,i.next=a,a.prev=i,s.next=i,i.prev=s,n.next=s,s.prev=n,s},PIXI.EarCut.insertNode=function(e,t,i,s){var a=new PIXI.EarCut.Node(e,t,i);return s?(a.next=s.next,a.prev=s,s.next.prev=a,s.next=a):(a.prev=a,a.next=a),a},PIXI.EarCut.removeNode=function(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)},PIXI.EarCut.Node=function(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1},PIXI.WebGLGraphics=function(){},PIXI.WebGLGraphics.stencilBufferLimit=6,PIXI.WebGLGraphics.renderGraphics=function(e,t){var i,s=t.gl,a=t.projection,n=t.offset,o=t.shaderManager.primitiveShader;e.dirty&&PIXI.WebGLGraphics.updateGraphics(e,s);for(var r=e._webGL[s.id],l=0;l<r.data.length;l++)1===r.data[l].mode?(i=r.data[l],t.stencilManager.pushStencil(e,i,t),s.drawElements(s.TRIANGLE_FAN,4,s.UNSIGNED_SHORT,2*(i.indices.length-4)),t.stencilManager.popStencil(e,i,t)):(i=r.data[l],t.shaderManager.setShader(o),o=t.shaderManager.primitiveShader,s.uniformMatrix3fv(o.translationMatrix,!1,e.worldTransform.toArray(!0)),s.uniform1f(o.flipY,1),s.uniform2f(o.projectionVector,a.x,-a.y),s.uniform2f(o.offsetVector,-n.x,-n.y),s.uniform3fv(o.tintColor,PIXI.hex2rgb(e.tint)),s.uniform1f(o.alpha,e.worldAlpha),s.bindBuffer(s.ARRAY_BUFFER,i.buffer),s.vertexAttribPointer(o.aVertexPosition,2,s.FLOAT,!1,24,0),s.vertexAttribPointer(o.colorAttribute,4,s.FLOAT,!1,24,8),s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,i.indexBuffer),s.drawElements(s.TRIANGLE_STRIP,i.indices.length,s.UNSIGNED_SHORT,0))},PIXI.WebGLGraphics.updateGraphics=function(e,t){var i=e._webGL[t.id];i||(i=e._webGL[t.id]={lastIndex:0,data:[],gl:t}),e.dirty=!1;var s;if(e.clearDirty){for(e.clearDirty=!1,s=0;s<i.data.length;s++){var a=i.data[s];a.reset(),PIXI.WebGLGraphics.graphicsDataPool.push(a)}i.data=[],i.lastIndex=0}var n;for(s=i.lastIndex;s<e.graphicsData.length;s++){var o=e.graphicsData[s];o.type===PIXI.Graphics.POLY?(o.points=o.shape.points.slice(),o.shape.closed&&(o.points[0]===o.points[o.points.length-2]&&o.points[1]===o.points[o.points.length-1]||o.points.push(o.points[0],o.points[1])),o.fill&&o.points.length>=PIXI.WebGLGraphics.stencilBufferLimit&&(o.points.length<2*PIXI.WebGLGraphics.stencilBufferLimit?(n=PIXI.WebGLGraphics.switchMode(i,0),PIXI.WebGLGraphics.buildPoly(o,n)||(n=PIXI.WebGLGraphics.switchMode(i,1),PIXI.WebGLGraphics.buildComplexPoly(o,n))):(n=PIXI.WebGLGraphics.switchMode(i,1),PIXI.WebGLGraphics.buildComplexPoly(o,n))),o.lineWidth>0&&(n=PIXI.WebGLGraphics.switchMode(i,0),PIXI.WebGLGraphics.buildLine(o,n))):(n=PIXI.WebGLGraphics.switchMode(i,0),o.type===PIXI.Graphics.RECT?PIXI.WebGLGraphics.buildRectangle(o,n):o.type===PIXI.Graphics.CIRC||o.type===PIXI.Graphics.ELIP?PIXI.WebGLGraphics.buildCircle(o,n):o.type===PIXI.Graphics.RREC&&PIXI.WebGLGraphics.buildRoundedRectangle(o,n)),i.lastIndex++}for(s=0;s<i.data.length;s++)(n=i.data[s]).dirty&&n.upload()},PIXI.WebGLGraphics.switchMode=function(e,t){var i;return e.data.length?(i=e.data[e.data.length-1]).mode===t&&1!==t||(i=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(e.gl),i.mode=t,e.data.push(i)):(i=PIXI.WebGLGraphics.graphicsDataPool.pop()||new PIXI.WebGLGraphicsData(e.gl),i.mode=t,e.data.push(i)),i.dirty=!0,i},PIXI.WebGLGraphics.buildRectangle=function(e,t){var i=e.shape,s=i.x,a=i.y,n=i.width,o=i.height;if(e.fill){var r=PIXI.hex2rgb(e.fillColor),l=e.fillAlpha,h=r[0]*l,c=r[1]*l,p=r[2]*l,d=t.points,u=t.indices,m=d.length/6;d.push(s,a),d.push(h,c,p,l),d.push(s+n,a),d.push(h,c,p,l),d.push(s,a+o),d.push(h,c,p,l),d.push(s+n,a+o),d.push(h,c,p,l),u.push(m,m,m+1,m+2,m+3,m+3)}if(e.lineWidth){var g=e.points;e.points=[s,a,s+n,a,s+n,a+o,s,a+o,s,a],PIXI.WebGLGraphics.buildLine(e,t),e.points=g}},PIXI.WebGLGraphics.buildRoundedRectangle=function(e,t){var i=e.shape,s=i.x,a=i.y,n=i.width,o=i.height,r=i.radius,l=[];if(l.push(s,a+r),l=l.concat(PIXI.WebGLGraphics.quadraticBezierCurve(s,a+o-r,s,a+o,s+r,a+o)),l=l.concat(PIXI.WebGLGraphics.quadraticBezierCurve(s+n-r,a+o,s+n,a+o,s+n,a+o-r)),l=l.concat(PIXI.WebGLGraphics.quadraticBezierCurve(s+n,a+r,s+n,a,s+n-r,a)),l=l.concat(PIXI.WebGLGraphics.quadraticBezierCurve(s+r,a,s,a,s,a+r)),e.fill){var h=PIXI.hex2rgb(e.fillColor),c=e.fillAlpha,p=h[0]*c,d=h[1]*c,u=h[2]*c,m=t.points,g=t.indices,y=m.length/6,b=PIXI.EarCut.Triangulate(l,null,2),x=0;for(x=0;x<b.length;x+=3)g.push(b[x]+y),g.push(b[x]+y),g.push(b[x+1]+y),g.push(b[x+2]+y),g.push(b[x+2]+y);for(x=0;x<l.length;x++)m.push(l[x],l[++x],p,d,u,c)}if(e.lineWidth){var v=e.points;e.points=l,PIXI.WebGLGraphics.buildLine(e,t),e.points=v}},PIXI.WebGLGraphics.quadraticBezierCurve=function(e,t,i,s,a,n){function o(e,t,i){return e+(t-e)*i}for(var r,l,h,c,p,d,u=[],m=0,g=0;g<=20;g++)m=g/20,r=o(e,i,m),l=o(t,s,m),h=o(i,a,m),c=o(s,n,m),p=o(r,h,m),d=o(l,c,m),u.push(p,d);return u},PIXI.WebGLGraphics.buildCircle=function(e,t){var i,s,a=e.shape,n=a.x,o=a.y;e.type===PIXI.Graphics.CIRC?(i=a.radius,s=a.radius):(i=a.width,s=a.height);var r=2*Math.PI/40,l=0;if(e.fill){var h=PIXI.hex2rgb(e.fillColor),c=e.fillAlpha,p=h[0]*c,d=h[1]*c,u=h[2]*c,m=t.points,g=t.indices,y=m.length/6;for(g.push(y),l=0;l<41;l++)m.push(n,o,p,d,u,c),m.push(n+Math.sin(r*l)*i,o+Math.cos(r*l)*s,p,d,u,c),g.push(y++,y++);g.push(y-1)}if(e.lineWidth){var b=e.points;for(e.points=[],l=0;l<41;l++)e.points.push(n+Math.sin(r*l)*i,o+Math.cos(r*l)*s);PIXI.WebGLGraphics.buildLine(e,t),e.points=b}},PIXI.WebGLGraphics.buildLine=function(e,t){var i=0,s=e.points;if(0!==s.length){if(e.lineWidth%2)for(i=0;i<s.length;i++)s[i]+=.5;var a=new PIXI.Point(s[0],s[1]),n=new PIXI.Point(s[s.length-2],s[s.length-1]);if(a.x===n.x&&a.y===n.y){(s=s.slice()).pop(),s.pop();var o=(n=new PIXI.Point(s[s.length-2],s[s.length-1])).x+.5*(a.x-n.x),r=n.y+.5*(a.y-n.y);s.unshift(o,r),s.push(o,r)}var l,h,c,p,d,u,m,g,y,b,x,v,f,w,k,_,S,M,A,C,P,T,X=t.points,Y=t.indices,G=s.length/2,B=s.length,L=X.length/6,E=e.lineWidth/2,R=PIXI.hex2rgb(e.lineColor),D=e.lineAlpha,F=R[0]*D,I=R[1]*D,V=R[2]*D;for(c=s[0],p=s[1],d=s[2],y=-(p-(u=s[3])),b=c-d,y/=T=Math.sqrt(y*y+b*b),b/=T,y*=E,b*=E,X.push(c-y,p-b,F,I,V,D),X.push(c+y,p+b,F,I,V,D),i=1;i<G-1;i++)c=s[2*(i-1)],p=s[2*(i-1)+1],d=s[2*i],u=s[2*i+1],m=s[2*(i+1)],g=s[2*(i+1)+1],y=-(p-u),b=c-d,T=Math.sqrt(y*y+b*b),y/=T,b/=T,y*=E,b*=E,x=-(u-g),v=d-m,T=Math.sqrt(x*x+v*v),x/=T,v/=T,x*=E,v*=E,k=-b+p-(-b+u),_=-y+d-(-y+c),S=(-y+c)*(-b+u)-(-y+d)*(-b+p),M=-v+g-(-v+u),A=-x+d-(-x+m),C=(-x+m)*(-v+u)-(-x+d)*(-v+g),P=k*A-M*_,Math.abs(P)<.1?(P+=10.1,X.push(d-y,u-b,F,I,V,D),X.push(d+y,u+b,F,I,V,D)):(l=(_*C-A*S)/P,h=(M*S-k*C)/P,(l-d)*(l-d)+(h-u)+(h-u)>19600?(f=y-x,w=b-v,T=Math.sqrt(f*f+w*w),f/=T,w/=T,f*=E,w*=E,X.push(d-f,u-w),X.push(F,I,V,D),X.push(d+f,u+w),X.push(F,I,V,D),X.push(d-f,u-w),X.push(F,I,V,D),B++):(X.push(l,h),X.push(F,I,V,D),X.push(d-(l-d),u-(h-u)),X.push(F,I,V,D)));for(c=s[2*(G-2)],p=s[2*(G-2)+1],d=s[2*(G-1)],y=-(p-(u=s[2*(G-1)+1])),b=c-d,y/=T=Math.sqrt(y*y+b*b),b/=T,y*=E,b*=E,X.push(d-y,u-b),X.push(F,I,V,D),X.push(d+y,u+b),X.push(F,I,V,D),Y.push(L),i=0;i<B;i++)Y.push(L++);Y.push(L-1)}},PIXI.WebGLGraphics.buildComplexPoly=function(e,t){var i=e.points.slice();if(!(i.length<6)){var s=t.indices;t.points=i,t.alpha=e.fillAlpha,t.color=PIXI.hex2rgb(e.fillColor);for(var a,n,o=1/0,r=-1/0,l=1/0,h=-1/0,c=0;c<i.length;c+=2)a=i[c],n=i[c+1],o=a<o?a:o,r=a>r?a:r,l=n<l?n:l,h=n>h?n:h;i.push(o,l,r,l,r,h,o,h);var p=i.length/2;for(c=0;c<p;c++)s.push(c)}},PIXI.WebGLGraphics.buildPoly=function(e,t){var i=e.points;if(!(i.length<6)){var s=t.points,a=t.indices,n=i.length/2,o=PIXI.hex2rgb(e.fillColor),r=e.fillAlpha,l=o[0]*r,h=o[1]*r,c=o[2]*r,p=PIXI.EarCut.Triangulate(i,null,2);if(!p)return!1;var d=s.length/6,u=0;for(u=0;u<p.length;u+=3)a.push(p[u]+d),a.push(p[u]+d),a.push(p[u+1]+d),a.push(p[u+2]+d),a.push(p[u+2]+d);for(u=0;u<n;u++)s.push(i[2*u],i[2*u+1],l,h,c,r);return!0}},PIXI.WebGLGraphics.graphicsDataPool=[],PIXI.WebGLGraphicsData=function(e){this.gl=e,this.color=[0,0,0],this.points=[],this.indices=[],this.buffer=e.createBuffer(),this.indexBuffer=e.createBuffer(),this.mode=1,this.alpha=1,this.dirty=!0},PIXI.WebGLGraphicsData.prototype.reset=function(){this.points=[],this.indices=[]},PIXI.WebGLGraphicsData.prototype.upload=function(){var e=this.gl;this.glPoints=new PIXI.Float32Array(this.points),e.bindBuffer(e.ARRAY_BUFFER,this.buffer),e.bufferData(e.ARRAY_BUFFER,this.glPoints,e.STATIC_DRAW),this.glIndicies=new PIXI.Uint16Array(this.indices),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.glIndicies,e.STATIC_DRAW),this.dirty=!1},PIXI.CanvasGraphics=function(){},PIXI.CanvasGraphics.renderGraphics=function(e,t){var i=e.worldAlpha;e.dirty&&(this.updateGraphicsTint(e),e.dirty=!1);for(var s=0;s<e.graphicsData.length;s++){var a=e.graphicsData[s],n=a.shape,o=a._fillTint,r=a._lineTint;if(t.lineWidth=a.lineWidth,a.type===PIXI.Graphics.POLY){t.beginPath();var l=n.points;t.moveTo(l[0],l[1]);for(var h=1;h<l.length/2;h++)t.lineTo(l[2*h],l[2*h+1]);n.closed&&t.lineTo(l[0],l[1]),l[0]===l[l.length-2]&&l[1]===l[l.length-1]&&t.closePath(),a.fill&&(t.globalAlpha=a.fillAlpha*i,t.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),t.fill()),a.lineWidth&&(t.globalAlpha=a.lineAlpha*i,t.strokeStyle="#"+("00000"+(0|r).toString(16)).substr(-6),t.stroke())}else if(a.type===PIXI.Graphics.RECT)(a.fillColor||0===a.fillColor)&&(t.globalAlpha=a.fillAlpha*i,t.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),t.fillRect(n.x,n.y,n.width,n.height)),a.lineWidth&&(t.globalAlpha=a.lineAlpha*i,t.strokeStyle="#"+("00000"+(0|r).toString(16)).substr(-6),t.strokeRect(n.x,n.y,n.width,n.height));else if(a.type===PIXI.Graphics.CIRC)t.beginPath(),t.arc(n.x,n.y,n.radius,0,2*Math.PI),t.closePath(),a.fill&&(t.globalAlpha=a.fillAlpha*i,t.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),t.fill()),a.lineWidth&&(t.globalAlpha=a.lineAlpha*i,t.strokeStyle="#"+("00000"+(0|r).toString(16)).substr(-6),t.stroke());else if(a.type===PIXI.Graphics.ELIP){var c=2*n.width,p=2*n.height,d=n.x-c/2,u=n.y-p/2;t.beginPath();var m=.5522848,g=c/2*m,y=p/2*m,b=d+c,x=u+p,v=d+c/2,f=u+p/2;t.moveTo(d,f),t.bezierCurveTo(d,f-y,v-g,u,v,u),t.bezierCurveTo(v+g,u,b,f-y,b,f),t.bezierCurveTo(b,f+y,v+g,x,v,x),t.bezierCurveTo(v-g,x,d,f+y,d,f),t.closePath(),a.fill&&(t.globalAlpha=a.fillAlpha*i,t.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),t.fill()),a.lineWidth&&(t.globalAlpha=a.lineAlpha*i,t.strokeStyle="#"+("00000"+(0|r).toString(16)).substr(-6),t.stroke())}else if(a.type===PIXI.Graphics.RREC){var w=n.x,k=n.y,_=n.width,S=n.height,M=n.radius,A=Math.min(_,S)/2|0;M=M>A?A:M,t.beginPath(),t.moveTo(w,k+M),t.lineTo(w,k+S-M),t.quadraticCurveTo(w,k+S,w+M,k+S),t.lineTo(w+_-M,k+S),t.quadraticCurveTo(w+_,k+S,w+_,k+S-M),t.lineTo(w+_,k+M),t.quadraticCurveTo(w+_,k,w+_-M,k),t.lineTo(w+M,k),t.quadraticCurveTo(w,k,w,k+M),t.closePath(),(a.fillColor||0===a.fillColor)&&(t.globalAlpha=a.fillAlpha*i,t.fillStyle="#"+("00000"+(0|o).toString(16)).substr(-6),t.fill()),a.lineWidth&&(t.globalAlpha=a.lineAlpha*i,t.strokeStyle="#"+("00000"+(0|r).toString(16)).substr(-6),t.stroke())}}},PIXI.CanvasGraphics.renderGraphicsMask=function(e,t){var i=e.graphicsData.length;if(0!==i){t.beginPath();for(var s=0;s<i;s++){var a=e.graphicsData[s],n=a.shape;if(a.type===PIXI.Graphics.POLY){var o=n.points;t.moveTo(o[0],o[1]);for(var r=1;r<o.length/2;r++)t.lineTo(o[2*r],o[2*r+1]);o[0]===o[o.length-2]&&o[1]===o[o.length-1]&&t.closePath()}else if(a.type===PIXI.Graphics.RECT)t.rect(n.x,n.y,n.width,n.height),t.closePath();else if(a.type===PIXI.Graphics.CIRC)t.arc(n.x,n.y,n.radius,0,2*Math.PI),t.closePath();else if(a.type===PIXI.Graphics.ELIP){var l=2*n.width,h=2*n.height,c=n.x-l/2,p=n.y-h/2,d=.5522848,u=l/2*d,m=h/2*d,g=c+l,y=p+h,b=c+l/2,x=p+h/2;t.moveTo(c,x),t.bezierCurveTo(c,x-m,b-u,p,b,p),t.bezierCurveTo(b+u,p,g,x-m,g,x),t.bezierCurveTo(g,x+m,b+u,y,b,y),t.bezierCurveTo(b-u,y,c,x+m,c,x),t.closePath()}else if(a.type===PIXI.Graphics.RREC){var v=n.x,f=n.y,w=n.width,k=n.height,_=n.radius,S=Math.min(w,k)/2|0;_=_>S?S:_,t.moveTo(v,f+_),t.lineTo(v,f+k-_),t.quadraticCurveTo(v,f+k,v+_,f+k),t.lineTo(v+w-_,f+k),t.quadraticCurveTo(v+w,f+k,v+w,f+k-_),t.lineTo(v+w,f+_),t.quadraticCurveTo(v+w,f,v+w-_,f),t.lineTo(v+_,f),t.quadraticCurveTo(v,f,v,f+_),t.closePath()}}}},PIXI.CanvasGraphics.updateGraphicsTint=function(e){if(16777215!==e.tint)for(var t=(e.tint>>16&255)/255,i=(e.tint>>8&255)/255,s=(255&e.tint)/255,a=0;a<e.graphicsData.length;a++){var n=e.graphicsData[a],o=0|n.fillColor,r=0|n.lineColor;n._fillTint=((o>>16&255)/255*t*255<<16)+((o>>8&255)/255*i*255<<8)+(255&o)/255*s*255,n._lineTint=((r>>16&255)/255*t*255<<16)+((r>>8&255)/255*i*255<<8)+(255&r)/255*s*255}},i.Graphics=function(e,t,s){void 0===t&&(t=0),void 0===s&&(s=0),this.type=i.GRAPHICS,this.physicsType=i.SPRITE,this.anchor=new i.Point,PIXI.Graphics.call(this),i.Component.Core.init.call(this,e,t,s,"",null)},i.Graphics.prototype=Object.create(PIXI.Graphics.prototype),i.Graphics.prototype.constructor=i.Graphics,i.Component.Core.install.call(i.Graphics.prototype,["Angle","AutoCull","Bounds","Destroy","FixedToCamera","InputEnabled","InWorld","LifeSpan","PhysicsBody","Reset"]),i.Graphics.prototype.preUpdatePhysics=i.Component.PhysicsBody.preUpdate,i.Graphics.prototype.preUpdateLifeSpan=i.Component.LifeSpan.preUpdate,i.Graphics.prototype.preUpdateInWorld=i.Component.InWorld.preUpdate,i.Graphics.prototype.preUpdateCore=i.Component.Core.preUpdate,i.Graphics.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},i.Graphics.prototype.postUpdate=function(){i.Component.PhysicsBody.postUpdate.call(this),i.Component.FixedToCamera.postUpdate.call(this),this._boundsDirty&&(this.updateLocalBounds(),this._boundsDirty=!1);for(var e=0;e<this.children.length;e++)this.children[e].postUpdate()},i.Graphics.prototype.destroy=function(e){this.clear(),i.Component.Destroy.prototype.destroy.call(this,e)},i.Graphics.prototype.drawTriangle=function(e,t){void 0===t&&(t=!1);var s=new i.Polygon(e);if(t){var a=new i.Point(this.game.camera.x-e[0].x,this.game.camera.y-e[0].y),n=new i.Point(e[1].x-e[0].x,e[1].y-e[0].y),o=new i.Point(e[1].x-e[2].x,e[1].y-e[2].y).cross(n);a.dot(o)>0&&this.drawPolygon(s)}else this.drawPolygon(s)},i.Graphics.prototype.drawTriangles=function(e,t,s){void 0===s&&(s=!1);var a,n=new i.Point,o=new i.Point,r=new i.Point,l=[];if(t)if(e[0]instanceof i.Point)for(a=0;a<t.length/3;a++)l.push(e[t[3*a]]),l.push(e[t[3*a+1]]),l.push(e[t[3*a+2]]),3===l.length&&(this.drawTriangle(l,s),l=[]);else for(a=0;a<t.length;a++)n.x=e[2*t[a]],n.y=e[2*t[a]+1],l.push(n.copyTo({})),3===l.length&&(this.drawTriangle(l,s),l=[]);else if(e[0]instanceof i.Point)for(a=0;a<e.length/3;a++)this.drawTriangle([e[3*a],e[3*a+1],e[3*a+2]],s);else for(a=0;a<e.length/6;a++)n.x=e[6*a+0],n.y=e[6*a+1],o.x=e[6*a+2],o.y=e[6*a+3],r.x=e[6*a+4],r.y=e[6*a+5],this.drawTriangle([n,o,r],s)},i.RenderTexture=function(e,t,s,a,n,o){void 0===a&&(a=""),void 0===n&&(n=i.scaleModes.DEFAULT),void 0===o&&(o=1),this.game=e,this.key=a,this.type=i.RENDERTEXTURE,this._tempMatrix=new PIXI.Matrix,PIXI.RenderTexture.call(this,t,s,this.game.renderer,n,o),this.render=i.RenderTexture.prototype.render},i.RenderTexture.prototype=Object.create(PIXI.RenderTexture.prototype),i.RenderTexture.prototype.constructor=i.RenderTexture,i.RenderTexture.prototype.renderXY=function(e,t,i,s){e.updateTransform(),this._tempMatrix.copyFrom(e.worldTransform),this._tempMatrix.tx=t,this._tempMatrix.ty=i,this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(e,this._tempMatrix,s):this.renderCanvas(e,this._tempMatrix,s)},i.RenderTexture.prototype.renderRawXY=function(e,t,i,s){this._tempMatrix.identity().translate(t,i),this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(e,this._tempMatrix,s):this.renderCanvas(e,this._tempMatrix,s)},i.RenderTexture.prototype.render=function(e,t,i){void 0===t||null===t?this._tempMatrix.copyFrom(e.worldTransform):this._tempMatrix.copyFrom(t),this.renderer.type===PIXI.WEBGL_RENDERER?this.renderWebGL(e,this._tempMatrix,i):this.renderCanvas(e,this._tempMatrix,i)},i.Text=function(e,t,s,a,n){t=t||0,s=s||0,a=void 0===a||null===a?"":a.toString(),n=i.Utils.extend({},n),this.type=i.TEXT,this.physicsType=i.SPRITE,this.padding=new i.Point,this.textBounds=null,this.canvas=PIXI.CanvasPool.create(this),this.context=this.canvas.getContext("2d"),this.colors=[],this.strokeColors=[],this.fontStyles=[],this.fontWeights=[],this.autoRound=!1,this.useAdvancedWrap=!1,this._res=e.renderer.resolution,this._text=a,this._fontComponents=null,this._lineSpacing=0,this._charCount=0,this._width=0,this._height=0,i.Sprite.call(this,e,t,s,PIXI.Texture.fromCanvas(this.canvas)),this.setStyle(n),""!==a&&this.updateText()},i.Text.prototype=Object.create(i.Sprite.prototype),i.Text.prototype.constructor=i.Text,i.Text.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},i.Text.prototype.update=function(){},i.Text.prototype.destroy=function(e){this.texture.destroy(!0),i.Component.Destroy.prototype.destroy.call(this,e)},i.Text.prototype.setShadow=function(e,t,i,s,a,n){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i="rgba(0, 0, 0, 1)"),void 0===s&&(s=0),void 0===a&&(a=!0),void 0===n&&(n=!0),this.style.shadowOffsetX=e,this.style.shadowOffsetY=t,this.style.shadowColor=i,this.style.shadowBlur=s,this.style.shadowStroke=a,this.style.shadowFill=n,this.dirty=!0,this},i.Text.prototype.setStyle=function(e,t){void 0===t&&(t=!1),(e=e||{}).font=e.font||"bold 20pt Arial",e.backgroundColor=e.backgroundColor||null,e.fill=e.fill||"black",e.align=e.align||"left",e.boundsAlignH=e.boundsAlignH||"left",e.boundsAlignV=e.boundsAlignV||"top",e.stroke=e.stroke||"black",e.strokeThickness=e.strokeThickness||0,e.wordWrap=e.wordWrap||!1,e.wordWrapWidth=e.wordWrapWidth||100,e.maxLines=e.maxLines||0,e.shadowOffsetX=e.shadowOffsetX||0,e.shadowOffsetY=e.shadowOffsetY||0,e.shadowColor=e.shadowColor||"rgba(0,0,0,0)",e.shadowBlur=e.shadowBlur||0,e.tabs=e.tabs||0;var i=this.fontToComponents(e.font);return e.fontStyle&&(i.fontStyle=e.fontStyle),e.fontVariant&&(i.fontVariant=e.fontVariant),e.fontWeight&&(i.fontWeight=e.fontWeight),e.fontSize&&("number"==typeof e.fontSize&&(e.fontSize=e.fontSize+"px"),i.fontSize=e.fontSize),this._fontComponents=i,e.font=this.componentsToFont(this._fontComponents),this.style=e,this.dirty=!0,t&&this.updateText(),this},i.Text.prototype.updateText=function(){this.texture.baseTexture.resolution=this._res,this.context.font=this.style.font;var e=this.text;this.style.wordWrap&&(e=this.runWordWrap(this.text));var t=e.split(/(?:\r\n|\r|\n)/),i=this.style.tabs,s=[],a=0,n=this.determineFontProperties(this.style.font),o=t.length;this.style.maxLines>0&&this.style.maxLines<t.length&&(o=this.style.maxLines),this._charCount=0;for(var r=0;r<o;r++){if(0===i){h=this.style.strokeThickness+this.padding.x;h+=this.colors.length>0||this.strokeColors.length>0||this.fontWeights.length>0||this.fontStyles.length>0?this.measureLine(t[r]):this.context.measureText(t[r]).width,this.style.wordWrap&&(h-=this.context.measureText(" ").width)}else{var l=t[r].split(/(?:\t)/),h=this.padding.x+this.style.strokeThickness;if(Array.isArray(i))for(var c=0,p=0;p<l.length;p++){var d=0;d=this.colors.length>0||this.strokeColors.length>0||this.fontWeights.length>0||this.fontStyles.length>0?this.measureLine(l[p]):Math.ceil(this.context.measureText(l[p]).width),p>0&&(c+=i[p-1]),h=c+d}else for(p=0;p<l.length;p++)h+=this.colors.length>0||this.strokeColors.length>0||this.fontWeights.length>0||this.fontStyles.length>0?this.measureLine(l[p]):Math.ceil(this.context.measureText(l[p]).width),h+=this.game.math.snapToCeil(h,i)-h}s[r]=Math.ceil(h),a=Math.max(a,s[r])}this.canvas.width=a*this._res;var u=n.fontSize+this.style.strokeThickness+this.padding.y,m=u*o,g=this._lineSpacing;g<0&&Math.abs(g)>u&&(g=-u),0!==g&&(m+=g>0?g*t.length:g*(t.length-1)),this.canvas.height=m*this._res,this.context.scale(this._res,this._res),navigator.isCocoonJS&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),this.style.backgroundColor&&(this.context.fillStyle=this.style.backgroundColor,this.context.fillRect(0,0,this.canvas.width,this.canvas.height)),this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.textBaseline="alphabetic",this.context.lineWidth=this.style.strokeThickness,this.context.lineCap="round",this.context.lineJoin="round";var y,b;for(this._charCount=0,r=0;r<o;r++)y=this.style.strokeThickness/2,b=this.style.strokeThickness/2+r*u+n.ascent,r>0&&(b+=g*r),"right"===this.style.align?y+=a-s[r]:"center"===this.style.align&&(y+=(a-s[r])/2),this.autoRound&&(y=Math.round(y),b=Math.round(b)),this.colors.length>0||this.strokeColors.length>0||this.fontWeights.length>0||this.fontStyles.length>0?this.updateLine(t[r],y,b):(this.style.stroke&&this.style.strokeThickness&&(this.updateShadow(this.style.shadowStroke),0===i?this.context.strokeText(t[r],y,b):this.renderTabLine(t[r],y,b,!1)),this.style.fill&&(this.updateShadow(this.style.shadowFill),0===i?this.context.fillText(t[r],y,b):this.renderTabLine(t[r],y,b,!0)));this.updateTexture(),this.dirty=!1},i.Text.prototype.renderTabLine=function(e,t,i,s){var a=e.split(/(?:\t)/),n=this.style.tabs,o=0;if(Array.isArray(n))for(var r=0,l=0;l<a.length;l++)l>0&&(r+=n[l-1]),o=t+r,s?this.context.fillText(a[l],o,i):this.context.strokeText(a[l],o,i);else for(l=0;l<a.length;l++){var h=Math.ceil(this.context.measureText(a[l]).width);o=this.game.math.snapToCeil(t,n),s?this.context.fillText(a[l],o,i):this.context.strokeText(a[l],o,i),t=o+h}},i.Text.prototype.updateShadow=function(e){e?(this.context.shadowOffsetX=this.style.shadowOffsetX,this.context.shadowOffsetY=this.style.shadowOffsetY,this.context.shadowColor=this.style.shadowColor,this.context.shadowBlur=this.style.shadowBlur):(this.context.shadowOffsetX=0,this.context.shadowOffsetY=0,this.context.shadowColor=0,this.context.shadowBlur=0)},i.Text.prototype.measureLine=function(e){for(var t=0,i=0;i<e.length;i++){var s=e[i];if(this.fontWeights.length>0||this.fontStyles.length>0){var a=this.fontToComponents(this.context.font);this.fontStyles[this._charCount]&&(a.fontStyle=this.fontStyles[this._charCount]),this.fontWeights[this._charCount]&&(a.fontWeight=this.fontWeights[this._charCount]),this.context.font=this.componentsToFont(a)}this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke)),this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill)),t+=this.context.measureText(s).width,this._charCount++}return Math.ceil(t)},i.Text.prototype.updateLine=function(e,t,i){for(var s=0;s<e.length;s++){var a=e[s];if(this.fontWeights.length>0||this.fontStyles.length>0){var n=this.fontToComponents(this.context.font);this.fontStyles[this._charCount]&&(n.fontStyle=this.fontStyles[this._charCount]),this.fontWeights[this._charCount]&&(n.fontWeight=this.fontWeights[this._charCount]),this.context.font=this.componentsToFont(n)}this.style.stroke&&this.style.strokeThickness&&(this.strokeColors[this._charCount]&&(this.context.strokeStyle=this.strokeColors[this._charCount]),this.updateShadow(this.style.shadowStroke),this.context.strokeText(a,t,i)),this.style.fill&&(this.colors[this._charCount]&&(this.context.fillStyle=this.colors[this._charCount]),this.updateShadow(this.style.shadowFill),this.context.fillText(a,t,i)),t+=this.context.measureText(a).width,this._charCount++}},i.Text.prototype.clearColors=function(){return this.colors=[],this.strokeColors=[],this.dirty=!0,this},i.Text.prototype.clearFontValues=function(){return this.fontStyles=[],this.fontWeights=[],this.dirty=!0,this},i.Text.prototype.addColor=function(e,t){return this.colors[t]=e,this.dirty=!0,this},i.Text.prototype.addStrokeColor=function(e,t){return this.strokeColors[t]=e,this.dirty=!0,this},i.Text.prototype.addFontStyle=function(e,t){return this.fontStyles[t]=e,this.dirty=!0,this},i.Text.prototype.addFontWeight=function(e,t){return this.fontWeights[t]=e,this.dirty=!0,this},i.Text.prototype.precalculateWordWrap=function(e){return this.texture.baseTexture.resolution=this._res,this.context.font=this.style.font,this.runWordWrap(e).split(/(?:\r\n|\r|\n)/)},i.Text.prototype.runWordWrap=function(e){return this.useAdvancedWrap?this.advancedWordWrap(e):this.basicWordWrap(e)},i.Text.prototype.advancedWordWrap=function(e){for(var t=this.context,i=this.style.wordWrapWidth,s="",a=e.replace(/ +/gi," ").split(/\r?\n/gi),n=a.length,o=0;o<n;o++){var r=a[o],l="";if(r=r.replace(/^ *|\s*$/gi,""),t.measureText(r).width<i)s+=r+"\n";else{for(var h=i,c=r.split(" "),p=0;p<c.length;p++){var d=c[p],u=d+" ",m=t.measureText(u).width;if(m>h){if(0===p){for(var g=u;g.length&&(g=g.slice(0,-1),!((m=t.measureText(g).width)<=h)););if(!g.length)throw new Error("This text's wordWrapWidth setting is less than a single character!");var y=d.substr(g.length);c[p]=y,l+=g}var b=c[p].length?p:p+1,x=c.slice(b).join(" ").replace(/[ \n]*$/gi,"");a[o+1]=x+" "+(a[o+1]||""),n=a.length;break}l+=u,h-=m}s+=l.replace(/[ \n]*$/gi,"")+"\n"}}return s=s.replace(/[\s|\n]*$/gi,"")},i.Text.prototype.basicWordWrap=function(e){for(var t="",i=e.split("\n"),s=0;s<i.length;s++){for(var a=this.style.wordWrapWidth,n=i[s].split(" "),o=0;o<n.length;o++){var r=this.context.measureText(n[o]).width,l=r+this.context.measureText(" ").width;l>a?(o>0&&(t+="\n"),t+=n[o]+" ",a=this.style.wordWrapWidth-r):(a-=l,t+=n[o]+" ")}s<i.length-1&&(t+="\n")}return t},i.Text.prototype.updateFont=function(e){var t=this.componentsToFont(e);this.style.font!==t&&(this.style.font=t,this.dirty=!0,this.parent&&this.updateTransform())},i.Text.prototype.fontToComponents=function(e){var t=e.match(/^\s*(?:\b(normal|italic|oblique|inherit)?\b)\s*(?:\b(normal|small-caps|inherit)?\b)\s*(?:\b(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900|inherit)?\b)\s*(?:\b(xx-small|x-small|small|medium|large|x-large|xx-large|larger|smaller|0|\d*(?:[.]\d*)?(?:%|[a-z]{2,5}))?\b)\s*(.*)\s*$/);if(t){var i=t[5].trim();return/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(i)||/['",]/.exec(i)||(i="'"+i+"'"),{font:e,fontStyle:t[1]||"normal",fontVariant:t[2]||"normal",fontWeight:t[3]||"normal",fontSize:t[4]||"medium",fontFamily:i}}return{font:e}},i.Text.prototype.componentsToFont=function(e){var t,i=[];return(t=e.fontStyle)&&"normal"!==t&&i.push(t),(t=e.fontVariant)&&"normal"!==t&&i.push(t),(t=e.fontWeight)&&"normal"!==t&&i.push(t),(t=e.fontSize)&&"medium"!==t&&i.push(t),(t=e.fontFamily)&&i.push(t),i.length||i.push(e.font),i.join(" ")},i.Text.prototype.setText=function(e,t){return void 0===t&&(t=!1),this.text=e.toString()||"",t?this.updateText():this.dirty=!0,this},i.Text.prototype.parseList=function(e){if(!Array.isArray(e))return this;for(var t="",i=0;i<e.length;i++)Array.isArray(e[i])?(t+=e[i].join("\t"),i<e.length-1&&(t+="\n")):(t+=e[i],i<e.length-1&&(t+="\t"));return this.text=t,this.dirty=!0,this},i.Text.prototype.setTextBounds=function(e,t,s,a){return void 0===e?this.textBounds=null:(this.textBounds?this.textBounds.setTo(e,t,s,a):this.textBounds=new i.Rectangle(e,t,s,a),this.style.wordWrapWidth>s&&(this.style.wordWrapWidth=s)),this.updateTexture(),this},i.Text.prototype.updateTexture=function(){var e=this.texture.baseTexture,t=this.texture.crop,i=this.texture.frame,s=this.canvas.width,a=this.canvas.height;if(e.width=s,e.height=a,t.width=s,t.height=a,i.width=s,i.height=a,this.texture.width=s,this.texture.height=a,this._width=s,this._height=a,this.textBounds){var n=this.textBounds.x,o=this.textBounds.y;"right"===this.style.boundsAlignH?n+=this.textBounds.width-this.canvas.width/this.resolution:"center"===this.style.boundsAlignH&&(n+=this.textBounds.halfWidth-this.canvas.width/this.resolution/2),"bottom"===this.style.boundsAlignV?o+=this.textBounds.height-this.canvas.height/this.resolution:"middle"===this.style.boundsAlignV&&(o+=this.textBounds.halfHeight-this.canvas.height/this.resolution/2),this.pivot.x=-n,this.pivot.y=-o}this.renderable=0!==s&&0!==a,this.texture.requiresReTint=!0,this.texture.baseTexture.dirty()},i.Text.prototype._renderWebGL=function(e){this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype._renderWebGL.call(this,e)},i.Text.prototype._renderCanvas=function(e){this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype._renderCanvas.call(this,e)},i.Text.prototype.determineFontProperties=function(e){var t=i.Text.fontPropertiesCache[e];if(!t){t={};var s=i.Text.fontPropertiesCanvas,a=i.Text.fontPropertiesContext;a.font=e;var n=Math.ceil(a.measureText("|MÉq").width),o=Math.ceil(a.measureText("|MÉq").width),r=2*o;if(o=1.4*o|0,s.width=n,s.height=r,a.fillStyle="#f00",a.fillRect(0,0,n,r),a.font=e,a.textBaseline="alphabetic",a.fillStyle="#000",a.fillText("|MÉq",0,o),!a.getImageData(0,0,n,r))return t.ascent=o,t.descent=o+6,t.fontSize=t.ascent+t.descent,i.Text.fontPropertiesCache[e]=t,t;var l,h,c=a.getImageData(0,0,n,r).data,p=c.length,d=4*n,u=0,m=!1;for(l=0;l<o;l++){for(h=0;h<d;h+=4)if(255!==c[u+h]){m=!0;break}if(m)break;u+=d}for(t.ascent=o-l,u=p-d,m=!1,l=r;l>o;l--){for(h=0;h<d;h+=4)if(255!==c[u+h]){m=!0;break}if(m)break;u-=d}t.descent=l-o,t.descent+=6,t.fontSize=t.ascent+t.descent,i.Text.fontPropertiesCache[e]=t}return t},i.Text.prototype.getBounds=function(e){return this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype.getBounds.call(this,e)},Object.defineProperty(i.Text.prototype,"text",{get:function(){return this._text},set:function(e){e!==this._text&&(this._text=e.toString()||"",this.dirty=!0,this.parent&&this.updateTransform())}}),Object.defineProperty(i.Text.prototype,"cssFont",{get:function(){return this.componentsToFont(this._fontComponents)},set:function(e){e=e||"bold 20pt Arial",this._fontComponents=this.fontToComponents(e),this.updateFont(this._fontComponents)}}),Object.defineProperty(i.Text.prototype,"font",{get:function(){return this._fontComponents.fontFamily},set:function(e){e=(e=e||"Arial").trim(),/^(?:inherit|serif|sans-serif|cursive|fantasy|monospace)$/.exec(e)||/['",]/.exec(e)||(e="'"+e+"'"),this._fontComponents.fontFamily=e,this.updateFont(this._fontComponents)}}),Object.defineProperty(i.Text.prototype,"fontSize",{get:function(){var e=this._fontComponents.fontSize;return e&&/(?:^0$|px$)/.exec(e)?parseInt(e,10):e},set:function(e){"number"==typeof(e=e||"0")&&(e+="px"),this._fontComponents.fontSize=e,this.updateFont(this._fontComponents)}}),Object.defineProperty(i.Text.prototype,"fontWeight",{get:function(){return this._fontComponents.fontWeight||"normal"},set:function(e){e=e||"normal",this._fontComponents.fontWeight=e,this.updateFont(this._fontComponents)}}),Object.defineProperty(i.Text.prototype,"fontStyle",{get:function(){return this._fontComponents.fontStyle||"normal"},set:function(e){e=e||"normal",this._fontComponents.fontStyle=e,this.updateFont(this._fontComponents)}}),Object.defineProperty(i.Text.prototype,"fontVariant",{get:function(){return this._fontComponents.fontVariant||"normal"},set:function(e){e=e||"normal",this._fontComponents.fontVariant=e,this.updateFont(this._fontComponents)}}),Object.defineProperty(i.Text.prototype,"fill",{get:function(){return this.style.fill},set:function(e){e!==this.style.fill&&(this.style.fill=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"align",{get:function(){return this.style.align},set:function(e){e!==this.style.align&&(this.style.align=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"resolution",{get:function(){return this._res},set:function(e){e!==this._res&&(this._res=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"tabs",{get:function(){return this.style.tabs},set:function(e){e!==this.style.tabs&&(this.style.tabs=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"boundsAlignH",{get:function(){return this.style.boundsAlignH},set:function(e){e!==this.style.boundsAlignH&&(this.style.boundsAlignH=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"boundsAlignV",{get:function(){return this.style.boundsAlignV},set:function(e){e!==this.style.boundsAlignV&&(this.style.boundsAlignV=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"stroke",{get:function(){return this.style.stroke},set:function(e){e!==this.style.stroke&&(this.style.stroke=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"strokeThickness",{get:function(){return this.style.strokeThickness},set:function(e){e!==this.style.strokeThickness&&(this.style.strokeThickness=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"wordWrap",{get:function(){return this.style.wordWrap},set:function(e){e!==this.style.wordWrap&&(this.style.wordWrap=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"wordWrapWidth",{get:function(){return this.style.wordWrapWidth},set:function(e){e!==this.style.wordWrapWidth&&(this.style.wordWrapWidth=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"lineSpacing",{get:function(){return this._lineSpacing},set:function(e){e!==this._lineSpacing&&(this._lineSpacing=parseFloat(e),this.dirty=!0,this.parent&&this.updateTransform())}}),Object.defineProperty(i.Text.prototype,"shadowOffsetX",{get:function(){return this.style.shadowOffsetX},set:function(e){e!==this.style.shadowOffsetX&&(this.style.shadowOffsetX=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"shadowOffsetY",{get:function(){return this.style.shadowOffsetY},set:function(e){e!==this.style.shadowOffsetY&&(this.style.shadowOffsetY=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"shadowColor",{get:function(){return this.style.shadowColor},set:function(e){e!==this.style.shadowColor&&(this.style.shadowColor=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"shadowBlur",{get:function(){return this.style.shadowBlur},set:function(e){e!==this.style.shadowBlur&&(this.style.shadowBlur=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"shadowStroke",{get:function(){return this.style.shadowStroke},set:function(e){e!==this.style.shadowStroke&&(this.style.shadowStroke=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"shadowFill",{get:function(){return this.style.shadowFill},set:function(e){e!==this.style.shadowFill&&(this.style.shadowFill=e,this.dirty=!0)}}),Object.defineProperty(i.Text.prototype,"width",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.x*this.texture.frame.width},set:function(e){this.scale.x=e/this.texture.frame.width,this._width=e}}),Object.defineProperty(i.Text.prototype,"height",{get:function(){return this.dirty&&(this.updateText(),this.dirty=!1),this.scale.y*this.texture.frame.height},set:function(e){this.scale.y=e/this.texture.frame.height,this._height=e}}),i.Text.fontPropertiesCache={},i.Text.fontPropertiesCanvas=document.createElement("canvas"),i.Text.fontPropertiesContext=i.Text.fontPropertiesCanvas.getContext("2d"),i.BitmapText=function(e,t,s,a,n,o,r){t=t||0,s=s||0,a=a||"",n=n||"",o=o||32,r=r||"left",PIXI.DisplayObjectContainer.call(this),this.type=i.BITMAPTEXT,this.physicsType=i.SPRITE,this.textWidth=0,this.textHeight=0,this.anchor=new i.Point,this._prevAnchor=new i.Point,this._glyphs=[],this._maxWidth=0,this._text=n.toString()||"",this._data=e.cache.getBitmapFont(a),this._font=a,this._fontSize=o,this._align=r,this._tint=16777215,this.updateText(),this.dirty=!1,i.Component.Core.init.call(this,e,t,s,"",null)},i.BitmapText.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),i.BitmapText.prototype.constructor=i.BitmapText,i.Component.Core.install.call(i.BitmapText.prototype,["Angle","AutoCull","Bounds","Destroy","FixedToCamera","InputEnabled","InWorld","LifeSpan","PhysicsBody","Reset"]),i.BitmapText.prototype.preUpdatePhysics=i.Component.PhysicsBody.preUpdate,i.BitmapText.prototype.preUpdateLifeSpan=i.Component.LifeSpan.preUpdate,i.BitmapText.prototype.preUpdateInWorld=i.Component.InWorld.preUpdate,i.BitmapText.prototype.preUpdateCore=i.Component.Core.preUpdate,i.BitmapText.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},i.BitmapText.prototype.postUpdate=function(){i.Component.PhysicsBody.postUpdate.call(this),i.Component.FixedToCamera.postUpdate.call(this),this.body&&this.body.type===i.Physics.ARCADE&&(this.textWidth===this.body.sourceWidth&&this.textHeight===this.body.sourceHeight||this.body.setSize(this.textWidth,this.textHeight))},i.BitmapText.prototype.setText=function(e){this.text=e},i.BitmapText.prototype.scanLine=function(e,t,i){for(var s=0,a=0,n=-1,o=0,r=null,l=this._maxWidth>0?this._maxWidth:null,h=[],c=0;c<i.length;c++){var p=c===i.length-1;if(/(?:\r\n|\r|\n)/.test(i.charAt(c)))return{width:a,text:i.substr(0,c),end:p,chars:h};var d=i.charCodeAt(c),u=e.chars[d],m=0;void 0===u&&(d=32,u=e.chars[d]);var g=r&&u.kerning[r]?u.kerning[r]:0;if(/(\s)/.test(i.charAt(c))&&(n=c,o=a),m=(g+u.texture.width+u.xOffset)*t,l&&a+m>=l&&n>-1)return{width:o||a,text:i.substr(0,c-(c-n)),end:p,chars:h};a+=(u.xAdvance+g)*t,h.push(s+(u.xOffset+g)*t),s+=(u.xAdvance+g)*t,r=d}return{width:a,text:i,end:p,chars:h}},i.BitmapText.prototype.cleanText=function(e,t){void 0===t&&(t="");var i=this._data.font;if(!i)return"";for(var s=/\r\n|\n\r|\n|\r/g,a=e.replace(s,"\n").split("\n"),n=0;n<a.length;n++){for(var o="",r=a[n],l=0;l<r.length;l++)o=i.chars[r.charCodeAt(l)]?o.concat(r[l]):o.concat(t);a[n]=o}return a.join("\n")},i.BitmapText.prototype.updateText=function(){var e=this._data.font;if(e){var t=this.text,i=this._fontSize/e.size,s=[],a=0;this.textWidth=0;do{(c=this.scanLine(e,i,t)).y=a,s.push(c),c.width>this.textWidth&&(this.textWidth=c.width),a+=e.lineHeight*i,t=t.substr(c.text.length+1)}while(!1===c.end);this.textHeight=a;for(var n=0,o=0,r=this.textWidth*this.anchor.x,l=this.textHeight*this.anchor.y,h=0;h<s.length;h++){var c=s[h];"right"===this._align?o=this.textWidth-c.width:"center"===this._align&&(o=(this.textWidth-c.width)/2);for(var p=0;p<c.text.length;p++){var d=c.text.charCodeAt(p),u=e.chars[d];void 0===u&&(d=32,u=e.chars[d]);var m=this._glyphs[n];m?m.texture=u.texture:(m=new PIXI.Sprite(u.texture),m.name=c.text[p],this._glyphs.push(m)),m.position.x=c.chars[p]+o-r,m.position.y=c.y+u.yOffset*i-l,m.scale.set(i),m.tint=this.tint,m.texture.requiresReTint=!0,m.parent||this.addChild(m),n++}}for(h=n;h<this._glyphs.length;h++)this.removeChild(this._glyphs[h])}},i.BitmapText.prototype.purgeGlyphs=function(){for(var e=this._glyphs.length,t=[],i=0;i<this._glyphs.length;i++)this._glyphs[i].parent!==this?this._glyphs[i].destroy():t.push(this._glyphs[i]);return this._glyphs=[],this._glyphs=t,this.updateText(),e-t.length},i.BitmapText.prototype.updateTransform=function(){!this.dirty&&this.anchor.equals(this._prevAnchor)||(this.updateText(),this.dirty=!1,this._prevAnchor.copyFrom(this.anchor)),PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},Object.defineProperty(i.BitmapText.prototype,"align",{get:function(){return this._align},set:function(e){e===this._align||"left"!==e&&"center"!==e&&"right"!==e||(this._align=e,this.updateText())}}),Object.defineProperty(i.BitmapText.prototype,"tint",{get:function(){return this._tint},set:function(e){e!==this._tint&&(this._tint=e,this.updateText())}}),Object.defineProperty(i.BitmapText.prototype,"font",{get:function(){return this._font},set:function(e){e!==this._font&&(this._font=e.trim(),this._data=this.game.cache.getBitmapFont(this._font),this.updateText())}}),Object.defineProperty(i.BitmapText.prototype,"fontSize",{get:function(){return this._fontSize},set:function(e){(e=parseInt(e,10))!==this._fontSize&&e>0&&(this._fontSize=e,this.updateText())}}),Object.defineProperty(i.BitmapText.prototype,"text",{get:function(){return this._text},set:function(e){e!==this._text&&(this._text=e.toString()||"",this.updateText())}}),Object.defineProperty(i.BitmapText.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(e){e!==this._maxWidth&&(this._maxWidth=e,this.updateText())}}),Object.defineProperty(i.BitmapText.prototype,"smoothed",{get:function(){return!this._data.base.scaleMode},set:function(e){this._data.base.scaleMode=e?0:1}}),i.RetroFont=function(e,t,s,a,n,o,r,l,h,c){if(!e.cache.checkImageKey(t))return!1;void 0!==o&&null!==o||(o=e.cache.getImage(t).width/s),this.characterWidth=s,this.characterHeight=a,this.characterSpacingX=r||0,this.characterSpacingY=l||0,this.characterPerRow=o,this.offsetX=h||0,this.offsetY=c||0,this.align="left",this.multiLine=!1,this.autoUpperCase=!0,this.customSpacingX=0,this.customSpacingY=0,this.fixedWidth=0,this.fontSet=e.cache.getImage(t),this._text="",this.grabData=[],this.frameData=new i.FrameData;for(var p=this.offsetX,d=this.offsetY,u=0,m=0;m<n.length;m++){var g=this.frameData.addFrame(new i.Frame(m,p,d,this.characterWidth,this.characterHeight));this.grabData[n.charCodeAt(m)]=g.index,++u===this.characterPerRow?(u=0,p=this.offsetX,d+=this.characterHeight+this.characterSpacingY):p+=this.characterWidth+this.characterSpacingX}e.cache.updateFrameData(t,this.frameData),this.stamp=new i.Image(e,0,0,t,0),i.RenderTexture.call(this,e,100,100,"",i.scaleModes.NEAREST),this.type=i.RETROFONT},i.RetroFont.prototype=Object.create(i.RenderTexture.prototype),i.RetroFont.prototype.constructor=i.RetroFont,i.RetroFont.ALIGN_LEFT="left",i.RetroFont.ALIGN_RIGHT="right",i.RetroFont.ALIGN_CENTER="center",i.RetroFont.TEXT_SET1=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",i.RetroFont.TEXT_SET2=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ",i.RetroFont.TEXT_SET3="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",i.RetroFont.TEXT_SET4="ABCDEFGHIJKLMNOPQRSTUVWXYZ 0123456789",i.RetroFont.TEXT_SET5="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,/() '!?-*:0123456789",i.RetroFont.TEXT_SET6="ABCDEFGHIJKLMNOPQRSTUVWXYZ!?:;0123456789\"(),-.' ",i.RetroFont.TEXT_SET7="AGMSY+:4BHNTZ!;5CIOU.?06DJPV,(17EKQW\")28FLRX-'39",i.RetroFont.TEXT_SET8="0123456789 .ABCDEFGHIJKLMNOPQRSTUVWXYZ",i.RetroFont.TEXT_SET9="ABCDEFGHIJKLMNOPQRSTUVWXYZ()-0123456789.:,'\"?!",i.RetroFont.TEXT_SET10="ABCDEFGHIJKLMNOPQRSTUVWXYZ",i.RetroFont.TEXT_SET11="ABCDEFGHIJKLMNOPQRSTUVWXYZ.,\"-+!?()':;0123456789",i.RetroFont.prototype.setFixedWidth=function(e,t){void 0===t&&(t="left"),this.fixedWidth=e,this.align=t},i.RetroFont.prototype.setText=function(e,t,i,s,a,n){this.multiLine=t||!1,this.customSpacingX=i||0,this.customSpacingY=s||0,this.align=a||"left",this.autoUpperCase=!n,e.length>0&&(this.text=e)},i.RetroFont.prototype.buildRetroFontText=function(){var e=0,t=0;if(this.clear(),this.multiLine){var s=this._text.split("\n");this.fixedWidth>0?this.resize(this.fixedWidth,s.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0):this.resize(this.getLongestLine()*(this.characterWidth+this.customSpacingX),s.length*(this.characterHeight+this.customSpacingY)-this.customSpacingY,!0);for(var a=0;a<s.length;a++)e=0,this.align===i.RetroFont.ALIGN_RIGHT?e=this.width-s[a].length*(this.characterWidth+this.customSpacingX):this.align===i.RetroFont.ALIGN_CENTER&&(e=this.width/2-s[a].length*(this.characterWidth+this.customSpacingX)/2,e+=this.customSpacingX/2),e<0&&(e=0),this.pasteLine(s[a],e,t,this.customSpacingX),t+=this.characterHeight+this.customSpacingY}else this.fixedWidth>0?this.resize(this.fixedWidth,this.characterHeight,!0):this.resize(this._text.length*(this.characterWidth+this.customSpacingX),this.characterHeight,!0),e=0,this.align===i.RetroFont.ALIGN_RIGHT?e=this.width-this._text.length*(this.characterWidth+this.customSpacingX):this.align===i.RetroFont.ALIGN_CENTER&&(e=this.width/2-this._text.length*(this.characterWidth+this.customSpacingX)/2,e+=this.customSpacingX/2),e<0&&(e=0),this.pasteLine(this._text,e,0,this.customSpacingX);this.requiresReTint=!0},i.RetroFont.prototype.pasteLine=function(e,t,i,s){for(var a=0;a<e.length;a++)if(" "===e.charAt(a))t+=this.characterWidth+s;else if(this.grabData[e.charCodeAt(a)]>=0&&(this.stamp.frame=this.grabData[e.charCodeAt(a)],this.renderXY(this.stamp,t,i,!1),(t+=this.characterWidth+s)>this.width))break},i.RetroFont.prototype.getLongestLine=function(){var e=0;if(this._text.length>0)for(var t=this._text.split("\n"),i=0;i<t.length;i++)t[i].length>e&&(e=t[i].length);return e},i.RetroFont.prototype.removeUnsupportedCharacters=function(e){for(var t="",i=0;i<this._text.length;i++){var s=this._text[i],a=s.charCodeAt(0);(this.grabData[a]>=0||!e&&"\n"===s)&&(t=t.concat(s))}return t},i.RetroFont.prototype.updateOffset=function(e,t){if(this.offsetX!==e||this.offsetY!==t){for(var i=e-this.offsetX,s=t-this.offsetY,a=this.game.cache.getFrameData(this.stamp.key).getFrames(),n=a.length;n--;)a[n].x+=i,a[n].y+=s;this.buildRetroFontText()}},Object.defineProperty(i.RetroFont.prototype,"text",{get:function(){return this._text},set:function(e){var t;(t=this.autoUpperCase?e.toUpperCase():e)!==this._text&&(this._text=t,this.removeUnsupportedCharacters(this.multiLine),this.buildRetroFontText())}}),Object.defineProperty(i.RetroFont.prototype,"smoothed",{get:function(){return this.stamp.smoothed},set:function(e){this.stamp.smoothed=e,this.buildRetroFontText()}}),i.Rope=function(e,t,s,a,n,o){this.points=[],this.points=o,this._hasUpdateAnimation=!1,this._updateAnimationCallback=null,t=t||0,s=s||0,a=a||null,n=n||null,this.type=i.ROPE,PIXI.Rope.call(this,i.Cache.DEFAULT,this.points),i.Component.Core.init.call(this,e,t,s,a,n)},i.Rope.prototype=Object.create(PIXI.Rope.prototype),i.Rope.prototype.constructor=i.Rope,i.Component.Core.install.call(i.Rope.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Crop","Delta","Destroy","FixedToCamera","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","ScaleMinMax","Smoothed"]),i.Rope.prototype.preUpdatePhysics=i.Component.PhysicsBody.preUpdate,i.Rope.prototype.preUpdateLifeSpan=i.Component.LifeSpan.preUpdate,i.Rope.prototype.preUpdateInWorld=i.Component.InWorld.preUpdate,i.Rope.prototype.preUpdateCore=i.Component.Core.preUpdate,i.Rope.prototype.preUpdate=function(){return!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},i.Rope.prototype.update=function(){this._hasUpdateAnimation&&this.updateAnimation.call(this)},i.Rope.prototype.reset=function(e,t){return i.Component.Reset.prototype.reset.call(this,e,t),this},Object.defineProperty(i.Rope.prototype,"updateAnimation",{get:function(){return this._updateAnimation},set:function(e){e&&"function"==typeof e?(this._hasUpdateAnimation=!0,this._updateAnimation=e):(this._hasUpdateAnimation=!1,this._updateAnimation=null)}}),Object.defineProperty(i.Rope.prototype,"segments",{get:function(){for(var e,t,s,a,n,o,r,l,h=[],c=0;c<this.points.length;c++)e=4*c,t=this.vertices[e]*this.scale.x,s=this.vertices[e+1]*this.scale.y,a=this.vertices[e+4]*this.scale.x,n=this.vertices[e+3]*this.scale.y,o=i.Math.difference(t,a),r=i.Math.difference(s,n),t+=this.world.x,s+=this.world.y,l=new i.Rectangle(t,s,o,r),h.push(l);return h}}),i.TileSprite=function(e,t,s,a,n,o,r){t=t||0,s=s||0,a=a||256,n=n||256,o=o||null,r=r||null,this.type=i.TILESPRITE,this.physicsType=i.SPRITE,this._scroll=new i.Point;var l=e.cache.getImage("__default",!0);PIXI.TilingSprite.call(this,new PIXI.Texture(l.base),a,n),i.Component.Core.init.call(this,e,t,s,o,r)},i.TileSprite.prototype=Object.create(PIXI.TilingSprite.prototype),i.TileSprite.prototype.constructor=i.TileSprite,i.Component.Core.install.call(i.TileSprite.prototype,["Angle","Animation","AutoCull","Bounds","BringToTop","Destroy","FixedToCamera","Health","InCamera","InputEnabled","InWorld","LifeSpan","LoadTexture","Overlap","PhysicsBody","Reset","Smoothed"]),i.TileSprite.prototype.preUpdatePhysics=i.Component.PhysicsBody.preUpdate,i.TileSprite.prototype.preUpdateLifeSpan=i.Component.LifeSpan.preUpdate,i.TileSprite.prototype.preUpdateInWorld=i.Component.InWorld.preUpdate,i.TileSprite.prototype.preUpdateCore=i.Component.Core.preUpdate,i.TileSprite.prototype.preUpdate=function(){return 0!==this._scroll.x&&(this.tilePosition.x+=this._scroll.x*this.game.time.physicsElapsed),0!==this._scroll.y&&(this.tilePosition.y+=this._scroll.y*this.game.time.physicsElapsed),!!(this.preUpdatePhysics()&&this.preUpdateLifeSpan()&&this.preUpdateInWorld())&&this.preUpdateCore()},i.TileSprite.prototype.autoScroll=function(e,t){this._scroll.set(e,t)},i.TileSprite.prototype.stopScroll=function(){this._scroll.set(0,0)},i.TileSprite.prototype.destroy=function(e){i.Component.Destroy.prototype.destroy.call(this,e),PIXI.TilingSprite.prototype.destroy.call(this)},i.TileSprite.prototype.reset=function(e,t){return i.Component.Reset.prototype.reset.call(this,e,t),this.tilePosition.x=0,this.tilePosition.y=0,this},i.Device=function(){this.deviceReadyAt=0,this.initialized=!1,this.desktop=!1,this.iOS=!1,this.iOSVersion=0,this.cocoonJS=!1,this.cocoonJSApp=!1,this.cordova=!1,this.node=!1,this.nodeWebkit=!1,this.electron=!1,this.ejecta=!1,this.crosswalk=!1,this.android=!1,this.chromeOS=!1,this.linux=!1,this.macOS=!1,this.windows=!1,this.windowsPhone=!1,this.canvas=!1,this.canvasBitBltShift=null,this.webGL=!1,this.file=!1,this.fileSystem=!1,this.localStorage=!1,this.worker=!1,this.css3D=!1,this.pointerLock=!1,this.typedArray=!1,this.vibration=!1,this.getUserMedia=!0,this.quirksMode=!1,this.touch=!1,this.mspointer=!1,this.wheelEvent=null,this.arora=!1,this.chrome=!1,this.chromeVersion=0,this.epiphany=!1,this.firefox=!1,this.firefoxVersion=0,this.ie=!1,this.ieVersion=0,this.trident=!1,this.tridentVersion=0,this.edge=!1,this.mobileSafari=!1,this.midori=!1,this.opera=!1,this.safari=!1,this.safariVersion=0,this.webApp=!1,this.silk=!1,this.audioData=!1,this.webAudio=!1,this.ogg=!1,this.opus=!1,this.mp3=!1,this.wav=!1,this.m4a=!1,this.webm=!1,this.dolby=!1,this.oggVideo=!1,this.h264Video=!1,this.mp4Video=!1,this.webmVideo=!1,this.vp9Video=!1,this.hlsVideo=!1,this.iPhone=!1,this.iPhone4=!1,this.iPad=!1,this.pixelRatio=0,this.littleEndian=!1,this.LITTLE_ENDIAN=!1,this.support32bit=!1,this.fullscreen=!1,this.requestFullscreen="",this.cancelFullscreen="",this.fullscreenKeyboard=!1},i.Device=new i.Device,i.Device.onInitialized=new i.Signal,i.Device.whenReady=function(e,t,i){var s=this._readyCheck;if(this.deviceReadyAt||!s)e.call(t,this);else if(s._monitor||i)s._queue=s._queue||[],s._queue.push([e,t]);else{s._monitor=s.bind(this),s._queue=s._queue||[],s._queue.push([e,t]);var a=void 0!==window.cordova,n=navigator.isCocoonJS;"complete"===document.readyState||"interactive"===document.readyState?window.setTimeout(s._monitor,0):a&&!n?document.addEventListener("deviceready",s._monitor,!1):(document.addEventListener("DOMContentLoaded",s._monitor,!1),window.addEventListener("load",s._monitor,!1))}},i.Device._readyCheck=function(){var e=this._readyCheck;if(document.body){if(!this.deviceReadyAt){this.deviceReadyAt=Date.now(),document.removeEventListener("deviceready",e._monitor),document.removeEventListener("DOMContentLoaded",e._monitor),window.removeEventListener("load",e._monitor),this._initialize(),this.initialized=!0,this.onInitialized.dispatch(this);for(var t;t=e._queue.shift();){var i=t[0],s=t[1];i.call(s,this)}this._readyCheck=null,this._initialize=null,this.onInitialized=null}}else window.setTimeout(e._monitor,20)},i.Device._initialize=function(){function e(){var e=new ArrayBuffer(4),t=new Uint8Array(e),i=new Uint32Array(e);return t[0]=161,t[1]=178,t[2]=195,t[3]=212,3569595041===i[0]||2712847316!==i[0]&&null}function t(){if(void 0===Uint8ClampedArray)return!1;var e=PIXI.CanvasPool.create(this,1,1).getContext("2d");if(!e)return!1;var t=e.createImageData(1,1);return PIXI.CanvasPool.remove(this),t.data instanceof Uint8ClampedArray}var i=this;(function(){var e=navigator.userAgent;/Playstation Vita/.test(e)?i.vita=!0:/Kindle/.test(e)||/\bKF[A-Z][A-Z]+/.test(e)||/Silk.*Mobile Safari/.test(e)?i.kindle=!0:/Android/.test(e)?i.android=!0:/CrOS/.test(e)?i.chromeOS=!0:/iP[ao]d|iPhone/i.test(e)?(i.iOS=!0,navigator.appVersion.match(/OS (\d+)/),i.iOSVersion=parseInt(RegExp.$1,10)):/Linux/.test(e)?i.linux=!0:/Mac OS/.test(e)?i.macOS=!0:/Windows/.test(e)&&(i.windows=!0),(/Windows Phone/i.test(e)||/IEMobile/i.test(e))&&(i.android=!1,i.iOS=!1,i.macOS=!1,i.windows=!0,i.windowsPhone=!0);var t=/Silk/.test(e);(i.windows||i.macOS||i.linux&&!t||i.chromeOS)&&(i.desktop=!0),(i.windowsPhone||/Windows NT/i.test(e)&&/Touch/i.test(e))&&(i.desktop=!1)})(),function(){var e=navigator.userAgent;if(/Arora/.test(e)?i.arora=!0:/Edge\/\d+/.test(e)?i.edge=!0:/Chrome\/(\d+)/.test(e)&&!i.windowsPhone?(i.chrome=!0,i.chromeVersion=parseInt(RegExp.$1,10)):/Epiphany/.test(e)?i.epiphany=!0:/Firefox\D+(\d+)/.test(e)?(i.firefox=!0,i.firefoxVersion=parseInt(RegExp.$1,10)):/AppleWebKit/.test(e)&&i.iOS?i.mobileSafari=!0:/MSIE (\d+\.\d+);/.test(e)?(i.ie=!0,i.ieVersion=parseInt(RegExp.$1,10)):/Midori/.test(e)?i.midori=!0:/Opera/.test(e)?i.opera=!0:/Safari\/(\d+)/.test(e)&&!i.windowsPhone?(i.safari=!0,/Version\/(\d+)\./.test(e)&&(i.safariVersion=parseInt(RegExp.$1,10))):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(e)&&(i.ie=!0,i.trident=!0,i.tridentVersion=parseInt(RegExp.$1,10),i.ieVersion=parseInt(RegExp.$3,10)),/Silk/.test(e)&&(i.silk=!0),navigator.standalone&&(i.webApp=!0),void 0!==window.cordova&&(i.cordova=!0),"undefined"!=typeof process&&"undefined"!=typeof require&&(i.node=!0),i.node&&"object"==typeof process.versions&&(i.nodeWebkit=!!process.versions["node-webkit"],i.electron=!!process.versions.electron),navigator.isCocoonJS&&(i.cocoonJS=!0),i.cocoonJS)try{i.cocoonJSApp="undefined"!=typeof CocoonJS}catch(e){i.cocoonJSApp=!1}void 0!==window.ejecta&&(i.ejecta=!0),/Crosswalk/.test(e)&&(i.crosswalk=!0)}(),function(){i.audioData=!!window.Audio,i.webAudio=!(!window.AudioContext&&!window.webkitAudioContext);var e=document.createElement("audio");try{if(e.canPlayType&&(e.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(i.ogg=!0),(e.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||e.canPlayType("audio/opus;").replace(/^no$/,""))&&(i.opus=!0),e.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(i.mp3=!0),e.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(i.wav=!0),(e.canPlayType("audio/x-m4a;")||e.canPlayType("audio/aac;").replace(/^no$/,""))&&(i.m4a=!0),e.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(i.webm=!0),""!==e.canPlayType('audio/mp4;codecs="ec-3"')))if(i.edge)i.dolby=!0;else if(i.safari&&i.safariVersion>=9&&/Mac OS X (\d+)_(\d+)/.test(navigator.userAgent)){var t=parseInt(RegExp.$1,10),s=parseInt(RegExp.$2,10);(10===t&&s>=11||t>10)&&(i.dolby=!0)}}catch(e){}}(),function(){var e=document.createElement("video");try{!!e.canPlayType&&(e.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(i.oggVideo=!0),e.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(i.h264Video=!0,i.mp4Video=!0),e.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(i.webmVideo=!0),e.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,"")&&(i.vp9Video=!0),e.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(i.hlsVideo=!0))}catch(e){}}(),function(){var e,t=document.createElement("p"),s={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(t,null);for(var a in s)void 0!==t.style[a]&&(t.style[a]="translate3d(1px,1px,1px)",e=window.getComputedStyle(t).getPropertyValue(s[a]));document.body.removeChild(t),i.css3D=void 0!==e&&e.length>0&&"none"!==e}(),i.pixelRatio=window.devicePixelRatio||1,i.iPhone=-1!==navigator.userAgent.toLowerCase().indexOf("iphone"),i.iPhone4=2===i.pixelRatio&&i.iPhone,i.iPad=-1!==navigator.userAgent.toLowerCase().indexOf("ipad"),"undefined"!=typeof Int8Array?i.typedArray=!0:i.typedArray=!1,"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint32Array&&(i.littleEndian=e(),i.LITTLE_ENDIAN=i.littleEndian),i.support32bit="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof Int32Array&&null!==i.littleEndian&&t(),navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate,navigator.vibrate&&(i.vibration=!0),function(){i.canvas=!!window.CanvasRenderingContext2D||i.cocoonJS;try{i.localStorage=!!localStorage.getItem}catch(e){i.localStorage=!1}i.file=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),i.fileSystem=!!window.requestFileSystem,i.webGL=function(){try{var e=document.createElement("canvas");return e.screencanvas=!1,!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(e){return!1}}(),i.webGL=!!i.webGL,i.worker=!!window.Worker,i.pointerLock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,i.quirksMode="CSS1Compat"!==document.compatMode,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||navigator.oGetUserMedia,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,i.getUserMedia=i.getUserMedia&&!!navigator.getUserMedia&&!!window.URL,i.firefox&&i.firefoxVersion<21&&(i.getUserMedia=!1),!i.iOS&&(i.ie||i.firefox||i.chrome)&&(i.canvasBitBltShift=!0),(i.safari||i.mobileSafari)&&(i.canvasBitBltShift=!1)}(),function(){for(var e=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","msRequestFullscreen","msRequestFullScreen","mozRequestFullScreen","mozRequestFullscreen"],t=document.createElement("div"),s=0;s<e.length;s++)if(t[e[s]]){i.fullscreen=!0,i.requestFullscreen=e[s];break}var a=["cancelFullScreen","exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","msCancelFullScreen","msExitFullscreen","mozCancelFullScreen","mozExitFullscreen"];if(i.fullscreen)for(s=0;s<a.length;s++)if(document[a[s]]){i.cancelFullscreen=a[s];break}window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(i.fullscreenKeyboard=!0)}(),("ontouchstart"in document.documentElement||window.navigator.maxTouchPoints&&window.navigator.maxTouchPoints>=1)&&(i.touch=!0),(window.navigator.msPointerEnabled||window.navigator.pointerEnabled)&&(i.mspointer=!0),i.cocoonJS||("onwheel"in window||i.ie&&"WheelEvent"in window?i.wheelEvent="wheel":"onmousewheel"in window?i.wheelEvent="mousewheel":i.firefox&&"MouseScrollEvent"in window&&(i.wheelEvent="DOMMouseScroll"))},i.Device.canPlayAudio=function(e){return!!("mp3"===e&&this.mp3||"ogg"===e&&(this.ogg||this.opus)||"m4a"===e&&this.m4a||"opus"===e&&this.opus||"wav"===e&&this.wav||"webm"===e&&this.webm||"mp4"===e&&this.dolby)},i.Device.canPlayVideo=function(e){return!!("webm"===e&&(this.webmVideo||this.vp9Video)||"mp4"===e&&(this.mp4Video||this.h264Video)||("ogg"===e||"ogv"===e)&&this.oggVideo||"mpeg"===e&&this.hlsVideo)},i.Device.isConsoleOpen=function(){return!(!window.console||!window.console.firebug)||!(!window.console||(console.clear,!console.profiles))&&console.profiles.length>0},i.Device.isAndroidStockBrowser=function(){var e=window.navigator.userAgent.match(/Android.*AppleWebKit\/([\d.]+)/);return e&&e[1]<537},i.Canvas={create:function(e,t,i,s,a){t=t||256,i=i||256;var n=a?document.createElement("canvas"):PIXI.CanvasPool.create(e,t,i);return"string"==typeof s&&""!==s&&(n.id=s),n.width=t,n.height=i,n.style.display="block",n},setBackgroundColor:function(e,t){return t=t||"rgb(0,0,0)",e.style.backgroundColor=t,e},setTouchAction:function(e,t){return t=t||"none",e.style.msTouchAction=t,e.style["ms-touch-action"]=t,e.style["touch-action"]=t,e},setUserSelect:function(e,t){return t=t||"none",e.style["-webkit-touch-callout"]=t,e.style["-webkit-user-select"]=t,e.style["-khtml-user-select"]=t,e.style["-moz-user-select"]=t,e.style["-ms-user-select"]=t,e.style["user-select"]=t,e.style["-webkit-tap-highlight-color"]="rgba(0, 0, 0, 0)",e},addToDOM:function(e,t,i){var s;return void 0===i&&(i=!0),t&&("string"==typeof t?s=document.getElementById(t):"object"==typeof t&&1===t.nodeType&&(s=t)),s||(s=document.body),i&&s.style&&(s.style.overflow="hidden"),s.appendChild(e),e},removeFromDOM:function(e){e.parentNode&&e.parentNode.removeChild(e)},setTransform:function(e,t,i,s,a,n,o){return e.setTransform(s,n,o,a,t,i),e},setSmoothingEnabled:function(e,t){var s=i.Canvas.getSmoothingPrefix(e);return s&&(e[s]=t),e},getSmoothingPrefix:function(e){var t=["i","webkitI","msI","mozI","oI"];for(var i in t){var s=t[i]+"mageSmoothingEnabled";if(s in e)return s}return null},getSmoothingEnabled:function(e){var t=i.Canvas.getSmoothingPrefix(e);if(t)return e[t]},setImageRenderingCrisp:function(e){for(var t=["optimizeSpeed","crisp-edges","-moz-crisp-edges","-webkit-optimize-contrast","optimize-contrast","pixelated"],i=0;i<t.length;i++)e.style["image-rendering"]=t[i];return e.style.msInterpolationMode="nearest-neighbor",e},setImageRenderingBicubic:function(e){return e.style["image-rendering"]="auto",e.style.msInterpolationMode="bicubic",e}},i.RequestAnimationFrame=function(e,t){void 0===t&&(t=!1),this.game=e,this.isRunning=!1,this.forceSetTimeOut=t;for(var i=["ms","moz","webkit","o"],s=0;s<i.length&&!window.requestAnimationFrame;s++)window.requestAnimationFrame=window[i[s]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[s]+"CancelAnimationFrame"];this._isSetTimeOut=!1,this._onLoop=null,this._timeOutID=null},i.RequestAnimationFrame.prototype={start:function(){this.isRunning=!0;var e=this;!window.requestAnimationFrame||this.forceSetTimeOut?(this._isSetTimeOut=!0,this._onLoop=function(){return e.updateSetTimeout()},this._timeOutID=window.setTimeout(this._onLoop,0)):(this._isSetTimeOut=!1,this._onLoop=function(t){return e.updateRAF(t)},this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateRAF:function(e){this.isRunning&&(this.game.update(Math.floor(e)),this._timeOutID=window.requestAnimationFrame(this._onLoop))},updateSetTimeout:function(){this.isRunning&&(this.game.update(Date.now()),this._timeOutID=window.setTimeout(this._onLoop,this.game.time.timeToCall))},stop:function(){this._isSetTimeOut?clearTimeout(this._timeOutID):window.cancelAnimationFrame(this._timeOutID),this.isRunning=!1},isSetTimeOut:function(){return this._isSetTimeOut},isRAF:function(){return!1===this._isSetTimeOut}},i.RequestAnimationFrame.prototype.constructor=i.RequestAnimationFrame,i.Math={PI2:2*Math.PI,between:function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},fuzzyEqual:function(e,t,i){return void 0===i&&(i=1e-4),Math.abs(e-t)<i},fuzzyLessThan:function(e,t,i){return void 0===i&&(i=1e-4),e<t+i},fuzzyGreaterThan:function(e,t,i){return void 0===i&&(i=1e-4),e>t-i},fuzzyCeil:function(e,t){return void 0===t&&(t=1e-4),Math.ceil(e-t)},fuzzyFloor:function(e,t){return void 0===t&&(t=1e-4),Math.floor(e+t)},average:function(){for(var e=0,t=arguments.length,i=0;i<t;i++)e+=+arguments[i];return e/t},shear:function(e){return e%1},snapTo:function(e,t,i){return void 0===i&&(i=0),0===t?e:(e-=i,e=t*Math.round(e/t),i+e)},snapToFloor:function(e,t,i){return void 0===i&&(i=0),0===t?e:(e-=i,e=t*Math.floor(e/t),i+e)},snapToCeil:function(e,t,i){return void 0===i&&(i=0),0===t?e:(e-=i,e=t*Math.ceil(e/t),i+e)},roundTo:function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=10);var s=Math.pow(i,-t);return Math.round(e*s)/s},floorTo:function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=10);var s=Math.pow(i,-t);return Math.floor(e*s)/s},ceilTo:function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=10);var s=Math.pow(i,-t);return Math.ceil(e*s)/s},rotateToAngle:function(e,t,s){return void 0===s&&(s=.05),e===t?e:(Math.abs(t-e)<=s||Math.abs(t-e)>=i.Math.PI2-s?e=t:(Math.abs(t-e)>Math.PI&&(t<e?t+=i.Math.PI2:t-=i.Math.PI2),t>e?e+=s:t<e&&(e-=s)),e)},getShortestAngle:function(e,t){var i=t-e;return 0===i?0:i-360*Math.floor((i- -180)/360)},angleBetween:function(e,t,i,s){return Math.atan2(s-t,i-e)},angleBetweenY:function(e,t,i,s){return Math.atan2(i-e,s-t)},angleBetweenPoints:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},angleBetweenPointsY:function(e,t){return Math.atan2(t.x-e.x,t.y-e.y)},reverseAngle:function(e){return this.normalizeAngle(e+Math.PI,!0)},normalizeAngle:function(e){return(e%=2*Math.PI)>=0?e:e+2*Math.PI},maxAdd:function(e,t,i){return Math.min(e+t,i)},minSub:function(e,t,i){return Math.max(e-t,i)},wrap:function(e,t,i){var s=i-t;if(s<=0)return 0;var a=(e-t)%s;return a<0&&(a+=s),a+t},wrapValue:function(e,t,i){return e=Math.abs(e),t=Math.abs(t),i=Math.abs(i),(e+t)%i},isOdd:function(e){return!!(1&e)},isEven:function(e){return!(1&e)},min:function(){if(1===arguments.length&&"object"==typeof arguments[0])e=arguments[0];else var e=arguments;for(var t=1,i=0,s=e.length;t<s;t++)e[t]<e[i]&&(i=t);return e[i]},max:function(){if(1===arguments.length&&"object"==typeof arguments[0])e=arguments[0];else var e=arguments;for(var t=1,i=0,s=e.length;t<s;t++)e[t]>e[i]&&(i=t);return e[i]},minProperty:function(e){if(2===arguments.length&&"object"==typeof arguments[1])t=arguments[1];else var t=arguments.slice(1);for(var i=1,s=0,a=t.length;i<a;i++)t[i][e]<t[s][e]&&(s=i);return t[s][e]},maxProperty:function(e){if(2===arguments.length&&"object"==typeof arguments[1])t=arguments[1];else var t=arguments.slice(1);for(var i=1,s=0,a=t.length;i<a;i++)t[i][e]>t[s][e]&&(s=i);return t[s][e]},wrapAngle:function(e,t){return t?this.wrap(e,-Math.PI,Math.PI):this.wrap(e,-180,180)},linearInterpolation:function(e,t){var i=e.length-1,s=i*t,a=Math.floor(s);return t<0?this.linear(e[0],e[1],s):t>1?this.linear(e[i],e[i-1],i-s):this.linear(e[a],e[a+1>i?i:a+1],s-a)},bezierInterpolation:function(e,t){for(var i=0,s=e.length-1,a=0;a<=s;a++)i+=Math.pow(1-t,s-a)*Math.pow(t,a)*e[a]*this.bernstein(s,a);return i},catmullRomInterpolation:function(e,t){var i=e.length-1,s=i*t,a=Math.floor(s);return e[0]===e[i]?(t<0&&(a=Math.floor(s=i*(1+t))),this.catmullRom(e[(a-1+i)%i],e[a],e[(a+1)%i],e[(a+2)%i],s-a)):t<0?e[0]-(this.catmullRom(e[0],e[0],e[1],e[1],-s)-e[0]):t>1?e[i]-(this.catmullRom(e[i],e[i],e[i-1],e[i-1],s-i)-e[i]):this.catmullRom(e[a?a-1:0],e[a],e[i<a+1?i:a+1],e[i<a+2?i:a+2],s-a)},linear:function(e,t,i){return(t-e)*i+e},bernstein:function(e,t){return this.factorial(e)/this.factorial(t)/this.factorial(e-t)},factorial:function(e){if(0===e)return 1;for(var t=e;--e;)t*=e;return t},catmullRom:function(e,t,i,s,a){var n=.5*(i-e),o=.5*(s-t),r=a*a;return(2*t-2*i+n+o)*(a*r)+(-3*t+3*i-2*n-o)*r+n*a+t},difference:function(e,t){return Math.abs(e-t)},roundAwayFromZero:function(e){return e>0?Math.ceil(e):Math.floor(e)},sinCosGenerator:function(e,t,i,s){void 0===t&&(t=1),void 0===i&&(i=1),void 0===s&&(s=1);for(var a=t,n=i,o=s*Math.PI/e,r=[],l=[],h=0;h<e;h++)n-=a*o,a+=n*o,r[h]=n,l[h]=a;return{sin:l,cos:r,length:e}},distance:function(e,t,i,s){var a=e-i,n=t-s;return Math.sqrt(a*a+n*n)},distanceSq:function(e,t,i,s){var a=e-i,n=t-s;return a*a+n*n},distancePow:function(e,t,i,s,a){return void 0===a&&(a=2),Math.sqrt(Math.pow(i-e,a)+Math.pow(s-t,a))},clamp:function(e,t,i){return e<t?t:i<e?i:e},clampBottom:function(e,t){return e<t?t:e},within:function(e,t,i){return Math.abs(e-t)<=i},mapLinear:function(e,t,i,s,a){return s+(e-t)*(a-s)/(i-t)},smoothstep:function(e,t,i){return(e=Math.max(0,Math.min(1,(e-t)/(i-t))))*e*(3-2*e)},smootherstep:function(e,t,i){return(e=Math.max(0,Math.min(1,(e-t)/(i-t))))*e*e*(e*(6*e-15)+10)},sign:function(e){return e<0?-1:e>0?1:0},percent:function(e,t,i){return void 0===i&&(i=0),e>t||i>t?1:e<i||i>e?0:(e-i)/t}};var c=Math.PI/180,p=180/Math.PI;return i.Math.degToRad=function(e){return e*c},i.Math.radToDeg=function(e){return e*p},i.RandomDataGenerator=function(e){void 0===e&&(e=[]),this.c=1,this.s0=0,this.s1=0,this.s2=0,"string"==typeof e?this.state(e):this.sow(e)},i.RandomDataGenerator.prototype={rnd:function(){var e=2091639*this.s0+2.3283064365386963e-10*this.c;return this.c=0|e,this.s0=this.s1,this.s1=this.s2,this.s2=e-this.c,this.s2},sow:function(e){if(this.s0=this.hash(" "),this.s1=this.hash(this.s0),this.s2=this.hash(this.s1),this.c=1,e)for(var t=0;t<e.length&&null!=e[t];t++){var i=e[t];this.s0-=this.hash(i),this.s0+=~~(this.s0<0),this.s1-=this.hash(i),this.s1+=~~(this.s1<0),this.s2-=this.hash(i),this.s2+=~~(this.s2<0)}},hash:function(e){var t,i,s;for(s=4022871197,e=e.toString(),i=0;i<e.length;i++)s+=e.charCodeAt(i),t=.02519603282416938*s,s=t>>>0,t-=s,t*=s,s=t>>>0,t-=s,s+=4294967296*t;return 2.3283064365386963e-10*(s>>>0)},integer:function(){return 4294967296*this.rnd.apply(this)},frac:function(){return this.rnd.apply(this)+1.1102230246251565e-16*(2097152*this.rnd.apply(this)|0)},real:function(){return this.integer()+this.frac()},integerInRange:function(e,t){return Math.floor(this.realInRange(0,t-e+1)+e)},between:function(e,t){return this.integerInRange(e,t)},realInRange:function(e,t){return this.frac()*(t-e)+e},normal:function(){return 1-2*this.frac()},uuid:function(){var e="",t="";for(t=e="";e++<36;t+=~e%5|3*e&4?(15^e?8^this.frac()*(20^e?16:4):4).toString(16):"-");return t},pick:function(e){return e[this.integerInRange(0,e.length-1)]},sign:function(){return this.pick([-1,1])},weightedPick:function(e){return e[~~(Math.pow(this.frac(),2)*(e.length-1)+.5)]},timestamp:function(e,t){return this.realInRange(e||9466848e5,t||1577862e6)},angle:function(){return this.integerInRange(-180,180)},state:function(e){return"string"==typeof e&&e.match(/^!rnd/)&&(e=e.split(","),this.c=parseFloat(e[1]),this.s0=parseFloat(e[2]),this.s1=parseFloat(e[3]),this.s2=parseFloat(e[4])),["!rnd",this.c,this.s0,this.s1,this.s2].join(",")}},i.RandomDataGenerator.prototype.constructor=i.RandomDataGenerator,i.QuadTree=function(e,t,i,s,a,n,o){this.maxObjects=10,this.maxLevels=4,this.level=0,this.bounds={},this.objects=[],this.nodes=[],this._empty=[],this.reset(e,t,i,s,a,n,o)},i.QuadTree.prototype={reset:function(e,t,i,s,a,n,o){this.maxObjects=a||10,this.maxLevels=n||4,this.level=o||0,this.bounds={x:Math.round(e),y:Math.round(t),width:i,height:s,subWidth:Math.floor(i/2),subHeight:Math.floor(s/2),right:Math.round(e)+Math.floor(i/2),bottom:Math.round(t)+Math.floor(s/2)},this.objects.length=0,this.nodes.length=0},populate:function(e){e.forEach(this.populateHandler,this,!0)},populateHandler:function(e){e.body&&e.exists&&this.insert(e.body)},split:function(){this.nodes[0]=new i.QuadTree(this.bounds.right,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[1]=new i.QuadTree(this.bounds.x,this.bounds.y,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[2]=new i.QuadTree(this.bounds.x,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1),this.nodes[3]=new i.QuadTree(this.bounds.right,this.bounds.bottom,this.bounds.subWidth,this.bounds.subHeight,this.maxObjects,this.maxLevels,this.level+1)},insert:function(e){var t,i=0;if(null==this.nodes[0]||-1===(t=this.getIndex(e))){if(this.objects.push(e),this.objects.length>this.maxObjects&&this.level<this.maxLevels)for(null==this.nodes[0]&&this.split();i<this.objects.length;)-1!==(t=this.getIndex(this.objects[i]))?this.nodes[t].insert(this.objects.splice(i,1)[0]):i++}else this.nodes[t].insert(e)},getIndex:function(e){var t=-1;return e.x<this.bounds.right&&e.right<this.bounds.right?e.y<this.bounds.bottom&&e.bottom<this.bounds.bottom?t=1:e.y>this.bounds.bottom&&(t=2):e.x>this.bounds.right&&(e.y<this.bounds.bottom&&e.bottom<this.bounds.bottom?t=0:e.y>this.bounds.bottom&&(t=3)),t},retrieve:function(e){if(e instanceof i.Rectangle)var t=this.objects,s=this.getIndex(e);else{if(!e.body)return this._empty;var t=this.objects,s=this.getIndex(e.body)}return this.nodes[0]&&(-1!==s?t=t.concat(this.nodes[s].retrieve(e)):(t=t.concat(this.nodes[0].retrieve(e)),t=t.concat(this.nodes[1].retrieve(e)),t=t.concat(this.nodes[2].retrieve(e)),t=t.concat(this.nodes[3].retrieve(e)))),t},clear:function(){this.objects.length=0;for(var e=this.nodes.length;e--;)this.nodes[e].clear(),this.nodes.splice(e,1);this.nodes.length=0}},i.QuadTree.prototype.constructor=i.QuadTree,i.Net=function(e){this.game=e},i.Net.prototype={getHostName:function(){return window.location&&window.location.hostname?window.location.hostname:null},checkDomainName:function(e){return-1!==window.location.hostname.indexOf(e)},updateQueryString:function(e,t,i,s){void 0===i&&(i=!1),void 0!==s&&""!==s||(s=window.location.href);var a="",n=new RegExp("([?|&])"+e+"=.*?(&|#|$)(.*)","gi");if(n.test(s))a=void 0!==t&&null!==t?s.replace(n,"$1"+e+"="+t+"$2$3"):s.replace(n,"$1$3").replace(/(&|\?)$/,"");else if(void 0!==t&&null!==t){var o=-1!==s.indexOf("?")?"&":"?",r=s.split("#");s=r[0]+o+e+"="+t,r[1]&&(s+="#"+r[1]),a=s}else a=s;return i?void(window.location.href=a):a},getQueryString:function(e){void 0===e&&(e="");var t={},i=location.search.substring(1).split("&");for(var s in i){var a=i[s].split("=");if(a.length>1){if(e&&e===this.decodeURI(a[0]))return this.decodeURI(a[1]);t[this.decodeURI(a[0])]=this.decodeURI(a[1])}}return t},decodeURI:function(e){return decodeURIComponent(e.replace(/\+/g," "))}},i.Net.prototype.constructor=i.Net,i.TweenManager=function(e){this.game=e,this.frameBased=!1,this._tweens=[],this._add=[],this.easeMap={Power0:i.Easing.Power0,Power1:i.Easing.Power1,Power2:i.Easing.Power2,Power3:i.Easing.Power3,Power4:i.Easing.Power4,Linear:i.Easing.Linear.None,Quad:i.Easing.Quadratic.Out,Cubic:i.Easing.Cubic.Out,Quart:i.Easing.Quartic.Out,Quint:i.Easing.Quintic.Out,Sine:i.Easing.Sinusoidal.Out,Expo:i.Easing.Exponential.Out,Circ:i.Easing.Circular.Out,Elastic:i.Easing.Elastic.Out,Back:i.Easing.Back.Out,Bounce:i.Easing.Bounce.Out,"Quad.easeIn":i.Easing.Quadratic.In,"Cubic.easeIn":i.Easing.Cubic.In,"Quart.easeIn":i.Easing.Quartic.In,"Quint.easeIn":i.Easing.Quintic.In,"Sine.easeIn":i.Easing.Sinusoidal.In,"Expo.easeIn":i.Easing.Exponential.In,"Circ.easeIn":i.Easing.Circular.In,"Elastic.easeIn":i.Easing.Elastic.In,"Back.easeIn":i.Easing.Back.In,"Bounce.easeIn":i.Easing.Bounce.In,"Quad.easeOut":i.Easing.Quadratic.Out,"Cubic.easeOut":i.Easing.Cubic.Out,"Quart.easeOut":i.Easing.Quartic.Out,"Quint.easeOut":i.Easing.Quintic.Out,"Sine.easeOut":i.Easing.Sinusoidal.Out,"Expo.easeOut":i.Easing.Exponential.Out,"Circ.easeOut":i.Easing.Circular.Out,"Elastic.easeOut":i.Easing.Elastic.Out,"Back.easeOut":i.Easing.Back.Out,"Bounce.easeOut":i.Easing.Bounce.Out,"Quad.easeInOut":i.Easing.Quadratic.InOut,"Cubic.easeInOut":i.Easing.Cubic.InOut,"Quart.easeInOut":i.Easing.Quartic.InOut,"Quint.easeInOut":i.Easing.Quintic.InOut,"Sine.easeInOut":i.Easing.Sinusoidal.InOut,"Expo.easeInOut":i.Easing.Exponential.InOut,"Circ.easeInOut":i.Easing.Circular.InOut,"Elastic.easeInOut":i.Easing.Elastic.InOut,"Back.easeInOut":i.Easing.Back.InOut,"Bounce.easeInOut":i.Easing.Bounce.InOut},this.game.onPause.add(this._pauseAll,this),this.game.onResume.add(this._resumeAll,this)},i.TweenManager.prototype={getAll:function(){return this._tweens},removeAll:function(){for(var e=0;e<this._tweens.length;e++)this._tweens[e].pendingDelete=!0;this._add=[]},removeFrom:function(e,t){void 0===t&&(t=!0);if(Array.isArray(e))for(s=0,a=e.length;s<a;s++)this.removeFrom(e[s]);else if(e.type===i.GROUP&&t)for(var s=0,a=e.children.length;s<a;s++)this.removeFrom(e.children[s]);else{for(s=0,a=this._tweens.length;s<a;s++)e===this._tweens[s].target&&this.remove(this._tweens[s]);for(s=0,a=this._add.length;s<a;s++)e===this._add[s].target&&this.remove(this._add[s])}},add:function(e){e._manager=this,this._add.push(e)},create:function(e){return new i.Tween(e,this.game,this)},remove:function(e){var t=this._tweens.indexOf(e);-1!==t?this._tweens[t].pendingDelete=!0:-1!==(t=this._add.indexOf(e))&&(this._add[t].pendingDelete=!0)},update:function(){var e=this._add.length,t=this._tweens.length;if(0===t&&0===e)return!1;for(var i=0;i<t;)this._tweens[i].update(this.game.time.time)?i++:(this._tweens.splice(i,1),t--);return e>0&&(this._tweens=this._tweens.concat(this._add),this._add.length=0),!0},isTweening:function(e){return this._tweens.some(function(t){return t.target===e})},_pauseAll:function(){for(var e=this._tweens.length-1;e>=0;e--)this._tweens[e]._pause()},_resumeAll:function(){for(var e=this._tweens.length-1;e>=0;e--)this._tweens[e]._resume()},pauseAll:function(){for(var e=this._tweens.length-1;e>=0;e--)this._tweens[e].pause()},resumeAll:function(){for(var e=this._tweens.length-1;e>=0;e--)this._tweens[e].resume(!0)}},i.TweenManager.prototype.constructor=i.TweenManager,i.Tween=function(e,t,s){this.game=t,this.target=e,this.manager=s,this.timeline=[],this.reverse=!1,this.timeScale=1,this.repeatCounter=0,this.pendingDelete=!1,this.onStart=new i.Signal,this.onLoop=new i.Signal,this.onRepeat=new i.Signal,this.onChildComplete=new i.Signal,this.onComplete=new i.Signal,this.isRunning=!1,this.current=0,this.properties={},this.chainedTween=null,this.isPaused=!1,this.frameBased=s.frameBased,this._onUpdateCallback=null,this._onUpdateCallbackContext=null,this._pausedTime=0,this._codePaused=!1,this._hasStarted=!1},i.Tween.prototype={to:function(e,t,s,a,n,o,r){return(void 0===t||t<=0)&&(t=1e3),void 0!==s&&null!==s||(s=i.Easing.Default),void 0===a&&(a=!1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=!1),"string"==typeof s&&this.manager.easeMap[s]&&(s=this.manager.easeMap[s]),this.isRunning?this:(this.timeline.push(new i.TweenData(this).to(e,t,s,n,o,r)),a&&this.start(),this)},from:function(e,t,s,a,n,o,r){return void 0===t&&(t=1e3),void 0!==s&&null!==s||(s=i.Easing.Default),void 0===a&&(a=!1),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=!1),"string"==typeof s&&this.manager.easeMap[s]&&(s=this.manager.easeMap[s]),this.isRunning?this:(this.timeline.push(new i.TweenData(this).from(e,t,s,n,o,r)),a&&this.start(),this)},start:function(e){if(void 0===e&&(e=0),null===this.game||null===this.target||0===this.timeline.length||this.isRunning)return this;for(i=0;i<this.timeline.length;i++)for(var t in this.timeline[i].vEnd)this.properties[t]=this.target[t]||0,Array.isArray(this.properties[t])||(this.properties[t]*=1);for(var i=0;i<this.timeline.length;i++)this.timeline[i].loadValues();return this.manager.add(this),this.isRunning=!0,(e<0||e>this.timeline.length-1)&&(e=0),this.current=e,this.timeline[this.current].start(),this},stop:function(e){return void 0===e&&(e=!1),this.isRunning=!1,this._onUpdateCallback=null,this._onUpdateCallbackContext=null,e&&(this.onComplete.dispatch(this.target,this),this._hasStarted=!1,this.chainedTween&&this.chainedTween.start()),this.manager.remove(this),this},updateTweenData:function(e,t,i){if(0===this.timeline.length)return this;if(void 0===i&&(i=0),-1===i)for(var s=0;s<this.timeline.length;s++)this.timeline[s][e]=t;else this.timeline[i][e]=t;return this},delay:function(e,t){return this.updateTweenData("delay",e,t)},repeat:function(e,t,i){return void 0===t&&(t=0),this.updateTweenData("repeatCounter",e,i),this.updateTweenData("repeatDelay",t,i)},repeatDelay:function(e,t){return this.updateTweenData("repeatDelay",e,t)},yoyo:function(e,t,i){return void 0===t&&(t=0),this.updateTweenData("yoyo",e,i),this.updateTweenData("yoyoDelay",t,i)},yoyoDelay:function(e,t){return this.updateTweenData("yoyoDelay",e,t)},easing:function(e,t){return"string"==typeof e&&this.manager.easeMap[e]&&(e=this.manager.easeMap[e]),this.updateTweenData("easingFunction",e,t)},interpolation:function(e,t,s){return void 0===t&&(t=i.Math),this.updateTweenData("interpolationFunction",e,s),this.updateTweenData("interpolationContext",t,s)},repeatAll:function(e){return void 0===e&&(e=0),this.repeatCounter=e,this},chain:function(){for(var e=arguments.length;e--;)e>0?arguments[e-1].chainedTween=arguments[e]:this.chainedTween=arguments[e];return this},loop:function(e){return void 0===e&&(e=!0),this.repeatCounter=e?-1:0,this},onUpdateCallback:function(e,t){return this._onUpdateCallback=e,this._onUpdateCallbackContext=t,this},pause:function(){this.isPaused=!0,this._codePaused=!0,this._pausedTime=this.game.time.time},_pause:function(){this._codePaused||(this.isPaused=!0,this._pausedTime=this.game.time.time)},resume:function(){if(this.isPaused){this.isPaused=!1,this._codePaused=!1;for(var e=0;e<this.timeline.length;e++)this.timeline[e].isRunning||(this.timeline[e].startTime+=this.game.time.time-this._pausedTime)}},_resume:function(){this._codePaused||this.resume()},update:function(e){if(this.pendingDelete||!this.target)return!1;if(this.isPaused)return!0;var t=this.timeline[this.current].update(e);if(t===i.TweenData.PENDING)return!0;if(t===i.TweenData.RUNNING)return this._hasStarted||(this.onStart.dispatch(this.target,this),this._hasStarted=!0),null!==this._onUpdateCallback&&this._onUpdateCallback.call(this._onUpdateCallbackContext,this,this.timeline[this.current].value,this.timeline[this.current]),this.isRunning;if(t===i.TweenData.LOOPED)return-1===this.timeline[this.current].repeatCounter?this.onLoop.dispatch(this.target,this):this.onRepeat.dispatch(this.target,this),!0;if(t===i.TweenData.COMPLETE){var s=!1;return this.reverse?--this.current<0&&(this.current=this.timeline.length-1,s=!0):++this.current===this.timeline.length&&(this.current=0,s=!0),s?-1===this.repeatCounter?(this.timeline[this.current].start(),this.onLoop.dispatch(this.target,this),!0):this.repeatCounter>0?(this.repeatCounter--,this.timeline[this.current].start(),this.onRepeat.dispatch(this.target,this),!0):(this.isRunning=!1,this.onComplete.dispatch(this.target,this),this._hasStarted=!1,this.chainedTween&&this.chainedTween.start(),!1):(this.onChildComplete.dispatch(this.target,this),this.timeline[this.current].start(),!0)}},generateData:function(e,t){if(null===this.game||null===this.target)return null;void 0===e&&(e=60),void 0===t&&(t=[]);for(s=0;s<this.timeline.length;s++)for(var i in this.timeline[s].vEnd)this.properties[i]=this.target[i]||0,Array.isArray(this.properties[i])||(this.properties[i]*=1);for(s=0;s<this.timeline.length;s++)this.timeline[s].loadValues();for(var s=0;s<this.timeline.length;s++)t=t.concat(this.timeline[s].generateData(e));return t}},Object.defineProperty(i.Tween.prototype,"totalDuration",{get:function(){for(var e=0,t=0;t<this.timeline.length;t++)e+=this.timeline[t].duration;return e}}),i.Tween.prototype.constructor=i.Tween,i.TweenData=function(e){this.parent=e,this.game=e.game,this.vStart={},this.vStartCache={},this.vEnd={},this.vEndCache={},this.duration=1e3,this.percent=0,this.value=0,this.repeatCounter=0,this.repeatDelay=0,this.repeatTotal=0,this.interpolate=!1,this.yoyo=!1,this.yoyoDelay=0,this.inReverse=!1,this.delay=0,this.dt=0,this.startTime=null,this.easingFunction=i.Easing.Default,this.interpolationFunction=i.Math.linearInterpolation,this.interpolationContext=i.Math,this.isRunning=!1,this.isFrom=!1},i.TweenData.PENDING=0,i.TweenData.RUNNING=1,i.TweenData.LOOPED=2,i.TweenData.COMPLETE=3,i.TweenData.prototype={to:function(e,t,i,s,a,n){return this.vEnd=e,this.duration=t,this.easingFunction=i,this.delay=s,this.repeatTotal=a,this.yoyo=n,this.isFrom=!1,this},from:function(e,t,i,s,a,n){return this.vEnd=e,this.duration=t,this.easingFunction=i,this.delay=s,this.repeatTotal=a,this.yoyo=n,this.isFrom=!0,this},start:function(){if(this.startTime=this.game.time.time+this.delay,this.parent.reverse?this.dt=this.duration:this.dt=0,this.delay>0?this.isRunning=!1:this.isRunning=!0,this.isFrom)for(var e in this.vStartCache)this.vStart[e]=this.vEndCache[e],this.vEnd[e]=this.vStartCache[e],this.parent.target[e]=this.vStart[e];return this.value=0,this.yoyoCounter=0,this.repeatCounter=this.repeatTotal,this},loadValues:function(){for(var e in this.parent.properties){if(this.vStart[e]=this.parent.properties[e],Array.isArray(this.vEnd[e])){if(0===this.vEnd[e].length)continue;0===this.percent&&(this.vEnd[e]=[this.vStart[e]].concat(this.vEnd[e]))}void 0!==this.vEnd[e]?("string"==typeof this.vEnd[e]&&(this.vEnd[e]=this.vStart[e]+parseFloat(this.vEnd[e],10)),this.parent.properties[e]=this.vEnd[e]):this.vEnd[e]=this.vStart[e],this.vStartCache[e]=this.vStart[e],this.vEndCache[e]=this.vEnd[e]}return this},update:function(e){if(this.isRunning){if(e<this.startTime)return i.TweenData.RUNNING}else{if(!(e>=this.startTime))return i.TweenData.PENDING;this.isRunning=!0}var t=this.parent.frameBased?this.game.time.physicsElapsedMS:this.game.time.elapsedMS;this.parent.reverse?(this.dt-=t*this.parent.timeScale,this.dt=Math.max(this.dt,0)):(this.dt+=t*this.parent.timeScale,this.dt=Math.min(this.dt,this.duration)),this.percent=this.dt/this.duration,this.value=this.easingFunction(this.percent);for(var s in this.vEnd){var a=this.vStart[s],n=this.vEnd[s];Array.isArray(n)?this.parent.target[s]=this.interpolationFunction.call(this.interpolationContext,n,this.value):this.parent.target[s]=a+(n-a)*this.value}return!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent?this.repeat():i.TweenData.RUNNING},generateData:function(e){this.parent.reverse?this.dt=this.duration:this.dt=0;var t=[],i=!1,s=1/e*1e3;do{this.parent.reverse?(this.dt-=s,this.dt=Math.max(this.dt,0)):(this.dt+=s,this.dt=Math.min(this.dt,this.duration)),this.percent=this.dt/this.duration,this.value=this.easingFunction(this.percent);var a={};for(var n in this.vEnd){var o=this.vStart[n],r=this.vEnd[n];Array.isArray(r)?a[n]=this.interpolationFunction(r,this.value):a[n]=o+(r-o)*this.value}t.push(a),(!this.parent.reverse&&1===this.percent||this.parent.reverse&&0===this.percent)&&(i=!0)}while(!i);if(this.yoyo){var l=t.slice();l.reverse(),t=t.concat(l)}return t},repeat:function(){if(this.yoyo){if(this.inReverse&&0===this.repeatCounter){for(var e in this.vStartCache)this.vStart[e]=this.vStartCache[e],this.vEnd[e]=this.vEndCache[e];return this.inReverse=!1,i.TweenData.COMPLETE}this.inReverse=!this.inReverse}else if(0===this.repeatCounter)return i.TweenData.COMPLETE;if(this.inReverse)for(var e in this.vStartCache)this.vStart[e]=this.vEndCache[e],this.vEnd[e]=this.vStartCache[e];else{for(var e in this.vStartCache)this.vStart[e]=this.vStartCache[e],this.vEnd[e]=this.vEndCache[e];this.repeatCounter>0&&this.repeatCounter--}return this.startTime=this.game.time.time,this.yoyo&&this.inReverse?this.startTime+=this.yoyoDelay:this.inReverse||(this.startTime+=this.repeatDelay),this.parent.reverse?this.dt=this.duration:this.dt=0,i.TweenData.LOOPED}},i.TweenData.prototype.constructor=i.TweenData,i.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 0===e?0:1===e?1:1-Math.cos(e*Math.PI/2)},Out:function(e){return 0===e?0:1===e?1:Math.sin(e*Math.PI/2)},InOut:function(e){return 0===e?0:1===e?1:.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),-i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4))},Out:function(e){var t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/.4)+1)},InOut:function(e){var t,i=.1;return 0===e?0:1===e?1:(!i||i<1?(i=1,t=.1):t=.4*Math.asin(1/i)/(2*Math.PI),(e*=2)<1?i*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*-.5:i*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/.4)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-i.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*i.Easing.Bounce.In(2*e):.5*i.Easing.Bounce.Out(2*e-1)+.5}}},i.Easing.Default=i.Easing.Linear.None,i.Easing.Power0=i.Easing.Linear.None,i.Easing.Power1=i.Easing.Quadratic.Out,i.Easing.Power2=i.Easing.Cubic.Out,i.Easing.Power3=i.Easing.Quartic.Out,i.Easing.Power4=i.Easing.Quintic.Out,i.Time=function(e){this.game=e,this.time=0,this.prevTime=0,this.now=0,this.elapsed=0,this.elapsedMS=0,this.physicsElapsed=1/60,this.physicsElapsedMS=1/60*1e3,this.desiredFpsMult=1/60,this._desiredFps=60,this.suggestedFps=this.desiredFps,this.slowMotion=1,this.advancedTiming=!1,this.frames=0,this.fps=0,this.fpsMin=1e3,this.fpsMax=0,this.msMin=1e3,this.msMax=0,this.pauseDuration=0,this.timeToCall=0,this.timeExpected=0,this.events=new i.Timer(this.game,!1),this._frameCount=0,this._elapsedAccumulator=0,this._started=0,this._timeLastSecond=0,this._pauseStarted=0,this._justResumed=!1,this._timers=[]},i.Time.prototype={boot:function(){this._started=Date.now(),this.time=Date.now(),this.events.start(),this.timeExpected=this.time},add:function(e){return this._timers.push(e),e},create:function(e){void 0===e&&(e=!0);var t=new i.Timer(this.game,e);return this._timers.push(t),t},removeAll:function(){for(var e=0;e<this._timers.length;e++)this._timers[e].destroy();this._timers=[],this.events.removeAll()},refresh:function(){var e=this.time;this.time=Date.now(),this.elapsedMS=this.time-e},update:function(e){var t=this.time;this.time=Date.now(),this.elapsedMS=this.time-t,this.prevTime=this.now,this.now=e,this.elapsed=this.now-this.prevTime,this.game.raf._isSetTimeOut&&(this.timeToCall=Math.floor(Math.max(0,1e3/this._desiredFps-(this.timeExpected-e))),this.timeExpected=e+this.timeToCall),this.advancedTiming&&this.updateAdvancedTiming(),this.game.paused||(this.events.update(this.time),this._timers.length&&this.updateTimers())},updateTimers:function(){for(var e=0,t=this._timers.length;e<t;)this._timers[e].update(this.time)?e++:(this._timers.splice(e,1),t--)},updateAdvancedTiming:function(){this._frameCount++,this._elapsedAccumulator+=this.elapsed,this._frameCount>=2*this._desiredFps&&(this.suggestedFps=5*Math.floor(200/(this._elapsedAccumulator/this._frameCount)),this._frameCount=0,this._elapsedAccumulator=0),this.msMin=Math.min(this.msMin,this.elapsed),this.msMax=Math.max(this.msMax,this.elapsed),this.frames++,this.now>this._timeLastSecond+1e3&&(this.fps=Math.round(1e3*this.frames/(this.now-this._timeLastSecond)),this.fpsMin=Math.min(this.fpsMin,this.fps),this.fpsMax=Math.max(this.fpsMax,this.fps),this._timeLastSecond=this.now,this.frames=0)},gamePaused:function(){this._pauseStarted=Date.now(),this.events.pause();for(var e=this._timers.length;e--;)this._timers[e]._pause()},gameResumed:function(){this.time=Date.now(),this.pauseDuration=this.time-this._pauseStarted,this.events.resume();for(var e=this._timers.length;e--;)this._timers[e]._resume()},totalElapsedSeconds:function(){return.001*(this.time-this._started)},elapsedSince:function(e){return this.time-e},elapsedSecondsSince:function(e){return.001*(this.time-e)},reset:function(){this._started=this.time,this.removeAll()}},Object.defineProperty(i.Time.prototype,"desiredFps",{get:function(){return this._desiredFps},set:function(e){this._desiredFps=e,this.physicsElapsed=1/e,this.physicsElapsedMS=1e3*this.physicsElapsed,this.desiredFpsMult=1/e}}),i.Time.prototype.constructor=i.Time,i.Timer=function(e,t){void 0===t&&(t=!0),this.game=e,this.running=!1,this.autoDestroy=t,this.expired=!1,this.elapsed=0,this.events=[],this.onComplete=new i.Signal,this.nextTick=0,this.timeCap=1e3,this.paused=!1,this._codePaused=!1,this._started=0,this._pauseStarted=0,this._pauseTotal=0,this._now=Date.now(),this._len=0,this._marked=0,this._i=0,this._diff=0,this._newTick=0},i.Timer.MINUTE=6e4,i.Timer.SECOND=1e3,i.Timer.HALF=500,i.Timer.QUARTER=250,i.Timer.prototype={create:function(e,t,s,a,n,o){var r=e=Math.round(e);r+=0===this._now?this.game.time.time:this._now;var l=new i.TimerEvent(this,e,r,s,t,a,n,o);return this.events.push(l),this.order(),this.expired=!1,l},add:function(e,t,i){return this.create(e,!1,0,t,i,Array.prototype.slice.call(arguments,3))},repeat:function(e,t,i,s){return this.create(e,!1,t,i,s,Array.prototype.slice.call(arguments,4))},loop:function(e,t,i){return this.create(e,!0,0,t,i,Array.prototype.slice.call(arguments,3))},start:function(e){if(!this.running){this._started=this.game.time.time+(e||0),this.running=!0;for(var t=0;t<this.events.length;t++)this.events[t].tick=this.events[t].delay+this._started}},stop:function(e){this.running=!1,void 0===e&&(e=!0),e&&(this.events.length=0)},remove:function(e){for(var t=0;t<this.events.length;t++)if(this.events[t]===e)return this.events[t].pendingDelete=!0,!0;return!1},order:function(){this.events.length>0&&(this.events.sort(this.sortHandler),this.nextTick=this.events[0].tick)},sortHandler:function(e,t){return e.tick<t.tick?-1:e.tick>t.tick?1:0},clearPendingEvents:function(){for(this._i=this.events.length;this._i--;)this.events[this._i].pendingDelete&&this.events.splice(this._i,1);this._len=this.events.length,this._i=0},update:function(e){if(this.paused)return!0;if(this.elapsed=e-this._now,this._now=e,this.elapsed>this.timeCap&&this.adjustEvents(e-this.elapsed),this._marked=0,this.clearPendingEvents(),this.running&&this._now>=this.nextTick&&this._len>0){for(;this._i<this._len&&this.running&&this._now>=this.events[this._i].tick&&!this.events[this._i].pendingDelete;)this._newTick=this._now+this.events[this._i].delay-(this._now-this.events[this._i].tick),this._newTick<0&&(this._newTick=this._now+this.events[this._i].delay),!0===this.events[this._i].loop?(this.events[this._i].tick=this._newTick,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)):this.events[this._i].repeatCount>0?(this.events[this._i].repeatCount--,this.events[this._i].tick=this._newTick,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)):(this._marked++,this.events[this._i].pendingDelete=!0,this.events[this._i].callback.apply(this.events[this._i].callbackContext,this.events[this._i].args)),this._i++;this.events.length>this._marked?this.order():(this.expired=!0,this.onComplete.dispatch(this))}return!this.expired||!this.autoDestroy},pause:function(){this.running&&(this._codePaused=!0,this.paused||(this._pauseStarted=this.game.time.time,this.paused=!0))},_pause:function(){!this.paused&&this.running&&(this._pauseStarted=this.game.time.time,this.paused=!0)},adjustEvents:function(e){for(var t=0;t<this.events.length;t++)if(!this.events[t].pendingDelete){var i=this.events[t].tick-e;i<0&&(i=0),this.events[t].tick=this._now+i}var s=this.nextTick-e;this.nextTick=s<0?this._now:this._now+s},resume:function(){if(this.paused){var e=this.game.time.time;this._pauseTotal+=e-this._now,this._now=e,this.adjustEvents(this._pauseStarted),this.paused=!1,this._codePaused=!1}},_resume:function(){this._codePaused||this.resume()},removeAll:function(){this.onComplete.removeAll(),this.events.length=0,this._len=0,this._i=0},destroy:function(){this.onComplete.removeAll(),this.running=!1,this.events=[],this._len=0,this._i=0}},Object.defineProperty(i.Timer.prototype,"next",{get:function(){return this.nextTick}}),Object.defineProperty(i.Timer.prototype,"duration",{get:function(){return this.running&&this.nextTick>this._now?this.nextTick-this._now:0}}),Object.defineProperty(i.Timer.prototype,"length",{get:function(){return this.events.length}}),Object.defineProperty(i.Timer.prototype,"ms",{get:function(){return this.running?this._now-this._started-this._pauseTotal:0}}),Object.defineProperty(i.Timer.prototype,"seconds",{get:function(){return this.running?.001*this.ms:0}}),i.Timer.prototype.constructor=i.Timer,i.TimerEvent=function(e,t,i,s,a,n,o,r){this.timer=e,this.delay=t,this.tick=i,this.repeatCount=s-1,this.loop=a,this.callback=n,this.callbackContext=o,this.args=r,this.pendingDelete=!1},i.TimerEvent.prototype.constructor=i.TimerEvent,i.AnimationManager=function(e){this.sprite=e,this.game=e.game,this.currentFrame=null,this.currentAnim=null,this.updateIfVisible=!0,this.isLoaded=!1,this._frameData=null,this._anims={},this._outputFrames=[]},i.AnimationManager.prototype={loadFrameData:function(e,t){if(void 0===e)return!1;if(this.isLoaded)for(var i in this._anims)this._anims[i].updateFrameData(e);return this._frameData=e,void 0===t||null===t?this.frame=0:"string"==typeof t?this.frameName=t:this.frame=t,this.isLoaded=!0,!0},copyFrameData:function(e,t){if(this._frameData=e.clone(),this.isLoaded)for(var i in this._anims)this._anims[i].updateFrameData(this._frameData);return void 0===t||null===t?this.frame=0:"string"==typeof t?this.frameName=t:this.frame=t,this.isLoaded=!0,!0},add:function(e,t,s,a,n){return t=t||[],s=s||60,void 0===a&&(a=!1),void 0===n&&(n=!(!t||"number"!=typeof t[0])),this._outputFrames=[],this._frameData.getFrameIndexes(t,n,this._outputFrames),this._anims[e]=new i.Animation(this.game,this.sprite,e,this._frameData,this._outputFrames,s,a),this.currentAnim=this._anims[e],this.sprite.tilingTexture&&(this.sprite.refreshTexture=!0),this._anims[e]},validateFrames:function(e,t){void 0===t&&(t=!0);for(var i=0;i<e.length;i++)if(!0===t){if(e[i]>this._frameData.total)return!1}else if(!1===this._frameData.checkFrameName(e[i]))return!1;return!0},play:function(e,t,i,s){if(this._anims[e])return this.currentAnim===this._anims[e]?!1===this.currentAnim.isPlaying?(this.currentAnim.paused=!1,this.currentAnim.play(t,i,s)):this.currentAnim:(this.currentAnim&&this.currentAnim.isPlaying&&this.currentAnim.stop(),this.currentAnim=this._anims[e],this.currentAnim.paused=!1,this.currentFrame=this.currentAnim.currentFrame,this.currentAnim.play(t,i,s))},stop:function(e,t){void 0===t&&(t=!1),!this.currentAnim||"string"==typeof e&&e!==this.currentAnim.name||this.currentAnim.stop(t)},update:function(){return!(this.updateIfVisible&&!this.sprite.visible||!this.currentAnim||!this.currentAnim.update()||(this.currentFrame=this.currentAnim.currentFrame,0))},next:function(e){this.currentAnim&&(this.currentAnim.next(e),this.currentFrame=this.currentAnim.currentFrame)},previous:function(e){this.currentAnim&&(this.currentAnim.previous(e),this.currentFrame=this.currentAnim.currentFrame)},getAnimation:function(e){return"string"==typeof e&&this._anims[e]?this._anims[e]:null},refreshFrame:function(){},destroy:function(){e=null;for(var e in this._anims)this._anims.hasOwnProperty(e)&&this._anims[e].destroy();this._anims={},this._outputFrames=[],this._frameData=null,this.currentAnim=null,this.currentFrame=null,this.sprite=null,this.game=null}},i.AnimationManager.prototype.constructor=i.AnimationManager,Object.defineProperty(i.AnimationManager.prototype,"frameData",{get:function(){return this._frameData}}),Object.defineProperty(i.AnimationManager.prototype,"frameTotal",{get:function(){return this._frameData.total}}),Object.defineProperty(i.AnimationManager.prototype,"paused",{get:function(){return this.currentAnim.isPaused},set:function(e){this.currentAnim.paused=e}}),Object.defineProperty(i.AnimationManager.prototype,"name",{get:function(){if(this.currentAnim)return this.currentAnim.name}}),Object.defineProperty(i.AnimationManager.prototype,"frame",{get:function(){if(this.currentFrame)return this.currentFrame.index},set:function(e){"number"==typeof e&&this._frameData&&null!==this._frameData.getFrame(e)&&(this.currentFrame=this._frameData.getFrame(e),this.currentFrame&&this.sprite.setFrame(this.currentFrame))}}),Object.defineProperty(i.AnimationManager.prototype,"frameName",{get:function(){if(this.currentFrame)return this.currentFrame.name},set:function(e){"string"==typeof e&&this._frameData&&null!==this._frameData.getFrameByName(e)&&(this.currentFrame=this._frameData.getFrameByName(e),this.currentFrame&&(this._frameIndex=this.currentFrame.index,this.sprite.setFrame(this.currentFrame)))}}),i.Animation=function(e,t,s,a,n,o,r){void 0===r&&(r=!1),this.game=e,this._parent=t,this._frameData=a,this.name=s,this._frames=[],this._frames=this._frames.concat(n),this.delay=1e3/o,this.loop=r,this.loopCount=0,this.killOnComplete=!1,this.isFinished=!1,this.isPlaying=!1,this.isPaused=!1,this._pauseStartTime=0,this._frameIndex=0,this._frameDiff=0,this._frameSkip=1,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.onStart=new i.Signal,this.onUpdate=null,this.onComplete=new i.Signal,this.onLoop=new i.Signal,this.isReversed=!1,this.game.onPause.add(this.onPause,this),this.game.onResume.add(this.onResume,this)},i.Animation.prototype={play:function(e,t,i){return"number"==typeof e&&(this.delay=1e3/e),"boolean"==typeof t&&(this.loop=t),void 0!==i&&(this.killOnComplete=i),this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.time,this._timeNextFrame=this.game.time.time+this.delay,this._frameIndex=this.isReversed?this._frames.length-1:0,this.updateCurrentFrame(!1,!0),this._parent.events.onAnimationStart$dispatch(this._parent,this),this.onStart.dispatch(this._parent,this),this._parent.animations.currentAnim=this,this._parent.animations.currentFrame=this.currentFrame,this},restart:function(){this.isPlaying=!0,this.isFinished=!1,this.paused=!1,this.loopCount=0,this._timeLastFrame=this.game.time.time,this._timeNextFrame=this.game.time.time+this.delay,this._frameIndex=0,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this._parent.setFrame(this.currentFrame),this._parent.animations.currentAnim=this,this._parent.animations.currentFrame=this.currentFrame,this.onStart.dispatch(this._parent,this)},reverse:function(){return this.reversed=!this.reversed,this},reverseOnce:function(){return this.onComplete.addOnce(this.reverse,this),this.reverse()},setFrame:function(e,t){var i;if(void 0===t&&(t=!1),"string"==typeof e)for(s=0;s<this._frames.length;s++)this._frameData.getFrame(this._frames[s]).name===e&&(i=s);else if("number"==typeof e)if(t)i=e;else for(var s=0;s<this._frames.length;s++)this._frames[s]===e&&(i=s);i&&(this._frameIndex=i-1,this._timeNextFrame=this.game.time.time,this.update())},stop:function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this.isPlaying=!1,this.isFinished=!0,this.paused=!1,e&&(this.currentFrame=this._frameData.getFrame(this._frames[0]),this._parent.setFrame(this.currentFrame)),t&&(this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this))},onPause:function(){this.isPlaying&&(this._frameDiff=this._timeNextFrame-this.game.time.time)},onResume:function(){this.isPlaying&&(this._timeNextFrame=this.game.time.time+this._frameDiff)},update:function(){return!this.isPaused&&!!(this.isPlaying&&this.game.time.time>=this._timeNextFrame)&&(this._frameSkip=1,this._frameDiff=this.game.time.time-this._timeNextFrame,this._timeLastFrame=this.game.time.time,this._frameDiff>this.delay&&(this._frameSkip=Math.floor(this._frameDiff/this.delay),this._frameDiff-=this._frameSkip*this.delay),this._timeNextFrame=this.game.time.time+(this.delay-this._frameDiff),this.isReversed?this._frameIndex-=this._frameSkip:this._frameIndex+=this._frameSkip,!this.isReversed&&this._frameIndex>=this._frames.length||this.isReversed&&this._frameIndex<=-1?this.loop?(this._frameIndex=Math.abs(this._frameIndex)%this._frames.length,this.isReversed&&(this._frameIndex=this._frames.length-1-this._frameIndex),this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&this._parent.setFrame(this.currentFrame),this.loopCount++,this._parent.events.onAnimationLoop$dispatch(this._parent,this),this.onLoop.dispatch(this._parent,this),!this.onUpdate||(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData)):(this.complete(),!1):this.updateCurrentFrame(!0))},updateCurrentFrame:function(e,t){if(void 0===t&&(t=!1),!this._frameData)return!1;var i=this.currentFrame.index;return this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.currentFrame&&(t||!t&&i!==this.currentFrame.index)&&this._parent.setFrame(this.currentFrame),!this.onUpdate||!e||(this.onUpdate.dispatch(this,this.currentFrame),!!this._frameData)},next:function(e){void 0===e&&(e=1);var t=this._frameIndex+e;t>=this._frames.length&&(this.loop?t%=this._frames.length:t=this._frames.length-1),t!==this._frameIndex&&(this._frameIndex=t,this.updateCurrentFrame(!0))},previous:function(e){void 0===e&&(e=1);var t=this._frameIndex-e;t<0&&(this.loop?t=this._frames.length+t:t++),t!==this._frameIndex&&(this._frameIndex=t,this.updateCurrentFrame(!0))},updateFrameData:function(e){this._frameData=e,this.currentFrame=this._frameData?this._frameData.getFrame(this._frames[this._frameIndex%this._frames.length]):null},destroy:function(){this._frameData&&(this.game.onPause.remove(this.onPause,this),this.game.onResume.remove(this.onResume,this),this.game=null,this._parent=null,this._frames=null,this._frameData=null,this.currentFrame=null,this.isPlaying=!1,this.onStart.dispose(),this.onLoop.dispose(),this.onComplete.dispose(),this.onUpdate&&this.onUpdate.dispose())},complete:function(){this._frameIndex=this._frames.length-1,this.currentFrame=this._frameData.getFrame(this._frames[this._frameIndex]),this.isPlaying=!1,this.isFinished=!0,this.paused=!1,this._parent.events.onAnimationComplete$dispatch(this._parent,this),this.onComplete.dispatch(this._parent,this),this.killOnComplete&&this._parent.kill()}},i.Animation.prototype.constructor=i.Animation,Object.defineProperty(i.Animation.prototype,"paused",{get:function(){return this.isPaused},set:function(e){this.isPaused=e,e?this._pauseStartTime=this.game.time.time:this.isPlaying&&(this._timeNextFrame=this.game.time.time+this.delay)}}),Object.defineProperty(i.Animation.prototype,"reversed",{get:function(){return this.isReversed},set:function(e){this.isReversed=e}}),Object.defineProperty(i.Animation.prototype,"frameTotal",{get:function(){return this._frames.length}}),Object.defineProperty(i.Animation.prototype,"frame",{get:function(){return null!==this.currentFrame?this.currentFrame.index:this._frameIndex},set:function(e){this.currentFrame=this._frameData.getFrame(this._frames[e]),null!==this.currentFrame&&(this._frameIndex=e,this._parent.setFrame(this.currentFrame),this.onUpdate&&this.onUpdate.dispatch(this,this.currentFrame))}}),Object.defineProperty(i.Animation.prototype,"speed",{get:function(){return 1e3/this.delay},set:function(e){e>0&&(this.delay=1e3/e)}}),Object.defineProperty(i.Animation.prototype,"enableUpdate",{get:function(){return null!==this.onUpdate},set:function(e){e&&null===this.onUpdate?this.onUpdate=new i.Signal:e||null===this.onUpdate||(this.onUpdate.dispose(),this.onUpdate=null)}}),i.Animation.generateFrameNames=function(e,t,s,a,n){void 0===a&&(a="");var o=[],r="";if(t<s)for(l=t;l<=s;l++)r="number"==typeof n?i.Utils.pad(l.toString(),n,"0",1):l.toString(),r=e+r+a,o.push(r);else for(var l=t;l>=s;l--)r="number"==typeof n?i.Utils.pad(l.toString(),n,"0",1):l.toString(),r=e+r+a,o.push(r);return o},i.Frame=function(e,t,s,a,n,o){this.index=e,this.x=t,this.y=s,this.width=a,this.height=n,this.name=o,this.centerX=Math.floor(a/2),this.centerY=Math.floor(n/2),this.distance=i.Math.distance(0,0,a,n),this.rotated=!1,this.rotationDirection="cw",this.trimmed=!1,this.sourceSizeW=a,this.sourceSizeH=n,this.spriteSourceSizeX=0,this.spriteSourceSizeY=0,this.spriteSourceSizeW=0,this.spriteSourceSizeH=0,this.right=this.x+this.width,this.bottom=this.y+this.height},i.Frame.prototype={resize:function(e,t){this.width=e,this.height=t,this.centerX=Math.floor(e/2),this.centerY=Math.floor(t/2),this.distance=i.Math.distance(0,0,e,t),this.sourceSizeW=e,this.sourceSizeH=t,this.right=this.x+e,this.bottom=this.y+t},setTrim:function(e,t,i,s,a,n,o){this.trimmed=e,e&&(this.sourceSizeW=t,this.sourceSizeH=i,this.centerX=Math.floor(t/2),this.centerY=Math.floor(i/2),this.spriteSourceSizeX=s,this.spriteSourceSizeY=a,this.spriteSourceSizeW=n,this.spriteSourceSizeH=o)},clone:function(){var e=new i.Frame(this.index,this.x,this.y,this.width,this.height,this.name);for(var t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},getRect:function(e){return void 0===e?e=new i.Rectangle(this.x,this.y,this.width,this.height):e.setTo(this.x,this.y,this.width,this.height),e}},i.Frame.prototype.constructor=i.Frame,i.FrameData=function(){this._frames=[],this._frameNames=[]},i.FrameData.prototype={addFrame:function(e){return e.index=this._frames.length,this._frames.push(e),""!==e.name&&(this._frameNames[e.name]=e.index),e},getFrame:function(e){return e>=this._frames.length&&(e=0),this._frames[e]},getFrameByName:function(e){return"number"==typeof this._frameNames[e]?this._frames[this._frameNames[e]]:null},checkFrameName:function(e){return null!=this._frameNames[e]},clone:function(){for(var e=new i.FrameData,t=0;t<this._frames.length;t++)e._frames.push(this._frames[t].clone());for(var s in this._frameNames)this._frameNames.hasOwnProperty(s)&&e._frameNames.push(this._frameNames[s]);return e},getFrameRange:function(e,t,i){void 0===i&&(i=[]);for(var s=e;s<=t;s++)i.push(this._frames[s]);return i},getFrames:function(e,t,i){if(void 0===t&&(t=!0),void 0===i&&(i=[]),void 0===e||0===e.length)for(s=0;s<this._frames.length;s++)i.push(this._frames[s]);else for(var s=0;s<e.length;s++)t?i.push(this.getFrame(e[s])):i.push(this.getFrameByName(e[s]));return i},getFrameIndexes:function(e,t,i){if(void 0===t&&(t=!0),void 0===i&&(i=[]),void 0===e||0===e.length)for(s=0;s<this._frames.length;s++)i.push(this._frames[s].index);else for(var s=0;s<e.length;s++)t&&this._frames[e[s]]?i.push(this._frames[e[s]].index):this.getFrameByName(e[s])&&i.push(this.getFrameByName(e[s]).index);return i},destroy:function(){this._frames=null,this._frameNames=null}},i.FrameData.prototype.constructor=i.FrameData,Object.defineProperty(i.FrameData.prototype,"total",{get:function(){return this._frames.length}}),i.AnimationParser={spriteSheet:function(e,t,s,a,n,o,r){var l=t;if("string"==typeof t&&(l=e.cache.getImage(t)),null===l)return null;var h=l.width,c=l.height;s<=0&&(s=Math.floor(-h/Math.min(-1,s))),a<=0&&(a=Math.floor(-c/Math.min(-1,a)));var p=Math.floor((h-o)/(s+r))*Math.floor((c-o)/(a+r));if(-1!==n&&(p=n),0===h||0===c||h<s||c<a||0===p)return null;for(var d=new i.FrameData,u=o,m=o,g=0;g<p;g++)d.addFrame(new i.Frame(g,u,m,s,a,"")),(u+=s+r)+s>h&&(u=o,m+=a+r);return d},JSONData:function(e,t){if(t.frames){for(var s,a=new i.FrameData,n=t.frames,o=0;o<n.length;o++)s=a.addFrame(new i.Frame(o,n[o].frame.x,n[o].frame.y,n[o].frame.w,n[o].frame.h,n[o].filename)),n[o].trimmed&&s.setTrim(n[o].trimmed,n[o].sourceSize.w,n[o].sourceSize.h,n[o].spriteSourceSize.x,n[o].spriteSourceSize.y,n[o].spriteSourceSize.w,n[o].spriteSourceSize.h);return a}},JSONDataPyxel:function(e,t){if(["layers","tilewidth","tileheight","tileswide","tileshigh"].forEach(function(e){t[e]}),1===t.layers.length){for(var s=new i.FrameData,a=t.tileheight,n=t.tilewidth,o=t.layers[0].tiles,r=0;r<o.length;r++)s.addFrame(new i.Frame(r,o[r].x,o[r].y,n,a,"frame_"+r)).setTrim(!1);return s}},JSONDataHash:function(e,t){if(t.frames){var s,a=new i.FrameData,n=t.frames,o=0;for(var r in n)s=a.addFrame(new i.Frame(o,n[r].frame.x,n[r].frame.y,n[r].frame.w,n[r].frame.h,r)),n[r].trimmed&&s.setTrim(n[r].trimmed,n[r].sourceSize.w,n[r].sourceSize.h,n[r].spriteSourceSize.x,n[r].spriteSourceSize.y,n[r].spriteSourceSize.w,n[r].spriteSourceSize.h),o++;return a}},XMLData:function(e,t){if(t.getElementsByTagName("TextureAtlas")){for(var s,a,n,o,r,l,h,c,p,d,u,m=new i.FrameData,g=t.getElementsByTagName("SubTexture"),y=0;y<g.length;y++)n=g[y].attributes,a=n.name.value,o=parseInt(n.x.value,10),r=parseInt(n.y.value,10),l=parseInt(n.width.value,10),h=parseInt(n.height.value,10),c=null,p=null,n.frameX&&(c=Math.abs(parseInt(n.frameX.value,10)),p=Math.abs(parseInt(n.frameY.value,10)),d=parseInt(n.frameWidth.value,10),u=parseInt(n.frameHeight.value,10)),s=m.addFrame(new i.Frame(y,o,r,l,h,a)),null===c&&null===p||s.setTrim(!0,l,h,c,p,d,u);return m}}},i.Cache=function(e){this.game=e,this.autoResolveURL=!1,this._cache={canvas:{},image:{},texture:{},sound:{},video:{},text:{},json:{},xml:{},physics:{},tilemap:{},binary:{},bitmapData:{},bitmapFont:{},shader:{},renderTexture:{}},this._urlMap={},this._urlResolver=new Image,this._urlTemp=null,this.onSoundUnlock=new i.Signal,this._cacheMap=[],this._cacheMap[i.Cache.CANVAS]=this._cache.canvas,this._cacheMap[i.Cache.IMAGE]=this._cache.image,this._cacheMap[i.Cache.TEXTURE]=this._cache.texture,this._cacheMap[i.Cache.SOUND]=this._cache.sound,this._cacheMap[i.Cache.TEXT]=this._cache.text,this._cacheMap[i.Cache.PHYSICS]=this._cache.physics,this._cacheMap[i.Cache.TILEMAP]=this._cache.tilemap,this._cacheMap[i.Cache.BINARY]=this._cache.binary,this._cacheMap[i.Cache.BITMAPDATA]=this._cache.bitmapData,this._cacheMap[i.Cache.BITMAPFONT]=this._cache.bitmapFont,this._cacheMap[i.Cache.JSON]=this._cache.json,this._cacheMap[i.Cache.XML]=this._cache.xml,this._cacheMap[i.Cache.VIDEO]=this._cache.video,this._cacheMap[i.Cache.SHADER]=this._cache.shader,this._cacheMap[i.Cache.RENDER_TEXTURE]=this._cache.renderTexture,this.addDefaultImage(),this.addMissingImage()},i.Cache.CANVAS=1,i.Cache.IMAGE=2,i.Cache.TEXTURE=3,i.Cache.SOUND=4,i.Cache.TEXT=5,i.Cache.PHYSICS=6,i.Cache.TILEMAP=7,i.Cache.BINARY=8,i.Cache.BITMAPDATA=9,i.Cache.BITMAPFONT=10,i.Cache.JSON=11,i.Cache.XML=12,i.Cache.VIDEO=13,i.Cache.SHADER=14,i.Cache.RENDER_TEXTURE=15,i.Cache.DEFAULT=null,i.Cache.MISSING=null,i.Cache.prototype={addCanvas:function(e,t,i){void 0===i&&(i=t.getContext("2d")),this._cache.canvas[e]={canvas:t,context:i}},addImage:function(e,t,s){this.checkImageKey(e)&&this.removeImage(e);var a={key:e,url:t,data:s,base:new PIXI.BaseTexture(s),frame:new i.Frame(0,0,0,s.width,s.height,e),frameData:new i.FrameData};return a.frameData.addFrame(new i.Frame(0,0,0,s.width,s.height,t)),this._cache.image[e]=a,this._resolveURL(t,a),"__default"===e?i.Cache.DEFAULT=new PIXI.Texture(a.base):"__missing"===e&&(i.Cache.MISSING=new PIXI.Texture(a.base)),a},addDefaultImage:function(){var e=new Image;e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgAQMAAABJtOi3AAAAA1BMVEX///+nxBvIAAAAAXRSTlMAQObYZgAAABVJREFUeF7NwIEAAAAAgKD9qdeocAMAoAABm3DkcAAAAABJRU5ErkJggg==";var t=this.addImage("__default",null,e);t.base.skipRender=!0,i.Cache.DEFAULT=new PIXI.Texture(t.base)},addMissingImage:function(){var e=new Image;e.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAJ9JREFUeNq01ssOwyAMRFG46v//Mt1ESmgh+DFmE2GPOBARKb2NVjo+17PXLD8a1+pl5+A+wSgFygymWYHBb0FtsKhJDdZlncG2IzJ4ayoMDv20wTmSMzClEgbWYNTAkQ0Z+OJ+A/eWnAaR9+oxCF4Os0H8htsMUp+pwcgBBiMNnAwF8GqIgL2hAzaGFFgZauDPKABmowZ4GL369/0rwACp2yA/ttmvsQAAAABJRU5ErkJggg==";var t=this.addImage("__missing",null,e);i.Cache.MISSING=new PIXI.Texture(t.base)},addSound:function(e,t,i,s,a){void 0===s&&(s=!0,a=!1),void 0===a&&(s=!1,a=!0);var n=!1;a&&(n=!0),this._cache.sound[e]={url:t,data:i,isDecoding:!1,decoded:n,webAudio:s,audioTag:a,locked:this.game.sound.touchLocked},this._resolveURL(t,this._cache.sound[e])},addText:function(e,t,i){this._cache.text[e]={url:t,data:i},this._resolveURL(t,this._cache.text[e])},addPhysicsData:function(e,t,i,s){this._cache.physics[e]={url:t,data:i,format:s},this._resolveURL(t,this._cache.physics[e])},addTilemap:function(e,t,i,s){this._cache.tilemap[e]={url:t,data:i,format:s},this._resolveURL(t,this._cache.tilemap[e])},addBinary:function(e,t){this._cache.binary[e]=t},addBitmapData:function(e,t,s){return t.key=e,void 0===s&&(s=new i.FrameData).addFrame(t.textureFrame),this._cache.bitmapData[e]={data:t,frameData:s},t},addBitmapFont:function(e,t,s,a,n,o,r){var l={url:t,data:s,font:null,base:new PIXI.BaseTexture(s)};void 0===o&&(o=0),void 0===r&&(r=0),l.font="json"===n?i.LoaderParser.jsonBitmapFont(a,l.base,o,r):i.LoaderParser.xmlBitmapFont(a,l.base,o,r),this._cache.bitmapFont[e]=l,this._resolveURL(t,l)},addJSON:function(e,t,i){this._cache.json[e]={url:t,data:i},this._resolveURL(t,this._cache.json[e])},addXML:function(e,t,i){this._cache.xml[e]={url:t,data:i},this._resolveURL(t,this._cache.xml[e])},addVideo:function(e,t,i,s){this._cache.video[e]={url:t,data:i,isBlob:s,locked:!0},this._resolveURL(t,this._cache.video[e])},addShader:function(e,t,i){this._cache.shader[e]={url:t,data:i},this._resolveURL(t,this._cache.shader[e])},addRenderTexture:function(e,t){this._cache.renderTexture[e]={texture:t,frame:new i.Frame(0,0,0,t.width,t.height,"","")}},addSpriteSheet:function(e,t,s,a,n,o,r,l){void 0===o&&(o=-1),void 0===r&&(r=0),void 0===l&&(l=0);var h={key:e,url:t,data:s,frameWidth:a,frameHeight:n,margin:r,spacing:l,base:new PIXI.BaseTexture(s),frameData:i.AnimationParser.spriteSheet(this.game,s,a,n,o,r,l)};this._cache.image[e]=h,this._resolveURL(t,h)},addTextureAtlas:function(e,t,s,a,n){var o={key:e,url:t,data:s,base:new PIXI.BaseTexture(s)};n===i.Loader.TEXTURE_ATLAS_XML_STARLING?o.frameData=i.AnimationParser.XMLData(this.game,a,e):n===i.Loader.TEXTURE_ATLAS_JSON_PYXEL?o.frameData=i.AnimationParser.JSONDataPyxel(this.game,a,e):Array.isArray(a.frames)?o.frameData=i.AnimationParser.JSONData(this.game,a,e):o.frameData=i.AnimationParser.JSONDataHash(this.game,a,e),this._cache.image[e]=o,this._resolveURL(t,o)},reloadSound:function(e){var t=this,i=this.getSound(e);i&&(i.data.src=i.url,i.data.addEventListener("canplaythrough",function(){return t.reloadSoundComplete(e)},!1),i.data.load())},reloadSoundComplete:function(e){var t=this.getSound(e);t&&(t.locked=!1,this.onSoundUnlock.dispatch(e))},updateSound:function(e,t,i){var s=this.getSound(e);s&&(s[t]=i)},decodedSound:function(e,t){var i=this.getSound(e);i.data=t,i.decoded=!0,i.isDecoding=!1},isSoundDecoded:function(e){var t=this.getItem(e,i.Cache.SOUND,"isSoundDecoded");if(t)return t.decoded},isSoundReady:function(e){var t=this.getItem(e,i.Cache.SOUND,"isSoundDecoded");if(t)return t.decoded&&!this.game.sound.touchLocked},checkKey:function(e,t){return!!this._cacheMap[e][t]},checkURL:function(e){return!!this._urlMap[this._resolveURL(e)]},checkCanvasKey:function(e){return this.checkKey(i.Cache.CANVAS,e)},checkImageKey:function(e){return this.checkKey(i.Cache.IMAGE,e)},checkTextureKey:function(e){return this.checkKey(i.Cache.TEXTURE,e)},checkSoundKey:function(e){return this.checkKey(i.Cache.SOUND,e)},checkTextKey:function(e){return this.checkKey(i.Cache.TEXT,e)},checkPhysicsKey:function(e){return this.checkKey(i.Cache.PHYSICS,e)},checkTilemapKey:function(e){return this.checkKey(i.Cache.TILEMAP,e)},checkBinaryKey:function(e){return this.checkKey(i.Cache.BINARY,e)},checkBitmapDataKey:function(e){return this.checkKey(i.Cache.BITMAPDATA,e)},checkBitmapFontKey:function(e){return this.checkKey(i.Cache.BITMAPFONT,e)},checkJSONKey:function(e){return this.checkKey(i.Cache.JSON,e)},checkXMLKey:function(e){return this.checkKey(i.Cache.XML,e)},checkVideoKey:function(e){return this.checkKey(i.Cache.VIDEO,e)},checkShaderKey:function(e){return this.checkKey(i.Cache.SHADER,e)},checkRenderTextureKey:function(e){return this.checkKey(i.Cache.RENDER_TEXTURE,e)},getItem:function(e,t,i,s){return this.checkKey(t,e)?void 0===s?this._cacheMap[t][e]:this._cacheMap[t][e][s]:null},getCanvas:function(e){return this.getItem(e,i.Cache.CANVAS,"getCanvas","canvas")},getImage:function(e,t){void 0!==e&&null!==e||(e="__default"),void 0===t&&(t=!1);var s=this.getItem(e,i.Cache.IMAGE,"getImage");return null===s&&(s=this.getItem("__missing",i.Cache.IMAGE,"getImage")),t?s:s.data},getTextureFrame:function(e){return this.getItem(e,i.Cache.TEXTURE,"getTextureFrame","frame")},getSound:function(e){return this.getItem(e,i.Cache.SOUND,"getSound")},getSoundData:function(e){return this.getItem(e,i.Cache.SOUND,"getSoundData","data")},getText:function(e){return this.getItem(e,i.Cache.TEXT,"getText","data")},getPhysicsData:function(e,t,s){var a=this.getItem(e,i.Cache.PHYSICS,"getPhysicsData","data");if(null===a||void 0===t||null===t)return a;if(a[t]){var n=a[t];if(!n||!s)return n;for(var o in n)if((o=n[o]).fixtureKey===s)return o}return null},getTilemapData:function(e){return this.getItem(e,i.Cache.TILEMAP,"getTilemapData")},getBinary:function(e){return this.getItem(e,i.Cache.BINARY,"getBinary")},getBitmapData:function(e){return this.getItem(e,i.Cache.BITMAPDATA,"getBitmapData","data")},getBitmapFont:function(e){return this.getItem(e,i.Cache.BITMAPFONT,"getBitmapFont")},getJSON:function(e,t){var s=this.getItem(e,i.Cache.JSON,"getJSON","data");return s?t?i.Utils.extend(!0,Array.isArray(s)?[]:{},s):s:null},getXML:function(e){return this.getItem(e,i.Cache.XML,"getXML","data")},getVideo:function(e){return this.getItem(e,i.Cache.VIDEO,"getVideo")},getShader:function(e){return this.getItem(e,i.Cache.SHADER,"getShader","data")},getRenderTexture:function(e){return this.getItem(e,i.Cache.RENDER_TEXTURE,"getRenderTexture")},getBaseTexture:function(e,t){return void 0===t&&(t=i.Cache.IMAGE),this.getItem(e,t,"getBaseTexture","base")},getFrame:function(e,t){return void 0===t&&(t=i.Cache.IMAGE),this.getItem(e,t,"getFrame","frame")},getFrameCount:function(e,t){var i=this.getFrameData(e,t);return i?i.total:0},getFrameData:function(e,t){return void 0===t&&(t=i.Cache.IMAGE),this.getItem(e,t,"getFrameData","frameData")},hasFrameData:function(e,t){return void 0===t&&(t=i.Cache.IMAGE),null!==this.getItem(e,t,"","frameData")},updateFrameData:function(e,t,s){void 0===s&&(s=i.Cache.IMAGE),this._cacheMap[s][e]&&(this._cacheMap[s][e].frameData=t)},getFrameByIndex:function(e,t,i){var s=this.getFrameData(e,i);return s?s.getFrame(t):null},getFrameByName:function(e,t,i){var s=this.getFrameData(e,i);return s?s.getFrameByName(t):null},getURL:function(e){return(e=this._resolveURL(e))?this._urlMap[e]:null},getKeys:function(e){void 0===e&&(e=i.Cache.IMAGE);var t=[];if(this._cacheMap[e])for(var s in this._cacheMap[e])"__default"!==s&&"__missing"!==s&&t.push(s);return t},removeCanvas:function(e){delete this._cache.canvas[e]},removeImage:function(e,t){void 0===t&&(t=!0);var i=this.getImage(e,!0);t&&i.base&&i.base.destroy(),delete this._cache.image[e]},removeSound:function(e){delete this._cache.sound[e]},removeText:function(e){delete this._cache.text[e]},removePhysics:function(e){delete this._cache.physics[e]},removeTilemap:function(e){delete this._cache.tilemap[e]},removeBinary:function(e){delete this._cache.binary[e]},removeBitmapData:function(e){delete this._cache.bitmapData[e]},removeBitmapFont:function(e){delete this._cache.bitmapFont[e]},removeJSON:function(e){delete this._cache.json[e]},removeXML:function(e){delete this._cache.xml[e]},removeVideo:function(e){delete this._cache.video[e]},removeShader:function(e){delete this._cache.shader[e]},removeRenderTexture:function(e){delete this._cache.renderTexture[e]},removeSpriteSheet:function(e){delete this._cache.spriteSheet[e]},removeTextureAtlas:function(e){delete this._cache.atlas[e]},clearGLTextures:function(){for(var e in this._cache.image)this._cache.image[e].base._glTextures=[]},_resolveURL:function(e,t){return this.autoResolveURL?(this._urlResolver.src=this.game.load.baseURL+e,this._urlTemp=this._urlResolver.src,this._urlResolver.src="",t&&(this._urlMap[this._urlTemp]=t),this._urlTemp):null},destroy:function(){for(var e=0;e<this._cacheMap.length;e++){var t=this._cacheMap[e];for(var i in t)"__default"!==i&&"__missing"!==i&&(t[i].destroy&&t[i].destroy(),delete t[i])}this._urlMap=null,this._urlResolver=null,this._urlTemp=null}},i.Cache.prototype.constructor=i.Cache,i.Loader=function(e){this.game=e,this.cache=e.cache,this.resetLocked=!1,this.isLoading=!1,this.hasLoaded=!1,this.preloadSprite=null,this.crossOrigin=!1,this.baseURL="",this.path="",this.headers={requestedWith:!1,json:"application/json",xml:"application/xml"},this.onLoadStart=new i.Signal,this.onLoadComplete=new i.Signal,this.onPackComplete=new i.Signal,this.onFileStart=new i.Signal,this.onFileComplete=new i.Signal,this.onFileError=new i.Signal,this.useXDomainRequest=!1,this._warnedAboutXDomainRequest=!1,this.enableParallel=!0,this.maxParallelDownloads=4,this._withSyncPointDepth=0,this._fileList=[],this._flightQueue=[],this._processingHead=0,this._fileLoadStarted=!1,this._totalPackCount=0,this._totalFileCount=0,this._loadedPackCount=0,this._loadedFileCount=0},i.Loader.TEXTURE_ATLAS_JSON_ARRAY=0,i.Loader.TEXTURE_ATLAS_JSON_HASH=1,i.Loader.TEXTURE_ATLAS_XML_STARLING=2,i.Loader.PHYSICS_LIME_CORONA_JSON=3,i.Loader.PHYSICS_PHASER_JSON=4,i.Loader.TEXTURE_ATLAS_JSON_PYXEL=5,i.Loader.prototype={setPreloadSprite:function(e,t){t=t||0,this.preloadSprite={sprite:e,direction:t,width:e.width,height:e.height,rect:null},this.preloadSprite.rect=0===t?new i.Rectangle(0,0,1,e.height):new i.Rectangle(0,0,e.width,1),e.crop(this.preloadSprite.rect),e.visible=!0},resize:function(){this.preloadSprite&&this.preloadSprite.height!==this.preloadSprite.sprite.height&&(this.preloadSprite.rect.height=this.preloadSprite.sprite.height)},checkKeyExists:function(e,t){return this.getAssetIndex(e,t)>-1},getAssetIndex:function(e,t){for(var i=-1,s=0;s<this._fileList.length;s++){var a=this._fileList[s];if(a.type===e&&a.key===t&&(i=s,!a.loaded&&!a.loading))break}return i},getAsset:function(e,t){var i=this.getAssetIndex(e,t);return i>-1&&{index:i,file:this._fileList[i]}},reset:function(e,t){void 0===t&&(t=!1),this.resetLocked||(e&&(this.preloadSprite=null),this.isLoading=!1,this._processingHead=0,this._fileList.length=0,this._flightQueue.length=0,this._fileLoadStarted=!1,this._totalFileCount=0,this._totalPackCount=0,this._loadedPackCount=0,this._loadedFileCount=0,t&&(this.onLoadStart.removeAll(),this.onLoadComplete.removeAll(),this.onPackComplete.removeAll(),this.onFileStart.removeAll(),this.onFileComplete.removeAll(),this.onFileError.removeAll()))},addToFileList:function(e,t,i,s,a,n){if(void 0===a&&(a=!1),void 0===t||""===t)return this;if(void 0===i||null===i){if(!n)return this;i=t+n}var o={type:e,key:t,path:this.path,url:i,syncPoint:this._withSyncPointDepth>0,data:null,loading:!1,loaded:!1,error:!1};if(s)for(var r in s)o[r]=s[r];var l=this.getAssetIndex(e,t);if(a&&l>-1){var h=this._fileList[l];h.loading||h.loaded?(this._fileList.push(o),this._totalFileCount++):this._fileList[l]=o}else-1===l&&(this._fileList.push(o),this._totalFileCount++);return this},replaceInFileList:function(e,t,i,s){return this.addToFileList(e,t,i,s,!0)},pack:function(e,t,i,s){if(void 0===t&&(t=null),void 0===i&&(i=null),void 0===s&&(s=null),!t&&!i)return this;var a={type:"packfile",key:e,url:t,path:this.path,syncPoint:!0,data:null,loading:!1,loaded:!1,error:!1,callbackContext:s};i&&("string"==typeof i&&(i=JSON.parse(i)),a.data=i||{},a.loaded=!0);for(var n=0;n<this._fileList.length+1;n++){var o=this._fileList[n];if(!o||!o.loaded&&!o.loading&&"packfile"!==o.type){this._fileList.splice(n,0,a),this._totalPackCount++;break}}return this},image:function(e,t,i){return this.addToFileList("image",e,t,void 0,i,".png")},images:function(e,t){if(Array.isArray(t))for(i=0;i<e.length;i++)this.image(e[i],t[i]);else for(var i=0;i<e.length;i++)this.image(e[i]);return this},text:function(e,t,i){return this.addToFileList("text",e,t,void 0,i,".txt")},json:function(e,t,i){return this.addToFileList("json",e,t,void 0,i,".json")},shader:function(e,t,i){return this.addToFileList("shader",e,t,void 0,i,".frag")},xml:function(e,t,i){return this.addToFileList("xml",e,t,void 0,i,".xml")},script:function(e,t,i,s){return void 0===i&&(i=!1),!1!==i&&void 0===s&&(s=this),this.addToFileList("script",e,t,{syncPoint:!0,callback:i,callbackContext:s},!1,".js")},binary:function(e,t,i,s){return void 0===i&&(i=!1),!1!==i&&void 0===s&&(s=i),this.addToFileList("binary",e,t,{callback:i,callbackContext:s},!1,".bin")},spritesheet:function(e,t,i,s,a,n,o){return void 0===a&&(a=-1),void 0===n&&(n=0),void 0===o&&(o=0),this.addToFileList("spritesheet",e,t,{frameWidth:i,frameHeight:s,frameMax:a,margin:n,spacing:o},!1,".png")},audio:function(e,t,i){return this.game.sound.noAudio?this:(void 0===i&&(i=!0),"string"==typeof t&&(t=[t]),this.addToFileList("audio",e,t,{buffer:null,autoDecode:i}))},audioSprite:function(e,t,i,s,a){return this.game.sound.noAudio?this:(void 0===i&&(i=null),void 0===s&&(s=null),void 0===a&&(a=!0),this.audio(e,t,a),i?this.json(e+"-audioatlas",i):s&&("string"==typeof s&&(s=JSON.parse(s)),this.cache.addJSON(e+"-audioatlas","",s)),this)},audiosprite:function(e,t,i,s,a){return this.audioSprite(e,t,i,s,a)},video:function(e,t,i,s){return void 0===i&&(i=this.game.device.firefox?"loadeddata":"canplaythrough"),void 0===s&&(s=!1),"string"==typeof t&&(t=[t]),this.addToFileList("video",e,t,{buffer:null,asBlob:s,loadEvent:i})},tilemap:function(e,t,s,a){if(void 0===t&&(t=null),void 0===s&&(s=null),void 0===a&&(a=i.Tilemap.CSV),t||s||(t=a===i.Tilemap.CSV?e+".csv":e+".json"),s){switch(a){case i.Tilemap.CSV:break;case i.Tilemap.TILED_JSON:"string"==typeof s&&(s=JSON.parse(s))}this.cache.addTilemap(e,null,s,a)}else this.addToFileList("tilemap",e,t,{format:a});return this},physics:function(e,t,s,a){return void 0===t&&(t=null),void 0===s&&(s=null),void 0===a&&(a=i.Physics.LIME_CORONA_JSON),t||s||(t=e+".json"),s?("string"==typeof s&&(s=JSON.parse(s)),this.cache.addPhysicsData(e,null,s,a)):this.addToFileList("physics",e,t,{format:a}),this},bitmapFont:function(e,t,i,s,a,n){if(void 0!==t&&null!==t||(t=e+".png"),void 0===i&&(i=null),void 0===s&&(s=null),null===i&&null===s&&(i=e+".xml"),void 0===a&&(a=0),void 0===n&&(n=0),i)this.addToFileList("bitmapfont",e,t,{atlasURL:i,xSpacing:a,ySpacing:n});else if("string"==typeof s){var o,r;try{o=JSON.parse(s)}catch(e){r=this.parseXml(s)}if(!r&&!o)throw new Error("Phaser.Loader. Invalid Bitmap Font atlas given");this.addToFileList("bitmapfont",e,t,{atlasURL:null,atlasData:o||r,atlasType:o?"json":"xml",xSpacing:a,ySpacing:n})}return this},atlasJSONArray:function(e,t,s,a){return this.atlas(e,t,s,a,i.Loader.TEXTURE_ATLAS_JSON_ARRAY)},atlasJSONHash:function(e,t,s,a){return this.atlas(e,t,s,a,i.Loader.TEXTURE_ATLAS_JSON_HASH)},atlasXML:function(e,t,s,a){return void 0===s&&(s=null),void 0===a&&(a=null),s||a||(s=e+".xml"),this.atlas(e,t,s,a,i.Loader.TEXTURE_ATLAS_XML_STARLING)},atlas:function(e,t,s,a,n){if(void 0!==t&&null!==t||(t=e+".png"),void 0===s&&(s=null),void 0===a&&(a=null),void 0===n&&(n=i.Loader.TEXTURE_ATLAS_JSON_ARRAY),s||a||(s=n===i.Loader.TEXTURE_ATLAS_XML_STARLING?e+".xml":e+".json"),s)this.addToFileList("textureatlas",e,t,{atlasURL:s,format:n});else{switch(n){case i.Loader.TEXTURE_ATLAS_JSON_ARRAY:"string"==typeof a&&(a=JSON.parse(a));break;case i.Loader.TEXTURE_ATLAS_XML_STARLING:if("string"==typeof a){var o=this.parseXml(a);if(!o)throw new Error("Phaser.Loader. Invalid Texture Atlas XML given");a=o}}this.addToFileList("textureatlas",e,t,{atlasURL:null,atlasData:a,format:n})}return this},withSyncPoint:function(e,t){this._withSyncPointDepth++;try{e.call(t||this,this)}finally{this._withSyncPointDepth--}return this},addSyncPoint:function(e,t){var i=this.getAsset(e,t);return i&&(i.file.syncPoint=!0),this},removeFile:function(e,t){var i=this.getAsset(e,t);i&&(i.loaded||i.loading||this._fileList.splice(i.index,1))},removeAll:function(){this._fileList.length=0,this._flightQueue.length=0},start:function(){this.isLoading||(this.hasLoaded=!1,this.isLoading=!0,this.updateProgress(),this.processLoadQueue())},processLoadQueue:function(){if(this.isLoading){for(s=0;s<this._flightQueue.length;s++)((a=this._flightQueue[s]).loaded||a.error)&&(this._flightQueue.splice(s,1),s--,a.loading=!1,a.requestUrl=null,a.requestObject=null,a.error&&this.onFileError.dispatch(a.key,a),"packfile"!==a.type?(this._loadedFileCount++,this.onFileComplete.dispatch(this.progress,a.key,!a.error,this._loadedFileCount,this._totalFileCount)):"packfile"===a.type&&a.error&&(this._loadedPackCount++,this.onPackComplete.dispatch(a.key,!a.error,this._loadedPackCount,this._totalPackCount)));for(var e=!1,t=this.enableParallel?i.Math.clamp(this.maxParallelDownloads,1,12):1,s=this._processingHead;s<this._fileList.length;s++){var a=this._fileList[s];if("packfile"===a.type&&!a.error&&a.loaded&&s===this._processingHead&&(this.processPack(a),this._loadedPackCount++,this.onPackComplete.dispatch(a.key,!a.error,this._loadedPackCount,this._totalPackCount)),a.loaded||a.error?s===this._processingHead&&(this._processingHead=s+1):!a.loading&&this._flightQueue.length<t&&("packfile"!==a.type||a.data?e||(this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this._flightQueue.push(a),a.loading=!0,this.onFileStart.dispatch(this.progress,a.key,a.url),this.loadFile(a)):(this._flightQueue.push(a),a.loading=!0,this.loadFile(a))),!a.loaded&&a.syncPoint&&(e=!0),this._flightQueue.length>=t||e&&this._loadedPackCount===this._totalPackCount)break}if(this.updateProgress(),this._processingHead>=this._fileList.length)this.finishedLoading();else if(!this._flightQueue.length){var n=this;setTimeout(function(){n.finishedLoading(!0)},2e3)}}else this.finishedLoading(!0)},finishedLoading:function(e){this.hasLoaded||(this.hasLoaded=!0,this.isLoading=!1,e||this._fileLoadStarted||(this._fileLoadStarted=!0,this.onLoadStart.dispatch()),this.onLoadComplete.dispatch(),this.game.state.loadComplete(),this.reset())},asyncComplete:function(e,t){void 0===t&&(t=""),e.loaded=!0,e.error=!!t,t&&(e.errorMessage=t),this.processLoadQueue()},processPack:function(e){var t=e.data[e.key];if(t)for(var s=0;s<t.length;s++){var a=t[s];switch(a.type){case"image":this.image(a.key,a.url,a.overwrite);break;case"text":this.text(a.key,a.url,a.overwrite);break;case"json":this.json(a.key,a.url,a.overwrite);break;case"xml":this.xml(a.key,a.url,a.overwrite);break;case"script":this.script(a.key,a.url,a.callback,e.callbackContext||this);break;case"binary":this.binary(a.key,a.url,a.callback,e.callbackContext||this);break;case"spritesheet":this.spritesheet(a.key,a.url,a.frameWidth,a.frameHeight,a.frameMax,a.margin,a.spacing);break;case"video":this.video(a.key,a.urls);break;case"audio":this.audio(a.key,a.urls,a.autoDecode);break;case"audiosprite":this.audiosprite(a.key,a.urls,a.jsonURL,a.jsonData,a.autoDecode);break;case"tilemap":this.tilemap(a.key,a.url,a.data,i.Tilemap[a.format]);break;case"physics":this.physics(a.key,a.url,a.data,i.Loader[a.format]);break;case"bitmapFont":this.bitmapFont(a.key,a.textureURL,a.atlasURL,a.atlasData,a.xSpacing,a.ySpacing);break;case"atlasJSONArray":this.atlasJSONArray(a.key,a.textureURL,a.atlasURL,a.atlasData);break;case"atlasJSONHash":this.atlasJSONHash(a.key,a.textureURL,a.atlasURL,a.atlasData);break;case"atlasXML":this.atlasXML(a.key,a.textureURL,a.atlasURL,a.atlasData);break;case"atlas":this.atlas(a.key,a.textureURL,a.atlasURL,a.atlasData,i.Loader[a.format]);break;case"shader":this.shader(a.key,a.url,a.overwrite)}}},transformUrl:function(e,t){return!!e&&(e.match(/^(?:blob:|data:|http:\/\/|https:\/\/|\/\/)/)?e:this.baseURL+t.path+e)},loadFile:function(e){switch(e.type){case"packfile":this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.fileComplete);break;case"image":case"spritesheet":case"textureatlas":case"bitmapfont":this.loadImageTag(e);break;case"audio":e.url=this.getAudioURL(e.url),e.url?this.game.sound.usingWebAudio?this.xhrLoad(e,this.transformUrl(e.url,e),"arraybuffer",this.fileComplete):this.game.sound.usingAudioTag&&this.loadAudioTag(e):this.fileError(e,null,"No supported audio URL specified or device does not have audio playback support");break;case"video":e.url=this.getVideoURL(e.url),e.url?e.asBlob?this.xhrLoad(e,this.transformUrl(e.url,e),"blob",this.fileComplete):this.loadVideoTag(e):this.fileError(e,null,"No supported video URL specified or device does not have video playback support");break;case"json":this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.jsonLoadComplete);break;case"xml":this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.xmlLoadComplete);break;case"tilemap":e.format===i.Tilemap.TILED_JSON?this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.jsonLoadComplete):e.format===i.Tilemap.CSV?this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.csvLoadComplete):this.asyncComplete(e,"invalid Tilemap format: "+e.format);break;case"text":case"script":case"shader":case"physics":this.xhrLoad(e,this.transformUrl(e.url,e),"text",this.fileComplete);break;case"binary":this.xhrLoad(e,this.transformUrl(e.url,e),"arraybuffer",this.fileComplete)}},loadImageTag:function(e){var t=this;e.data=new Image,e.data.name=e.key,this.crossOrigin&&(e.data.crossOrigin=this.crossOrigin),e.data.onload=function(){e.data.onload&&(e.data.onload=null,e.data.onerror=null,t.fileComplete(e))},e.data.onerror=function(){e.data.onload&&(e.data.onload=null,e.data.onerror=null,t.fileError(e))},e.data.src=this.transformUrl(e.url,e),e.data.complete&&e.data.width&&e.data.height&&(e.data.onload=null,e.data.onerror=null,this.fileComplete(e))},loadVideoTag:function(e){var t=this;e.data=document.createElement("video"),e.data.name=e.key,e.data.controls=!1,e.data.autoplay=!1;var s=function(){e.data.removeEventListener(e.loadEvent,s,!1),e.data.onerror=null,e.data.canplay=!0,i.GAMES[t.game.id].load.fileComplete(e)};e.data.onerror=function(){e.data.removeEventListener(e.loadEvent,s,!1),e.data.onerror=null,e.data.canplay=!1,t.fileError(e)},e.data.addEventListener(e.loadEvent,s,!1),e.data.src=this.transformUrl(e.url,e),e.data.load()},loadAudioTag:function(e){var t=this;if(this.game.sound.touchLocked)e.data=new Audio,e.data.name=e.key,e.data.preload="auto",e.data.src=this.transformUrl(e.url,e),this.fileComplete(e);else{e.data=new Audio,e.data.name=e.key;var i=function(){e.data.removeEventListener("canplaythrough",i,!1),e.data.onerror=null,t.fileComplete(e)};e.data.onerror=function(){e.data.removeEventListener("canplaythrough",i,!1),e.data.onerror=null,t.fileError(e)},e.data.preload="auto",e.data.src=this.transformUrl(e.url,e),e.data.addEventListener("canplaythrough",i,!1),e.data.load()}},xhrLoad:function(e,t,i,s,a){if(this.useXDomainRequest&&window.XDomainRequest)this.xhrLoadWithXDR(e,t,i,s,a);else{var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType=i,!1!==this.headers.requestedWith&&n.setRequestHeader("X-Requested-With",this.headers.requestedWith),this.headers[e.type]&&n.setRequestHeader("Accept",this.headers[e.type]),a=a||this.fileError;var o=this;n.onload=function(){try{return 4===n.readyState&&n.status>=400&&n.status<=599?a.call(o,e,n):s.call(o,e,n)}catch(t){o.hasLoaded?window.console:o.asyncComplete(e,t.message||"Exception")}},n.onerror=function(){try{return a.call(o,e,n)}catch(t){o.hasLoaded?window.console:o.asyncComplete(e,t.message||"Exception")}},e.requestObject=n,e.requestUrl=t,n.send()}},xhrLoadWithXDR:function(e,t,i,s,a){this._warnedAboutXDomainRequest||this.game.device.ie&&!(this.game.device.ieVersion>=10)||(this._warnedAboutXDomainRequest=!0);var n=new window.XDomainRequest;n.open("GET",t,!0),n.responseType=i,n.timeout=3e3,a=a||this.fileError;var o=this;n.onerror=function(){try{return a.call(o,e,n)}catch(t){o.asyncComplete(e,t.message||"Exception")}},n.ontimeout=function(){try{return a.call(o,e,n)}catch(t){o.asyncComplete(e,t.message||"Exception")}},n.onprogress=function(){},n.onload=function(){try{return 4===n.readyState&&n.status>=400&&n.status<=599?a.call(o,e,n):s.call(o,e,n)}catch(t){o.asyncComplete(e,t.message||"Exception")}},e.requestObject=n,e.requestUrl=t,setTimeout(function(){n.send()},0)},getVideoURL:function(e){for(var t=0;t<e.length;t++){var i,s=e[t];if(s.uri){if(i=s.type,s=s.uri,this.game.device.canPlayVideo(i))return s}else{if(0===s.indexOf("blob:")||0===s.indexOf("data:"))return s;if(s.indexOf("?")>=0&&(s=s.substr(0,s.indexOf("?"))),i=s.substr((Math.max(0,s.lastIndexOf("."))||1/0)+1).toLowerCase(),this.game.device.canPlayVideo(i))return e[t]}}return null},getAudioURL:function(e){if(this.game.sound.noAudio)return null;for(var t=0;t<e.length;t++){var i,s=e[t];if(s.uri){if(i=s.type,s=s.uri,this.game.device.canPlayAudio(i))return s}else{if(0===s.indexOf("blob:")||0===s.indexOf("data:"))return s;if(s.indexOf("?")>=0&&(s=s.substr(0,s.indexOf("?"))),i=s.substr((Math.max(0,s.lastIndexOf("."))||1/0)+1).toLowerCase(),this.game.device.canPlayAudio(i))return e[t]}}return null},fileError:function(e,t,i){var s="error loading asset from URL "+(e.requestUrl||this.transformUrl(e.url,e));!i&&t&&(i=t.status),i&&(s=s+" ("+i+")"),this.asyncComplete(e,s)},fileComplete:function(e,t){var s=!0;switch(e.type){case"packfile":a=JSON.parse(t.responseText);e.data=a||{};break;case"image":this.cache.addImage(e.key,e.url,e.data);break;case"spritesheet":this.cache.addSpriteSheet(e.key,e.url,e.data,e.frameWidth,e.frameHeight,e.frameMax,e.margin,e.spacing);break;case"textureatlas":if(null==e.atlasURL)this.cache.addTextureAtlas(e.key,e.url,e.data,e.atlasData,e.format);else if(s=!1,e.format===i.Loader.TEXTURE_ATLAS_JSON_ARRAY||e.format===i.Loader.TEXTURE_ATLAS_JSON_HASH||e.format===i.Loader.TEXTURE_ATLAS_JSON_PYXEL)this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",this.jsonLoadComplete);else{if(e.format!==i.Loader.TEXTURE_ATLAS_XML_STARLING)throw new Error("Phaser.Loader. Invalid Texture Atlas format: "+e.format);this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",this.xmlLoadComplete)}break;case"bitmapfont":e.atlasURL?(s=!1,this.xhrLoad(e,this.transformUrl(e.atlasURL,e),"text",function(e,t){var i;try{i=JSON.parse(t.responseText)}catch(e){}i?(e.atlasType="json",this.jsonLoadComplete(e,t)):(e.atlasType="xml",this.xmlLoadComplete(e,t))})):this.cache.addBitmapFont(e.key,e.url,e.data,e.atlasData,e.atlasType,e.xSpacing,e.ySpacing);break;case"video":if(e.asBlob)try{e.data=t.response}catch(t){throw new Error("Phaser.Loader. Unable to parse video file as Blob: "+e.key)}this.cache.addVideo(e.key,e.url,e.data,e.asBlob);break;case"audio":this.game.sound.usingWebAudio?(e.data=t.response,this.cache.addSound(e.key,e.url,e.data,!0,!1),e.autoDecode&&this.game.sound.decode(e.key)):this.cache.addSound(e.key,e.url,e.data,!1,!0);break;case"text":e.data=t.responseText,this.cache.addText(e.key,e.url,e.data);break;case"shader":e.data=t.responseText,this.cache.addShader(e.key,e.url,e.data);break;case"physics":var a=JSON.parse(t.responseText);this.cache.addPhysicsData(e.key,e.url,a,e.format);break;case"script":e.data=document.createElement("script"),e.data.language="javascript",e.data.type="text/javascript",e.data.defer=!1,e.data.text=t.responseText,document.head.appendChild(e.data),e.callback&&(e.data=e.callback.call(e.callbackContext,e.key,t.responseText));break;case"binary":e.callback?e.data=e.callback.call(e.callbackContext,e.key,t.response):e.data=t.response,this.cache.addBinary(e.key,e.data)}s&&this.asyncComplete(e)},jsonLoadComplete:function(e,t){var i=JSON.parse(t.responseText);"tilemap"===e.type?this.cache.addTilemap(e.key,e.url,i,e.format):"bitmapfont"===e.type?this.cache.addBitmapFont(e.key,e.url,e.data,i,e.atlasType,e.xSpacing,e.ySpacing):"json"===e.type?this.cache.addJSON(e.key,e.url,i):this.cache.addTextureAtlas(e.key,e.url,e.data,i,e.format),this.asyncComplete(e)},csvLoadComplete:function(e,t){var i=t.responseText;this.cache.addTilemap(e.key,e.url,i,e.format),this.asyncComplete(e)},xmlLoadComplete:function(e,t){var i=t.responseText,s=this.parseXml(i);if(s)"bitmapfont"===e.type?this.cache.addBitmapFont(e.key,e.url,e.data,s,e.atlasType,e.xSpacing,e.ySpacing):"textureatlas"===e.type?this.cache.addTextureAtlas(e.key,e.url,e.data,s,e.format):"xml"===e.type&&this.cache.addXML(e.key,e.url,s),this.asyncComplete(e);else{t.responseType||t.contentType;this.asyncComplete(e,"invalid XML")}},parseXml:function(e){var t;try{if(window.DOMParser){var i=new DOMParser;t=i.parseFromString(e,"text/xml")}else t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)}catch(e){t=null}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length?t:null},updateProgress:function(){this.preloadSprite&&(0===this.preloadSprite.direction?this.preloadSprite.rect.width=Math.floor(this.preloadSprite.width/100*this.progress):this.preloadSprite.rect.height=Math.floor(this.preloadSprite.height/100*this.progress),this.preloadSprite.sprite?this.preloadSprite.sprite.updateCrop():this.preloadSprite=null)},totalLoadedFiles:function(){return this._loadedFileCount},totalQueuedFiles:function(){return this._totalFileCount-this._loadedFileCount},totalLoadedPacks:function(){return this._totalPackCount},totalQueuedPacks:function(){return this._totalPackCount-this._loadedPackCount}},Object.defineProperty(i.Loader.prototype,"progressFloat",{get:function(){var e=this._loadedFileCount/this._totalFileCount*100;return i.Math.clamp(e||0,0,100)}}),Object.defineProperty(i.Loader.prototype,"progress",{get:function(){return Math.round(this.progressFloat)}}),i.Loader.prototype.constructor=i.Loader,i.LoaderParser={bitmapFont:function(e,t,i,s){return this.xmlBitmapFont(e,t,i,s)},xmlBitmapFont:function(e,t,i,s){var a={},n=e.getElementsByTagName("info")[0],o=e.getElementsByTagName("common")[0];a.font=n.getAttribute("face"),a.size=parseInt(n.getAttribute("size"),10),a.lineHeight=parseInt(o.getAttribute("lineHeight"),10)+s,a.chars={};for(var r=e.getElementsByTagName("char"),l=0;l<r.length;l++){var h=parseInt(r[l].getAttribute("id"),10);a.chars[h]={x:parseInt(r[l].getAttribute("x"),10),y:parseInt(r[l].getAttribute("y"),10),width:parseInt(r[l].getAttribute("width"),10),height:parseInt(r[l].getAttribute("height"),10),xOffset:parseInt(r[l].getAttribute("xoffset"),10),yOffset:parseInt(r[l].getAttribute("yoffset"),10),xAdvance:parseInt(r[l].getAttribute("xadvance"),10)+i,kerning:{}}}var c=e.getElementsByTagName("kerning");for(l=0;l<c.length;l++){var p=parseInt(c[l].getAttribute("first"),10),d=parseInt(c[l].getAttribute("second"),10),u=parseInt(c[l].getAttribute("amount"),10);a.chars[d].kerning[p]=u}return this.finalizeBitmapFont(t,a)},jsonBitmapFont:function(e,t,i,s){var a={font:e.font.info._face,size:parseInt(e.font.info._size,10),lineHeight:parseInt(e.font.common._lineHeight,10)+s,chars:{}};return e.font.chars.char.forEach(function(e){var t=parseInt(e._id,10);a.chars[t]={x:parseInt(e._x,10),y:parseInt(e._y,10),width:parseInt(e._width,10),height:parseInt(e._height,10),xOffset:parseInt(e._xoffset,10),yOffset:parseInt(e._yoffset,10),xAdvance:parseInt(e._xadvance,10)+i,kerning:{}}}),e.font.kernings&&e.font.kernings.kerning&&e.font.kernings.kerning.forEach(function(e){a.chars[e._second].kerning[e._first]=parseInt(e._amount,10)}),this.finalizeBitmapFont(t,a)},finalizeBitmapFont:function(e,t){return Object.keys(t.chars).forEach(function(s){var a=t.chars[s];a.texture=new PIXI.Texture(e,new i.Rectangle(a.x,a.y,a.width,a.height))}),t}},i.AudioSprite=function(e,t){this.game=e,this.key=t,this.config=this.game.cache.getJSON(t+"-audioatlas"),this.autoplayKey=null,this.autoplay=!1,this.sounds={};for(var i in this.config.spritemap){var s=this.config.spritemap[i],a=this.game.add.sound(this.key);a.addMarker(i,s.start,s.end-s.start,null,s.loop),this.sounds[i]=a}this.config.autoplay&&(this.autoplayKey=this.config.autoplay,this.play(this.autoplayKey),this.autoplay=this.sounds[this.autoplayKey])},i.AudioSprite.prototype={play:function(e,t){return void 0===t&&(t=1),this.sounds[e].play(e,null,t)},stop:function(e){if(e)this.sounds[e].stop();else for(var t in this.sounds)this.sounds[t].stop()},get:function(e){return this.sounds[e]}},i.AudioSprite.prototype.constructor=i.AudioSprite,i.Sound=function(e,t,s,a,n){void 0===s&&(s=1),void 0===a&&(a=!1),void 0===n&&(n=e.sound.connectToMaster),this.game=e,this.name=t,this.key=t,this.loop=a,this.markers={},this.context=null,this.autoplay=!1,this.totalDuration=0,this.startTime=0,this.currentTime=0,this.duration=0,this.durationMS=0,this.position=0,this.stopTime=0,this.paused=!1,this.pausedPosition=0,this.pausedTime=0,this.isPlaying=!1,this.currentMarker="",this.fadeTween=null,this.pendingPlayback=!1,this.override=!1,this.allowMultiple=!1,this.usingWebAudio=this.game.sound.usingWebAudio,this.usingAudioTag=this.game.sound.usingAudioTag,this.externalNode=null,this.masterGainNode=null,this.gainNode=null,this._sound=null,this.usingWebAudio?(this.context=this.game.sound.context,this.masterGainNode=this.game.sound.masterGain,void 0===this.context.createGain?this.gainNode=this.context.createGainNode():this.gainNode=this.context.createGain(),this.gainNode.gain.value=s*this.game.sound.volume,n&&this.gainNode.connect(this.masterGainNode)):this.usingAudioTag&&(this.game.cache.getSound(t)&&this.game.cache.isSoundReady(t)?(this._sound=this.game.cache.getSoundData(t),this.totalDuration=0,this._sound.duration&&(this.totalDuration=this._sound.duration)):this.game.cache.onSoundUnlock.add(this.soundHasUnlocked,this)),this.onDecoded=new i.Signal,this.onPlay=new i.Signal,this.onPause=new i.Signal,this.onResume=new i.Signal,this.onLoop=new i.Signal,this.onStop=new i.Signal,this.onMute=new i.Signal,this.onMarkerComplete=new i.Signal,this.onFadeComplete=new i.Signal,this._volume=s,this._buffer=null,this._muted=!1,this._tempMarker=0,this._tempPosition=0,this._tempVolume=0,this._tempPause=0,this._muteVolume=0,this._tempLoop=0,this._paused=!1,this._onDecodedEventDispatched=!1},i.Sound.prototype={soundHasUnlocked:function(e){e===this.key&&(this._sound=this.game.cache.getSoundData(this.key),this.totalDuration=this._sound.duration)},addMarker:function(e,t,i,s,a){void 0!==i&&null!==i||(i=1),void 0!==s&&null!==s||(s=1),void 0===a&&(a=!1),this.markers[e]={name:e,start:t,stop:t+i,volume:s,duration:i,durationMS:1e3*i,loop:a}},removeMarker:function(e){delete this.markers[e]},onEndedHandler:function(){this._sound.onended=null,this.isPlaying=!1,this.currentTime=this.durationMS,this.stop()},update:function(){return this.game.cache.checkSoundKey(this.key)?(this.isDecoded&&!this._onDecodedEventDispatched&&(this.onDecoded.dispatch(this),this._onDecodedEventDispatched=!0),this.pendingPlayback&&this.game.cache.isSoundReady(this.key)&&(this.pendingPlayback=!1,this.play(this._tempMarker,this._tempPosition,this._tempVolume,this._tempLoop)),void(this.isPlaying&&(this.currentTime=this.game.time.time-this.startTime,this.currentTime>=this.durationMS&&(this.usingWebAudio?this.loop?(this.onLoop.dispatch(this),this.isPlaying=!1,""===this.currentMarker?(this.currentTime=0,this.startTime=this.game.time.time,this.isPlaying=!0):(this.onMarkerComplete.dispatch(this.currentMarker,this),this.play(this.currentMarker,0,this.volume,!0,!0))):""!==this.currentMarker&&this.stop():this.loop?(this.onLoop.dispatch(this),""===this.currentMarker&&(this.currentTime=0,this.startTime=this.game.time.time),this.isPlaying=!1,this.play(this.currentMarker,0,this.volume,!0,!0)):this.stop())))):void this.destroy()},loopFull:function(e){return this.play(null,0,e,!0)},play:function(e,t,i,s,a){if(void 0!==e&&!1!==e&&null!==e||(e=""),void 0===a&&(a=!0),this.isPlaying&&!this.allowMultiple&&!a&&!this.override)return this;if(this._sound&&this.isPlaying&&!this.allowMultiple&&(this.override||a)){if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(e){}this.externalNode?this._sound.disconnect(this.externalNode):this.gainNode&&this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);this.isPlaying=!1}if(""===e&&Object.keys(this.markers).length>0)return this;if(""!==e){if(!this.markers[e])return this;this.currentMarker=e,this.position=this.markers[e].start,this.volume=this.markers[e].volume,this.loop=this.markers[e].loop,this.duration=this.markers[e].duration,this.durationMS=this.markers[e].durationMS,void 0!==i&&(this.volume=i),void 0!==s&&(this.loop=s),this._tempMarker=e,this._tempPosition=this.position,this._tempVolume=this.volume,this._tempLoop=this.loop}else t=t||0,void 0===i&&(i=this._volume),void 0===s&&(s=this.loop),this.position=Math.max(0,t),this.volume=i,this.loop=s,this.duration=0,this.durationMS=0,this._tempMarker=e,this._tempPosition=t,this._tempVolume=i,this._tempLoop=s;return this.usingWebAudio?this.game.cache.isSoundDecoded(this.key)?(this._sound=this.context.createBufferSource(),this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),this._buffer=this.game.cache.getSoundData(this.key),this._sound.buffer=this._buffer,this.loop&&""===e&&(this._sound.loop=!0),this.loop||""!==e||(this._sound.onended=this.onEndedHandler.bind(this)),this.totalDuration=this._sound.buffer.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=Math.ceil(1e3*this.totalDuration)),void 0===this._sound.start?this._sound.noteGrainOn(0,this.position,this.duration):this.loop&&""===e?this._sound.start(0,0):this._sound.start(0,this.position,this.duration),this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):(this.pendingPlayback=!0,this.game.cache.getSound(this.key)&&!1===this.game.cache.getSound(this.key).isDecoding&&this.game.sound.decode(this.key,this)):this.game.cache.getSound(this.key)&&this.game.cache.getSound(this.key).locked?(this.game.cache.reloadSound(this.key),this.pendingPlayback=!0):this._sound&&(this.game.device.cocoonJS||4===this._sound.readyState)?(this._sound.play(),this.totalDuration=this._sound.duration,0===this.duration&&(this.duration=this.totalDuration,this.durationMS=1e3*this.totalDuration),this._sound.currentTime=this.position,this._sound.muted=this._muted,this._muted||this.game.sound.mute?this._sound.volume=0:this._sound.volume=this._volume,this.isPlaying=!0,this.startTime=this.game.time.time,this.currentTime=0,this.stopTime=this.startTime+this.durationMS,this.onPlay.dispatch(this)):this.pendingPlayback=!0,this},restart:function(e,t,i,s){e=e||"",t=t||0,i=i||1,void 0===s&&(s=!1),this.play(e,t,i,s,!0)},pause:function(){this.isPlaying&&this._sound&&(this.paused=!0,this.pausedPosition=this.currentTime,this.pausedTime=this.game.time.time,this._tempPause=this._sound.currentTime,this.onPause.dispatch(this),this.stop())},resume:function(){if(this.paused&&this._sound){if(this.usingWebAudio){var e=Math.max(0,this.position+this.pausedPosition/1e3);this._sound=this.context.createBufferSource(),this._sound.buffer=this._buffer,this.externalNode?this._sound.connect(this.externalNode):this._sound.connect(this.gainNode),this.loop&&(this._sound.loop=!0),this.loop||""!==this.currentMarker||(this._sound.onended=this.onEndedHandler.bind(this));var t=this.duration-this.pausedPosition/1e3;void 0===this._sound.start?this._sound.noteGrainOn(0,e,t):this.loop&&this.game.device.chrome?42===this.game.device.chromeVersion?this._sound.start(0):this._sound.start(0,e):this._sound.start(0,e,t)}else this._sound.currentTime=this._tempPause,this._sound.play();this.isPlaying=!0,this.paused=!1,this.startTime+=this.game.time.time-this.pausedTime,this.onResume.dispatch(this)}},stop:function(){if(this.isPlaying&&this._sound)if(this.usingWebAudio){if(void 0===this._sound.stop)this._sound.noteOff(0);else try{this._sound.stop(0)}catch(e){}this.externalNode?this._sound.disconnect(this.externalNode):this.gainNode&&this._sound.disconnect(this.gainNode)}else this.usingAudioTag&&(this._sound.pause(),this._sound.currentTime=0);if(this.pendingPlayback=!1,this.isPlaying=!1,!this.paused){var e=this.currentMarker;""!==this.currentMarker&&this.onMarkerComplete.dispatch(this.currentMarker,this),this.currentMarker="",null!==this.fadeTween&&this.fadeTween.stop(),this.onStop.dispatch(this,e)}},fadeIn:function(e,t,i){void 0===t&&(t=!1),void 0===i&&(i=this.currentMarker),this.paused||(this.play(i,0,0,t),this.fadeTo(e,1))},fadeOut:function(e){this.fadeTo(e,0)},fadeTo:function(e,t){if(this.isPlaying&&!this.paused&&t!==this.volume){if(void 0===e&&(e=1e3),void 0===t)return;this.fadeTween=this.game.add.tween(this).to({volume:t},e,i.Easing.Linear.None,!0),this.fadeTween.onComplete.add(this.fadeComplete,this)}},fadeComplete:function(){this.onFadeComplete.dispatch(this,this.volume),0===this.volume&&this.stop()},updateGlobalVolume:function(e){this.usingAudioTag&&this._sound&&(this._sound.volume=e*this._volume)},destroy:function(e){void 0===e&&(e=!0),this.stop(),e?this.game.sound.remove(this):(this.markers={},this.context=null,this._buffer=null,this.externalNode=null,this.onDecoded.dispose(),this.onPlay.dispose(),this.onPause.dispose(),this.onResume.dispose(),this.onLoop.dispose(),this.onStop.dispose(),this.onMute.dispose(),this.onMarkerComplete.dispose())}},i.Sound.prototype.constructor=i.Sound,Object.defineProperty(i.Sound.prototype,"isDecoding",{get:function(){return this.game.cache.getSound(this.key).isDecoding}}),Object.defineProperty(i.Sound.prototype,"isDecoded",{get:function(){return this.game.cache.isSoundDecoded(this.key)}}),Object.defineProperty(i.Sound.prototype,"mute",{get:function(){return this._muted||this.game.sound.mute},set:function(e){(e=e||!1)!==this._muted&&(e?(this._muted=!0,this._muteVolume=this._tempVolume,this.usingWebAudio?this.gainNode.gain.value=0:this.usingAudioTag&&this._sound&&(this._sound.volume=0)):(this._muted=!1,this.usingWebAudio?this.gainNode.gain.value=this._muteVolume:this.usingAudioTag&&this._sound&&(this._sound.volume=this._muteVolume)),this.onMute.dispatch(this))}}),Object.defineProperty(i.Sound.prototype,"volume",{get:function(){return this._volume},set:function(e){return this.game.device.firefox&&this.usingAudioTag&&(e=this.game.math.clamp(e,0,1)),this._muted?void(this._muteVolume=e):(this._tempVolume=e,this._volume=e,void(this.usingWebAudio?this.gainNode.gain.value=e:this.usingAudioTag&&this._sound&&(this._sound.volume=e)))}}),i.SoundManager=function(e){this.game=e,this.onSoundDecode=new i.Signal,this.onVolumeChange=new i.Signal,this.onMute=new i.Signal,this.onUnMute=new i.Signal,this.context=null,this.usingWebAudio=!1,this.usingAudioTag=!1,this.noAudio=!1,this.connectToMaster=!0,this.touchLocked=!1,this.channels=32,this.muteOnPause=!0,this._codeMuted=!1,this._muted=!1,this._unlockSource=null,this._volume=1,this._sounds=[],this._watchList=new i.ArraySet,this._watching=!1,this._watchCallback=null,this._watchContext=null},i.SoundManager.prototype={boot:function(){if(this.game.device.iOS&&!1===this.game.device.webAudio&&(this.channels=1),window.PhaserGlobal){if(!0===window.PhaserGlobal.disableAudio)return this.noAudio=!0,void(this.touchLocked=!1);if(!0===window.PhaserGlobal.disableWebAudio)return this.usingAudioTag=!0,void(this.touchLocked=!1)}if(window.PhaserGlobal&&window.PhaserGlobal.audioContext)this.context=window.PhaserGlobal.audioContext;else if(window.AudioContext)try{this.context=new window.AudioContext}catch(e){this.context=null,this.usingWebAudio=!1,this.touchLocked=!1}else if(window.webkitAudioContext)try{this.context=new window.webkitAudioContext}catch(e){this.context=null,this.usingWebAudio=!1,this.touchLocked=!1}if(null===this.context){if(void 0===window.Audio)return void(this.noAudio=!0);this.usingAudioTag=!0}else this.usingWebAudio=!0,void 0===this.context.createGain?this.masterGain=this.context.createGainNode():this.masterGain=this.context.createGain(),this.masterGain.gain.value=1,this.masterGain.connect(this.context.destination);this.noAudio||(!this.game.device.cocoonJS&&this.game.device.iOS||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock)&&this.setTouchLock()},setTouchLock:function(){this.noAudio||window.PhaserGlobal&&!0===window.PhaserGlobal.disableAudio||(this.game.device.iOSVersion>8?this.game.input.touch.addTouchLockCallback(this.unlock,this,!0):this.game.input.touch.addTouchLockCallback(this.unlock,this),this.touchLocked=!0)},unlock:function(){if(this.noAudio||!this.touchLocked||null!==this._unlockSource)return!0;if(this.usingAudioTag)this.touchLocked=!1,this._unlockSource=null;else if(this.usingWebAudio){var e=this.context.createBuffer(1,1,22050);this._unlockSource=this.context.createBufferSource(),this._unlockSource.buffer=e,this._unlockSource.connect(this.context.destination),void 0===this._unlockSource.start?this._unlockSource.noteOn(0):this._unlockSource.start(0)}return!0},stopAll:function(){if(!this.noAudio)for(var e=0;e<this._sounds.length;e++)this._sounds[e]&&this._sounds[e].stop()},pauseAll:function(){if(!this.noAudio)for(var e=0;e<this._sounds.length;e++)this._sounds[e]&&this._sounds[e].pause()},resumeAll:function(){if(!this.noAudio)for(var e=0;e<this._sounds.length;e++)this._sounds[e]&&this._sounds[e].resume()},decode:function(e,t){t=t||null;var i=this.game.cache.getSoundData(e);if(i&&!1===this.game.cache.isSoundDecoded(e)){this.game.cache.updateSound(e,"isDecoding",!0);var s=this;try{this.context.decodeAudioData(i,function(i){i&&(s.game.cache.decodedSound(e,i),s.onSoundDecode.dispatch(e,t))})}catch(e){}}},setDecodedCallback:function(e,t,s){"string"==typeof e&&(e=[e]),this._watchList.reset();for(var a=0;a<e.length;a++)e[a]instanceof i.Sound?this.game.cache.isSoundDecoded(e[a].key)||this._watchList.add(e[a].key):this.game.cache.isSoundDecoded(e[a])||this._watchList.add(e[a]);0===this._watchList.total?(this._watching=!1,t.call(s)):(this._watching=!0,this._watchCallback=t,this._watchContext=s)},update:function(){if(!this.noAudio){!this.touchLocked||null===this._unlockSource||this._unlockSource.playbackState!==this._unlockSource.PLAYING_STATE&&this._unlockSource.playbackState!==this._unlockSource.FINISHED_STATE||(this.touchLocked=!1,this._unlockSource=null);for(var e=0;e<this._sounds.length;e++)this._sounds[e].update();if(this._watching){for(var t=this._watchList.first;t;)this.game.cache.isSoundDecoded(t)&&this._watchList.remove(t),t=this._watchList.next;0===this._watchList.total&&(this._watching=!1,this._watchCallback.call(this._watchContext))}}},add:function(e,t,s,a){void 0===t&&(t=1),void 0===s&&(s=!1),void 0===a&&(a=this.connectToMaster);var n=new i.Sound(this.game,e,t,s,a);return this._sounds.push(n),n},addSprite:function(e){return new i.AudioSprite(this.game,e)},remove:function(e){for(var t=this._sounds.length;t--;)if(this._sounds[t]===e)return this._sounds[t].destroy(!1),this._sounds.splice(t,1),!0;return!1},removeByKey:function(e){for(var t=this._sounds.length,i=0;t--;)this._sounds[t].key===e&&(this._sounds[t].destroy(!1),this._sounds.splice(t,1),i++);return i},play:function(e,t,i){if(!this.noAudio){var s=this.add(e,t,i);return s.play(),s}},setMute:function(){if(!this._muted){this._muted=!0,this.usingWebAudio&&(this._muteVolume=this.masterGain.gain.value,this.masterGain.gain.value=0);for(var e=0;e<this._sounds.length;e++)this._sounds[e].usingAudioTag&&(this._sounds[e].mute=!0);this.onMute.dispatch()}},unsetMute:function(){if(this._muted&&!this._codeMuted){this._muted=!1,this.usingWebAudio&&(this.masterGain.gain.value=this._muteVolume);for(var e=0;e<this._sounds.length;e++)this._sounds[e].usingAudioTag&&(this._sounds[e].mute=!1);this.onUnMute.dispatch()}},destroy:function(){this.stopAll();for(var e=0;e<this._sounds.length;e++)this._sounds[e]&&this._sounds[e].destroy();this._sounds=[],this.onSoundDecode.dispose(),this.context&&(window.PhaserGlobal?window.PhaserGlobal.audioContext=this.context:this.context.close&&this.context.close())}},i.SoundManager.prototype.constructor=i.SoundManager,Object.defineProperty(i.SoundManager.prototype,"mute",{get:function(){return this._muted},set:function(e){if(e=e||!1){if(this._muted)return;this._codeMuted=!0,this.setMute()}else{if(!this._muted)return;this._codeMuted=!1,this.unsetMute()}}}),Object.defineProperty(i.SoundManager.prototype,"volume",{get:function(){return this._volume},set:function(e){if(e<0?e=0:e>1&&(e=1),this._volume!==e){if(this._volume=e,this.usingWebAudio)this.masterGain.gain.value=e;else for(var t=0;t<this._sounds.length;t++)this._sounds[t].usingAudioTag&&this._sounds[t].updateGlobalVolume(e);this.onVolumeChange.dispatch(e)}}}),i.ScaleManager=function(e,t,s){this.game=e,this.dom=i.DOM,this.grid=null,this.width=0,this.height=0,this.minWidth=null,this.maxWidth=null,this.minHeight=null,this.maxHeight=null,this.offset=new i.Point,this.forceLandscape=!1,this.forcePortrait=!1,this.incorrectOrientation=!1,this._pageAlignHorizontally=!1,this._pageAlignVertically=!1,this.onOrientationChange=new i.Signal,this.enterIncorrectOrientation=new i.Signal,this.leaveIncorrectOrientation=new i.Signal,this.hasPhaserSetFullScreen=!1,this.fullScreenTarget=null,this._createdFullScreenTarget=null,this.onFullScreenInit=new i.Signal,this.onFullScreenChange=new i.Signal,this.onFullScreenError=new i.Signal,this.screenOrientation=this.dom.getScreenOrientation(),this.scaleFactor=new i.Point(1,1),this.scaleFactorInversed=new i.Point(1,1),this.margin={left:0,top:0,right:0,bottom:0,x:0,y:0},this.bounds=new i.Rectangle,this.aspectRatio=0,this.sourceAspectRatio=0,this.event=null,this.windowConstraints={right:"layout",bottom:""},this.compatibility={supportsFullScreen:!1,orientationFallback:null,noMargins:!1,scrollTo:null,forceMinimumDocumentHeight:!1,canExpandParent:!0,clickTrampoline:""},this._scaleMode=i.ScaleManager.NO_SCALE,this._fullScreenScaleMode=i.ScaleManager.NO_SCALE,this.parentIsWindow=!1,this.parentNode=null,this.parentScaleFactor=new i.Point(1,1),this.trackParentInterval=2e3,this.onSizeChange=new i.Signal,this.onResize=null,this.onResizeContext=null,this._pendingScaleMode=null,this._fullScreenRestore=null,this._gameSize=new i.Rectangle,this._userScaleFactor=new i.Point(1,1),this._userScaleTrim=new i.Point(0,0),this._lastUpdate=0,this._updateThrottle=0,this._updateThrottleReset=100,this._parentBounds=new i.Rectangle,this._tempBounds=new i.Rectangle,this._lastReportedCanvasSize=new i.Rectangle,this._lastReportedGameSize=new i.Rectangle,this._booted=!1,e.config&&this.parseConfig(e.config),this.setupScale(t,s)},i.ScaleManager.EXACT_FIT=0,i.ScaleManager.NO_SCALE=1,i.ScaleManager.SHOW_ALL=2,i.ScaleManager.RESIZE=3,i.ScaleManager.USER_SCALE=4,i.ScaleManager.prototype={boot:function(){var e=this.compatibility;e.supportsFullScreen=this.game.device.fullscreen&&!this.game.device.cocoonJS,this.game.device.iPad||this.game.device.webApp||this.game.device.desktop||(this.game.device.android&&!this.game.device.chrome?e.scrollTo=new i.Point(0,1):e.scrollTo=new i.Point(0,0)),this.game.device.desktop?(e.orientationFallback="screen",e.clickTrampoline="when-not-mouse"):(e.orientationFallback="",e.clickTrampoline="");var t=this;this._orientationChange=function(e){return t.orientationChange(e)},this._windowResize=function(e){return t.windowResize(e)},window.addEventListener("orientationchange",this._orientationChange,!1),window.addEventListener("resize",this._windowResize,!1),this.compatibility.supportsFullScreen&&(this._fullScreenChange=function(e){return t.fullScreenChange(e)},this._fullScreenError=function(e){return t.fullScreenError(e)},document.addEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.addEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.addEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.addEventListener("fullscreenchange",this._fullScreenChange,!1),document.addEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.addEventListener("mozfullscreenerror",this._fullScreenError,!1),document.addEventListener("MSFullscreenError",this._fullScreenError,!1),document.addEventListener("fullscreenerror",this._fullScreenError,!1)),this.game.onResume.add(this._gameResumed,this),this.dom.getOffset(this.game.canvas,this.offset),this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height),this.setGameSize(this.game.width,this.game.height),this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback),i.FlexGrid&&(this.grid=new i.FlexGrid(this,this.width,this.height)),this._booted=!0,null!==this._pendingScaleMode&&(this.scaleMode=this._pendingScaleMode,this._pendingScaleMode=null)},parseConfig:function(e){void 0!==e.scaleMode&&(this._booted?this.scaleMode=e.scaleMode:this._pendingScaleMode=e.scaleMode),void 0!==e.fullScreenScaleMode&&(this.fullScreenScaleMode=e.fullScreenScaleMode),e.fullScreenTarget&&(this.fullScreenTarget=e.fullScreenTarget)},setupScale:function(e,t){var s,a=new i.Rectangle;""!==this.game.parent&&("string"==typeof this.game.parent?s=document.getElementById(this.game.parent):this.game.parent&&1===this.game.parent.nodeType&&(s=this.game.parent)),s?(this.parentNode=s,this.parentIsWindow=!1,this.getParentBounds(this._parentBounds),a.width=this._parentBounds.width,a.height=this._parentBounds.height,this.offset.set(this._parentBounds.x,this._parentBounds.y)):(this.parentNode=null,this.parentIsWindow=!0,a.width=this.dom.visualBounds.width,a.height=this.dom.visualBounds.height,this.offset.set(0,0));var n=0,o=0;"number"==typeof e?n=e:(this.parentScaleFactor.x=parseInt(e,10)/100,n=a.width*this.parentScaleFactor.x),"number"==typeof t?o=t:(this.parentScaleFactor.y=parseInt(t,10)/100,o=a.height*this.parentScaleFactor.y),n=Math.floor(n),o=Math.floor(o),this._gameSize.setTo(0,0,n,o),this.updateDimensions(n,o,!1)},_gameResumed:function(){this.queueUpdate(!0)},setGameSize:function(e,t){this._gameSize.setTo(0,0,e,t),this.currentScaleMode!==i.ScaleManager.RESIZE&&this.updateDimensions(e,t,!0),this.queueUpdate(!0)},setUserScale:function(e,t,i,s){this._userScaleFactor.setTo(e,t),this._userScaleTrim.setTo(0|i,0|s),this.queueUpdate(!0)},setResizeCallback:function(e,t){this.onResize=e,this.onResizeContext=t},signalSizeChange:function(){if(!i.Rectangle.sameDimensions(this,this._lastReportedCanvasSize)||!i.Rectangle.sameDimensions(this.game,this._lastReportedGameSize)){var e=this.width,t=this.height;this._lastReportedCanvasSize.setTo(0,0,e,t),this._lastReportedGameSize.setTo(0,0,this.game.width,this.game.height),this.grid&&this.grid.onResize(e,t),this.onSizeChange.dispatch(this,e,t),this.currentScaleMode===i.ScaleManager.RESIZE&&(this.game.state.resize(e,t),this.game.load.resize(e,t))}},setMinMax:function(e,t,i,s){this.minWidth=e,this.minHeight=t,void 0!==i&&(this.maxWidth=i),void 0!==s&&(this.maxHeight=s)},preUpdate:function(){if(!(this.game.time.time<this._lastUpdate+this._updateThrottle)){var e=this._updateThrottle;this._updateThrottleReset=e>=400?0:100,this.dom.getOffset(this.game.canvas,this.offset);var t=this._parentBounds.width,s=this._parentBounds.height,a=this.getParentBounds(this._parentBounds),n=a.width!==t||a.height!==s,o=this.updateOrientationState();(n||o)&&(this.onResize&&this.onResize.call(this.onResizeContext,this,a),this.updateLayout(),this.signalSizeChange());var r=2*this._updateThrottle;this._updateThrottle<e&&(r=Math.min(e,this._updateThrottleReset)),this._updateThrottle=i.Math.clamp(r,25,this.trackParentInterval),this._lastUpdate=this.game.time.time}},pauseUpdate:function(){this.preUpdate(),this._updateThrottle=this.trackParentInterval},updateDimensions:function(e,t,i){this.width=e*this.parentScaleFactor.x,this.height=t*this.parentScaleFactor.y,this.game.width=this.width,this.game.height=this.height,this.sourceAspectRatio=this.width/this.height,this.updateScalingAndBounds(),i&&(this.game.renderer.resize(this.width,this.height),this.game.camera.setSize(this.width,this.height),this.game.world.resize(this.width,this.height))},updateScalingAndBounds:function(){this.scaleFactor.x=this.game.width/this.width,this.scaleFactor.y=this.game.height/this.height,this.scaleFactorInversed.x=this.width/this.game.width,this.scaleFactorInversed.y=this.height/this.game.height,this.aspectRatio=this.width/this.height,this.game.canvas&&this.dom.getOffset(this.game.canvas,this.offset),this.bounds.setTo(this.offset.x,this.offset.y,this.width,this.height),this.game.input&&this.game.input.scale&&this.game.input.scale.setTo(this.scaleFactor.x,this.scaleFactor.y)},forceOrientation:function(e,t){void 0===t&&(t=!1),this.forceLandscape=e,this.forcePortrait=t,this.queueUpdate(!0)},classifyOrientation:function(e){return"portrait-primary"===e||"portrait-secondary"===e?"portrait":"landscape-primary"===e||"landscape-secondary"===e?"landscape":null},updateOrientationState:function(){var e=this.screenOrientation,t=this.incorrectOrientation;this.screenOrientation=this.dom.getScreenOrientation(this.compatibility.orientationFallback),this.incorrectOrientation=this.forceLandscape&&!this.isLandscape||this.forcePortrait&&!this.isPortrait;var i=e!==this.screenOrientation,s=t!==this.incorrectOrientation;return s&&(this.incorrectOrientation?this.enterIncorrectOrientation.dispatch():this.leaveIncorrectOrientation.dispatch()),(i||s)&&this.onOrientationChange.dispatch(this,e,t),i||s},orientationChange:function(e){this.event=e,this.queueUpdate(!0)},windowResize:function(e){this.event=e,this.queueUpdate(!0)},scrollTop:function(){var e=this.compatibility.scrollTo;e&&window.scrollTo(e.x,e.y)},refresh:function(){this.scrollTop(),this.queueUpdate(!0)},updateLayout:function(){var e=this.currentScaleMode;if(e!==i.ScaleManager.RESIZE){if(this.scrollTop(),this.compatibility.forceMinimumDocumentHeight&&(document.documentElement.style.minHeight=window.innerHeight+"px"),this.incorrectOrientation?this.setMaximum():e===i.ScaleManager.EXACT_FIT?this.setExactFit():e===i.ScaleManager.SHOW_ALL?!this.isFullScreen&&this.boundingParent&&this.compatibility.canExpandParent?(this.setShowAll(!0),this.resetCanvas(),this.setShowAll()):this.setShowAll():e===i.ScaleManager.NO_SCALE?(this.width=this.game.width,this.height=this.game.height):e===i.ScaleManager.USER_SCALE&&(this.width=this.game.width*this._userScaleFactor.x-this._userScaleTrim.x,this.height=this.game.height*this._userScaleFactor.y-this._userScaleTrim.y),!this.compatibility.canExpandParent&&(e===i.ScaleManager.SHOW_ALL||e===i.ScaleManager.USER_SCALE)){var t=this.getParentBounds(this._tempBounds);this.width=Math.min(this.width,t.width),this.height=Math.min(this.height,t.height)}this.width=0|this.width,this.height=0|this.height,this.reflowCanvas()}else this.reflowGame()},getParentBounds:function(e){var t=e||new i.Rectangle,s=this.boundingParent,a=this.dom.visualBounds,n=this.dom.layoutBounds;if(s){var o=s.getBoundingClientRect(),r=s.offsetParent?s.offsetParent.getBoundingClientRect():s.getBoundingClientRect();t.setTo(o.left-r.left,o.top-r.top,o.width,o.height);var l=this.windowConstraints;if(l.right){h="layout"===l.right?n:a;t.right=Math.min(t.right,h.width)}if(l.bottom){var h="layout"===l.bottom?n:a;t.bottom=Math.min(t.bottom,h.height)}}else t.setTo(0,0,a.width,a.height);return t.setTo(Math.round(t.x),Math.round(t.y),Math.round(t.width),Math.round(t.height)),t},alignCanvas:function(e,t){var i=this.getParentBounds(this._tempBounds),s=this.game.canvas,a=this.margin;if(e){a.left=a.right=0;l=s.getBoundingClientRect();if(this.width<i.width&&!this.incorrectOrientation){var n=l.left-i.x,o=i.width/2-this.width/2,r=(o=Math.max(o,0))-n;a.left=Math.round(r)}s.style.marginLeft=a.left+"px",0!==a.left&&(a.right=-(i.width-l.width-a.left),s.style.marginRight=a.right+"px")}if(t){a.top=a.bottom=0;var l=s.getBoundingClientRect();if(this.height<i.height&&!this.incorrectOrientation){var n=l.top-i.y,o=i.height/2-this.height/2,r=(o=Math.max(o,0))-n;a.top=Math.round(r)}s.style.marginTop=a.top+"px",0!==a.top&&(a.bottom=-(i.height-l.height-a.top),s.style.marginBottom=a.bottom+"px")}a.x=a.left,a.y=a.top},reflowGame:function(){this.resetCanvas("","");var e=this.getParentBounds(this._tempBounds);this.updateDimensions(e.width,e.height,!0)},reflowCanvas:function(){this.incorrectOrientation||(this.width=i.Math.clamp(this.width,this.minWidth||0,this.maxWidth||this.width),this.height=i.Math.clamp(this.height,this.minHeight||0,this.maxHeight||this.height)),this.resetCanvas(),this.compatibility.noMargins||(this.isFullScreen&&this._createdFullScreenTarget?this.alignCanvas(!0,!0):this.alignCanvas(this.pageAlignHorizontally,this.pageAlignVertically)),this.updateScalingAndBounds()},resetCanvas:function(e,t){void 0===e&&(e=this.width+"px"),void 0===t&&(t=this.height+"px");var i=this.game.canvas;this.compatibility.noMargins||(i.style.marginLeft="",i.style.marginTop="",i.style.marginRight="",i.style.marginBottom=""),i.style.width=e,i.style.height=t},queueUpdate:function(e){e&&(this._parentBounds.width=0,this._parentBounds.height=0),this._updateThrottle=this._updateThrottleReset},reset:function(e){e&&this.grid&&this.grid.reset()},setMaximum:function(){this.width=this.dom.visualBounds.width,this.height=this.dom.visualBounds.height},setShowAll:function(e){var t,i=this.getParentBounds(this._tempBounds),s=i.width,a=i.height;t=e?Math.max(a/this.game.height,s/this.game.width):Math.min(a/this.game.height,s/this.game.width),this.width=Math.round(this.game.width*t),this.height=Math.round(this.game.height*t)},setExactFit:function(){var e=this.getParentBounds(this._tempBounds);this.width=e.width,this.height=e.height,this.isFullScreen||(this.maxWidth&&(this.width=Math.min(this.width,this.maxWidth)),this.maxHeight&&(this.height=Math.min(this.height,this.maxHeight)))},createFullScreenTarget:function(){var e=document.createElement("div");return e.style.margin="0",e.style.padding="0",e.style.background="#000",e},startFullScreen:function(e,t){if(this.isFullScreen)return!1;{if(this.compatibility.supportsFullScreen){if("when-not-mouse"===this.compatibility.clickTrampoline){var s=this.game.input;if(s.activePointer&&s.activePointer!==s.mousePointer&&(t||!1!==t))return void s.activePointer.addClickTrampoline("startFullScreen",this.startFullScreen,this,[e,!1])}void 0!==e&&this.game.renderType===i.CANVAS&&(this.game.stage.smoothed=e);var a=this.fullScreenTarget;a||(this.cleanupCreatedTarget(),this._createdFullScreenTarget=this.createFullScreenTarget(),a=this._createdFullScreenTarget);var n={targetElement:a};if(this.hasPhaserSetFullScreen=!0,this.onFullScreenInit.dispatch(this,n),this._createdFullScreenTarget){var o=this.game.canvas;o.parentNode.insertBefore(a,o),a.appendChild(o)}return this.game.device.fullscreenKeyboard?a[this.game.device.requestFullscreen](Element.ALLOW_KEYBOARD_INPUT):a[this.game.device.requestFullscreen](),!0}var r=this;setTimeout(function(){r.fullScreenError()},10)}},stopFullScreen:function(){return!(!this.isFullScreen||!this.compatibility.supportsFullScreen||(this.hasPhaserSetFullScreen=!1,document[this.game.device.cancelFullscreen](),0))},cleanupCreatedTarget:function(){var e=this._createdFullScreenTarget;if(e&&e.parentNode){var t=e.parentNode;t.insertBefore(this.game.canvas,e),t.removeChild(e)}this._createdFullScreenTarget=null},prepScreenMode:function(e){var t=!!this._createdFullScreenTarget,s=this._createdFullScreenTarget||this.fullScreenTarget;e?(t||this.fullScreenScaleMode===i.ScaleManager.EXACT_FIT)&&s!==this.game.canvas&&(this._fullScreenRestore={targetWidth:s.style.width,targetHeight:s.style.height},s.style.width="100%",s.style.height="100%"):(this._fullScreenRestore&&(s.style.width=this._fullScreenRestore.targetWidth,s.style.height=this._fullScreenRestore.targetHeight,this._fullScreenRestore=null),this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.resetCanvas())},fullScreenChange:function(e){this.event=e,this.isFullScreen?(this.prepScreenMode(!0),this.updateLayout(),this.queueUpdate(!0)):(this.prepScreenMode(!1),this.cleanupCreatedTarget(),this.updateLayout(),this.queueUpdate(!0)),this.onFullScreenChange.dispatch(this,this.width,this.height)},fullScreenError:function(e){this.event=e,this.cleanupCreatedTarget(),this.onFullScreenError.dispatch(this)},scaleSprite:function(e,t,i,s){if(void 0===t&&(t=this.width),void 0===i&&(i=this.height),void 0===s&&(s=!1),!e||!e.scale)return e;if(e.scale.x=1,e.scale.y=1,e.width<=0||e.height<=0||t<=0||i<=0)return e;var a=t,n=e.height*t/e.width,o=e.width*i/e.height,r=i,l=o>t;return(l=l?s:!s)?(e.width=Math.floor(a),e.height=Math.floor(n)):(e.width=Math.floor(o),e.height=Math.floor(r)),e},destroy:function(){this.game.onResume.remove(this._gameResumed,this),window.removeEventListener("orientationchange",this._orientationChange,!1),window.removeEventListener("resize",this._windowResize,!1),this.compatibility.supportsFullScreen&&(document.removeEventListener("webkitfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("mozfullscreenchange",this._fullScreenChange,!1),document.removeEventListener("MSFullscreenChange",this._fullScreenChange,!1),document.removeEventListener("fullscreenchange",this._fullScreenChange,!1),document.removeEventListener("webkitfullscreenerror",this._fullScreenError,!1),document.removeEventListener("mozfullscreenerror",this._fullScreenError,!1),document.removeEventListener("MSFullscreenError",this._fullScreenError,!1),document.removeEventListener("fullscreenerror",this._fullScreenError,!1))}},i.ScaleManager.prototype.constructor=i.ScaleManager,Object.defineProperty(i.ScaleManager.prototype,"boundingParent",{get:function(){return this.parentIsWindow||this.isFullScreen&&this.hasPhaserSetFullScreen&&!this._createdFullScreenTarget?null:this.game.canvas&&this.game.canvas.parentNode||null}}),Object.defineProperty(i.ScaleManager.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(e){return e!==this._scaleMode&&(this.isFullScreen||(this.updateDimensions(this._gameSize.width,this._gameSize.height,!0),this.queueUpdate(!0)),this._scaleMode=e),this._scaleMode}}),Object.defineProperty(i.ScaleManager.prototype,"fullScreenScaleMode",{get:function(){return this._fullScreenScaleMode},set:function(e){return e!==this._fullScreenScaleMode&&(this.isFullScreen?(this.prepScreenMode(!1),this._fullScreenScaleMode=e,this.prepScreenMode(!0),this.queueUpdate(!0)):this._fullScreenScaleMode=e),this._fullScreenScaleMode}}),Object.defineProperty(i.ScaleManager.prototype,"currentScaleMode",{get:function(){return this.isFullScreen?this._fullScreenScaleMode:this._scaleMode}}),Object.defineProperty(i.ScaleManager.prototype,"pageAlignHorizontally",{get:function(){return this._pageAlignHorizontally},set:function(e){e!==this._pageAlignHorizontally&&(this._pageAlignHorizontally=e,this.queueUpdate(!0))}}),Object.defineProperty(i.ScaleManager.prototype,"pageAlignVertically",{get:function(){return this._pageAlignVertically},set:function(e){e!==this._pageAlignVertically&&(this._pageAlignVertically=e,this.queueUpdate(!0))}}),Object.defineProperty(i.ScaleManager.prototype,"isFullScreen",{get:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement)}}),Object.defineProperty(i.ScaleManager.prototype,"isPortrait",{get:function(){return"portrait"===this.classifyOrientation(this.screenOrientation)}}),Object.defineProperty(i.ScaleManager.prototype,"isLandscape",{get:function(){return"landscape"===this.classifyOrientation(this.screenOrientation)}}),Object.defineProperty(i.ScaleManager.prototype,"isGamePortrait",{get:function(){return this.height>this.width}}),Object.defineProperty(i.ScaleManager.prototype,"isGameLandscape",{get:function(){return this.width>this.height}}),i.Utils.Debug=function(e){this.game=e,this.sprite=null,this.bmd=null,this.canvas=null,this.context=null,this.font="14px Courier",this.columnWidth=100,this.lineHeight=16,this.renderShadow=!0,this.currentX=0,this.currentY=0,this.currentAlpha=1,this.dirty=!1},i.Utils.Debug.prototype={boot:function(){this.game.renderType===i.CANVAS?this.context=this.game.context:(this.bmd=new i.BitmapData(this.game,"__DEBUG",this.game.width,this.game.height,!0),this.sprite=this.game.make.image(0,0,this.bmd),this.game.stage.addChild(this.sprite),this.game.scale.onSizeChange.add(this.resize,this),this.canvas=PIXI.CanvasPool.create(this,this.game.width,this.game.height),this.context=this.canvas.getContext("2d"))},resize:function(e,t,i){this.bmd.resize(t,i),this.canvas.width=t,this.canvas.height=i},preUpdate:function(){this.dirty&&this.sprite&&(this.bmd.clear(),this.bmd.draw(this.canvas,0,0),this.context.clearRect(0,0,this.game.width,this.game.height),this.dirty=!1)},reset:function(){this.context&&this.context.clearRect(0,0,this.game.width,this.game.height),this.sprite&&this.bmd.clear()},start:function(e,t,i,s){"number"!=typeof e&&(e=0),"number"!=typeof t&&(t=0),i=i||"rgb(255,255,255)",void 0===s&&(s=0),this.currentX=e,this.currentY=t,this.currentColor=i,this.columnWidth=s,this.dirty=!0,this.context.save(),this.context.setTransform(1,0,0,1,0,0),this.context.strokeStyle=i,this.context.fillStyle=i,this.context.font=this.font,this.context.globalAlpha=this.currentAlpha},stop:function(){this.context.restore()},line:function(){for(var e=this.currentX,t=0;t<arguments.length;t++)this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(arguments[t],e+1,this.currentY+1),this.context.fillStyle=this.currentColor),this.context.fillText(arguments[t],e,this.currentY),e+=this.columnWidth;this.currentY+=this.lineHeight},soundInfo:function(e,t,i,s){this.start(t,i,s),this.line("Sound: "+e.key+" Locked: "+e.game.sound.touchLocked),this.line("Is Ready?: "+this.game.cache.isSoundReady(e.key)+" Pending Playback: "+e.pendingPlayback),this.line("Decoded: "+e.isDecoded+" Decoding: "+e.isDecoding),this.line("Total Duration: "+e.totalDuration+" Playing: "+e.isPlaying),this.line("Time: "+e.currentTime),this.line("Volume: "+e.volume+" Muted: "+e.mute),this.line("WebAudio: "+e.usingWebAudio+" Audio: "+e.usingAudioTag),""!==e.currentMarker&&(this.line("Marker: "+e.currentMarker+" Duration: "+e.duration+" (ms: "+e.durationMS+")"),this.line("Start: "+e.markers[e.currentMarker].start+" Stop: "+e.markers[e.currentMarker].stop),this.line("Position: "+e.position)),this.stop()},cameraInfo:function(e,t,i,s){this.start(t,i,s),this.line("Camera ("+e.width+" x "+e.height+")"),this.line("X: "+e.x+" Y: "+e.y),e.bounds&&this.line("Bounds x: "+e.bounds.x+" Y: "+e.bounds.y+" w: "+e.bounds.width+" h: "+e.bounds.height),this.line("View x: "+e.view.x+" Y: "+e.view.y+" w: "+e.view.width+" h: "+e.view.height),this.line("Total in view: "+e.totalInView),this.stop()},timer:function(e,t,i,s){this.start(t,i,s),this.line("Timer (running: "+e.running+" expired: "+e.expired+")"),this.line("Next Tick: "+e.next+" Duration: "+e.duration),this.line("Paused: "+e.paused+" Length: "+e.length),this.stop()},pointer:function(e,t,i,s,a){null!=e&&(void 0===t&&(t=!1),i=i||"rgba(0,255,0,0.5)",s=s||"rgba(255,0,0,0.5)",!0===t&&!0===e.isUp||(this.start(e.x,e.y-100,a),this.context.beginPath(),this.context.arc(e.x,e.y,e.circle.radius,0,2*Math.PI),e.active?this.context.fillStyle=i:this.context.fillStyle=s,this.context.fill(),this.context.closePath(),this.context.beginPath(),this.context.moveTo(e.positionDown.x,e.positionDown.y),this.context.lineTo(e.position.x,e.position.y),this.context.lineWidth=2,this.context.stroke(),this.context.closePath(),this.line("ID: "+e.id+" Active: "+e.active),this.line("World X: "+e.worldX+" World Y: "+e.worldY),this.line("Screen X: "+e.x+" Screen Y: "+e.y+" In: "+e.withinGame),this.line("Duration: "+e.duration+" ms"),this.line("is Down: "+e.isDown+" is Up: "+e.isUp),this.stop()))},spriteInputInfo:function(e,t,i,s){this.start(t,i,s),this.line("Sprite Input: ("+e.width+" x "+e.height+")"),this.line("x: "+e.input.pointerX().toFixed(1)+" y: "+e.input.pointerY().toFixed(1)),this.line("over: "+e.input.pointerOver()+" duration: "+e.input.overDuration().toFixed(0)),this.line("down: "+e.input.pointerDown()+" duration: "+e.input.downDuration().toFixed(0)),this.line("just over: "+e.input.justOver()+" just out: "+e.input.justOut()),this.stop()},key:function(e,t,i,s){this.start(t,i,s,150),this.line("Key:",e.keyCode,"isDown:",e.isDown),this.line("justDown:",e.justDown,"justUp:",e.justUp),this.line("Time Down:",e.timeDown.toFixed(0),"duration:",e.duration.toFixed(0)),this.stop()},inputInfo:function(e,t,i){this.start(e,t,i),this.line("Input"),this.line("X: "+this.game.input.x+" Y: "+this.game.input.y),this.line("World X: "+this.game.input.worldX+" World Y: "+this.game.input.worldY),this.line("Scale X: "+this.game.input.scale.x.toFixed(1)+" Scale Y: "+this.game.input.scale.x.toFixed(1)),this.line("Screen X: "+this.game.input.activePointer.screenX+" Screen Y: "+this.game.input.activePointer.screenY),this.stop()},spriteBounds:function(e,t,i){var s=e.getBounds();s.x+=this.game.camera.x,s.y+=this.game.camera.y,this.rectangle(s,t,i)},ropeSegments:function(e,t,i){var s=this;e.segments.forEach(function(e){s.rectangle(e,t,i)},this)},spriteInfo:function(e,t,i,s){this.start(t,i,s),this.line("Sprite:  ("+e.width+" x "+e.height+") anchor: "+e.anchor.x+" x "+e.anchor.y),this.line("x: "+e.x.toFixed(1)+" y: "+e.y.toFixed(1)),this.line("angle: "+e.angle.toFixed(1)+" rotation: "+e.rotation.toFixed(1)),this.line("visible: "+e.visible+" in camera: "+e.inCamera),this.line("bounds x: "+e._bounds.x.toFixed(1)+" y: "+e._bounds.y.toFixed(1)+" w: "+e._bounds.width.toFixed(1)+" h: "+e._bounds.height.toFixed(1)),this.stop()},spriteCoords:function(e,t,i,s){this.start(t,i,s,100),e.name&&this.line(e.name),this.line("x:",e.x.toFixed(2),"y:",e.y.toFixed(2)),this.line("pos x:",e.position.x.toFixed(2),"pos y:",e.position.y.toFixed(2)),this.line("world x:",e.world.x.toFixed(2),"world y:",e.world.y.toFixed(2)),this.stop()},lineInfo:function(e,t,i,s){this.start(t,i,s,80),this.line("start.x:",e.start.x.toFixed(2),"start.y:",e.start.y.toFixed(2)),this.line("end.x:",e.end.x.toFixed(2),"end.y:",e.end.y.toFixed(2)),this.line("length:",e.length.toFixed(2),"angle:",e.angle),this.stop()},pixel:function(e,t,i,s){s=s||2,this.start(),this.context.fillStyle=i,this.context.fillRect(e,t,s,s),this.stop()},geom:function(e,t,s,a){void 0===s&&(s=!0),void 0===a&&(a=0),t=t||"rgba(0,255,0,0.4)",this.start(),this.context.fillStyle=t,this.context.strokeStyle=t,e instanceof i.Rectangle||1===a?s?this.context.fillRect(e.x-this.game.camera.x,e.y-this.game.camera.y,e.width,e.height):this.context.strokeRect(e.x-this.game.camera.x,e.y-this.game.camera.y,e.width,e.height):e instanceof i.Circle||2===a?(this.context.beginPath(),this.context.arc(e.x-this.game.camera.x,e.y-this.game.camera.y,e.radius,0,2*Math.PI,!1),this.context.closePath(),s?this.context.fill():this.context.stroke()):e instanceof i.Point||3===a?this.context.fillRect(e.x-this.game.camera.x,e.y-this.game.camera.y,4,4):(e instanceof i.Line||4===a)&&(this.context.lineWidth=1,this.context.beginPath(),this.context.moveTo(e.start.x+.5-this.game.camera.x,e.start.y+.5-this.game.camera.y),this.context.lineTo(e.end.x+.5-this.game.camera.x,e.end.y+.5-this.game.camera.y),this.context.closePath(),this.context.stroke()),this.stop()},rectangle:function(e,t,i){void 0===i&&(i=!0),t=t||"rgba(0, 255, 0, 0.4)",this.start(),i?(this.context.fillStyle=t,this.context.fillRect(e.x-this.game.camera.x,e.y-this.game.camera.y,e.width,e.height)):(this.context.strokeStyle=t,this.context.strokeRect(e.x-this.game.camera.x,e.y-this.game.camera.y,e.width,e.height)),this.stop()},text:function(e,t,i,s,a){s=s||"rgb(255,255,255)",a=a||"16px Courier",this.start(),this.context.font=a,this.renderShadow&&(this.context.fillStyle="rgb(0,0,0)",this.context.fillText(e,t+1,i+1)),this.context.fillStyle=s,this.context.fillText(e,t,i),this.stop()},quadTree:function(e,t){t=t||"rgba(255,0,0,0.3)",this.start();var i=e.bounds;if(0===e.nodes.length){this.context.strokeStyle=t,this.context.strokeRect(i.x,i.y,i.width,i.height),this.text("size: "+e.objects.length,i.x+4,i.y+16,"rgb(0,200,0)","12px Courier"),this.context.strokeStyle="rgb(0,255,0)";for(s=0;s<e.objects.length;s++)this.context.strokeRect(e.objects[s].x,e.objects[s].y,e.objects[s].width,e.objects[s].height)}else for(var s=0;s<e.nodes.length;s++)this.quadTree(e.nodes[s]);this.stop()},body:function(e,t,s){e.body&&(this.start(),e.body.type===i.Physics.ARCADE?i.Physics.Arcade.Body.render(this.context,e.body,t,s):e.body.type===i.Physics.NINJA?i.Physics.Ninja.Body.render(this.context,e.body,t,s):e.body.type===i.Physics.BOX2D&&i.Physics.Box2D.renderBody(this.context,e.body,t),this.stop())},bodyInfo:function(e,t,s,a){e.body&&(this.start(t,s,a,210),e.body.type===i.Physics.ARCADE?i.Physics.Arcade.Body.renderBodyInfo(this,e.body):e.body.type===i.Physics.BOX2D&&this.game.physics.box2d.renderBodyInfo(this,e.body),this.stop())},box2dWorld:function(){this.start(),this.context.translate(-this.game.camera.view.x,-this.game.camera.view.y,0),this.game.physics.box2d.renderDebugDraw(this.context),this.stop()},box2dBody:function(e,t){this.start(),i.Physics.Box2D.renderBody(this.context,e,t),this.stop()},displayList:function(e){if(void 0===e&&(e=this.game.world),e.hasOwnProperty("renderOrderID"),e.children&&e.children.length>0)for(var t=0;t<e.children.length;t++)this.game.debug.displayList(e.children[t])},destroy:function(){PIXI.CanvasPool.remove(this)}},i.Utils.Debug.prototype.constructor=i.Utils.Debug,i.DOM={getOffset:function(e,t){t=t||new i.Point;var s=e.getBoundingClientRect(),a=i.DOM.scrollY,n=i.DOM.scrollX,o=document.documentElement.clientTop,r=document.documentElement.clientLeft;return t.x=s.left+n-r,t.y=s.top+a-o,t},getBounds:function(e,t){return void 0===t&&(t=0),!(!(e=e&&!e.nodeType?e[0]:e)||1!==e.nodeType)&&this.calibrate(e.getBoundingClientRect(),t)},calibrate:function(e,t){t=+t||0;var i={width:0,height:0,left:0,right:0,top:0,bottom:0};return i.width=(i.right=e.right+t)-(i.left=e.left-t),i.height=(i.bottom=e.bottom+t)-(i.top=e.top-t),i},getAspectRatio:function(e){var t=(e=null==e?this.visualBounds:1===e.nodeType?this.getBounds(e):e).width,i=e.height;return"function"==typeof t&&(t=t.call(e)),"function"==typeof i&&(i=i.call(e)),t/i},inLayoutViewport:function(e,t){var i=this.getBounds(e,t);return!!i&&i.bottom>=0&&i.right>=0&&i.top<=this.layoutBounds.width&&i.left<=this.layoutBounds.height},getScreenOrientation:function(e){var t=window.screen,i=t.orientation||t.mozOrientation||t.msOrientation;if(i&&"string"==typeof i.type)return i.type;if("string"==typeof i)return i;var s="portrait-primary",a="landscape-primary";if("screen"===e)return t.height>t.width?s:a;if("viewport"===e)return this.visualBounds.height>this.visualBounds.width?s:a;if("window.orientation"===e&&"number"==typeof window.orientation)return 0===window.orientation||180===window.orientation?s:a;if(window.matchMedia){if(window.matchMedia("(orientation: portrait)").matches)return s;if(window.matchMedia("(orientation: landscape)").matches)return a}return this.visualBounds.height>this.visualBounds.width?s:a},visualBounds:new i.Rectangle,layoutBounds:new i.Rectangle,documentBounds:new i.Rectangle},i.Device.whenReady(function(e){var t=window&&"pageXOffset"in window?function(){return window.pageXOffset}:function(){return document.documentElement.scrollLeft},s=window&&"pageYOffset"in window?function(){return window.pageYOffset}:function(){return document.documentElement.scrollTop};if(Object.defineProperty(i.DOM,"scrollX",{get:t}),Object.defineProperty(i.DOM,"scrollY",{get:s}),Object.defineProperty(i.DOM.visualBounds,"x",{get:t}),Object.defineProperty(i.DOM.visualBounds,"y",{get:s}),Object.defineProperty(i.DOM.layoutBounds,"x",{value:0}),Object.defineProperty(i.DOM.layoutBounds,"y",{value:0}),e.desktop&&document.documentElement.clientWidth<=window.innerWidth&&document.documentElement.clientHeight<=window.innerHeight){var a=function(){return Math.max(window.innerWidth,document.documentElement.clientWidth)},n=function(){return Math.max(window.innerHeight,document.documentElement.clientHeight)};Object.defineProperty(i.DOM.visualBounds,"width",{get:a}),Object.defineProperty(i.DOM.visualBounds,"height",{get:n}),Object.defineProperty(i.DOM.layoutBounds,"width",{get:a}),Object.defineProperty(i.DOM.layoutBounds,"height",{get:n})}else Object.defineProperty(i.DOM.visualBounds,"width",{get:function(){return window.innerWidth}}),Object.defineProperty(i.DOM.visualBounds,"height",{get:function(){return window.innerHeight}}),Object.defineProperty(i.DOM.layoutBounds,"width",{get:function(){var e=document.documentElement.clientWidth,t=window.innerWidth;return e<t?t:e}}),Object.defineProperty(i.DOM.layoutBounds,"height",{get:function(){var e=document.documentElement.clientHeight,t=window.innerHeight;return e<t?t:e}});Object.defineProperty(i.DOM.documentBounds,"x",{value:0}),Object.defineProperty(i.DOM.documentBounds,"y",{value:0}),Object.defineProperty(i.DOM.documentBounds,"width",{get:function(){var e=document.documentElement;return Math.max(e.clientWidth,e.offsetWidth,e.scrollWidth)}}),Object.defineProperty(i.DOM.documentBounds,"height",{get:function(){var e=document.documentElement;return Math.max(e.clientHeight,e.offsetHeight,e.scrollHeight)}})},null,!0),i.ArraySet=function(e){this.position=0,this.list=e||[]},i.ArraySet.prototype={add:function(e){return this.exists(e)||this.list.push(e),e},getIndex:function(e){return this.list.indexOf(e)},getByKey:function(e,t){for(var i=this.list.length;i--;)if(this.list[i][e]===t)return this.list[i];return null},exists:function(e){return this.list.indexOf(e)>-1},reset:function(){this.list.length=0},remove:function(e){var t=this.list.indexOf(e);if(t>-1)return this.list.splice(t,1),e},setAll:function(e,t){for(var i=this.list.length;i--;)this.list[i]&&(this.list[i][e]=t)},callAll:function(e){for(var t=Array.prototype.slice.call(arguments,1),i=this.list.length;i--;)this.list[i]&&this.list[i][e]&&this.list[i][e].apply(this.list[i],t)},removeAll:function(e){void 0===e&&(e=!1);for(var t=this.list.length;t--;)if(this.list[t]){var i=this.remove(this.list[t]);e&&i.destroy()}this.position=0,this.list=[]}},Object.defineProperty(i.ArraySet.prototype,"total",{get:function(){return this.list.length}}),Object.defineProperty(i.ArraySet.prototype,"first",{get:function(){return this.position=0,this.list.length>0?this.list[0]:null}}),Object.defineProperty(i.ArraySet.prototype,"next",{get:function(){return this.position<this.list.length?(this.position++,this.list[this.position]):null}}),i.ArraySet.prototype.constructor=i.ArraySet,i.ArrayUtils={getRandomItem:function(e,t,i){if(null===e)return null;void 0===t&&(t=0),void 0===i&&(i=e.length);var s=t+Math.floor(Math.random()*i);return void 0===e[s]?null:e[s]},removeRandomItem:function(e,t,i){if(null==e)return null;void 0===t&&(t=0),void 0===i&&(i=e.length);var s=t+Math.floor(Math.random()*i);if(s<e.length){var a=e.splice(s,1);return void 0===a[0]?null:a[0]}return null},shuffle:function(e){for(var t=e.length-1;t>0;t--){var i=Math.floor(Math.random()*(t+1)),s=e[t];e[t]=e[i],e[i]=s}return e},transposeMatrix:function(e){for(var t=e.length,i=e[0].length,s=new Array(i),a=0;a<i;a++){s[a]=new Array(t);for(var n=t-1;n>-1;n--)s[a][n]=e[n][a]}return s},rotateMatrix:function(e,t){if("string"!=typeof t&&(t=(t%360+360)%360),90===t||-270===t||"rotateLeft"===t)e=i.ArrayUtils.transposeMatrix(e),e=e.reverse();else if(-90===t||270===t||"rotateRight"===t)e=e.reverse(),e=i.ArrayUtils.transposeMatrix(e);else if(180===Math.abs(t)||"rotate180"===t){for(var s=0;s<e.length;s++)e[s].reverse();e=e.reverse()}return e},findClosest:function(e,t){if(!t.length)return NaN;if(1===t.length||e<t[0])return t[0];for(var i=1;t[i]<e;)i++;var s=t[i-1],a=i<t.length?t[i]:Number.POSITIVE_INFINITY;return a-e<=e-s?a:s},rotateRight:function(e){var t=e.pop();return e.unshift(t),t},rotateLeft:function(e){var t=e.shift();return e.push(t),t},rotate:function(e){var t=e.shift();return e.push(t),t},numberArray:function(e,t){for(var i=[],s=e;s<=t;s++)i.push(s);return i},numberArrayStep:function(e,t,s){void 0!==e&&null!==e||(e=0),void 0!==t&&null!==t||(t=e,e=0),void 0===s&&(s=1);for(var a=[],n=Math.max(i.Math.roundAwayFromZero((t-e)/(s||1)),0),o=0;o<n;o++)a.push(e),e+=s;return a}},i.LinkedList=function(){this.next=null,this.prev=null,this.first=null,this.last=null,this.total=0},i.LinkedList.prototype={add:function(e){return 0===this.total&&null===this.first&&null===this.last?(this.first=e,this.last=e,this.next=e,e.prev=this,this.total++,e):(this.last.next=e,e.prev=this.last,this.last=e,this.total++,e)},reset:function(){this.first=null,this.last=null,this.next=null,this.prev=null,this.total=0},remove:function(e){return 1===this.total?(this.reset(),void(e.next=e.prev=null)):(e===this.first?this.first=this.first.next:e===this.last&&(this.last=this.last.prev),e.prev&&(e.prev.next=e.next),e.next&&(e.next.prev=e.prev),e.next=e.prev=null,null===this.first&&(this.last=null),void this.total--)},callAll:function(e){if(this.first&&this.last){var t=this.first;do{t&&t[e]&&t[e].call(t),t=t.next}while(t!==this.last.next)}}},i.LinkedList.prototype.constructor=i.LinkedList,i.Create=function(e){this.game=e,this.bmd=null,this.canvas=null,this.ctx=null,this.palettes=[{0:"#000",1:"#9D9D9D",2:"#FFF",3:"#BE2633",4:"#E06F8B",5:"#493C2B",6:"#A46422",7:"#EB8931",8:"#F7E26B",9:"#2F484E",A:"#44891A",B:"#A3CE27",C:"#1B2632",D:"#005784",E:"#31A2F2",F:"#B2DCEF"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#f5f4eb"},{0:"#000",1:"#2234d1",2:"#0c7e45",3:"#44aacc",4:"#8a3622",5:"#5c2e78",6:"#aa5c3d",7:"#b5b5b5",8:"#5e606e",9:"#4c81fb",A:"#6cd947",B:"#7be2f9",C:"#eb8a60",D:"#e23d69",E:"#ffd93f",F:"#fff"},{0:"#000",1:"#fff",2:"#8b4131",3:"#7bbdc5",4:"#8b41ac",5:"#6aac41",6:"#3931a4",7:"#d5de73",8:"#945a20",9:"#5a4100",A:"#bd736a",B:"#525252",C:"#838383",D:"#acee8b",E:"#7b73de",F:"#acacac"},{0:"#000",1:"#191028",2:"#46af45",3:"#a1d685",4:"#453e78",5:"#7664fe",6:"#833129",7:"#9ec2e8",8:"#dc534b",9:"#e18d79",A:"#d6b97b",B:"#e9d8a1",C:"#216c4b",D:"#d365c8",E:"#afaab9",F:"#fff"}]},i.Create.PALETTE_ARNE=0,i.Create.PALETTE_JMP=1,i.Create.PALETTE_CGA=2,i.Create.PALETTE_C64=3,i.Create.PALETTE_JAPANESE_MACHINE=4,i.Create.prototype={texture:function(e,t,i,s,a){void 0===i&&(i=8),void 0===s&&(s=i),void 0===a&&(a=0);var n=t[0].length*i,o=t.length*s;null===this.bmd&&(this.bmd=this.game.make.bitmapData(),this.canvas=this.bmd.canvas,this.ctx=this.bmd.context),this.bmd.resize(n,o),this.bmd.clear();for(var r=0;r<t.length;r++)for(var l=t[r],h=0;h<l.length;h++){var c=l[h];"."!==c&&" "!==c&&(this.ctx.fillStyle=this.palettes[a][c],this.ctx.fillRect(h*i,r*s,i,s))}return this.bmd.generateTexture(e)},grid:function(e,t,i,s,a,n){null===this.bmd&&(this.bmd=this.game.make.bitmapData(),this.canvas=this.bmd.canvas,this.ctx=this.bmd.context),this.bmd.resize(t,i),this.ctx.fillStyle=n;for(var o=0;o<i;o+=a)this.ctx.fillRect(0,o,t,1);for(var r=0;r<t;r+=s)this.ctx.fillRect(r,0,1,i);return this.bmd.generateTexture(e)}},i.Create.prototype.constructor=i.Create,i.FlexGrid=function(e,t,s){this.game=e.game,this.manager=e,this.width=t,this.height=s,this.boundsCustom=new i.Rectangle(0,0,t,s),this.boundsFluid=new i.Rectangle(0,0,t,s),this.boundsFull=new i.Rectangle(0,0,t,s),this.boundsNone=new i.Rectangle(0,0,t,s),this.positionCustom=new i.Point(0,0),this.positionFluid=new i.Point(0,0),this.positionFull=new i.Point(0,0),this.positionNone=new i.Point(0,0),this.scaleCustom=new i.Point(1,1),this.scaleFluid=new i.Point(1,1),this.scaleFluidInversed=new i.Point(1,1),this.scaleFull=new i.Point(1,1),this.scaleNone=new i.Point(1,1),this.customWidth=0,this.customHeight=0,this.customOffsetX=0,this.customOffsetY=0,this.ratioH=t/s,this.ratioV=s/t,this.multiplier=0,this.layers=[]},i.FlexGrid.prototype={setSize:function(e,t){this.width=e,this.height=t,this.ratioH=e/t,this.ratioV=t/e,this.scaleNone=new i.Point(1,1),this.boundsNone.width=this.width,this.boundsNone.height=this.height,this.refresh()},createCustomLayer:function(e,t,s,a){void 0===a&&(a=!0),this.customWidth=e,this.customHeight=t,this.boundsCustom.width=e,this.boundsCustom.height=t;var n=new i.FlexLayer(this,this.positionCustom,this.boundsCustom,this.scaleCustom);return a&&this.game.world.add(n),this.layers.push(n),void 0!==s&&null!==typeof s&&n.addMultiple(s),n},createFluidLayer:function(e,t){void 0===t&&(t=!0);var s=new i.FlexLayer(this,this.positionFluid,this.boundsFluid,this.scaleFluid);return t&&this.game.world.add(s),this.layers.push(s),void 0!==e&&null!==typeof e&&s.addMultiple(e),s},createFullLayer:function(e){var t=new i.FlexLayer(this,this.positionFull,this.boundsFull,this.scaleFluid);return this.game.world.add(t),this.layers.push(t),void 0!==e&&t.addMultiple(e),t},createFixedLayer:function(e){var t=new i.FlexLayer(this,this.positionNone,this.boundsNone,this.scaleNone);return this.game.world.add(t),this.layers.push(t),void 0!==e&&t.addMultiple(e),t},reset:function(){for(var e=this.layers.length;e--;)this.layers[e].persist||(this.layers[e].position=null,this.layers[e].scale=null,this.layers.slice(e,1))},onResize:function(e,t){this.ratioH=e/t,this.ratioV=t/e,this.refresh(e,t)},refresh:function(){this.multiplier=Math.min(this.manager.height/this.height,this.manager.width/this.width),this.boundsFluid.width=Math.round(this.width*this.multiplier),this.boundsFluid.height=Math.round(this.height*this.multiplier),this.scaleFluid.set(this.boundsFluid.width/this.width,this.boundsFluid.height/this.height),this.scaleFluidInversed.set(this.width/this.boundsFluid.width,this.height/this.boundsFluid.height),this.scaleFull.set(this.boundsFull.width/this.width,this.boundsFull.height/this.height),this.boundsFull.width=Math.round(this.manager.width*this.scaleFluidInversed.x),this.boundsFull.height=Math.round(this.manager.height*this.scaleFluidInversed.y),this.boundsFluid.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY),this.boundsNone.centerOn(this.manager.bounds.centerX,this.manager.bounds.centerY),this.positionFluid.set(this.boundsFluid.x,this.boundsFluid.y),this.positionNone.set(this.boundsNone.x,this.boundsNone.y)},fitSprite:function(e){this.manager.scaleSprite(e),e.x=this.manager.bounds.centerX,e.y=this.manager.bounds.centerY},debug:function(){this.game.debug.text(this.boundsFluid.width+" x "+this.boundsFluid.height,this.boundsFluid.x+4,this.boundsFluid.y+16),this.game.debug.geom(this.boundsFluid,"rgba(255,0,0,0.9",!1)}},i.FlexGrid.prototype.constructor=i.FlexGrid,i.FlexLayer=function(e,t,s,a){i.Group.call(this,e.game,null,"__flexLayer"+e.game.rnd.uuid(),!1),this.manager=e.manager,this.grid=e,this.persist=!1,this.position=t,this.bounds=s,this.scale=a,this.topLeft=s.topLeft,this.topMiddle=new i.Point(s.halfWidth,0),this.topRight=s.topRight,this.bottomLeft=s.bottomLeft,this.bottomMiddle=new i.Point(s.halfWidth,s.bottom),this.bottomRight=s.bottomRight},i.FlexLayer.prototype=Object.create(i.Group.prototype),i.FlexLayer.prototype.constructor=i.FlexLayer,i.FlexLayer.prototype.resize=function(){},i.FlexLayer.prototype.debug=function(){this.game.debug.text(this.bounds.width+" x "+this.bounds.height,this.bounds.x+4,this.bounds.y+16),this.game.debug.geom(this.bounds,"rgba(0,0,255,0.9",!1),this.game.debug.geom(this.topLeft,"rgba(255,255,255,0.9"),this.game.debug.geom(this.topMiddle,"rgba(255,255,255,0.9"),this.game.debug.geom(this.topRight,"rgba(255,255,255,0.9")},i.Color={packPixel:function(e,t,s,a){return i.Device.LITTLE_ENDIAN?(a<<24|s<<16|t<<8|e)>>>0:(e<<24|t<<16|s<<8|a)>>>0},unpackPixel:function(e,t,s,a){return void 0!==t&&null!==t||(t=i.Color.createColor()),void 0!==s&&null!==s||(s=!1),void 0!==a&&null!==a||(a=!1),i.Device.LITTLE_ENDIAN?(t.a=(4278190080&e)>>>24,t.b=(16711680&e)>>>16,t.g=(65280&e)>>>8,t.r=255&e):(t.r=(4278190080&e)>>>24,t.g=(16711680&e)>>>16,t.b=(65280&e)>>>8,t.a=255&e),t.color=e,t.rgba="rgba("+t.r+","+t.g+","+t.b+","+t.a/255+")",s&&i.Color.RGBtoHSL(t.r,t.g,t.b,t),a&&i.Color.RGBtoHSV(t.r,t.g,t.b,t),t},fromRGBA:function(e,t){return t||(t=i.Color.createColor()),t.r=(4278190080&e)>>>24,t.g=(16711680&e)>>>16,t.b=(65280&e)>>>8,t.a=255&e,t.rgba="rgba("+t.r+","+t.g+","+t.b+","+t.a+")",t},toRGBA:function(e,t,i,s){return e<<24|t<<16|i<<8|s},toABGR:function(e,t,i,s){return(s<<24|i<<16|t<<8|e)>>>0},RGBtoHSL:function(e,t,s,a){a||(a=i.Color.createColor(e,t,s,1)),e/=255,t/=255,s/=255;var n=Math.min(e,t,s),o=Math.max(e,t,s);if(a.h=0,a.s=0,a.l=(o+n)/2,o!==n){var r=o-n;a.s=a.l>.5?r/(2-o-n):r/(o+n),o===e?a.h=(t-s)/r+(t<s?6:0):o===t?a.h=(s-e)/r+2:o===s&&(a.h=(e-t)/r+4),a.h/=6}return a},HSLtoRGB:function(e,t,s,a){if(a?(a.r=s,a.g=s,a.b=s):a=i.Color.createColor(s,s,s),0!==t){var n=s<.5?s*(1+t):s+t-s*t,o=2*s-n;a.r=i.Color.hueToColor(o,n,e+1/3),a.g=i.Color.hueToColor(o,n,e),a.b=i.Color.hueToColor(o,n,e-1/3)}return a.r=Math.floor(255*a.r|0),a.g=Math.floor(255*a.g|0),a.b=Math.floor(255*a.b|0),i.Color.updateColor(a),a},RGBtoHSV:function(e,t,s,a){a||(a=i.Color.createColor(e,t,s,255)),e/=255,t/=255,s/=255;var n=Math.min(e,t,s),o=Math.max(e,t,s),r=o-n;return a.h=0,a.s=0===o?0:r/o,a.v=o,o!==n&&(o===e?a.h=(t-s)/r+(t<s?6:0):o===t?a.h=(s-e)/r+2:o===s&&(a.h=(e-t)/r+4),a.h/=6),a},HSVtoRGB:function(e,t,s,a){void 0===a&&(a=i.Color.createColor(0,0,0,1,e,t,0,s));var n,o,r,l=Math.floor(6*e),h=6*e-l,c=s*(1-t),p=s*(1-h*t),d=s*(1-(1-h)*t);switch(l%6){case 0:n=s,o=d,r=c;break;case 1:n=p,o=s,r=c;break;case 2:n=c,o=s,r=d;break;case 3:n=c,o=p,r=s;break;case 4:n=d,o=c,r=s;break;case 5:n=s,o=c,r=p}return a.r=Math.floor(255*n),a.g=Math.floor(255*o),a.b=Math.floor(255*r),i.Color.updateColor(a),a},hueToColor:function(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e},createColor:function(e,t,s,a,n,o,r,l){var h={r:e||0,g:t||0,b:s||0,a:a||1,h:n||0,s:o||0,l:r||0,v:l||0,color:0,color32:0,rgba:""};return i.Color.updateColor(h)},updateColor:function(e){return e.rgba="rgba("+e.r.toString()+","+e.g.toString()+","+e.b.toString()+","+e.a.toString()+")",e.color=i.Color.getColor(e.r,e.g,e.b),e.color32=i.Color.getColor32(255*e.a,e.r,e.g,e.b),e},getColor32:function(e,t,i,s){return e<<24|t<<16|i<<8|s},getColor:function(e,t,i){return e<<16|t<<8|i},RGBtoString:function(e,t,s,a,n){return void 0===a&&(a=255),void 0===n&&(n="#"),"#"===n?"#"+((1<<24)+(e<<16)+(t<<8)+s).toString(16).slice(1):"0x"+i.Color.componentToHex(a)+i.Color.componentToHex(e)+i.Color.componentToHex(t)+i.Color.componentToHex(s)},hexToRGB:function(e){var t=i.Color.hexToColor(e);if(t)return i.Color.getColor32(t.a,t.r,t.g,t.b)},hexToColor:function(e,t){e=e.replace(/^(?:#|0x)?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,i,s){return t+t+i+i+s+s});var s=/^(?:#|0x)?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(s){var a=parseInt(s[1],16),n=parseInt(s[2],16),o=parseInt(s[3],16);t?(t.r=a,t.g=n,t.b=o):t=i.Color.createColor(a,n,o)}return t},webToColor:function(e,t){t||(t=i.Color.createColor());var s=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d+(?:\.\d+)?))?\s*\)$/.exec(e);return s&&(t.r=parseInt(s[1],10),t.g=parseInt(s[2],10),t.b=parseInt(s[3],10),t.a=void 0!==s[4]?parseFloat(s[4]):1,i.Color.updateColor(t)),t},valueToColor:function(e,t){if(t||(t=i.Color.createColor()),"string"==typeof e)return 0===e.indexOf("rgb")?i.Color.webToColor(e,t):(t.a=1,i.Color.hexToColor(e,t));if("number"==typeof e){var s=i.Color.getRGB(e);return t.r=s.r,t.g=s.g,t.b=s.b,t.a=s.a/255,t}return t},componentToHex:function(e){var t=e.toString(16);return 1===t.length?"0"+t:t},HSVColorWheel:function(e,t){void 0===e&&(e=1),void 0===t&&(t=1);for(var s=[],a=0;a<=359;a++)s.push(i.Color.HSVtoRGB(a/359,e,t));return s},HSLColorWheel:function(e,t){void 0===e&&(e=.5),void 0===t&&(t=.5);for(var s=[],a=0;a<=359;a++)s.push(i.Color.HSLtoRGB(a/359,e,t));return s},interpolateColor:function(e,t,s,a,n){void 0===n&&(n=255);var o=i.Color.getRGB(e),r=i.Color.getRGB(t),l=(r.red-o.red)*a/s+o.red,h=(r.green-o.green)*a/s+o.green,c=(r.blue-o.blue)*a/s+o.blue;return i.Color.getColor32(n,l,h,c)},interpolateColorWithRGB:function(e,t,s,a,n,o){var r=i.Color.getRGB(e),l=(t-r.red)*o/n+r.red,h=(s-r.green)*o/n+r.green,c=(a-r.blue)*o/n+r.blue;return i.Color.getColor(l,h,c)},interpolateRGB:function(e,t,s,a,n,o,r,l){var h=(a-e)*l/r+e,c=(n-t)*l/r+t,p=(o-s)*l/r+s;return i.Color.getColor(h,c,p)},getRandomColor:function(e,t,s){if(void 0===e&&(e=0),void 0===t&&(t=255),void 0===s&&(s=255),t>255||e>t)return i.Color.getColor(255,255,255);var a=e+Math.round(Math.random()*(t-e)),n=e+Math.round(Math.random()*(t-e)),o=e+Math.round(Math.random()*(t-e));return i.Color.getColor32(s,a,n,o)},getRGB:function(e){return e>16777215?{alpha:e>>>24,red:e>>16&255,green:e>>8&255,blue:255&e,a:e>>>24,r:e>>16&255,g:e>>8&255,b:255&e}:{alpha:255,red:e>>16&255,green:e>>8&255,blue:255&e,a:255,r:e>>16&255,g:e>>8&255,b:255&e}},getWebRGB:function(e){if("object"==typeof e)return"rgba("+e.r.toString()+","+e.g.toString()+","+e.b.toString()+","+(e.a/255).toString()+")";var t=i.Color.getRGB(e);return"rgba("+t.r.toString()+","+t.g.toString()+","+t.b.toString()+","+(t.a/255).toString()+")"},getAlpha:function(e){return e>>>24},getAlphaFloat:function(e){return(e>>>24)/255},getRed:function(e){return e>>16&255},getGreen:function(e){return e>>8&255},getBlue:function(e){return 255&e},blendNormal:function(e){return e},blendLighten:function(e,t){return t>e?t:e},blendDarken:function(e,t){return t>e?e:t},blendMultiply:function(e,t){return e*t/255},blendAverage:function(e,t){return(e+t)/2},blendAdd:function(e,t){return Math.min(255,e+t)},blendSubtract:function(e,t){return Math.max(0,e+t-255)},blendDifference:function(e,t){return Math.abs(e-t)},blendNegation:function(e,t){return 255-Math.abs(255-e-t)},blendScreen:function(e,t){return 255-((255-e)*(255-t)>>8)},blendExclusion:function(e,t){return e+t-2*e*t/255},blendOverlay:function(e,t){return t<128?2*e*t/255:255-2*(255-e)*(255-t)/255},blendSoftLight:function(e,t){return t<128?2*(64+(e>>1))*(t/255):255-2*(255-(64+(e>>1)))*(255-t)/255},blendHardLight:function(e,t){return i.Color.blendOverlay(t,e)},blendColorDodge:function(e,t){return 255===t?t:Math.min(255,(e<<8)/(255-t))},blendColorBurn:function(e,t){return 0===t?t:Math.max(0,255-(255-e<<8)/t)},blendLinearDodge:function(e,t){return i.Color.blendAdd(e,t)},blendLinearBurn:function(e,t){return i.Color.blendSubtract(e,t)},blendLinearLight:function(e,t){return t<128?i.Color.blendLinearBurn(e,2*t):i.Color.blendLinearDodge(e,2*(t-128))},blendVividLight:function(e,t){return t<128?i.Color.blendColorBurn(e,2*t):i.Color.blendColorDodge(e,2*(t-128))},blendPinLight:function(e,t){return t<128?i.Color.blendDarken(e,2*t):i.Color.blendLighten(e,2*(t-128))},blendHardMix:function(e,t){return i.Color.blendVividLight(e,t)<128?0:255},blendReflect:function(e,t){return 255===t?t:Math.min(255,e*e/(255-t))},blendGlow:function(e,t){return i.Color.blendReflect(t,e)},blendPhoenix:function(e,t){return Math.min(e,t)-Math.max(e,t)+255}},i.Physics=function(e,t){t=t||{},this.game=e,this.config=t,this.arcade=null,this.p2=null,this.ninja=null,this.box2d=null,this.chipmunk=null,this.matter=null,this.parseConfig()},i.Physics.ARCADE=0,i.Physics.P2JS=1,i.Physics.NINJA=2,i.Physics.BOX2D=3,i.Physics.CHIPMUNK=4,i.Physics.MATTERJS=5,i.Physics.prototype={parseConfig:function(){this.config.hasOwnProperty("arcade")&&!0!==this.config.arcade||!i.Physics.hasOwnProperty("Arcade")||(this.arcade=new i.Physics.Arcade(this.game)),this.config.hasOwnProperty("ninja")&&!0===this.config.ninja&&i.Physics.hasOwnProperty("Ninja")&&(this.ninja=new i.Physics.Ninja(this.game)),this.config.hasOwnProperty("p2")&&!0===this.config.p2&&i.Physics.hasOwnProperty("P2")&&(this.p2=new i.Physics.P2(this.game,this.config)),this.config.hasOwnProperty("box2d")&&!0===this.config.box2d&&i.Physics.hasOwnProperty("BOX2D")&&(this.box2d=new i.Physics.BOX2D(this.game,this.config)),this.config.hasOwnProperty("matter")&&!0===this.config.matter&&i.Physics.hasOwnProperty("Matter")&&(this.matter=new i.Physics.Matter(this.game,this.config))},startSystem:function(e){e===i.Physics.ARCADE?this.arcade=new i.Physics.Arcade(this.game):e===i.Physics.P2JS?null===this.p2?this.p2=new i.Physics.P2(this.game,this.config):this.p2.reset():e===i.Physics.NINJA?this.ninja=new i.Physics.Ninja(this.game):e===i.Physics.BOX2D?null===this.box2d?this.box2d=new i.Physics.Box2D(this.game,this.config):this.box2d.reset():e===i.Physics.MATTERJS&&(null===this.matter?this.matter=new i.Physics.Matter(this.game,this.config):this.matter.reset())},enable:function(e,t,s){void 0===t&&(t=i.Physics.ARCADE),void 0===s&&(s=!1),t===i.Physics.ARCADE?this.arcade.enable(e):t===i.Physics.P2JS&&this.p2?this.p2.enable(e,s):t===i.Physics.NINJA&&this.ninja?this.ninja.enableAABB(e):t===i.Physics.BOX2D&&this.box2d?this.box2d.enable(e):t===i.Physics.MATTERJS&&this.matter&&this.matter.enable(e)},preUpdate:function(){this.p2&&this.p2.preUpdate(),this.box2d&&this.box2d.preUpdate(),this.matter&&this.matter.preUpdate()},update:function(){this.p2&&this.p2.update(),this.box2d&&this.box2d.update(),this.matter&&this.matter.update()},setBoundsToWorld:function(){this.arcade&&this.arcade.setBoundsToWorld(),this.ninja&&this.ninja.setBoundsToWorld(),this.p2&&this.p2.setBoundsToWorld(),this.box2d&&this.box2d.setBoundsToWorld(),this.matter&&this.matter.setBoundsToWorld()},clear:function(){this.p2&&this.p2.clear(),this.box2d&&this.box2d.clear(),this.matter&&this.matter.clear()},reset:function(){this.p2&&this.p2.reset(),this.box2d&&this.box2d.reset(),this.matter&&this.matter.reset()},destroy:function(){this.p2&&this.p2.destroy(),this.box2d&&this.box2d.destroy(),this.matter&&this.matter.destroy(),this.arcade=null,this.ninja=null,this.p2=null,this.box2d=null,this.matter=null}},i.Physics.prototype.constructor=i.Physics,i.Physics.Arcade=function(e){this.game=e,this.gravity=new i.Point,this.bounds=new i.Rectangle(0,0,e.world.width,e.world.height),this.checkCollision={up:!0,down:!0,left:!0,right:!0},this.maxObjects=10,this.maxLevels=4,this.OVERLAP_BIAS=4,this.forceX=!1,this.sortDirection=i.Physics.Arcade.LEFT_RIGHT,this.skipQuadTree=!0,this.isPaused=!1,this.quadTree=new i.QuadTree(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this._total=0,this.setBoundsToWorld()},i.Physics.Arcade.prototype.constructor=i.Physics.Arcade,i.Physics.Arcade.SORT_NONE=0,i.Physics.Arcade.LEFT_RIGHT=1,i.Physics.Arcade.RIGHT_LEFT=2,i.Physics.Arcade.TOP_BOTTOM=3,i.Physics.Arcade.BOTTOM_TOP=4,i.Physics.Arcade.prototype={setBounds:function(e,t,i,s){this.bounds.setTo(e,t,i,s)},setBoundsToWorld:function(){this.bounds.copyFrom(this.game.world.bounds)},enable:function(e,t){void 0===t&&(t=!0);var s=1;if(Array.isArray(e))for(s=e.length;s--;)e[s]instanceof i.Group?this.enable(e[s].children,t):(this.enableBody(e[s]),t&&e[s].hasOwnProperty("children")&&e[s].children.length>0&&this.enable(e[s],!0));else e instanceof i.Group?this.enable(e.children,t):(this.enableBody(e),t&&e.hasOwnProperty("children")&&e.children.length>0&&this.enable(e.children,!0))},enableBody:function(e){e.hasOwnProperty("body")&&null===e.body&&(e.body=new i.Physics.Arcade.Body(e),e.parent&&e.parent instanceof i.Group&&e.parent.addToHash(e))},updateMotion:function(e){var t=this.computeVelocity(0,e,e.angularVelocity,e.angularAcceleration,e.angularDrag,e.maxAngular)-e.angularVelocity;e.angularVelocity+=t,e.rotation+=e.angularVelocity*this.game.time.physicsElapsed,e.velocity.x=this.computeVelocity(1,e,e.velocity.x,e.acceleration.x,e.drag.x,e.maxVelocity.x),e.velocity.y=this.computeVelocity(2,e,e.velocity.y,e.acceleration.y,e.drag.y,e.maxVelocity.y)},computeVelocity:function(e,t,i,s,a,n){return void 0===n&&(n=1e4),1===e&&t.allowGravity?i+=(this.gravity.x+t.gravity.x)*this.game.time.physicsElapsed:2===e&&t.allowGravity&&(i+=(this.gravity.y+t.gravity.y)*this.game.time.physicsElapsed),s?i+=s*this.game.time.physicsElapsed:a&&(a*=this.game.time.physicsElapsed,i-a>0?i-=a:i+a<0?i+=a:i=0),i>n?i=n:i<-n&&(i=-n),i},overlap:function(e,t,i,s,a){if(i=i||null,s=s||null,a=a||i,this._total=0,!Array.isArray(e)&&Array.isArray(t))for(n=0;n<t.length;n++)this.collideHandler(e,t[n],i,s,a,!0);else if(Array.isArray(e)&&!Array.isArray(t))for(n=0;n<e.length;n++)this.collideHandler(e[n],t,i,s,a,!0);else if(Array.isArray(e)&&Array.isArray(t))for(var n=0;n<e.length;n++)for(var o=0;o<t.length;o++)this.collideHandler(e[n],t[o],i,s,a,!0);else this.collideHandler(e,t,i,s,a,!0);return this._total>0},collide:function(e,t,i,s,a){if(i=i||null,s=s||null,a=a||i,this._total=0,!Array.isArray(e)&&Array.isArray(t))for(n=0;n<t.length;n++)this.collideHandler(e,t[n],i,s,a,!1);else if(Array.isArray(e)&&!Array.isArray(t))for(n=0;n<e.length;n++)this.collideHandler(e[n],t,i,s,a,!1);else if(Array.isArray(e)&&Array.isArray(t))for(var n=0;n<e.length;n++)for(var o=0;o<t.length;o++)this.collideHandler(e[n],t[o],i,s,a,!1);else this.collideHandler(e,t,i,s,a,!1);return this._total>0},sortLeftRight:function(e,t){return e.body&&t.body?e.body.x-t.body.x:0},sortRightLeft:function(e,t){return e.body&&t.body?t.body.x-e.body.x:0},sortTopBottom:function(e,t){return e.body&&t.body?e.body.y-t.body.y:0},sortBottomTop:function(e,t){return e.body&&t.body?t.body.y-e.body.y:0},sort:function(e,t){null!==e.physicsSortDirection?t=e.physicsSortDirection:void 0===t&&(t=this.sortDirection),t===i.Physics.Arcade.LEFT_RIGHT?e.hash.sort(this.sortLeftRight):t===i.Physics.Arcade.RIGHT_LEFT?e.hash.sort(this.sortRightLeft):t===i.Physics.Arcade.TOP_BOTTOM?e.hash.sort(this.sortTopBottom):t===i.Physics.Arcade.BOTTOM_TOP&&e.hash.sort(this.sortBottomTop)},collideHandler:function(e,t,s,a,n,o){return void 0===t&&e.physicsType===i.GROUP?(this.sort(e),void this.collideGroupVsSelf(e,s,a,n,o)):void(e&&t&&e.exists&&t.exists&&(this.sortDirection!==i.Physics.Arcade.SORT_NONE&&(e.physicsType===i.GROUP&&this.sort(e),t.physicsType===i.GROUP&&this.sort(t)),e.physicsType===i.SPRITE?t.physicsType===i.SPRITE?this.collideSpriteVsSprite(e,t,s,a,n,o):t.physicsType===i.GROUP?this.collideSpriteVsGroup(e,t,s,a,n,o):t.physicsType===i.TILEMAPLAYER&&this.collideSpriteVsTilemapLayer(e,t,s,a,n,o):e.physicsType===i.GROUP?t.physicsType===i.SPRITE?this.collideSpriteVsGroup(t,e,s,a,n,o):t.physicsType===i.GROUP?this.collideGroupVsGroup(e,t,s,a,n,o):t.physicsType===i.TILEMAPLAYER&&this.collideGroupVsTilemapLayer(e,t,s,a,n,o):e.physicsType===i.TILEMAPLAYER&&(t.physicsType===i.SPRITE?this.collideSpriteVsTilemapLayer(t,e,s,a,n,o):t.physicsType===i.GROUP&&this.collideGroupVsTilemapLayer(t,e,s,a,n,o))))},collideSpriteVsSprite:function(e,t,i,s,a,n){return!(!e.body||!t.body||(this.separate(e.body,t.body,s,a,n)&&(i&&i.call(a,e,t),this._total++),0))},collideSpriteVsGroup:function(e,t,s,a,n,o){if(0!==t.length&&e.body)if(this.skipQuadTree||e.body.skipQuadTree)for(var r={},l=0;l<t.hash.length;l++){var h=t.hash[l];if(h&&h.exists&&h.body){if(r=h.body.getBounds(r),this.sortDirection===i.Physics.Arcade.LEFT_RIGHT){if(e.body.right<r.x)break;if(r.right<e.body.x)continue}else if(this.sortDirection===i.Physics.Arcade.RIGHT_LEFT){if(e.body.x>r.right)break;if(r.x>e.body.right)continue}else if(this.sortDirection===i.Physics.Arcade.TOP_BOTTOM){if(e.body.bottom<r.y)break;if(r.bottom<e.body.y)continue}else if(this.sortDirection===i.Physics.Arcade.BOTTOM_TOP){if(e.body.y>r.bottom)break;if(r.y>e.body.bottom)continue}this.collideSpriteVsSprite(e,h,s,a,n,o)}}else{this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(t);for(var c=this.quadTree.retrieve(e),l=0;l<c.length;l++)this.separate(e.body,c[l],a,n,o)&&(s&&s.call(n,e,c[l].sprite),this._total++)}},collideGroupVsSelf:function(e,t,s,a,n){if(0!==e.length)for(var o=0;o<e.hash.length;o++){var r={},l=e.hash[o];if(l&&l.exists&&l.body){r=l.body.getBounds(r);for(var h=o+1;h<e.hash.length;h++){var c={},p=e.hash[h];if(p&&p.exists&&p.body){if(c=p.body.getBounds(c),this.sortDirection===i.Physics.Arcade.LEFT_RIGHT){if(r.right<c.x)break;if(c.right<r.x)continue}else if(this.sortDirection===i.Physics.Arcade.RIGHT_LEFT){if(r.x>c.right)continue;if(c.x>r.right)break}else if(this.sortDirection===i.Physics.Arcade.TOP_BOTTOM){if(r.bottom<c.y)continue;if(c.bottom<r.y)break}else if(this.sortDirection===i.Physics.Arcade.BOTTOM_TOP){if(r.y>c.bottom)continue;if(c.y>l.body.bottom)break}this.collideSpriteVsSprite(l,p,t,s,a,n)}}}}},collideGroupVsGroup:function(e,t,s,a,n,o){if(0!==e.length&&0!==t.length)for(var r=0;r<e.children.length;r++)e.children[r].exists&&(e.children[r].physicsType===i.GROUP?this.collideGroupVsGroup(e.children[r],t,s,a,n,o):this.collideSpriteVsGroup(e.children[r],t,s,a,n,o))},separate:function(e,t,i,s,a){if(!e.enable||!t.enable||e.checkCollision.none||t.checkCollision.none||!this.intersects(e,t))return!1;if(i&&!1===i.call(s,e.sprite,t.sprite))return!1;if(e.isCircle&&t.isCircle)return this.separateCircle(e,t,a);if(e.isCircle!==t.isCircle){var n=e.isCircle?t:e,o=e.isCircle?e:t,r={x:n.x,y:n.y,right:n.right,bottom:n.bottom},l={x:o.x+o.radius,y:o.y+o.radius};if((l.y<r.y||l.y>r.bottom)&&(l.x<r.x||l.x>r.right))return this.separateCircle(e,t,a)}var h=!1,c=!1;this.forceX||Math.abs(this.gravity.y+e.gravity.y)<Math.abs(this.gravity.x+e.gravity.x)?(h=this.separateX(e,t,a),this.intersects(e,t)&&(c=this.separateY(e,t,a))):(c=this.separateY(e,t,a),this.intersects(e,t)&&(h=this.separateX(e,t,a)));var p=h||c;return p&&(a?(e.onOverlap&&e.onOverlap.dispatch(e.sprite,t.sprite),t.onOverlap&&t.onOverlap.dispatch(t.sprite,e.sprite)):(e.onCollide&&e.onCollide.dispatch(e.sprite,t.sprite),t.onCollide&&t.onCollide.dispatch(t.sprite,e.sprite))),p},intersects:function(e,t){return e!==t&&(e.isCircle?t.isCircle?i.Math.distance(e.center.x,e.center.y,t.center.x,t.center.y)<=e.radius+t.radius:this.circleBodyIntersects(e,t):t.isCircle?this.circleBodyIntersects(t,e):!(e.right<=t.position.x||e.bottom<=t.position.y||e.position.x>=t.right||e.position.y>=t.bottom))},circleBodyIntersects:function(e,t){var s=i.Math.clamp(e.center.x,t.left,t.right),a=i.Math.clamp(e.center.y,t.top,t.bottom);return(e.center.x-s)*(e.center.x-s)+(e.center.y-a)*(e.center.y-a)<=e.radius*e.radius},separateCircle:function(e,t,s){this.getOverlapX(e,t),this.getOverlapY(e,t);var a=t.center.x-e.center.x,n=t.center.y-e.center.y,o=Math.atan2(n,a),r=0;if(e.isCircle!==t.isCircle){var l={x:t.isCircle?e.position.x:t.position.x,y:t.isCircle?e.position.y:t.position.y,right:t.isCircle?e.right:t.right,bottom:t.isCircle?e.bottom:t.bottom},h={x:e.isCircle?e.position.x+e.radius:t.position.x+t.radius,y:e.isCircle?e.position.y+e.radius:t.position.y+t.radius,radius:e.isCircle?e.radius:t.radius};h.y<l.y?h.x<l.x?r=i.Math.distance(h.x,h.y,l.x,l.y)-h.radius:h.x>l.right&&(r=i.Math.distance(h.x,h.y,l.right,l.y)-h.radius):h.y>l.bottom&&(h.x<l.x?r=i.Math.distance(h.x,h.y,l.x,l.bottom)-h.radius:h.x>l.right&&(r=i.Math.distance(h.x,h.y,l.right,l.bottom)-h.radius)),r*=-1}else r=e.radius+t.radius-i.Math.distance(e.center.x,e.center.y,t.center.x,t.center.y);if(s||0===r||e.immovable&&t.immovable||e.customSeparateX||t.customSeparateX)return 0!==r&&(e.onOverlap&&e.onOverlap.dispatch(e.sprite,t.sprite),t.onOverlap&&t.onOverlap.dispatch(t.sprite,e.sprite)),0!==r;var c={x:e.velocity.x*Math.cos(o)+e.velocity.y*Math.sin(o),y:e.velocity.x*Math.sin(o)-e.velocity.y*Math.cos(o)},p={x:t.velocity.x*Math.cos(o)+t.velocity.y*Math.sin(o),y:t.velocity.x*Math.sin(o)-t.velocity.y*Math.cos(o)},d=((e.mass-t.mass)*c.x+2*t.mass*p.x)/(e.mass+t.mass),u=(2*e.mass*c.x+(t.mass-e.mass)*p.x)/(e.mass+t.mass);return e.immovable||(e.velocity.x=(d*Math.cos(o)-c.y*Math.sin(o))*e.bounce.x,e.velocity.y=(c.y*Math.cos(o)+d*Math.sin(o))*e.bounce.y),t.immovable||(t.velocity.x=(u*Math.cos(o)-p.y*Math.sin(o))*t.bounce.x,t.velocity.y=(p.y*Math.cos(o)+u*Math.sin(o))*t.bounce.y),Math.abs(o)<Math.PI/2?e.velocity.x>0&&!e.immovable&&t.velocity.x>e.velocity.x?e.velocity.x*=-1:t.velocity.x<0&&!t.immovable&&e.velocity.x<t.velocity.x?t.velocity.x*=-1:e.velocity.y>0&&!e.immovable&&t.velocity.y>e.velocity.y?e.velocity.y*=-1:t.velocity.y<0&&!t.immovable&&e.velocity.y<t.velocity.y&&(t.velocity.y*=-1):Math.abs(o)>Math.PI/2&&(e.velocity.x<0&&!e.immovable&&t.velocity.x<e.velocity.x?e.velocity.x*=-1:t.velocity.x>0&&!t.immovable&&e.velocity.x>t.velocity.x?t.velocity.x*=-1:e.velocity.y<0&&!e.immovable&&t.velocity.y<e.velocity.y?e.velocity.y*=-1:t.velocity.y>0&&!t.immovable&&e.velocity.x>t.velocity.y&&(t.velocity.y*=-1)),e.immovable||(e.x+=e.velocity.x*this.game.time.physicsElapsed-r*Math.cos(o),e.y+=e.velocity.y*this.game.time.physicsElapsed-r*Math.sin(o)),t.immovable||(t.x+=t.velocity.x*this.game.time.physicsElapsed+r*Math.cos(o),t.y+=t.velocity.y*this.game.time.physicsElapsed+r*Math.sin(o)),e.onCollide&&e.onCollide.dispatch(e.sprite,t.sprite),t.onCollide&&t.onCollide.dispatch(t.sprite,e.sprite),!0},getOverlapX:function(e,t,i){var s=0,a=e.deltaAbsX()+t.deltaAbsX()+this.OVERLAP_BIAS;return 0===e.deltaX()&&0===t.deltaX()?(e.embedded=!0,t.embedded=!0):e.deltaX()>t.deltaX()?(s=e.right-t.x)>a&&!i||!1===e.checkCollision.right||!1===t.checkCollision.left?s=0:(e.touching.none=!1,e.touching.right=!0,t.touching.none=!1,t.touching.left=!0):e.deltaX()<t.deltaX()&&(-(s=e.x-t.width-t.x)>a&&!i||!1===e.checkCollision.left||!1===t.checkCollision.right?s=0:(e.touching.none=!1,e.touching.left=!0,t.touching.none=!1,t.touching.right=!0)),e.overlapX=s,t.overlapX=s,s},getOverlapY:function(e,t,i){var s=0,a=e.deltaAbsY()+t.deltaAbsY()+this.OVERLAP_BIAS;return 0===e.deltaY()&&0===t.deltaY()?(e.embedded=!0,t.embedded=!0):e.deltaY()>t.deltaY()?(s=e.bottom-t.y)>a&&!i||!1===e.checkCollision.down||!1===t.checkCollision.up?s=0:(e.touching.none=!1,e.touching.down=!0,t.touching.none=!1,t.touching.up=!0):e.deltaY()<t.deltaY()&&(-(s=e.y-t.bottom)>a&&!i||!1===e.checkCollision.up||!1===t.checkCollision.down?s=0:(e.touching.none=!1,e.touching.up=!0,t.touching.none=!1,t.touching.down=!0)),e.overlapY=s,t.overlapY=s,s},separateX:function(e,t,i){var s=this.getOverlapX(e,t,i);if(i||0===s||e.immovable&&t.immovable||e.customSeparateX||t.customSeparateX)return 0!==s||e.embedded&&t.embedded;var a=e.velocity.x,n=t.velocity.x;if(e.immovable||t.immovable)e.immovable?(t.x+=s,t.velocity.x=a-n*t.bounce.x,e.moves&&(t.y+=(e.y-e.prev.y)*e.friction.y)):(e.x-=s,e.velocity.x=n-a*e.bounce.x,t.moves&&(e.y+=(t.y-t.prev.y)*t.friction.y));else{s*=.5,e.x-=s,t.x+=s;var o=Math.sqrt(n*n*t.mass/e.mass)*(n>0?1:-1),r=Math.sqrt(a*a*e.mass/t.mass)*(a>0?1:-1),l=.5*(o+r);o-=l,r-=l,e.velocity.x=l+o*e.bounce.x,t.velocity.x=l+r*t.bounce.x}return!0},separateY:function(e,t,i){var s=this.getOverlapY(e,t,i);if(i||0===s||e.immovable&&t.immovable||e.customSeparateY||t.customSeparateY)return 0!==s||e.embedded&&t.embedded;var a=e.velocity.y,n=t.velocity.y;if(e.immovable||t.immovable)e.immovable?(t.y+=s,t.velocity.y=a-n*t.bounce.y,e.moves&&(t.x+=(e.x-e.prev.x)*e.friction.x)):(e.y-=s,e.velocity.y=n-a*e.bounce.y,t.moves&&(e.x+=(t.x-t.prev.x)*t.friction.x));else{s*=.5,e.y-=s,t.y+=s;var o=Math.sqrt(n*n*t.mass/e.mass)*(n>0?1:-1),r=Math.sqrt(a*a*e.mass/t.mass)*(a>0?1:-1),l=.5*(o+r);o-=l,r-=l,e.velocity.y=l+o*e.bounce.y,t.velocity.y=l+r*t.bounce.y}return!0},getObjectsUnderPointer:function(e,t,i,s){if(0!==t.length&&e.exists)return this.getObjectsAtLocation(e.x,e.y,t,i,s,e)},getObjectsAtLocation:function(e,t,s,a,n,o){this.quadTree.clear(),this.quadTree.reset(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,this.maxObjects,this.maxLevels),this.quadTree.populate(s);for(var r=new i.Rectangle(e,t,1,1),l=[],h=this.quadTree.retrieve(r),c=0;c<h.length;c++)h[c].hitTest(e,t)&&(a&&a.call(n,o,h[c].sprite),l.push(h[c].sprite));return l},moveToObject:function(e,t,i,s){void 0===i&&(i=60),void 0===s&&(s=0);var a=Math.atan2(t.y-e.y,t.x-e.x);return s>0&&(i=this.distanceBetween(e,t)/(s/1e3)),e.body.velocity.x=Math.cos(a)*i,e.body.velocity.y=Math.sin(a)*i,a},moveToPointer:function(e,t,i,s){void 0===t&&(t=60),i=i||this.game.input.activePointer,void 0===s&&(s=0);var a=this.angleToPointer(e,i);return s>0&&(t=this.distanceToPointer(e,i)/(s/1e3)),e.body.velocity.x=Math.cos(a)*t,e.body.velocity.y=Math.sin(a)*t,a},moveToXY:function(e,t,i,s,a){void 0===s&&(s=60),void 0===a&&(a=0);var n=Math.atan2(i-e.y,t-e.x);return a>0&&(s=this.distanceToXY(e,t,i)/(a/1e3)),e.body.velocity.x=Math.cos(n)*s,e.body.velocity.y=Math.sin(n)*s,n},velocityFromAngle:function(e,t,s){return void 0===t&&(t=60),(s=s||new i.Point).setTo(Math.cos(this.game.math.degToRad(e))*t,Math.sin(this.game.math.degToRad(e))*t)},velocityFromRotation:function(e,t,s){return void 0===t&&(t=60),(s=s||new i.Point).setTo(Math.cos(e)*t,Math.sin(e)*t)},accelerationFromRotation:function(e,t,s){return void 0===t&&(t=60),(s=s||new i.Point).setTo(Math.cos(e)*t,Math.sin(e)*t)},accelerateToObject:function(e,t,i,s,a){void 0===i&&(i=60),void 0===s&&(s=1e3),void 0===a&&(a=1e3);var n=this.angleBetween(e,t);return e.body.acceleration.setTo(Math.cos(n)*i,Math.sin(n)*i),e.body.maxVelocity.setTo(s,a),n},accelerateToPointer:function(e,t,i,s,a){void 0===i&&(i=60),void 0===t&&(t=this.game.input.activePointer),void 0===s&&(s=1e3),void 0===a&&(a=1e3);var n=this.angleToPointer(e,t);return e.body.acceleration.setTo(Math.cos(n)*i,Math.sin(n)*i),e.body.maxVelocity.setTo(s,a),n},accelerateToXY:function(e,t,i,s,a,n){void 0===s&&(s=60),void 0===a&&(a=1e3),void 0===n&&(n=1e3);var o=this.angleToXY(e,t,i);return e.body.acceleration.setTo(Math.cos(o)*s,Math.sin(o)*s),e.body.maxVelocity.setTo(a,n),o},distanceBetween:function(e,t,i){void 0===i&&(i=!1);var s=i?e.world.x-t.world.x:e.x-t.x,a=i?e.world.y-t.world.y:e.y-t.y;return Math.sqrt(s*s+a*a)},distanceToXY:function(e,t,i,s){void 0===s&&(s=!1);var a=s?e.world.x-t:e.x-t,n=s?e.world.y-i:e.y-i;return Math.sqrt(a*a+n*n)},distanceToPointer:function(e,t,i){void 0===t&&(t=this.game.input.activePointer),void 0===i&&(i=!1);var s=i?e.world.x-t.worldX:e.x-t.worldX,a=i?e.world.y-t.worldY:e.y-t.worldY;return Math.sqrt(s*s+a*a)},angleBetween:function(e,t,i){return void 0===i&&(i=!1),i?Math.atan2(t.world.y-e.world.y,t.world.x-e.world.x):Math.atan2(t.y-e.y,t.x-e.x)},angleBetweenCenters:function(e,t){var i=t.centerX-e.centerX,s=t.centerY-e.centerY;return Math.atan2(s,i)},angleToXY:function(e,t,i,s){return void 0===s&&(s=!1),s?Math.atan2(i-e.world.y,t-e.world.x):Math.atan2(i-e.y,t-e.x)},angleToPointer:function(e,t,i){return void 0===t&&(t=this.game.input.activePointer),void 0===i&&(i=!1),i?Math.atan2(t.worldY-e.world.y,t.worldX-e.world.x):Math.atan2(t.worldY-e.y,t.worldX-e.x)},worldAngleToPointer:function(e,t){return this.angleToPointer(e,t,!0)}},i.Physics.Arcade.Body=function(e){this.sprite=e,this.game=e.game,this.type=i.Physics.ARCADE,this.enable=!0,this.isCircle=!1,this.radius=0,this.offset=new i.Point,this.position=new i.Point(e.x,e.y),this.prev=new i.Point(this.position.x,this.position.y),this.allowRotation=!0,this.rotation=e.angle,this.preRotation=e.angle,this.width=e.width,this.height=e.height,this.sourceWidth=e.width,this.sourceHeight=e.height,e.texture&&(this.sourceWidth=e.texture.frame.width,this.sourceHeight=e.texture.frame.height),this.halfWidth=Math.abs(e.width/2),this.halfHeight=Math.abs(e.height/2),this.center=new i.Point(e.x+this.halfWidth,e.y+this.halfHeight),this.velocity=new i.Point,this.newVelocity=new i.Point,this.deltaMax=new i.Point,this.acceleration=new i.Point,this.drag=new i.Point,this.allowGravity=!0,this.gravity=new i.Point,this.bounce=new i.Point,this.worldBounce=null,this.onWorldBounds=null,this.onCollide=null,this.onOverlap=null,this.maxVelocity=new i.Point(1e4,1e4),this.friction=new i.Point(1,0),this.angularVelocity=0,this.angularAcceleration=0,this.angularDrag=0,this.maxAngular=1e3,this.mass=1,this.angle=0,this.speed=0,this.facing=i.NONE,this.immovable=!1,this.moves=!0,this.customSeparateX=!1,this.customSeparateY=!1,this.overlapX=0,this.overlapY=0,this.overlapR=0,this.embedded=!1,this.collideWorldBounds=!1,this.checkCollision={none:!1,any:!0,up:!0,down:!0,left:!0,right:!0},this.touching={none:!0,up:!1,down:!1,left:!1,right:!1},this.wasTouching={none:!0,up:!1,down:!1,left:!1,right:!1},this.blocked={up:!1,down:!1,left:!1,right:!1},this.tilePadding=new i.Point,this.dirty=!1,this.skipQuadTree=!1,this.syncBounds=!1,this.isMoving=!1,this.stopVelocityOnCollide=!0,this.moveTimer=0,this.moveDistance=0,this.moveDuration=0,this.moveTarget=null,this.moveEnd=null,this.onMoveComplete=new i.Signal,this.movementCallback=null,this.movementCallbackContext=null,this._reset=!0,this._sx=e.scale.x,this._sy=e.scale.y,this._dx=0,this._dy=0},i.Physics.Arcade.Body.prototype={updateBounds:function(){if(this.syncBounds){var e=this.sprite.getBounds();e.ceilAll(),e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._reset=!0)}else{var t=Math.abs(this.sprite.scale.x),i=Math.abs(this.sprite.scale.y);t===this._sx&&i===this._sy||(this.width=this.sourceWidth*t,this.height=this.sourceHeight*i,this._sx=t,this._sy=i,this._reset=!0)}this._reset&&(this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight))},preUpdate:function(){this.enable&&!this.game.physics.arcade.isPaused&&(this.dirty=!0,this.wasTouching.none=this.touching.none,this.wasTouching.up=this.touching.up,this.wasTouching.down=this.touching.down,this.wasTouching.left=this.touching.left,this.wasTouching.right=this.touching.right,this.touching.none=!0,this.touching.up=!1,this.touching.down=!1,this.touching.left=!1,this.touching.right=!1,this.blocked.up=!1,this.blocked.down=!1,this.blocked.left=!1,this.blocked.right=!1,this.embedded=!1,this.updateBounds(),this.position.x=this.sprite.world.x-this.sprite.anchor.x*this.sprite.width+this.sprite.scale.x*this.offset.x,this.position.x-=this.sprite.scale.x<0?this.width:0,this.position.y=this.sprite.world.y-this.sprite.anchor.y*this.sprite.height+this.sprite.scale.y*this.offset.y,this.position.y-=this.sprite.scale.y<0?this.height:0,this.rotation=this.sprite.angle,this.preRotation=this.rotation,(this._reset||this.sprite.fresh)&&(this.prev.x=this.position.x,this.prev.y=this.position.y),this.moves&&(this.game.physics.arcade.updateMotion(this),this.newVelocity.set(this.velocity.x*this.game.time.physicsElapsed,this.velocity.y*this.game.time.physicsElapsed),this.position.x+=this.newVelocity.x,this.position.y+=this.newVelocity.y,this.position.x===this.prev.x&&this.position.y===this.prev.y||(this.angle=Math.atan2(this.velocity.y,this.velocity.x)),this.speed=Math.sqrt(this.velocity.x*this.velocity.x+this.velocity.y*this.velocity.y),this.collideWorldBounds&&this.checkWorldBounds()&&this.onWorldBounds&&this.onWorldBounds.dispatch(this.sprite,this.blocked.up,this.blocked.down,this.blocked.left,this.blocked.right)),this._dx=this.deltaX(),this._dy=this.deltaY(),this._reset=!1)},updateMovement:function(){var e=0,t=0!==this.overlapX||0!==this.overlapY;if(this.moveDuration>0?(this.moveTimer+=this.game.time.elapsedMS,e=this.moveTimer/this.moveDuration):(this.moveTarget.end.set(this.position.x,this.position.y),e=this.moveTarget.length/this.moveDistance),this.movementCallback)var i=this.movementCallback.call(this.movementCallbackContext,this,this.velocity,e);return!(t||e>=1||void 0!==i&&!0!==i)||(this.stopMovement(e>=1||this.stopVelocityOnCollide&&t),!1)},stopMovement:function(e){this.isMoving&&(this.isMoving=!1,e&&this.velocity.set(0),this.onMoveComplete.dispatch(this.sprite,0!==this.overlapX||0!==this.overlapY))},postUpdate:function(){this.enable&&this.dirty&&(this.isMoving&&this.updateMovement(),this.dirty=!1,this.deltaX()<0?this.facing=i.LEFT:this.deltaX()>0&&(this.facing=i.RIGHT),this.deltaY()<0?this.facing=i.UP:this.deltaY()>0&&(this.facing=i.DOWN),this.moves&&(this._dx=this.deltaX(),this._dy=this.deltaY(),0!==this.deltaMax.x&&0!==this._dx&&(this._dx<0&&this._dx<-this.deltaMax.x?this._dx=-this.deltaMax.x:this._dx>0&&this._dx>this.deltaMax.x&&(this._dx=this.deltaMax.x)),0!==this.deltaMax.y&&0!==this._dy&&(this._dy<0&&this._dy<-this.deltaMax.y?this._dy=-this.deltaMax.y:this._dy>0&&this._dy>this.deltaMax.y&&(this._dy=this.deltaMax.y)),this.sprite.position.x+=this._dx,this.sprite.position.y+=this._dy,this._reset=!0),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.allowRotation&&(this.sprite.angle+=this.deltaZ()),this.prev.x=this.position.x,this.prev.y=this.position.y)},checkWorldBounds:function(){var e=this.position,t=this.game.physics.arcade.bounds,i=this.game.physics.arcade.checkCollision,s=this.worldBounce?-this.worldBounce.x:-this.bounce.x,a=this.worldBounce?-this.worldBounce.y:-this.bounce.y;if(this.isCircle){var n={x:this.center.x-this.radius,y:this.center.y-this.radius,right:this.center.x+this.radius,bottom:this.center.y+this.radius};n.x<t.x&&i.left?(e.x=t.x-this.halfWidth+this.radius,this.velocity.x*=s,this.blocked.left=!0):n.right>t.right&&i.right&&(e.x=t.right-this.halfWidth-this.radius,this.velocity.x*=s,this.blocked.right=!0),n.y<t.y&&i.up?(e.y=t.y-this.halfHeight+this.radius,this.velocity.y*=a,this.blocked.up=!0):n.bottom>t.bottom&&i.down&&(e.y=t.bottom-this.halfHeight-this.radius,this.velocity.y*=a,this.blocked.down=!0)}else e.x<t.x&&i.left?(e.x=t.x,this.velocity.x*=s,this.blocked.left=!0):this.right>t.right&&i.right&&(e.x=t.right-this.width,this.velocity.x*=s,this.blocked.right=!0),e.y<t.y&&i.up?(e.y=t.y,this.velocity.y*=a,this.blocked.up=!0):this.bottom>t.bottom&&i.down&&(e.y=t.bottom-this.height,this.velocity.y*=a,this.blocked.down=!0);return this.blocked.up||this.blocked.down||this.blocked.left||this.blocked.right},moveFrom:function(e,t,i){if(void 0===t&&(t=this.speed),0===t)return!1;var s;return void 0===i?(s=this.angle,i=this.game.math.radToDeg(s)):s=this.game.math.degToRad(i),this.moveTimer=0,this.moveDuration=e,0===i||180===i?this.velocity.set(Math.cos(s)*t,0):90===i||270===i?this.velocity.set(0,Math.sin(s)*t):this.velocity.set(Math.cos(s)*t,Math.sin(s)*t),this.isMoving=!0,!0},moveTo:function(e,t,s){var a=t/(e/1e3);if(0===a)return!1;var n;return void 0===s?(n=this.angle,s=this.game.math.radToDeg(n)):n=this.game.math.degToRad(s),t=Math.abs(t),this.moveDuration=0,this.moveDistance=t,null===this.moveTarget&&(this.moveTarget=new i.Line,this.moveEnd=new i.Point),this.moveTarget.fromAngle(this.x,this.y,n,t),this.moveEnd.set(this.moveTarget.end.x,this.moveTarget.end.y),this.moveTarget.setTo(this.x,this.y,this.x,this.y),0===s||180===s?this.velocity.set(Math.cos(n)*a,0):90===s||270===s?this.velocity.set(0,Math.sin(n)*a):this.velocity.set(Math.cos(n)*a,Math.sin(n)*a),this.isMoving=!0,!0},setSize:function(e,t,i,s){void 0===i&&(i=this.offset.x),void 0===s&&(s=this.offset.y),this.sourceWidth=e,this.sourceHeight=t,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.setTo(i,s),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight),this.isCircle=!1,this.radius=0},setCircle:function(e,t,i){void 0===t&&(t=this.offset.x),void 0===i&&(i=this.offset.y),e>0?(this.isCircle=!0,this.radius=e,this.sourceWidth=2*e,this.sourceHeight=2*e,this.width=this.sourceWidth*this._sx,this.height=this.sourceHeight*this._sy,this.halfWidth=Math.floor(this.width/2),this.halfHeight=Math.floor(this.height/2),this.offset.setTo(t,i),this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)):this.isCircle=!1},reset:function(e,t){this.velocity.set(0),this.acceleration.set(0),this.speed=0,this.angularVelocity=0,this.angularAcceleration=0,this.position.x=e-this.sprite.anchor.x*this.sprite.width+this.sprite.scale.x*this.offset.x,this.position.x-=this.sprite.scale.x<0?this.width:0,this.position.y=t-this.sprite.anchor.y*this.sprite.height+this.sprite.scale.y*this.offset.y,this.position.y-=this.sprite.scale.y<0?this.height:0,this.prev.x=this.position.x,this.prev.y=this.position.y,this.rotation=this.sprite.angle,this.preRotation=this.rotation,this._sx=this.sprite.scale.x,this._sy=this.sprite.scale.y,this.center.setTo(this.position.x+this.halfWidth,this.position.y+this.halfHeight)},getBounds:function(e){return this.isCircle?(e.x=this.center.x-this.radius,e.y=this.center.y-this.radius,e.right=this.center.x+this.radius,e.bottom=this.center.y+this.radius):(e.x=this.x,e.y=this.y,e.right=this.right,e.bottom=this.bottom),e},hitTest:function(e,t){return this.isCircle?i.Circle.contains(this,e,t):i.Rectangle.contains(this,e,t)},onFloor:function(){return this.blocked.down},onCeiling:function(){return this.blocked.up},onWall:function(){return this.blocked.left||this.blocked.right},deltaAbsX:function(){return this.deltaX()>0?this.deltaX():-this.deltaX()},deltaAbsY:function(){return this.deltaY()>0?this.deltaY():-this.deltaY()},deltaX:function(){return this.position.x-this.prev.x},deltaY:function(){return this.position.y-this.prev.y},deltaZ:function(){return this.rotation-this.preRotation},destroy:function(){this.sprite.parent&&this.sprite.parent instanceof i.Group&&this.sprite.parent.removeFromHash(this.sprite),this.sprite.body=null,this.sprite=null}},Object.defineProperty(i.Physics.Arcade.Body.prototype,"left",{get:function(){return this.position.x}}),Object.defineProperty(i.Physics.Arcade.Body.prototype,"right",{get:function(){return this.position.x+this.width}}),Object.defineProperty(i.Physics.Arcade.Body.prototype,"top",{get:function(){return this.position.y}}),Object.defineProperty(i.Physics.Arcade.Body.prototype,"bottom",{get:function(){return this.position.y+this.height}}),Object.defineProperty(i.Physics.Arcade.Body.prototype,"x",{get:function(){return this.position.x},set:function(e){this.position.x=e}}),Object.defineProperty(i.Physics.Arcade.Body.prototype,"y",{get:function(){return this.position.y},set:function(e){this.position.y=e}}),i.Physics.Arcade.Body.render=function(e,t,i,s){void 0===s&&(s=!0),i=i||"rgba(0,255,0,0.4)",e.fillStyle=i,e.strokeStyle=i,t.isCircle?(e.beginPath(),e.arc(t.center.x-t.game.camera.x,t.center.y-t.game.camera.y,t.radius,0,2*Math.PI),s?e.fill():e.stroke()):s?e.fillRect(t.position.x-t.game.camera.x,t.position.y-t.game.camera.y,t.width,t.height):e.strokeRect(t.position.x-t.game.camera.x,t.position.y-t.game.camera.y,t.width,t.height)},i.Physics.Arcade.Body.renderBodyInfo=function(e,t){e.line("x: "+t.x.toFixed(2),"y: "+t.y.toFixed(2),"width: "+t.width,"height: "+t.height),e.line("velocity x: "+t.velocity.x.toFixed(2),"y: "+t.velocity.y.toFixed(2),"deltaX: "+t._dx.toFixed(2),"deltaY: "+t._dy.toFixed(2)),e.line("acceleration x: "+t.acceleration.x.toFixed(2),"y: "+t.acceleration.y.toFixed(2),"speed: "+t.speed.toFixed(2),"angle: "+t.angle.toFixed(2)),e.line("gravity x: "+t.gravity.x,"y: "+t.gravity.y,"bounce x: "+t.bounce.x.toFixed(2),"y: "+t.bounce.y.toFixed(2)),e.line("touching left: "+t.touching.left,"right: "+t.touching.right,"up: "+t.touching.up,"down: "+t.touching.down),e.line("blocked left: "+t.blocked.left,"right: "+t.blocked.right,"up: "+t.blocked.up,"down: "+t.blocked.down)},i.Physics.Arcade.Body.prototype.constructor=i.Physics.Arcade.Body,i.Physics.Arcade.TilemapCollision=function(){},i.Physics.Arcade.TilemapCollision.prototype={TILE_BIAS:16,collideSpriteVsTilemapLayer:function(e,t,i,s,a,n){if(e.body){var o=t.getTiles(e.body.position.x-e.body.tilePadding.x,e.body.position.y-e.body.tilePadding.y,e.body.width+e.body.tilePadding.x,e.body.height+e.body.tilePadding.y,!1,!1);if(0!==o.length)for(var r=0;r<o.length;r++)s?s.call(a,e,o[r])&&this.separateTile(r,e.body,o[r],t,n)&&(this._total++,i&&i.call(a,e,o[r])):this.separateTile(r,e.body,o[r],t,n)&&(this._total++,i&&i.call(a,e,o[r]))}},collideGroupVsTilemapLayer:function(e,t,i,s,a,n){if(0!==e.length)for(var o=0;o<e.children.length;o++)e.children[o].exists&&this.collideSpriteVsTilemapLayer(e.children[o],t,i,s,a,n)},separateTile:function(e,t,i,s,a){if(!t.enable)return!1;var n=s.fixedToCamera?0:s.position.x,o=s.fixedToCamera?0:s.position.y;if(!i.intersects(t.position.x-n,t.position.y-o,t.right-n,t.bottom-o))return!1;if(a)return!0;if(i.collisionCallback&&!i.collisionCallback.call(i.collisionCallbackContext,t.sprite,i))return!1;if(void 0!==i.layer.callbacks&&i.layer.callbacks[i.index]&&!i.layer.callbacks[i.index].callback.call(i.layer.callbacks[i.index].callbackContext,t.sprite,i))return!1;if(!(i.faceLeft||i.faceRight||i.faceTop||i.faceBottom))return!1;var r=0,l=0,h=0,c=1;if(t.deltaAbsX()>t.deltaAbsY()?h=-1:t.deltaAbsX()<t.deltaAbsY()&&(c=-1),0!==t.deltaX()&&0!==t.deltaY()&&(i.faceLeft||i.faceRight)&&(i.faceTop||i.faceBottom)&&(h=Math.min(Math.abs(t.position.x-n-i.right),Math.abs(t.right-n-i.left)),c=Math.min(Math.abs(t.position.y-o-i.bottom),Math.abs(t.bottom-o-i.top))),h<c){if((i.faceLeft||i.faceRight)&&0!==(r=this.tileCheckX(t,i,s))&&!i.intersects(t.position.x-n,t.position.y-o,t.right-n,t.bottom-o))return!0;(i.faceTop||i.faceBottom)&&(l=this.tileCheckY(t,i,s))}else{if((i.faceTop||i.faceBottom)&&0!==(l=this.tileCheckY(t,i,s))&&!i.intersects(t.position.x-n,t.position.y-o,t.right-n,t.bottom-o))return!0;(i.faceLeft||i.faceRight)&&(r=this.tileCheckX(t,i,s))}return 0!==r||0!==l},tileCheckX:function(e,t,i){var s=0,a=i.fixedToCamera?0:i.position.x;return e.deltaX()<0&&!e.blocked.left&&t.collideRight&&e.checkCollision.left?t.faceRight&&e.x-a<t.right&&(s=e.x-a-t.right)<-this.TILE_BIAS&&(s=0):e.deltaX()>0&&!e.blocked.right&&t.collideLeft&&e.checkCollision.right&&t.faceLeft&&e.right-a>t.left&&(s=e.right-a-t.left)>this.TILE_BIAS&&(s=0),0!==s&&(e.customSeparateX?e.overlapX=s:this.processTileSeparationX(e,s)),s},tileCheckY:function(e,t,i){var s=0,a=i.fixedToCamera?0:i.position.y;return e.deltaY()<0&&!e.blocked.up&&t.collideDown&&e.checkCollision.up?t.faceBottom&&e.y-a<t.bottom&&(s=e.y-a-t.bottom)<-this.TILE_BIAS&&(s=0):e.deltaY()>0&&!e.blocked.down&&t.collideUp&&e.checkCollision.down&&t.faceTop&&e.bottom-a>t.top&&(s=e.bottom-a-t.top)>this.TILE_BIAS&&(s=0),0!==s&&(e.customSeparateY?e.overlapY=s:this.processTileSeparationY(e,s)),s},processTileSeparationX:function(e,t){t<0?e.blocked.left=!0:t>0&&(e.blocked.right=!0),e.position.x-=t,0===e.bounce.x?e.velocity.x=0:e.velocity.x=-e.velocity.x*e.bounce.x},processTileSeparationY:function(e,t){t<0?e.blocked.up=!0:t>0&&(e.blocked.down=!0),e.position.y-=t,0===e.bounce.y?e.velocity.y=0:e.velocity.y=-e.velocity.y*e.bounce.y}},i.Utils.mixinPrototype(i.Physics.Arcade.prototype,i.Physics.Arcade.TilemapCollision.prototype),p2.Body.prototype.parent=null,p2.Spring.prototype.parent=null,i.Physics.P2=function(e,t){this.game=e,void 0===t?t={gravity:[0,0],broadphase:new p2.SAPBroadphase}:(t.hasOwnProperty("gravity")||(t.gravity=[0,0]),t.hasOwnProperty("broadphase")||(t.broadphase=new p2.SAPBroadphase)),this.config=t,this.world=new p2.World(this.config),this.frameRate=1/60,this.useElapsedTime=!1,this.paused=!1,this.materials=[],this.gravity=new i.Physics.P2.InversePointProxy(this,this.world.gravity),this.walls={left:null,right:null,top:null,bottom:null},this.onBodyAdded=new i.Signal,this.onBodyRemoved=new i.Signal,this.onSpringAdded=new i.Signal,this.onSpringRemoved=new i.Signal,this.onConstraintAdded=new i.Signal,this.onConstraintRemoved=new i.Signal,this.onContactMaterialAdded=new i.Signal,this.onContactMaterialRemoved=new i.Signal,this.postBroadphaseCallback=null,this.callbackContext=null,this.onBeginContact=new i.Signal,this.onEndContact=new i.Signal,t.hasOwnProperty("mpx")&&t.hasOwnProperty("pxm")&&t.hasOwnProperty("mpxi")&&t.hasOwnProperty("pxmi")&&(this.mpx=t.mpx,this.mpxi=t.mpxi,this.pxm=t.pxm,this.pxmi=t.pxmi),this.world.on("beginContact",this.beginContactHandler,this),this.world.on("endContact",this.endContactHandler,this),this.collisionGroups=[],this.nothingCollisionGroup=new i.Physics.P2.CollisionGroup(1),this.boundsCollisionGroup=new i.Physics.P2.CollisionGroup(2),this.everythingCollisionGroup=new i.Physics.P2.CollisionGroup(2147483648),this.boundsCollidesWith=[],this._toRemove=[],this._collisionGroupID=2,this._boundsLeft=!0,this._boundsRight=!0,this._boundsTop=!0,this._boundsBottom=!0,this._boundsOwnGroup=!1,this.setBoundsToWorld(!0,!0,!0,!0,!1)},i.Physics.P2.prototype={removeBodyNextStep:function(e){this._toRemove.push(e)},preUpdate:function(){for(var e=this._toRemove.length;e--;)this.removeBody(this._toRemove[e]);this._toRemove.length=0},enable:function(e,t,s){void 0===t&&(t=!1),void 0===s&&(s=!0);var a=1;if(Array.isArray(e))for(a=e.length;a--;)e[a]instanceof i.Group?this.enable(e[a].children,t,s):(this.enableBody(e[a],t),s&&e[a].hasOwnProperty("children")&&e[a].children.length>0&&this.enable(e[a],t,!0));else e instanceof i.Group?this.enable(e.children,t,s):(this.enableBody(e,t),s&&e.hasOwnProperty("children")&&e.children.length>0&&this.enable(e.children,t,!0))},enableBody:function(e,t){e.hasOwnProperty("body")&&null===e.body&&(e.body=new i.Physics.P2.Body(this.game,e,e.x,e.y,1),e.body.debug=t,void 0!==e.anchor&&e.anchor.set(.5))},setImpactEvents:function(e){e?this.world.on("impact",this.impactHandler,this):this.world.off("impact",this.impactHandler,this)},setPostBroadphaseCallback:function(e,t){this.postBroadphaseCallback=e,this.callbackContext=t,null!==e?this.world.on("postBroadphase",this.postBroadphaseHandler,this):this.world.off("postBroadphase",this.postBroadphaseHandler,this)},postBroadphaseHandler:function(e){if(this.postBroadphaseCallback&&0!==e.pairs.length)for(var t=e.pairs.length-2;t>=0;t-=2)e.pairs[t].parent&&e.pairs[t+1].parent&&!this.postBroadphaseCallback.call(this.callbackContext,e.pairs[t].parent,e.pairs[t+1].parent)&&e.pairs.splice(t,2)},impactHandler:function(e){if(e.bodyA.parent&&e.bodyB.parent){var t=e.bodyA.parent,i=e.bodyB.parent;t._bodyCallbacks[e.bodyB.id]&&t._bodyCallbacks[e.bodyB.id].call(t._bodyCallbackContext[e.bodyB.id],t,i,e.shapeA,e.shapeB),i._bodyCallbacks[e.bodyA.id]&&i._bodyCallbacks[e.bodyA.id].call(i._bodyCallbackContext[e.bodyA.id],i,t,e.shapeB,e.shapeA),t._groupCallbacks[e.shapeB.collisionGroup]&&t._groupCallbacks[e.shapeB.collisionGroup].call(t._groupCallbackContext[e.shapeB.collisionGroup],t,i,e.shapeA,e.shapeB),i._groupCallbacks[e.shapeA.collisionGroup]&&i._groupCallbacks[e.shapeA.collisionGroup].call(i._groupCallbackContext[e.shapeA.collisionGroup],i,t,e.shapeB,e.shapeA)}},beginContactHandler:function(e){e.bodyA&&e.bodyB&&(this.onBeginContact.dispatch(e.bodyA,e.bodyB,e.shapeA,e.shapeB,e.contactEquations),e.bodyA.parent&&e.bodyA.parent.onBeginContact.dispatch(e.bodyB.parent,e.bodyB,e.shapeA,e.shapeB,e.contactEquations),e.bodyB.parent&&e.bodyB.parent.onBeginContact.dispatch(e.bodyA.parent,e.bodyA,e.shapeB,e.shapeA,e.contactEquations))},endContactHandler:function(e){e.bodyA&&e.bodyB&&(this.onEndContact.dispatch(e.bodyA,e.bodyB,e.shapeA,e.shapeB),e.bodyA.parent&&e.bodyA.parent.onEndContact.dispatch(e.bodyB.parent,e.bodyB,e.shapeA,e.shapeB),e.bodyB.parent&&e.bodyB.parent.onEndContact.dispatch(e.bodyA.parent,e.bodyA,e.shapeB,e.shapeA))},setBoundsToWorld:function(e,t,i,s,a){this.setBounds(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,e,t,i,s,a)},setWorldMaterial:function(e,t,i,s,a){void 0===t&&(t=!0),void 0===i&&(i=!0),void 0===s&&(s=!0),void 0===a&&(a=!0),t&&this.walls.left&&(this.walls.left.shapes[0].material=e),i&&this.walls.right&&(this.walls.right.shapes[0].material=e),s&&this.walls.top&&(this.walls.top.shapes[0].material=e),a&&this.walls.bottom&&(this.walls.bottom.shapes[0].material=e)},updateBoundsCollisionGroup:function(e){void 0===e&&(e=!0);var t=e?this.boundsCollisionGroup.mask:this.everythingCollisionGroup.mask;this.walls.left&&(this.walls.left.shapes[0].collisionGroup=t),this.walls.right&&(this.walls.right.shapes[0].collisionGroup=t),this.walls.top&&(this.walls.top.shapes[0].collisionGroup=t),this.walls.bottom&&(this.walls.bottom.shapes[0].collisionGroup=t),this._boundsOwnGroup=e},setBounds:function(e,t,i,s,a,n,o,r,l){void 0===a&&(a=this._boundsLeft),void 0===n&&(n=this._boundsRight),void 0===o&&(o=this._boundsTop),void 0===r&&(r=this._boundsBottom),void 0===l&&(l=this._boundsOwnGroup),this.setupWall(a,"left",e,t,1.5707963267948966,l),this.setupWall(n,"right",e+i,t,-1.5707963267948966,l),this.setupWall(o,"top",e,t,-3.141592653589793,l),this.setupWall(r,"bottom",e,t+s,0,l),this._boundsLeft=a,this._boundsRight=n,this._boundsTop=o,this._boundsBottom=r,this._boundsOwnGroup=l},setupWall:function(e,t,i,s,a,n){e?(this.walls[t]?this.walls[t].position=[this.pxmi(i),this.pxmi(s)]:(this.walls[t]=new p2.Body({mass:0,position:[this.pxmi(i),this.pxmi(s)],angle:a}),this.walls[t].addShape(new p2.Plane),this.world.addBody(this.walls[t])),n&&(this.walls[t].shapes[0].collisionGroup=this.boundsCollisionGroup.mask)):this.walls[t]&&(this.world.removeBody(this.walls[t]),this.walls[t]=null)},pause:function(){this.paused=!0},resume:function(){this.paused=!1},update:function(){this.paused||(this.useElapsedTime?this.world.step(this.game.time.physicsElapsed):this.world.step(this.frameRate))},reset:function(){this.world.on("beginContact",this.beginContactHandler,this),this.world.on("endContact",this.endContactHandler,this),this.nothingCollisionGroup=new i.Physics.P2.CollisionGroup(1),this.boundsCollisionGroup=new i.Physics.P2.CollisionGroup(2),this.everythingCollisionGroup=new i.Physics.P2.CollisionGroup(2147483648),this._collisionGroupID=2,this.setBoundsToWorld(!0,!0,!0,!0,!1)},clear:function(){this.world.time=0,this.world.fixedStepTime=0,this.world.solver&&this.world.solver.equations.length&&this.world.solver.removeAllEquations();for(var e=this.world.constraints,t=e.length-1;t>=0;t--)this.world.removeConstraint(e[t]);for(var i=this.world.bodies,t=i.length-1;t>=0;t--)this.world.removeBody(i[t]);for(var s=this.world.springs,t=s.length-1;t>=0;t--)this.world.removeSpring(s[t]);for(var a=this.world.contactMaterials,t=a.length-1;t>=0;t--)this.world.removeContactMaterial(a[t]);this.world.off("beginContact",this.beginContactHandler,this),this.world.off("endContact",this.endContactHandler,this),this.postBroadphaseCallback=null,this.callbackContext=null,this.impactCallback=null,this.collisionGroups=[],this._toRemove=[],this.boundsCollidesWith=[],this.walls={left:null,right:null,top:null,bottom:null}},destroy:function(){this.clear(),this.game=null},addBody:function(e){return!e.data.world&&(this.world.addBody(e.data),this.onBodyAdded.dispatch(e),!0)},removeBody:function(e){return e.data.world===this.world&&(this.world.removeBody(e.data),this.onBodyRemoved.dispatch(e)),e},addSpring:function(e){return e instanceof i.Physics.P2.Spring||e instanceof i.Physics.P2.RotationalSpring?this.world.addSpring(e.data):this.world.addSpring(e),this.onSpringAdded.dispatch(e),e},removeSpring:function(e){return e instanceof i.Physics.P2.Spring||e instanceof i.Physics.P2.RotationalSpring?this.world.removeSpring(e.data):this.world.removeSpring(e),this.onSpringRemoved.dispatch(e),e},createDistanceConstraint:function(e,t,s,a,n,o){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addConstraint(new i.Physics.P2.DistanceConstraint(this,e,t,s,a,n,o)):void 0},createGearConstraint:function(e,t,s,a){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addConstraint(new i.Physics.P2.GearConstraint(this,e,t,s,a)):void 0},createRevoluteConstraint:function(e,t,s,a,n,o){return e=this.getBody(e),s=this.getBody(s),e&&s?this.addConstraint(new i.Physics.P2.RevoluteConstraint(this,e,t,s,a,n,o)):void 0},createLockConstraint:function(e,t,s,a,n){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addConstraint(new i.Physics.P2.LockConstraint(this,e,t,s,a,n)):void 0},createPrismaticConstraint:function(e,t,s,a,n,o,r){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addConstraint(new i.Physics.P2.PrismaticConstraint(this,e,t,s,a,n,o,r)):void 0},addConstraint:function(e){return this.world.addConstraint(e),this.onConstraintAdded.dispatch(e),e},removeConstraint:function(e){return this.world.removeConstraint(e),this.onConstraintRemoved.dispatch(e),e},addContactMaterial:function(e){return this.world.addContactMaterial(e),this.onContactMaterialAdded.dispatch(e),e},removeContactMaterial:function(e){return this.world.removeContactMaterial(e),this.onContactMaterialRemoved.dispatch(e),e},getContactMaterial:function(e,t){return this.world.getContactMaterial(e,t)},setMaterial:function(e,t){for(var i=t.length;i--;)t[i].setMaterial(e)},createMaterial:function(e,t){e=e||"";var s=new i.Physics.P2.Material(e);return this.materials.push(s),void 0!==t&&t.setMaterial(s),s},createContactMaterial:function(e,t,s){void 0===e&&(e=this.createMaterial()),void 0===t&&(t=this.createMaterial());var a=new i.Physics.P2.ContactMaterial(e,t,s);return this.addContactMaterial(a)},getBodies:function(){for(var e=[],t=this.world.bodies.length;t--;)e.push(this.world.bodies[t].parent);return e},getBody:function(e){return e instanceof p2.Body?e:e instanceof i.Physics.P2.Body?e.data:e.body&&e.body.type===i.Physics.P2JS?e.body.data:null},getSprings:function(){for(var e=[],t=this.world.springs.length;t--;)e.push(this.world.springs[t].parent);return e},getConstraints:function(){for(var e=[],t=this.world.constraints.length;t--;)e.push(this.world.constraints[t]);return e},hitTest:function(e,t,s,a){void 0===t&&(t=this.world.bodies),void 0===s&&(s=5),void 0===a&&(a=!1);for(var n=[this.pxmi(e.x),this.pxmi(e.y)],o=[],r=t.length;r--;)t[r]instanceof i.Physics.P2.Body&&(!a||t[r].data.type!==p2.Body.STATIC)?o.push(t[r].data):t[r]instanceof p2.Body&&t[r].parent&&(!a||t[r].type!==p2.Body.STATIC)?o.push(t[r]):t[r]instanceof i.Sprite&&t[r].hasOwnProperty("body")&&(!a||t[r].body.data.type!==p2.Body.STATIC)&&o.push(t[r].body.data);return this.world.hitTest(n,o,s)},toJSON:function(){return this.world.toJSON()},createCollisionGroup:function(e){var t=Math.pow(2,this._collisionGroupID);this.walls.left&&(this.walls.left.shapes[0].collisionMask=this.walls.left.shapes[0].collisionMask|t),this.walls.right&&(this.walls.right.shapes[0].collisionMask=this.walls.right.shapes[0].collisionMask|t),this.walls.top&&(this.walls.top.shapes[0].collisionMask=this.walls.top.shapes[0].collisionMask|t),this.walls.bottom&&(this.walls.bottom.shapes[0].collisionMask=this.walls.bottom.shapes[0].collisionMask|t),this._collisionGroupID++;var s=new i.Physics.P2.CollisionGroup(t);return this.collisionGroups.push(s),e&&this.setCollisionGroup(e,s),s},setCollisionGroup:function(e,t){if(e instanceof i.Group)for(var s=0;s<e.total;s++)e.children[s].body&&e.children[s].body.type===i.Physics.P2JS&&e.children[s].body.setCollisionGroup(t);else e.body.setCollisionGroup(t)},createSpring:function(e,t,s,a,n,o,r,l,h){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addSpring(new i.Physics.P2.Spring(this,e,t,s,a,n,o,r,l,h)):void 0},createRotationalSpring:function(e,t,s,a,n){return e=this.getBody(e),t=this.getBody(t),e&&t?this.addSpring(new i.Physics.P2.RotationalSpring(this,e,t,s,a,n)):void 0},createBody:function(e,t,s,a,n,o){void 0===a&&(a=!1);var r=new i.Physics.P2.Body(this.game,null,e,t,s);return!(o&&!r.addPolygon(n,o))&&(a&&this.world.addBody(r.data),r)},createParticle:function(e,t,s,a,n,o){void 0===a&&(a=!1);var r=new i.Physics.P2.Body(this.game,null,e,t,s);return!(o&&!r.addPolygon(n,o))&&(a&&this.world.addBody(r.data),r)},convertCollisionObjects:function(e,t,i){void 0===i&&(i=!0);for(var s=[],a=0,n=e.collision[t].length;a<n;a++){var o=e.collision[t][a],r=this.createBody(o.x,o.y,0,i,{},o.polyline);r&&s.push(r)}return s},clearTilemapLayerBodies:function(e,t){t=e.getLayer(t);for(var i=e.layers[t].bodies.length;i--;)e.layers[t].bodies[i].destroy();e.layers[t].bodies.length=0},convertTilemap:function(e,t,i,s){t=e.getLayer(t),void 0===i&&(i=!0),void 0===s&&(s=!0),this.clearTilemapLayerBodies(e,t);for(var a=0,n=0,o=0,r=0,l=e.layers[t].height;r<l;r++){a=0;for(var h=0,c=e.layers[t].width;h<c;h++){var p=e.layers[t].data[r][h];if(p&&p.index>-1&&p.collides)if(s){var d=e.getTileRight(t,h,r);0===a&&(n=p.x*p.width,o=p.y*p.height,a=p.width),d&&d.collides?a+=p.width:((u=this.createBody(n,o,0,!1)).addRectangle(a,p.height,a/2,p.height/2,0),i&&this.addBody(u),e.layers[t].bodies.push(u),a=0)}else{var u=this.createBody(p.x*p.width,p.y*p.height,0,!1);u.addRectangle(p.width,p.height,p.width/2,p.height/2,0),i&&this.addBody(u),e.layers[t].bodies.push(u)}}}return e.layers[t].bodies},mpx:function(e){return e*=20},pxm:function(e){return.05*e},mpxi:function(e){return e*=-20},pxmi:function(e){return-.05*e}},Object.defineProperty(i.Physics.P2.prototype,"friction",{get:function(){return this.world.defaultContactMaterial.friction},set:function(e){this.world.defaultContactMaterial.friction=e}}),Object.defineProperty(i.Physics.P2.prototype,"restitution",{get:function(){return this.world.defaultContactMaterial.restitution},set:function(e){this.world.defaultContactMaterial.restitution=e}}),Object.defineProperty(i.Physics.P2.prototype,"contactMaterial",{get:function(){return this.world.defaultContactMaterial},set:function(e){this.world.defaultContactMaterial=e}}),Object.defineProperty(i.Physics.P2.prototype,"applySpringForces",{get:function(){return this.world.applySpringForces},set:function(e){this.world.applySpringForces=e}}),Object.defineProperty(i.Physics.P2.prototype,"applyDamping",{get:function(){return this.world.applyDamping},set:function(e){this.world.applyDamping=e}}),Object.defineProperty(i.Physics.P2.prototype,"applyGravity",{get:function(){return this.world.applyGravity},set:function(e){this.world.applyGravity=e}}),Object.defineProperty(i.Physics.P2.prototype,"solveConstraints",{get:function(){return this.world.solveConstraints},set:function(e){this.world.solveConstraints=e}}),Object.defineProperty(i.Physics.P2.prototype,"time",{get:function(){return this.world.time}}),Object.defineProperty(i.Physics.P2.prototype,"emitImpactEvent",{get:function(){return this.world.emitImpactEvent},set:function(e){this.world.emitImpactEvent=e}}),Object.defineProperty(i.Physics.P2.prototype,"sleepMode",{get:function(){return this.world.sleepMode},set:function(e){this.world.sleepMode=e}}),Object.defineProperty(i.Physics.P2.prototype,"total",{get:function(){return this.world.bodies.length}}),i.Physics.P2.FixtureList=function(e){Array.isArray(e)||(e=[e]),this.rawList=e,this.init(),this.parse(this.rawList)},i.Physics.P2.FixtureList.prototype={init:function(){this.namedFixtures={},this.groupedFixtures=[],this.allFixtures=[]},setCategory:function(e,t){this.getFixtures(t).forEach(function(t){t.collisionGroup=e})},setMask:function(e,t){this.getFixtures(t).forEach(function(t){t.collisionMask=e})},setSensor:function(e,t){this.getFixtures(t).forEach(function(t){t.sensor=e})},setMaterial:function(e,t){this.getFixtures(t).forEach(function(t){t.material=e})},getFixtures:function(e){var t=[];if(e){e instanceof Array||(e=[e]);var i=this;return e.forEach(function(e){i.namedFixtures[e]&&t.push(i.namedFixtures[e])}),this.flatten(t)}return this.allFixtures},getFixtureByKey:function(e){return this.namedFixtures[e]},getGroup:function(e){return this.groupedFixtures[e]},parse:function(){var e,t,i,s;i=this.rawList,s=[];for(e in i)t=i[e],isNaN(e-0)?this.namedFixtures[e]=this.flatten(t):(this.groupedFixtures[e]=this.groupedFixtures[e]||[],this.groupedFixtures[e]=this.groupedFixtures[e].concat(t)),s.push(this.allFixtures=this.flatten(this.groupedFixtures))},flatten:function(e){var t,i;return t=[],i=arguments.callee,e.forEach(function(e){return Array.prototype.push.apply(t,Array.isArray(e)?i(e):[e])}),t}},i.Physics.P2.PointProxy=function(e,t){this.world=e,this.destination=t},i.Physics.P2.PointProxy.prototype.constructor=i.Physics.P2.PointProxy,Object.defineProperty(i.Physics.P2.PointProxy.prototype,"x",{get:function(){return this.world.mpx(this.destination[0])},set:function(e){this.destination[0]=this.world.pxm(e)}}),Object.defineProperty(i.Physics.P2.PointProxy.prototype,"y",{get:function(){return this.world.mpx(this.destination[1])},set:function(e){this.destination[1]=this.world.pxm(e)}}),Object.defineProperty(i.Physics.P2.PointProxy.prototype,"mx",{get:function(){return this.destination[0]},set:function(e){this.destination[0]=e}}),Object.defineProperty(i.Physics.P2.PointProxy.prototype,"my",{get:function(){return this.destination[1]},set:function(e){this.destination[1]=e}}),i.Physics.P2.InversePointProxy=function(e,t){this.world=e,this.destination=t},i.Physics.P2.InversePointProxy.prototype.constructor=i.Physics.P2.InversePointProxy,Object.defineProperty(i.Physics.P2.InversePointProxy.prototype,"x",{get:function(){return this.world.mpxi(this.destination[0])},set:function(e){this.destination[0]=this.world.pxmi(e)}}),Object.defineProperty(i.Physics.P2.InversePointProxy.prototype,"y",{get:function(){return this.world.mpxi(this.destination[1])},set:function(e){this.destination[1]=this.world.pxmi(e)}}),Object.defineProperty(i.Physics.P2.InversePointProxy.prototype,"mx",{get:function(){return this.destination[0]},set:function(e){this.destination[0]=-e}}),Object.defineProperty(i.Physics.P2.InversePointProxy.prototype,"my",{get:function(){return this.destination[1]},set:function(e){this.destination[1]=-e}}),i.Physics.P2.Body=function(e,t,s,a,n){t=t||null,s=s||0,a=a||0,void 0===n&&(n=1),this.game=e,this.world=e.physics.p2,this.sprite=t,this.type=i.Physics.P2JS,this.offset=new i.Point,this.data=new p2.Body({position:[this.world.pxmi(s),this.world.pxmi(a)],mass:n}),this.data.parent=this,this.velocity=new i.Physics.P2.InversePointProxy(this.world,this.data.velocity),this.force=new i.Physics.P2.InversePointProxy(this.world,this.data.force),this.gravity=new i.Point,this.onBeginContact=new i.Signal,this.onEndContact=new i.Signal,this.collidesWith=[],this.removeNextStep=!1,this.debugBody=null,this.dirty=!1,this._collideWorldBounds=!0,this._bodyCallbacks={},this._bodyCallbackContext={},this._groupCallbacks={},this._groupCallbackContext={},this._reset=!1,t&&(this.setRectangleFromSprite(t),t.exists&&this.game.physics.p2.addBody(this))},i.Physics.P2.Body.prototype={createBodyCallback:function(e,t,i){var s=-1;e.id?s=e.id:e.body&&(s=e.body.id),s>-1&&(null===t?(delete this._bodyCallbacks[s],delete this._bodyCallbackContext[s]):(this._bodyCallbacks[s]=t,this._bodyCallbackContext[s]=i))},createGroupCallback:function(e,t,i){null===t?(delete this._groupCallbacks[e.mask],delete this._groupCallbackContext[e.mask]):(this._groupCallbacks[e.mask]=t,this._groupCallbackContext[e.mask]=i)},getCollisionMask:function(){var e=0;this._collideWorldBounds&&(e=this.game.physics.p2.boundsCollisionGroup.mask);for(var t=0;t<this.collidesWith.length;t++)e|=this.collidesWith[t].mask;return e},updateCollisionMask:function(e){var t=this.getCollisionMask();if(void 0===e)for(var i=this.data.shapes.length-1;i>=0;i--)this.data.shapes[i].collisionMask=t;else e.collisionMask=t},setCollisionGroup:function(e,t){var i=this.getCollisionMask();if(void 0===t)for(var s=this.data.shapes.length-1;s>=0;s--)this.data.shapes[s].collisionGroup=e.mask,this.data.shapes[s].collisionMask=i;else t.collisionGroup=e.mask,t.collisionMask=i},clearCollision:function(e,t,i){if(void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===i)for(var s=this.data.shapes.length-1;s>=0;s--)e&&(this.data.shapes[s].collisionGroup=null),t&&(this.data.shapes[s].collisionMask=null);else e&&(i.collisionGroup=null),t&&(i.collisionMask=null);e&&(this.collidesWith.length=0)},removeCollisionGroup:function(e,t,i){void 0===t&&(t=!0);var s;if(Array.isArray(e))for(n=0;n<e.length;n++)(s=this.collidesWith.indexOf(e[n]))>-1&&(this.collidesWith.splice(s,1),t&&(delete this._groupCallbacks[e.mask],delete this._groupCallbackContext[e.mask]));else(s=this.collidesWith.indexOf(e))>-1&&(this.collidesWith.splice(s,1),t&&(delete this._groupCallbacks[e.mask],delete this._groupCallbackContext[e.mask]));var a=this.getCollisionMask();if(void 0===i)for(var n=this.data.shapes.length-1;n>=0;n--)this.data.shapes[n].collisionMask=a;else i.collisionMask=a},collides:function(e,t,i,s){if(Array.isArray(e))for(n=0;n<e.length;n++)-1===this.collidesWith.indexOf(e[n])&&(this.collidesWith.push(e[n]),t&&this.createGroupCallback(e[n],t,i));else-1===this.collidesWith.indexOf(e)&&(this.collidesWith.push(e),t&&this.createGroupCallback(e,t,i));var a=this.getCollisionMask();if(void 0===s)for(var n=this.data.shapes.length-1;n>=0;n--)this.data.shapes[n].collisionMask=a;else s.collisionMask=a},adjustCenterOfMass:function(){this.data.adjustCenterOfMass(),this.shapeChanged()},getVelocityAtPoint:function(e,t){return this.data.getVelocityAtPoint(e,t)},applyDamping:function(e){this.data.applyDamping(e)},applyImpulse:function(e,t,i){this.data.applyImpulse(e,[this.world.pxmi(t),this.world.pxmi(i)])},applyImpulseLocal:function(e,t,i){this.data.applyImpulseLocal(e,[this.world.pxmi(t),this.world.pxmi(i)])},applyForce:function(e,t,i){this.data.applyForce(e,[this.world.pxmi(t),this.world.pxmi(i)])},setZeroForce:function(){this.data.setZeroForce()},setZeroRotation:function(){this.data.angularVelocity=0},setZeroVelocity:function(){this.data.velocity[0]=0,this.data.velocity[1]=0},setZeroDamping:function(){this.data.damping=0,this.data.angularDamping=0},toLocalFrame:function(e,t){return this.data.toLocalFrame(e,t)},toWorldFrame:function(e,t){return this.data.toWorldFrame(e,t)},rotateLeft:function(e){this.data.angularVelocity=this.world.pxm(-e)},rotateRight:function(e){this.data.angularVelocity=this.world.pxm(e)},moveForward:function(e){var t=this.world.pxmi(-e),i=this.data.angle+Math.PI/2;this.data.velocity[0]=t*Math.cos(i),this.data.velocity[1]=t*Math.sin(i)},moveBackward:function(e){var t=this.world.pxmi(-e),i=this.data.angle+Math.PI/2;this.data.velocity[0]=-t*Math.cos(i),this.data.velocity[1]=-t*Math.sin(i)},thrust:function(e){var t=this.world.pxmi(-e),i=this.data.angle+Math.PI/2;this.data.force[0]+=t*Math.cos(i),this.data.force[1]+=t*Math.sin(i)},thrustLeft:function(e){var t=this.world.pxmi(-e),i=this.data.angle;this.data.force[0]+=t*Math.cos(i),this.data.force[1]+=t*Math.sin(i)},thrustRight:function(e){var t=this.world.pxmi(-e),i=this.data.angle;this.data.force[0]-=t*Math.cos(i),this.data.force[1]-=t*Math.sin(i)},reverse:function(e){var t=this.world.pxmi(-e),i=this.data.angle+Math.PI/2;this.data.force[0]-=t*Math.cos(i),this.data.force[1]-=t*Math.sin(i)},moveLeft:function(e){this.data.velocity[0]=this.world.pxmi(-e)},moveRight:function(e){this.data.velocity[0]=this.world.pxmi(e)},moveUp:function(e){this.data.velocity[1]=this.world.pxmi(-e)},moveDown:function(e){this.data.velocity[1]=this.world.pxmi(e)},preUpdate:function(){this.dirty=!0,this.removeNextStep&&(this.removeFromWorld(),this.removeNextStep=!1)},postUpdate:function(){this.sprite.x=this.world.mpxi(this.data.position[0])+this.offset.x,this.sprite.y=this.world.mpxi(this.data.position[1])+this.offset.y,this.fixedRotation||(this.sprite.rotation=this.data.angle),this.debugBody&&this.debugBody.updateSpriteTransform(),this.dirty=!1},reset:function(e,t,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1),this.setZeroForce(),this.setZeroVelocity(),this.setZeroRotation(),i&&this.setZeroDamping(),s&&(this.mass=1),this.x=e,this.y=t},addToWorld:function(){if(this.game.physics.p2._toRemove)for(var e=0;e<this.game.physics.p2._toRemove.length;e++)this.game.physics.p2._toRemove[e]===this&&this.game.physics.p2._toRemove.splice(e,1);this.data.world!==this.game.physics.p2.world&&this.game.physics.p2.addBody(this)},removeFromWorld:function(){this.data.world===this.game.physics.p2.world&&this.game.physics.p2.removeBodyNextStep(this)},destroy:function(){this.removeFromWorld(),this.clearShapes(),this._bodyCallbacks={},this._bodyCallbackContext={},this._groupCallbacks={},this._groupCallbackContext={},this.debugBody&&this.debugBody.destroy(!0,!0),this.debugBody=null,this.sprite&&(this.sprite.body=null,this.sprite=null)},clearShapes:function(){for(var e=this.data.shapes.length;e--;)this.data.removeShape(this.data.shapes[e]);this.shapeChanged()},addShape:function(e,t,i,s){return void 0===t&&(t=0),void 0===i&&(i=0),void 0===s&&(s=0),this.data.addShape(e,[this.world.pxmi(t),this.world.pxmi(i)],s),this.shapeChanged(),e},addCircle:function(e,t,i,s){var a=new p2.Circle({radius:this.world.pxm(e)});return this.addShape(a,t,i,s)},addRectangle:function(e,t,i,s,a){var n=new p2.Box({width:this.world.pxm(e),height:this.world.pxm(t)});return this.addShape(n,i,s,a)},addPlane:function(e,t,i){var s=new p2.Plane;return this.addShape(s,e,t,i)},addParticle:function(e,t,i){var s=new p2.Particle;return this.addShape(s,e,t,i)},addLine:function(e,t,i,s){var a=new p2.Line({length:this.world.pxm(e)});return this.addShape(a,t,i,s)},addCapsule:function(e,t,i,s,a){var n=new p2.Capsule({length:this.world.pxm(e),radius:this.world.pxm(t)});return this.addShape(n,i,s,a)},addPolygon:function(e,t){e=e||{},Array.isArray(t)||(t=Array.prototype.slice.call(arguments,1));var i=[];if(1===t.length&&Array.isArray(t[0]))i=t[0].slice(0);else if(Array.isArray(t[0]))i=t.slice();else if("number"==typeof t[0])for(var s=0,a=t.length;s<a;s+=2)i.push([t[s],t[s+1]]);var n=i.length-1;i[n][0]===i[0][0]&&i[n][1]===i[0][1]&&i.pop();for(var o=0;o<i.length;o++)i[o][0]=this.world.pxmi(i[o][0]),i[o][1]=this.world.pxmi(i[o][1]);var r=this.data.fromPolygon(i,e);return this.shapeChanged(),r},removeShape:function(e){var t=this.data.removeShape(e);return this.shapeChanged(),t},setCircle:function(e,t,i,s){return this.clearShapes(),this.addCircle(e,t,i,s)},setRectangle:function(e,t,i,s,a){return void 0===e&&(e=16),void 0===t&&(t=16),this.clearShapes(),this.addRectangle(e,t,i,s,a)},setRectangleFromSprite:function(e){return void 0===e&&(e=this.sprite),this.clearShapes(),this.addRectangle(e.width,e.height,0,0,e.rotation)},setMaterial:function(e,t){if(void 0===t)for(var i=this.data.shapes.length-1;i>=0;i--)this.data.shapes[i].material=e;else t.material=e},shapeChanged:function(){this.debugBody&&this.debugBody.draw()},addPhaserPolygon:function(e,t){for(var i=this.game.cache.getPhysicsData(e,t),s=[],a=0;a<i.length;a++){var n=i[a],o=this.addFixture(n);s[n.filter.group]=s[n.filter.group]||[],s[n.filter.group]=s[n.filter.group].concat(o),n.fixtureKey&&(s[n.fixtureKey]=o)}return this.data.aabbNeedsUpdate=!0,this.shapeChanged(),s},addFixture:function(e){var t=[];if(e.circle){(h=new p2.Circle({radius:this.world.pxm(e.circle.radius)})).collisionGroup=e.filter.categoryBits,h.collisionMask=e.filter.maskBits,h.sensor=e.isSensor;var i=p2.vec2.create();i[0]=this.world.pxmi(e.circle.position[0]-this.sprite.width/2),i[1]=this.world.pxmi(e.circle.position[1]-this.sprite.height/2),this.data.addShape(h,i),t.push(h)}else for(var s=e.polygons,a=p2.vec2.create(),n=0;n<s.length;n++){for(var o=s[n],r=[],l=0;l<o.length;l+=2)r.push([this.world.pxmi(o[l]),this.world.pxmi(o[l+1])]);for(var h=new p2.Convex({vertices:r}),c=0;c!==h.vertices.length;c++){var p=h.vertices[c];p2.vec2.sub(p,p,h.centerOfMass)}p2.vec2.scale(a,h.centerOfMass,1),a[0]-=this.world.pxmi(this.sprite.width/2),a[1]-=this.world.pxmi(this.sprite.height/2),h.updateTriangles(),h.updateCenterOfMass(),h.updateBoundingRadius(),h.collisionGroup=e.filter.categoryBits,h.collisionMask=e.filter.maskBits,h.sensor=e.isSensor,this.data.addShape(h,a),t.push(h)}return t},loadPolygon:function(e,t){if(null===e)i=t;else var i=this.game.cache.getPhysicsData(e,t);for(var s=p2.vec2.create(),a=0;a<i.length;a++){for(var n=[],o=0;o<i[a].shape.length;o+=2)n.push([this.world.pxmi(i[a].shape[o]),this.world.pxmi(i[a].shape[o+1])]);for(var r=new p2.Convex({vertices:n}),l=0;l!==r.vertices.length;l++){var h=r.vertices[l];p2.vec2.sub(h,h,r.centerOfMass)}p2.vec2.scale(s,r.centerOfMass,1),s[0]-=this.world.pxmi(this.sprite.width/2),s[1]-=this.world.pxmi(this.sprite.height/2),r.updateTriangles(),r.updateCenterOfMass(),r.updateBoundingRadius(),this.data.addShape(r,s)}return this.data.aabbNeedsUpdate=!0,this.shapeChanged(),!0}},i.Physics.P2.Body.prototype.constructor=i.Physics.P2.Body,i.Physics.P2.Body.DYNAMIC=1,i.Physics.P2.Body.STATIC=2,i.Physics.P2.Body.KINEMATIC=4,Object.defineProperty(i.Physics.P2.Body.prototype,"static",{get:function(){return this.data.type===i.Physics.P2.Body.STATIC},set:function(e){e&&this.data.type!==i.Physics.P2.Body.STATIC?(this.data.type=i.Physics.P2.Body.STATIC,this.mass=0):e||this.data.type!==i.Physics.P2.Body.STATIC||(this.data.type=i.Physics.P2.Body.DYNAMIC,this.mass=1)}}),Object.defineProperty(i.Physics.P2.Body.prototype,"dynamic",{get:function(){return this.data.type===i.Physics.P2.Body.DYNAMIC},set:function(e){e&&this.data.type!==i.Physics.P2.Body.DYNAMIC?(this.data.type=i.Physics.P2.Body.DYNAMIC,this.mass=1):e||this.data.type!==i.Physics.P2.Body.DYNAMIC||(this.data.type=i.Physics.P2.Body.STATIC,this.mass=0)}}),Object.defineProperty(i.Physics.P2.Body.prototype,"kinematic",{get:function(){return this.data.type===i.Physics.P2.Body.KINEMATIC},set:function(e){e&&this.data.type!==i.Physics.P2.Body.KINEMATIC?(this.data.type=i.Physics.P2.Body.KINEMATIC,this.mass=4):e||this.data.type!==i.Physics.P2.Body.KINEMATIC||(this.data.type=i.Physics.P2.Body.STATIC,this.mass=0)}}),Object.defineProperty(i.Physics.P2.Body.prototype,"allowSleep",{get:function(){return this.data.allowSleep},set:function(e){e!==this.data.allowSleep&&(this.data.allowSleep=e)}}),Object.defineProperty(i.Physics.P2.Body.prototype,"angle",{get:function(){return i.Math.wrapAngle(i.Math.radToDeg(this.data.angle))},set:function(e){this.data.angle=i.Math.degToRad(i.Math.wrapAngle(e))}}),Object.defineProperty(i.Physics.P2.Body.prototype,"angularDamping",{get:function(){return this.data.angularDamping},set:function(e){this.data.angularDamping=e}}),Object.defineProperty(i.Physics.P2.Body.prototype,"angularForce",{get:function(){return this.data.angularForce},set:function(e){this.data.angularForce=e}}),Object.defineProperty(i.Physics.P2.Body.prototype,"angularVelocity",{get:function(){return this.data.angularVelocity},set:function(e){this.data.angularVelocity=e}}),Object.defineProperty(i.Physics.P2.Body.prototype,"damping",{get:function(){return this.data.damping},set:function(e){this.data.damping=e}}),Object.defineProperty(i.Physics.P2.Body.prototype,"fixedRotation",{get:function(){return this.data.fixedRotation},set:function(e){e!==this.data.fixedRotation&&(this.data.fixedRotation=e)}}),Object.defineProperty(i.Physics.P2.Body.prototype,"inertia",{get:function(){return this.data.inertia},set:function(e){this.data.inertia=e}}),Object.defineProperty(i.Physics.P2.Body.prototype,"mass",{get:function(){return this.data.mass},set:function(e){e!==this.data.mass&&(this.data.mass=e,this.data.updateMassProperties())}}),Object.defineProperty(i.Physics.P2.Body.prototype,"motionState",{get:function(){return this.data.type},set:function(e){e!==this.data.type&&(this.data.type=e)}}),Object.defineProperty(i.Physics.P2.Body.prototype,"rotation",{get:function(){return this.data.angle},set:function(e){this.data.angle=e}}),Object.defineProperty(i.Physics.P2.Body.prototype,"sleepSpeedLimit",{get:function(){return this.data.sleepSpeedLimit},set:function(e){this.data.sleepSpeedLimit=e}}),Object.defineProperty(i.Physics.P2.Body.prototype,"x",{get:function(){return this.world.mpxi(this.data.position[0])},set:function(e){this.data.position[0]=this.world.pxmi(e)}}),Object.defineProperty(i.Physics.P2.Body.prototype,"y",{get:function(){return this.world.mpxi(this.data.position[1])},set:function(e){this.data.position[1]=this.world.pxmi(e)}}),Object.defineProperty(i.Physics.P2.Body.prototype,"id",{get:function(){return this.data.id}}),Object.defineProperty(i.Physics.P2.Body.prototype,"debug",{get:function(){return null!==this.debugBody},set:function(e){e&&!this.debugBody?this.debugBody=new i.Physics.P2.BodyDebug(this.game,this.data):!e&&this.debugBody&&(this.debugBody.destroy(),this.debugBody=null)}}),Object.defineProperty(i.Physics.P2.Body.prototype,"collideWorldBounds",{get:function(){return this._collideWorldBounds},set:function(e){e&&!this._collideWorldBounds?(this._collideWorldBounds=!0,this.updateCollisionMask()):!e&&this._collideWorldBounds&&(this._collideWorldBounds=!1,this.updateCollisionMask())}}),i.Physics.P2.BodyDebug=function(e,t,s){i.Group.call(this,e);var a={pixelsPerLengthUnit:e.physics.p2.mpx(1),debugPolygons:!1,lineWidth:1,alpha:.5};this.settings=i.Utils.extend(a,s),this.ppu=this.settings.pixelsPerLengthUnit,this.ppu=-1*this.ppu,this.body=t,this.canvas=new i.Graphics(e),this.canvas.alpha=this.settings.alpha,this.add(this.canvas),this.draw(),this.updateSpriteTransform()},i.Physics.P2.BodyDebug.prototype=Object.create(i.Group.prototype),i.Physics.P2.BodyDebug.prototype.constructor=i.Physics.P2.BodyDebug,i.Utils.extend(i.Physics.P2.BodyDebug.prototype,{updateSpriteTransform:function(){this.position.x=this.body.position[0]*this.ppu,this.position.y=this.body.position[1]*this.ppu,this.rotation=this.body.angle},draw:function(){var e,t,i,s,a,n,o,r,l,h,c,p,d,u,m;if(r=this.body,(h=this.canvas).clear(),i=parseInt(this.randomPastelHex(),16),n=16711680,o=this.lineWidth,r instanceof p2.Body&&r.shapes.length){var g=r.shapes.length;for(s=0;s!==g;){if(t=r.shapes[s],l=t.position||0,e=t.angle||0,t instanceof p2.Circle)this.drawCircle(h,l[0]*this.ppu,l[1]*this.ppu,e,t.radius*this.ppu,i,o);else if(t instanceof p2.Capsule)this.drawCapsule(h,l[0]*this.ppu,l[1]*this.ppu,e,t.length*this.ppu,t.radius*this.ppu,n,i,o);else if(t instanceof p2.Plane)this.drawPlane(h,l[0]*this.ppu,-l[1]*this.ppu,i,n,5*o,10*o,10*o,100*this.ppu,e);else if(t instanceof p2.Line)this.drawLine(h,t.length*this.ppu,n,o);else if(t instanceof p2.Box)this.drawRectangle(h,l[0]*this.ppu,l[1]*this.ppu,e,t.width*this.ppu,t.height*this.ppu,n,i,o);else if(t instanceof p2.Convex){for(p=[],d=p2.vec2.create(),a=u=0,m=t.vertices.length;0<=m?u<m:u>m;a=0<=m?++u:--u)c=t.vertices[a],p2.vec2.rotate(d,c,e),p.push([(d[0]+l[0])*this.ppu,-(d[1]+l[1])*this.ppu]);this.drawConvex(h,p,t.triangles,n,i,o,this.settings.debugPolygons,[l[0]*this.ppu,-l[1]*this.ppu])}s++}}},drawRectangle:function(e,t,i,s,a,n,o,r,l){void 0===l&&(l=1),void 0===o&&(o=0),e.lineStyle(l,o,1),e.beginFill(r),e.drawRect(t-a/2,i-n/2,a,n)},drawCircle:function(e,t,i,s,a,n,o){void 0===o&&(o=1),void 0===n&&(n=16777215),e.lineStyle(o,0,1),e.beginFill(n,1),e.drawCircle(t,i,2*-a),e.endFill(),e.moveTo(t,i),e.lineTo(t+a*Math.cos(-s),i+a*Math.sin(-s))},drawLine:function(e,t,i,s){void 0===s&&(s=1),void 0===i&&(i=0),e.lineStyle(5*s,i,1),e.moveTo(-t/2,0),e.lineTo(t/2,0)},drawConvex:function(e,t,i,s,a,n,o,r){var l,h,c,p,d,u,m,g,y,b,x;if(void 0===n&&(n=1),void 0===s&&(s=0),o){for(l=[16711680,65280,255],h=0;h!==t.length+1;)p=t[h%t.length],d=t[(h+1)%t.length],m=p[0],b=p[1],g=d[0],x=d[1],e.lineStyle(n,l[h%l.length],1),e.moveTo(m,-b),e.lineTo(g,-x),e.drawCircle(m,-b,2*n),h++;return e.lineStyle(n,0,1),e.drawCircle(r[0],r[1],2*n)}for(e.lineStyle(n,s,1),e.beginFill(a),h=0;h!==t.length;)c=t[h],u=c[0],y=c[1],0===h?e.moveTo(u,-y):e.lineTo(u,-y),h++;if(e.endFill(),t.length>2)return e.moveTo(t[t.length-1][0],-t[t.length-1][1]),e.lineTo(t[0][0],-t[0][1])},drawPath:function(e,t,i,s,a){var n,o,r,l,h,c,p,d,u,m,g,y;for(void 0===a&&(a=1),void 0===i&&(i=0),e.lineStyle(a,i,1),"number"==typeof s&&e.beginFill(s),o=null,r=null,n=0;n<t.length;)m=t[n],g=m[0],y=m[1],g===o&&y===r||(0===n?e.moveTo(g,y):(l=o,h=r,c=g,p=y,d=t[(n+1)%t.length][0],u=t[(n+1)%t.length][1],0!==(c-l)*(u-h)-(d-l)*(p-h)&&e.lineTo(g,y)),o=g,r=y),n++;"number"==typeof s&&e.endFill(),t.length>2&&"number"==typeof s&&(e.moveTo(t[t.length-1][0],t[t.length-1][1]),e.lineTo(t[0][0],t[0][1]))},drawPlane:function(e,t,i,s,a,n,o,r,l,h){var c,p;void 0===n&&(n=1),void 0===s&&(s=16777215),e.lineStyle(n,a,11),e.beginFill(s),e.moveTo(t,-i),c=t+Math.cos(h)*this.game.width,p=i+Math.sin(h)*this.game.height,e.lineTo(c,-p),e.moveTo(t,-i),c=t+Math.cos(h)*-this.game.width,p=i+Math.sin(h)*-this.game.height,e.lineTo(c,-p)},drawCapsule:function(e,t,i,s,a,n,o,r,l){void 0===l&&(l=1),void 0===o&&(o=0),e.lineStyle(l,o,1);var h=Math.cos(s),c=Math.sin(s);e.beginFill(r,1),e.drawCircle(-a/2*h+t,-a/2*c+i,2*-n),e.drawCircle(a/2*h+t,a/2*c+i,2*-n),e.endFill(),e.lineStyle(l,o,0),e.beginFill(r,1),e.moveTo(-a/2*h+n*c+t,-a/2*c+n*h+i),e.lineTo(a/2*h+n*c+t,a/2*c+n*h+i),e.lineTo(a/2*h-n*c+t,a/2*c-n*h+i),e.lineTo(-a/2*h-n*c+t,-a/2*c-n*h+i),e.endFill(),e.lineStyle(l,o,1),e.moveTo(-a/2*h+n*c+t,-a/2*c+n*h+i),e.lineTo(a/2*h+n*c+t,a/2*c+n*h+i),e.moveTo(-a/2*h-n*c+t,-a/2*c-n*h+i),e.lineTo(a/2*h-n*c+t,a/2*c-n*h+i)},randomPastelHex:function(){var e,t,i,s;return i=[255,255,255],s=Math.floor(256*Math.random()),t=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),s=Math.floor((s+3*i[0])/4),t=Math.floor((t+3*i[1])/4),e=Math.floor((e+3*i[2])/4),this.rgbToHex(s,t,e)},rgbToHex:function(e,t,i){return this.componentToHex(e)+this.componentToHex(t)+this.componentToHex(i)},componentToHex:function(e){var t;return 2===(t=e.toString(16)).length?t:t+"0"}}),i.Physics.P2.Spring=function(e,t,i,s,a,n,o,r,l,h){this.game=e.game,this.world=e,void 0===s&&(s=1),void 0===a&&(a=100),void 0===n&&(n=1);var c={restLength:s=e.pxm(s),stiffness:a,damping:n};void 0!==o&&null!==o&&(c.worldAnchorA=[e.pxm(o[0]),e.pxm(o[1])]),void 0!==r&&null!==r&&(c.worldAnchorB=[e.pxm(r[0]),e.pxm(r[1])]),void 0!==l&&null!==l&&(c.localAnchorA=[e.pxm(l[0]),e.pxm(l[1])]),void 0!==h&&null!==h&&(c.localAnchorB=[e.pxm(h[0]),e.pxm(h[1])]),this.data=new p2.LinearSpring(t,i,c),this.data.parent=this},i.Physics.P2.Spring.prototype.constructor=i.Physics.P2.Spring,i.Physics.P2.RotationalSpring=function(e,t,i,s,a,n){this.game=e.game,this.world=e,void 0===s&&(s=null),void 0===a&&(a=100),void 0===n&&(n=1),s&&(s=e.pxm(s));var o={restAngle:s,stiffness:a,damping:n};this.data=new p2.RotationalSpring(t,i,o),this.data.parent=this},i.Physics.P2.Spring.prototype.constructor=i.Physics.P2.Spring,i.Physics.P2.Material=function(e){this.name=e,p2.Material.call(this)},i.Physics.P2.Material.prototype=Object.create(p2.Material.prototype),i.Physics.P2.Material.prototype.constructor=i.Physics.P2.Material,i.Physics.P2.ContactMaterial=function(e,t,i){p2.ContactMaterial.call(this,e,t,i)},i.Physics.P2.ContactMaterial.prototype=Object.create(p2.ContactMaterial.prototype),i.Physics.P2.ContactMaterial.prototype.constructor=i.Physics.P2.ContactMaterial,i.Physics.P2.CollisionGroup=function(e){this.mask=e},i.Physics.P2.DistanceConstraint=function(e,t,i,s,a,n,o){void 0===s&&(s=100),void 0===a&&(a=[0,0]),void 0===n&&(n=[0,0]),void 0===o&&(o=Number.MAX_VALUE),this.game=e.game,this.world=e;var r={distance:s=e.pxm(s),localAnchorA:a=[e.pxmi(a[0]),e.pxmi(a[1])],localAnchorB:n=[e.pxmi(n[0]),e.pxmi(n[1])],maxForce:o};p2.DistanceConstraint.call(this,t,i,r)},i.Physics.P2.DistanceConstraint.prototype=Object.create(p2.DistanceConstraint.prototype),i.Physics.P2.DistanceConstraint.prototype.constructor=i.Physics.P2.DistanceConstraint,i.Physics.P2.GearConstraint=function(e,t,i,s,a){void 0===s&&(s=0),void 0===a&&(a=1),this.game=e.game,this.world=e;var n={angle:s,ratio:a};p2.GearConstraint.call(this,t,i,n)},i.Physics.P2.GearConstraint.prototype=Object.create(p2.GearConstraint.prototype),i.Physics.P2.GearConstraint.prototype.constructor=i.Physics.P2.GearConstraint,i.Physics.P2.LockConstraint=function(e,t,i,s,a,n){void 0===s&&(s=[0,0]),void 0===a&&(a=0),void 0===n&&(n=Number.MAX_VALUE),this.game=e.game,this.world=e;var o={localOffsetB:s=[e.pxm(s[0]),e.pxm(s[1])],localAngleB:a,maxForce:n};p2.LockConstraint.call(this,t,i,o)},i.Physics.P2.LockConstraint.prototype=Object.create(p2.LockConstraint.prototype),i.Physics.P2.LockConstraint.prototype.constructor=i.Physics.P2.LockConstraint,i.Physics.P2.PrismaticConstraint=function(e,t,i,s,a,n,o,r){void 0===s&&(s=!0),void 0===a&&(a=[0,0]),void 0===n&&(n=[0,0]),void 0===o&&(o=[0,0]),void 0===r&&(r=Number.MAX_VALUE),this.game=e.game,this.world=e;var l={localAnchorA:a=[e.pxmi(a[0]),e.pxmi(a[1])],localAnchorB:n=[e.pxmi(n[0]),e.pxmi(n[1])],localAxisA:o,maxForce:r,disableRotationalLock:!s};p2.PrismaticConstraint.call(this,t,i,l)},i.Physics.P2.PrismaticConstraint.prototype=Object.create(p2.PrismaticConstraint.prototype),i.Physics.P2.PrismaticConstraint.prototype.constructor=i.Physics.P2.PrismaticConstraint,i.Physics.P2.RevoluteConstraint=function(e,t,i,s,a,n,o){void 0===n&&(n=Number.MAX_VALUE),void 0===o&&(o=null),this.game=e.game,this.world=e,i=[e.pxmi(i[0]),e.pxmi(i[1])],a=[e.pxmi(a[0]),e.pxmi(a[1])],o&&(o=[e.pxmi(o[0]),e.pxmi(o[1])]);var r={worldPivot:o,localPivotA:i,localPivotB:a,maxForce:n};p2.RevoluteConstraint.call(this,t,s,r)},i.Physics.P2.RevoluteConstraint.prototype=Object.create(p2.RevoluteConstraint.prototype),i.Physics.P2.RevoluteConstraint.prototype.constructor=i.Physics.P2.RevoluteConstraint,i.ImageCollection=function(e,t,i,s,a,n,o){(void 0===i||i<=0)&&(i=32),(void 0===s||s<=0)&&(s=32),void 0===a&&(a=0),void 0===n&&(n=0),this.name=e,this.firstgid=0|t,this.imageWidth=0|i,this.imageHeight=0|s,this.imageMargin=0|a,this.imageSpacing=0|n,this.properties=o||{},this.images=[],this.total=0},i.ImageCollection.prototype={containsImageIndex:function(e){return e>=this.firstgid&&e<this.firstgid+this.total},addImage:function(e,t){this.images.push({gid:e,image:t}),this.total++}},i.ImageCollection.prototype.constructor=i.ImageCollection,i.Tile=function(e,t,i,s,a,n){this.layer=e,this.index=t,this.x=i,this.y=s,this.rotation=0,this.flipped=!1,this.worldX=i*a,this.worldY=s*n,this.width=a,this.height=n,this.centerX=Math.abs(a/2),this.centerY=Math.abs(n/2),this.alpha=1,this.properties={},this.scanned=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1,this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.collisionCallback=null,this.collisionCallbackContext=this},i.Tile.prototype={containsPoint:function(e,t){return!(e<this.worldX||t<this.worldY||e>this.right||t>this.bottom)},intersects:function(e,t,i,s){return!(i<=this.worldX||s<=this.worldY||e>=this.worldX+this.width||t>=this.worldY+this.height)},setCollisionCallback:function(e,t){this.collisionCallback=e,this.collisionCallbackContext=t},destroy:function(){this.collisionCallback=null,this.collisionCallbackContext=null,this.properties=null},setCollision:function(e,t,i,s){this.collideLeft=e,this.collideRight=t,this.collideUp=i,this.collideDown=s,this.faceLeft=e,this.faceRight=t,this.faceTop=i,this.faceBottom=s},resetCollision:function(){this.collideLeft=!1,this.collideRight=!1,this.collideUp=!1,this.collideDown=!1,this.faceTop=!1,this.faceBottom=!1,this.faceLeft=!1,this.faceRight=!1},isInteresting:function(e,t){return e&&t?this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.faceTop||this.faceBottom||this.faceLeft||this.faceRight||this.collisionCallback:e?this.collideLeft||this.collideRight||this.collideUp||this.collideDown:!!t&&(this.faceTop||this.faceBottom||this.faceLeft||this.faceRight)},copy:function(e){this.index=e.index,this.alpha=e.alpha,this.properties=e.properties,this.collideUp=e.collideUp,this.collideDown=e.collideDown,this.collideLeft=e.collideLeft,this.collideRight=e.collideRight,this.collisionCallback=e.collisionCallback,this.collisionCallbackContext=e.collisionCallbackContext}},i.Tile.prototype.constructor=i.Tile,Object.defineProperty(i.Tile.prototype,"collides",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown}}),Object.defineProperty(i.Tile.prototype,"canCollide",{get:function(){return this.collideLeft||this.collideRight||this.collideUp||this.collideDown||this.collisionCallback}}),Object.defineProperty(i.Tile.prototype,"left",{get:function(){return this.worldX}}),Object.defineProperty(i.Tile.prototype,"right",{get:function(){return this.worldX+this.width}}),Object.defineProperty(i.Tile.prototype,"top",{get:function(){return this.worldY}}),Object.defineProperty(i.Tile.prototype,"bottom",{get:function(){return this.worldY+this.height}}),i.Tilemap=function(e,t,s,a,n,o){this.game=e,this.key=t;var r=i.TilemapParser.parse(this.game,t,s,a,n,o);null!==r&&(this.width=r.width,this.height=r.height,this.tileWidth=r.tileWidth,this.tileHeight=r.tileHeight,this.orientation=r.orientation,this.format=r.format,this.version=r.version,this.properties=r.properties,this.widthInPixels=r.widthInPixels,this.heightInPixels=r.heightInPixels,this.layers=r.layers,this.tilesets=r.tilesets,this.imagecollections=r.imagecollections,this.tiles=r.tiles,this.objects=r.objects,this.collideIndexes=[],this.collision=r.collision,this.images=r.images,this.enableDebug=!1,this.currentLayer=0,this.debugMap=[],this._results=[],this._tempA=0,this._tempB=0)},i.Tilemap.CSV=0,i.Tilemap.TILED_JSON=1,i.Tilemap.NORTH=0,i.Tilemap.EAST=1,i.Tilemap.SOUTH=2,i.Tilemap.WEST=3,i.Tilemap.prototype={create:function(e,t,i,s,a,n){return void 0===n&&(n=this.game.world),this.width=t,this.height=i,this.setTileSize(s,a),this.layers.length=0,this.createBlankLayer(e,t,i,s,a,n)},setTileSize:function(e,t){this.tileWidth=e,this.tileHeight=t,this.widthInPixels=this.width*e,this.heightInPixels=this.height*t},addTilesetImage:function(e,t,s,a,n,o,r){if(void 0===e)return null;void 0===s&&(s=this.tileWidth),void 0===a&&(a=this.tileHeight),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),0===s&&(s=32),0===a&&(a=32);var l=null;if(void 0!==t&&null!==t||(t=e),t instanceof i.BitmapData)l=t.canvas;else{if(!this.game.cache.checkImageKey(t))return null;l=this.game.cache.getImage(t)}var h=this.getTilesetIndex(e);if(null===h&&this.format===i.Tilemap.TILED_JSON)return null;if(this.tilesets[h])return this.tilesets[h].setImage(l),this.tilesets[h];var c=new i.Tileset(e,r,s,a,n,o,{});c.setImage(l),this.tilesets.push(c);for(var p=this.tilesets.length-1,d=n,u=n,m=0,g=0,y=0,b=r;b<r+c.total&&(this.tiles[b]=[d,u,p],d+=s+o,++m!==c.total)&&(++g!==c.columns||(d=n,u+=a+o,g=0,++y!==c.rows));b++);return c},createFromObjects:function(e,t,s,a,n,o,r,l,h){if(void 0===n&&(n=!0),void 0===o&&(o=!1),void 0===r&&(r=this.game.world),void 0===l&&(l=i.Sprite),void 0===h&&(h=!0),this.objects[e])for(var c=0;c<this.objects[e].length;c++){var p=!1,d=this.objects[e][c];if(void 0!==d.gid&&"number"==typeof t&&d.gid===t?p=!0:void 0!==d.id&&"number"==typeof t&&d.id===t?p=!0:void 0!==d.name&&"string"==typeof t&&d.name===t&&(p=!0),p){var u=new l(this.game,parseFloat(d.x,10),parseFloat(d.y,10),s,a);u.name=d.name,u.visible=d.visible,u.autoCull=o,u.exists=n,d.width&&(u.width=d.width),d.height&&(u.height=d.height),d.rotation&&(u.angle=d.rotation),h&&(u.y-=u.height),r.add(u);for(var m in d.properties)r.set(u,m,d.properties[m],!1,!1,0,!0)}}},createFromTiles:function(e,t,s,a,n,o){"number"==typeof e&&(e=[e]),void 0===t||null===t?t=[]:"number"==typeof t&&(t=[t]),a=this.getLayer(a),void 0===n&&(n=this.game.world),void 0===o&&(o={}),void 0===o.customClass&&(o.customClass=i.Sprite),void 0===o.adjustY&&(o.adjustY=!0);var r=this.layers[a].width,l=this.layers[a].height;if(this.copy(0,0,r,l,a),this._results.length<2)return 0;for(var h,c=0,p=1,d=this._results.length;p<d;p++)if(-1!==e.indexOf(this._results[p].index)){h=new o.customClass(this.game,this._results[p].worldX,this._results[p].worldY,s);for(var u in o)h[u]=o[u];n.add(h),c++}if(1===t.length)for(p=0;p<e.length;p++)this.replace(e[p],t[0],0,0,r,l,a);else if(t.length>1)for(p=0;p<e.length;p++)this.replace(e[p],t[p],0,0,r,l,a);return c},createLayer:function(e,t,s,a){void 0===t&&(t=this.game.width),void 0===s&&(s=this.game.height),void 0===a&&(a=this.game.world);var n=e;if("string"==typeof e&&(n=this.getLayerIndex(e)),!(null===n||n>this.layers.length)){void 0===t||t<=0?t=Math.min(this.game.width,this.layers[n].widthInPixels):t>this.game.width&&(t=this.game.width),void 0===s||s<=0?s=Math.min(this.game.height,this.layers[n].heightInPixels):s>this.game.height&&(s=this.game.height),this.enableDebug;var o=a.add(new i.TilemapLayer(this.game,this,n,t,s));return this.enableDebug,o}},createBlankLayer:function(e,t,s,a,n,o){if(void 0===o&&(o=this.game.world),null===this.getLayerIndex(e)){for(var r,l={name:e,x:0,y:0,width:t,height:s,widthInPixels:t*a,heightInPixels:s*n,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:null},h=[],c=0;c<s;c++){r=[];for(var p=0;p<t;p++)r.push(new i.Tile(l,-1,p,c,a,n));h.push(r)}l.data=h,this.layers.push(l),this.currentLayer=this.layers.length-1;var d=l.widthInPixels,u=l.heightInPixels;return d>this.game.width&&(d=this.game.width),u>this.game.height&&(u=this.game.height),(h=new i.TilemapLayer(this.game,this,this.layers.length-1,d,u)).name=e,o.add(h)}},getIndex:function(e,t){for(var i=0;i<e.length;i++)if(e[i].name===t)return i;return null},getLayerIndex:function(e){return this.getIndex(this.layers,e)},getTilesetIndex:function(e){return this.getIndex(this.tilesets,e)},getImageIndex:function(e){return this.getIndex(this.images,e)},setTileIndexCallback:function(e,t,i,s){if(s=this.getLayer(s),"number"==typeof e)this.layers[s].callbacks[e]={callback:t,callbackContext:i};else for(var a=0,n=e.length;a<n;a++)this.layers[s].callbacks[e[a]]={callback:t,callbackContext:i}},setTileLocationCallback:function(e,t,i,s,a,n,o){if(o=this.getLayer(o),this.copy(e,t,i,s,o),!(this._results.length<2))for(var r=1;r<this._results.length;r++)this._results[r].setCollisionCallback(a,n)},setCollision:function(e,t,i,s){if(void 0===t&&(t=!0),void 0===s&&(s=!0),i=this.getLayer(i),"number"==typeof e)return this.setCollisionByIndex(e,t,i,!0);if(Array.isArray(e)){for(var a=0;a<e.length;a++)this.setCollisionByIndex(e[a],t,i,!1);s&&this.calculateFaces(i)}},setCollisionBetween:function(e,t,i,s,a){if(void 0===i&&(i=!0),void 0===a&&(a=!0),s=this.getLayer(s),!(e>t)){for(var n=e;n<=t;n++)this.setCollisionByIndex(n,i,s,!1);a&&this.calculateFaces(s)}},setCollisionByExclusion:function(e,t,i,s){void 0===t&&(t=!0),void 0===s&&(s=!0),i=this.getLayer(i);for(var a=0,n=this.tiles.length;a<n;a++)-1===e.indexOf(a)&&this.setCollisionByIndex(a,t,i,!1);s&&this.calculateFaces(i)},setCollisionByIndex:function(e,t,i,s){if(void 0===t&&(t=!0),void 0===i&&(i=this.currentLayer),void 0===s&&(s=!0),t)this.collideIndexes.push(e);else{var a=this.collideIndexes.indexOf(e);a>-1&&this.collideIndexes.splice(a,1)}for(var n=0;n<this.layers[i].height;n++)for(var o=0;o<this.layers[i].width;o++){var r=this.layers[i].data[n][o];r&&r.index===e&&(t?r.setCollision(!0,!0,!0,!0):r.resetCollision(),r.faceTop=t,r.faceBottom=t,r.faceLeft=t,r.faceRight=t)}return s&&this.calculateFaces(i),i},getLayer:function(e){return void 0===e?e=this.currentLayer:"string"==typeof e?e=this.getLayerIndex(e):e instanceof i.TilemapLayer&&(e=e.index),e},setPreventRecalculate:function(e){if(!0===e&&!0!==this.preventingRecalculate&&(this.preventingRecalculate=!0,this.needToRecalculate={}),!1===e&&!0===this.preventingRecalculate){this.preventingRecalculate=!1;for(var t in this.needToRecalculate)this.calculateFaces(t);this.needToRecalculate=!1}},calculateFaces:function(e){if(this.preventingRecalculate)this.needToRecalculate[e]=!0;else for(var t=null,i=null,s=null,a=null,n=0,o=this.layers[e].height;n<o;n++)for(var r=0,l=this.layers[e].width;r<l;r++){var h=this.layers[e].data[n][r];h&&(t=this.getTileAbove(e,r,n),i=this.getTileBelow(e,r,n),s=this.getTileLeft(e,r,n),a=this.getTileRight(e,r,n),h.collides&&(h.faceTop=!0,h.faceBottom=!0,h.faceLeft=!0,h.faceRight=!0),t&&t.collides&&(h.faceTop=!1),i&&i.collides&&(h.faceBottom=!1),s&&s.collides&&(h.faceLeft=!1),a&&a.collides&&(h.faceRight=!1))}},getTileAbove:function(e,t,i){return i>0?this.layers[e].data[i-1][t]:null},getTileBelow:function(e,t,i){return i<this.layers[e].height-1?this.layers[e].data[i+1][t]:null},getTileLeft:function(e,t,i){return t>0?this.layers[e].data[i][t-1]:null},getTileRight:function(e,t,i){return t<this.layers[e].width-1?this.layers[e].data[i][t+1]:null},setLayer:function(e){e=this.getLayer(e),this.layers[e]&&(this.currentLayer=e)},hasTile:function(e,t,i){return i=this.getLayer(i),void 0!==this.layers[i].data[t]&&void 0!==this.layers[i].data[t][e]&&this.layers[i].data[t][e].index>-1},removeTile:function(e,t,s){if(s=this.getLayer(s),e>=0&&e<this.layers[s].width&&t>=0&&t<this.layers[s].height&&this.hasTile(e,t,s)){var a=this.layers[s].data[t][e];return this.layers[s].data[t][e]=new i.Tile(this.layers[s],-1,e,t,this.tileWidth,this.tileHeight),this.layers[s].dirty=!0,this.calculateFaces(s),a}},removeTileWorldXY:function(e,t,i,s,a){return a=this.getLayer(a),e=this.game.math.snapToFloor(e,i)/i,t=this.game.math.snapToFloor(t,s)/s,this.removeTile(e,t,a)},putTile:function(e,t,s,a){if(null===e)return this.removeTile(t,s,a);if(a=this.getLayer(a),t>=0&&t<this.layers[a].width&&s>=0&&s<this.layers[a].height){var n;return e instanceof i.Tile?(n=e.index,this.hasTile(t,s,a)?this.layers[a].data[s][t].copy(e):this.layers[a].data[s][t]=new i.Tile(a,n,t,s,e.width,e.height)):(n=e,this.hasTile(t,s,a)?this.layers[a].data[s][t].index=n:this.layers[a].data[s][t]=new i.Tile(this.layers[a],n,t,s,this.tileWidth,this.tileHeight)),this.collideIndexes.indexOf(n)>-1?this.layers[a].data[s][t].setCollision(!0,!0,!0,!0):this.layers[a].data[s][t].resetCollision(),this.layers[a].dirty=!0,this.calculateFaces(a),this.layers[a].data[s][t]}return null},putTileWorldXY:function(e,t,i,s,a,n){return n=this.getLayer(n),t=this.game.math.snapToFloor(t,s)/s,i=this.game.math.snapToFloor(i,a)/a,this.putTile(e,t,i,n)},searchTileIndex:function(e,t,i,s){void 0===t&&(t=0),void 0===i&&(i=!1),s=this.getLayer(s);var a=0;if(i){for(n=this.layers[s].height-1;n>=0;n--)for(o=this.layers[s].width-1;o>=0;o--)if(this.layers[s].data[n][o].index===e){if(a===t)return this.layers[s].data[n][o];a++}}else for(var n=0;n<this.layers[s].height;n++)for(var o=0;o<this.layers[s].width;o++)if(this.layers[s].data[n][o].index===e){if(a===t)return this.layers[s].data[n][o];a++}return null},getTile:function(e,t,i,s){return void 0===s&&(s=!1),i=this.getLayer(i),e>=0&&e<this.layers[i].width&&t>=0&&t<this.layers[i].height?-1===this.layers[i].data[t][e].index?s?this.layers[i].data[t][e]:null:this.layers[i].data[t][e]:null},getTileWorldXY:function(e,t,i,s,a,n){return void 0===i&&(i=this.tileWidth),void 0===s&&(s=this.tileHeight),a=this.getLayer(a),e=this.game.math.snapToFloor(e,i)/i,t=this.game.math.snapToFloor(t,s)/s,this.getTile(e,t,a,n)},copy:function(e,t,i,s,a){if(a=this.getLayer(a),this.layers[a]){void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=this.layers[a].width),void 0===s&&(s=this.layers[a].height),e<0&&(e=0),t<0&&(t=0),i>this.layers[a].width&&(i=this.layers[a].width),s>this.layers[a].height&&(s=this.layers[a].height),this._results.length=0,this._results.push({x:e,y:t,width:i,height:s,layer:a});for(var n=t;n<t+s;n++)for(var o=e;o<e+i;o++)this._results.push(this.layers[a].data[n][o]);return this._results}this._results.length=0},paste:function(e,t,i,s){if(void 0===e&&(e=0),void 0===t&&(t=0),s=this.getLayer(s),i&&!(i.length<2)){for(var a=e-i[1].x,n=t-i[1].y,o=1;o<i.length;o++)this.layers[s].data[n+i[o].y][a+i[o].x].copy(i[o]);this.layers[s].dirty=!0,this.calculateFaces(s)}},swap:function(e,t,i,s,a,n,o){o=this.getLayer(o),this.copy(i,s,a,n,o),this._results.length<2||(this._tempA=e,this._tempB=t,this._results.forEach(this.swapHandler,this),this.paste(i,s,this._results,o))},swapHandler:function(e){e.index===this._tempA?e.index=this._tempB:e.index===this._tempB&&(e.index=this._tempA)},forEach:function(e,t,i,s,a,n,o){o=this.getLayer(o),this.copy(i,s,a,n,o),this._results.length<2||(this._results.forEach(e,t),this.paste(i,s,this._results,o))},replace:function(e,t,i,s,a,n,o){if(o=this.getLayer(o),this.copy(i,s,a,n,o),!(this._results.length<2)){for(var r=1;r<this._results.length;r++)this._results[r].index===e&&(this._results[r].index=t);this.paste(i,s,this._results,o)}},random:function(e,t,i,s,a){if(a=this.getLayer(a),this.copy(e,t,i,s,a),!(this._results.length<2)){for(var n=[],o=1;o<this._results.length;o++)if(this._results[o].index){var r=this._results[o].index;-1===n.indexOf(r)&&n.push(r)}for(var l=1;l<this._results.length;l++)this._results[l].index=this.game.rnd.pick(n);this.paste(e,t,this._results,a)}},shuffle:function(e,t,s,a,n){if(n=this.getLayer(n),this.copy(e,t,s,a,n),!(this._results.length<2)){for(var o=[],r=1;r<this._results.length;r++)this._results[r].index&&o.push(this._results[r].index);i.ArrayUtils.shuffle(o);for(var l=1;l<this._results.length;l++)this._results[l].index=o[l-1];this.paste(e,t,this._results,n)}},fill:function(e,t,i,s,a,n){if(n=this.getLayer(n),this.copy(t,i,s,a,n),!(this._results.length<2)){for(var o=1;o<this._results.length;o++)this._results[o].index=e;this.paste(t,i,this._results,n)}},removeAllLayers:function(){this.layers.length=0,this.currentLayer=0},dump:function(){for(var e="",t=[""],i=0;i<this.layers[this.currentLayer].height;i++){for(var s=0;s<this.layers[this.currentLayer].width;s++)e+="%c  ",this.layers[this.currentLayer].data[i][s]>1?this.debugMap[this.layers[this.currentLayer].data[i][s]]?t.push("background: "+this.debugMap[this.layers[this.currentLayer].data[i][s]]):t.push("background: #ffffff"):t.push("background: rgb(0, 0, 0)");e+="\n"}t[0]=e},destroy:function(){this.removeAllLayers(),this.data=[],this.game=null}},i.Tilemap.prototype.constructor=i.Tilemap,Object.defineProperty(i.Tilemap.prototype,"layer",{get:function(){return this.layers[this.currentLayer]},set:function(e){e!==this.currentLayer&&this.setLayer(e)}}),i.TilemapLayer=function(e,t,s,a,n){a|=0,n|=0,i.Sprite.call(this,e,0,0),this.map=t,this.index=s,this.layer=t.layers[s],this.canvas=PIXI.CanvasPool.create(this,a,n),this.context=this.canvas.getContext("2d"),this.setTexture(new PIXI.Texture(new PIXI.BaseTexture(this.canvas))),this.type=i.TILEMAPLAYER,this.physicsType=i.TILEMAPLAYER,this.renderSettings={enableScrollDelta:!1,overdrawRatio:.2,copyCanvas:null},this.debug=!1,this.exists=!0,this.debugSettings={missingImageFill:"rgb(255,255,255)",debuggedTileOverfill:"rgba(0,255,0,0.4)",forceFullRedraw:!0,debugAlpha:.5,facingEdgeStroke:"rgba(0,255,0,1)",collidingTileOverfill:"rgba(0,255,0,0.2)"},this.scrollFactorX=1,this.scrollFactorY=1,this.dirty=!0,this.rayStepRate=4,this._wrap=!1,this._mc={scrollX:0,scrollY:0,renderWidth:0,renderHeight:0,tileWidth:t.tileWidth,tileHeight:t.tileHeight,cw:t.tileWidth,ch:t.tileHeight,tilesets:[]},this._scrollX=0,this._scrollY=0,this._results=[],e.device.canvasBitBltShift||(this.renderSettings.copyCanvas=i.TilemapLayer.ensureSharedCopyCanvas()),this.fixedToCamera=!0},i.TilemapLayer.prototype=Object.create(i.Sprite.prototype),i.TilemapLayer.prototype.constructor=i.TilemapLayer,i.TilemapLayer.prototype.preUpdateCore=i.Component.Core.preUpdate,i.TilemapLayer.sharedCopyCanvas=null,i.TilemapLayer.ensureSharedCopyCanvas=function(){return this.sharedCopyCanvas||(this.sharedCopyCanvas=PIXI.CanvasPool.create(this,2,2)),this.sharedCopyCanvas},i.TilemapLayer.prototype.preUpdate=function(){return this.preUpdateCore()},i.TilemapLayer.prototype.postUpdate=function(){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y),this._scrollX=this.game.camera.view.x*this.scrollFactorX/this.scale.x,this._scrollY=this.game.camera.view.y*this.scrollFactorY/this.scale.y},i.TilemapLayer.prototype._renderCanvas=function(e){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y),this._scrollX=this.game.camera.view.x*this.scrollFactorX/this.scale.x,this._scrollY=this.game.camera.view.y*this.scrollFactorY/this.scale.y,this.render(),PIXI.Sprite.prototype._renderCanvas.call(this,e)},i.TilemapLayer.prototype._renderWebGL=function(e){this.fixedToCamera&&(this.position.x=(this.game.camera.view.x+this.cameraOffset.x)/this.game.camera.scale.x,this.position.y=(this.game.camera.view.y+this.cameraOffset.y)/this.game.camera.scale.y),this._scrollX=this.game.camera.view.x*this.scrollFactorX/this.scale.x,this._scrollY=this.game.camera.view.y*this.scrollFactorY/this.scale.y,this.render(),PIXI.Sprite.prototype._renderWebGL.call(this,e)},i.TilemapLayer.prototype.destroy=function(){PIXI.CanvasPool.remove(this),i.Component.Destroy.prototype.destroy.call(this)},i.TilemapLayer.prototype.resize=function(e,t){this.canvas.width=e,this.canvas.height=t,this.texture.frame.resize(e,t),this.texture.width=e,this.texture.height=t,this.texture.crop.width=e,this.texture.crop.height=t,this.texture.baseTexture.width=e,this.texture.baseTexture.height=t,this.texture.baseTexture.dirty(),this.texture.requiresUpdate=!0,this.texture._updateUvs(),this.dirty=!0},i.TilemapLayer.prototype.resizeWorld=function(){this.game.world.setBounds(0,0,this.layer.widthInPixels*this.scale.x,this.layer.heightInPixels*this.scale.y)},i.TilemapLayer.prototype._fixX=function(e){return 1===this.scrollFactorX||0===this.scrollFactorX&&0===this.position.x?e:0===this.scrollFactorX&&0!==this.position.x?e-this.position.x:this._scrollX+(e-this._scrollX/this.scrollFactorX)},i.TilemapLayer.prototype._unfixX=function(e){return 1===this.scrollFactorX?e:this._scrollX/this.scrollFactorX+(e-this._scrollX)},i.TilemapLayer.prototype._fixY=function(e){return 1===this.scrollFactorY||0===this.scrollFactorY&&0===this.position.y?e:0===this.scrollFactorY&&0!==this.position.y?e-this.position.y:this._scrollY+(e-this._scrollY/this.scrollFactorY)},i.TilemapLayer.prototype._unfixY=function(e){return 1===this.scrollFactorY?e:this._scrollY/this.scrollFactorY+(e-this._scrollY)},i.TilemapLayer.prototype.getTileX=function(e){return Math.floor(this._fixX(e)/this._mc.tileWidth)},i.TilemapLayer.prototype.getTileY=function(e){return Math.floor(this._fixY(e)/this._mc.tileHeight)},i.TilemapLayer.prototype.getTileXY=function(e,t,i){return i.x=this.getTileX(e),i.y=this.getTileY(t),i},i.TilemapLayer.prototype.getRayCastTiles=function(e,t,i,s){t||(t=this.rayStepRate),void 0===i&&(i=!1),void 0===s&&(s=!1);var a=this.getTiles(e.x,e.y,e.width,e.height,i,s);if(0===a.length)return[];for(var n=e.coordinatesOnLine(t),o=[],r=0;r<a.length;r++)for(var l=0;l<n.length;l++){var h=a[r],c=n[l];if(h.containsPoint(c[0],c[1])){o.push(h);break}}return o},i.TilemapLayer.prototype.getTiles=function(e,t,i,s,a,n){void 0===a&&(a=!1),void 0===n&&(n=!1);var o=!(a||n);e=this._fixX(e),t=this._fixY(t);for(var r=Math.floor(e/(this._mc.cw*this.scale.x)),l=Math.floor(t/(this._mc.ch*this.scale.y)),h=Math.ceil((e+i)/(this._mc.cw*this.scale.x))-r,c=Math.ceil((t+s)/(this._mc.ch*this.scale.y))-l;this._results.length;)this._results.pop();for(var p=l;p<l+c;p++)for(var d=r;d<r+h;d++){var u=this.layer.data[p];u&&u[d]&&(o||u[d].isInteresting(a,n))&&this._results.push(u[d])}return this._results.slice()},i.TilemapLayer.prototype.resolveTileset=function(e){var t=this._mc.tilesets;if(e<2e3)for(;t.length<e;)t.push(void 0);var i=this.map.tiles[e]&&this.map.tiles[e][2];if(null!==i){var s=this.map.tilesets[i];if(s&&s.containsTileIndex(e))return t[e]=s}return t[e]=null},i.TilemapLayer.prototype.resetTilesetCache=function(){for(var e=this._mc.tilesets;e.length;)e.pop()},i.TilemapLayer.prototype.setScale=function(e,t){e=e||1,t=t||e;for(var i=0;i<this.layer.data.length;i++)for(var s=this.layer.data[i],a=0;a<s.length;a++){var n=s[a];n.width=this.map.tileWidth*e,n.height=this.map.tileHeight*t,n.worldX=n.x*n.width,n.worldY=n.y*n.height}this.scale.setTo(e,t)},i.TilemapLayer.prototype.shiftCanvas=function(e,t,i){var s=e.canvas,a=s.width-Math.abs(t),n=s.height-Math.abs(i),o=0,r=0,l=t,h=i;t<0&&(o=-t,l=0),i<0&&(r=-i,h=0);var c=this.renderSettings.copyCanvas;if(c){(c.width<a||c.height<n)&&(c.width=a,c.height=n);var p=c.getContext("2d");p.clearRect(0,0,a,n),p.drawImage(s,o,r,a,n,0,0,a,n),e.clearRect(l,h,a,n),e.drawImage(c,0,0,a,n,l,h,a,n)}else e.save(),e.globalCompositeOperation="copy",e.drawImage(s,o,r,a,n,l,h,a,n),e.restore()},i.TilemapLayer.prototype.renderRegion=function(e,t,i,s,a,n){var o=this.context,r=this.layer.width,l=this.layer.height,h=this._mc.tileWidth,c=this._mc.tileHeight,p=this._mc.tilesets,d=NaN;this._wrap||(i<=a&&(i=Math.max(0,i),a=Math.min(r-1,a)),s<=n&&(s=Math.max(0,s),n=Math.min(l-1,n)));var u,m,g,y,b,x,v=i*h-e,f=(i+(1<<20)*r)%r;for(y=(s+(1<<20)*l)%l,x=n-s,m=s*c-t;x>=0;y++,x--,m+=c){y>=l&&(y-=l);var w=this.layer.data[y];for(g=f,b=a-i,u=v;b>=0;g++,b--,u+=h){g>=r&&(g-=r);var k=w[g];if(k&&!(k.index<0)){var _=k.index,S=p[_];void 0===S&&(S=this.resolveTileset(_)),k.alpha===d||this.debug||(o.globalAlpha=k.alpha,d=k.alpha),S?k.rotation||k.flipped?(o.save(),o.translate(u+k.centerX,m+k.centerY),o.rotate(k.rotation),k.flipped&&o.scale(-1,1),S.draw(o,-k.centerX,-k.centerY,_),o.restore()):S.draw(o,u,m,_):this.debugSettings.missingImageFill&&(o.fillStyle=this.debugSettings.missingImageFill,o.fillRect(u,m,h,c)),k.debug&&this.debugSettings.debuggedTileOverfill&&(o.fillStyle=this.debugSettings.debuggedTileOverfill,o.fillRect(u,m,h,c))}}}},i.TilemapLayer.prototype.renderDeltaScroll=function(e,t){var i=this._mc.scrollX,s=this._mc.scrollY,a=this.canvas.width,n=this.canvas.height,o=this._mc.tileWidth,r=this._mc.tileHeight,l=0,h=-o,c=0,p=-r;if(e<0?(l=a+e,h=a-1):e>0&&(h=e),t<0?(c=n+t,p=n-1):t>0&&(p=t),this.shiftCanvas(this.context,e,t),l=Math.floor((l+i)/o),h=Math.floor((h+i)/o),c=Math.floor((c+s)/r),p=Math.floor((p+s)/r),l<=h){this.context.clearRect(l*o-i,0,(h-l+1)*o,n);var d=Math.floor((0+s)/r),u=Math.floor((n-1+s)/r);this.renderRegion(i,s,l,d,h,u)}if(c<=p){this.context.clearRect(0,c*r-s,a,(p-c+1)*r);var m=Math.floor((0+i)/o),g=Math.floor((a-1+i)/o);this.renderRegion(i,s,m,c,g,p)}},i.TilemapLayer.prototype.renderFull=function(){var e=this._mc.scrollX,t=this._mc.scrollY,i=this.canvas.width,s=this.canvas.height,a=this._mc.tileWidth,n=this._mc.tileHeight,o=Math.floor(e/a),r=Math.floor((i-1+e)/a),l=Math.floor(t/n),h=Math.floor((s-1+t)/n);this.context.clearRect(0,0,i,s),this.renderRegion(e,t,o,l,r,h)},i.TilemapLayer.prototype.render=function(){var e=!1;if(this.visible){(this.dirty||this.layer.dirty)&&(this.layer.dirty=!1,e=!0);var t=this.canvas.width,i=this.canvas.height,s=0|this._scrollX,a=0|this._scrollY,n=this._mc,o=n.scrollX-s,r=n.scrollY-a;if(e||0!==o||0!==r||n.renderWidth!==t||n.renderHeight!==i)return this.context.save(),n.scrollX=s,n.scrollY=a,n.renderWidth===t&&n.renderHeight===i||(n.renderWidth=t,n.renderHeight=i),this.debug&&(this.context.globalAlpha=this.debugSettings.debugAlpha,this.debugSettings.forceFullRedraw&&(e=!0)),!e&&this.renderSettings.enableScrollDelta&&Math.abs(o)+Math.abs(r)<Math.min(t,i)?this.renderDeltaScroll(o,r):this.renderFull(),this.debug&&(this.context.globalAlpha=1,this.renderDebug()),this.texture.baseTexture.dirty(),this.dirty=!1,this.context.restore(),!0}},i.TilemapLayer.prototype.renderDebug=function(){var e,t,i,s,a,n,o=this._mc.scrollX,r=this._mc.scrollY,l=this.context,h=this.canvas.width,c=this.canvas.height,p=this.layer.width,d=this.layer.height,u=this._mc.tileWidth,m=this._mc.tileHeight,g=Math.floor(o/u),y=Math.floor((h-1+o)/u),b=Math.floor(r/m),x=Math.floor((c-1+r)/m),v=g*u-o,f=b*m-r,w=(g+(1<<20)*p)%p,k=(b+(1<<20)*d)%d;for(l.strokeStyle=this.debugSettings.facingEdgeStroke,s=k,n=x-b,t=f;n>=0;s++,n--,t+=m){s>=d&&(s-=d);var _=this.layer.data[s];for(i=w,a=y-g,e=v;a>=0;i++,a--,e+=u){i>=p&&(i-=p);var S=_[i];!S||S.index<0||!S.collides||(this.debugSettings.collidingTileOverfill&&(l.fillStyle=this.debugSettings.collidingTileOverfill,l.fillRect(e,t,this._mc.cw,this._mc.ch)),this.debugSettings.facingEdgeStroke&&(l.beginPath(),S.faceTop&&(l.moveTo(e,t),l.lineTo(e+this._mc.cw,t)),S.faceBottom&&(l.moveTo(e,t+this._mc.ch),l.lineTo(e+this._mc.cw,t+this._mc.ch)),S.faceLeft&&(l.moveTo(e,t),l.lineTo(e,t+this._mc.ch)),S.faceRight&&(l.moveTo(e+this._mc.cw,t),l.lineTo(e+this._mc.cw,t+this._mc.ch)),l.closePath(),l.stroke()))}}},Object.defineProperty(i.TilemapLayer.prototype,"wrap",{get:function(){return this._wrap},set:function(e){this._wrap=e,this.dirty=!0}}),Object.defineProperty(i.TilemapLayer.prototype,"scrollX",{get:function(){return this._scrollX},set:function(e){this._scrollX=e}}),Object.defineProperty(i.TilemapLayer.prototype,"scrollY",{get:function(){return this._scrollY},set:function(e){this._scrollY=e}}),Object.defineProperty(i.TilemapLayer.prototype,"collisionWidth",{get:function(){return this._mc.cw},set:function(e){this._mc.cw=0|e,this.dirty=!0}}),Object.defineProperty(i.TilemapLayer.prototype,"collisionHeight",{get:function(){return this._mc.ch},set:function(e){this._mc.ch=0|e,this.dirty=!0}}),i.TilemapParser={INSERT_NULL:!1,parse:function(e,t,s,a,n,o){if(void 0===s&&(s=32),void 0===a&&(a=32),void 0===n&&(n=10),void 0===o&&(o=10),void 0===t)return this.getEmptyData();if(null===t)return this.getEmptyData(s,a,n,o);var r=e.cache.getTilemapData(t);if(r){if(r.format===i.Tilemap.CSV)return this.parseCSV(t,r.data,s,a);if(!r.format||r.format===i.Tilemap.TILED_JSON)return this.parseTiledJSON(r.data)}},parseCSV:function(e,t,s,a){for(var n=this.getEmptyData(),o=[],r=(t=t.trim()).split("\n"),l=r.length,h=0,c=0;c<r.length;c++){o[c]=[];for(var p=r[c].split(","),d=0;d<p.length;d++)o[c][d]=new i.Tile(n.layers[0],parseInt(p[d],10),d,c,s,a);0===h&&(h=p.length)}return n.format=i.Tilemap.CSV,n.name=e,n.width=h,n.height=l,n.tileWidth=s,n.tileHeight=a,n.widthInPixels=h*s,n.heightInPixels=l*a,n.layers[0].width=h,n.layers[0].height=l,n.layers[0].widthInPixels=n.widthInPixels,n.layers[0].heightInPixels=n.heightInPixels,n.layers[0].data=o,n},getEmptyData:function(e,t,i,s){return{width:void 0!==i&&null!==i?i:0,height:void 0!==s&&null!==s?s:0,tileWidth:void 0!==e&&null!==e?e:0,tileHeight:void 0!==t&&null!==t?t:0,orientation:"orthogonal",version:"1",properties:{},widthInPixels:0,heightInPixels:0,layers:[{name:"layer",x:0,y:0,width:0,height:0,widthInPixels:0,heightInPixels:0,alpha:1,visible:!0,properties:{},indexes:[],callbacks:[],bodies:[],data:[]}],images:[],objects:{},collision:{},tilesets:[],tiles:[]}},parseTiledJSON:function(e){function t(e,t){var i={};for(var s in t){var a=t[s];void 0!==e[a]&&(i[a]=e[a])}return i}if("orthogonal"!==e.orientation)return null;for(var s={width:e.width,height:e.height,tileWidth:e.tilewidth,tileHeight:e.tileheight,orientation:e.orientation,format:i.Tilemap.TILED_JSON,version:e.version,properties:e.properties,widthInPixels:e.width*e.tilewidth,heightInPixels:e.height*e.tileheight},a=[],n=0;n<e.layers.length;n++)if("tilelayer"===e.layers[n].type){var o=e.layers[n];if(!o.compression&&o.encoding&&"base64"===o.encoding){for(var r=window.atob(o.data),l=r.length,h=new Array(l),c=0;c<l;c+=4)h[c/4]=(r.charCodeAt(c)|r.charCodeAt(c+1)<<8|r.charCodeAt(c+2)<<16|r.charCodeAt(c+3)<<24)>>>0;o.data=h,delete o.encoding}else if(o.compression)continue;I={name:o.name,x:o.x,y:o.y,width:o.width,height:o.height,widthInPixels:o.width*e.tilewidth,heightInPixels:o.height*e.tileheight,alpha:o.opacity,visible:o.visible,properties:{},indexes:[],callbacks:[],bodies:[]};o.properties&&(I.properties=o.properties);for(var p,d,u,m=0,g=[],y=[],b=0,l=o.data.length;b<l;b++){if(p=0,d=!1,C=o.data[b],u=0,C>536870912)switch(C>2147483648&&(C-=2147483648,u+=4),C>1073741824&&(C-=1073741824,u+=2),C>536870912&&(C-=536870912,u+=1),u){case 5:p=Math.PI/2;break;case 6:p=Math.PI;break;case 3:p=3*Math.PI/2;break;case 4:p=0,d=!0;break;case 7:p=Math.PI/2,d=!0;break;case 2:p=Math.PI,d=!0;break;case 1:p=3*Math.PI/2,d=!0}C>0?((V=new i.Tile(I,C,m,y.length,e.tilewidth,e.tileheight)).rotation=p,V.flipped=d,0!==u&&(V.flippedVal=u),g.push(V)):i.TilemapParser.INSERT_NULL?g.push(null):g.push(new i.Tile(I,-1,m,y.length,e.tilewidth,e.tileheight)),++m===o.width&&(y.push(g),m=0,g=[])}I.data=y,a.push(I)}s.layers=a;for(var x=[],n=0;n<e.layers.length;n++)if("imagelayer"===e.layers[n].type){var v=e.layers[n],f={name:v.name,image:v.image,x:v.x,y:v.y,alpha:v.opacity,visible:v.visible,properties:{}};v.properties&&(f.properties=v.properties),x.push(f)}s.images=x;for(var w=[],k=[],_=null,n=0;n<e.tilesets.length;n++){if((L=e.tilesets[n]).image){var S=new i.Tileset(L.name,L.firstgid,L.tilewidth,L.tileheight,L.margin,L.spacing,L.properties);L.tileproperties&&(S.tileProperties=L.tileproperties),S.updateTileData(L.imagewidth,L.imageheight),w.push(S)}else{var M=new i.ImageCollection(L.name,L.firstgid,L.tilewidth,L.tileheight,L.margin,L.spacing,L.properties);for(var A in L.tiles){var f=L.tiles[A].image,C=L.firstgid+parseInt(A,10);M.addImage(C,f)}k.push(M)}_&&(_.lastgid=L.firstgid-1),_=L}s.tilesets=w,s.imagecollections=k;for(var P={},T={},n=0;n<e.layers.length;n++)if("objectgroup"===e.layers[n].type){var X=e.layers[n];P[X.name]=[],T[X.name]=[];for(var Y=0,l=X.objects.length;Y<l;Y++)if(X.objects[Y].gid){B={gid:X.objects[Y].gid,name:X.objects[Y].name,type:X.objects[Y].hasOwnProperty("type")?X.objects[Y].type:"",x:X.objects[Y].x,y:X.objects[Y].y,visible:X.objects[Y].visible,properties:X.objects[Y].properties};X.objects[Y].rotation&&(B.rotation=X.objects[Y].rotation),P[X.name].push(B)}else if(X.objects[Y].polyline){B={name:X.objects[Y].name,type:X.objects[Y].type,x:X.objects[Y].x,y:X.objects[Y].y,width:X.objects[Y].width,height:X.objects[Y].height,visible:X.objects[Y].visible,properties:X.objects[Y].properties};X.objects[Y].rotation&&(B.rotation=X.objects[Y].rotation),B.polyline=[];for(G=0;G<X.objects[Y].polyline.length;G++)B.polyline.push([X.objects[Y].polyline[G].x,X.objects[Y].polyline[G].y]);T[X.name].push(B),P[X.name].push(B)}else if(X.objects[Y].polygon){(B=t(X.objects[Y],["name","type","x","y","visible","rotation","properties"])).polygon=[];for(var G=0;G<X.objects[Y].polygon.length;G++)B.polygon.push([X.objects[Y].polygon[G].x,X.objects[Y].polygon[G].y]);P[X.name].push(B)}else if(X.objects[Y].ellipse){var B=t(X.objects[Y],["name","type","ellipse","x","y","width","height","visible","rotation","properties"]);P[X.name].push(B)}else(B=t(X.objects[Y],["name","type","x","y","width","height","visible","rotation","properties"])).rectangle=!0,P[X.name].push(B)}s.objects=P,s.collision=T,s.tiles=[];for(n=0;n<s.tilesets.length;n++)for(var L=s.tilesets[n],m=L.tileMargin,E=L.tileMargin,R=0,D=0,F=0,b=L.firstgid;b<L.firstgid+L.total&&(s.tiles[b]=[m,E,n],m+=L.tileWidth+L.tileSpacing,++R!==L.total)&&(++D!==L.columns||(m=L.tileMargin,E+=L.tileHeight+L.tileSpacing,D=0,++F!==L.rows));b++);for(var I,V,W,n=0;n<s.layers.length;n++){I=s.layers[n],L=null;for(c=0;c<I.data.length;c++){g=I.data[c];for(var O=0;O<g.length;O++)null===(V=g[O])||V.index<0||(W=s.tiles[V.index][2],(L=s.tilesets[W]).tileProperties&&L.tileProperties[V.index-L.firstgid]&&(V.properties=i.Utils.mixin(L.tileProperties[V.index-L.firstgid],V.properties)))}}return s}},i.Tileset=function(e,t,i,s,a,n,o){(void 0===i||i<=0)&&(i=32),(void 0===s||s<=0)&&(s=32),void 0===a&&(a=0),void 0===n&&(n=0),this.name=e,this.firstgid=0|t,this.tileWidth=0|i,this.tileHeight=0|s,this.tileMargin=0|a,this.tileSpacing=0|n,this.properties=o||{},this.image=null,this.rows=0,this.columns=0,this.total=0,this.drawCoords=[]},i.Tileset.prototype={draw:function(e,t,i,s){var a=s-this.firstgid<<1;a>=0&&a+1<this.drawCoords.length&&e.drawImage(this.image,this.drawCoords[a],this.drawCoords[a+1],this.tileWidth,this.tileHeight,t,i,this.tileWidth,this.tileHeight)},containsTileIndex:function(e){return e>=this.firstgid&&e<this.firstgid+this.total},setImage:function(e){this.image=e,this.updateTileData(e.width,e.height)},setSpacing:function(e,t){this.tileMargin=0|e,this.tileSpacing=0|t,this.image&&this.updateTileData(this.image.width,this.image.height)},updateTileData:function(e,t){var i=(t-2*this.tileMargin+this.tileSpacing)/(this.tileHeight+this.tileSpacing),s=(e-2*this.tileMargin+this.tileSpacing)/(this.tileWidth+this.tileSpacing);i=Math.floor(i),s=Math.floor(s),this.rows&&this.rows!==i||this.columns&&this.columns,this.rows=i,this.columns=s,this.total=i*s,this.drawCoords.length=0;for(var a=this.tileMargin,n=this.tileMargin,o=0;o<this.rows;o++){for(var r=0;r<this.columns;r++)this.drawCoords.push(a),this.drawCoords.push(n),a+=this.tileWidth+this.tileSpacing;a=this.tileMargin,n+=this.tileHeight+this.tileSpacing}}},i.Tileset.prototype.constructor=i.Tileset,i.Particle=function(e,t,s,a,n){i.Sprite.call(this,e,t,s,a,n),this.autoScale=!1,this.scaleData=null,this._s=0,this.autoAlpha=!1,this.alphaData=null,this._a=0},i.Particle.prototype=Object.create(i.Sprite.prototype),i.Particle.prototype.constructor=i.Particle,i.Particle.prototype.update=function(){this.autoScale&&(--this._s?this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y):this.autoScale=!1),this.autoAlpha&&(--this._a?this.alpha=this.alphaData[this._a].v:this.autoAlpha=!1)},i.Particle.prototype.onEmit=function(){},i.Particle.prototype.setAlphaData=function(e){this.alphaData=e,this._a=e.length-1,this.alpha=this.alphaData[this._a].v,this.autoAlpha=!0},i.Particle.prototype.setScaleData=function(e){this.scaleData=e,this._s=e.length-1,this.scale.set(this.scaleData[this._s].x,this.scaleData[this._s].y),this.autoScale=!0},i.Particle.prototype.reset=function(e,t,s){return i.Component.Reset.prototype.reset.call(this,e,t,s),this.alpha=1,this.scale.set(1),this.autoScale=!1,this.autoAlpha=!1,this},i.Particles=function(e){this.game=e,this.emitters={},this.ID=0},i.Particles.prototype={add:function(e){return this.emitters[e.name]=e,e},remove:function(e){delete this.emitters[e.name]},update:function(){for(var e in this.emitters)this.emitters[e].exists&&this.emitters[e].update()}},i.Particles.prototype.constructor=i.Particles,i.Particles.Arcade={},i.Particles.Arcade.Emitter=function(e,t,s,a){this.maxParticles=a||50,i.Group.call(this,e),this.name="emitter"+this.game.particles.ID++,this.type=i.EMITTER,this.physicsType=i.GROUP,this.area=new i.Rectangle(t,s,1,1),this.minParticleSpeed=new i.Point(-100,-100),this.maxParticleSpeed=new i.Point(100,100),this.minParticleScale=1,this.maxParticleScale=1,this.scaleData=null,this.minRotation=-360,this.maxRotation=360,this.minParticleAlpha=1,this.maxParticleAlpha=1,this.alphaData=null,this.gravity=100,this.particleClass=i.Particle,this.particleDrag=new i.Point,this.angularDrag=0,this.frequency=100,this.lifespan=2e3,this.bounce=new i.Point,this.on=!1,this.particleAnchor=new i.Point(.5,.5),this.blendMode=i.blendModes.NORMAL,this.emitX=t,this.emitY=s,this.autoScale=!1,this.autoAlpha=!1,this.particleBringToTop=!1,this.particleSendToBack=!1,this._minParticleScale=new i.Point(1,1),this._maxParticleScale=new i.Point(1,1),this._quantity=0,this._timer=0,this._counter=0,this._flowQuantity=0,this._flowTotal=0,this._explode=!0,this._frames=null},i.Particles.Arcade.Emitter.prototype=Object.create(i.Group.prototype),i.Particles.Arcade.Emitter.prototype.constructor=i.Particles.Arcade.Emitter,i.Particles.Arcade.Emitter.prototype.update=function(){if(this.on&&this.game.time.time>=this._timer)if(this._timer=this.game.time.time+this.frequency*this.game.time.slowMotion,0!==this._flowTotal)if(this._flowQuantity>0){for(e=0;e<this._flowQuantity;e++)if(this.emitParticle()&&(this._counter++,-1!==this._flowTotal&&this._counter>=this._flowTotal)){this.on=!1;break}}else this.emitParticle()&&(this._counter++,-1!==this._flowTotal&&this._counter>=this._flowTotal&&(this.on=!1));else this.emitParticle()&&(this._counter++,this._quantity>0&&this._counter>=this._quantity&&(this.on=!1));for(var e=this.children.length;e--;)this.children[e].exists&&this.children[e].update()},i.Particles.Arcade.Emitter.prototype.makeParticles=function(e,t,i,s,a){void 0===t&&(t=0),void 0===i&&(i=this.maxParticles),void 0===s&&(s=!1),void 0===a&&(a=!1);var n,o=0,r=e,l=t;for(this._frames=t,i>this.maxParticles&&(this.maxParticles=i);o<i;)Array.isArray(e)&&(r=this.game.rnd.pick(e)),Array.isArray(t)&&(l=this.game.rnd.pick(t)),n=new this.particleClass(this.game,0,0,r,l),this.game.physics.arcade.enable(n,!1),s?(n.body.checkCollision.any=!0,n.body.checkCollision.none=!1):n.body.checkCollision.none=!0,n.body.collideWorldBounds=a,n.body.skipQuadTree=!0,n.exists=!1,n.visible=!1,n.anchor.copyFrom(this.particleAnchor),this.add(n),o++;return this},i.Particles.Arcade.Emitter.prototype.kill=function(){return this.on=!1,this.alive=!1,this.exists=!1,this},i.Particles.Arcade.Emitter.prototype.revive=function(){return this.alive=!0,this.exists=!0,this},i.Particles.Arcade.Emitter.prototype.explode=function(e,t){return this._flowTotal=0,this.start(!0,e,0,t,!1),this},i.Particles.Arcade.Emitter.prototype.flow=function(e,t,i,s,a){return void 0!==i&&0!==i||(i=1),void 0===s&&(s=-1),void 0===a&&(a=!0),i>this.maxParticles&&(i=this.maxParticles),this._counter=0,this._flowQuantity=i,this._flowTotal=s,a?(this.start(!0,e,t,i),this._counter+=i,this.on=!0,this._timer=this.game.time.time+t*this.game.time.slowMotion):this.start(!1,e,t,i),this},i.Particles.Arcade.Emitter.prototype.start=function(e,t,i,s,a){if(void 0===e&&(e=!0),void 0===t&&(t=0),void 0!==i&&null!==i||(i=250),void 0===s&&(s=0),void 0===a&&(a=!1),s>this.maxParticles&&(s=this.maxParticles),this.revive(),this.visible=!0,this.lifespan=t,this.frequency=i,e||a)for(var n=0;n<s;n++)this.emitParticle();else this.on=!0,this._quantity=s,this._counter=0,this._timer=this.game.time.time+i*this.game.time.slowMotion;return this},i.Particles.Arcade.Emitter.prototype.emitParticle=function(e,t,i,s){void 0===e&&(e=null),void 0===t&&(t=null);var a=this.getFirstExists(!1);if(null===a)return!1;var n=this.game.rnd;void 0!==i&&void 0!==s?a.loadTexture(i,s):void 0!==i&&a.loadTexture(i);var o=this.emitX,r=this.emitY;null!==e?o=e:this.width>1&&(o=n.between(this.left,this.right)),null!==t?r=t:this.height>1&&(r=n.between(this.top,this.bottom)),a.reset(o,r),a.angle=0,a.lifespan=this.lifespan,this.particleBringToTop?this.bringToTop(a):this.particleSendToBack&&this.sendToBack(a),this.autoScale?a.setScaleData(this.scaleData):1!==this.minParticleScale||1!==this.maxParticleScale?a.scale.set(n.realInRange(this.minParticleScale,this.maxParticleScale)):this._minParticleScale.x===this._maxParticleScale.x&&this._minParticleScale.y===this._maxParticleScale.y||a.scale.set(n.realInRange(this._minParticleScale.x,this._maxParticleScale.x),n.realInRange(this._minParticleScale.y,this._maxParticleScale.y)),void 0===s&&(Array.isArray(this._frames)?a.frame=this.game.rnd.pick(this._frames):a.frame=this._frames),this.autoAlpha?a.setAlphaData(this.alphaData):a.alpha=n.realInRange(this.minParticleAlpha,this.maxParticleAlpha),a.blendMode=this.blendMode;var l=a.body;return l.updateBounds(),l.bounce.copyFrom(this.bounce),l.drag.copyFrom(this.particleDrag),l.velocity.x=n.between(this.minParticleSpeed.x,this.maxParticleSpeed.x),l.velocity.y=n.between(this.minParticleSpeed.y,this.maxParticleSpeed.y),l.angularVelocity=n.between(this.minRotation,this.maxRotation),l.gravity.y=this.gravity,l.angularDrag=this.angularDrag,a.onEmit(),!0},i.Particles.Arcade.Emitter.prototype.destroy=function(){this.game.particles.remove(this),i.Group.prototype.destroy.call(this,!0,!1)},i.Particles.Arcade.Emitter.prototype.setSize=function(e,t){return this.area.width=e,this.area.height=t,this},i.Particles.Arcade.Emitter.prototype.setXSpeed=function(e,t){return e=e||0,t=t||0,this.minParticleSpeed.x=e,this.maxParticleSpeed.x=t,this},i.Particles.Arcade.Emitter.prototype.setYSpeed=function(e,t){return e=e||0,t=t||0,this.minParticleSpeed.y=e,this.maxParticleSpeed.y=t,this},i.Particles.Arcade.Emitter.prototype.setRotation=function(e,t){return e=e||0,t=t||0,this.minRotation=e,this.maxRotation=t,this},i.Particles.Arcade.Emitter.prototype.setAlpha=function(e,t,s,a,n){if(void 0===e&&(e=1),void 0===t&&(t=1),void 0===s&&(s=0),void 0===a&&(a=i.Easing.Linear.None),void 0===n&&(n=!1),this.minParticleAlpha=e,this.maxParticleAlpha=t,this.autoAlpha=!1,s>0&&e!==t){var o={v:e},r=this.game.make.tween(o).to({v:t},s,a);r.yoyo(n),this.alphaData=r.generateData(60),this.alphaData.reverse(),this.autoAlpha=!0}return this},i.Particles.Arcade.Emitter.prototype.setScale=function(e,t,s,a,n,o,r){if(void 0===e&&(e=1),void 0===t&&(t=1),void 0===s&&(s=1),void 0===a&&(a=1),void 0===n&&(n=0),void 0===o&&(o=i.Easing.Linear.None),void 0===r&&(r=!1),this.minParticleScale=1,this.maxParticleScale=1,this._minParticleScale.set(e,s),this._maxParticleScale.set(t,a),this.autoScale=!1,n>0&&(e!==t||s!==a)){var l={x:e,y:s},h=this.game.make.tween(l).to({x:t,y:a},n,o);h.yoyo(r),this.scaleData=h.generateData(60),this.scaleData.reverse(),this.autoScale=!0}return this},i.Particles.Arcade.Emitter.prototype.at=function(e){return e.center?(this.emitX=e.center.x,this.emitY=e.center.y):(this.emitX=e.world.x+e.anchor.x*e.width,this.emitY=e.world.y+e.anchor.y*e.height),this},Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"width",{get:function(){return this.area.width},set:function(e){this.area.width=e}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"height",{get:function(){return this.area.height},set:function(e){this.area.height=e}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"x",{get:function(){return this.emitX},set:function(e){this.emitX=e}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"y",{get:function(){return this.emitY},set:function(e){this.emitY=e}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"left",{get:function(){return Math.floor(this.x-this.area.width/2)}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"right",{get:function(){return Math.floor(this.x+this.area.width/2)}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"top",{get:function(){return Math.floor(this.y-this.area.height/2)}}),Object.defineProperty(i.Particles.Arcade.Emitter.prototype,"bottom",{get:function(){return Math.floor(this.y+this.area.height/2)}}),i.Weapon=function(e,t){i.Plugin.call(this,e,t),this.bullets=null,this.autoExpandBulletsGroup=!1,this.autofire=!1,this.shots=0,this.fireLimit=0,this.fireRate=100,this.fireRateVariance=0,this.fireFrom=new i.Rectangle(0,0,1,1),this.fireAngle=i.ANGLE_UP,this.bulletInheritSpriteSpeed=!1,this.bulletAnimation="",this.bulletFrameRandom=!1,this.bulletFrameCycle=!1,this.bulletWorldWrap=!1,this.bulletWorldWrapPadding=0,this.bulletAngleOffset=0,this.bulletAngleVariance=0,this.bulletSpeed=200,this.bulletSpeedVariance=0,this.bulletLifespan=0,this.bulletKillDistance=0,this.bulletGravity=new i.Point(0,0),this.bulletRotateToVelocity=!1,this.bulletKey="",this.bulletFrame="",this._bulletClass=i.Bullet,this._bulletCollideWorldBounds=!1,this._bulletKillType=i.Weapon.KILL_WORLD_BOUNDS,this._data={customBody:!1,width:0,height:0,offsetX:0,offsetY:0},this.bounds=new i.Rectangle,this.bulletBounds=e.world.bounds,this.bulletFrames=[],this.bulletFrameIndex=0,this.anims={},this.onFire=new i.Signal,this.onKill=new i.Signal,this.onFireLimit=new i.Signal,this.trackedSprite=null,this.trackedPointer=null,this.trackRotation=!1,this.trackOffset=new i.Point,this._nextFire=0,this._rotatedPoint=new i.Point},i.Weapon.prototype=Object.create(i.Plugin.prototype),i.Weapon.prototype.constructor=i.Weapon,i.Weapon.KILL_NEVER=0,i.Weapon.KILL_LIFESPAN=1,i.Weapon.KILL_DISTANCE=2,i.Weapon.KILL_WEAPON_BOUNDS=3,i.Weapon.KILL_CAMERA_BOUNDS=4,i.Weapon.KILL_WORLD_BOUNDS=5,i.Weapon.KILL_STATIC_BOUNDS=6,i.Weapon.prototype.createBullets=function(e,t,s,a){return void 0===e&&(e=1),void 0===a&&(a=this.game.world),this.bullets||(this.bullets=this.game.add.physicsGroup(i.Physics.ARCADE,a),this.bullets.classType=this._bulletClass),0!==e&&(-1===e&&(this.autoExpandBulletsGroup=!0,e=1),this.bullets.createMultiple(e,t,s),this.bullets.setAll("data.bulletManager",this),this.bulletKey=t,this.bulletFrame=s),this},i.Weapon.prototype.forEach=function(e,t){return this.bullets.forEachExists(e,t,arguments),this},i.Weapon.prototype.pauseAll=function(){return this.bullets.setAll("body.enable",!1),this},i.Weapon.prototype.resumeAll=function(){return this.bullets.setAll("body.enable",!0),this},i.Weapon.prototype.killAll=function(){return this.bullets.callAllExists("kill",!0),this.bullets.setAll("body.enable",!0),this},i.Weapon.prototype.resetShots=function(e){return this.shots=0,void 0!==e&&(this.fireLimit=e),this},i.Weapon.prototype.destroy=function(){this.parent.remove(this,!1),this.bullets.destroy(),this.game=null,this.parent=null,this.active=!1,this.visible=!1},i.Weapon.prototype.update=function(){this._bulletKillType===i.Weapon.KILL_WEAPON_BOUNDS&&(this.trackedSprite?(this.trackedSprite.updateTransform(),this.bounds.centerOn(this.trackedSprite.worldPosition.x,this.trackedSprite.worldPosition.y)):this.trackedPointer&&this.bounds.centerOn(this.trackedPointer.worldX,this.trackedPointer.worldY)),this.autofire&&this.fire()},i.Weapon.prototype.trackSprite=function(e,t,i,s){return void 0===t&&(t=0),void 0===i&&(i=0),void 0===s&&(s=!1),this.trackedPointer=null,this.trackedSprite=e,this.trackRotation=s,this.trackOffset.set(t,i),this},i.Weapon.prototype.trackPointer=function(e,t,i){return void 0===e&&(e=this.game.input.activePointer),void 0===t&&(t=0),void 0===i&&(i=0),this.trackedPointer=e,this.trackedSprite=null,this.trackRotation=!1,this.trackOffset.set(t,i),this},i.Weapon.prototype.fire=function(e,t,s){if(this.game.time.now<this._nextFire||this.fireLimit>0&&this.shots===this.fireLimit)return!1;var a=this.bulletSpeed;0!==this.bulletSpeedVariance&&(a+=i.Math.between(-this.bulletSpeedVariance,this.bulletSpeedVariance)),e?this.fireFrom.width>1?this.fireFrom.centerOn(e.x,e.y):(this.fireFrom.x=e.x,this.fireFrom.y=e.y):this.trackedSprite?(this.trackRotation?(this._rotatedPoint.set(this.trackedSprite.world.x+this.trackOffset.x,this.trackedSprite.world.y+this.trackOffset.y),this._rotatedPoint.rotate(this.trackedSprite.world.x,this.trackedSprite.world.y,this.trackedSprite.rotation),this.fireFrom.width>1?this.fireFrom.centerOn(this._rotatedPoint.x,this._rotatedPoint.y):(this.fireFrom.x=this._rotatedPoint.x,this.fireFrom.y=this._rotatedPoint.y)):this.fireFrom.width>1?this.fireFrom.centerOn(this.trackedSprite.world.x+this.trackOffset.x,this.trackedSprite.world.y+this.trackOffset.y):(this.fireFrom.x=this.trackedSprite.world.x+this.trackOffset.x,this.fireFrom.y=this.trackedSprite.world.y+this.trackOffset.y),this.bulletInheritSpriteSpeed&&(a+=this.trackedSprite.body.speed)):this.trackedPointer&&(this.fireFrom.width>1?this.fireFrom.centerOn(this.trackedPointer.world.x+this.trackOffset.x,this.trackedPointer.world.y+this.trackOffset.y):(this.fireFrom.x=this.trackedPointer.world.x+this.trackOffset.x,this.fireFrom.y=this.trackedPointer.world.y+this.trackOffset.y));var n=this.fireFrom.width>1?this.fireFrom.randomX:this.fireFrom.x,o=this.fireFrom.height>1?this.fireFrom.randomY:this.fireFrom.y,r=this.trackRotation?this.trackedSprite.angle:this.fireAngle;void 0!==t&&void 0!==s&&(r=this.game.math.radToDeg(Math.atan2(s-o,t-n))),0!==this.bulletAngleVariance&&(r+=i.Math.between(-this.bulletAngleVariance,this.bulletAngleVariance));var l=0,h=0;0===r||180===r?l=Math.cos(this.game.math.degToRad(r))*a:90===r||270===r?h=Math.sin(this.game.math.degToRad(r))*a:(l=Math.cos(this.game.math.degToRad(r))*a,h=Math.sin(this.game.math.degToRad(r))*a);var c=null;if(this.autoExpandBulletsGroup?(c=this.bullets.getFirstExists(!1,!0,n,o,this.bulletKey,this.bulletFrame),c.data.bulletManager=this):c=this.bullets.getFirstExists(!1),c){if(c.reset(n,o),c.data.fromX=n,c.data.fromY=o,c.data.killType=this.bulletKillType,c.data.killDistance=this.bulletKillDistance,c.data.rotateToVelocity=this.bulletRotateToVelocity,this.bulletKillType===i.Weapon.KILL_LIFESPAN&&(c.lifespan=this.bulletLifespan),c.angle=r+this.bulletAngleOffset,""!==this.bulletAnimation){if(null===c.animations.getAnimation(this.bulletAnimation)){var p=this.anims[this.bulletAnimation];c.animations.add(p.name,p.frames,p.frameRate,p.loop,p.useNumericIndex)}c.animations.play(this.bulletAnimation)}else this.bulletFrameCycle?(c.frame=this.bulletFrames[this.bulletFrameIndex],++this.bulletFrameIndex>=this.bulletFrames.length&&(this.bulletFrameIndex=0)):this.bulletFrameRandom&&(c.frame=this.bulletFrames[Math.floor(Math.random()*this.bulletFrames.length)]);if(c.data.bodyDirty&&(this._data.customBody&&c.body.setSize(this._data.width,this._data.height,this._data.offsetX,this._data.offsetY),c.body.collideWorldBounds=this.bulletCollideWorldBounds,c.data.bodyDirty=!1),c.body.velocity.set(l,h),c.body.gravity.set(this.bulletGravity.x,this.bulletGravity.y),0!==this.bulletSpeedVariance){var d=this.fireRate;(d+=i.Math.between(-this.fireRateVariance,this.fireRateVariance))<0&&(d=0),this._nextFire=this.game.time.now+d}else this._nextFire=this.game.time.now+this.fireRate;this.shots++,this.onFire.dispatch(c,this,a),this.fireLimit>0&&this.shots===this.fireLimit&&this.onFireLimit.dispatch(this,this.fireLimit)}return c},i.Weapon.prototype.fireAtPointer=function(e){return void 0===e&&(e=this.game.input.activePointer),this.fire(null,e.worldX,e.worldY)},i.Weapon.prototype.fireAtSprite=function(e){return this.fire(null,e.world.x,e.world.y)},i.Weapon.prototype.fireAtXY=function(e,t){return this.fire(null,e,t)},i.Weapon.prototype.setBulletBodyOffset=function(e,t,i,s){return void 0===i&&(i=0),void 0===s&&(s=0),this._data.customBody=!0,this._data.width=e,this._data.height=t,this._data.offsetX=i,this._data.offsetY=s,this.bullets.callAll("body.setSize","body",e,t,i,s),this.bullets.setAll("data.bodyDirty",!1),this},i.Weapon.prototype.setBulletFrames=function(e,t,s,a){return void 0===s&&(s=!0),void 0===a&&(a=!1),this.bulletFrames=i.ArrayUtils.numberArray(e,t),this.bulletFrameIndex=0,this.bulletFrameCycle=s,this.bulletFrameRandom=a,this},i.Weapon.prototype.addBulletAnimation=function(e,t,i,s,a){return this.anims[e]={name:e,frames:t,frameRate:i,loop:s,useNumericIndex:a},this.bullets.callAll("animations.add","animations",e,t,i,s,a),this.bulletAnimation=e,this},i.Weapon.prototype.debug=function(e,t,i){void 0===e&&(e=16),void 0===t&&(t=32),void 0===i&&(i=!1),this.game.debug.text("Weapon Plugin",e,t),this.game.debug.text("Bullets Alive: "+this.bullets.total+" - Total: "+this.bullets.length,e,t+24),i&&this.bullets.forEachExists(this.game.debug.body,this.game.debug,"rgba(255, 0, 255, 0.8)")},Object.defineProperty(i.Weapon.prototype,"bulletClass",{get:function(){return this._bulletClass},set:function(e){this._bulletClass=e,this.bullets.classType=this._bulletClass}}),Object.defineProperty(i.Weapon.prototype,"bulletKillType",{get:function(){return this._bulletKillType},set:function(e){switch(e){case i.Weapon.KILL_STATIC_BOUNDS:case i.Weapon.KILL_WEAPON_BOUNDS:this.bulletBounds=this.bounds;break;case i.Weapon.KILL_CAMERA_BOUNDS:this.bulletBounds=this.game.camera.view;break;case i.Weapon.KILL_WORLD_BOUNDS:this.bulletBounds=this.game.world.bounds}this._bulletKillType=e}}),Object.defineProperty(i.Weapon.prototype,"bulletCollideWorldBounds",{get:function(){return this._bulletCollideWorldBounds},set:function(e){this._bulletCollideWorldBounds=e,this.bullets.setAll("body.collideWorldBounds",e),this.bullets.setAll("data.bodyDirty",!1)}}),Object.defineProperty(i.Weapon.prototype,"x",{get:function(){return this.fireFrom.x},set:function(e){this.fireFrom.x=e}}),Object.defineProperty(i.Weapon.prototype,"y",{get:function(){return this.fireFrom.y},set:function(e){this.fireFrom.y=e}}),i.Bullet=function(e,t,s,a,n){i.Sprite.call(this,e,t,s,a,n),this.anchor.set(.5),this.data={bulletManager:null,fromX:0,fromY:0,bodyDirty:!0,rotateToVelocity:!1,killType:0,killDistance:0}},i.Bullet.prototype=Object.create(i.Sprite.prototype),i.Bullet.prototype.constructor=i.Bullet,i.Bullet.prototype.kill=function(){return this.alive=!1,this.exists=!1,this.visible=!1,this.data.bulletManager.onKill.dispatch(this),this},i.Bullet.prototype.update=function(){this.exists&&(this.data.killType>i.Weapon.KILL_LIFESPAN&&(this.data.killType===i.Weapon.KILL_DISTANCE?this.game.physics.arcade.distanceToXY(this,this.data.fromX,this.data.fromY,!0)>this.data.killDistance&&this.kill():this.data.bulletManager.bulletBounds.intersects(this)||this.kill()),this.data.rotateToVelocity&&(this.rotation=Math.atan2(this.body.velocity.y,this.body.velocity.x)),this.data.bulletManager.bulletWorldWrap&&this.game.world.wrap(this,this.data.bulletManager.bulletWorldWrapPadding))},i.Video=function(e,t,s){if(void 0===t&&(t=null),void 0===s&&(s=null),this.game=e,this.key=t,this.width=0,this.height=0,this.type=i.VIDEO,this.disableTextureUpload=!1,this.touchLocked=!1,this.onPlay=new i.Signal,this.onChangeSource=new i.Signal,this.onComplete=new i.Signal,this.onAccess=new i.Signal,this.onError=new i.Signal,this.onTimeout=new i.Signal,this.timeout=15e3,this._timeOutID=null,this.video=null,this.videoStream=null,this.isStreaming=!1,this.retryLimit=20,this.retry=0,this.retryInterval=500,this._retryID=null,this._codeMuted=!1,this._muted=!1,this._codePaused=!1,this._paused=!1,this._pending=!1,this._autoplay=!1,this._endCallback=null,this._playCallback=null,t&&this.game.cache.checkVideoKey(t)){var a=this.game.cache.getVideo(t);a.isBlob?this.createVideoFromBlob(a.data):this.video=a.data,this.width=this.video.videoWidth,this.height=this.video.videoHeight}else s&&this.createVideoFromURL(s,!1);this.video&&!s?(this.baseTexture=new PIXI.BaseTexture(this.video),this.baseTexture.forceLoaded(this.width,this.height)):(this.baseTexture=new PIXI.BaseTexture(i.Cache.DEFAULT.baseTexture.source),this.baseTexture.forceLoaded(this.width,this.height)),this.texture=new PIXI.Texture(this.baseTexture),this.textureFrame=new i.Frame(0,0,0,this.width,this.height,"video"),this.texture.setFrame(this.textureFrame),this.texture.valid=!1,null!==t&&this.video&&(this.texture.valid=this.video.canplay),this.snapshot=null,i.BitmapData&&(this.snapshot=new i.BitmapData(this.game,"",this.width,this.height)),!this.game.device.cocoonJS&&(this.game.device.iOS||this.game.device.android)||window.PhaserGlobal&&window.PhaserGlobal.fakeiOSTouchLock?this.setTouchLock():a&&(a.locked=!1)},i.Video.prototype={connectToMediaStream:function(e,t){return e&&t&&(this.video=e,this.videoStream=t,this.isStreaming=!0,this.baseTexture.source=this.video,this.updateTexture(null,this.video.videoWidth,this.video.videoHeight),this.onAccess.dispatch(this)),this},startMediaStream:function(e,t,i){if(void 0===e&&(e=!1),void 0===t&&(t=null),void 0===i&&(i=null),!this.game.device.getUserMedia)return this.onError.dispatch(this,"No getUserMedia"),!1;null!==this.videoStream&&(this.videoStream.active?this.videoStream.active=!1:this.videoStream.stop()),this.removeVideoElement(),this.video=document.createElement("video"),this.video.setAttribute("autoplay","autoplay"),null!==t&&(this.video.width=t),null!==i&&(this.video.height=i),this._timeOutID=window.setTimeout(this.getUserMediaTimeout.bind(this),this.timeout);try{navigator.getUserMedia({audio:e,video:!0},this.getUserMediaSuccess.bind(this),this.getUserMediaError.bind(this))}catch(e){this.getUserMediaError(e)}return this},getUserMediaTimeout:function(){clearTimeout(this._timeOutID),this.onTimeout.dispatch(this)},getUserMediaError:function(e){clearTimeout(this._timeOutID),this.onError.dispatch(this,e)},getUserMediaSuccess:function(e){clearTimeout(this._timeOutID),this.videoStream=e,void 0!==this.video.mozSrcObject?this.video.mozSrcObject=e:this.video.src=window.URL&&window.URL.createObjectURL(e)||e;var t=this;this.video.onloadeddata=function(){function e(){if(i>0)if(t.video.videoWidth>0){var s=t.video.videoWidth,a=t.video.videoHeight;isNaN(t.video.videoHeight)&&(a=s/(4/3)),t.video.play(),t.isStreaming=!0,t.baseTexture.source=t.video,t.updateTexture(null,s,a),t.onAccess.dispatch(t)}else window.setTimeout(e,500);i--}var i=10;e()}},createVideoFromBlob:function(e){var t=this;return this.video=document.createElement("video"),this.video.controls=!1,this.video.setAttribute("autoplay","autoplay"),this.video.addEventListener("loadeddata",function(e){t.updateTexture(e)},!0),this.video.src=window.URL.createObjectURL(e),this.video.canplay=!0,this},createVideoFromURL:function(e,t){return void 0===t&&(t=!1),this.texture&&(this.texture.valid=!1),this.video=document.createElement("video"),this.video.controls=!1,t&&this.video.setAttribute("autoplay","autoplay"),this.video.src=e,this.video.canplay=!0,this.video.load(),this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval),this.key=e,this},updateTexture:function(e,t,i){var s=!1;void 0!==t&&null!==t||(t=this.video.videoWidth,s=!0),void 0!==i&&null!==i||(i=this.video.videoHeight),this.width=t,this.height=i,this.baseTexture.source!==this.video&&(this.baseTexture.source=this.video),this.baseTexture.forceLoaded(t,i),this.texture.frame.resize(t,i),this.texture.width=t,this.texture.height=i,this.texture.valid=!0,this.snapshot&&this.snapshot.resize(t,i),s&&null!==this.key&&(this.onChangeSource.dispatch(this,t,i),this._autoplay&&(this.video.play(),this.onPlay.dispatch(this,this.loop,this.playbackRate)))},complete:function(){this.onComplete.dispatch(this)},play:function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=1),this.game.sound.onMute&&(this.game.sound.onMute.add(this.setMute,this),this.game.sound.onUnMute.add(this.unsetMute,this),this.game.sound.mute&&this.setMute()),this.game.onPause.add(this.setPause,this),this.game.onResume.add(this.setResume,this),this._endCallback=this.complete.bind(this),this.video.addEventListener("ended",this._endCallback,!0),this.video.addEventListener("webkitendfullscreen",this._endCallback,!0),this.video.loop=e?"loop":"",this.video.playbackRate=t,this.touchLocked?this._pending=!0:(this._pending=!1,null!==this.key&&(4!==this.video.readyState?(this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval)):(this._playCallback=this.playHandler.bind(this),this.video.addEventListener("playing",this._playCallback,!0))),this.video.play(),this.onPlay.dispatch(this,e,t)),this},playHandler:function(){this.video.removeEventListener("playing",this._playCallback,!0),this.updateTexture()},stop:function(){return this.game.sound.onMute&&(this.game.sound.onMute.remove(this.setMute,this),this.game.sound.onUnMute.remove(this.unsetMute,this)),this.game.onPause.remove(this.setPause,this),this.game.onResume.remove(this.setResume,this),this.isStreaming?(this.video.mozSrcObject?(this.video.mozSrcObject.stop(),this.video.src=null):(this.video.src="",this.videoStream.active?this.videoStream.active=!1:this.videoStream.getTracks?this.videoStream.getTracks().forEach(function(e){e.stop()}):this.videoStream.stop()),this.videoStream=null,this.isStreaming=!1):(this.video.removeEventListener("ended",this._endCallback,!0),this.video.removeEventListener("webkitendfullscreen",this._endCallback,!0),this.video.removeEventListener("playing",this._playCallback,!0),this.touchLocked?this._pending=!1:this.video.pause()),this},add:function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)e[t].loadTexture&&e[t].loadTexture(this);else e.loadTexture(this);return this},addToWorld:function(e,t,i,s,a,n){a=a||1,n=n||1;var o=this.game.add.image(e,t,this);return o.anchor.set(i,s),o.scale.set(a,n),o},render:function(){!this.disableTextureUpload&&this.playing&&this.baseTexture.dirty()},setMute:function(){this._muted||(this._muted=!0,this.video.muted=!0)},unsetMute:function(){this._muted&&!this._codeMuted&&(this._muted=!1,this.video.muted=!1)},setPause:function(){this._paused||this.touchLocked||(this._paused=!0,this.video.pause())},setResume:function(){!this._paused||this._codePaused||this.touchLocked||(this._paused=!1,this.video.ended||this.video.play())},changeSource:function(e,t){return void 0===t&&(t=!0),this.texture.valid=!1,this.video.pause(),this.retry=this.retryLimit,this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval),this.video.src=e,this.video.load(),this._autoplay=t,t||(this.paused=!0),this},checkVideoProgress:function(){4===this.video.readyState?this.updateTexture():--this.retry>0&&(this._retryID=window.setTimeout(this.checkVideoProgress.bind(this),this.retryInterval))},setTouchLock:function(){this.game.input.touch.addTouchLockCallback(this.unlock,this),this.touchLocked=!0},unlock:function(){if(this.touchLocked=!1,this.video.play(),this.onPlay.dispatch(this,this.loop,this.playbackRate),this.key){var e=this.game.cache.getVideo(this.key);e&&!e.isBlob&&(e.locked=!1)}return!0},grab:function(e,t,i){return void 0===e&&(e=!1),void 0===t&&(t=1),void 0===i&&(i=null),null===this.snapshot?void 0:(e&&this.snapshot.cls(),this.snapshot.copy(this.video,0,0,this.width,this.height,0,0,this.width,this.height,0,0,0,1,1,t,i),this.snapshot)},removeVideoElement:function(){if(this.video){for(this.video.parentNode&&this.video.parentNode.removeChild(this.video);this.video.hasChildNodes();)this.video.removeChild(this.video.firstChild);this.video.removeAttribute("autoplay"),this.video.removeAttribute("src"),this.video=null}},destroy:function(){this.stop(),this.removeVideoElement(),this.touchLocked&&this.game.input.touch.removeTouchLockCallback(this.unlock,this),this._retryID&&window.clearTimeout(this._retryID)}},Object.defineProperty(i.Video.prototype,"currentTime",{get:function(){return this.video?this.video.currentTime:0},set:function(e){this.video.currentTime=e}}),Object.defineProperty(i.Video.prototype,"duration",{get:function(){return this.video?this.video.duration:0}}),Object.defineProperty(i.Video.prototype,"progress",{get:function(){return this.video?this.video.currentTime/this.video.duration:0}}),Object.defineProperty(i.Video.prototype,"mute",{get:function(){return this._muted},set:function(e){if(e=e||null){if(this._muted)return;this._codeMuted=!0,this.setMute()}else{if(!this._muted)return;this._codeMuted=!1,this.unsetMute()}}}),Object.defineProperty(i.Video.prototype,"paused",{get:function(){return this._paused},set:function(e){if(e=e||null,!this.touchLocked)if(e){if(this._paused)return;this._codePaused=!0,this.setPause()}else{if(!this._paused)return;this._codePaused=!1,this.setResume()}}}),Object.defineProperty(i.Video.prototype,"volume",{get:function(){return this.video?this.video.volume:1},set:function(e){e<0?e=0:e>1&&(e=1),this.video&&(this.video.volume=e)}}),Object.defineProperty(i.Video.prototype,"playbackRate",{get:function(){return this.video?this.video.playbackRate:1},set:function(e){this.video&&(this.video.playbackRate=e)}}),Object.defineProperty(i.Video.prototype,"loop",{get:function(){return!!this.video&&this.video.loop},set:function(e){e&&this.video?this.video.loop="loop":this.video&&(this.video.loop="")}}),Object.defineProperty(i.Video.prototype,"playing",{get:function(){return!(this.video.paused&&this.video.ended)}}),i.Video.prototype.constructor=i.Video,void 0===PIXI.blendModes&&(PIXI.blendModes=i.blendModes),void 0===PIXI.scaleModes&&(PIXI.scaleModes=i.scaleModes),void 0===PIXI.Texture.emptyTexture&&(PIXI.Texture.emptyTexture=new PIXI.Texture(new PIXI.BaseTexture)),void 0===PIXI.DisplayObject._tempMatrix&&(PIXI.DisplayObject._tempMatrix=new PIXI.Matrix),void 0===PIXI.RenderTexture.tempMatrix&&(PIXI.RenderTexture.tempMatrix=new PIXI.Matrix),PIXI.Graphics&&void 0===PIXI.Graphics.POLY&&(PIXI.Graphics.POLY=i.POLYGON,PIXI.Graphics.RECT=i.RECTANGLE,PIXI.Graphics.CIRC=i.CIRCLE,PIXI.Graphics.ELIP=i.ELLIPSE,PIXI.Graphics.RREC=i.ROUNDEDRECTANGLE),PIXI.TextureSilentFail=!0,"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=i),exports.Phaser=i):"undefined"!=typeof define&&define.amd?define("Phaser",t.Phaser=i):t.Phaser=i,i}.call(this);var COMPILED=!1,goog=goog||{};goog.global=this,goog.global.CLOSURE_UNCOMPILED_DEFINES,goog.global.CLOSURE_DEFINES,goog.isDef=function(e){return void 0!==e},goog.exportPath_=function(e,t,i){var s=e.split("."),a=i||goog.global;s[0]in a||!a.execScript||a.execScript("var "+s[0]);for(var n;s.length&&(n=s.shift());)!s.length&&goog.isDef(t)?a[n]=t:a=a[n]?a[n]:a[n]={}},goog.define=function(e,t){var i=t;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,e)?i=goog.global.CLOSURE_UNCOMPILED_DEFINES[e]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,e)&&(i=goog.global.CLOSURE_DEFINES[e])),goog.exportPath_(e,i)},goog.DEBUG=!0,goog.define("goog.LOCALE","en"),goog.define("goog.TRUSTED_SITE",!0),goog.define("goog.STRICT_MODE_COMPATIBLE",!1),goog.provide=function(e){if(!COMPILED){if(goog.isProvided_(e))throw Error('Namespace "'+e+'" already declared.');delete goog.implicitNamespaces_[e];for(var t=e;(t=t.substring(0,t.lastIndexOf(".")))&&!goog.getObjectByName(t);)goog.implicitNamespaces_[t]=!0}goog.exportPath_(e)},goog.setTestOnly=function(e){if(COMPILED&&!goog.DEBUG)throw e=e||"",Error("Importing test-only code into non-debug environment"+(e?": "+e:"."))},goog.forwardDeclare=function(){},COMPILED||(goog.isProvided_=function(e){return!goog.implicitNamespaces_[e]&&goog.isDefAndNotNull(goog.getObjectByName(e))},goog.implicitNamespaces_={}),goog.getObjectByName=function(e,t){for(var i,s=e.split("."),a=t||goog.global;i=s.shift();){if(!goog.isDefAndNotNull(a[i]))return null;a=a[i]}return a},goog.globalize=function(e,t){var i=t||goog.global;for(var s in e)i[s]=e[s]},goog.addDependency=function(e,t,i){if(goog.DEPENDENCIES_ENABLED){for(var s,a,n=e.replace(/\\/g,"/"),o=goog.dependencies_,r=0;s=t[r];r++)o.nameToPath[s]=n,n in o.pathToNames||(o.pathToNames[n]={}),o.pathToNames[n][s]=!0;for(var l=0;a=i[l];l++)n in o.requires||(o.requires[n]={}),o.requires[n][a]=!0}},goog.define("goog.ENABLE_DEBUG_LOADER",!0),goog.require=function(e){if(!COMPILED){if(goog.isProvided_(e))return;if(goog.ENABLE_DEBUG_LOADER){var t=goog.getPathFromDeps_(e);if(t)return goog.included_[t]=!0,void goog.writeScripts_()}var i="goog.require could not find: "+e;throw goog.global.console&&goog.global.console.error(i),Error(i)}},goog.basePath="",goog.global.CLOSURE_BASE_PATH,goog.global.CLOSURE_NO_DEPS,goog.global.CLOSURE_IMPORT_SCRIPT,goog.nullFunction=function(){},goog.identityFunction=function(e){return e},goog.abstractMethod=function(){throw Error("unimplemented abstract method")},goog.addSingletonGetter=function(e){e.getInstance=function(){return e.instance_?e.instance_:(goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=e),e.instance_=new e)}},goog.instantiatedSingletons_=[],goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER,goog.DEPENDENCIES_ENABLED&&(goog.included_={},goog.dependencies_={pathToNames:{},nameToPath:{},requires:{},visited:{},written:{}},goog.inHtmlDocument_=function(){var e=goog.global.document;return void 0!==e&&"write"in e},goog.findBasePath_=function(){if(goog.global.CLOSURE_BASE_PATH)goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var e=goog.global.document,t=e.getElementsByTagName("script"),i=t.length-1;i>=0;--i){var s=t[i].src,a=s.lastIndexOf("?"),n=-1==a?s.length:a;if("base.js"==s.substr(n-7,7))return void(goog.basePath=s.substr(0,n-7))}},goog.importScript_=function(e){var t=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_;!goog.dependencies_.written[e]&&t(e)&&(goog.dependencies_.written[e]=!0)},goog.writeScriptTag_=function(e){if(goog.inHtmlDocument_()){var t=goog.global.document;if("complete"==t.readyState){if(/\bdeps.js$/.test(e))return!1;throw Error('Cannot write "'+e+'" after document load')}return t.write('<script type="text/javascript" src="'+e+'"><\/script>'),!0}return!1},goog.writeScripts_=function(){function e(a){if(!(a in s.written)){if(a in s.visited)return void(a in i||(i[a]=!0,t.push(a)));if(s.visited[a]=!0,a in s.requires)for(var n in s.requires[a])if(!goog.isProvided_(n)){if(!(n in s.nameToPath))throw Error("Undefined nameToPath for "+n);e(s.nameToPath[n])}a in i||(i[a]=!0,t.push(a))}}var t=[],i={},s=goog.dependencies_;for(var a in goog.included_)s.written[a]||e(a);for(var n=0;n<t.length;n++){if(!t[n])throw Error("Undefined script input");goog.importScript_(goog.basePath+t[n])}},goog.getPathFromDeps_=function(e){return e in goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[e]:null},goog.findBasePath_()),goog.typeOf=function(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array";if(e instanceof Object)return t;var i=Object.prototype.toString.call(e);if("[object Window]"==i)return"object";if("[object Array]"==i||"number"==typeof e.length&&void 0!==e.splice&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("splice"))return"array";if("[object Function]"==i||void 0!==e.call&&void 0!==e.propertyIsEnumerable&&!e.propertyIsEnumerable("call"))return"function"}else if("function"==t&&void 0===e.call)return"object";return t},goog.isNull=function(e){return null===e},goog.isDefAndNotNull=function(e){return null!=e},goog.isArray=function(e){return"array"==goog.typeOf(e)},goog.isArrayLike=function(e){var t=goog.typeOf(e);return"array"==t||"object"==t&&"number"==typeof e.length},goog.isDateLike=function(e){return goog.isObject(e)&&"function"==typeof e.getFullYear},goog.isString=function(e){return"string"==typeof e},goog.isBoolean=function(e){return"boolean"==typeof e},goog.isNumber=function(e){return"number"==typeof e},goog.isFunction=function(e){return"function"==goog.typeOf(e)},goog.isObject=function(e){var t=typeof e;return"object"==t&&null!=e||"function"==t},goog.getUid=function(e){return e[goog.UID_PROPERTY_]||(e[goog.UID_PROPERTY_]=++goog.uidCounter_)},goog.hasUid=function(e){return!!e[goog.UID_PROPERTY_]},goog.removeUid=function(e){"removeAttribute"in e&&e.removeAttribute(goog.UID_PROPERTY_);try{delete e[goog.UID_PROPERTY_]}catch(e){}},goog.UID_PROPERTY_="closure_uid_"+(1e9*Math.random()>>>0),goog.uidCounter_=0,goog.getHashCode=goog.getUid,goog.removeHashCode=goog.removeUid,goog.cloneObject=function(e){var t=goog.typeOf(e);if("object"==t||"array"==t){if(e.clone)return e.clone();var i="array"==t?[]:{};for(var s in e)i[s]=goog.cloneObject(e[s]);return i}return e},goog.bindNative_=function(e){return e.call.apply(e.bind,arguments)},goog.bindJs_=function(e,t){if(!e)throw new Error;if(arguments.length>2){var i=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,i),e.apply(t,s)}}return function(){return e.apply(t,arguments)}},goog.bind=function(){return goog.bind=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bindNative_:goog.bindJs_,goog.bind.apply(null,arguments)},goog.partial=function(e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),e.apply(this,i)}},goog.mixin=function(e,t){for(var i in t)e[i]=t[i]},goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date},goog.globalEval=function(e){if(goog.global.execScript)goog.global.execScript(e,"JavaScript");else{if(!goog.global.eval)throw Error("goog.globalEval not available");if(null==goog.evalWorksForGlobals_&&(goog.global.eval("var _et_ = 1;"),void 0!==goog.global._et_?(delete goog.global._et_,goog.evalWorksForGlobals_=!0):goog.evalWorksForGlobals_=!1),goog.evalWorksForGlobals_)goog.global.eval(e);else{var t=goog.global.document,i=t.createElement("script");i.type="text/javascript",i.defer=!1,i.appendChild(t.createTextNode(e)),t.body.appendChild(i),t.body.removeChild(i)}}},goog.evalWorksForGlobals_=null,goog.cssNameMapping_,goog.cssNameMappingStyle_,goog.getCssName=function(e,t){var i,s=function(e){return goog.cssNameMapping_[e]||e};return i=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?s:function(e){for(var t=e.split("-"),i=[],a=0;a<t.length;a++)i.push(s(t[a]));return i.join("-")}:function(e){return e},t?e+"-"+i(t):i(e)},goog.setCssNameMapping=function(e,t){goog.cssNameMapping_=e,goog.cssNameMappingStyle_=t},goog.global.CLOSURE_CSS_NAME_MAPPING,!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING),goog.getMsg=function(e,t){return t&&(e=e.replace(/\{\$([^}]+)}/g,function(e,i){return i in t?t[i]:e})),e},goog.getMsgWithFallback=function(e){return e},goog.exportSymbol=function(e,t,i){goog.exportPath_(e,t,i)},goog.exportProperty=function(e,t,i){e[t]=i},goog.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.superClass_=t.prototype,e.prototype=new i,e.prototype.constructor=e,e.base=function(e,i){var s=Array.prototype.slice.call(arguments,2);return t.prototype[i].apply(e,s)}},goog.base=function(e,t){var i=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!i)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(i.superClass_)return i.superClass_.constructor.apply(e,Array.prototype.slice.call(arguments,1));for(var s=Array.prototype.slice.call(arguments,2),a=!1,n=e.constructor;n;n=n.superClass_&&n.superClass_.constructor)if(n.prototype[t]===i)a=!0;else if(a)return n.prototype[t].apply(e,s);if(e[t]===i)return e.constructor.prototype[t].apply(e,s);throw Error("goog.base called from a method of one name to a method of a different name")},goog.scope=function(e){e.call(goog.global)},COMPILED||(goog.global.COMPILED=COMPILED),goog.defineClass=function(e,t){var i=t.constructor,s=t.statics;i&&i!=Object.prototype.constructor||(i=function(){throw Error("cannot instantiate an interface (no constructor defined).")});var a=goog.defineClass.createSealingConstructor_(i,e);return e&&goog.inherits(a,e),delete t.constructor,delete t.statics,goog.defineClass.applyProperties_(a.prototype,t),null!=s&&(s instanceof Function?s(a):goog.defineClass.applyProperties_(a,s)),a},goog.defineClass.ClassDescriptor,goog.define("goog.defineClass.SEAL_CLASS_INSTANCES",goog.DEBUG),goog.defineClass.createSealingConstructor_=function(e,t){if(goog.defineClass.SEAL_CLASS_INSTANCES&&Object.seal instanceof Function){if(t&&t.prototype&&t.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_])return e;var i=function(){var t=e.apply(this,arguments)||this;return this.constructor===i&&Object.seal(t),t};return i}return e},goog.defineClass.OBJECT_PROTOTYPE_FIELDS_=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],goog.defineClass.applyProperties_=function(e,t){var i;for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);for(var s=0;s<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;s++)i=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[s],Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},goog.tagUnsealableClass=function(e){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(e.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)},goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable",goog.provide("box2d.b2Settings"),Object.defineProperty||(Object.defineProperty=function(e,t,i){Object.__defineGetter__&&("get"in i?e.__defineGetter__(t,i.get):"value"in i&&e.__defineGetter__(t,i.value)),Object.__defineSetter__&&("set"in i?e.__defineSetter__(t,i.set):"value"in i&&e.__defineSetter__(t,i.value))}),box2d.DEBUG=!1,box2d.ENABLE_ASSERTS=box2d.DEBUG,box2d.b2Assert=function(e){box2d.DEBUG},box2d.b2_maxFloat=1e37,box2d.b2_epsilon=1e-5,box2d.b2_epsilon_sq=box2d.b2_epsilon*box2d.b2_epsilon,box2d.b2_pi=Math.PI,box2d.b2_maxManifoldPoints=2,box2d.b2_maxPolygonVertices=8,box2d.b2_aabbExtension=.1,box2d.b2_aabbMultiplier=2,box2d.b2_linearSlop=.008,box2d.b2_angularSlop=2/180*box2d.b2_pi,box2d.b2_polygonRadius=2*box2d.b2_linearSlop,box2d.b2_maxSubSteps=8,box2d.b2_maxTOIContacts=32,box2d.b2_velocityThreshold=1,box2d.b2_maxLinearCorrection=.2,box2d.b2_maxAngularCorrection=8/180*box2d.b2_pi,box2d.b2_maxTranslation=2,box2d.b2_maxTranslationSquared=box2d.b2_maxTranslation*box2d.b2_maxTranslation,box2d.b2_maxRotation=.5*box2d.b2_pi,box2d.b2_maxRotationSquared=box2d.b2_maxRotation*box2d.b2_maxRotation,box2d.b2_baumgarte=.2,box2d.b2_toiBaumgarte=.75,box2d.b2_timeToSleep=.5,box2d.b2_linearSleepTolerance=.01,box2d.b2_angularSleepTolerance=2/180*box2d.b2_pi,box2d.b2Alloc=function(){return null},box2d.b2Free=function(){},box2d.b2Log=function(){goog.global.console.log.apply(null,arguments)},box2d.b2Version=function(e,t,i){this.major=e||0,this.minor=t||0,this.revision=i||0},box2d.b2Version.prototype.major=0,box2d.b2Version.prototype.minor=0,box2d.b2Version.prototype.revision=0,box2d.b2Version.prototype.toString=function(){return this.major+"."+this.minor+"."+this.revision},box2d.b2_version=new box2d.b2Version(2,3,0),box2d.b2_changelist=278,box2d.b2ParseInt=function(e){return parseInt(e,10)},box2d.b2ParseUInt=function(e){return box2d.b2Abs(parseInt(e,10))},box2d.b2MakeArray=function(e,t){void 0===e&&(e=0);var i=new Array(e);if(void 0!==t)for(var s=0;e>s;++s)i[s]=t(s);return i},box2d.b2MakeNumberArray=function(e){return box2d.b2MakeArray(e,function(){return 0})},goog.provide("box2d.b2Math"),goog.require("box2d.b2Settings"),box2d.b2_pi_over_180=box2d.b2_pi/180,box2d.b2_180_over_pi=180/box2d.b2_pi,box2d.b2_two_pi=2*box2d.b2_pi,box2d.b2Abs=function(e){return 0>e?-e:e},box2d.b2Min=function(e,t){return t>e?e:t},box2d.b2Max=function(e,t){return e>t?e:t},box2d.b2Clamp=function(e,t,i){return t>e?t:e>i?i:e},box2d.b2Swap=function(e,t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);var i=e[0];e[0]=t[0],t[0]=i},box2d.b2IsValid=function(e){return isFinite(e)},box2d.b2Sq=function(e){return e*e},box2d.b2InvSqrt=function(e){return 1/Math.sqrt(e)},box2d.b2Sqrt=function(e){return Math.sqrt(e)},box2d.b2Pow=function(e,t){return Math.pow(e,t)},box2d.b2DegToRad=function(e){return e*box2d.b2_pi_over_180},box2d.b2RadToDeg=function(e){return e*box2d.b2_180_over_pi},box2d.b2Cos=function(e){return Math.cos(e)},box2d.b2Sin=function(e){return Math.sin(e)},box2d.b2Acos=function(e){return Math.acos(e)},box2d.b2Asin=function(e){return Math.asin(e)},box2d.b2Atan2=function(e,t){return Math.atan2(e,t)},box2d.b2NextPowerOfTwo=function(e){return e|=e>>1&2147483647,e|=e>>2&1073741823,e|=e>>4&268435455,e|=e>>8&16777215,(e|=e>>16&65535)+1},box2d.b2IsPowerOfTwo=function(e){return e>0&&0==(e&e-1)},box2d.b2Random=function(){return 2*Math.random()-1},box2d.b2RandomRange=function(e,t){return(t-e)*Math.random()+e},box2d.b2Vec2=function(e,t){this.x=e||0,this.y=t||0},box2d.b2Vec2.prototype.x=0,box2d.b2Vec2.prototype.y=0,box2d.b2Vec2_zero=new box2d.b2Vec2,box2d.b2Vec2.ZERO=new box2d.b2Vec2,box2d.b2Vec2.UNITX=new box2d.b2Vec2(1,0),box2d.b2Vec2.UNITY=new box2d.b2Vec2(0,1),box2d.b2Vec2.s_t0=new box2d.b2Vec2,box2d.b2Vec2.s_t1=new box2d.b2Vec2,box2d.b2Vec2.s_t2=new box2d.b2Vec2,box2d.b2Vec2.s_t3=new box2d.b2Vec2,box2d.b2Vec2.MakeArray=function(e){return box2d.b2MakeArray(e,function(){return new box2d.b2Vec2})},box2d.b2Vec2.prototype.Clone=function(){return new box2d.b2Vec2(this.x,this.y)},box2d.b2Vec2.prototype.SetZero=function(){return this.x=0,this.y=0,this},box2d.b2Vec2.prototype.SetXY=function(e,t){return this.x=e,this.y=t,this},box2d.b2Vec2.prototype.Copy=function(e){return this.x=e.x,this.y=e.y,this},box2d.b2Vec2.prototype.SelfAdd=function(e){return this.x+=e.x,this.y+=e.y,this},box2d.b2Vec2.prototype.SelfAddXY=function(e,t){return this.x+=e,this.y+=t,this},box2d.b2Vec2.prototype.SelfSub=function(e){return this.x-=e.x,this.y-=e.y,this},box2d.b2Vec2.prototype.SelfSubXY=function(e,t){return this.x-=e,this.y-=t,this},box2d.b2Vec2.prototype.SelfMul=function(e){return this.x*=e,this.y*=e,this},box2d.b2Vec2.prototype.SelfMulAdd=function(e,t){return this.x+=e*t.x,this.y+=e*t.y,this},box2d.b2Vec2.prototype.SelfMulSub=function(e,t){return this.x-=e*t.x,this.y-=e*t.y,this},box2d.b2Vec2.prototype.Dot=function(e){return this.x*e.x+this.y*e.y},box2d.b2Vec2.prototype.Cross=function(e){return this.x*e.y-this.y*e.x},box2d.b2Vec2.prototype.Length=function(){var e=this.x,t=this.y;return Math.sqrt(e*e+t*t)},box2d.b2Vec2.prototype.GetLength=box2d.b2Vec2.prototype.Length,box2d.b2Vec2.prototype.LengthSquared=function(){var e=this.x,t=this.y;return e*e+t*t},box2d.b2Vec2.prototype.GetLengthSquared=box2d.b2Vec2.prototype.LengthSquared,box2d.b2Vec2.prototype.Normalize=function(){var e=this.GetLength();if(e>=box2d.b2_epsilon){var t=1/e;this.x*=t,this.y*=t}return e},box2d.b2Vec2.prototype.SelfNormalize=function(){var e=this.GetLength();if(e>=box2d.b2_epsilon){var t=1/e;this.x*=t,this.y*=t}return this},box2d.b2Vec2.prototype.SelfRotate=function(e,t){var i=this.x,s=this.y;return this.x=e*i-t*s,this.y=t*i+e*s,this},box2d.b2Vec2.prototype.SelfRotateRadians=function(e){return this.SelfRotate(Math.cos(e),Math.sin(e))},box2d.b2Vec2.prototype.SelfRotateDegrees=function(e){return this.SelfRotateRadians(box2d.b2DegToRad(e))},box2d.b2Vec2.prototype.IsValid=function(){return isFinite(this.x)&&isFinite(this.y)},box2d.b2Vec2.prototype.SelfCrossVS=function(e){var t=this.x;return this.x=e*this.y,this.y=-e*t,this},box2d.b2Vec2.prototype.SelfCrossSV=function(e){var t=this.x;return this.x=-e*this.y,this.y=e*t,this},box2d.b2Vec2.prototype.SelfMinV=function(e){return this.x=box2d.b2Min(this.x,e.x),this.y=box2d.b2Min(this.y,e.y),this},box2d.b2Vec2.prototype.SelfMaxV=function(e){return this.x=box2d.b2Max(this.x,e.x),this.y=box2d.b2Max(this.y,e.y),this},box2d.b2Vec2.prototype.SelfAbs=function(){return this.x=box2d.b2Abs(this.x),this.y=box2d.b2Abs(this.y),this},box2d.b2Vec2.prototype.SelfNeg=function(){return this.x=-this.x,this.y=-this.y,this},box2d.b2Vec2.prototype.SelfSkew=function(){var e=this.x;return this.x=-this.y,this.y=e,this},box2d.b2AbsV=function(e,t){return t.x=box2d.b2Abs(e.x),t.y=box2d.b2Abs(e.y),t},box2d.b2MinV=function(e,t,i){return i.x=box2d.b2Min(e.x,t.x),i.y=box2d.b2Min(e.y,t.y),i},box2d.b2MaxV=function(e,t,i){return i.x=box2d.b2Max(e.x,t.x),i.y=box2d.b2Max(e.y,t.y),i},box2d.b2ClampV=function(e,t,i,s){return s.x=box2d.b2Clamp(e.x,t.x,i.x),s.y=box2d.b2Clamp(e.y,t.y,i.y),s},box2d.b2RotateV=function(e,t,i,s){var a=e.x,n=e.y;return s.x=t*a-i*n,s.y=i*a+t*n,s},box2d.b2RotateRadiansV=function(e,t,i){return box2d.b2RotateV(e,Math.cos(t),Math.sin(t),i)},box2d.b2RotateDegreesV=function(e,t,i){return box2d.b2RotateRadiansV(e,box2d.b2DegToRad(t),i)},box2d.b2DotVV=function(e,t){return e.x*t.x+e.y*t.y},box2d.b2CrossVV=function(e,t){return e.x*t.y-e.y*t.x},box2d.b2CrossVS=function(e,t,i){var s=e.x;return i.x=t*e.y,i.y=-t*s,i},box2d.b2CrossVOne=function(e,t){var i=e.x;return t.x=e.y,t.y=-i,t},box2d.b2CrossSV=function(e,t,i){var s=t.x;return i.x=-e*t.y,i.y=e*s,i},box2d.b2CrossOneV=function(e,t){var i=e.x;return t.x=-e.y,t.y=i,t},box2d.b2AddVV=function(e,t,i){return i.x=e.x+t.x,i.y=e.y+t.y,i},box2d.b2SubVV=function(e,t,i){return i.x=e.x-t.x,i.y=e.y-t.y,i},box2d.b2MulSV=function(e,t,i){return i.x=t.x*e,i.y=t.y*e,i},box2d.b2AddVMulSV=function(e,t,i,s){return s.x=e.x+t*i.x,s.y=e.y+t*i.y,s},box2d.b2SubVMulSV=function(e,t,i,s){return s.x=e.x-t*i.x,s.y=e.y-t*i.y,s},box2d.b2AddVCrossSV=function(e,t,i,s){var a=i.x;return s.x=e.x-t*i.y,s.y=e.y+t*a,s},box2d.b2MidVV=function(e,t,i){return i.x=.5*(e.x+t.x),i.y=.5*(e.y+t.y),i},box2d.b2ExtVV=function(e,t,i){return i.x=.5*(t.x-e.x),i.y=.5*(t.y-e.y),i},box2d.b2IsEqualToV=function(e,t){return e.x===t.x&&e.y===t.y},box2d.b2DistanceVV=function(e,t){var i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)},box2d.b2DistanceSquaredVV=function(e,t){var i=e.x-t.x,s=e.y-t.y;return i*i+s*s},box2d.b2NegV=function(e,t){return t.x=-e.x,t.y=-e.y,t},box2d.b2Vec3=function(e,t,i){this.x=e||0,this.y=t||0,this.z=i||0},box2d.b2Vec3.prototype.x=0,box2d.b2Vec3.prototype.y=0,box2d.b2Vec3.prototype.z=0,box2d.b2Vec3.ZERO=new box2d.b2Vec3,box2d.b2Vec3.s_t0=new box2d.b2Vec3,box2d.b2Vec3.prototype.Clone=function(){return new box2d.b2Vec3(this.x,this.y,this.z)},box2d.b2Vec3.prototype.SetZero=function(){return this.x=0,this.y=0,this.z=0,this},box2d.b2Vec3.prototype.SetXYZ=function(e,t,i){return this.x=e,this.y=t,this.z=i,this},box2d.b2Vec3.prototype.Copy=function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},box2d.b2Vec3.prototype.SelfNeg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},box2d.b2Vec3.prototype.SelfAdd=function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},box2d.b2Vec3.prototype.SelfAddXYZ=function(e,t,i){return this.x+=e,this.y+=t,this.z+=i,this},box2d.b2Vec3.prototype.SelfSub=function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this},box2d.b2Vec3.prototype.SelfSubXYZ=function(e,t,i){return this.x-=e,this.y-=t,this.z-=i,this},box2d.b2Vec3.prototype.SelfMul=function(e){return this.x*=e,this.y*=e,this.z*=e,this},box2d.b2DotV3V3=function(e,t){return e.x*t.x+e.y*t.y+e.z*t.z},box2d.b2CrossV3V3=function(e,t,i){var s=e.x,a=e.y,n=e.z,o=t.x,r=t.y,l=t.z;return i.x=a*l-n*r,i.y=n*o-s*l,i.z=s*r-a*o,i},box2d.b2Mat22=function(){this.ex=new box2d.b2Vec2(1,0),this.ey=new box2d.b2Vec2(0,1)},box2d.b2Mat22.prototype.ex=null,box2d.b2Mat22.prototype.ey=null,box2d.b2Mat22.IDENTITY=new box2d.b2Mat22,box2d.b2Mat22.prototype.Clone=function(){return(new box2d.b2Mat22).Copy(this)},box2d.b2Mat22.FromVV=function(e,t){return(new box2d.b2Mat22).SetVV(e,t)},box2d.b2Mat22.FromSSSS=function(e,t,i,s){return(new box2d.b2Mat22).SetSSSS(e,t,i,s)},box2d.b2Mat22.FromAngleRadians=function(e){return(new box2d.b2Mat22).SetAngleRadians(e)},box2d.b2Mat22.prototype.SetSSSS=function(e,t,i,s){return this.ex.SetXY(e,i),this.ey.SetXY(t,s),this},box2d.b2Mat22.prototype.SetVV=function(e,t){return this.ex.Copy(e),this.ey.Copy(t),this},box2d.b2Mat22.prototype.SetAngle=function(e){var t=Math.cos(e),i=Math.sin(e);return this.ex.SetXY(t,i),this.ey.SetXY(-i,t),this},box2d.b2Mat22.prototype.SetAngleRadians=box2d.b2Mat22.prototype.SetAngle,box2d.b2Mat22.prototype.SetAngleDegrees=function(e){return this.SetAngle(box2d.b2DegToRad(e))},box2d.b2Mat22.prototype.Copy=function(e){return this.ex.Copy(e.ex),this.ey.Copy(e.ey),this},box2d.b2Mat22.prototype.SetIdentity=function(){return this.ex.SetXY(1,0),this.ey.SetXY(0,1),this},box2d.b2Mat22.prototype.SetZero=function(){return this.ex.SetZero(),this.ey.SetZero(),this},box2d.b2Mat22.prototype.GetAngle=function(){return Math.atan2(this.ex.y,this.ex.x)},box2d.b2Mat22.prototype.GetAngleRadians=box2d.b2Mat22.prototype.GetAngle,box2d.b2Mat22.prototype.GetInverse=function(e){var t=this.ex.x,i=this.ey.x,s=this.ex.y,a=this.ey.y,n=t*a-i*s;return 0!==n&&(n=1/n),e.ex.x=n*a,e.ey.x=-n*i,e.ex.y=-n*s,e.ey.y=n*t,e},box2d.b2Mat22.prototype.Solve=function(e,t,i){var s=this.ex.x,a=this.ey.x,n=this.ex.y,o=this.ey.y,r=s*o-a*n;return 0!==r&&(r=1/r),i.x=r*(o*e-a*t),i.y=r*(s*t-n*e),i},box2d.b2Mat22.prototype.SelfAbs=function(){return this.ex.SelfAbs(),this.ey.SelfAbs(),this},box2d.b2Mat22.prototype.SelfInv=function(){return this.GetInverse(this)},box2d.b2Mat22.prototype.SelfAddM=function(e){return this.ex.SelfAdd(e.ex),this.ey.SelfAdd(e.ey),this},box2d.b2Mat22.prototype.SelfSubM=function(e){return this.ex.SelfSub(e.ex),this.ey.SelfSub(e.ey),this},box2d.b2AbsM=function(e,t){var i=e.ex,s=e.ey;return t.ex.x=box2d.b2Abs(i.x),t.ex.y=box2d.b2Abs(i.y),t.ey.x=box2d.b2Abs(s.x),t.ey.y=box2d.b2Abs(s.y),t},box2d.b2MulMV=function(e,t,i){var s=e.ex,a=e.ey,n=t.x,o=t.y;return i.x=s.x*n+a.x*o,i.y=s.y*n+a.y*o,i},box2d.b2MulTMV=function(e,t,i){var s=e.ex,a=e.ey,n=t.x,o=t.y;return i.x=s.x*n+s.y*o,i.y=a.x*n+a.y*o,i},box2d.b2AddMM=function(e,t,i){var s=e.ex,a=e.ey,n=t.ex,o=t.ey;return i.ex.x=s.x+n.x,i.ex.y=s.y+n.y,i.ey.x=a.x+o.x,i.ey.y=a.y+o.y,i},box2d.b2MulMM=function(e,t,i){var s=e.ex.x,a=e.ex.y,n=e.ey.x,o=e.ey.y,r=t.ex.x,l=t.ex.y,h=t.ey.x,c=t.ey.y;return i.ex.x=s*r+n*l,i.ex.y=a*r+o*l,i.ey.x=s*h+n*c,i.ey.y=a*h+o*c,i},box2d.b2MulTMM=function(e,t,i){var s=e.ex.x,a=e.ex.y,n=e.ey.x,o=e.ey.y,r=t.ex.x,l=t.ex.y,h=t.ey.x,c=t.ey.y;return i.ex.x=s*r+a*l,i.ex.y=n*r+o*l,i.ey.x=s*h+a*c,i.ey.y=n*h+o*c,i},box2d.b2Mat33=function(){this.ex=new box2d.b2Vec3(1,0,0),this.ey=new box2d.b2Vec3(0,1,0),this.ez=new box2d.b2Vec3(0,0,1)},box2d.b2Mat33.prototype.ex=null,box2d.b2Mat33.prototype.ey=null,box2d.b2Mat33.prototype.ez=null,box2d.b2Mat33.IDENTITY=new box2d.b2Mat33,box2d.b2Mat33.prototype.Clone=function(){return(new box2d.b2Mat33).Copy(this)},box2d.b2Mat33.prototype.SetVVV=function(e,t,i){return this.ex.Copy(e),this.ey.Copy(t),this.ez.Copy(i),this},box2d.b2Mat33.prototype.Copy=function(e){return this.ex.Copy(e.ex),this.ey.Copy(e.ey),this.ez.Copy(e.ez),this},box2d.b2Mat33.prototype.SetIdentity=function(){return this.ex.SetXYZ(1,0,0),this.ey.SetXYZ(0,1,0),this.ez.SetXYZ(0,0,1),this},box2d.b2Mat33.prototype.SetZero=function(){return this.ex.SetZero(),this.ey.SetZero(),this.ez.SetZero(),this},box2d.b2Mat33.prototype.SelfAddM=function(e){return this.ex.SelfAdd(e.ex),this.ey.SelfAdd(e.ey),this.ez.SelfAdd(e.ez),this},box2d.b2Mat33.prototype.Solve33=function(e,t,i,s){var a=this.ex.x,n=this.ex.y,o=this.ex.z,r=this.ey.x,l=this.ey.y,h=this.ey.z,c=this.ez.x,p=this.ez.y,d=this.ez.z,u=a*(l*d-h*p)+n*(h*c-r*d)+o*(r*p-l*c);return 0!==u&&(u=1/u),s.x=u*(e*(l*d-h*p)+t*(h*c-r*d)+i*(r*p-l*c)),s.y=u*(a*(t*d-i*p)+n*(i*c-e*d)+o*(e*p-t*c)),s.z=u*(a*(l*i-h*t)+n*(h*e-r*i)+o*(r*t-l*e)),s},box2d.b2Mat33.prototype.Solve22=function(e,t,i){var s=this.ex.x,a=this.ey.x,n=this.ex.y,o=this.ey.y,r=s*o-a*n;return 0!==r&&(r=1/r),i.x=r*(o*e-a*t),i.y=r*(s*t-n*e),i},box2d.b2Mat33.prototype.GetInverse22=function(e){var t=this.ex.x,i=this.ey.x,s=this.ex.y,a=this.ey.y,n=t*a-i*s;0!==n&&(n=1/n),e.ex.x=n*a,e.ey.x=-n*i,e.ex.z=0,e.ex.y=-n*s,e.ey.y=n*t,e.ey.z=0,e.ez.x=0,e.ez.y=0,e.ez.z=0},box2d.b2Mat33.prototype.GetSymInverse33=function(e){var t=box2d.b2DotV3V3(this.ex,box2d.b2CrossV3V3(this.ey,this.ez,box2d.b2Vec3.s_t0));0!==t&&(t=1/t);var i=this.ex.x,s=this.ey.x,a=this.ez.x,n=this.ey.y,o=this.ez.y,r=this.ez.z;e.ex.x=t*(n*r-o*o),e.ex.y=t*(a*o-s*r),e.ex.z=t*(s*o-a*n),e.ey.x=e.ex.y,e.ey.y=t*(i*r-a*a),e.ey.z=t*(a*s-i*o),e.ez.x=e.ex.z,e.ez.y=e.ey.z,e.ez.z=t*(i*n-s*s)},box2d.b2MulM33V3=function(e,t,i){var s=t.x,a=t.y,n=t.z;return i.x=e.ex.x*s+e.ey.x*a+e.ez.x*n,i.y=e.ex.y*s+e.ey.y*a+e.ez.y*n,i.z=e.ex.z*s+e.ey.z*a+e.ez.z*n,i},box2d.b2MulM33XYZ=function(e,t,i,s,a){return a.x=e.ex.x*t+e.ey.x*i+e.ez.x*s,a.y=e.ex.y*t+e.ey.y*i+e.ez.y*s,a.z=e.ex.z*t+e.ey.z*i+e.ez.z*s,a},box2d.b2MulM33V2=function(e,t,i){var s=t.x,a=t.y;return i.x=e.ex.x*s+e.ey.x*a,i.y=e.ex.y*s+e.ey.y*a,i},box2d.b2MulM33XY=function(e,t,i,s){return s.x=e.ex.x*t+e.ey.x*i,s.y=e.ex.y*t+e.ey.y*i,s},box2d.b2Rot=function(e){e&&(this.angle=e,this.s=Math.sin(e),this.c=Math.cos(e))},box2d.b2Rot.prototype.angle=0,box2d.b2Rot.prototype.s=0,box2d.b2Rot.prototype.c=1,box2d.b2Rot.IDENTITY=new box2d.b2Rot,box2d.b2Rot.prototype.Clone=function(){return(new box2d.b2Rot).Copy(this)},box2d.b2Rot.prototype.Copy=function(e){return this.angle=e.angle,this.s=e.s,this.c=e.c,this},box2d.b2Rot.prototype.SetAngle=function(e){return this.angle!==e&&(this.angle=e,this.s=Math.sin(e),this.c=Math.cos(e)),this},box2d.b2Rot.prototype.SetAngleRadians=box2d.b2Rot.prototype.SetAngle,box2d.b2Rot.prototype.SetAngleDegrees=function(e){return this.SetAngle(box2d.b2DegToRad(e))},box2d.b2Rot.prototype.SetIdentity=function(){return this.angle=0,this.s=0,this.c=1,this},box2d.b2Rot.prototype.GetAngle=function(){return this.angle},box2d.b2Rot.prototype.GetAngleRadians=box2d.b2Rot.prototype.GetAngle,box2d.b2Rot.prototype.GetAngleDegrees=function(){return box2d.b2RadToDeg(this.GetAngle())},box2d.b2Rot.prototype.GetXAxis=function(e){return e.x=this.c,e.y=this.s,e},box2d.b2Rot.prototype.GetYAxis=function(e){return e.x=-this.s,e.y=this.c,e},box2d.b2MulRR=function(e,t,i){var s=e.c,a=e.s,n=t.c,o=t.s;for(i.s=a*n+s*o,i.c=s*n-a*o,i.angle=e.angle+t.angle;i.angle<-box2d.b2_pi;)i.angle+=box2d.b2_two_pi;for(;i.angle>=box2d.b2_pi;)i.angle-=box2d.b2_two_pi;return i},box2d.b2MulTRR=function(e,t,i){var s=e.c,a=e.s,n=t.c,o=t.s;for(i.s=s*o-a*n,i.c=s*n+a*o,i.angle=e.angle-t.angle;i.angle<-box2d.b2_pi;)i.angle+=box2d.b2_two_pi;for(;i.angle>=box2d.b2_pi;)i.angle-=box2d.b2_two_pi;return i},box2d.b2MulRV=function(e,t,i){var s=e.c,a=e.s,n=t.x,o=t.y;return i.x=s*n-a*o,i.y=a*n+s*o,i},box2d.b2MulTRV=function(e,t,i){var s=e.c,a=e.s,n=t.x,o=t.y;return i.x=s*n+a*o,i.y=-a*n+s*o,i},box2d.b2Transform=function(){this.p=new box2d.b2Vec2,this.q=new box2d.b2Rot},box2d.b2Transform.prototype.p=null,box2d.b2Transform.prototype.q=null,box2d.b2Transform.IDENTITY=new box2d.b2Transform,box2d.b2Transform.prototype.Clone=function(){return(new box2d.b2Transform).Copy(this)},box2d.b2Transform.prototype.Copy=function(e){return this.p.Copy(e.p),this.q.Copy(e.q),this},box2d.b2Transform.prototype.SetIdentity=function(){return this.p.SetZero(),this.q.SetIdentity(),this},box2d.b2Transform.prototype.SetPositionRotation=function(e,t){return this.p.Copy(e),this.q.Copy(t),this},box2d.b2Transform.prototype.SetPositionAngleRadians=function(e,t){return this.p.Copy(e),this.q.SetAngleRadians(t),this},box2d.b2Transform.prototype.SetPosition=function(e){return this.p.Copy(e),this},box2d.b2Transform.prototype.SetPositionXY=function(e,t){return this.p.SetXY(e,t),this},box2d.b2Transform.prototype.SetRotation=function(e){return this.q.Copy(e),this},box2d.b2Transform.prototype.SetRotationAngleRadians=function(e){return this.q.SetAngleRadians(e),this},box2d.b2Transform.prototype.GetPosition=function(){return this.p},box2d.b2Transform.prototype.GetRotation=function(){return this.q},box2d.b2Transform.prototype.GetRotationAngle=function(){return this.q.GetAngle()},box2d.b2Transform.prototype.GetRotationAngleRadians=box2d.b2Transform.prototype.GetRotationAngle,box2d.b2Transform.prototype.GetAngle=function(){return this.q.GetAngle()},box2d.b2Transform.prototype.GetAngleRadians=box2d.b2Transform.prototype.GetAngle,box2d.b2MulXV=function(e,t,i){var s=e.q.c,a=e.q.s,n=t.x,o=t.y;return i.x=s*n-a*o+e.p.x,i.y=a*n+s*o+e.p.y,i},box2d.b2MulTXV=function(e,t,i){var s=e.q.c,a=e.q.s,n=t.x-e.p.x,o=t.y-e.p.y;return i.x=s*n+a*o,i.y=-a*n+s*o,i},box2d.b2MulXX=function(e,t,i){return box2d.b2MulRR(e.q,t.q,i.q),box2d.b2AddVV(box2d.b2MulRV(e.q,t.p,i.p),e.p,i.p),i},box2d.b2MulTXX=function(e,t,i){return box2d.b2MulTRR(e.q,t.q,i.q),box2d.b2MulTRV(e.q,box2d.b2SubVV(t.p,e.p,i.p),i.p),i},box2d.b2Sweep=function(){this.localCenter=new box2d.b2Vec2,this.c0=new box2d.b2Vec2,this.c=new box2d.b2Vec2},box2d.b2Sweep.prototype.localCenter=null,box2d.b2Sweep.prototype.c0=null,box2d.b2Sweep.prototype.c=null,box2d.b2Sweep.prototype.a0=0,box2d.b2Sweep.prototype.a=0,box2d.b2Sweep.prototype.alpha0=0,box2d.b2Sweep.prototype.Clone=function(){return(new box2d.b2Sweep).Copy(this)},box2d.b2Sweep.prototype.Copy=function(e){return this.localCenter.Copy(e.localCenter),this.c0.Copy(e.c0),this.c.Copy(e.c),this.a0=e.a0,this.a=e.a,this.alpha0=e.alpha0,this},box2d.b2Sweep.prototype.GetTransform=function(e,t){var i=1-t;e.p.x=i*this.c0.x+t*this.c.x,e.p.y=i*this.c0.y+t*this.c.y;var s=i*this.a0+t*this.a;return e.q.SetAngleRadians(s),e.p.SelfSub(box2d.b2MulRV(e.q,this.localCenter,box2d.b2Vec2.s_t0)),e},box2d.b2Sweep.prototype.Advance=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.alpha0<1);var t=(e-this.alpha0)/(1-this.alpha0);this.c0.x+=t*(this.c.x-this.c0.x),this.c0.y+=t*(this.c.y-this.c0.y),this.a0+=t*(this.a-this.a0),this.alpha0=e},box2d.b2Sweep.prototype.Normalize=function(){var e=box2d.b2_two_pi*Math.floor(this.a0/box2d.b2_two_pi);this.a0-=e,this.a-=e},goog.provide("box2d.b2Controller"),goog.require("box2d.b2Settings"),box2d.b2ControllerEdge=function(){},box2d.b2ControllerEdge.prototype.controller=null,box2d.b2ControllerEdge.prototype.body=null,box2d.b2ControllerEdge.prototype.prevBody=null,box2d.b2ControllerEdge.prototype.nextBody=null,box2d.b2ControllerEdge.prototype.prevController=null,box2d.b2ControllerEdge.prototype.nextController=null,box2d.b2Controller=function(){},box2d.b2Controller.prototype.m_world=null,box2d.b2Controller.prototype.m_bodyList=null,box2d.b2Controller.prototype.m_bodyCount=0,box2d.b2Controller.prototype.m_prev=null,box2d.b2Controller.prototype.m_next=null,box2d.b2Controller.prototype.Step=function(){},box2d.b2Controller.prototype.Draw=function(){},box2d.b2Controller.prototype.GetNext=function(){return this.m_next},box2d.b2Controller.prototype.GetPrev=function(){return this.m_prev},box2d.b2Controller.prototype.GetWorld=function(){return this.m_world},box2d.b2Controller.prototype.GetBodyList=function(){return this.m_bodyList},box2d.b2Controller.prototype.AddBody=function(e){var t=new box2d.b2ControllerEdge;t.body=e,t.controller=this,t.nextBody=this.m_bodyList,t.prevBody=null,this.m_bodyList&&(this.m_bodyList.prevBody=t),this.m_bodyList=t,++this.m_bodyCount,t.nextController=e.m_controllerList,t.prevController=null,e.m_controllerList&&(e.m_controllerList.prevController=t),e.m_controllerList=t,++e.m_controllerCount},box2d.b2Controller.prototype.RemoveBody=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_bodyCount>0);for(var t=this.m_bodyList;t&&t.body!==e;)t=t.nextBody;box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==t),t.prevBody&&(t.prevBody.nextBody=t.nextBody),t.nextBody&&(t.nextBody.prevBody=t.prevBody),this.m_bodyList===t&&(this.m_bodyList=t.nextBody),--this.m_bodyCount,t.nextController&&(t.nextController.prevController=t.prevController),t.prevController&&(t.prevController.nextController=t.nextController),e.m_controllerList===t&&(e.m_controllerList=t.nextController),--e.m_controllerCount},box2d.b2Controller.prototype.Clear=function(){for(;this.m_bodyList;)this.RemoveBody(this.m_bodyList.body);this.m_bodyCount=0},goog.provide("box2d.b2ConstantAccelController"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Controller"),goog.require("box2d.b2Math"),box2d.b2ConstantAccelController=function(){goog.base(this),this.A=new box2d.b2Vec2(0,0)},goog.inherits(box2d.b2ConstantAccelController,box2d.b2Controller),box2d.b2ConstantAccelController.prototype.A=null,box2d.b2ConstantAccelController.prototype.Step=function(e){for(var t=box2d.b2MulSV(e.dt,this.A,box2d.b2ConstantAccelController.prototype.Step.s_dtA),i=this.m_bodyList;i;i=i.nextBody){var s=i.body;s.IsAwake()&&s.SetLinearVelocity(box2d.b2AddVV(s.GetLinearVelocity(),t,box2d.b2Vec2.s_t0))}},box2d.b2ConstantAccelController.prototype.Step.s_dtA=new box2d.b2Vec2,goog.provide("box2d.b2Joint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Math"),box2d.b2JointType={e_unknownJoint:0,e_revoluteJoint:1,e_prismaticJoint:2,e_distanceJoint:3,e_pulleyJoint:4,e_mouseJoint:5,e_gearJoint:6,e_wheelJoint:7,e_weldJoint:8,e_frictionJoint:9,e_ropeJoint:10,e_motorJoint:11,e_areaJoint:12},goog.exportProperty(box2d.b2JointType,"e_unknownJoint",box2d.b2JointType.e_unknownJoint),goog.exportProperty(box2d.b2JointType,"e_revoluteJoint",box2d.b2JointType.e_revoluteJoint),goog.exportProperty(box2d.b2JointType,"e_prismaticJoint",box2d.b2JointType.e_prismaticJoint),goog.exportProperty(box2d.b2JointType,"e_distanceJoint",box2d.b2JointType.e_distanceJoint),goog.exportProperty(box2d.b2JointType,"e_pulleyJoint",box2d.b2JointType.e_pulleyJoint),goog.exportProperty(box2d.b2JointType,"e_mouseJoint",box2d.b2JointType.e_mouseJoint),goog.exportProperty(box2d.b2JointType,"e_gearJoint",box2d.b2JointType.e_gearJoint),goog.exportProperty(box2d.b2JointType,"e_wheelJoint",box2d.b2JointType.e_wheelJoint),goog.exportProperty(box2d.b2JointType,"e_weldJoint",box2d.b2JointType.e_weldJoint),goog.exportProperty(box2d.b2JointType,"e_frictionJoint",box2d.b2JointType.e_frictionJoint),goog.exportProperty(box2d.b2JointType,"e_ropeJoint",box2d.b2JointType.e_ropeJoint),goog.exportProperty(box2d.b2JointType,"e_motorJoint",box2d.b2JointType.e_motorJoint),goog.exportProperty(box2d.b2JointType,"e_areaJoint",box2d.b2JointType.e_areaJoint),box2d.b2LimitState={e_inactiveLimit:0,e_atLowerLimit:1,e_atUpperLimit:2,e_equalLimits:3},goog.exportProperty(box2d.b2LimitState,"e_inactiveLimit",box2d.b2LimitState.e_inactiveLimit),goog.exportProperty(box2d.b2LimitState,"e_atLowerLimit",box2d.b2LimitState.e_atLowerLimit),goog.exportProperty(box2d.b2LimitState,"e_atUpperLimit",box2d.b2LimitState.e_atUpperLimit),goog.exportProperty(box2d.b2LimitState,"e_equalLimits",box2d.b2LimitState.e_equalLimits),box2d.b2Jacobian=function(){this.linear=new box2d.b2Vec2},box2d.b2Jacobian.prototype.linear=null,box2d.b2Jacobian.prototype.angularA=0,box2d.b2Jacobian.prototype.angularB=0,box2d.b2Jacobian.prototype.SetZero=function(){return this.linear.SetZero(),this.angularA=0,this.angularB=0,this},box2d.b2Jacobian.prototype.Set=function(e,t,i){return this.linear.Copy(e),this.angularA=t,this.angularB=i,this},box2d.b2JointEdge=function(){},box2d.b2JointEdge.prototype.other=null,box2d.b2JointEdge.prototype.joint=null,box2d.b2JointEdge.prototype.prev=null,box2d.b2JointEdge.prototype.next=null,box2d.b2JointDef=function(e){this.type=e},box2d.b2JointDef.prototype.type=box2d.b2JointType.e_unknownJoint,box2d.b2JointDef.prototype.userData=null,box2d.b2JointDef.prototype.bodyA=null,box2d.b2JointDef.prototype.bodyB=null,box2d.b2JointDef.prototype.collideConnected=!1,box2d.b2Joint=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.bodyA!==e.bodyB),this.m_type=e.type,this.m_edgeA=new box2d.b2JointEdge,this.m_edgeB=new box2d.b2JointEdge,this.m_bodyA=e.bodyA,this.m_bodyB=e.bodyB,this.m_collideConnected=e.collideConnected,this.m_userData=e.userData},box2d.b2Joint.prototype.m_type=box2d.b2JointType.e_unknownJoint,box2d.b2Joint.prototype.m_prev=null,box2d.b2Joint.prototype.m_next=null,box2d.b2Joint.prototype.m_edgeA=null,box2d.b2Joint.prototype.m_edgeB=null,box2d.b2Joint.prototype.m_bodyA=null,box2d.b2Joint.prototype.m_bodyB=null,box2d.b2Joint.prototype.m_index=0,box2d.b2Joint.prototype.m_islandFlag=!1,box2d.b2Joint.prototype.m_collideConnected=!1,box2d.b2Joint.prototype.m_userData=null,box2d.b2Joint.prototype.GetAnchorA=function(e){return e.SetZero()},box2d.b2Joint.prototype.GetAnchorB=function(e){return e.SetZero()},box2d.b2Joint.prototype.GetReactionForce=function(e,t){return t.SetZero()},box2d.b2Joint.prototype.GetReactionTorque=function(){return 0},box2d.b2Joint.prototype.InitVelocityConstraints=function(){},box2d.b2Joint.prototype.SolveVelocityConstraints=function(){},box2d.b2Joint.prototype.SolvePositionConstraints=function(){return!1},box2d.b2Joint.prototype.GetType=function(){return this.m_type},box2d.b2Joint.prototype.GetBodyA=function(){return this.m_bodyA},box2d.b2Joint.prototype.GetBodyB=function(){return this.m_bodyB},box2d.b2Joint.prototype.GetNext=function(){return this.m_next},box2d.b2Joint.prototype.GetUserData=function(){return this.m_userData},box2d.b2Joint.prototype.SetUserData=function(e){this.m_userData=e},box2d.b2Joint.prototype.GetCollideConnected=function(){return this.m_collideConnected},box2d.b2Joint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("// Dump is not supported for this joint type.\n")},box2d.b2Joint.prototype.IsActive=function(){return this.m_bodyA.IsActive()&&this.m_bodyB.IsActive()},box2d.b2Joint.prototype.ShiftOrigin=function(){},goog.provide("box2d.b2RevoluteJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Joint"),goog.require("box2d.b2Math"),box2d.b2RevoluteJointDef=function(){goog.base(this,box2d.b2JointType.e_revoluteJoint),this.localAnchorA=new box2d.b2Vec2(0,0),this.localAnchorB=new box2d.b2Vec2(0,0)},goog.inherits(box2d.b2RevoluteJointDef,box2d.b2JointDef),box2d.b2RevoluteJointDef.prototype.localAnchorA=null,box2d.b2RevoluteJointDef.prototype.localAnchorB=null,box2d.b2RevoluteJointDef.prototype.referenceAngle=0,box2d.b2RevoluteJointDef.prototype.enableLimit=!1,box2d.b2RevoluteJointDef.prototype.lowerAngle=0,box2d.b2RevoluteJointDef.prototype.upperAngle=0,box2d.b2RevoluteJointDef.prototype.enableMotor=!1,box2d.b2RevoluteJointDef.prototype.motorSpeed=0,box2d.b2RevoluteJointDef.prototype.maxMotorTorque=0,box2d.b2RevoluteJointDef.prototype.Initialize=function(e,t,i){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngleRadians()-this.bodyA.GetAngleRadians()},box2d.b2RevoluteJoint=function(e){goog.base(this,e),this.m_localAnchorA=new box2d.b2Vec2,this.m_localAnchorB=new box2d.b2Vec2,this.m_impulse=new box2d.b2Vec3,this.m_rA=new box2d.b2Vec2,this.m_rB=new box2d.b2Vec2,this.m_localCenterA=new box2d.b2Vec2,this.m_localCenterB=new box2d.b2Vec2,this.m_mass=new box2d.b2Mat33,this.m_qA=new box2d.b2Rot,this.m_qB=new box2d.b2Rot,this.m_lalcA=new box2d.b2Vec2,this.m_lalcB=new box2d.b2Vec2,this.m_K=new box2d.b2Mat22,this.m_localAnchorA.Copy(e.localAnchorA),this.m_localAnchorB.Copy(e.localAnchorB),this.m_referenceAngle=e.referenceAngle,this.m_impulse.SetZero(),this.m_motorImpulse=0,this.m_lowerAngle=e.lowerAngle,this.m_upperAngle=e.upperAngle,this.m_maxMotorTorque=e.maxMotorTorque,this.m_motorSpeed=e.motorSpeed,this.m_enableLimit=e.enableLimit,this.m_enableMotor=e.enableMotor,this.m_limitState=box2d.b2LimitState.e_inactiveLimit},goog.inherits(box2d.b2RevoluteJoint,box2d.b2Joint),box2d.b2RevoluteJoint.prototype.m_localAnchorA=null,box2d.b2RevoluteJoint.prototype.m_localAnchorB=null,box2d.b2RevoluteJoint.prototype.m_impulse=null,box2d.b2RevoluteJoint.prototype.m_motorImpulse=0,box2d.b2RevoluteJoint.prototype.m_enableMotor=!1,box2d.b2RevoluteJoint.prototype.m_maxMotorTorque=0,box2d.b2RevoluteJoint.prototype.m_motorSpeed=0,box2d.b2RevoluteJoint.prototype.m_enableLimit=!1,box2d.b2RevoluteJoint.prototype.m_referenceAngle=0,box2d.b2RevoluteJoint.prototype.m_lowerAngle=0,box2d.b2RevoluteJoint.prototype.m_upperAngle=0,box2d.b2RevoluteJoint.prototype.m_indexA=0,box2d.b2RevoluteJoint.prototype.m_indexB=0,box2d.b2RevoluteJoint.prototype.m_rA=null,box2d.b2RevoluteJoint.prototype.m_rB=null,box2d.b2RevoluteJoint.prototype.m_localCenterA=null,box2d.b2RevoluteJoint.prototype.m_localCenterB=null,box2d.b2RevoluteJoint.prototype.m_invMassA=0,box2d.b2RevoluteJoint.prototype.m_invMassB=0,box2d.b2RevoluteJoint.prototype.m_invIA=0,box2d.b2RevoluteJoint.prototype.m_invIB=0,box2d.b2RevoluteJoint.prototype.m_mass=null,box2d.b2RevoluteJoint.prototype.m_motorMass=0,box2d.b2RevoluteJoint.prototype.m_limitState=box2d.b2LimitState.e_inactiveLimit,box2d.b2RevoluteJoint.prototype.m_qA=null,box2d.b2RevoluteJoint.prototype.m_qB=null,box2d.b2RevoluteJoint.prototype.m_lalcA=null,box2d.b2RevoluteJoint.prototype.m_lalcB=null,box2d.b2RevoluteJoint.prototype.m_K=null,box2d.b2RevoluteJoint.prototype.InitVelocityConstraints=function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].a,i=e.velocities[this.m_indexA].v,s=e.velocities[this.m_indexA].w,a=e.positions[this.m_indexB].a,n=e.velocities[this.m_indexB].v,o=e.velocities[this.m_indexB].w,r=this.m_qA.SetAngleRadians(t),l=this.m_qB.SetAngleRadians(a);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),box2d.b2MulRV(r,this.m_lalcA,this.m_rA),box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),box2d.b2MulRV(l,this.m_lalcB,this.m_rB);var h=this.m_invMassA,c=this.m_invMassB,p=this.m_invIA,d=this.m_invIB,u=p+d===0;if(this.m_mass.ex.x=h+c+this.m_rA.y*this.m_rA.y*p+this.m_rB.y*this.m_rB.y*d,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*p-this.m_rB.y*this.m_rB.x*d,this.m_mass.ez.x=-this.m_rA.y*p-this.m_rB.y*d,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=h+c+this.m_rA.x*this.m_rA.x*p+this.m_rB.x*this.m_rB.x*d,this.m_mass.ez.y=this.m_rA.x*p+this.m_rB.x*d,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=p+d,this.m_motorMass=p+d,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(!1===this.m_enableMotor||u)&&(this.m_motorImpulse=0),this.m_enableLimit&&!1===u){var m=a-t-this.m_referenceAngle;box2d.b2Abs(this.m_upperAngle-this.m_lowerAngle)<2*box2d.b2_angularSlop?this.m_limitState=box2d.b2LimitState.e_equalLimits:m<=this.m_lowerAngle?(this.m_limitState!==box2d.b2LimitState.e_atLowerLimit&&(this.m_impulse.z=0),this.m_limitState=box2d.b2LimitState.e_atLowerLimit):m>=this.m_upperAngle?(this.m_limitState!==box2d.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=0),this.m_limitState=box2d.b2LimitState.e_atUpperLimit):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=box2d.b2LimitState.e_inactiveLimit;if(e.step.warmStarting){this.m_impulse.SelfMul(e.step.dtRatio),this.m_motorImpulse*=e.step.dtRatio;var g=box2d.b2RevoluteJoint.prototype.InitVelocityConstraints.s_P.SetXY(this.m_impulse.x,this.m_impulse.y);i.SelfMulSub(h,g),s-=p*(box2d.b2CrossVV(this.m_rA,g)+this.m_motorImpulse+this.m_impulse.z),n.SelfMulAdd(c,g),o+=d*(box2d.b2CrossVV(this.m_rB,g)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.SetZero(),this.m_motorImpulse=0;e.velocities[this.m_indexA].w=s,e.velocities[this.m_indexB].w=o},box2d.b2RevoluteJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints=function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,n=this.m_invMassA,o=this.m_invMassB,r=this.m_invIA,l=this.m_invIB,h=r+l===0;if(this.m_enableMotor&&this.m_limitState!==box2d.b2LimitState.e_equalLimits&&!1===h){var c=a-i-this.m_motorSpeed,p=-this.m_motorMass*c,d=this.m_motorImpulse,u=e.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+p,-u,u),i-=r*(p=this.m_motorImpulse-d),a+=l*p}if(this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit&&!1===h){var m=box2d.b2SubVV(box2d.b2AddVCrossSV(s,a,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(t,i,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot1),g=a-i,p=this.m_mass.Solve33(m.x,m.y,g,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse3).SelfNeg();if(this.m_limitState===box2d.b2LimitState.e_equalLimits)this.m_impulse.SelfAdd(p);else if(this.m_limitState===box2d.b2LimitState.e_atLowerLimit)if(0>(v=this.m_impulse.z+p.z)){var y=-m.x+this.m_impulse.z*this.m_mass.ez.x,b=-m.y+this.m_impulse.z*this.m_mass.ez.y,x=this.m_mass.Solve22(y,b,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced);p.x=x.x,p.y=x.y,p.z=-this.m_impulse.z,this.m_impulse.x+=x.x,this.m_impulse.y+=x.y,this.m_impulse.z=0}else this.m_impulse.SelfAdd(p);else if(this.m_limitState===box2d.b2LimitState.e_atUpperLimit){var v=this.m_impulse.z+p.z;if(v>0){var y=-m.x+this.m_impulse.z*this.m_mass.ez.x,b=-m.y+this.m_impulse.z*this.m_mass.ez.y,x=this.m_mass.Solve22(y,b,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced);p.x=x.x,p.y=x.y,p.z=-this.m_impulse.z,this.m_impulse.x+=x.x,this.m_impulse.y+=x.y,this.m_impulse.z=0}else this.m_impulse.SelfAdd(p)}var f=box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_P.SetXY(p.x,p.y);t.SelfMulSub(n,f),i-=r*(box2d.b2CrossVV(this.m_rA,f)+p.z),s.SelfMulAdd(o,f),a+=l*(box2d.b2CrossVV(this.m_rB,f)+p.z)}else{var c=box2d.b2SubVV(box2d.b2AddVCrossSV(s,a,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(t,i,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot),p=this.m_mass.Solve22(-c.x,-c.y,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse2);this.m_impulse.x+=p.x,this.m_impulse.y+=p.y,t.SelfMulSub(n,p),i-=r*box2d.b2CrossVV(this.m_rA,p),s.SelfMulAdd(o,p),a+=l*box2d.b2CrossVV(this.m_rB,p)}e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=a},box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_Cdot1=new box2d.b2Vec2,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse3=new box2d.b2Vec3,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_reduced=new box2d.b2Vec2,box2d.b2RevoluteJoint.prototype.SolveVelocityConstraints.s_impulse2=new box2d.b2Vec2,box2d.b2RevoluteJoint.prototype.SolvePositionConstraints=function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.positions[this.m_indexB].c,a=e.positions[this.m_indexB].a,n=this.m_qA.SetAngleRadians(i),o=this.m_qB.SetAngleRadians(a),r=0,l=0,h=this.m_invIA+this.m_invIB===0;if(this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit&&!1===h){var c=a-i-this.m_referenceAngle,p=0;if(this.m_limitState===box2d.b2LimitState.e_equalLimits){var d=box2d.b2Clamp(c-this.m_lowerAngle,-box2d.b2_maxAngularCorrection,box2d.b2_maxAngularCorrection);p=-this.m_motorMass*d,r=box2d.b2Abs(d)}else this.m_limitState===box2d.b2LimitState.e_atLowerLimit?(r=-(d=c-this.m_lowerAngle),d=box2d.b2Clamp(d+box2d.b2_angularSlop,-box2d.b2_maxAngularCorrection,0),p=-this.m_motorMass*d):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(r=d=c-this.m_upperAngle,d=box2d.b2Clamp(d-box2d.b2_angularSlop,0,box2d.b2_maxAngularCorrection),p=-this.m_motorMass*d);i-=this.m_invIA*p,a+=this.m_invIB*p}n.SetAngleRadians(i),o.SetAngleRadians(a),box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var u=box2d.b2MulRV(n,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var m=box2d.b2MulRV(o,this.m_lalcB,this.m_rB);l=(d=box2d.b2SubVV(box2d.b2AddVV(s,m,box2d.b2Vec2.s_t0),box2d.b2AddVV(t,u,box2d.b2Vec2.s_t1),box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_C)).GetLength();var g=this.m_invMassA,y=this.m_invMassB,b=this.m_invIA,x=this.m_invIB,v=this.m_K;v.ex.x=g+y+b*u.y*u.y+x*m.y*m.y,v.ex.y=-b*u.x*u.y-x*m.x*m.y,v.ey.x=v.ex.y,v.ey.y=g+y+b*u.x*u.x+x*m.x*m.x;var f=v.Solve(d.x,d.y,box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_impulse).SelfNeg();return t.SelfMulSub(g,f),i-=b*box2d.b2CrossVV(u,f),s.SelfMulAdd(y,f),a+=x*box2d.b2CrossVV(m,f),e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=a,l<=box2d.b2_linearSlop&&r<=box2d.b2_angularSlop},box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_C=new box2d.b2Vec2,box2d.b2RevoluteJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec2,box2d.b2RevoluteJoint.prototype.GetAnchorA=function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)},box2d.b2RevoluteJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)},box2d.b2RevoluteJoint.prototype.GetReactionForce=function(e,t){return t.SetXY(e*this.m_impulse.x,e*this.m_impulse.y)},box2d.b2RevoluteJoint.prototype.GetReactionTorque=function(e){return e*this.m_impulse.z},box2d.b2RevoluteJoint.prototype.GetLocalAnchorA=function(e){return e.Copy(this.m_localAnchorA)},box2d.b2RevoluteJoint.prototype.GetLocalAnchorB=function(e){return e.Copy(this.m_localAnchorB)},box2d.b2RevoluteJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle},box2d.b2RevoluteJoint.prototype.GetJointAngleRadians=function(){return this.m_bodyB.m_sweep.a-this.m_bodyA.m_sweep.a-this.m_referenceAngle},box2d.b2RevoluteJoint.prototype.GetJointSpeed=function(){return this.m_bodyB.m_angularVelocity-this.m_bodyA.m_angularVelocity},box2d.b2RevoluteJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor},box2d.b2RevoluteJoint.prototype.EnableMotor=function(e){this.m_enableMotor!==e&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=e)},box2d.b2RevoluteJoint.prototype.GetMotorTorque=function(e){return e*this.m_motorImpulse},box2d.b2RevoluteJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},box2d.b2RevoluteJoint.prototype.SetMaxMotorTorque=function(e){this.m_maxMotorTorque=e},box2d.b2RevoluteJoint.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque},box2d.b2RevoluteJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit},box2d.b2RevoluteJoint.prototype.EnableLimit=function(e){e!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=e,this.m_impulse.z=0)},box2d.b2RevoluteJoint.prototype.GetLowerLimit=function(){return this.m_lowerAngle},box2d.b2RevoluteJoint.prototype.GetUpperLimit=function(){return this.m_upperAngle},box2d.b2RevoluteJoint.prototype.SetLimits=function(e,t){(e!==this.m_lowerAngle||t!==this.m_upperAngle)&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=e,this.m_upperAngle=t)},box2d.b2RevoluteJoint.prototype.SetMotorSpeed=function(e){this.m_motorSpeed!==e&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e)},box2d.b2RevoluteJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,t=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2RevoluteJointDef*/ var jd = new box2d.b2RevoluteJointDef();\n"),box2d.b2Log("  jd.bodyA = bodies[%d];\n",e),box2d.b2Log("  jd.bodyB = bodies[%d];\n",t),box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),box2d.b2Log("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false"),box2d.b2Log("  jd.lowerAngle = %.15f;\n",this.m_lowerAngle),box2d.b2Log("  jd.upperAngle = %.15f;\n",this.m_upperAngle),box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),box2d.b2Log("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque),box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},goog.provide("box2d.b2PrismaticJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Joint"),goog.require("box2d.b2Math"),box2d.b2PrismaticJointDef=function(){goog.base(this,box2d.b2JointType.e_prismaticJoint),this.localAnchorA=new box2d.b2Vec2,this.localAnchorB=new box2d.b2Vec2,this.localAxisA=new box2d.b2Vec2(1,0)},goog.inherits(box2d.b2PrismaticJointDef,box2d.b2JointDef),box2d.b2PrismaticJointDef.prototype.localAnchorA=null,box2d.b2PrismaticJointDef.prototype.localAnchorB=null,box2d.b2PrismaticJointDef.prototype.localAxisA=null,box2d.b2PrismaticJointDef.prototype.referenceAngle=0,box2d.b2PrismaticJointDef.prototype.enableLimit=!1,box2d.b2PrismaticJointDef.prototype.lowerTranslation=0,box2d.b2PrismaticJointDef.prototype.upperTranslation=0,box2d.b2PrismaticJointDef.prototype.enableMotor=!1,box2d.b2PrismaticJointDef.prototype.maxMotorForce=0,box2d.b2PrismaticJointDef.prototype.motorSpeed=0,box2d.b2PrismaticJointDef.prototype.Initialize=function(e,t,i,s){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.bodyA.GetLocalVector(s,this.localAxisA),this.referenceAngle=this.bodyB.GetAngleRadians()-this.bodyA.GetAngleRadians()},box2d.b2PrismaticJoint=function(e){goog.base(this,e),this.m_localAnchorA=e.localAnchorA.Clone(),this.m_localAnchorB=e.localAnchorB.Clone(),this.m_localXAxisA=e.localAxisA.Clone().SelfNormalize(),this.m_localYAxisA=box2d.b2CrossOneV(this.m_localXAxisA,new box2d.b2Vec2),this.m_referenceAngle=e.referenceAngle,this.m_impulse=new box2d.b2Vec3(0,0,0),this.m_lowerTranslation=e.lowerTranslation,this.m_upperTranslation=e.upperTranslation,this.m_maxMotorForce=e.maxMotorForce,this.m_motorSpeed=e.motorSpeed,this.m_enableLimit=e.enableLimit,this.m_enableMotor=e.enableMotor,this.m_localCenterA=new box2d.b2Vec2,this.m_localCenterB=new box2d.b2Vec2,this.m_axis=new box2d.b2Vec2(0,0),this.m_perp=new box2d.b2Vec2(0,0),this.m_K=new box2d.b2Mat33,this.m_K3=new box2d.b2Mat33,this.m_K2=new box2d.b2Mat22,this.m_qA=new box2d.b2Rot,this.m_qB=new box2d.b2Rot,this.m_lalcA=new box2d.b2Vec2,this.m_lalcB=new box2d.b2Vec2,this.m_rA=new box2d.b2Vec2,this.m_rB=new box2d.b2Vec2},goog.inherits(box2d.b2PrismaticJoint,box2d.b2Joint),box2d.b2PrismaticJoint.prototype.m_localAnchorA=null,box2d.b2PrismaticJoint.prototype.m_localAnchorB=null,box2d.b2PrismaticJoint.prototype.m_localXAxisA=null,box2d.b2PrismaticJoint.prototype.m_localYAxisA=null,box2d.b2PrismaticJoint.prototype.m_referenceAngle=0,box2d.b2PrismaticJoint.prototype.m_impulse=null,box2d.b2PrismaticJoint.prototype.m_motorImpulse=0,box2d.b2PrismaticJoint.prototype.m_lowerTranslation=0,box2d.b2PrismaticJoint.prototype.m_upperTranslation=0,box2d.b2PrismaticJoint.prototype.m_maxMotorForce=0,box2d.b2PrismaticJoint.prototype.m_motorSpeed=0,box2d.b2PrismaticJoint.prototype.m_enableLimit=!1,box2d.b2PrismaticJoint.prototype.m_enableMotor=!1,box2d.b2PrismaticJoint.prototype.m_limitState=box2d.b2LimitState.e_inactiveLimit,box2d.b2PrismaticJoint.prototype.m_indexA=0,box2d.b2PrismaticJoint.prototype.m_indexB=0,box2d.b2PrismaticJoint.prototype.m_localCenterA=null,box2d.b2PrismaticJoint.prototype.m_localCenterB=null,box2d.b2PrismaticJoint.prototype.m_invMassA=0,box2d.b2PrismaticJoint.prototype.m_invMassB=0,box2d.b2PrismaticJoint.prototype.m_invIA=0,box2d.b2PrismaticJoint.prototype.m_invIB=0,box2d.b2PrismaticJoint.prototype.m_axis=null,box2d.b2PrismaticJoint.prototype.m_perp=null,box2d.b2PrismaticJoint.prototype.m_s1=0,box2d.b2PrismaticJoint.prototype.m_s2=0,box2d.b2PrismaticJoint.prototype.m_a1=0,box2d.b2PrismaticJoint.prototype.m_a2=0,box2d.b2PrismaticJoint.prototype.m_K=null,box2d.b2PrismaticJoint.prototype.m_K3=null,box2d.b2PrismaticJoint.prototype.m_K2=null,box2d.b2PrismaticJoint.prototype.m_motorMass=0,box2d.b2PrismaticJoint.prototype.m_qA=null,box2d.b2PrismaticJoint.prototype.m_qB=null,box2d.b2PrismaticJoint.prototype.m_lalcA=null,box2d.b2PrismaticJoint.prototype.m_lalcB=null,box2d.b2PrismaticJoint.prototype.m_rA=null,box2d.b2PrismaticJoint.prototype.m_rB=null,box2d.b2PrismaticJoint.prototype.InitVelocityConstraints=function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.velocities[this.m_indexA].v,a=e.velocities[this.m_indexA].w,n=e.positions[this.m_indexB].c,o=e.positions[this.m_indexB].a,r=e.velocities[this.m_indexB].v,l=e.velocities[this.m_indexB].w,h=this.m_qA.SetAngleRadians(i),c=this.m_qB.SetAngleRadians(o);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var p=box2d.b2MulRV(h,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var d=box2d.b2MulRV(c,this.m_lalcB,this.m_rB),u=box2d.b2AddVV(box2d.b2SubVV(n,t,box2d.b2Vec2.s_t0),box2d.b2SubVV(d,p,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_d),m=this.m_invMassA,g=this.m_invMassB,y=this.m_invIA,b=this.m_invIB;if(box2d.b2MulRV(h,this.m_localXAxisA,this.m_axis),this.m_a1=box2d.b2CrossVV(box2d.b2AddVV(u,p,box2d.b2Vec2.s_t0),this.m_axis),this.m_a2=box2d.b2CrossVV(d,this.m_axis),this.m_motorMass=m+g+y*this.m_a1*this.m_a1+b*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),box2d.b2MulRV(h,this.m_localYAxisA,this.m_perp),this.m_s1=box2d.b2CrossVV(box2d.b2AddVV(u,p,box2d.b2Vec2.s_t0),this.m_perp),this.m_s2=box2d.b2CrossVV(d,this.m_perp),this.m_K.ex.x=m+g+y*this.m_s1*this.m_s1+b*this.m_s2*this.m_s2,this.m_K.ex.y=y*this.m_s1+b*this.m_s2,this.m_K.ex.z=y*this.m_s1*this.m_a1+b*this.m_s2*this.m_a2,this.m_K.ey.x=this.m_K.ex.y,this.m_K.ey.y=y+b,0===this.m_K.ey.y&&(this.m_K.ey.y=1),this.m_K.ey.z=y*this.m_a1+b*this.m_a2,this.m_K.ez.x=this.m_K.ex.z,this.m_K.ez.y=this.m_K.ey.z,this.m_K.ez.z=m+g+y*this.m_a1*this.m_a1+b*this.m_a2*this.m_a2,this.m_enableLimit){var x=box2d.b2DotVV(this.m_axis,u);box2d.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*box2d.b2_linearSlop?this.m_limitState=box2d.b2LimitState.e_equalLimits:x<=this.m_lowerTranslation?this.m_limitState!==box2d.b2LimitState.e_atLowerLimit&&(this.m_limitState=box2d.b2LimitState.e_atLowerLimit,this.m_impulse.z=0):x>=this.m_upperTranslation?this.m_limitState!==box2d.b2LimitState.e_atUpperLimit&&(this.m_limitState=box2d.b2LimitState.e_atUpperLimit,this.m_impulse.z=0):(this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0)}else this.m_limitState=box2d.b2LimitState.e_inactiveLimit,this.m_impulse.z=0;if(!1===this.m_enableMotor&&(this.m_motorImpulse=0),e.step.warmStarting){this.m_impulse.SelfMul(e.step.dtRatio),this.m_motorImpulse*=e.step.dtRatio;var v=box2d.b2AddVV(box2d.b2MulSV(this.m_impulse.x,this.m_perp,box2d.b2Vec2.s_t0),box2d.b2MulSV(this.m_motorImpulse+this.m_impulse.z,this.m_axis,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_P),f=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,w=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;s.SelfMulSub(m,v),a-=y*f,r.SelfMulAdd(g,v),l+=b*w}else this.m_impulse.SetZero(),this.m_motorImpulse=0;e.velocities[this.m_indexA].w=a,e.velocities[this.m_indexB].w=l},box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_d=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints=function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,n=this.m_invMassA,o=this.m_invMassB,r=this.m_invIA,l=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!==box2d.b2LimitState.e_equalLimits){var h=box2d.b2DotVV(this.m_axis,box2d.b2SubVV(s,t,box2d.b2Vec2.s_t0))+this.m_a2*a-this.m_a1*i,c=this.m_motorMass*(this.m_motorSpeed-h),p=this.m_motorImpulse,d=e.step.dt*this.m_maxMotorForce;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+c,-d,d),c=this.m_motorImpulse-p;var u=box2d.b2MulSV(c,this.m_axis,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),m=c*this.m_a1,g=c*this.m_a2;t.SelfMulSub(n,u),i-=r*m,s.SelfMulAdd(o,u),a+=l*g}var y=box2d.b2DotVV(this.m_perp,box2d.b2SubVV(s,t,box2d.b2Vec2.s_t0))+this.m_s2*a-this.m_s1*i,b=a-i;if(this.m_enableLimit&&this.m_limitState!==box2d.b2LimitState.e_inactiveLimit){var x=box2d.b2DotVV(this.m_axis,box2d.b2SubVV(s,t,box2d.b2Vec2.s_t0))+this.m_a2*a-this.m_a1*i,v=box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f1.Copy(this.m_impulse),f=this.m_K.Solve33(-y,-b,-x,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df3);this.m_impulse.SelfAdd(f),this.m_limitState===box2d.b2LimitState.e_atLowerLimit?this.m_impulse.z=box2d.b2Max(this.m_impulse.z,0):this.m_limitState===box2d.b2LimitState.e_atUpperLimit&&(this.m_impulse.z=box2d.b2Min(this.m_impulse.z,0));var w=-y-(this.m_impulse.z-v.z)*this.m_K.ez.x,k=-b-(this.m_impulse.z-v.z)*this.m_K.ez.y,_=this.m_K.Solve22(w,k,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f2r);_.x+=v.x,_.y+=v.y,this.m_impulse.x=_.x,this.m_impulse.y=_.y,f.x=this.m_impulse.x-v.x,f.y=this.m_impulse.y-v.y,f.z=this.m_impulse.z-v.z;var u=box2d.b2AddVV(box2d.b2MulSV(f.x,this.m_perp,box2d.b2Vec2.s_t0),box2d.b2MulSV(f.z,this.m_axis,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),m=f.x*this.m_s1+f.y+f.z*this.m_a1,g=f.x*this.m_s2+f.y+f.z*this.m_a2;t.SelfMulSub(n,u),i-=r*m,s.SelfMulAdd(o,u),a+=l*g}else{f=this.m_K.Solve22(-y,-b,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df2);this.m_impulse.x+=f.x,this.m_impulse.y+=f.y;var u=box2d.b2MulSV(f.x,this.m_perp,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P),m=f.x*this.m_s1+f.y,g=f.x*this.m_s2+f.y;t.SelfMulSub(n,u),i-=r*m,s.SelfMulAdd(o,u),a+=l*g}e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=a},box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f2r=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_f1=new box2d.b2Vec3,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df3=new box2d.b2Vec3,box2d.b2PrismaticJoint.prototype.SolveVelocityConstraints.s_df2=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.SolvePositionConstraints=function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.positions[this.m_indexB].c,a=e.positions[this.m_indexB].a,n=this.m_qA.SetAngleRadians(i),o=this.m_qB.SetAngleRadians(a),r=this.m_invMassA,l=this.m_invMassB,h=this.m_invIA,c=this.m_invIB,p=box2d.b2MulRV(n,this.m_lalcA,this.m_rA),d=box2d.b2MulRV(o,this.m_lalcB,this.m_rB),u=box2d.b2SubVV(box2d.b2AddVV(s,d,box2d.b2Vec2.s_t0),box2d.b2AddVV(t,p,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_d),m=box2d.b2MulRV(n,this.m_localXAxisA,this.m_axis),g=box2d.b2CrossVV(box2d.b2AddVV(u,p,box2d.b2Vec2.s_t0),m),y=box2d.b2CrossVV(d,m),b=box2d.b2MulRV(n,this.m_localYAxisA,this.m_perp),x=box2d.b2CrossVV(box2d.b2AddVV(u,p,box2d.b2Vec2.s_t0),b),v=box2d.b2CrossVV(d,b),f=box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse,w=box2d.b2DotVV(b,u),k=a-i-this.m_referenceAngle,_=box2d.b2Abs(w),S=box2d.b2Abs(k),M=!1,A=0;if(this.m_enableLimit){var C=box2d.b2DotVV(m,u);box2d.b2Abs(this.m_upperTranslation-this.m_lowerTranslation)<2*box2d.b2_linearSlop?(A=box2d.b2Clamp(C,-box2d.b2_maxLinearCorrection,box2d.b2_maxLinearCorrection),_=box2d.b2Max(_,box2d.b2Abs(C)),M=!0):C<=this.m_lowerTranslation?(A=box2d.b2Clamp(C-this.m_lowerTranslation+box2d.b2_linearSlop,-box2d.b2_maxLinearCorrection,0),_=box2d.b2Max(_,this.m_lowerTranslation-C),M=!0):C>=this.m_upperTranslation&&(A=box2d.b2Clamp(C-this.m_upperTranslation-box2d.b2_linearSlop,0,box2d.b2_maxLinearCorrection),_=box2d.b2Max(_,C-this.m_upperTranslation),M=!0)}if(M){var P=r+l+h*x*x+c*v*v,T=h*x+c*v,X=h*x*g+c*v*y;0===(L=h+c)&&(L=1);var Y=h*g+c*y,G=r+l+h*g*g+c*y*y,B=this.m_K3;B.ex.SetXYZ(P,T,X),B.ey.SetXYZ(T,L,Y),B.ez.SetXYZ(X,Y,G),f=B.Solve33(-w,-k,-A,f)}else{var P=r+l+h*x*x+c*v*v,T=h*x+c*v,L=h+c;0===L&&(L=1);var E=this.m_K2;E.ex.SetXY(P,T),E.ey.SetXY(T,L);var R=E.Solve(-w,-k,box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse1);f.x=R.x,f.y=R.y,f.z=0}var D=box2d.b2AddVV(box2d.b2MulSV(f.x,b,box2d.b2Vec2.s_t0),box2d.b2MulSV(f.z,m,box2d.b2Vec2.s_t1),box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_P),F=f.x*x+f.y+f.z*g,I=f.x*v+f.y+f.z*y;return t.SelfMulSub(r,D),i-=h*F,s.SelfMulAdd(l,D),a+=c*I,e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=a,_<=box2d.b2_linearSlop&&S<=box2d.b2_angularSlop},box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_d=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec3,box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_impulse1=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.GetAnchorA=function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)},box2d.b2PrismaticJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)},box2d.b2PrismaticJoint.prototype.GetReactionForce=function(e,t){return t.SetXY(e*(this.m_impulse.x*this.m_perp.x+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.x),e*(this.m_impulse.x*this.m_perp.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis.y))},box2d.b2PrismaticJoint.prototype.GetReactionTorque=function(e){return e*this.m_impulse.y},box2d.b2PrismaticJoint.prototype.GetLocalAnchorA=function(e){return e.Copy(this.m_localAnchorA)},box2d.b2PrismaticJoint.prototype.GetLocalAnchorB=function(e){return e.Copy(this.m_localAnchorB)},box2d.b2PrismaticJoint.prototype.GetLocalAxisA=function(e){return e.Copy(this.m_localXAxisA)},box2d.b2PrismaticJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle},box2d.b2PrismaticJoint.prototype.GetJointTranslation=function(){var e=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pA),t=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pB),i=box2d.b2SubVV(t,e,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_d),s=this.m_bodyA.GetWorldVector(this.m_localXAxisA,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_axis);return box2d.b2DotVV(i,s)},box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pA=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_pB=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_d=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.GetJointTranslation.s_axis=new box2d.b2Vec2,box2d.b2PrismaticJoint.prototype.GetJointSpeed=function(){var e=this.m_bodyA,t=this.m_bodyB;box2d.b2SubVV(this.m_localAnchorA,e.m_sweep.localCenter,this.m_lalcA);var i=box2d.b2MulRV(e.m_xf.q,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,t.m_sweep.localCenter,this.m_lalcB);var s=box2d.b2MulRV(t.m_xf.q,this.m_lalcB,this.m_rB),a=box2d.b2AddVV(e.m_sweep.c,i,box2d.b2Vec2.s_t0),n=box2d.b2AddVV(t.m_sweep.c,s,box2d.b2Vec2.s_t1),o=box2d.b2SubVV(n,a,box2d.b2Vec2.s_t2),r=e.GetWorldVector(this.m_localXAxisA,this.m_axis),l=e.m_linearVelocity,h=t.m_linearVelocity,c=e.m_angularVelocity,p=t.m_angularVelocity;return box2d.b2DotVV(o,box2d.b2CrossSV(c,r,box2d.b2Vec2.s_t0))+box2d.b2DotVV(r,box2d.b2SubVV(box2d.b2AddVCrossSV(h,p,s,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(l,c,i,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0))},box2d.b2PrismaticJoint.prototype.IsLimitEnabled=function(){return this.m_enableLimit},box2d.b2PrismaticJoint.prototype.EnableLimit=function(e){e!==this.m_enableLimit&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableLimit=e,this.m_impulse.z=0)},box2d.b2PrismaticJoint.prototype.GetLowerLimit=function(){return this.m_lowerTranslation},box2d.b2PrismaticJoint.prototype.GetUpperLimit=function(){return this.m_upperTranslation},box2d.b2PrismaticJoint.prototype.SetLimits=function(e,t){(e!==this.m_lowerTranslation||t!==this.m_upperTranslation)&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_lowerTranslation=e,this.m_upperTranslation=t,this.m_impulse.z=0)},box2d.b2PrismaticJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor},box2d.b2PrismaticJoint.prototype.EnableMotor=function(e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=e},box2d.b2PrismaticJoint.prototype.SetMotorSpeed=function(e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e},box2d.b2PrismaticJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},box2d.b2PrismaticJoint.prototype.SetMaxMotorForce=function(e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorForce=e},box2d.b2PrismaticJoint.prototype.GetMaxMotorForce=function(){return this.m_maxMotorForce},box2d.b2PrismaticJoint.prototype.GetMotorForce=function(e){return e*this.m_motorImpulse},box2d.b2PrismaticJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,t=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2PrismaticJointDef*/ var jd = new box2d.b2PrismaticJointDef();\n"),box2d.b2Log("  jd.bodyA = bodies[%d];\n",e),box2d.b2Log("  jd.bodyB = bodies[%d];\n",t),box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),box2d.b2Log("  jd.localAxisA.SetXY(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y),box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),box2d.b2Log("  jd.enableLimit = %s;\n",this.m_enableLimit?"true":"false"),box2d.b2Log("  jd.lowerTranslation = %.15f;\n",this.m_lowerTranslation),box2d.b2Log("  jd.upperTranslation = %.15f;\n",this.m_upperTranslation),box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),box2d.b2Log("  jd.maxMotorForce = %.15f;\n",this.m_maxMotorForce),box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},goog.provide("box2d.b2GearJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Joint"),goog.require("box2d.b2Math"),goog.require("box2d.b2RevoluteJoint"),goog.require("box2d.b2PrismaticJoint"),box2d.b2GearJointDef=function(){goog.base(this,box2d.b2JointType.e_gearJoint)},goog.inherits(box2d.b2GearJointDef,box2d.b2JointDef),box2d.b2GearJointDef.prototype.joint1=null,box2d.b2GearJointDef.prototype.joint2=null,box2d.b2GearJointDef.prototype.ratio=1,box2d.b2GearJoint=function(e){goog.base(this,e),this.m_joint1=e.joint1,this.m_joint2=e.joint2,this.m_localAnchorA=new box2d.b2Vec2,this.m_localAnchorB=new box2d.b2Vec2,this.m_localAnchorC=new box2d.b2Vec2,this.m_localAnchorD=new box2d.b2Vec2,this.m_localAxisC=new box2d.b2Vec2,this.m_localAxisD=new box2d.b2Vec2,this.m_lcA=new box2d.b2Vec2,this.m_lcB=new box2d.b2Vec2,this.m_lcC=new box2d.b2Vec2,this.m_lcD=new box2d.b2Vec2,this.m_JvAC=new box2d.b2Vec2,this.m_JvBD=new box2d.b2Vec2,this.m_qA=new box2d.b2Rot,this.m_qB=new box2d.b2Rot,this.m_qC=new box2d.b2Rot,this.m_qD=new box2d.b2Rot,this.m_lalcA=new box2d.b2Vec2,this.m_lalcB=new box2d.b2Vec2,this.m_lalcC=new box2d.b2Vec2,this.m_lalcD=new box2d.b2Vec2,this.m_typeA=this.m_joint1.GetType(),this.m_typeB=this.m_joint2.GetType(),box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_typeA===box2d.b2JointType.e_revoluteJoint||this.m_typeA===box2d.b2JointType.e_prismaticJoint),box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_typeB===box2d.b2JointType.e_revoluteJoint||this.m_typeB===box2d.b2JointType.e_prismaticJoint);var t,i;this.m_bodyC=this.m_joint1.GetBodyA(),this.m_bodyA=this.m_joint1.GetBodyB();var s=this.m_bodyA.m_xf,a=this.m_bodyA.m_sweep.a,n=this.m_bodyC.m_xf,o=this.m_bodyC.m_sweep.a;if(this.m_typeA===box2d.b2JointType.e_revoluteJoint){u=e.joint1;this.m_localAnchorC.Copy(u.m_localAnchorA),this.m_localAnchorA.Copy(u.m_localAnchorB),this.m_referenceAngleA=u.m_referenceAngle,this.m_localAxisC.SetZero(),t=a-o-this.m_referenceAngleA}else{m=e.joint1;this.m_localAnchorC.Copy(m.m_localAnchorA),this.m_localAnchorA.Copy(m.m_localAnchorB),this.m_referenceAngleA=m.m_referenceAngle,this.m_localAxisC.Copy(m.m_localXAxisA);var r=this.m_localAnchorC,l=box2d.b2MulTRV(n.q,box2d.b2AddVV(box2d.b2MulRV(s.q,this.m_localAnchorA,box2d.b2Vec2.s_t0),box2d.b2SubVV(s.p,n.p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);t=box2d.b2DotVV(box2d.b2SubVV(l,r,box2d.b2Vec2.s_t0),this.m_localAxisC)}this.m_bodyD=this.m_joint2.GetBodyA(),this.m_bodyB=this.m_joint2.GetBodyB();var h=this.m_bodyB.m_xf,c=this.m_bodyB.m_sweep.a,p=this.m_bodyD.m_xf,d=this.m_bodyD.m_sweep.a;if(this.m_typeB===box2d.b2JointType.e_revoluteJoint){var u=e.joint2;this.m_localAnchorD.Copy(u.m_localAnchorA),this.m_localAnchorB.Copy(u.m_localAnchorB),this.m_referenceAngleB=u.m_referenceAngle,this.m_localAxisD.SetZero(),i=c-d-this.m_referenceAngleB}else{var m=e.joint2;this.m_localAnchorD.Copy(m.m_localAnchorA),this.m_localAnchorB.Copy(m.m_localAnchorB),this.m_referenceAngleB=m.m_referenceAngle,this.m_localAxisD.Copy(m.m_localXAxisA);var g=this.m_localAnchorD,y=box2d.b2MulTRV(p.q,box2d.b2AddVV(box2d.b2MulRV(h.q,this.m_localAnchorB,box2d.b2Vec2.s_t0),box2d.b2SubVV(h.p,p.p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);i=box2d.b2DotVV(box2d.b2SubVV(y,g,box2d.b2Vec2.s_t0),this.m_localAxisD)}this.m_ratio=e.ratio,this.m_constant=t+this.m_ratio*i,this.m_impulse=0},goog.inherits(box2d.b2GearJoint,box2d.b2Joint),box2d.b2GearJoint.prototype.m_joint1=null,box2d.b2GearJoint.prototype.m_joint2=null,box2d.b2GearJoint.prototype.m_typeA=box2d.b2JointType.e_unknownJoint,box2d.b2GearJoint.prototype.m_typeB=box2d.b2JointType.e_unknownJoint,box2d.b2GearJoint.prototype.m_bodyC=null,box2d.b2GearJoint.prototype.m_bodyD=null,box2d.b2GearJoint.prototype.m_localAnchorA=null,box2d.b2GearJoint.prototype.m_localAnchorB=null,box2d.b2GearJoint.prototype.m_localAnchorC=null,box2d.b2GearJoint.prototype.m_localAnchorD=null,box2d.b2GearJoint.prototype.m_localAxisC=null,box2d.b2GearJoint.prototype.m_localAxisD=null,box2d.b2GearJoint.prototype.m_referenceAngleA=0,box2d.b2GearJoint.prototype.m_referenceAngleB=0,box2d.b2GearJoint.prototype.m_constant=0,box2d.b2GearJoint.prototype.m_ratio=0,box2d.b2GearJoint.prototype.m_impulse=0,box2d.b2GearJoint.prototype.m_indexA=0,box2d.b2GearJoint.prototype.m_indexB=0,box2d.b2GearJoint.prototype.m_indexC=0,box2d.b2GearJoint.prototype.m_indexD=0,box2d.b2GearJoint.prototype.m_lcA=null,box2d.b2GearJoint.prototype.m_lcB=null,box2d.b2GearJoint.prototype.m_lcC=null,box2d.b2GearJoint.prototype.m_lcD=null,box2d.b2GearJoint.prototype.m_mA=0,box2d.b2GearJoint.prototype.m_mB=0,box2d.b2GearJoint.prototype.m_mC=0,box2d.b2GearJoint.prototype.m_mD=0,box2d.b2GearJoint.prototype.m_iA=0,box2d.b2GearJoint.prototype.m_iB=0,box2d.b2GearJoint.prototype.m_iC=0,box2d.b2GearJoint.prototype.m_iD=0,box2d.b2GearJoint.prototype.m_JvAC=null,box2d.b2GearJoint.prototype.m_JvBD=null,box2d.b2GearJoint.prototype.m_JwA=0,box2d.b2GearJoint.prototype.m_JwB=0,box2d.b2GearJoint.prototype.m_JwC=0,box2d.b2GearJoint.prototype.m_JwD=0,box2d.b2GearJoint.prototype.m_mass=0,box2d.b2GearJoint.prototype.m_qA=null,box2d.b2GearJoint.prototype.m_qB=null,box2d.b2GearJoint.prototype.m_qC=null,box2d.b2GearJoint.prototype.m_qD=null,box2d.b2GearJoint.prototype.m_lalcA=null,box2d.b2GearJoint.prototype.m_lalcB=null,box2d.b2GearJoint.prototype.m_lalcC=null,box2d.b2GearJoint.prototype.m_lalcD=null,box2d.b2GearJoint.prototype.InitVelocityConstraints=function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_indexC=this.m_bodyC.m_islandIndex,this.m_indexD=this.m_bodyD.m_islandIndex,this.m_lcA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_lcB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_lcC.Copy(this.m_bodyC.m_sweep.localCenter),this.m_lcD.Copy(this.m_bodyD.m_sweep.localCenter),this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var t=e.positions[this.m_indexA].a,i=e.velocities[this.m_indexA].v,s=e.velocities[this.m_indexA].w,a=e.positions[this.m_indexB].a,n=e.velocities[this.m_indexB].v,o=e.velocities[this.m_indexB].w,r=e.positions[this.m_indexC].a,l=e.velocities[this.m_indexC].v,h=e.velocities[this.m_indexC].w,c=e.positions[this.m_indexD].a,p=e.velocities[this.m_indexD].v,d=e.velocities[this.m_indexD].w,u=this.m_qA.SetAngleRadians(t),m=this.m_qB.SetAngleRadians(a),g=this.m_qC.SetAngleRadians(r),y=this.m_qD.SetAngleRadians(c);if(this.m_mass=0,this.m_typeA===box2d.b2JointType.e_revoluteJoint)this.m_JvAC.SetZero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{v=box2d.b2MulRV(g,this.m_localAxisC,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u);box2d.b2SubVV(this.m_localAnchorC,this.m_lcC,this.m_lalcC);var b=box2d.b2MulRV(g,this.m_lalcC,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rC);box2d.b2SubVV(this.m_localAnchorA,this.m_lcA,this.m_lalcA);var x=box2d.b2MulRV(u,this.m_lalcA,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rA);this.m_JvAC.Copy(v),this.m_JwC=box2d.b2CrossVV(b,v),this.m_JwA=box2d.b2CrossVV(x,v),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_typeB===box2d.b2JointType.e_revoluteJoint)this.m_JvBD.SetZero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{var v=box2d.b2MulRV(y,this.m_localAxisD,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u);box2d.b2SubVV(this.m_localAnchorD,this.m_lcD,this.m_lalcD);var f=box2d.b2MulRV(y,this.m_lalcD,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rD);box2d.b2SubVV(this.m_localAnchorB,this.m_lcB,this.m_lalcB);var w=box2d.b2MulRV(m,this.m_lalcB,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rB);box2d.b2MulSV(this.m_ratio,v,this.m_JvBD),this.m_JwD=this.m_ratio*box2d.b2CrossVV(f,v),this.m_JwB=this.m_ratio*box2d.b2CrossVV(w,v),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,e.step.warmStarting?(i.SelfMulAdd(this.m_mA*this.m_impulse,this.m_JvAC),s+=this.m_iA*this.m_impulse*this.m_JwA,n.SelfMulAdd(this.m_mB*this.m_impulse,this.m_JvBD),o+=this.m_iB*this.m_impulse*this.m_JwB,l.SelfMulSub(this.m_mC*this.m_impulse,this.m_JvAC),h-=this.m_iC*this.m_impulse*this.m_JwC,p.SelfMulSub(this.m_mD*this.m_impulse,this.m_JvBD),d-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,e.velocities[this.m_indexA].w=s,e.velocities[this.m_indexB].w=o,e.velocities[this.m_indexC].w=h,e.velocities[this.m_indexD].w=d},box2d.b2GearJoint.prototype.InitVelocityConstraints.s_u=new box2d.b2Vec2,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rA=new box2d.b2Vec2,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rB=new box2d.b2Vec2,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rC=new box2d.b2Vec2,box2d.b2GearJoint.prototype.InitVelocityConstraints.s_rD=new box2d.b2Vec2,box2d.b2GearJoint.prototype.SolveVelocityConstraints=function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,n=e.velocities[this.m_indexC].v,o=e.velocities[this.m_indexC].w,r=e.velocities[this.m_indexD].v,l=e.velocities[this.m_indexD].w,h=box2d.b2DotVV(this.m_JvAC,box2d.b2SubVV(t,n,box2d.b2Vec2.s_t0))+box2d.b2DotVV(this.m_JvBD,box2d.b2SubVV(s,r,box2d.b2Vec2.s_t0));h+=this.m_JwA*i-this.m_JwC*o+(this.m_JwB*a-this.m_JwD*l);var c=-this.m_mass*h;this.m_impulse+=c,t.SelfMulAdd(this.m_mA*c,this.m_JvAC),i+=this.m_iA*c*this.m_JwA,s.SelfMulAdd(this.m_mB*c,this.m_JvBD),a+=this.m_iB*c*this.m_JwB,n.SelfMulSub(this.m_mC*c,this.m_JvAC),o-=this.m_iC*c*this.m_JwC,r.SelfMulSub(this.m_mD*c,this.m_JvBD),l-=this.m_iD*c*this.m_JwD,e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=a,e.velocities[this.m_indexC].w=o,e.velocities[this.m_indexD].w=l},box2d.b2GearJoint.prototype.SolvePositionConstraints=function(e){var t,i,s,a,n,o,r=e.positions[this.m_indexA].c,l=e.positions[this.m_indexA].a,h=e.positions[this.m_indexB].c,c=e.positions[this.m_indexB].a,p=e.positions[this.m_indexC].c,d=e.positions[this.m_indexC].a,u=e.positions[this.m_indexD].c,m=e.positions[this.m_indexD].a,g=this.m_qA.SetAngleRadians(l),y=this.m_qB.SetAngleRadians(c),b=this.m_qC.SetAngleRadians(d),x=this.m_qD.SetAngleRadians(m),v=this.m_JvAC,f=this.m_JvBD,w=0;if(this.m_typeA===box2d.b2JointType.e_revoluteJoint)v.SetZero(),s=1,n=1,w+=this.m_iA+this.m_iC,t=l-d-this.m_referenceAngleA;else{var k=box2d.b2MulRV(b,this.m_localAxisC,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u),_=box2d.b2MulRV(b,this.m_lalcC,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rC),S=box2d.b2MulRV(g,this.m_lalcA,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rA);v.Copy(k),n=box2d.b2CrossVV(_,k),s=box2d.b2CrossVV(S,k),w+=this.m_mC+this.m_mA+this.m_iC*n*n+this.m_iA*s*s;var M=this.m_lalcC,A=box2d.b2MulTRV(b,box2d.b2AddVV(S,box2d.b2SubVV(r,p,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);t=box2d.b2DotVV(box2d.b2SubVV(A,M,box2d.b2Vec2.s_t0),this.m_localAxisC)}if(this.m_typeB===box2d.b2JointType.e_revoluteJoint)f.SetZero(),a=this.m_ratio,o=this.m_ratio,w+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),i=c-m-this.m_referenceAngleB;else{var k=box2d.b2MulRV(x,this.m_localAxisD,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u),C=box2d.b2MulRV(x,this.m_lalcD,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rD),P=box2d.b2MulRV(y,this.m_lalcB,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rB);box2d.b2MulSV(this.m_ratio,k,f),o=this.m_ratio*box2d.b2CrossVV(C,k),a=this.m_ratio*box2d.b2CrossVV(P,k),w+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*o*o+this.m_iB*a*a;var T=this.m_lalcD,X=box2d.b2MulTRV(x,box2d.b2AddVV(P,box2d.b2SubVV(h,u,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0);i=box2d.b2DotVV(box2d.b2SubVV(X,T,box2d.b2Vec2.s_t0),this.m_localAxisD)}var Y=t+this.m_ratio*i-this.m_constant,G=0;return w>0&&(G=-Y/w),r.SelfMulAdd(this.m_mA*G,v),l+=this.m_iA*G*s,h.SelfMulAdd(this.m_mB*G,f),c+=this.m_iB*G*a,p.SelfMulSub(this.m_mC*G,v),d-=this.m_iC*G*n,u.SelfMulSub(this.m_mD*G,f),m-=this.m_iD*G*o,e.positions[this.m_indexA].a=l,e.positions[this.m_indexB].a=c,e.positions[this.m_indexC].a=d,e.positions[this.m_indexD].a=m,0<box2d.b2_linearSlop},box2d.b2GearJoint.prototype.SolvePositionConstraints.s_u=new box2d.b2Vec2,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rA=new box2d.b2Vec2,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rB=new box2d.b2Vec2,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rC=new box2d.b2Vec2,box2d.b2GearJoint.prototype.SolvePositionConstraints.s_rD=new box2d.b2Vec2,box2d.b2GearJoint.prototype.GetAnchorA=function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)},box2d.b2GearJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)},box2d.b2GearJoint.prototype.GetReactionForce=function(e,t){return box2d.b2MulSV(e*this.m_impulse,this.m_JvAC,t)},box2d.b2GearJoint.prototype.GetReactionTorque=function(e){return e*this.m_impulse*this.m_JwA},box2d.b2GearJoint.prototype.GetJoint1=function(){return this.m_joint1},box2d.b2GearJoint.prototype.GetJoint2=function(){return this.m_joint2},box2d.b2GearJoint.prototype.GetRatio=function(){return this.m_ratio},box2d.b2GearJoint.prototype.SetRatio=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e)),this.m_ratio=e},box2d.b2GearJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,t=this.m_bodyB.m_islandIndex,i=this.m_joint1.m_index,s=this.m_joint2.m_index;box2d.b2Log("  /*box2d.b2GearJointDef*/ var jd = new box2d.b2GearJointDef();\n"),box2d.b2Log("  jd.bodyA = bodies[%d];\n",e),box2d.b2Log("  jd.bodyB = bodies[%d];\n",t),box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),box2d.b2Log("  jd.joint1 = joints[%d];\n",i),box2d.b2Log("  jd.joint2 = joints[%d];\n",s),box2d.b2Log("  jd.ratio = %.15f;\n",this.m_ratio),box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},goog.provide("box2d.b2Distance"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Math"),box2d.b2DistanceProxy=function(){this.m_buffer=box2d.b2Vec2.MakeArray(2)},box2d.b2DistanceProxy.prototype.m_buffer=null,box2d.b2DistanceProxy.prototype.m_vertices=null,box2d.b2DistanceProxy.prototype.m_count=0,box2d.b2DistanceProxy.prototype.m_radius=0,box2d.b2DistanceProxy.prototype.Reset=function(){return this.m_vertices=null,this.m_count=0,this.m_radius=0,this},box2d.b2DistanceProxy.prototype.SetShape=function(e,t){e.SetupDistanceProxy(this,t)},box2d.b2DistanceProxy.prototype.GetSupport=function(e){for(var t=0,i=box2d.b2DotVV(this.m_vertices[0],e),s=1;s<this.m_count;++s){var a=box2d.b2DotVV(this.m_vertices[s],e);a>i&&(t=s,i=a)}return t},box2d.b2DistanceProxy.prototype.GetSupportVertex=function(e,t){for(var i=0,s=box2d.b2DotVV(this.m_vertices[0],e),a=1;a<this.m_count;++a){var n=box2d.b2DotVV(this.m_vertices[a],e);n>s&&(i=a,s=n)}return t.Copy(this.m_vertices[i])},box2d.b2DistanceProxy.prototype.GetVertexCount=function(){return this.m_count},box2d.b2DistanceProxy.prototype.GetVertex=function(e){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(e>=0&&e<this.m_count),this.m_vertices[e]},box2d.b2SimplexCache=function(){this.indexA=box2d.b2MakeNumberArray(3),this.indexB=box2d.b2MakeNumberArray(3)},box2d.b2SimplexCache.prototype.metric=0,box2d.b2SimplexCache.prototype.count=0,box2d.b2SimplexCache.prototype.indexA=null,box2d.b2SimplexCache.prototype.indexB=null,box2d.b2SimplexCache.prototype.Reset=function(){return this.metric=0,this.count=0,this},box2d.b2DistanceInput=function(){this.proxyA=new box2d.b2DistanceProxy,this.proxyB=new box2d.b2DistanceProxy,this.transformA=new box2d.b2Transform,this.transformB=new box2d.b2Transform},box2d.b2DistanceInput.prototype.proxyA=null,box2d.b2DistanceInput.prototype.proxyB=null,box2d.b2DistanceInput.prototype.transformA=null,box2d.b2DistanceInput.prototype.transformB=null,box2d.b2DistanceInput.prototype.useRadii=!1,box2d.b2DistanceInput.prototype.Reset=function(){return this.proxyA.Reset(),this.proxyB.Reset(),this.transformA.SetIdentity(),this.transformB.SetIdentity(),this.useRadii=!1,this},box2d.b2DistanceOutput=function(){this.pointA=new box2d.b2Vec2,this.pointB=new box2d.b2Vec2},box2d.b2DistanceOutput.prototype.pointA=null,box2d.b2DistanceOutput.prototype.pointB=null,box2d.b2DistanceOutput.prototype.distance=0,box2d.b2DistanceOutput.prototype.iterations=0,box2d.b2DistanceOutput.prototype.Reset=function(){return this.pointA.SetZero(),this.pointB.SetZero(),this.distance=0,this.iterations=0,this},box2d.b2_gjkCalls=0,box2d.b2_gjkIters=0,box2d.b2_gjkMaxIters=0,box2d.b2SimplexVertex=function(){this.wA=new box2d.b2Vec2,this.wB=new box2d.b2Vec2,this.w=new box2d.b2Vec2},box2d.b2SimplexVertex.prototype.wA=null,box2d.b2SimplexVertex.prototype.wB=null,box2d.b2SimplexVertex.prototype.w=null,box2d.b2SimplexVertex.prototype.a=0,box2d.b2SimplexVertex.prototype.indexA=0,box2d.b2SimplexVertex.prototype.indexB=0,box2d.b2SimplexVertex.prototype.Copy=function(e){return this.wA.Copy(e.wA),this.wB.Copy(e.wB),this.w.Copy(e.w),this.a=e.a,this.indexA=e.indexA,this.indexB=e.indexB,this},box2d.b2Simplex=function(){this.m_v1=new box2d.b2SimplexVertex,this.m_v2=new box2d.b2SimplexVertex,this.m_v3=new box2d.b2SimplexVertex,this.m_vertices=new Array(3),this.m_vertices[0]=this.m_v1,this.m_vertices[1]=this.m_v2,this.m_vertices[2]=this.m_v3},box2d.b2Simplex.prototype.m_v1=null,box2d.b2Simplex.prototype.m_v2=null,box2d.b2Simplex.prototype.m_v3=null,box2d.b2Simplex.prototype.m_vertices=null,box2d.b2Simplex.prototype.m_count=0,box2d.b2Simplex.prototype.ReadCache=function(e,t,i,s,a){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0<=e.count&&e.count<=3),this.m_count=e.count;for(var n=this.m_vertices,o=0;o<this.m_count;++o){(p=n[o]).indexA=e.indexA[o],p.indexB=e.indexB[o];var r=t.GetVertex(p.indexA),l=s.GetVertex(p.indexB);box2d.b2MulXV(i,r,p.wA),box2d.b2MulXV(a,l,p.wB),box2d.b2SubVV(p.wB,p.wA,p.w),p.a=0}if(this.m_count>1){var h=e.metric,c=this.GetMetric();(.5*h>c||c>2*h||c<box2d.b2_epsilon)&&(this.m_count=0)}if(0===this.m_count){var p=n[0];p.indexA=0,p.indexB=0;var r=t.GetVertex(0),l=s.GetVertex(0);box2d.b2MulXV(i,r,p.wA),box2d.b2MulXV(a,l,p.wB),box2d.b2SubVV(p.wB,p.wA,p.w),p.a=1,this.m_count=1}},box2d.b2Simplex.prototype.WriteCache=function(e){e.metric=this.GetMetric(),e.count=this.m_count;for(var t=this.m_vertices,i=0;i<this.m_count;++i)e.indexA[i]=t[i].indexA,e.indexB[i]=t[i].indexB},box2d.b2Simplex.prototype.GetSearchDirection=function(e){switch(this.m_count){case 1:return box2d.b2NegV(this.m_v1.w,e);case 2:var t=box2d.b2SubVV(this.m_v2.w,this.m_v1.w,e);return box2d.b2CrossVV(t,box2d.b2NegV(this.m_v1.w,box2d.b2Vec2.s_t0))>0?box2d.b2CrossOneV(t,e):box2d.b2CrossVOne(t,e);default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),e.SetZero()}},box2d.b2Simplex.prototype.GetClosestPoint=function(e){switch(this.m_count){case 0:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),e.SetZero();case 1:return e.Copy(this.m_v1.w);case 2:return e.SetXY(this.m_v1.a*this.m_v1.w.x+this.m_v2.a*this.m_v2.w.x,this.m_v1.a*this.m_v1.w.y+this.m_v2.a*this.m_v2.w.y);case 3:return e.SetZero();default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),e.SetZero()}},box2d.b2Simplex.prototype.GetWitnessPoints=function(e,t){switch(this.m_count){case 0:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1);break;case 1:e.Copy(this.m_v1.wA),t.Copy(this.m_v1.wB);break;case 2:e.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x,e.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y,t.x=this.m_v1.a*this.m_v1.wB.x+this.m_v2.a*this.m_v2.wB.x,t.y=this.m_v1.a*this.m_v1.wB.y+this.m_v2.a*this.m_v2.wB.y;break;case 3:t.x=e.x=this.m_v1.a*this.m_v1.wA.x+this.m_v2.a*this.m_v2.wA.x+this.m_v3.a*this.m_v3.wA.x,t.y=e.y=this.m_v1.a*this.m_v1.wA.y+this.m_v2.a*this.m_v2.wA.y+this.m_v3.a*this.m_v3.wA.y;break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}},box2d.b2Simplex.prototype.GetMetric=function(){switch(this.m_count){case 0:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0;case 1:return 0;case 2:return box2d.b2DistanceVV(this.m_v1.w,this.m_v2.w);case 3:return box2d.b2CrossVV(box2d.b2SubVV(this.m_v2.w,this.m_v1.w,box2d.b2Vec2.s_t0),box2d.b2SubVV(this.m_v3.w,this.m_v1.w,box2d.b2Vec2.s_t1));default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0}},box2d.b2Simplex.prototype.Solve2=function(){var e=this.m_v1.w,t=this.m_v2.w,i=box2d.b2SubVV(t,e,box2d.b2Simplex.s_e12),s=-box2d.b2DotVV(e,i);if(0>=s)return this.m_v1.a=1,void(this.m_count=1);var a=box2d.b2DotVV(t,i);if(0>=a)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);var n=1/(a+s);this.m_v1.a=a*n,this.m_v2.a=s*n,this.m_count=2},box2d.b2Simplex.prototype.Solve3=function(){var e=this.m_v1.w,t=this.m_v2.w,i=this.m_v3.w,s=box2d.b2SubVV(t,e,box2d.b2Simplex.s_e12),a=box2d.b2DotVV(e,s),n=box2d.b2DotVV(t,s),o=-a,r=box2d.b2SubVV(i,e,box2d.b2Simplex.s_e13),l=box2d.b2DotVV(e,r),h=box2d.b2DotVV(i,r),c=-l,p=box2d.b2SubVV(i,t,box2d.b2Simplex.s_e23),d=box2d.b2DotVV(t,p),u=box2d.b2DotVV(i,p),m=-d,g=box2d.b2CrossVV(s,r),y=g*box2d.b2CrossVV(t,i),b=g*box2d.b2CrossVV(i,e),x=g*box2d.b2CrossVV(e,t);if(0>=o&&0>=c)return this.m_v1.a=1,void(this.m_count=1);if(n>0&&o>0&&0>=x){var v=1/(n+o);return this.m_v1.a=n*v,this.m_v2.a=o*v,void(this.m_count=2)}if(h>0&&c>0&&0>=b){var f=1/(h+c);return this.m_v1.a=h*f,this.m_v3.a=c*f,this.m_count=2,void this.m_v2.Copy(this.m_v3)}if(0>=n&&0>=m)return this.m_v2.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v2);if(0>=h&&0>=u)return this.m_v3.a=1,this.m_count=1,void this.m_v1.Copy(this.m_v3);if(u>0&&m>0&&0>=y){var w=1/(u+m);return this.m_v2.a=u*w,this.m_v3.a=m*w,this.m_count=2,void this.m_v1.Copy(this.m_v3)}var k=1/(y+b+x);this.m_v1.a=y*k,this.m_v2.a=b*k,this.m_v3.a=x*k,this.m_count=3},box2d.b2Simplex.s_e12=new box2d.b2Vec2,box2d.b2Simplex.s_e13=new box2d.b2Vec2,box2d.b2Simplex.s_e23=new box2d.b2Vec2,box2d.b2Distance=function(e,t,i){++box2d.b2_gjkCalls;var s=i.proxyA,a=i.proxyB,n=i.transformA,o=i.transformB,r=box2d.b2Distance.s_simplex;r.ReadCache(t,s,n,a,o);for(var l=r.m_vertices,h=box2d.b2Distance.s_saveA,c=box2d.b2Distance.s_saveB,p=0,d=(box2d.b2_maxFloat,0);20>d;){p=r.m_count;for(y=0;p>y;++y)h[y]=l[y].indexA,c[y]=l[y].indexB;switch(r.m_count){case 1:break;case 2:r.Solve2();break;case 3:r.Solve3();break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}if(3===r.m_count)break;(f=r.GetClosestPoint(box2d.b2Distance.s_p)).GetLengthSquared();var u=r.GetSearchDirection(box2d.b2Distance.s_d);if(u.GetLengthSquared()<box2d.b2_epsilon_sq)break;var m=l[r.m_count];m.indexA=s.GetSupport(box2d.b2MulTRV(n.q,box2d.b2NegV(u,box2d.b2Vec2.s_t0),box2d.b2Distance.s_supportA)),box2d.b2MulXV(n,s.GetVertex(m.indexA),m.wA),m.indexB=a.GetSupport(box2d.b2MulTRV(o.q,u,box2d.b2Distance.s_supportB)),box2d.b2MulXV(o,a.GetVertex(m.indexB),m.wB),box2d.b2SubVV(m.wB,m.wA,m.w),++d,++box2d.b2_gjkIters;for(var g=!1,y=0;p>y;++y)if(m.indexA===h[y]&&m.indexB===c[y]){g=!0;break}if(g)break;++r.m_count}if(box2d.b2_gjkMaxIters=box2d.b2Max(box2d.b2_gjkMaxIters,d),r.GetWitnessPoints(e.pointA,e.pointB),e.distance=box2d.b2DistanceVV(e.pointA,e.pointB),e.iterations=d,r.WriteCache(t),i.useRadii){var b=s.m_radius,x=a.m_radius;if(e.distance>b+x&&e.distance>box2d.b2_epsilon){e.distance-=b+x;var v=box2d.b2SubVV(e.pointB,e.pointA,box2d.b2Distance.s_normal);v.Normalize(),e.pointA.SelfMulAdd(b,v),e.pointB.SelfMulSub(x,v)}else{var f=box2d.b2MidVV(e.pointA,e.pointB,box2d.b2Distance.s_p);e.pointA.Copy(f),e.pointB.Copy(f),e.distance=0}}},box2d.b2Distance.s_simplex=new box2d.b2Simplex,box2d.b2Distance.s_saveA=box2d.b2MakeNumberArray(3),box2d.b2Distance.s_saveB=box2d.b2MakeNumberArray(3),box2d.b2Distance.s_p=new box2d.b2Vec2,box2d.b2Distance.s_d=new box2d.b2Vec2,box2d.b2Distance.s_normal=new box2d.b2Vec2,box2d.b2Distance.s_supportA=new box2d.b2Vec2,box2d.b2Distance.s_supportB=new box2d.b2Vec2,goog.provide("box2d.b2WeldJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Joint"),goog.require("box2d.b2Math"),box2d.b2WeldJointDef=function(){goog.base(this,box2d.b2JointType.e_weldJoint),this.localAnchorA=new box2d.b2Vec2,this.localAnchorB=new box2d.b2Vec2},goog.inherits(box2d.b2WeldJointDef,box2d.b2JointDef),box2d.b2WeldJointDef.prototype.localAnchorA=null,box2d.b2WeldJointDef.prototype.localAnchorB=null,box2d.b2WeldJointDef.prototype.referenceAngle=0,box2d.b2WeldJointDef.prototype.frequencyHz=0,box2d.b2WeldJointDef.prototype.dampingRatio=0,box2d.b2WeldJointDef.prototype.Initialize=function(e,t,i){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.referenceAngle=this.bodyB.GetAngleRadians()-this.bodyA.GetAngleRadians()},box2d.b2WeldJoint=function(e){goog.base(this,e),this.m_frequencyHz=e.frequencyHz,this.m_dampingRatio=e.dampingRatio,this.m_localAnchorA=e.localAnchorA.Clone(),this.m_localAnchorB=e.localAnchorB.Clone(),this.m_referenceAngle=e.referenceAngle,this.m_impulse=new box2d.b2Vec3(0,0,0),this.m_rA=new box2d.b2Vec2,this.m_rB=new box2d.b2Vec2,this.m_localCenterA=new box2d.b2Vec2,this.m_localCenterB=new box2d.b2Vec2,this.m_mass=new box2d.b2Mat33,this.m_qA=new box2d.b2Rot,this.m_qB=new box2d.b2Rot,this.m_lalcA=new box2d.b2Vec2,this.m_lalcB=new box2d.b2Vec2,this.m_K=new box2d.b2Mat33},goog.inherits(box2d.b2WeldJoint,box2d.b2Joint),box2d.b2WeldJoint.prototype.m_frequencyHz=0,box2d.b2WeldJoint.prototype.m_dampingRatio=0,box2d.b2WeldJoint.prototype.m_bias=0,box2d.b2WeldJoint.prototype.m_localAnchorA=null,box2d.b2WeldJoint.prototype.m_localAnchorB=null,box2d.b2WeldJoint.prototype.m_referenceAngle=0,box2d.b2WeldJoint.prototype.m_gamma=0,box2d.b2WeldJoint.prototype.m_impulse=null,box2d.b2WeldJoint.prototype.m_indexA=0,box2d.b2WeldJoint.prototype.m_indexB=0,box2d.b2WeldJoint.prototype.m_rA=null,box2d.b2WeldJoint.prototype.m_rB=null,box2d.b2WeldJoint.prototype.m_localCenterA=null,box2d.b2WeldJoint.prototype.m_localCenterB=null,box2d.b2WeldJoint.prototype.m_invMassA=0,box2d.b2WeldJoint.prototype.m_invMassB=0,box2d.b2WeldJoint.prototype.m_invIA=0,box2d.b2WeldJoint.prototype.m_invIB=0,box2d.b2WeldJoint.prototype.m_mass=null,box2d.b2WeldJoint.prototype.m_qA=null,box2d.b2WeldJoint.prototype.m_qB=null,box2d.b2WeldJoint.prototype.m_lalcA=null,box2d.b2WeldJoint.prototype.m_lalcB=null,box2d.b2WeldJoint.prototype.m_K=null,box2d.b2WeldJoint.prototype.InitVelocityConstraints=function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].a,i=e.velocities[this.m_indexA].v,s=e.velocities[this.m_indexA].w,a=e.positions[this.m_indexB].a,n=e.velocities[this.m_indexB].v,o=e.velocities[this.m_indexB].w,r=this.m_qA.SetAngleRadians(t),l=this.m_qB.SetAngleRadians(a);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),box2d.b2MulRV(r,this.m_lalcA,this.m_rA),box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),box2d.b2MulRV(l,this.m_lalcB,this.m_rB);var h=this.m_invMassA,c=this.m_invMassB,p=this.m_invIA,d=this.m_invIB,u=this.m_K;if(u.ex.x=h+c+this.m_rA.y*this.m_rA.y*p+this.m_rB.y*this.m_rB.y*d,u.ey.x=-this.m_rA.y*this.m_rA.x*p-this.m_rB.y*this.m_rB.x*d,u.ez.x=-this.m_rA.y*p-this.m_rB.y*d,u.ex.y=u.ey.x,u.ey.y=h+c+this.m_rA.x*this.m_rA.x*p+this.m_rB.x*this.m_rB.x*d,u.ez.y=this.m_rA.x*p+this.m_rB.x*d,u.ex.z=u.ez.x,u.ey.z=u.ez.y,u.ez.z=p+d,this.m_frequencyHz>0){u.GetInverse22(this.m_mass);var m=p+d,g=m>0?1/m:0,y=a-t-this.m_referenceAngle,b=2*box2d.b2_pi*this.m_frequencyHz,x=2*g*this.m_dampingRatio*b,v=g*b*b,f=e.step.dt;this.m_gamma=f*(x+f*v),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=y*f*v*this.m_gamma,m+=this.m_gamma,this.m_mass.ez.z=0!==m?1/m:0}else u.GetSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0;if(e.step.warmStarting){this.m_impulse.SelfMul(e.step.dtRatio);var w=box2d.b2WeldJoint.prototype.InitVelocityConstraints.s_P.SetXY(this.m_impulse.x,this.m_impulse.y);i.SelfMulSub(h,w),s-=p*(box2d.b2CrossVV(this.m_rA,w)+this.m_impulse.z),n.SelfMulAdd(c,w),o+=d*(box2d.b2CrossVV(this.m_rB,w)+this.m_impulse.z)}else this.m_impulse.SetZero();e.velocities[this.m_indexA].w=s,e.velocities[this.m_indexB].w=o},box2d.b2WeldJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2WeldJoint.prototype.SolveVelocityConstraints=function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,n=this.m_invMassA,o=this.m_invMassB,r=this.m_invIA,l=this.m_invIB;if(this.m_frequencyHz>0){var h=a-i,c=-this.m_mass.ez.z*(h+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=c,i-=r*c,a+=l*c;var p=box2d.b2SubVV(box2d.b2AddVCrossSV(s,a,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(t,i,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1),d=box2d.b2MulM33XY(this.m_mass,p.x,p.y,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse1).SelfNeg();this.m_impulse.x+=d.x,this.m_impulse.y+=d.y;m=d;t.SelfMulSub(n,m),i-=r*box2d.b2CrossVV(this.m_rA,m),s.SelfMulAdd(o,m),a+=l*box2d.b2CrossVV(this.m_rB,m)}else{var p=box2d.b2SubVV(box2d.b2AddVCrossSV(s,a,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(t,i,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1),h=a-i,u=box2d.b2MulM33XYZ(this.m_mass,p.x,p.y,h,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse).SelfNeg();this.m_impulse.SelfAdd(u);var m=box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_P.SetXY(u.x,u.y);t.SelfMulSub(n,m),i-=r*(box2d.b2CrossVV(this.m_rA,m)+u.z),s.SelfMulAdd(o,m),a+=l*(box2d.b2CrossVV(this.m_rB,m)+u.z)}e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=a},box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_Cdot1=new box2d.b2Vec2,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse1=new box2d.b2Vec2,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec3,box2d.b2WeldJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2WeldJoint.prototype.SolvePositionConstraints=function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.positions[this.m_indexB].c,a=e.positions[this.m_indexB].a,n=this.m_qA.SetAngleRadians(i),o=this.m_qB.SetAngleRadians(a),r=this.m_invMassA,l=this.m_invMassB,h=this.m_invIA,c=this.m_invIB;box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var p=box2d.b2MulRV(n,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var d,u,m=box2d.b2MulRV(o,this.m_lalcB,this.m_rB),g=this.m_K;if(g.ex.x=r+l+p.y*p.y*h+m.y*m.y*c,g.ey.x=-p.y*p.x*h-m.y*m.x*c,g.ez.x=-p.y*h-m.y*c,g.ex.y=g.ey.x,g.ey.y=r+l+p.x*p.x*h+m.x*m.x*c,g.ez.y=p.x*h+m.x*c,g.ex.z=g.ez.x,g.ey.z=g.ez.y,g.ez.z=h+c,this.m_frequencyHz>0){d=(y=box2d.b2SubVV(box2d.b2AddVV(s,m,box2d.b2Vec2.s_t0),box2d.b2AddVV(t,p,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1)).GetLength(),u=0;v=g.Solve22(y.x,y.y,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P).SelfNeg();t.SelfMulSub(r,v),i-=h*box2d.b2CrossVV(p,v),s.SelfMulAdd(l,v),a+=c*box2d.b2CrossVV(m,v)}else{var y=box2d.b2SubVV(box2d.b2AddVV(s,m,box2d.b2Vec2.s_t0),box2d.b2AddVV(t,p,box2d.b2Vec2.s_t1),box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1),b=a-i-this.m_referenceAngle;d=y.GetLength(),u=box2d.b2Abs(b);var x=g.Solve33(y.x,y.y,b,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse).SelfNeg(),v=box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P.SetXY(x.x,x.y);t.SelfMulSub(r,v),i-=h*(box2d.b2CrossVV(this.m_rA,v)+x.z),s.SelfMulAdd(l,v),a+=c*(box2d.b2CrossVV(this.m_rB,v)+x.z)}return e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=a,d<=box2d.b2_linearSlop&&u<=box2d.b2_angularSlop},box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_C1=new box2d.b2Vec2,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2,box2d.b2WeldJoint.prototype.SolvePositionConstraints.s_impulse=new box2d.b2Vec3,box2d.b2WeldJoint.prototype.GetAnchorA=function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)},box2d.b2WeldJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)},box2d.b2WeldJoint.prototype.GetReactionForce=function(e,t){return t.SetXY(e*this.m_impulse.x,e*this.m_impulse.y)},box2d.b2WeldJoint.prototype.GetReactionTorque=function(e){return e*this.m_impulse.z},box2d.b2WeldJoint.prototype.GetLocalAnchorA=function(e){return e.Copy(this.m_localAnchorA)},box2d.b2WeldJoint.prototype.GetLocalAnchorB=function(e){return e.Copy(this.m_localAnchorB)},box2d.b2WeldJoint.prototype.GetReferenceAngle=function(){return this.m_referenceAngle},box2d.b2WeldJoint.prototype.SetFrequency=function(e){this.m_frequencyHz=e},box2d.b2WeldJoint.prototype.GetFrequency=function(){return this.m_frequencyHz},box2d.b2WeldJoint.prototype.SetDampingRatio=function(e){this.m_dampingRatio=e},box2d.b2WeldJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio},box2d.b2WeldJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,t=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2WeldJointDef*/ var jd = new box2d.b2WeldJointDef();\n"),box2d.b2Log("  jd.bodyA = bodies[%d];\n",e),box2d.b2Log("  jd.bodyB = bodies[%d];\n",t),box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),box2d.b2Log("  jd.referenceAngle = %.15f;\n",this.m_referenceAngle),box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},goog.provide("box2d.b2RopeJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Joint"),goog.require("box2d.b2Math"),box2d.b2RopeJointDef=function(){goog.base(this,box2d.b2JointType.e_ropeJoint),this.localAnchorA=new box2d.b2Vec2(-1,0),this.localAnchorB=new box2d.b2Vec2(1,0)},goog.inherits(box2d.b2RopeJointDef,box2d.b2JointDef),box2d.b2RopeJointDef.prototype.localAnchorA=null,box2d.b2RopeJointDef.prototype.localAnchorB=null,box2d.b2RopeJointDef.prototype.maxLength=0,box2d.b2RopeJoint=function(e){goog.base(this,e),this.m_localAnchorA=e.localAnchorA.Clone(),this.m_localAnchorB=e.localAnchorB.Clone(),this.m_maxLength=e.maxLength,this.m_u=new box2d.b2Vec2,this.m_rA=new box2d.b2Vec2,this.m_rB=new box2d.b2Vec2,this.m_localCenterA=new box2d.b2Vec2,this.m_localCenterB=new box2d.b2Vec2,this.m_qA=new box2d.b2Rot,this.m_qB=new box2d.b2Rot,this.m_lalcA=new box2d.b2Vec2,this.m_lalcB=new box2d.b2Vec2},goog.inherits(box2d.b2RopeJoint,box2d.b2Joint),box2d.b2RopeJoint.prototype.m_localAnchorA=null,box2d.b2RopeJoint.prototype.m_localAnchorB=null,box2d.b2RopeJoint.prototype.m_maxLength=0,box2d.b2RopeJoint.prototype.m_length=0,box2d.b2RopeJoint.prototype.m_impulse=0,box2d.b2RopeJoint.prototype.m_indexA=0,box2d.b2RopeJoint.prototype.m_indexB=0,box2d.b2RopeJoint.prototype.m_u=null,box2d.b2RopeJoint.prototype.m_rA=null,box2d.b2RopeJoint.prototype.m_rB=null,box2d.b2RopeJoint.prototype.m_localCenterA=null,box2d.b2RopeJoint.prototype.m_localCenterB=null,box2d.b2RopeJoint.prototype.m_invMassA=0,box2d.b2RopeJoint.prototype.m_invMassB=0,box2d.b2RopeJoint.prototype.m_invIA=0,box2d.b2RopeJoint.prototype.m_invIB=0,box2d.b2RopeJoint.prototype.m_mass=0,box2d.b2RopeJoint.prototype.m_state=box2d.b2LimitState.e_inactiveLimit,box2d.b2RopeJoint.prototype.m_qA=null,box2d.b2RopeJoint.prototype.m_qB=null,box2d.b2RopeJoint.prototype.m_lalcA=null,box2d.b2RopeJoint.prototype.m_lalcB=null,box2d.b2RopeJoint.prototype.InitVelocityConstraints=function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.velocities[this.m_indexA].v,a=e.velocities[this.m_indexA].w,n=e.positions[this.m_indexB].c,o=e.positions[this.m_indexB].a,r=e.velocities[this.m_indexB].v,l=e.velocities[this.m_indexB].w,h=this.m_qA.SetAngleRadians(i),c=this.m_qB.SetAngleRadians(o);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),box2d.b2MulRV(h,this.m_lalcA,this.m_rA),box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),box2d.b2MulRV(c,this.m_lalcB,this.m_rB),this.m_u.Copy(n).SelfAdd(this.m_rB).SelfSub(t).SelfSub(this.m_rA),this.m_length=this.m_u.GetLength();var p=this.m_length-this.m_maxLength;if(this.m_state=p>0?box2d.b2LimitState.e_atUpperLimit:box2d.b2LimitState.e_inactiveLimit,!(this.m_length>box2d.b2_linearSlop))return this.m_u.SetZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.SelfMul(1/this.m_length);var d=box2d.b2CrossVV(this.m_rA,this.m_u),u=box2d.b2CrossVV(this.m_rB,this.m_u),m=this.m_invMassA+this.m_invIA*d*d+this.m_invMassB+this.m_invIB*u*u;if(this.m_mass=0!==m?1/m:0,e.step.warmStarting){this.m_impulse*=e.step.dtRatio;var g=box2d.b2MulSV(this.m_impulse,this.m_u,box2d.b2RopeJoint.prototype.InitVelocityConstraints.s_P);s.SelfMulSub(this.m_invMassA,g),a-=this.m_invIA*box2d.b2CrossVV(this.m_rA,g),r.SelfMulAdd(this.m_invMassB,g),l+=this.m_invIB*box2d.b2CrossVV(this.m_rB,g)}else this.m_impulse=0;e.velocities[this.m_indexA].w=a,e.velocities[this.m_indexB].w=l},box2d.b2RopeJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2RopeJoint.prototype.SolveVelocityConstraints=function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,n=box2d.b2AddVCrossSV(t,i,this.m_rA,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpA),o=box2d.b2AddVCrossSV(s,a,this.m_rB,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpB),r=this.m_length-this.m_maxLength,l=box2d.b2DotVV(this.m_u,box2d.b2SubVV(o,n,box2d.b2Vec2.s_t0));0>r&&(l+=e.step.inv_dt*r);var h=-this.m_mass*l,c=this.m_impulse;this.m_impulse=box2d.b2Min(0,this.m_impulse+h),h=this.m_impulse-c;var p=box2d.b2MulSV(h,this.m_u,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_P);t.SelfMulSub(this.m_invMassA,p),i-=this.m_invIA*box2d.b2CrossVV(this.m_rA,p),s.SelfMulAdd(this.m_invMassB,p),a+=this.m_invIB*box2d.b2CrossVV(this.m_rB,p),e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=a},box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2,box2d.b2RopeJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2RopeJoint.prototype.SolvePositionConstraints=function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.positions[this.m_indexB].c,a=e.positions[this.m_indexB].a,n=this.m_qA.SetAngleRadians(i),o=this.m_qB.SetAngleRadians(a);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var r=box2d.b2MulRV(n,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var l=box2d.b2MulRV(o,this.m_lalcB,this.m_rB),h=this.m_u.Copy(s).SelfAdd(l).SelfSub(t).SelfSub(r),c=h.Normalize(),p=c-this.m_maxLength;p=box2d.b2Clamp(p,0,box2d.b2_maxLinearCorrection);var d=-this.m_mass*p,u=box2d.b2MulSV(d,h,box2d.b2RopeJoint.prototype.SolvePositionConstraints.s_P);return t.SelfMulSub(this.m_invMassA,u),i-=this.m_invIA*box2d.b2CrossVV(r,u),s.SelfMulAdd(this.m_invMassB,u),a+=this.m_invIB*box2d.b2CrossVV(l,u),e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=a,c-this.m_maxLength<box2d.b2_linearSlop},box2d.b2RopeJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2,box2d.b2RopeJoint.prototype.GetAnchorA=function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)},box2d.b2RopeJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)},box2d.b2RopeJoint.prototype.GetReactionForce=function(e,t){return box2d.b2MulSV(e*this.m_impulse,this.m_u,t)},box2d.b2RopeJoint.prototype.GetReactionTorque=function(){return 0},box2d.b2RopeJoint.prototype.GetLocalAnchorA=function(e){return e.Copy(this.m_localAnchorA)},box2d.b2RopeJoint.prototype.GetLocalAnchorB=function(e){return e.Copy(this.m_localAnchorB)},box2d.b2RopeJoint.prototype.SetMaxLength=function(e){this.m_maxLength=e},box2d.b2RopeJoint.prototype.GetMaxLength=function(){return this.m_maxLength},box2d.b2RopeJoint.prototype.GetLimitState=function(){return this.m_state},box2d.b2RopeJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,t=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2RopeJointDef*/ var jd = new box2d.b2RopeJointDef();\n"),box2d.b2Log("  jd.bodyA = bodies[%d];\n",e),box2d.b2Log("  jd.bodyB = bodies[%d];\n",t),box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),box2d.b2Log("  jd.maxLength = %.15f;\n",this.m_maxLength),box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},goog.provide("box2d.b2GravityController"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Controller"),goog.require("box2d.b2Math"),box2d.b2GravityController=function(){goog.base(this)},goog.inherits(box2d.b2GravityController,box2d.b2Controller),box2d.b2GravityController.prototype.G=1,box2d.b2GravityController.prototype.invSqr=!0,box2d.b2GravityController.prototype.Step=function(){if(this.invSqr)for(o=this.m_bodyList;o;o=o.nextBody)for(var e=o.body,t=e.GetWorldCenter(),i=e.GetMass(),s=this.m_bodyList;s!==o;s=s.nextBody){var a=(r=s.body).GetWorldCenter(),n=r.GetMass();(c=(l=a.x-t.x)*l+(h=a.y-t.y)*h)<box2d.b2_epsilon||((p=box2d.b2GravityController.prototype.Step.s_f.SetXY(l,h)).SelfMul(this.G/c/box2d.b2Sqrt(c)*i*n),e.IsAwake()&&e.ApplyForce(p,t),r.IsAwake()&&r.ApplyForce(p.SelfMul(-1),a))}else for(var o=this.m_bodyList;o;o=o.nextBody)for(var e=o.body,t=e.GetWorldCenter(),i=e.GetMass(),s=this.m_bodyList;s!==o;s=s.nextBody){var r=s.body,a=r.GetWorldCenter(),n=r.GetMass(),l=a.x-t.x,h=a.y-t.y,c=l*l+h*h;if(!(c<box2d.b2_epsilon)){var p=box2d.b2GravityController.prototype.Step.s_f.SetXY(l,h);p.SelfMul(this.G/c*i*n),e.IsAwake()&&e.ApplyForce(p,t),r.IsAwake()&&r.ApplyForce(p.SelfMul(-1),a)}}},box2d.b2GravityController.prototype.Step.s_f=new box2d.b2Vec2,goog.provide("box2d.b2TimeStep"),goog.require("box2d.b2Settings"),box2d.b2Profile=function(){},box2d.b2Profile.prototype.step=0,box2d.b2Profile.prototype.collide=0,box2d.b2Profile.prototype.solve=0,box2d.b2Profile.prototype.solveInit=0,box2d.b2Profile.prototype.solveVelocity=0,box2d.b2Profile.prototype.solvePosition=0,box2d.b2Profile.prototype.broadphase=0,box2d.b2Profile.prototype.solveTOI=0,box2d.b2Profile.prototype.Reset=function(){return this.step=0,this.collide=0,this.solve=0,this.solveInit=0,this.solveVelocity=0,this.solvePosition=0,this.broadphase=0,this.solveTOI=0,this},box2d.b2TimeStep=function(){},box2d.b2TimeStep.prototype.dt=0,box2d.b2TimeStep.prototype.inv_dt=0,box2d.b2TimeStep.prototype.dtRatio=0,box2d.b2TimeStep.prototype.velocityIterations=0,box2d.b2TimeStep.prototype.positionIterations=0,box2d.b2TimeStep.prototype.warmStarting=!1,box2d.b2TimeStep.prototype.Copy=function(e){return this.dt=e.dt,this.inv_dt=e.inv_dt,this.dtRatio=e.dtRatio,this.positionIterations=e.positionIterations,this.velocityIterations=e.velocityIterations,this.warmStarting=e.warmStarting,this},box2d.b2Position=function(){this.c=new box2d.b2Vec2},box2d.b2Position.prototype.c=null,box2d.b2Position.prototype.a=0,box2d.b2Position.MakeArray=function(e){return box2d.b2MakeArray(e,function(){return new box2d.b2Position})},box2d.b2Velocity=function(){this.v=new box2d.b2Vec2},box2d.b2Velocity.prototype.v=null,box2d.b2Velocity.prototype.w=0,box2d.b2Velocity.MakeArray=function(e){return box2d.b2MakeArray(e,function(){return new box2d.b2Velocity})},box2d.b2SolverData=function(){this.step=new box2d.b2TimeStep},box2d.b2SolverData.prototype.step=null,box2d.b2SolverData.prototype.positions=null,box2d.b2SolverData.prototype.velocities=null,goog.provide("box2d.b2Collision"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Math"),goog.require("box2d.b2Distance"),box2d.b2ContactFeatureType={e_vertex:0,e_face:1},goog.exportProperty(box2d.b2ContactFeatureType,"e_vertex",box2d.b2ContactFeatureType.e_vertex),goog.exportProperty(box2d.b2ContactFeatureType,"e_face",box2d.b2ContactFeatureType.e_face),box2d.b2ContactFeature=function(e){this._id=e},box2d.b2ContactFeature.prototype._id=null,box2d.b2ContactFeature.prototype._indexA=0,box2d.b2ContactFeature.prototype._indexB=0,box2d.b2ContactFeature.prototype._typeA=0,box2d.b2ContactFeature.prototype._typeB=0,Object.defineProperty(box2d.b2ContactFeature.prototype,"indexA",{enumerable:!1,configurable:!0,get:function(){return this._indexA},set:function(e){this._indexA=e,this._id._key=4294967040&this._id._key|255&this._indexA}}),Object.defineProperty(box2d.b2ContactFeature.prototype,"indexB",{enumerable:!1,configurable:!0,get:function(){return this._indexB},set:function(e){this._indexB=e,this._id._key=4294902015&this._id._key|this._indexB<<8&65280}}),Object.defineProperty(box2d.b2ContactFeature.prototype,"typeA",{enumerable:!1,configurable:!0,get:function(){return this._typeA},set:function(e){this._typeA=e,this._id._key=4278255615&this._id._key|this._typeA<<16&16711680}}),Object.defineProperty(box2d.b2ContactFeature.prototype,"typeB",{enumerable:!1,configurable:!0,get:function(){return this._typeB},set:function(e){this._typeB=e,this._id._key=16777215&this._id._key|this._typeB<<24&4278190080}}),box2d.b2ContactID=function(){this.cf=new box2d.b2ContactFeature(this)},box2d.b2ContactID.prototype.cf=null,box2d.b2ContactID.prototype.key=0,box2d.b2ContactID.prototype.Copy=function(e){return this.key=e.key,this},box2d.b2ContactID.prototype.Clone=function(){return(new box2d.b2ContactID).Copy(this)},Object.defineProperty(box2d.b2ContactID.prototype,"key",{enumerable:!1,configurable:!0,get:function(){return this._key},set:function(e){this._key=e,this.cf._indexA=255&this._key,this.cf._indexB=this._key>>8&255,this.cf._typeA=this._key>>16&255,this.cf._typeB=this._key>>24&255}}),box2d.b2ManifoldPoint=function(){this.localPoint=new box2d.b2Vec2,this.id=new box2d.b2ContactID},box2d.b2ManifoldPoint.prototype.localPoint=null,box2d.b2ManifoldPoint.prototype.normalImpulse=0,box2d.b2ManifoldPoint.prototype.tangentImpulse=0,box2d.b2ManifoldPoint.prototype.id=null,box2d.b2ManifoldPoint.MakeArray=function(e){return box2d.b2MakeArray(e,function(){return new box2d.b2ManifoldPoint})},box2d.b2ManifoldPoint.prototype.Reset=function(){this.localPoint.SetZero(),this.normalImpulse=0,this.tangentImpulse=0,this.id.key=0},box2d.b2ManifoldPoint.prototype.Copy=function(e){return this.localPoint.Copy(e.localPoint),this.normalImpulse=e.normalImpulse,this.tangentImpulse=e.tangentImpulse,this.id.Copy(e.id),this},box2d.b2ManifoldType={e_unknown:-1,e_circles:0,e_faceA:1,e_faceB:2},goog.exportProperty(box2d.b2ManifoldType,"e_unknown",box2d.b2ManifoldType.e_unknown),goog.exportProperty(box2d.b2ManifoldType,"e_circles",box2d.b2ManifoldType.e_circles),goog.exportProperty(box2d.b2ManifoldType,"e_faceA",box2d.b2ManifoldType.e_faceA),goog.exportProperty(box2d.b2ManifoldType,"e_faceB",box2d.b2ManifoldType.e_faceB),box2d.b2Manifold=function(){this.points=box2d.b2ManifoldPoint.MakeArray(box2d.b2_maxManifoldPoints),this.localNormal=new box2d.b2Vec2,this.localPoint=new box2d.b2Vec2,this.type=box2d.b2ManifoldType.e_unknown,this.pointCount=0},box2d.b2Manifold.prototype.points=null,box2d.b2Manifold.prototype.localNormal=null,box2d.b2Manifold.prototype.localPoint=null,box2d.b2Manifold.prototype.type=box2d.b2ManifoldType.e_unknown,box2d.b2Manifold.prototype.pointCount=0,box2d.b2Manifold.prototype.Reset=function(){for(var e=0,t=box2d.b2_maxManifoldPoints;t>e;++e)this.points[e].Reset();this.localNormal.SetZero(),this.localPoint.SetZero(),this.type=box2d.b2ManifoldType.e_unknown,this.pointCount=0},box2d.b2Manifold.prototype.Copy=function(e){this.pointCount=e.pointCount;for(var t=0,i=box2d.b2_maxManifoldPoints;i>t;++t)this.points[t].Copy(e.points[t]);return this.localNormal.Copy(e.localNormal),this.localPoint.Copy(e.localPoint),this.type=e.type,this},box2d.b2Manifold.prototype.Clone=function(){return(new box2d.b2Manifold).Copy(this)},box2d.b2WorldManifold=function(){this.normal=new box2d.b2Vec2,this.points=box2d.b2Vec2.MakeArray(box2d.b2_maxManifoldPoints),this.separations=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints)},box2d.b2WorldManifold.prototype.normal=null,box2d.b2WorldManifold.prototype.points=null,box2d.b2WorldManifold.prototype.separations=null,box2d.b2WorldManifold.prototype.Initialize=function(e,t,i,s,a){if(0!==e.pointCount)switch(e.type){case box2d.b2ManifoldType.e_circles:this.normal.SetXY(1,0);var n=box2d.b2MulXV(t,e.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_pointA),o=box2d.b2MulXV(s,e.points[0].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_pointB);box2d.b2DistanceSquaredVV(n,o)>box2d.b2_epsilon_sq&&box2d.b2SubVV(o,n,this.normal).SelfNormalize();var r=box2d.b2AddVMulSV(n,i,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),l=box2d.b2SubVMulSV(o,a,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB);box2d.b2MidVV(r,l,this.points[0]),this.separations[0]=box2d.b2DotVV(box2d.b2SubVV(l,r,box2d.b2Vec2.s_t0),this.normal);break;case box2d.b2ManifoldType.e_faceA:box2d.b2MulRV(t.q,e.localNormal,this.normal);for(var h=box2d.b2MulXV(t,e.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_planePoint),c=0,p=e.pointCount;p>c;++c){var d=box2d.b2MulXV(s,e.points[c].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint),u=i-box2d.b2DotVV(box2d.b2SubVV(d,h,box2d.b2Vec2.s_t0),this.normal),r=box2d.b2AddVMulSV(d,u,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA),l=box2d.b2SubVMulSV(d,a,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB);box2d.b2MidVV(r,l,this.points[c]),this.separations[c]=box2d.b2DotVV(box2d.b2SubVV(l,r,box2d.b2Vec2.s_t0),this.normal)}break;case box2d.b2ManifoldType.e_faceB:box2d.b2MulRV(s.q,e.localNormal,this.normal);for(var h=box2d.b2MulXV(s,e.localPoint,box2d.b2WorldManifold.prototype.Initialize.s_planePoint),c=0,p=e.pointCount;p>c;++c){var d=box2d.b2MulXV(t,e.points[c].localPoint,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint),u=a-box2d.b2DotVV(box2d.b2SubVV(d,h,box2d.b2Vec2.s_t0),this.normal),l=box2d.b2AddVMulSV(d,u,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cB),r=box2d.b2SubVMulSV(d,i,this.normal,box2d.b2WorldManifold.prototype.Initialize.s_cA);box2d.b2MidVV(r,l,this.points[c]),this.separations[c]=box2d.b2DotVV(box2d.b2SubVV(r,l,box2d.b2Vec2.s_t0),this.normal)}this.normal.SelfNeg()}},box2d.b2WorldManifold.prototype.Initialize.s_pointA=new box2d.b2Vec2,box2d.b2WorldManifold.prototype.Initialize.s_pointB=new box2d.b2Vec2,box2d.b2WorldManifold.prototype.Initialize.s_cA=new box2d.b2Vec2,box2d.b2WorldManifold.prototype.Initialize.s_cB=new box2d.b2Vec2,box2d.b2WorldManifold.prototype.Initialize.s_planePoint=new box2d.b2Vec2,box2d.b2WorldManifold.prototype.Initialize.s_clipPoint=new box2d.b2Vec2,box2d.b2PointState={b2_nullState:0,b2_addState:1,b2_persistState:2,b2_removeState:3},goog.exportProperty(box2d.b2PointState,"b2_nullState   ",box2d.b2PointState.b2_nullState),goog.exportProperty(box2d.b2PointState,"b2_addState    ",box2d.b2PointState.b2_addState),goog.exportProperty(box2d.b2PointState,"b2_persistState",box2d.b2PointState.b2_persistState),goog.exportProperty(box2d.b2PointState,"b2_removeState ",box2d.b2PointState.b2_removeState),box2d.b2GetPointStates=function(e,t,i,s){for(var a=0,n=i.pointCount;n>a;++a){h=(l=i.points[a].id).key;e[a]=box2d.b2PointState.b2_removeState;for(var o=0,r=s.pointCount;r>o;++o)if(s.points[o].id.key===h){e[a]=box2d.b2PointState.b2_persistState;break}}for(n=box2d.b2_maxManifoldPoints;n>a;++a)e[a]=box2d.b2PointState.b2_nullState;for(var a=0,n=s.pointCount;n>a;++a){var l=s.points[a].id,h=l.key;t[a]=box2d.b2PointState.b2_addState;for(var o=0,r=i.pointCount;r>o;++o)if(i.points[o].id.key===h){t[a]=box2d.b2PointState.b2_persistState;break}}for(n=box2d.b2_maxManifoldPoints;n>a;++a)t[a]=box2d.b2PointState.b2_nullState},box2d.b2ClipVertex=function(){this.v=new box2d.b2Vec2,this.id=new box2d.b2ContactID},box2d.b2ClipVertex.prototype.v=null,box2d.b2ClipVertex.prototype.id=null,box2d.b2ClipVertex.MakeArray=function(e){return box2d.b2MakeArray(e,function(){return new box2d.b2ClipVertex})},box2d.b2ClipVertex.prototype.Copy=function(e){return this.v.Copy(e.v),this.id.Copy(e.id),this},box2d.b2RayCastInput=function(){this.p1=new box2d.b2Vec2,this.p2=new box2d.b2Vec2,this.maxFraction=1},box2d.b2RayCastInput.prototype.p1=null,box2d.b2RayCastInput.prototype.p2=null,box2d.b2RayCastInput.prototype.maxFraction=1,box2d.b2RayCastInput.prototype.Copy=function(e){return this.p1.Copy(e.p1),this.p2.Copy(e.p2),this.maxFraction=e.maxFraction,this},box2d.b2RayCastOutput=function(){this.normal=new box2d.b2Vec2,this.fraction=0},box2d.b2RayCastOutput.prototype.normal=null,box2d.b2RayCastOutput.prototype.fraction=0,box2d.b2RayCastOutput.prototype.Copy=function(e){return this.normal.Copy(e.normal),this.fraction=e.fraction,this},box2d.b2AABB=function(){this.lowerBound=new box2d.b2Vec2,this.upperBound=new box2d.b2Vec2,this.m_out_center=new box2d.b2Vec2,this.m_out_extent=new box2d.b2Vec2},box2d.b2AABB.prototype.lowerBound=null,box2d.b2AABB.prototype.upperBound=null,box2d.b2AABB.prototype.m_out_center=null,box2d.b2AABB.prototype.m_out_extent=null,box2d.b2AABB.prototype.Copy=function(e){return this.lowerBound.Copy(e.lowerBound),this.upperBound.Copy(e.upperBound),this},box2d.b2AABB.prototype.IsValid=function(){var e=this.upperBound.x-this.lowerBound.x,t=this.upperBound.y-this.lowerBound.y,i=e>=0&&t>=0;return i=i&&this.lowerBound.IsValid()&&this.upperBound.IsValid()},box2d.b2AABB.prototype.GetCenter=function(){return box2d.b2MidVV(this.lowerBound,this.upperBound,this.m_out_center)},box2d.b2AABB.prototype.GetExtents=function(){return box2d.b2ExtVV(this.lowerBound,this.upperBound,this.m_out_extent)},box2d.b2AABB.prototype.GetPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+(this.upperBound.y-this.lowerBound.y))},box2d.b2AABB.prototype.Combine1=function(e){return this.lowerBound.x=box2d.b2Min(this.lowerBound.x,e.lowerBound.x),this.lowerBound.y=box2d.b2Min(this.lowerBound.y,e.lowerBound.y),this.upperBound.x=box2d.b2Max(this.upperBound.x,e.upperBound.x),this.upperBound.y=box2d.b2Max(this.upperBound.y,e.upperBound.y),this},box2d.b2AABB.prototype.Combine2=function(e,t){return this.lowerBound.x=box2d.b2Min(e.lowerBound.x,t.lowerBound.x),this.lowerBound.y=box2d.b2Min(e.lowerBound.y,t.lowerBound.y),this.upperBound.x=box2d.b2Max(e.upperBound.x,t.upperBound.x),this.upperBound.y=box2d.b2Max(e.upperBound.y,t.upperBound.y),this},box2d.b2AABB.Combine=function(e,t,i){return i.Combine2(e,t),i},box2d.b2AABB.prototype.Contains=function(e){var t=!0;return t=t&&this.lowerBound.x<=e.lowerBound.x,t=t&&this.lowerBound.y<=e.lowerBound.y,t=t&&e.upperBound.x<=this.upperBound.x,t=t&&e.upperBound.y<=this.upperBound.y},box2d.b2AABB.prototype.RayCast=function(e,t){var i=-box2d.b2_maxFloat,s=box2d.b2_maxFloat,a=t.p1.x,n=t.p1.y,o=t.p2.x-t.p1.x,r=t.p2.y-t.p1.y,l=box2d.b2Abs(o),h=box2d.b2Abs(r),c=e.normal;if(l<box2d.b2_epsilon){if(a<this.lowerBound.x||this.upperBound.x<a)return!1}else{var p=1/o,d=-1;if((u=(this.lowerBound.x-a)*p)>(m=(this.upperBound.x-a)*p)){g=u;u=m,m=g,d=1}if(u>i&&(c.x=d,c.y=0,i=u),s=box2d.b2Min(s,m),i>s)return!1}if(h<box2d.b2_epsilon){if(n<this.lowerBound.y||this.upperBound.y<n)return!1}else{var p=1/r,u=(this.lowerBound.y-n)*p,m=(this.upperBound.y-n)*p,d=-1;if(u>m){var g=u;u=m,m=g,d=1}if(u>i&&(c.x=0,c.y=d,i=u),s=box2d.b2Min(s,m),i>s)return!1}return!(0>i||t.maxFraction<i)&&(e.fraction=i,!0)},box2d.b2AABB.prototype.TestOverlap=function(e){var t=e.lowerBound.x-this.upperBound.x,i=e.lowerBound.y-this.upperBound.y,s=this.lowerBound.x-e.upperBound.x,a=this.lowerBound.y-e.upperBound.y;return!(t>0||i>0)&&!(s>0||a>0)},box2d.b2TestOverlapAABB=function(e,t){var i=t.lowerBound.x-e.upperBound.x,s=t.lowerBound.y-e.upperBound.y,a=e.lowerBound.x-t.upperBound.x,n=e.lowerBound.y-t.upperBound.y;return!(i>0||s>0)&&!(a>0||n>0)},box2d.b2ClipSegmentToLine=function(e,t,i,s,a){var n=0,o=t[0],r=t[1],l=box2d.b2DotVV(i,o.v)-s,h=box2d.b2DotVV(i,r.v)-s;if(0>=l&&e[n++].Copy(o),0>=h&&e[n++].Copy(r),0>l*h){var c=l/(l-h),p=e[n].v;p.x=o.v.x+c*(r.v.x-o.v.x),p.y=o.v.y+c*(r.v.y-o.v.y);var d=e[n].id;d.cf.indexA=a,d.cf.indexB=o.id.cf.indexB,d.cf.typeA=box2d.b2ContactFeatureType.e_vertex,d.cf.typeB=box2d.b2ContactFeatureType.e_face,++n}return n},box2d.b2TestOverlapShape=function(e,t,i,s,a,n){var o=box2d.b2TestOverlapShape.s_input.Reset();o.proxyA.SetShape(e,t),o.proxyB.SetShape(i,s),o.transformA.Copy(a),o.transformB.Copy(n),o.useRadii=!0;var r=box2d.b2TestOverlapShape.s_simplexCache.Reset();r.count=0;var l=box2d.b2TestOverlapShape.s_output.Reset();return box2d.b2Distance(l,r,o),l.distance<10*box2d.b2_epsilon},box2d.b2TestOverlapShape.s_input=new box2d.b2DistanceInput,box2d.b2TestOverlapShape.s_simplexCache=new box2d.b2SimplexCache,box2d.b2TestOverlapShape.s_output=new box2d.b2DistanceOutput,goog.provide("box2d.b2Timer"),goog.require("box2d.b2Settings"),box2d.b2Timer=function(){this.m_start=(new Date).getTime()},box2d.b2Timer.prototype.m_start=0,box2d.b2Timer.prototype.Reset=function(){return this.m_start=(new Date).getTime(),this},box2d.b2Timer.prototype.GetMilliseconds=function(){return(new Date).getTime()-this.m_start},box2d.b2Counter=function(){},box2d.b2Counter.prototype.m_count=0,box2d.b2Counter.prototype.m_min_count=0,box2d.b2Counter.prototype.m_max_count=0,box2d.b2Counter.prototype.GetCount=function(){return this.m_count},box2d.b2Counter.prototype.GetMinCount=function(){return this.m_min_count},box2d.b2Counter.prototype.GetMaxCount=function(){return this.m_max_count},box2d.b2Counter.prototype.ResetCount=function(){var e=this.m_count;return this.m_count=0,e},box2d.b2Counter.prototype.ResetMinCount=function(){this.m_min_count=0},box2d.b2Counter.prototype.ResetMaxCount=function(){this.m_max_count=0},box2d.b2Counter.prototype.Increment=function(){this.m_count++,this.m_max_count<this.m_count&&(this.m_max_count=this.m_count)},box2d.b2Counter.prototype.Decrement=function(){this.m_count--,this.m_min_count>this.m_count&&(this.m_min_count=this.m_count)},goog.provide("box2d.b2TimeOfImpact"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Distance"),goog.require("box2d.b2Math"),goog.require("box2d.b2Timer"),box2d.b2_toiTime=0,box2d.b2_toiMaxTime=0,box2d.b2_toiCalls=0,box2d.b2_toiIters=0,box2d.b2_toiMaxIters=0,box2d.b2_toiRootIters=0,box2d.b2_toiMaxRootIters=0,box2d.b2TOIInput=function(){this.proxyA=new box2d.b2DistanceProxy,this.proxyB=new box2d.b2DistanceProxy,this.sweepA=new box2d.b2Sweep,this.sweepB=new box2d.b2Sweep},box2d.b2TOIInput.prototype.proxyA=null,box2d.b2TOIInput.prototype.proxyB=null,box2d.b2TOIInput.prototype.sweepA=null,box2d.b2TOIInput.prototype.sweepB=null,box2d.b2TOIInput.prototype.tMax=0,box2d.b2TOIOutputState={e_unknown:0,e_failed:1,e_overlapped:2,e_touching:3,e_separated:4},goog.exportProperty(box2d.b2TOIOutputState,"e_unknown",box2d.b2TOIOutputState.e_unknown),goog.exportProperty(box2d.b2TOIOutputState,"e_failed",box2d.b2TOIOutputState.e_failed),goog.exportProperty(box2d.b2TOIOutputState,"e_overlapped",box2d.b2TOIOutputState.e_overlapped),goog.exportProperty(box2d.b2TOIOutputState,"e_touching",box2d.b2TOIOutputState.e_touching),goog.exportProperty(box2d.b2TOIOutputState,"e_separated",box2d.b2TOIOutputState.e_separated),box2d.b2TOIOutput=function(){},box2d.b2TOIOutput.prototype.state=box2d.b2TOIOutputState.e_unknown,box2d.b2TOIOutput.prototype.t=0,box2d.b2SeparationFunctionType={e_unknown:-1,e_points:0,e_faceA:1,e_faceB:2},goog.exportProperty(box2d.b2SeparationFunctionType,"e_unknown",box2d.b2SeparationFunctionType.e_unknown),goog.exportProperty(box2d.b2SeparationFunctionType,"e_points",box2d.b2SeparationFunctionType.e_points),goog.exportProperty(box2d.b2SeparationFunctionType,"e_faceA",box2d.b2SeparationFunctionType.e_faceA),goog.exportProperty(box2d.b2SeparationFunctionType,"e_faceB",box2d.b2SeparationFunctionType.e_faceB),box2d.b2SeparationFunction=function(){this.m_sweepA=new box2d.b2Sweep,this.m_sweepB=new box2d.b2Sweep,this.m_localPoint=new box2d.b2Vec2,this.m_axis=new box2d.b2Vec2},box2d.b2SeparationFunction.prototype.m_proxyA=null,box2d.b2SeparationFunction.prototype.m_proxyB=null,box2d.b2SeparationFunction.prototype.m_sweepA=null,box2d.b2SeparationFunction.prototype.m_sweepB=null,box2d.b2SeparationFunction.prototype.m_type=box2d.b2SeparationFunctionType.e_unknown,box2d.b2SeparationFunction.prototype.m_localPoint=null,box2d.b2SeparationFunction.prototype.m_axis=null,box2d.b2SeparationFunction.prototype.Initialize=function(e,t,i,s,a,n){this.m_proxyA=t,this.m_proxyB=s;var o=e.count;box2d.ENABLE_ASSERTS&&box2d.b2Assert(o>0&&3>o),this.m_sweepA.Copy(i),this.m_sweepB.Copy(a);var r=box2d.b2TimeOfImpact.s_xfA,l=box2d.b2TimeOfImpact.s_xfB;if(this.m_sweepA.GetTransform(r,n),this.m_sweepB.GetTransform(l,n),1===o){this.m_type=box2d.b2SeparationFunctionType.e_points;var h=this.m_proxyA.GetVertex(e.indexA[0]),c=this.m_proxyB.GetVertex(e.indexB[0]),p=box2d.b2MulXV(r,h,box2d.b2TimeOfImpact.s_pointA),d=box2d.b2MulXV(l,c,box2d.b2TimeOfImpact.s_pointB);return box2d.b2SubVV(d,p,this.m_axis),x=this.m_axis.Normalize()}if(e.indexA[0]===e.indexA[1]){this.m_type=box2d.b2SeparationFunctionType.e_faceB;var u=this.m_proxyB.GetVertex(e.indexB[0]),m=this.m_proxyB.GetVertex(e.indexB[1]);box2d.b2CrossVOne(box2d.b2SubVV(m,u,box2d.b2Vec2.s_t0),this.m_axis).SelfNormalize();b=box2d.b2MulRV(l.q,this.m_axis,box2d.b2TimeOfImpact.s_normal);box2d.b2MidVV(u,m,this.m_localPoint);var d=box2d.b2MulXV(l,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),h=this.m_proxyA.GetVertex(e.indexA[0]),p=box2d.b2MulXV(r,h,box2d.b2TimeOfImpact.s_pointA);return 0>(x=box2d.b2DotVV(box2d.b2SubVV(p,d,box2d.b2Vec2.s_t0),b))&&(this.m_axis.SelfNeg(),x=-x),x}this.m_type=box2d.b2SeparationFunctionType.e_faceA;var g=this.m_proxyA.GetVertex(e.indexA[0]),y=this.m_proxyA.GetVertex(e.indexA[1]);box2d.b2CrossVOne(box2d.b2SubVV(y,g,box2d.b2Vec2.s_t0),this.m_axis).SelfNormalize();var b=box2d.b2MulRV(r.q,this.m_axis,box2d.b2TimeOfImpact.s_normal);box2d.b2MidVV(g,y,this.m_localPoint);var p=box2d.b2MulXV(r,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),c=this.m_proxyB.GetVertex(e.indexB[0]),d=box2d.b2MulXV(l,c,box2d.b2TimeOfImpact.s_pointB),x=box2d.b2DotVV(box2d.b2SubVV(d,p,box2d.b2Vec2.s_t0),b);return 0>x&&(this.m_axis.SelfNeg(),x=-x),x},box2d.b2SeparationFunction.prototype.FindMinSeparation=function(e,t,i){var s=box2d.b2TimeOfImpact.s_xfA,a=box2d.b2TimeOfImpact.s_xfB;switch(this.m_sweepA.GetTransform(s,i),this.m_sweepB.GetTransform(a,i),this.m_type){case box2d.b2SeparationFunctionType.e_points:var n=box2d.b2MulTRV(s.q,this.m_axis,box2d.b2TimeOfImpact.s_axisA),o=box2d.b2MulTRV(a.q,box2d.b2NegV(this.m_axis,box2d.b2Vec2.s_t0),box2d.b2TimeOfImpact.s_axisB);e[0]=this.m_proxyA.GetSupport(n),t[0]=this.m_proxyB.GetSupport(o);var r=this.m_proxyA.GetVertex(e[0]),l=this.m_proxyB.GetVertex(t[0]),h=box2d.b2MulXV(s,r,box2d.b2TimeOfImpact.s_pointA),c=box2d.b2MulXV(a,l,box2d.b2TimeOfImpact.s_pointB);return d=box2d.b2DotVV(box2d.b2SubVV(c,h,box2d.b2Vec2.s_t0),this.m_axis);case box2d.b2SeparationFunctionType.e_faceA:var p=box2d.b2MulRV(s.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),h=box2d.b2MulXV(s,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),o=box2d.b2MulTRV(a.q,box2d.b2NegV(p,box2d.b2Vec2.s_t0),box2d.b2TimeOfImpact.s_axisB);e[0]=-1,t[0]=this.m_proxyB.GetSupport(o);var l=this.m_proxyB.GetVertex(t[0]),c=box2d.b2MulXV(a,l,box2d.b2TimeOfImpact.s_pointB);return d=box2d.b2DotVV(box2d.b2SubVV(c,h,box2d.b2Vec2.s_t0),p);case box2d.b2SeparationFunctionType.e_faceB:var p=box2d.b2MulRV(a.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),c=box2d.b2MulXV(a,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),n=box2d.b2MulTRV(s.q,box2d.b2NegV(p,box2d.b2Vec2.s_t0),box2d.b2TimeOfImpact.s_axisA);t[0]=-1,e[0]=this.m_proxyA.GetSupport(n);var r=this.m_proxyA.GetVertex(e[0]),h=box2d.b2MulXV(s,r,box2d.b2TimeOfImpact.s_pointA),d=box2d.b2DotVV(box2d.b2SubVV(h,c,box2d.b2Vec2.s_t0),p);return d;default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),e[0]=-1,t[0]=-1,0}},box2d.b2SeparationFunction.prototype.Evaluate=function(e,t,i){var s=box2d.b2TimeOfImpact.s_xfA,a=box2d.b2TimeOfImpact.s_xfB;switch(this.m_sweepA.GetTransform(s,i),this.m_sweepB.GetTransform(a,i),this.m_type){case box2d.b2SeparationFunctionType.e_points:var n=this.m_proxyA.GetVertex(e),o=this.m_proxyB.GetVertex(t),r=box2d.b2MulXV(s,n,box2d.b2TimeOfImpact.s_pointA),l=box2d.b2MulXV(a,o,box2d.b2TimeOfImpact.s_pointB);return c=box2d.b2DotVV(box2d.b2SubVV(l,r,box2d.b2Vec2.s_t0),this.m_axis);case box2d.b2SeparationFunctionType.e_faceA:var h=box2d.b2MulRV(s.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),r=box2d.b2MulXV(s,this.m_localPoint,box2d.b2TimeOfImpact.s_pointA),o=this.m_proxyB.GetVertex(t),l=box2d.b2MulXV(a,o,box2d.b2TimeOfImpact.s_pointB);return c=box2d.b2DotVV(box2d.b2SubVV(l,r,box2d.b2Vec2.s_t0),h);case box2d.b2SeparationFunctionType.e_faceB:var h=box2d.b2MulRV(a.q,this.m_axis,box2d.b2TimeOfImpact.s_normal),l=box2d.b2MulXV(a,this.m_localPoint,box2d.b2TimeOfImpact.s_pointB),n=this.m_proxyA.GetVertex(e),r=box2d.b2MulXV(s,n,box2d.b2TimeOfImpact.s_pointA),c=box2d.b2DotVV(box2d.b2SubVV(r,l,box2d.b2Vec2.s_t0),h);return c;default:return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),0}},box2d.b2TimeOfImpact=function(e,t){var i=box2d.b2TimeOfImpact.s_timer.Reset();++box2d.b2_toiCalls,e.state=box2d.b2TOIOutputState.e_unknown,e.t=t.tMax;var s=t.proxyA,a=t.proxyB,n=box2d.b2TimeOfImpact.s_sweepA.Copy(t.sweepA),o=box2d.b2TimeOfImpact.s_sweepB.Copy(t.sweepB);n.Normalize(),o.Normalize();var r=t.tMax,l=s.m_radius+a.m_radius,h=box2d.b2Max(box2d.b2_linearSlop,l-3*box2d.b2_linearSlop),c=.25*box2d.b2_linearSlop;box2d.ENABLE_ASSERTS&&box2d.b2Assert(h>c);var p=0,d=0,u=box2d.b2TimeOfImpact.s_cache;u.count=0;var m=box2d.b2TimeOfImpact.s_distanceInput;for(m.proxyA=t.proxyA,m.proxyB=t.proxyB,m.useRadii=!1;;){var g=box2d.b2TimeOfImpact.s_xfA,y=box2d.b2TimeOfImpact.s_xfB;n.GetTransform(g,p),o.GetTransform(y,p),m.transformA.Copy(g),m.transformB.Copy(y);var b=box2d.b2TimeOfImpact.s_distanceOutput;if(box2d.b2Distance(b,u,m),b.distance<=0){e.state=box2d.b2TOIOutputState.e_overlapped,e.t=0;break}if(b.distance<h+c){e.state=box2d.b2TOIOutputState.e_touching,e.t=p;break}var x=box2d.b2TimeOfImpact.s_fcn;x.Initialize(u,s,n,a,o,p);for(var v=!1,f=r,w=0;;){var k=box2d.b2TimeOfImpact.s_indexA,_=box2d.b2TimeOfImpact.s_indexB,S=x.FindMinSeparation(k,_,f);if(S>h+c){e.state=box2d.b2TOIOutputState.e_separated,e.t=r,v=!0;break}if(S>h-c){p=f;break}var M=x.Evaluate(k[0],_[0],p);if(h-c>M){e.state=box2d.b2TOIOutputState.e_failed,e.t=p,v=!0;break}if(h+c>=M){e.state=box2d.b2TOIOutputState.e_touching,e.t=p,v=!0;break}for(var A=0,C=p,P=f;;){var T=0;T=1&A?C+(h-M)*(P-C)/(S-M):.5*(C+P),++A,++box2d.b2_toiRootIters;var X=x.Evaluate(k[0],_[0],T);if(box2d.b2Abs(X-h)<c){f=T;break}if(X>h?(C=T,M=X):(P=T,S=X),50===A)break}if(box2d.b2_toiMaxRootIters=box2d.b2Max(box2d.b2_toiMaxRootIters,A),++w===box2d.b2_maxPolygonVertices)break}if(++d,++box2d.b2_toiIters,v)break;if(20===d){e.state=box2d.b2TOIOutputState.e_failed,e.t=p;break}}box2d.b2_toiMaxIters=box2d.b2Max(box2d.b2_toiMaxIters,d);var Y=i.GetMilliseconds();box2d.b2_toiMaxTime=box2d.b2Max(box2d.b2_toiMaxTime,Y),box2d.b2_toiTime+=Y},box2d.b2TimeOfImpact.s_timer=new box2d.b2Timer,box2d.b2TimeOfImpact.s_cache=new box2d.b2SimplexCache,box2d.b2TimeOfImpact.s_distanceInput=new box2d.b2DistanceInput,box2d.b2TimeOfImpact.s_distanceOutput=new box2d.b2DistanceOutput,box2d.b2TimeOfImpact.s_xfA=new box2d.b2Transform,box2d.b2TimeOfImpact.s_xfB=new box2d.b2Transform,box2d.b2TimeOfImpact.s_indexA=box2d.b2MakeNumberArray(1),box2d.b2TimeOfImpact.s_indexB=box2d.b2MakeNumberArray(1),box2d.b2TimeOfImpact.s_fcn=new box2d.b2SeparationFunction,box2d.b2TimeOfImpact.s_sweepA=new box2d.b2Sweep,box2d.b2TimeOfImpact.s_sweepB=new box2d.b2Sweep,box2d.b2TimeOfImpact.s_pointA=new box2d.b2Vec2,box2d.b2TimeOfImpact.s_pointB=new box2d.b2Vec2,box2d.b2TimeOfImpact.s_normal=new box2d.b2Vec2,box2d.b2TimeOfImpact.s_axisA=new box2d.b2Vec2,box2d.b2TimeOfImpact.s_axisB=new box2d.b2Vec2,goog.provide("box2d.b2Contact"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Collision"),goog.require("box2d.b2TimeOfImpact"),box2d.b2MixFriction=function(e,t){return box2d.b2Sqrt(e*t)},box2d.b2MixRestitution=function(e,t){return e>t?e:t},box2d.b2ContactEdge=function(){},box2d.b2ContactEdge.prototype.other=null,box2d.b2ContactEdge.prototype.contact=null,box2d.b2ContactEdge.prototype.prev=null,box2d.b2ContactEdge.prototype.next=null,box2d.b2ContactFlag={e_none:0,e_islandFlag:1,e_touchingFlag:2,e_enabledFlag:4,e_filterFlag:8,e_bulletHitFlag:16,e_toiFlag:32},goog.exportProperty(box2d.b2ContactFlag,"e_none",box2d.b2ContactFlag.e_none),goog.exportProperty(box2d.b2ContactFlag,"e_islandFlag",box2d.b2ContactFlag.e_islandFlag),goog.exportProperty(box2d.b2ContactFlag,"e_touchingFlag",box2d.b2ContactFlag.e_touchingFlag),goog.exportProperty(box2d.b2ContactFlag,"e_enabledFlag",box2d.b2ContactFlag.e_enabledFlag),goog.exportProperty(box2d.b2ContactFlag,"e_filterFlag",box2d.b2ContactFlag.e_filterFlag),goog.exportProperty(box2d.b2ContactFlag,"e_bulletHitFlag",box2d.b2ContactFlag.e_bulletHitFlag),goog.exportProperty(box2d.b2ContactFlag,"e_toiFlag",box2d.b2ContactFlag.e_toiFlag),box2d.b2Contact=function(){this.m_nodeA=new box2d.b2ContactEdge,this.m_nodeB=new box2d.b2ContactEdge,this.m_manifold=new box2d.b2Manifold,this.m_oldManifold=new box2d.b2Manifold},box2d.b2Contact.prototype.m_flags=box2d.b2ContactFlag.e_none,box2d.b2Contact.prototype.m_prev=null,box2d.b2Contact.prototype.m_next=null,box2d.b2Contact.prototype.m_nodeA=null,box2d.b2Contact.prototype.m_nodeB=null,box2d.b2Contact.prototype.m_fixtureA=null,box2d.b2Contact.prototype.m_fixtureB=null,box2d.b2Contact.prototype.m_indexA=0,box2d.b2Contact.prototype.m_indexB=0,box2d.b2Contact.prototype.m_manifold=null,box2d.b2Contact.prototype.m_toiCount=0,box2d.b2Contact.prototype.m_toi=0,box2d.b2Contact.prototype.m_friction=0,box2d.b2Contact.prototype.m_restitution=0,box2d.b2Contact.prototype.m_tangentSpeed=0,box2d.b2Contact.prototype.m_oldManifold=null,box2d.b2Contact.prototype.GetManifold=function(){return this.m_manifold},box2d.b2Contact.prototype.GetWorldManifold=function(e){var t=this.m_fixtureA.GetBody(),i=this.m_fixtureB.GetBody(),s=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();e.Initialize(this.m_manifold,t.GetTransform(),s.m_radius,i.GetTransform(),a.m_radius)},box2d.b2Contact.prototype.IsTouching=function(){return(this.m_flags&box2d.b2ContactFlag.e_touchingFlag)===box2d.b2ContactFlag.e_touchingFlag},box2d.b2Contact.prototype.SetEnabled=function(e){e?this.m_flags|=box2d.b2ContactFlag.e_enabledFlag:this.m_flags&=~box2d.b2ContactFlag.e_enabledFlag},box2d.b2Contact.prototype.IsEnabled=function(){return(this.m_flags&box2d.b2ContactFlag.e_enabledFlag)===box2d.b2ContactFlag.e_enabledFlag},box2d.b2Contact.prototype.GetNext=function(){return this.m_next},box2d.b2Contact.prototype.GetFixtureA=function(){return this.m_fixtureA},box2d.b2Contact.prototype.GetChildIndexA=function(){return this.m_indexA},box2d.b2Contact.prototype.GetFixtureB=function(){return this.m_fixtureB},box2d.b2Contact.prototype.GetChildIndexB=function(){return this.m_indexB},box2d.b2Contact.prototype.Evaluate=function(){},box2d.b2Contact.prototype.FlagForFiltering=function(){this.m_flags|=box2d.b2ContactFlag.e_filterFlag},box2d.b2Contact.prototype.SetFriction=function(e){this.m_friction=e},box2d.b2Contact.prototype.GetFriction=function(){return this.m_friction},box2d.b2Contact.prototype.ResetFriction=function(){this.m_friction=box2d.b2MixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)},box2d.b2Contact.prototype.SetRestitution=function(e){this.m_restitution=e},box2d.b2Contact.prototype.GetRestitution=function(){return this.m_restitution},box2d.b2Contact.prototype.ResetRestitution=function(){this.m_restitution=box2d.b2MixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},box2d.b2Contact.prototype.SetTangentSpeed=function(e){this.m_tangentSpeed=e},box2d.b2Contact.prototype.GetTangentSpeed=function(){return this.m_tangentSpeed},box2d.b2Contact.prototype.Reset=function(e,t,i,s){this.m_flags=box2d.b2ContactFlag.e_enabledFlag,this.m_fixtureA=e,this.m_fixtureB=i,this.m_indexA=t,this.m_indexB=s,this.m_manifold.pointCount=0,this.m_prev=null,this.m_next=null,this.m_nodeA.contact=null,this.m_nodeA.prev=null,this.m_nodeA.next=null,this.m_nodeA.other=null,this.m_nodeB.contact=null,this.m_nodeB.prev=null,this.m_nodeB.next=null,this.m_nodeB.other=null,this.m_toiCount=0,this.m_friction=box2d.b2MixFriction(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=box2d.b2MixRestitution(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},box2d.b2Contact.prototype.Update=function(e){var t=this.m_oldManifold;this.m_oldManifold=this.m_manifold,this.m_manifold=t,this.m_flags|=box2d.b2ContactFlag.e_enabledFlag;var i=!1,s=(this.m_flags&box2d.b2ContactFlag.e_touchingFlag)===box2d.b2ContactFlag.e_touchingFlag,a=this.m_fixtureA.IsSensor(),n=this.m_fixtureB.IsSensor(),o=a||n,r=this.m_fixtureA.GetBody(),l=this.m_fixtureB.GetBody(),h=r.GetTransform(),c=l.GetTransform();if(o){var p=this.m_fixtureA.GetShape(),d=this.m_fixtureB.GetShape();i=box2d.b2TestOverlapShape(p,this.m_indexA,d,this.m_indexB,h,c),this.m_manifold.pointCount=0}else{this.Evaluate(this.m_manifold,h,c),i=this.m_manifold.pointCount>0;for(var u=0;u<this.m_manifold.pointCount;++u){var m=this.m_manifold.points[u];m.normalImpulse=0,m.tangentImpulse=0;for(var g=m.id,y=0;y<this.m_oldManifold.pointCount;++y){var b=this.m_oldManifold.points[y];if(b.id.key===g.key){m.normalImpulse=b.normalImpulse,m.tangentImpulse=b.tangentImpulse;break}}}i!==s&&(r.SetAwake(!0),l.SetAwake(!0))}i?this.m_flags|=box2d.b2ContactFlag.e_touchingFlag:this.m_flags&=~box2d.b2ContactFlag.e_touchingFlag,!1===s&&!0===i&&e&&e.BeginContact(this),!0===s&&!1===i&&e&&e.EndContact(this),!1===o&&i&&e&&e.PreSolve(this,this.m_oldManifold)},box2d.b2Contact.prototype.ComputeTOI=function(e,t){var i=box2d.b2Contact.prototype.ComputeTOI.s_input;i.proxyA.SetShape(this.m_fixtureA.GetShape(),this.m_indexA),i.proxyB.SetShape(this.m_fixtureB.GetShape(),this.m_indexB),i.sweepA.Copy(e),i.sweepB.Copy(t),i.tMax=box2d.b2_linearSlop;var s=box2d.b2Contact.prototype.ComputeTOI.s_output;return box2d.b2TimeOfImpact(s,i),s.t},box2d.b2Contact.prototype.ComputeTOI.s_input=new box2d.b2TOIInput,box2d.b2Contact.prototype.ComputeTOI.s_output=new box2d.b2TOIOutput,goog.provide("box2d.b2PolygonAndCircleContact"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Contact"),box2d.b2PolygonAndCircleContact=function(){goog.base(this)},goog.inherits(box2d.b2PolygonAndCircleContact,box2d.b2Contact),box2d.b2PolygonAndCircleContact.Create=function(){return new box2d.b2PolygonAndCircleContact},box2d.b2PolygonAndCircleContact.Destroy=function(){},box2d.b2PolygonAndCircleContact.prototype.Reset=function(e,t,i,s){goog.base(this,"Reset",e,t,i,s),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.GetType()===box2d.b2ShapeType.e_polygonShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(i.GetType()===box2d.b2ShapeType.e_circleShape)},box2d.b2PolygonAndCircleContact.prototype.Evaluate=function(e,t,i){var s=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(s instanceof box2d.b2PolygonShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2CircleShape),box2d.b2CollidePolygonAndCircle(e,s instanceof box2d.b2PolygonShape?s:null,t,a instanceof box2d.b2CircleShape?a:null,i)},goog.provide("box2d.b2EdgeAndPolygonContact"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Contact"),box2d.b2EdgeAndPolygonContact=function(){goog.base(this)},goog.inherits(box2d.b2EdgeAndPolygonContact,box2d.b2Contact),box2d.b2EdgeAndPolygonContact.Create=function(){return new box2d.b2EdgeAndPolygonContact},box2d.b2EdgeAndPolygonContact.Destroy=function(){},box2d.b2EdgeAndPolygonContact.prototype.Reset=function(e,t,i,s){goog.base(this,"Reset",e,t,i,s),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.GetType()===box2d.b2ShapeType.e_edgeShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(i.GetType()===box2d.b2ShapeType.e_polygonShape)},box2d.b2EdgeAndPolygonContact.prototype.Evaluate=function(e,t,i){var s=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(s instanceof box2d.b2EdgeShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2PolygonShape),box2d.b2CollideEdgeAndPolygon(e,s instanceof box2d.b2EdgeShape?s:null,t,a instanceof box2d.b2PolygonShape?a:null,i)},goog.provide("box2d.b2Shape"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Math"),goog.require("box2d.b2Distance"),box2d.b2MassData=function(){this.center=new box2d.b2Vec2(0,0)},box2d.b2MassData.prototype.mass=0,box2d.b2MassData.prototype.center=null,box2d.b2MassData.prototype.I=0,box2d.b2ShapeType={e_unknown:-1,e_circleShape:0,e_edgeShape:1,e_polygonShape:2,e_chainShape:3,e_shapeTypeCount:4},goog.exportProperty(box2d.b2ShapeType,"e_unknown",box2d.b2ShapeType.e_unknown),goog.exportProperty(box2d.b2ShapeType,"e_circleShape",box2d.b2ShapeType.e_circleShape),goog.exportProperty(box2d.b2ShapeType,"e_edgeShape",box2d.b2ShapeType.e_edgeShape),goog.exportProperty(box2d.b2ShapeType,"e_polygonShape",box2d.b2ShapeType.e_polygonShape),goog.exportProperty(box2d.b2ShapeType,"e_chainShape",box2d.b2ShapeType.e_chainShape),goog.exportProperty(box2d.b2ShapeType,"e_shapeTypeCount",box2d.b2ShapeType.e_shapeTypeCount),box2d.b2Shape=function(e,t){this.m_type=e,this.m_radius=t},box2d.b2Shape.prototype.m_type=box2d.b2ShapeType.e_unknown,box2d.b2Shape.prototype.m_radius=0,box2d.b2Shape.prototype.Clone=function(){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),null},box2d.b2Shape.prototype.Copy=function(e){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_type===e.m_type),this.m_radius=e.m_radius,this},box2d.b2Shape.prototype.GetType=function(){return this.m_type},box2d.b2Shape.prototype.GetChildCount=function(){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual"),0},box2d.b2Shape.prototype.TestPoint=function(){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual"),!1},box2d.b2Shape.prototype.RayCast=function(){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual"),!1},box2d.b2Shape.prototype.ComputeAABB=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")},box2d.b2Shape.prototype.ComputeMass=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")},box2d.b2Shape.prototype.SetupDistanceProxy=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")},box2d.b2Shape.prototype.ComputeSubmergedArea=function(){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual"),0},box2d.b2Shape.prototype.Dump=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1,"pure virtual")},goog.provide("box2d.b2PolygonShape"),goog.require("box2d.b2Shape"),box2d.b2PolygonShape=function(){goog.base(this,box2d.b2ShapeType.e_polygonShape,box2d.b2_polygonRadius),this.m_centroid=new box2d.b2Vec2(0,0),this.m_vertices=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices),this.m_normals=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices)},goog.inherits(box2d.b2PolygonShape,box2d.b2Shape),box2d.b2PolygonShape.prototype.m_centroid=null,box2d.b2PolygonShape.prototype.m_vertices=null,box2d.b2PolygonShape.prototype.m_normals=null,box2d.b2PolygonShape.prototype.m_count=0,box2d.b2PolygonShape.prototype.Clone=function(){return(new box2d.b2PolygonShape).Copy(this)},box2d.b2PolygonShape.prototype.Copy=function(e){goog.base(this,"Copy",e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2PolygonShape),this.m_centroid.Copy(e.m_centroid),this.m_count=e.m_count;for(var t=0,i=this.m_count;i>t;++t)this.m_vertices[t].Copy(e.m_vertices[t]),this.m_normals[t].Copy(e.m_normals[t]);return this},box2d.b2PolygonShape.prototype.SetAsBox=function(e,t){return this.m_count=4,this.m_vertices[0].SetXY(-e,-t),this.m_vertices[1].SetXY(e,-t),this.m_vertices[2].SetXY(e,t),this.m_vertices[3].SetXY(-e,t),this.m_normals[0].SetXY(0,-1),this.m_normals[1].SetXY(1,0),this.m_normals[2].SetXY(0,1),this.m_normals[3].SetXY(-1,0),this.m_centroid.SetZero(),this},box2d.b2PolygonShape.prototype.SetAsOrientedBox=function(e,t,i,s){this.m_count=4,this.m_vertices[0].SetXY(-e,-t),this.m_vertices[1].SetXY(e,-t),this.m_vertices[2].SetXY(e,t),this.m_vertices[3].SetXY(-e,t),this.m_normals[0].SetXY(0,-1),this.m_normals[1].SetXY(1,0),this.m_normals[2].SetXY(0,1),this.m_normals[3].SetXY(-1,0),this.m_centroid.Copy(i);var a=new box2d.b2Transform;a.SetPosition(i),a.SetRotationAngleRadians(s);for(var n=0,o=this.m_count;o>n;++n)box2d.b2MulXV(a,this.m_vertices[n],this.m_vertices[n]),box2d.b2MulRV(a.q,this.m_normals[n],this.m_normals[n]);return this},box2d.b2PolygonShape.prototype.Set=function(e,t){if(void 0===t&&(t=e.length),box2d.ENABLE_ASSERTS&&box2d.b2Assert(t>=3&&t<=box2d.b2_maxPolygonVertices),3>t)return this.SetAsBox(1,1);for(var i=box2d.b2Min(t,box2d.b2_maxPolygonVertices),s=box2d.b2PolygonShape.prototype.Set.s_ps,a=0,n=0;i>n;++n){for(var o=e[n],r=!0,l=0;a>l;++l)if(box2d.b2DistanceSquaredVV(o,s[l])<.5*box2d.b2_linearSlop){r=!1;break}r&&s[a++].Copy(o)}if(3>(i=a))return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),this.SetAsBox(1,1);for(var h=0,c=s[0].x,n=1;i>n;++n){var p=s[n].x;(p>c||p===c&&s[n].y<s[h].y)&&(h=n,c=p)}for(var d=box2d.b2PolygonShape.prototype.Set.s_hull,u=0,m=h;;){d[u]=m;for(var g=0,l=1;i>l;++l)if(g!==m){var y=box2d.b2SubVV(s[g],s[d[u]],box2d.b2PolygonShape.prototype.Set.s_r),o=box2d.b2SubVV(s[l],s[d[u]],box2d.b2PolygonShape.prototype.Set.s_v),b=box2d.b2CrossVV(y,o);0>b&&(g=l),0===b&&o.GetLengthSquared()>y.GetLengthSquared()&&(g=l)}else g=l;if(++u,m=g,g===h)break}this.m_count=u;for(n=0;u>n;++n)this.m_vertices[n].Copy(s[d[n]]);for(var n=0,x=u;x>n;++n){var v=this.m_vertices[n],f=this.m_vertices[(n+1)%x],w=box2d.b2SubVV(f,v,box2d.b2Vec2.s_t0);box2d.ENABLE_ASSERTS&&box2d.b2Assert(w.GetLengthSquared()>box2d.b2_epsilon_sq),box2d.b2CrossVOne(w,this.m_normals[n]).SelfNormalize()}return box2d.b2PolygonShape.ComputeCentroid(this.m_vertices,u,this.m_centroid),this},box2d.b2PolygonShape.prototype.Set.s_ps=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices),box2d.b2PolygonShape.prototype.Set.s_hull=box2d.b2MakeNumberArray(box2d.b2_maxPolygonVertices),box2d.b2PolygonShape.prototype.Set.s_r=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.Set.s_v=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.SetAsVector=function(e,t){return this.Set(e,t),this},box2d.b2PolygonShape.prototype.SetAsArray=function(e,t){return this.Set(e,t),this},box2d.b2PolygonShape.prototype.GetChildCount=function(){return 1},box2d.b2PolygonShape.prototype.TestPoint=function(e,t){for(var i=box2d.b2MulTXV(e,t,box2d.b2PolygonShape.prototype.TestPoint.s_pLocal),s=0,a=this.m_count;a>s;++s)if(box2d.b2DotVV(this.m_normals[s],box2d.b2SubVV(i,this.m_vertices[s],box2d.b2Vec2.s_t0))>0)return!1;return!0},box2d.b2PolygonShape.prototype.TestPoint.s_pLocal=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.RayCast=function(e,t,i){for(var s=box2d.b2MulTXV(i,t.p1,box2d.b2PolygonShape.prototype.RayCast.s_p1),a=box2d.b2MulTXV(i,t.p2,box2d.b2PolygonShape.prototype.RayCast.s_p2),n=box2d.b2SubVV(a,s,box2d.b2PolygonShape.prototype.RayCast.s_d),o=0,r=t.maxFraction,l=-1,h=0,c=this.m_count;c>h;++h){var p=box2d.b2DotVV(this.m_normals[h],box2d.b2SubVV(this.m_vertices[h],s,box2d.b2Vec2.s_t0)),d=box2d.b2DotVV(this.m_normals[h],n);if(0===d){if(0>p)return!1}else 0>d&&o*d>p?(o=p/d,l=h):d>0&&r*d>p&&(r=p/d);if(o>r)return!1}return box2d.ENABLE_ASSERTS&&box2d.b2Assert(o>=0&&o<=t.maxFraction),l>=0&&(e.fraction=o,box2d.b2MulRV(i.q,this.m_normals[l],e.normal),!0)},box2d.b2PolygonShape.prototype.RayCast.s_p1=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.RayCast.s_p2=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.RayCast.s_d=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.ComputeAABB=function(e,t){for(var i=box2d.b2MulXV(t,this.m_vertices[0],e.lowerBound),s=e.upperBound.Copy(i),a=0,n=this.m_count;n>a;++a){var o=box2d.b2MulXV(t,this.m_vertices[a],box2d.b2PolygonShape.prototype.ComputeAABB.s_v);box2d.b2MinV(o,i,i),box2d.b2MaxV(o,s,s)}var r=this.m_radius;i.SelfSubXY(r,r),s.SelfAddXY(r,r)},box2d.b2PolygonShape.prototype.ComputeAABB.s_v=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.ComputeMass=function(e,t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_count>=3);for(var i=box2d.b2PolygonShape.prototype.ComputeMass.s_center.SetZero(),s=0,a=0,n=box2d.b2PolygonShape.prototype.ComputeMass.s_s.SetZero(),o=0,r=this.m_count;r>o;++o)n.SelfAdd(this.m_vertices[o]);n.SelfMul(1/this.m_count);for(var o=0,r=this.m_count;r>o;++o){var l=box2d.b2SubVV(this.m_vertices[o],n,box2d.b2PolygonShape.prototype.ComputeMass.s_e1),h=box2d.b2SubVV(this.m_vertices[(o+1)%r],n,box2d.b2PolygonShape.prototype.ComputeMass.s_e2),c=box2d.b2CrossVV(l,h),p=.5*c;s+=p,i.SelfAdd(box2d.b2MulSV(p*(1/3),box2d.b2AddVV(l,h,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1));var d=l.x,u=l.y,m=h.x,g=h.y;a+=1/3*.25*c*(d*d+m*d+m*m+(u*u+g*u+g*g))}e.mass=t*s,box2d.ENABLE_ASSERTS&&box2d.b2Assert(s>box2d.b2_epsilon),i.SelfMul(1/s),box2d.b2AddVV(i,n,e.center),e.I=t*a,e.I+=e.mass*(box2d.b2DotVV(e.center,e.center)-box2d.b2DotVV(i,i))},box2d.b2PolygonShape.prototype.ComputeMass.s_center=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.ComputeMass.s_s=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.ComputeMass.s_e1=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.ComputeMass.s_e2=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.Validate=function(){for(var e=0;e<this.m_count;++e)for(var t=e,i=(e+1)%this.m_count,s=this.m_vertices[t],a=box2d.b2SubVV(this.m_vertices[i],s,box2d.b2PolygonShape.prototype.Validate.s_e),n=0;n<this.m_count;++n)if(n!==t&&n!==i){var o=box2d.b2SubVV(this.m_vertices[n],s,box2d.b2PolygonShape.prototype.Validate.s_v);if(0>box2d.b2CrossVV(a,o))return!1}return!0},box2d.b2PolygonShape.prototype.Validate.s_e=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.Validate.s_v=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.SetupDistanceProxy=function(e){e.m_vertices=this.m_vertices,e.m_count=this.m_count,e.m_radius=this.m_radius},box2d.b2PolygonShape.prototype.ComputeSubmergedArea=function(e,t,i,s){for(var a=box2d.b2MulTRV(i.q,e,box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_normalL),n=t-box2d.b2DotVV(e,i.p),o=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_depths,r=0,l=-1,h=-1,c=!1,p=0,d=this.m_count;d>p;++p){o[p]=box2d.b2DotVV(a,this.m_vertices[p])-n;var u=o[p]<-box2d.b2_epsilon;p>0&&(u?c||(l=p-1,r++):c&&(h=p-1,r++)),c=u}switch(r){case 0:if(c){var m=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_md;return this.ComputeMass(m,1),box2d.b2MulXV(i,m.center,s),m.mass}return 0;case 1:-1===l?l=this.m_count-1:h=this.m_count-1}for(var g=(l+1)%this.m_count,y=(h+1)%this.m_count,b=(0-o[l])/(o[g]-o[l]),x=(0-o[h])/(o[y]-o[h]),v=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_intoVec.SetXY(this.m_vertices[l].x*(1-b)+this.m_vertices[g].x*b,this.m_vertices[l].y*(1-b)+this.m_vertices[g].y*b),f=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_outoVec.SetXY(this.m_vertices[h].x*(1-x)+this.m_vertices[y].x*x,this.m_vertices[h].y*(1-x)+this.m_vertices[y].y*x),w=0,k=box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_center.SetZero(),_=this.m_vertices[g],S=null,p=g;p!==y;){S=(p=(p+1)%this.m_count)===y?f:this.m_vertices[p];var M=.5*((_.x-v.x)*(S.y-v.y)-(_.y-v.y)*(S.x-v.x));w+=M,k.x+=M*(v.x+_.x+S.x)/3,k.y+=M*(v.y+_.y+S.y)/3,_=S}return k.SelfMul(1/w),box2d.b2MulXV(i,k,s),w},box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_normalL=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_depths=box2d.b2MakeNumberArray(box2d.b2_maxPolygonVertices),box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_md=new box2d.b2MassData,box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_intoVec=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_outoVec=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.ComputeSubmergedArea.s_center=new box2d.b2Vec2,box2d.b2PolygonShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2PolygonShape*/ var shape = new box2d.b2PolygonShape();\n"),box2d.b2Log("    /*box2d.b2Vec2[]*/ var vs = box2d.b2Vec2.MakeArray(%d);\n",box2d.b2_maxPolygonVertices);for(var e=0;e<this.m_count;++e)box2d.b2Log("    vs[%d].SetXY(%.15f, %.15f);\n",e,this.m_vertices[e].x,this.m_vertices[e].y);box2d.b2Log("    shape.Set(vs, %d);\n",this.m_count)},box2d.b2PolygonShape.ComputeCentroid=function(e,t,i){box2d.ENABLE_ASSERTS&&box2d.b2Assert(t>=3);var s=i;s.SetZero();for(var a=0,n=box2d.b2PolygonShape.ComputeCentroid.s_pRef.SetZero(),o=0;t>o;++o){var r=n,l=e[o],h=e[(o+1)%t],c=box2d.b2SubVV(l,r,box2d.b2PolygonShape.ComputeCentroid.s_e1),p=box2d.b2SubVV(h,r,box2d.b2PolygonShape.ComputeCentroid.s_e2),d=.5*box2d.b2CrossVV(c,p);a+=d,s.x+=d*(1/3)*(r.x+l.x+h.x),s.y+=d*(1/3)*(r.y+l.y+h.y)}return box2d.ENABLE_ASSERTS&&box2d.b2Assert(a>box2d.b2_epsilon),s.SelfMul(1/a),s},box2d.b2PolygonShape.ComputeCentroid.s_pRef=new box2d.b2Vec2,box2d.b2PolygonShape.ComputeCentroid.s_e1=new box2d.b2Vec2,box2d.b2PolygonShape.ComputeCentroid.s_e2=new box2d.b2Vec2,goog.provide("box2d.b2CollideEdge"),goog.require("box2d.b2Collision"),box2d.b2CollideEdgeAndCircle=function(e,t,i,s,a){e.pointCount=0;var n=box2d.b2MulTXV(i,box2d.b2MulXV(a,s.m_p,box2d.b2Vec2.s_t0),box2d.b2CollideEdgeAndCircle.s_Q),o=t.m_vertex1,r=t.m_vertex2,l=box2d.b2SubVV(r,o,box2d.b2CollideEdgeAndCircle.s_e),h=box2d.b2DotVV(l,box2d.b2SubVV(r,n,box2d.b2Vec2.s_t0)),c=box2d.b2DotVV(l,box2d.b2SubVV(n,o,box2d.b2Vec2.s_t0)),p=t.m_radius+s.m_radius,d=box2d.b2CollideEdgeAndCircle.s_id;if(d.cf.indexB=0,d.cf.typeB=box2d.b2ContactFeatureType.e_vertex,0>=c){var u=o,m=box2d.b2SubVV(n,u,box2d.b2CollideEdgeAndCircle.s_d);if((k=box2d.b2DotVV(m,m))>p*p)return;if(t.m_hasVertex0){var g=t.m_vertex0,y=o,b=box2d.b2SubVV(y,g,box2d.b2CollideEdgeAndCircle.s_e1);if(box2d.b2DotVV(b,box2d.b2SubVV(y,n,box2d.b2Vec2.s_t0))>0)return}return d.cf.indexA=0,d.cf.typeA=box2d.b2ContactFeatureType.e_vertex,e.pointCount=1,e.type=box2d.b2ManifoldType.e_circles,e.localNormal.SetZero(),e.localPoint.Copy(u),e.points[0].id.Copy(d),void e.points[0].localPoint.Copy(s.m_p)}if(0>=h){var u=r,m=box2d.b2SubVV(n,u,box2d.b2CollideEdgeAndCircle.s_d);if((k=box2d.b2DotVV(m,m))>p*p)return;if(t.m_hasVertex3){var x=t.m_vertex3,v=r,f=box2d.b2SubVV(x,v,box2d.b2CollideEdgeAndCircle.s_e2);if(box2d.b2DotVV(f,box2d.b2SubVV(n,v,box2d.b2Vec2.s_t0))>0)return}return d.cf.indexA=1,d.cf.typeA=box2d.b2ContactFeatureType.e_vertex,e.pointCount=1,e.type=box2d.b2ManifoldType.e_circles,e.localNormal.SetZero(),e.localPoint.Copy(u),e.points[0].id.Copy(d),void e.points[0].localPoint.Copy(s.m_p)}var w=box2d.b2DotVV(l,l);box2d.ENABLE_ASSERTS&&box2d.b2Assert(w>0),(u=box2d.b2CollideEdgeAndCircle.s_P).x=1/w*(h*o.x+c*r.x),u.y=1/w*(h*o.y+c*r.y);var m=box2d.b2SubVV(n,u,box2d.b2CollideEdgeAndCircle.s_d),k=box2d.b2DotVV(m,m);if(!(k>p*p)){var _=box2d.b2CollideEdgeAndCircle.s_n.SetXY(-l.y,l.x);box2d.b2DotVV(_,box2d.b2SubVV(n,o,box2d.b2Vec2.s_t0))<0&&_.SetXY(-_.x,-_.y),_.Normalize(),d.cf.indexA=0,d.cf.typeA=box2d.b2ContactFeatureType.e_face,e.pointCount=1,e.type=box2d.b2ManifoldType.e_faceA,e.localNormal.Copy(_),e.localPoint.Copy(o),e.points[0].id.Copy(d),e.points[0].localPoint.Copy(s.m_p)}},box2d.b2CollideEdgeAndCircle.s_Q=new box2d.b2Vec2,box2d.b2CollideEdgeAndCircle.s_e=new box2d.b2Vec2,box2d.b2CollideEdgeAndCircle.s_d=new box2d.b2Vec2,box2d.b2CollideEdgeAndCircle.s_e1=new box2d.b2Vec2,box2d.b2CollideEdgeAndCircle.s_e2=new box2d.b2Vec2,box2d.b2CollideEdgeAndCircle.s_P=new box2d.b2Vec2,box2d.b2CollideEdgeAndCircle.s_n=new box2d.b2Vec2,box2d.b2CollideEdgeAndCircle.s_id=new box2d.b2ContactID,box2d.b2EPAxisType={e_unknown:0,e_edgeA:1,e_edgeB:2},goog.exportProperty(box2d.b2EPAxisType,"e_unknown",box2d.b2EPAxisType.e_unknown),goog.exportProperty(box2d.b2EPAxisType,"e_edgeA",box2d.b2EPAxisType.e_edgeA),goog.exportProperty(box2d.b2EPAxisType,"e_edgeB",box2d.b2EPAxisType.e_edgeB),box2d.b2EPAxis=function(){},box2d.b2EPAxis.prototype.type=box2d.b2EPAxisType.e_unknown,box2d.b2EPAxis.prototype.index=0,box2d.b2EPAxis.prototype.separation=0,box2d.b2TempPolygon=function(){this.vertices=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices),this.normals=box2d.b2Vec2.MakeArray(box2d.b2_maxPolygonVertices),this.count=0},box2d.b2TempPolygon.prototype.vertices=null,box2d.b2TempPolygon.prototype.normals=null,box2d.b2TempPolygon.prototype.count=0,box2d.b2ReferenceFace=function(){this.i1=0,this.i2=0,this.v1=new box2d.b2Vec2,this.v2=new box2d.b2Vec2,this.normal=new box2d.b2Vec2,this.sideNormal1=new box2d.b2Vec2,this.sideOffset1=0,this.sideNormal2=new box2d.b2Vec2,this.sideOffset2=0},box2d.b2ReferenceFace.prototype.i1=0,box2d.b2ReferenceFace.prototype.i2=0,box2d.b2ReferenceFace.prototype.v1=null,box2d.b2ReferenceFace.prototype.v2=null,box2d.b2ReferenceFace.prototype.normal=null,box2d.b2ReferenceFace.prototype.sideNormal1=null,box2d.b2ReferenceFace.prototype.sideOffset1=0,box2d.b2ReferenceFace.prototype.sideNormal2=null,box2d.b2ReferenceFace.prototype.sideOffset2=0,box2d.b2EPColliderVertexType={e_isolated:0,e_concave:1,e_convex:2},goog.exportProperty(box2d.b2EPColliderVertexType,"e_isolated",box2d.b2EPColliderVertexType.e_isolated),goog.exportProperty(box2d.b2EPColliderVertexType,"e_concave",box2d.b2EPColliderVertexType.e_concave),goog.exportProperty(box2d.b2EPColliderVertexType,"e_convex",box2d.b2EPColliderVertexType.e_convex),box2d.b2EPCollider=function(){this.m_polygonB=new box2d.b2TempPolygon,this.m_xf=new box2d.b2Transform,this.m_centroidB=new box2d.b2Vec2,this.m_v0=new box2d.b2Vec2,this.m_v1=new box2d.b2Vec2,this.m_v2=new box2d.b2Vec2,this.m_v3=new box2d.b2Vec2,this.m_normal0=new box2d.b2Vec2,this.m_normal1=new box2d.b2Vec2,this.m_normal2=new box2d.b2Vec2,this.m_normal=new box2d.b2Vec2,this.m_type1=box2d.b2EPColliderVertexType.e_isolated,this.m_type2=box2d.b2EPColliderVertexType.e_isolated,this.m_lowerLimit=new box2d.b2Vec2,this.m_upperLimit=new box2d.b2Vec2,this.m_radius=0,this.m_front=!1},box2d.b2EPCollider.prototype.m_polygonB=null,box2d.b2EPCollider.prototype.m_xf=null,box2d.b2EPCollider.prototype.m_centroidB=null,box2d.b2EPCollider.prototype.m_v0=null,box2d.b2EPCollider.prototype.m_v1=null,box2d.b2EPCollider.prototype.m_v2=null,box2d.b2EPCollider.prototype.m_v3=null,box2d.b2EPCollider.prototype.m_normal0=null,box2d.b2EPCollider.prototype.m_normal1=null,box2d.b2EPCollider.prototype.m_normal2=null,box2d.b2EPCollider.prototype.m_normal=null,box2d.b2EPCollider.prototype.m_type1=box2d.b2EPColliderVertexType.e_isolated,box2d.b2EPCollider.prototype.m_type2=box2d.b2EPColliderVertexType.e_isolated,box2d.b2EPCollider.prototype.m_lowerLimit=null,box2d.b2EPCollider.prototype.m_upperLimit=null,box2d.b2EPCollider.prototype.m_radius=0,box2d.b2EPCollider.prototype.m_front=!1,box2d.b2EPCollider.prototype.Collide=function(e,t,i,s,a){box2d.b2MulTXX(i,a,this.m_xf),box2d.b2MulXV(this.m_xf,s.m_centroid,this.m_centroidB),this.m_v0.Copy(t.m_vertex0),this.m_v1.Copy(t.m_vertex1),this.m_v2.Copy(t.m_vertex2),this.m_v3.Copy(t.m_vertex3);var n=t.m_hasVertex0,o=t.m_hasVertex3,r=box2d.b2SubVV(this.m_v2,this.m_v1,box2d.b2EPCollider.s_edge1);r.Normalize(),this.m_normal1.SetXY(r.y,-r.x);var l=box2d.b2DotVV(this.m_normal1,box2d.b2SubVV(this.m_centroidB,this.m_v1,box2d.b2Vec2.s_t0)),h=0,c=0,p=!1,d=!1;if(n){var u=box2d.b2SubVV(this.m_v1,this.m_v0,box2d.b2EPCollider.s_edge0);u.Normalize(),this.m_normal0.SetXY(u.y,-u.x),p=box2d.b2CrossVV(u,r)>=0,h=box2d.b2DotVV(this.m_normal0,box2d.b2SubVV(this.m_centroidB,this.m_v0,box2d.b2Vec2.s_t0))}if(o){var m=box2d.b2SubVV(this.m_v3,this.m_v2,box2d.b2EPCollider.s_edge2);m.Normalize(),this.m_normal2.SetXY(m.y,-m.x),d=box2d.b2CrossVV(r,m)>0,c=box2d.b2DotVV(this.m_normal2,box2d.b2SubVV(this.m_centroidB,this.m_v2,box2d.b2Vec2.s_t0))}n&&o?p&&d?(this.m_front=h>=0||l>=0||c>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):p?(this.m_front=h>=0||l>=0&&c>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):d?(this.m_front=c>=0||h>=0&&l>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):(this.m_front=h>=0&&l>=0&&c>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):n?p?(this.m_front=h>=0||l>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal0),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg())):(this.m_front=h>=0&&l>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal0).SelfNeg())):o?d?(this.m_front=l>=0||c>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal2)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1))):(this.m_front=l>=0&&c>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1)):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal2).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1))):(this.m_front=l>=0,this.m_front?(this.m_normal.Copy(this.m_normal1),this.m_lowerLimit.Copy(this.m_normal1).SelfNeg(),this.m_upperLimit.Copy(this.m_normal1).SelfNeg()):(this.m_normal.Copy(this.m_normal1).SelfNeg(),this.m_lowerLimit.Copy(this.m_normal1),this.m_upperLimit.Copy(this.m_normal1))),this.m_polygonB.count=s.m_count;for(var g=0,y=s.m_count;y>g;++g)box2d.b2MulXV(this.m_xf,s.m_vertices[g],this.m_polygonB.vertices[g]),box2d.b2MulRV(this.m_xf.q,s.m_normals[g],this.m_polygonB.normals[g]);this.m_radius=2*box2d.b2_polygonRadius,e.pointCount=0;var b=this.ComputeEdgeSeparation(box2d.b2EPCollider.s_edgeAxis);if(b.type!==box2d.b2EPAxisType.e_unknown&&!(b.separation>this.m_radius)){var x=this.ComputePolygonSeparation(box2d.b2EPCollider.s_polygonAxis);if(!(x.type!==box2d.b2EPAxisType.e_unknown&&x.separation>this.m_radius)){var v;v=x.type===box2d.b2EPAxisType.e_unknown?b:x.separation>.98*b.separation+.001?x:b;var f=box2d.b2EPCollider.s_ie,w=box2d.b2EPCollider.s_rf;if(v.type===box2d.b2EPAxisType.e_edgeA){e.type=box2d.b2ManifoldType.e_faceA;for(var k=0,_=box2d.b2DotVV(this.m_normal,this.m_polygonB.normals[0]),g=1,y=this.m_polygonB.count;y>g;++g){var S=box2d.b2DotVV(this.m_normal,this.m_polygonB.normals[g]);_>S&&(_=S,k=g)}var M=k,A=(M+1)%this.m_polygonB.count;(C=f[0]).v.Copy(this.m_polygonB.vertices[M]),C.id.cf.indexA=0,C.id.cf.indexB=M,C.id.cf.typeA=box2d.b2ContactFeatureType.e_face,C.id.cf.typeB=box2d.b2ContactFeatureType.e_vertex,(P=f[1]).v.Copy(this.m_polygonB.vertices[A]),P.id.cf.indexA=0,P.id.cf.indexB=A,P.id.cf.typeA=box2d.b2ContactFeatureType.e_face,P.id.cf.typeB=box2d.b2ContactFeatureType.e_vertex,this.m_front?(w.i1=0,w.i2=1,w.v1.Copy(this.m_v1),w.v2.Copy(this.m_v2),w.normal.Copy(this.m_normal1)):(w.i1=1,w.i2=0,w.v1.Copy(this.m_v2),w.v2.Copy(this.m_v1),w.normal.Copy(this.m_normal1).SelfNeg())}else{e.type=box2d.b2ManifoldType.e_faceB;var C=f[0];C.v.Copy(this.m_v1),C.id.cf.indexA=0,C.id.cf.indexB=v.index,C.id.cf.typeA=box2d.b2ContactFeatureType.e_vertex,C.id.cf.typeB=box2d.b2ContactFeatureType.e_face;var P=f[1];P.v.Copy(this.m_v2),P.id.cf.indexA=0,P.id.cf.indexB=v.index,P.id.cf.typeA=box2d.b2ContactFeatureType.e_vertex,P.id.cf.typeB=box2d.b2ContactFeatureType.e_face,w.i1=v.index,w.i2=(w.i1+1)%this.m_polygonB.count,w.v1.Copy(this.m_polygonB.vertices[w.i1]),w.v2.Copy(this.m_polygonB.vertices[w.i2]),w.normal.Copy(this.m_polygonB.normals[w.i1])}w.sideNormal1.SetXY(w.normal.y,-w.normal.x),w.sideNormal2.Copy(w.sideNormal1).SelfNeg(),w.sideOffset1=box2d.b2DotVV(w.sideNormal1,w.v1),w.sideOffset2=box2d.b2DotVV(w.sideNormal2,w.v2);var T=box2d.b2EPCollider.s_clipPoints1,X=box2d.b2EPCollider.s_clipPoints2;if(!(box2d.b2ClipSegmentToLine(T,f,w.sideNormal1,w.sideOffset1,w.i1)<box2d.b2_maxManifoldPoints||box2d.b2ClipSegmentToLine(X,T,w.sideNormal2,w.sideOffset2,w.i2)<box2d.b2_maxManifoldPoints)){v.type===box2d.b2EPAxisType.e_edgeA?(e.localNormal.Copy(w.normal),e.localPoint.Copy(w.v1)):(e.localNormal.Copy(s.m_normals[w.i1]),e.localPoint.Copy(s.m_vertices[w.i1]));for(var Y=0,g=0,y=box2d.b2_maxManifoldPoints;y>g;++g){if(box2d.b2DotVV(w.normal,box2d.b2SubVV(X[g].v,w.v1,box2d.b2Vec2.s_t0))<=this.m_radius){var G=e.points[Y];v.type===box2d.b2EPAxisType.e_edgeA?(box2d.b2MulTXV(this.m_xf,X[g].v,G.localPoint),G.id=X[g].id):(G.localPoint.Copy(X[g].v),G.id.cf.typeA=X[g].id.cf.typeB,G.id.cf.typeB=X[g].id.cf.typeA,G.id.cf.indexA=X[g].id.cf.indexB,G.id.cf.indexB=X[g].id.cf.indexA),++Y}}e.pointCount=Y}}}},box2d.b2EPCollider.s_edge1=new box2d.b2Vec2,box2d.b2EPCollider.s_edge0=new box2d.b2Vec2,box2d.b2EPCollider.s_edge2=new box2d.b2Vec2,box2d.b2EPCollider.s_ie=box2d.b2ClipVertex.MakeArray(2),box2d.b2EPCollider.s_rf=new box2d.b2ReferenceFace,box2d.b2EPCollider.s_clipPoints1=box2d.b2ClipVertex.MakeArray(2),box2d.b2EPCollider.s_clipPoints2=box2d.b2ClipVertex.MakeArray(2),box2d.b2EPCollider.s_edgeAxis=new box2d.b2EPAxis,box2d.b2EPCollider.s_polygonAxis=new box2d.b2EPAxis,box2d.b2EPCollider.prototype.ComputeEdgeSeparation=function(e){var t=e;t.type=box2d.b2EPAxisType.e_edgeA,t.index=this.m_front?0:1,t.separation=box2d.b2_maxFloat;for(var i=0,s=this.m_polygonB.count;s>i;++i){var a=box2d.b2DotVV(this.m_normal,box2d.b2SubVV(this.m_polygonB.vertices[i],this.m_v1,box2d.b2Vec2.s_t0));a<t.separation&&(t.separation=a)}return t},box2d.b2EPCollider.prototype.ComputePolygonSeparation=function(e){var t=e;t.type=box2d.b2EPAxisType.e_unknown,t.index=-1,t.separation=-box2d.b2_maxFloat;for(var i=box2d.b2EPCollider.s_perp.SetXY(-this.m_normal.y,this.m_normal.x),s=0,a=this.m_polygonB.count;a>s;++s){var n=box2d.b2NegV(this.m_polygonB.normals[s],box2d.b2EPCollider.s_n),o=box2d.b2DotVV(n,box2d.b2SubVV(this.m_polygonB.vertices[s],this.m_v1,box2d.b2Vec2.s_t0)),r=box2d.b2DotVV(n,box2d.b2SubVV(this.m_polygonB.vertices[s],this.m_v2,box2d.b2Vec2.s_t0)),l=box2d.b2Min(o,r);if(l>this.m_radius)return t.type=box2d.b2EPAxisType.e_edgeB,t.index=s,t.separation=l,t;if(box2d.b2DotVV(n,i)>=0){if(box2d.b2DotVV(box2d.b2SubVV(n,this.m_upperLimit,box2d.b2Vec2.s_t0),this.m_normal)<-box2d.b2_angularSlop)continue}else if(box2d.b2DotVV(box2d.b2SubVV(n,this.m_lowerLimit,box2d.b2Vec2.s_t0),this.m_normal)<-box2d.b2_angularSlop)continue;l>t.separation&&(t.type=box2d.b2EPAxisType.e_edgeB,t.index=s,t.separation=l)}return t},box2d.b2EPCollider.s_n=new box2d.b2Vec2,box2d.b2EPCollider.s_perp=new box2d.b2Vec2,box2d.b2CollideEdgeAndPolygon=function(e,t,i,s,a){box2d.b2CollideEdgeAndPolygon.s_collider.Collide(e,t,i,s,a)},box2d.b2CollideEdgeAndPolygon.s_collider=new box2d.b2EPCollider,goog.provide("box2d.b2EdgeShape"),goog.require("box2d.b2Shape"),box2d.b2EdgeShape=function(){goog.base(this,box2d.b2ShapeType.e_edgeShape,box2d.b2_polygonRadius),this.m_vertex1=new box2d.b2Vec2,this.m_vertex2=new box2d.b2Vec2,this.m_vertex0=new box2d.b2Vec2,this.m_vertex3=new box2d.b2Vec2},goog.inherits(box2d.b2EdgeShape,box2d.b2Shape),box2d.b2EdgeShape.prototype.m_vertex1=null,box2d.b2EdgeShape.prototype.m_vertex2=null,box2d.b2EdgeShape.prototype.m_vertex0=null,box2d.b2EdgeShape.prototype.m_vertex3=null,box2d.b2EdgeShape.prototype.m_hasVertex0=!1,box2d.b2EdgeShape.prototype.m_hasVertex3=!1,box2d.b2EdgeShape.prototype.Set=function(e,t){return this.m_vertex1.Copy(e),this.m_vertex2.Copy(t),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this},box2d.b2EdgeShape.prototype.SetAsEdge=box2d.b2EdgeShape.prototype.Set,box2d.b2EdgeShape.prototype.Clone=function(){return(new box2d.b2EdgeShape).Copy(this)},box2d.b2EdgeShape.prototype.Copy=function(e){return goog.base(this,"Copy",e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2EdgeShape),this.m_vertex1.Copy(e.m_vertex1),this.m_vertex2.Copy(e.m_vertex2),this.m_vertex0.Copy(e.m_vertex0),this.m_vertex3.Copy(e.m_vertex3),this.m_hasVertex0=e.m_hasVertex0,this.m_hasVertex3=e.m_hasVertex3,this},box2d.b2EdgeShape.prototype.GetChildCount=function(){return 1},box2d.b2EdgeShape.prototype.TestPoint=function(){return!1},box2d.b2EdgeShape.prototype.RayCast=function(e,t,i){var s=box2d.b2MulTXV(i,t.p1,box2d.b2EdgeShape.prototype.RayCast.s_p1),a=box2d.b2MulTXV(i,t.p2,box2d.b2EdgeShape.prototype.RayCast.s_p2),n=box2d.b2SubVV(a,s,box2d.b2EdgeShape.prototype.RayCast.s_d),o=this.m_vertex1,r=this.m_vertex2,l=box2d.b2SubVV(r,o,box2d.b2EdgeShape.prototype.RayCast.s_e),h=e.normal.SetXY(l.y,-l.x).SelfNormalize(),c=box2d.b2DotVV(h,box2d.b2SubVV(o,s,box2d.b2Vec2.s_t0)),p=box2d.b2DotVV(h,n);if(0===p)return!1;var d=c/p;if(0>d||t.maxFraction<d)return!1;var u=box2d.b2AddVMulSV(s,d,n,box2d.b2EdgeShape.prototype.RayCast.s_q),m=box2d.b2SubVV(r,o,box2d.b2EdgeShape.prototype.RayCast.s_r),g=box2d.b2DotVV(m,m);if(0===g)return!1;var y=box2d.b2DotVV(box2d.b2SubVV(u,o,box2d.b2Vec2.s_t0),m)/g;return!(0>y||y>1)&&(e.fraction=d,box2d.b2MulRV(i.q,e.normal,e.normal),c>0&&e.normal.SelfNeg(),!0)},box2d.b2EdgeShape.prototype.RayCast.s_p1=new box2d.b2Vec2,box2d.b2EdgeShape.prototype.RayCast.s_p2=new box2d.b2Vec2,box2d.b2EdgeShape.prototype.RayCast.s_d=new box2d.b2Vec2,box2d.b2EdgeShape.prototype.RayCast.s_e=new box2d.b2Vec2,box2d.b2EdgeShape.prototype.RayCast.s_q=new box2d.b2Vec2,box2d.b2EdgeShape.prototype.RayCast.s_r=new box2d.b2Vec2,box2d.b2EdgeShape.prototype.ComputeAABB=function(e,t){var i=box2d.b2MulXV(t,this.m_vertex1,box2d.b2EdgeShape.prototype.ComputeAABB.s_v1),s=box2d.b2MulXV(t,this.m_vertex2,box2d.b2EdgeShape.prototype.ComputeAABB.s_v2);box2d.b2MinV(i,s,e.lowerBound),box2d.b2MaxV(i,s,e.upperBound);var a=this.m_radius;e.lowerBound.SelfSubXY(a,a),e.upperBound.SelfAddXY(a,a)},box2d.b2EdgeShape.prototype.ComputeAABB.s_v1=new box2d.b2Vec2,box2d.b2EdgeShape.prototype.ComputeAABB.s_v2=new box2d.b2Vec2,box2d.b2EdgeShape.prototype.ComputeMass=function(e){e.mass=0,box2d.b2MidVV(this.m_vertex1,this.m_vertex2,e.center),e.I=0},box2d.b2EdgeShape.prototype.SetupDistanceProxy=function(e){e.m_vertices=new Array(2),e.m_vertices[0]=this.m_vertex1,e.m_vertices[1]=this.m_vertex2,e.m_count=2,e.m_radius=this.m_radius},box2d.b2EdgeShape.prototype.ComputeSubmergedArea=function(e,t,i,s){return s.SetZero(),0},box2d.b2EdgeShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2EdgeShape*/ var shape = new box2d.b2EdgeShape();\n"),box2d.b2Log("    shape.m_radius = %.15f;\n",this.m_radius),box2d.b2Log("    shape.m_vertex0.SetXY(%.15f, %.15f);\n",this.m_vertex0.x,this.m_vertex0.y),box2d.b2Log("    shape.m_vertex1.SetXY(%.15f, %.15f);\n",this.m_vertex1.x,this.m_vertex1.y),box2d.b2Log("    shape.m_vertex2.SetXY(%.15f, %.15f);\n",this.m_vertex2.x,this.m_vertex2.y),box2d.b2Log("    shape.m_vertex3.SetXY(%.15f, %.15f);\n",this.m_vertex3.x,this.m_vertex3.y),box2d.b2Log("    shape.m_hasVertex0 = %s;\n",this.m_hasVertex0),box2d.b2Log("    shape.m_hasVertex3 = %s;\n",this.m_hasVertex3)},goog.provide("box2d.b2ChainShape"),goog.require("box2d.b2Shape"),goog.require("box2d.b2EdgeShape"),box2d.b2ChainShape=function(){goog.base(this,box2d.b2ShapeType.e_chainShape,box2d.b2_polygonRadius),this.m_prevVertex=new box2d.b2Vec2,this.m_nextVertex=new box2d.b2Vec2},goog.inherits(box2d.b2ChainShape,box2d.b2Shape),box2d.b2ChainShape.prototype.m_vertices=null,box2d.b2ChainShape.prototype.m_count=0,box2d.b2ChainShape.prototype.m_prevVertex=null,box2d.b2ChainShape.prototype.m_nextVertex=null,box2d.b2ChainShape.prototype.m_hasPrevVertex=!1,box2d.b2ChainShape.prototype.m_hasNextVertex=!1,box2d.b2ChainShape.prototype.CreateLoop=function(e,t){if(t=t||e.length,box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===this.m_vertices&&0===this.m_count),box2d.ENABLE_ASSERTS&&box2d.b2Assert(t>=3),box2d.ENABLE_ASSERTS)for(a=1;t>a;++a){var i=e[a-1],s=e[a];box2d.b2Assert(box2d.b2DistanceSquaredVV(i,s)>box2d.b2_linearSlop*box2d.b2_linearSlop)}this.m_count=t+1,this.m_vertices=box2d.b2Vec2.MakeArray(this.m_count);for(var a=0;t>a;++a)this.m_vertices[a].Copy(e[a]);return this.m_vertices[t].Copy(this.m_vertices[0]),this.m_prevVertex.Copy(this.m_vertices[this.m_count-2]),this.m_nextVertex.Copy(this.m_vertices[1]),this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this},box2d.b2ChainShape.prototype.CreateChain=function(e,t){if(t=t||e.length,box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===this.m_vertices&&0===this.m_count),box2d.ENABLE_ASSERTS&&box2d.b2Assert(t>=2),box2d.ENABLE_ASSERTS)for(a=1;t>a;++a){var i=e[a-1],s=e[a];box2d.b2Assert(box2d.b2DistanceSquaredVV(i,s)>box2d.b2_linearSlop*box2d.b2_linearSlop)}this.m_count=t,this.m_vertices=box2d.b2Vec2.MakeArray(t);for(var a=0;t>a;++a)this.m_vertices[a].Copy(e[a]);return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex.SetZero(),this.m_nextVertex.SetZero(),this},box2d.b2ChainShape.prototype.SetPrevVertex=function(e){return this.m_prevVertex.Copy(e),this.m_hasPrevVertex=!0,this},box2d.b2ChainShape.prototype.SetNextVertex=function(e){return this.m_nextVertex.Copy(e),this.m_hasNextVertex=!0,this},box2d.b2ChainShape.prototype.Clone=function(){return(new box2d.b2ChainShape).Copy(this)},box2d.b2ChainShape.prototype.Copy=function(e){return goog.base(this,"Copy",e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2ChainShape),this.CreateChain(e.m_vertices,e.m_count),this.m_prevVertex.Copy(e.m_prevVertex),this.m_nextVertex.Copy(e.m_nextVertex),this.m_hasPrevVertex=e.m_hasPrevVertex,this.m_hasNextVertex=e.m_hasNextVertex,this},box2d.b2ChainShape.prototype.GetChildCount=function(){return this.m_count-1},box2d.b2ChainShape.prototype.GetChildEdge=function(e,t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(t>=0&&t<this.m_count-1),e.m_type=box2d.b2ShapeType.e_edgeShape,e.m_radius=this.m_radius,e.m_vertex1.Copy(this.m_vertices[t]),e.m_vertex2.Copy(this.m_vertices[t+1]),t>0?(e.m_vertex0.Copy(this.m_vertices[t-1]),e.m_hasVertex0=!0):(e.m_vertex0.Copy(this.m_prevVertex),e.m_hasVertex0=this.m_hasPrevVertex),t<this.m_count-2?(e.m_vertex3.Copy(this.m_vertices[t+2]),e.m_hasVertex3=!0):(e.m_vertex3.Copy(this.m_nextVertex),e.m_hasVertex3=this.m_hasNextVertex)},box2d.b2ChainShape.prototype.TestPoint=function(){return!1},box2d.b2ChainShape.prototype.RayCast=function(e,t,i,s){box2d.ENABLE_ASSERTS&&box2d.b2Assert(s<this.m_count);var a=box2d.b2ChainShape.s_edgeShape;return a.m_vertex1.Copy(this.m_vertices[s]),a.m_vertex2.Copy(this.m_vertices[(s+1)%this.m_count]),a.RayCast(e,t,i,0)},box2d.b2ChainShape.s_edgeShape=new box2d.b2EdgeShape,box2d.b2ChainShape.prototype.ComputeAABB=function(e,t,i){box2d.ENABLE_ASSERTS&&box2d.b2Assert(i<this.m_count);var s=this.m_vertices[i],a=this.m_vertices[(i+1)%this.m_count],n=box2d.b2MulXV(t,s,box2d.b2ChainShape.prototype.ComputeAABB.s_v1),o=box2d.b2MulXV(t,a,box2d.b2ChainShape.prototype.ComputeAABB.s_v2);box2d.b2MinV(n,o,e.lowerBound),box2d.b2MaxV(n,o,e.upperBound)},box2d.b2ChainShape.prototype.ComputeAABB.s_v1=new box2d.b2Vec2,box2d.b2ChainShape.prototype.ComputeAABB.s_v2=new box2d.b2Vec2,box2d.b2ChainShape.prototype.ComputeMass=function(e){e.mass=0,e.center.SetZero(),e.I=0},box2d.b2ChainShape.prototype.SetupDistanceProxy=function(e,t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(t>=0&&t<this.m_count),e.m_buffer[0].Copy(this.m_vertices[t]),e.m_buffer[1].Copy(t+1<this.m_count?this.m_vertices[t+1]:this.m_vertices[0]),e.m_vertices=e.m_buffer,e.m_count=2,e.m_radius=this.m_radius},box2d.b2ChainShape.prototype.ComputeSubmergedArea=function(e,t,i,s){return s.SetZero(),0},box2d.b2ChainShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2ChainShape*/ var shape = new box2d.b2ChainShape();\n"),box2d.b2Log("    /*box2d.b2Vec2[]*/ var vs = box2d.b2Vec2.MakeArray(%d);\n",box2d.b2_maxPolygonVertices);for(var e=0;e<this.m_count;++e)box2d.b2Log("    vs[%d].SetXY(%.15f, %.15f);\n",e,this.m_vertices[e].x,this.m_vertices[e].y);box2d.b2Log("    shape.CreateChain(vs, %d);\n",this.m_count),box2d.b2Log("    shape.m_prevVertex.SetXY(%.15f, %.15f);\n",this.m_prevVertex.x,this.m_prevVertex.y),box2d.b2Log("    shape.m_nextVertex.SetXY(%.15f, %.15f);\n",this.m_nextVertex.x,this.m_nextVertex.y),box2d.b2Log("    shape.m_hasPrevVertex = %s;\n",this.m_hasPrevVertex?"true":"false"),box2d.b2Log("    shape.m_hasNextVertex = %s;\n",this.m_hasNextVertex?"true":"false")},goog.provide("box2d.b2ChainAndPolygonContact"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Contact"),goog.require("box2d.b2CollideEdge"),goog.require("box2d.b2ChainShape"),goog.require("box2d.b2PolygonShape"),box2d.b2ChainAndPolygonContact=function(){goog.base(this)},goog.inherits(box2d.b2ChainAndPolygonContact,box2d.b2Contact),box2d.b2ChainAndPolygonContact.Create=function(){return new box2d.b2ChainAndPolygonContact},box2d.b2ChainAndPolygonContact.Destroy=function(){},box2d.b2ChainAndPolygonContact.prototype.Reset=function(e,t,i,s){goog.base(this,"Reset",e,t,i,s),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.GetType()===box2d.b2ShapeType.e_chainShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(i.GetType()===box2d.b2ShapeType.e_polygonShape)},box2d.b2ChainAndPolygonContact.prototype.Evaluate=function(e,t,i){var s=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(s instanceof box2d.b2ChainShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2PolygonShape);var n=s instanceof box2d.b2ChainShape?s:null,o=box2d.b2ChainAndPolygonContact.prototype.Evaluate.s_edge;n.GetChildEdge(o,this.m_indexA),box2d.b2CollideEdgeAndPolygon(e,o,t,a instanceof box2d.b2PolygonShape?a:null,i)},box2d.b2ChainAndPolygonContact.prototype.Evaluate.s_edge=new box2d.b2EdgeShape,goog.provide("box2d.b2CollidePolygon"),goog.require("box2d.b2Collision"),box2d.b2FindMaxSeparation=function(e,t,i,s,a){for(var n=t.m_count,o=s.m_count,r=t.m_normals,l=t.m_vertices,h=s.m_vertices,c=box2d.b2MulTXX(a,i,box2d.b2FindMaxSeparation.s_xf),p=0,d=-box2d.b2_maxFloat,u=0;n>u;++u){for(var m=box2d.b2MulRV(c.q,r[u],box2d.b2FindMaxSeparation.s_n),g=box2d.b2MulXV(c,l[u],box2d.b2FindMaxSeparation.s_v1),y=box2d.b2_maxFloat,b=0;o>b;++b){var x=box2d.b2DotVV(m,box2d.b2SubVV(h[b],g,box2d.b2Vec2.s_t0));y>x&&(y=x)}y>d&&(d=y,p=u)}return e[0]=p,d},box2d.b2FindMaxSeparation.s_xf=new box2d.b2Transform,box2d.b2FindMaxSeparation.s_n=new box2d.b2Vec2,box2d.b2FindMaxSeparation.s_v1=new box2d.b2Vec2,box2d.b2FindIncidentEdge=function(e,t,i,s,a,n){var o=t.m_count,r=t.m_normals,l=a.m_count,h=a.m_vertices,c=a.m_normals;box2d.ENABLE_ASSERTS&&box2d.b2Assert(s>=0&&o>s);for(var p=box2d.b2MulTRV(n.q,box2d.b2MulRV(i.q,r[s],box2d.b2Vec2.s_t0),box2d.b2FindIncidentEdge.s_normal1),d=0,u=box2d.b2_maxFloat,m=0;l>m;++m){var g=box2d.b2DotVV(p,c[m]);u>g&&(u=g,d=m)}var y=d,b=(y+1)%l,x=e[0];box2d.b2MulXV(n,h[y],x.v);var v=x.id.cf;v.indexA=s,v.indexB=y,v.typeA=box2d.b2ContactFeatureType.e_face,v.typeB=box2d.b2ContactFeatureType.e_vertex;var f=e[1];box2d.b2MulXV(n,h[b],f.v);var w=f.id.cf;w.indexA=s,w.indexB=b,w.typeA=box2d.b2ContactFeatureType.e_face,w.typeB=box2d.b2ContactFeatureType.e_vertex},box2d.b2FindIncidentEdge.s_normal1=new box2d.b2Vec2,box2d.b2CollidePolygons=function(e,t,i,s,a){e.pointCount=0;var n=t.m_radius+s.m_radius,o=box2d.b2CollidePolygons.s_edgeA;o[0]=0;var r=box2d.b2FindMaxSeparation(o,t,i,s,a);if(!(r>n)){var l=box2d.b2CollidePolygons.s_edgeB;l[0]=0;var h=box2d.b2FindMaxSeparation(l,s,a,t,i);if(!(h>n)){var c,p,d,u,m=0,g=0;h>.98*r+.001?(c=s,p=t,d=a,u=i,m=l[0],e.type=box2d.b2ManifoldType.e_faceB,g=1):(c=t,p=s,d=i,u=a,m=o[0],e.type=box2d.b2ManifoldType.e_faceA,g=0);var y=box2d.b2CollidePolygons.s_incidentEdge;box2d.b2FindIncidentEdge(y,c,d,m,p,u);var b=c.m_count,x=c.m_vertices,v=m,f=(m+1)%b,w=x[v],k=x[f],_=box2d.b2SubVV(k,w,box2d.b2CollidePolygons.s_localTangent);_.Normalize();var S=box2d.b2CrossVOne(_,box2d.b2CollidePolygons.s_localNormal),M=box2d.b2MidVV(w,k,box2d.b2CollidePolygons.s_planePoint),A=box2d.b2MulRV(d.q,_,box2d.b2CollidePolygons.s_tangent),C=box2d.b2CrossVOne(A,box2d.b2CollidePolygons.s_normal),P=box2d.b2MulXV(d,w,box2d.b2CollidePolygons.s_v11),T=box2d.b2MulXV(d,k,box2d.b2CollidePolygons.s_v12),X=box2d.b2DotVV(C,P),Y=-box2d.b2DotVV(A,P)+n,G=box2d.b2DotVV(A,T)+n,B=box2d.b2CollidePolygons.s_clipPoints1,L=box2d.b2CollidePolygons.s_clipPoints2,E=box2d.b2NegV(A,box2d.b2CollidePolygons.s_ntangent);if(!(2>box2d.b2ClipSegmentToLine(B,y,E,Y,v)||2>box2d.b2ClipSegmentToLine(L,B,A,G,f))){e.localNormal.Copy(S),e.localPoint.Copy(M);for(var R=0,D=0;D<box2d.b2_maxManifoldPoints;++D){var F=L[D];if(n>=box2d.b2DotVV(C,F.v)-X){var I=e.points[R];if(box2d.b2MulTXV(u,F.v,I.localPoint),I.id.Copy(F.id),g){var V=I.id.cf;I.id.cf.indexA=V.indexB,I.id.cf.indexB=V.indexA,I.id.cf.typeA=V.typeB,I.id.cf.typeB=V.typeA}++R}}e.pointCount=R}}}},box2d.b2CollidePolygons.s_incidentEdge=box2d.b2ClipVertex.MakeArray(2),box2d.b2CollidePolygons.s_clipPoints1=box2d.b2ClipVertex.MakeArray(2),box2d.b2CollidePolygons.s_clipPoints2=box2d.b2ClipVertex.MakeArray(2),box2d.b2CollidePolygons.s_edgeA=box2d.b2MakeNumberArray(1),box2d.b2CollidePolygons.s_edgeB=box2d.b2MakeNumberArray(1),box2d.b2CollidePolygons.s_localTangent=new box2d.b2Vec2,box2d.b2CollidePolygons.s_localNormal=new box2d.b2Vec2,box2d.b2CollidePolygons.s_planePoint=new box2d.b2Vec2,box2d.b2CollidePolygons.s_normal=new box2d.b2Vec2,box2d.b2CollidePolygons.s_tangent=new box2d.b2Vec2,box2d.b2CollidePolygons.s_ntangent=new box2d.b2Vec2,box2d.b2CollidePolygons.s_v11=new box2d.b2Vec2,box2d.b2CollidePolygons.s_v12=new box2d.b2Vec2,goog.provide("box2d.b2PolygonContact"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Contact"),goog.require("box2d.b2CollidePolygon"),box2d.b2PolygonContact=function(){goog.base(this)},goog.inherits(box2d.b2PolygonContact,box2d.b2Contact),box2d.b2PolygonContact.Create=function(){return new box2d.b2PolygonContact},box2d.b2PolygonContact.Destroy=function(){},box2d.b2PolygonContact.prototype.Reset=function(e,t,i,s){goog.base(this,"Reset",e,t,i,s)},box2d.b2PolygonContact.prototype.Evaluate=function(e,t,i){var s=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(s instanceof box2d.b2PolygonShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2PolygonShape),box2d.b2CollidePolygons(e,s instanceof box2d.b2PolygonShape?s:null,t,a instanceof box2d.b2PolygonShape?a:null,i)},goog.provide("box2d.b2CollideCircle"),goog.require("box2d.b2Collision"),box2d.b2CollideCircles=function(e,t,i,s,a){e.pointCount=0;var n=box2d.b2MulXV(i,t.m_p,box2d.b2CollideCircles.s_pA),o=box2d.b2MulXV(a,s.m_p,box2d.b2CollideCircles.s_pB),r=box2d.b2DistanceSquaredVV(n,o),l=t.m_radius+s.m_radius;r>l*l||(e.type=box2d.b2ManifoldType.e_circles,e.localPoint.Copy(t.m_p),e.localNormal.SetZero(),e.pointCount=1,e.points[0].localPoint.Copy(s.m_p),e.points[0].id.key=0)},box2d.b2CollideCircles.s_pA=new box2d.b2Vec2,box2d.b2CollideCircles.s_pB=new box2d.b2Vec2,box2d.b2CollidePolygonAndCircle=function(e,t,i,s,a){e.pointCount=0;for(var n=box2d.b2MulXV(a,s.m_p,box2d.b2CollidePolygonAndCircle.s_c),o=box2d.b2MulTXV(i,n,box2d.b2CollidePolygonAndCircle.s_cLocal),r=0,l=-box2d.b2_maxFloat,h=t.m_radius+s.m_radius,c=t.m_count,p=t.m_vertices,d=t.m_normals,u=0;c>u;++u){var m=box2d.b2DotVV(d[u],box2d.b2SubVV(o,p[u],box2d.b2Vec2.s_t0));if(m>h)return;m>l&&(l=m,r=u)}var g=r,y=(g+1)%c,b=p[g],x=p[y];if(l<box2d.b2_epsilon)return e.pointCount=1,e.type=box2d.b2ManifoldType.e_faceA,e.localNormal.Copy(d[r]),box2d.b2MidVV(b,x,e.localPoint),e.points[0].localPoint.Copy(s.m_p),void(e.points[0].id.key=0);var v=box2d.b2DotVV(box2d.b2SubVV(o,b,box2d.b2Vec2.s_t0),box2d.b2SubVV(x,b,box2d.b2Vec2.s_t1)),f=box2d.b2DotVV(box2d.b2SubVV(o,x,box2d.b2Vec2.s_t0),box2d.b2SubVV(b,x,box2d.b2Vec2.s_t1));if(0>=v){if(box2d.b2DistanceSquaredVV(o,b)>h*h)return;e.pointCount=1,e.type=box2d.b2ManifoldType.e_faceA,box2d.b2SubVV(o,b,e.localNormal).SelfNormalize(),e.localPoint.Copy(b),e.points[0].localPoint.Copy(s.m_p),e.points[0].id.key=0}else if(0>=f){if(box2d.b2DistanceSquaredVV(o,x)>h*h)return;e.pointCount=1,e.type=box2d.b2ManifoldType.e_faceA,box2d.b2SubVV(o,x,e.localNormal).SelfNormalize(),e.localPoint.Copy(x),e.points[0].localPoint.Copy(s.m_p),e.points[0].id.key=0}else{var w=box2d.b2MidVV(b,x,box2d.b2CollidePolygonAndCircle.s_faceCenter);if((l=box2d.b2DotVV(box2d.b2SubVV(o,w,box2d.b2Vec2.s_t1),d[g]))>h)return;e.pointCount=1,e.type=box2d.b2ManifoldType.e_faceA,e.localNormal.Copy(d[g]).SelfNormalize(),e.localPoint.Copy(w),e.points[0].localPoint.Copy(s.m_p),e.points[0].id.key=0}},box2d.b2CollidePolygonAndCircle.s_c=new box2d.b2Vec2,box2d.b2CollidePolygonAndCircle.s_cLocal=new box2d.b2Vec2,box2d.b2CollidePolygonAndCircle.s_faceCenter=new box2d.b2Vec2,goog.provide("box2d.b2CircleContact"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Contact"),goog.require("box2d.b2CollideCircle"),box2d.b2CircleContact=function(){goog.base(this)},goog.inherits(box2d.b2CircleContact,box2d.b2Contact),box2d.b2CircleContact.Create=function(){return new box2d.b2CircleContact},box2d.b2CircleContact.Destroy=function(){},box2d.b2CircleContact.prototype.Reset=function(e,t,i,s){goog.base(this,"Reset",e,t,i,s)},box2d.b2CircleContact.prototype.Evaluate=function(e,t,i){var s=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(s instanceof box2d.b2CircleShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2CircleShape),box2d.b2CollideCircles(e,s instanceof box2d.b2CircleShape?s:null,t,a instanceof box2d.b2CircleShape?a:null,i)},goog.provide("box2d.b2ChainAndCircleContact"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Contact"),goog.require("box2d.b2CollideEdge"),box2d.b2ChainAndCircleContact=function(){goog.base(this)},goog.inherits(box2d.b2ChainAndCircleContact,box2d.b2Contact),box2d.b2ChainAndCircleContact.Create=function(){return new box2d.b2ChainAndCircleContact},box2d.b2ChainAndCircleContact.Destroy=function(){},box2d.b2ChainAndCircleContact.prototype.Reset=function(e,t,i,s){goog.base(this,"Reset",e,t,i,s),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.GetType()===box2d.b2ShapeType.e_chainShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(i.GetType()===box2d.b2ShapeType.e_circleShape)},box2d.b2ChainAndCircleContact.prototype.Evaluate=function(e,t,i){var s=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(s instanceof box2d.b2ChainShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2CircleShape);var n=s instanceof box2d.b2ChainShape?s:null,o=box2d.b2ChainAndCircleContact.prototype.Evaluate.s_edge;n.GetChildEdge(o,this.m_indexA),box2d.b2CollideEdgeAndCircle(e,o,t,a instanceof box2d.b2CircleShape?a:null,i)},box2d.b2ChainAndCircleContact.prototype.Evaluate.s_edge=new box2d.b2EdgeShape,goog.provide("box2d.b2EdgeAndCircleContact"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Contact"),goog.require("box2d.b2CollideEdge"),box2d.b2EdgeAndCircleContact=function(){goog.base(this)},goog.inherits(box2d.b2EdgeAndCircleContact,box2d.b2Contact),box2d.b2EdgeAndCircleContact.Create=function(){return new box2d.b2EdgeAndCircleContact},box2d.b2EdgeAndCircleContact.Destroy=function(){},box2d.b2EdgeAndCircleContact.prototype.Reset=function(e,t,i,s){goog.base(this,"Reset",e,t,i,s),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.GetType()===box2d.b2ShapeType.e_edgeShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(i.GetType()===box2d.b2ShapeType.e_circleShape)},box2d.b2EdgeAndCircleContact.prototype.Evaluate=function(e,t,i){var s=this.m_fixtureA.GetShape(),a=this.m_fixtureB.GetShape();box2d.ENABLE_ASSERTS&&box2d.b2Assert(s instanceof box2d.b2EdgeShape),box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2CircleShape),box2d.b2CollideEdgeAndCircle(e,s instanceof box2d.b2EdgeShape?s:null,t,a instanceof box2d.b2CircleShape?a:null,i)},goog.provide("box2d.b2ContactSolver"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Math"),goog.require("box2d.b2Collision"),goog.require("box2d.b2CircleContact"),goog.require("box2d.b2PolygonAndCircleContact"),goog.require("box2d.b2PolygonContact"),goog.require("box2d.b2EdgeAndCircleContact"),goog.require("box2d.b2EdgeAndPolygonContact"),goog.require("box2d.b2ChainAndCircleContact"),goog.require("box2d.b2ChainAndPolygonContact"),box2d.b2VelocityConstraintPoint=function(){this.rA=new box2d.b2Vec2,this.rB=new box2d.b2Vec2},box2d.b2VelocityConstraintPoint.prototype.rA=null,box2d.b2VelocityConstraintPoint.prototype.rB=null,box2d.b2VelocityConstraintPoint.prototype.normalImpulse=0,box2d.b2VelocityConstraintPoint.prototype.tangentImpulse=0,box2d.b2VelocityConstraintPoint.prototype.normalMass=0,box2d.b2VelocityConstraintPoint.prototype.tangentMass=0,box2d.b2VelocityConstraintPoint.prototype.velocityBias=0,box2d.b2VelocityConstraintPoint.MakeArray=function(e){return box2d.b2MakeArray(e,function(){return new box2d.b2VelocityConstraintPoint})},box2d.b2ContactVelocityConstraint=function(){this.points=box2d.b2VelocityConstraintPoint.MakeArray(box2d.b2_maxManifoldPoints),this.normal=new box2d.b2Vec2,this.tangent=new box2d.b2Vec2,this.normalMass=new box2d.b2Mat22,this.K=new box2d.b2Mat22},box2d.b2ContactVelocityConstraint.prototype.points=null,box2d.b2ContactVelocityConstraint.prototype.normal=null,box2d.b2ContactVelocityConstraint.prototype.tangent=null,box2d.b2ContactVelocityConstraint.prototype.normalMass=null,box2d.b2ContactVelocityConstraint.prototype.K=null,box2d.b2ContactVelocityConstraint.prototype.indexA=0,box2d.b2ContactVelocityConstraint.prototype.indexB=0,box2d.b2ContactVelocityConstraint.prototype.invMassA=0,box2d.b2ContactVelocityConstraint.prototype.invMassB=0,box2d.b2ContactVelocityConstraint.prototype.invIA=0,box2d.b2ContactVelocityConstraint.prototype.invIB=0,box2d.b2ContactVelocityConstraint.prototype.friction=0,box2d.b2ContactVelocityConstraint.prototype.restitution=0,box2d.b2ContactVelocityConstraint.prototype.tangentSpeed=0,box2d.b2ContactVelocityConstraint.prototype.pointCount=0,box2d.b2ContactVelocityConstraint.prototype.contactIndex=0,box2d.b2ContactVelocityConstraint.MakeArray=function(e){return box2d.b2MakeArray(e,function(){return new box2d.b2ContactVelocityConstraint})},box2d.b2ContactPositionConstraint=function(){this.localPoints=box2d.b2Vec2.MakeArray(box2d.b2_maxManifoldPoints),this.localNormal=new box2d.b2Vec2,this.localPoint=new box2d.b2Vec2,this.localCenterA=new box2d.b2Vec2,this.localCenterB=new box2d.b2Vec2},box2d.b2ContactPositionConstraint.prototype.localPoints=null,box2d.b2ContactPositionConstraint.prototype.localNormal=null,box2d.b2ContactPositionConstraint.prototype.localPoint=null,box2d.b2ContactPositionConstraint.prototype.indexA=0,box2d.b2ContactPositionConstraint.prototype.indexB=0,box2d.b2ContactPositionConstraint.prototype.invMassA=0,box2d.b2ContactPositionConstraint.prototype.invMassB=0,box2d.b2ContactPositionConstraint.prototype.localCenterA=null,box2d.b2ContactPositionConstraint.prototype.localCenterB=null,box2d.b2ContactPositionConstraint.prototype.invIA=0,box2d.b2ContactPositionConstraint.prototype.invIB=0,box2d.b2ContactPositionConstraint.prototype.type=box2d.b2ManifoldType.e_unknown,box2d.b2ContactPositionConstraint.prototype.radiusA=0,box2d.b2ContactPositionConstraint.prototype.radiusB=0,box2d.b2ContactPositionConstraint.prototype.pointCount=0,box2d.b2ContactPositionConstraint.MakeArray=function(e){return box2d.b2MakeArray(e,function(){return new box2d.b2ContactPositionConstraint})},box2d.b2ContactSolverDef=function(){this.step=new box2d.b2TimeStep},box2d.b2ContactSolverDef.prototype.step=null,box2d.b2ContactSolverDef.prototype.contacts=null,box2d.b2ContactSolverDef.prototype.count=0,box2d.b2ContactSolverDef.prototype.positions=null,box2d.b2ContactSolverDef.prototype.velocities=null,box2d.b2ContactSolverDef.prototype.allocator=null,box2d.b2ContactSolver=function(){this.m_step=new box2d.b2TimeStep,this.m_positionConstraints=box2d.b2ContactPositionConstraint.MakeArray(1024),this.m_velocityConstraints=box2d.b2ContactVelocityConstraint.MakeArray(1024)},box2d.b2ContactSolver.prototype.m_step=null,box2d.b2ContactSolver.prototype.m_positions=null,box2d.b2ContactSolver.prototype.m_velocities=null,box2d.b2ContactSolver.prototype.m_allocator=null,box2d.b2ContactSolver.prototype.m_positionConstraints=null,box2d.b2ContactSolver.prototype.m_velocityConstraints=null,box2d.b2ContactSolver.prototype.m_contacts=null,box2d.b2ContactSolver.prototype.m_count=0,box2d.b2ContactSolver.prototype.Initialize=function(e){if(this.m_step.Copy(e.step),this.m_allocator=e.allocator,this.m_count=e.count,this.m_positionConstraints.length<this.m_count){t=box2d.b2Max(2*this.m_positionConstraints.length,this.m_count);for(box2d.DEBUG&&window.console.log("box2d.b2ContactSolver.m_positionConstraints: "+t);this.m_positionConstraints.length<t;)this.m_positionConstraints[this.m_positionConstraints.length]=new box2d.b2ContactPositionConstraint}if(this.m_velocityConstraints.length<this.m_count){var t=box2d.b2Max(2*this.m_velocityConstraints.length,this.m_count);for(box2d.DEBUG&&window.console.log("box2d.b2ContactSolver.m_velocityConstraints: "+t);this.m_velocityConstraints.length<t;)this.m_velocityConstraints[this.m_velocityConstraints.length]=new box2d.b2ContactVelocityConstraint}this.m_positions=e.positions,this.m_velocities=e.velocities,this.m_contacts=e.contacts;var i,s,a,n,o,r,l,h,c,p,d,u,m,g,y,b,x,v,f;for(i=0,s=this.m_count;s>i;++i)for(o=this.m_contacts[i],r=o.m_fixtureA,l=o.m_fixtureB,h=r.GetShape(),c=l.GetShape(),p=h.m_radius,d=c.m_radius,u=r.GetBody(),m=l.GetBody(),g=o.GetManifold(),y=g.pointCount,box2d.ENABLE_ASSERTS&&box2d.b2Assert(y>0),b=this.m_velocityConstraints[i],b.friction=o.m_friction,b.restitution=o.m_restitution,b.tangentSpeed=o.m_tangentSpeed,b.indexA=u.m_islandIndex,b.indexB=m.m_islandIndex,b.invMassA=u.m_invMass,b.invMassB=m.m_invMass,b.invIA=u.m_invI,b.invIB=m.m_invI,b.contactIndex=i,b.pointCount=y,b.K.SetZero(),b.normalMass.SetZero(),x=this.m_positionConstraints[i],x.indexA=u.m_islandIndex,x.indexB=m.m_islandIndex,x.invMassA=u.m_invMass,x.invMassB=m.m_invMass,x.localCenterA.Copy(u.m_sweep.localCenter),x.localCenterB.Copy(m.m_sweep.localCenter),x.invIA=u.m_invI,x.invIB=m.m_invI,x.localNormal.Copy(g.localNormal),x.localPoint.Copy(g.localPoint),x.pointCount=y,x.radiusA=p,x.radiusB=d,x.type=g.type,a=0,n=y;n>a;++a)v=g.points[a],f=b.points[a],this.m_step.warmStarting?(f.normalImpulse=this.m_step.dtRatio*v.normalImpulse,f.tangentImpulse=this.m_step.dtRatio*v.tangentImpulse):(f.normalImpulse=0,f.tangentImpulse=0),f.rA.SetZero(),f.rB.SetZero(),f.normalMass=0,f.tangentMass=0,f.velocityBias=0,x.localPoints[a].Copy(v.localPoint);return this},box2d.b2ContactSolver.prototype.InitializeVelocityConstraints=function(){var e,t,i,s,a,n,o,r,l,h,c,p,d,u,m,g,y,b,x,v,f,w,k,_,S,M,A,C,P,T,X,Y,G,B,L,E,R,D,F,I,V,W,O,N=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfA,U=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfB,J=box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_worldManifold;for(e=0,t=this.m_count;t>e;++e){for(a=this.m_velocityConstraints[e],o=(n=this.m_positionConstraints[e]).radiusA,r=n.radiusB,l=this.m_contacts[a.contactIndex].GetManifold(),h=a.indexA,c=a.indexB,p=a.invMassA,d=a.invMassB,u=a.invIA,m=a.invIB,g=n.localCenterA,y=n.localCenterB,b=this.m_positions[h].c,x=this.m_positions[h].a,v=this.m_velocities[h].v,f=this.m_velocities[h].w,w=this.m_positions[c].c,k=this.m_positions[c].a,_=this.m_velocities[c].v,S=this.m_velocities[c].w,box2d.ENABLE_ASSERTS&&box2d.b2Assert(l.pointCount>0),N.q.SetAngleRadians(x),U.q.SetAngleRadians(k),box2d.b2SubVV(b,box2d.b2MulRV(N.q,g,box2d.b2Vec2.s_t0),N.p),box2d.b2SubVV(w,box2d.b2MulRV(U.q,y,box2d.b2Vec2.s_t0),U.p),J.Initialize(l,N,o,U,r),a.normal.Copy(J.normal),box2d.b2CrossVOne(a.normal,a.tangent),i=0,s=a.pointCount;s>i;++i)M=a.points[i],box2d.b2SubVV(J.points[i],b,M.rA),box2d.b2SubVV(J.points[i],w,M.rB),A=box2d.b2CrossVV(M.rA,a.normal),C=box2d.b2CrossVV(M.rB,a.normal),P=p+d+u*A*A+m*C*C,M.normalMass=P>0?1/P:0,T=a.tangent,X=box2d.b2CrossVV(M.rA,T),Y=box2d.b2CrossVV(M.rB,T),G=p+d+u*X*X+m*Y*Y,M.tangentMass=G>0?1/G:0,M.velocityBias=0,(B=box2d.b2DotVV(a.normal,box2d.b2SubVV(box2d.b2AddVCrossSV(_,S,M.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(v,f,M.rA,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t0)))<-box2d.b2_velocityThreshold&&(M.velocityBias+=-a.restitution*B);2===a.pointCount&&(L=a.points[0],E=a.points[1],R=box2d.b2CrossVV(L.rA,a.normal),D=box2d.b2CrossVV(L.rB,a.normal),F=box2d.b2CrossVV(E.rA,a.normal),I=box2d.b2CrossVV(E.rB,a.normal),V=p+d+u*R*R+m*D*D,W=p+d+u*F*F+m*I*I,O=p+d+u*R*F+m*D*I,1e3*(V*W-O*O)>V*V?(a.K.ex.SetXY(V,O),a.K.ey.SetXY(O,W),a.K.GetInverse(a.normalMass)):a.pointCount=1)}},box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfA=new box2d.b2Transform,box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_xfB=new box2d.b2Transform,box2d.b2ContactSolver.prototype.InitializeVelocityConstraints.s_worldManifold=new box2d.b2WorldManifold,box2d.b2ContactSolver.prototype.WarmStart=function(){var e,t,i,s,a,n,o,r,l,h,c,p,d,u,m,g,y,b,x,v=box2d.b2ContactSolver.prototype.WarmStart.s_P;for(e=0,t=this.m_count;t>e;++e){for(n=(a=this.m_velocityConstraints[e]).indexA,o=a.indexB,r=a.invMassA,l=a.invIA,h=a.invMassB,c=a.invIB,p=a.pointCount,d=this.m_velocities[n].v,u=this.m_velocities[n].w,m=this.m_velocities[o].v,g=this.m_velocities[o].w,y=a.normal,b=a.tangent,i=0,s=p;s>i;++i)x=a.points[i],box2d.b2AddVV(box2d.b2MulSV(x.normalImpulse,y,box2d.b2Vec2.s_t0),box2d.b2MulSV(x.tangentImpulse,b,box2d.b2Vec2.s_t1),v),u-=l*box2d.b2CrossVV(x.rA,v),d.SelfMulSub(r,v),g+=c*box2d.b2CrossVV(x.rB,v),m.SelfMulAdd(h,v);this.m_velocities[n].w=u,this.m_velocities[o].w=g}},box2d.b2ContactSolver.prototype.WarmStart.s_P=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints=function(){var e,t,i,s,a,n,o,r,l,h,c,p,d,u,m,g,y,b,x,v,f,w,k,_,S,M,A,C,P,T=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv,X=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv1,Y=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv2,G=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P,B=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_a,L=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_b,E=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_x,R=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_d,D=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1,F=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P2,I=box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1P2;for(e=0,t=this.m_count;t>e;++e){for(n=(a=this.m_velocityConstraints[e]).indexA,o=a.indexB,r=a.invMassA,l=a.invIA,h=a.invMassB,c=a.invIB,p=a.pointCount,d=this.m_velocities[n].v,u=this.m_velocities[n].w,m=this.m_velocities[o].v,g=this.m_velocities[o].w,y=a.normal,b=a.tangent,x=a.friction,box2d.ENABLE_ASSERTS&&box2d.b2Assert(1===p||2===p),i=0,s=p;s>i;++i)v=a.points[i],box2d.b2SubVV(box2d.b2AddVCrossSV(m,g,v.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(d,u,v.rA,box2d.b2Vec2.s_t1),T),f=box2d.b2DotVV(T,b)-a.tangentSpeed,k=v.tangentMass*-f,_=x*v.normalImpulse,S=box2d.b2Clamp(v.tangentImpulse+k,-_,_),k=S-v.tangentImpulse,v.tangentImpulse=S,box2d.b2MulSV(k,b,G),d.SelfMulSub(r,G),u-=l*box2d.b2CrossVV(v.rA,G),m.SelfMulAdd(h,G),g+=c*box2d.b2CrossVV(v.rB,G);if(1===a.pointCount)v=a.points[0],box2d.b2SubVV(box2d.b2AddVCrossSV(m,g,v.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(d,u,v.rA,box2d.b2Vec2.s_t1),T),w=box2d.b2DotVV(T,y),k=-v.normalMass*(w-v.velocityBias),S=box2d.b2Max(v.normalImpulse+k,0),k=S-v.normalImpulse,v.normalImpulse=S,box2d.b2MulSV(k,y,G),d.SelfMulSub(r,G),u-=l*box2d.b2CrossVV(v.rA,G),m.SelfMulAdd(h,G),g+=c*box2d.b2CrossVV(v.rB,G);else for(M=a.points[0],A=a.points[1],B.SetXY(M.normalImpulse,A.normalImpulse),box2d.ENABLE_ASSERTS&&box2d.b2Assert(B.x>=0&&B.y>=0),box2d.b2SubVV(box2d.b2AddVCrossSV(m,g,M.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(d,u,M.rA,box2d.b2Vec2.s_t1),X),box2d.b2SubVV(box2d.b2AddVCrossSV(m,g,A.rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(d,u,A.rA,box2d.b2Vec2.s_t1),Y),C=box2d.b2DotVV(X,y),P=box2d.b2DotVV(Y,y),L.x=C-M.velocityBias,L.y=P-A.velocityBias,L.SelfSub(box2d.b2MulMV(a.K,B,box2d.b2Vec2.s_t0));;){if(box2d.b2MulMV(a.normalMass,L,E).SelfNeg(),E.x>=0&&E.y>=0){box2d.b2SubVV(E,B,R),box2d.b2MulSV(R.x,y,D),box2d.b2MulSV(R.y,y,F),box2d.b2AddVV(D,F,I),d.SelfMulSub(r,I),u-=l*(box2d.b2CrossVV(M.rA,D)+box2d.b2CrossVV(A.rA,F)),m.SelfMulAdd(h,I),g+=c*(box2d.b2CrossVV(M.rB,D)+box2d.b2CrossVV(A.rB,F)),M.normalImpulse=E.x,A.normalImpulse=E.y;break}if(E.x=-M.normalMass*L.x,E.y=0,C=0,P=a.K.ex.y*E.x+L.y,E.x>=0&&P>=0){box2d.b2SubVV(E,B,R),box2d.b2MulSV(R.x,y,D),box2d.b2MulSV(R.y,y,F),box2d.b2AddVV(D,F,I),d.SelfMulSub(r,I),u-=l*(box2d.b2CrossVV(M.rA,D)+box2d.b2CrossVV(A.rA,F)),m.SelfMulAdd(h,I),g+=c*(box2d.b2CrossVV(M.rB,D)+box2d.b2CrossVV(A.rB,F)),M.normalImpulse=E.x,A.normalImpulse=E.y;break}if(E.x=0,E.y=-A.normalMass*L.y,C=a.K.ey.x*E.y+L.x,P=0,E.y>=0&&C>=0){box2d.b2SubVV(E,B,R),box2d.b2MulSV(R.x,y,D),box2d.b2MulSV(R.y,y,F),box2d.b2AddVV(D,F,I),d.SelfMulSub(r,I),u-=l*(box2d.b2CrossVV(M.rA,D)+box2d.b2CrossVV(A.rA,F)),m.SelfMulAdd(h,I),g+=c*(box2d.b2CrossVV(M.rB,D)+box2d.b2CrossVV(A.rB,F)),M.normalImpulse=E.x,A.normalImpulse=E.y;break}if(E.x=0,E.y=0,C=L.x,P=L.y,C>=0&&P>=0){box2d.b2SubVV(E,B,R),box2d.b2MulSV(R.x,y,D),box2d.b2MulSV(R.y,y,F),box2d.b2AddVV(D,F,I),d.SelfMulSub(r,I),u-=l*(box2d.b2CrossVV(M.rA,D)+box2d.b2CrossVV(A.rA,F)),m.SelfMulAdd(h,I),g+=c*(box2d.b2CrossVV(M.rB,D)+box2d.b2CrossVV(A.rB,F)),M.normalImpulse=E.x,A.normalImpulse=E.y;break}break}this.m_velocities[n].w=u,this.m_velocities[o].w=g}},box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv1=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_dv2=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_a=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_b=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_x=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_d=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P2=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveVelocityConstraints.s_P1P2=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.StoreImpulses=function(){var e,t,i,s,a,n;for(e=0,t=this.m_count;t>e;++e)for(a=this.m_velocityConstraints[e],n=this.m_contacts[a.contactIndex].GetManifold(),i=0,s=a.pointCount;s>i;++i)n.points[i].normalImpulse=a.points[i].normalImpulse,n.points[i].tangentImpulse=a.points[i].tangentImpulse},box2d.b2PositionSolverManifold=function(){this.normal=new box2d.b2Vec2,this.point=new box2d.b2Vec2},box2d.b2PositionSolverManifold.prototype.normal=null,box2d.b2PositionSolverManifold.prototype.point=null,box2d.b2PositionSolverManifold.prototype.separation=0,box2d.b2PositionSolverManifold.prototype.Initialize=function(e,t,i,s){var a=box2d.b2PositionSolverManifold.prototype.Initialize.s_pointA,n=box2d.b2PositionSolverManifold.prototype.Initialize.s_pointB,o=box2d.b2PositionSolverManifold.prototype.Initialize.s_planePoint,r=box2d.b2PositionSolverManifold.prototype.Initialize.s_clipPoint;switch(box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.pointCount>0),e.type){case box2d.b2ManifoldType.e_circles:box2d.b2MulXV(t,e.localPoint,a),box2d.b2MulXV(i,e.localPoints[0],n),box2d.b2SubVV(n,a,this.normal).SelfNormalize(),box2d.b2MidVV(a,n,this.point),this.separation=box2d.b2DotVV(box2d.b2SubVV(n,a,box2d.b2Vec2.s_t0),this.normal)-e.radiusA-e.radiusB;break;case box2d.b2ManifoldType.e_faceA:box2d.b2MulRV(t.q,e.localNormal,this.normal),box2d.b2MulXV(t,e.localPoint,o),box2d.b2MulXV(i,e.localPoints[s],r),this.separation=box2d.b2DotVV(box2d.b2SubVV(r,o,box2d.b2Vec2.s_t0),this.normal)-e.radiusA-e.radiusB,this.point.Copy(r);break;case box2d.b2ManifoldType.e_faceB:box2d.b2MulRV(i.q,e.localNormal,this.normal),box2d.b2MulXV(i,e.localPoint,o),box2d.b2MulXV(t,e.localPoints[s],r),this.separation=box2d.b2DotVV(box2d.b2SubVV(r,o,box2d.b2Vec2.s_t0),this.normal)-e.radiusA-e.radiusB,this.point.Copy(r),this.normal.SelfNeg()}},box2d.b2PositionSolverManifold.prototype.Initialize.s_pointA=new box2d.b2Vec2,box2d.b2PositionSolverManifold.prototype.Initialize.s_pointB=new box2d.b2Vec2,box2d.b2PositionSolverManifold.prototype.Initialize.s_planePoint=new box2d.b2Vec2,box2d.b2PositionSolverManifold.prototype.Initialize.s_clipPoint=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolvePositionConstraints=function(){var e,t,i,s,a,n,o,r,l,h,c,p,d,u,m,g,y,b,x,v,f,w,k,_,S,M,A=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfA,C=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfB,P=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_psm,T=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rA,X=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rB,Y=box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_P,G=0;for(e=0,t=this.m_count;t>e;++e){for(n=(a=this.m_positionConstraints[e]).indexA,o=a.indexB,r=a.localCenterA,l=a.invMassA,h=a.invIA,c=a.localCenterB,p=a.invMassB,d=a.invIB,u=a.pointCount,m=this.m_positions[n].c,g=this.m_positions[n].a,y=this.m_positions[o].c,b=this.m_positions[o].a,i=0,s=u;s>i;++i)A.q.SetAngleRadians(g),C.q.SetAngleRadians(b),box2d.b2SubVV(m,box2d.b2MulRV(A.q,r,box2d.b2Vec2.s_t0),A.p),box2d.b2SubVV(y,box2d.b2MulRV(C.q,c,box2d.b2Vec2.s_t0),C.p),P.Initialize(a,A,C,i),x=P.normal,v=P.point,f=P.separation,box2d.b2SubVV(v,m,T),box2d.b2SubVV(v,y,X),G=box2d.b2Min(G,f),w=box2d.b2Clamp(box2d.b2_baumgarte*(f+box2d.b2_linearSlop),-box2d.b2_maxLinearCorrection,0),k=box2d.b2CrossVV(T,x),_=box2d.b2CrossVV(X,x),S=l+p+h*k*k+d*_*_,M=S>0?-w/S:0,box2d.b2MulSV(M,x,Y),m.SelfMulSub(l,Y),g-=h*box2d.b2CrossVV(T,Y),y.SelfMulAdd(p,Y),b+=d*box2d.b2CrossVV(X,Y);this.m_positions[n].a=g,this.m_positions[o].a=b}return G>-3*box2d.b2_linearSlop},box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfA=new box2d.b2Transform,box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_xfB=new box2d.b2Transform,box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_psm=new box2d.b2PositionSolverManifold,box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rA=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_rB=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints=function(e,t){var i,s,a,n,o,r,l,h,c,p,d,u,m,g,y,b,x,v,f,w,k,_,S,M,A,C,P=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfA,T=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfB,X=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_psm,Y=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rA,G=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rB,B=box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_P,L=0;for(i=0,s=this.m_count;s>i;++i){for(r=(o=this.m_positionConstraints[i]).indexA,l=o.indexB,h=o.localCenterA,c=o.localCenterB,p=o.pointCount,d=0,u=0,(r===e||r===t)&&(d=o.invMassA,u=o.invIA),m=0,g=0,(l===e||l===t)&&(m=o.invMassB,g=o.invIB),y=this.m_positions[r].c,b=this.m_positions[r].a,x=this.m_positions[l].c,v=this.m_positions[l].a,a=0,n=p;n>a;++a)P.q.SetAngleRadians(b),T.q.SetAngleRadians(v),box2d.b2SubVV(y,box2d.b2MulRV(P.q,h,box2d.b2Vec2.s_t0),P.p),box2d.b2SubVV(x,box2d.b2MulRV(T.q,c,box2d.b2Vec2.s_t0),T.p),X.Initialize(o,P,T,a),f=X.normal,w=X.point,k=X.separation,box2d.b2SubVV(w,y,Y),box2d.b2SubVV(w,x,G),L=box2d.b2Min(L,k),_=box2d.b2Clamp(box2d.b2_toiBaumgarte*(k+box2d.b2_linearSlop),-box2d.b2_maxLinearCorrection,0),S=box2d.b2CrossVV(Y,f),M=box2d.b2CrossVV(G,f),A=d+m+u*S*S+g*M*M,C=A>0?-_/A:0,box2d.b2MulSV(C,f,B),y.SelfMulSub(d,B),b-=u*box2d.b2CrossVV(Y,B),x.SelfMulAdd(m,B),v+=g*box2d.b2CrossVV(G,B);this.m_positions[r].a=b,this.m_positions[l].a=v}return L>=-1.5*box2d.b2_linearSlop},box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfA=new box2d.b2Transform,box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_xfB=new box2d.b2Transform,box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_psm=new box2d.b2PositionSolverManifold,box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rA=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_rB=new box2d.b2Vec2,box2d.b2ContactSolver.prototype.SolveTOIPositionConstraints.s_P=new box2d.b2Vec2,goog.provide("box2d.b2WorldCallbacks"),goog.require("box2d.b2Settings"),box2d.b2DestructionListener=function(){},box2d.b2DestructionListener.prototype.SayGoodbyeJoint=function(){},box2d.b2DestructionListener.prototype.SayGoodbyeFixture=function(){},box2d.b2ContactFilter=function(){},box2d.b2ContactFilter.prototype.ShouldCollide=function(e,t){var i=e.GetFilterData(),s=t.GetFilterData();return i.groupIndex===s.groupIndex&&0!==i.groupIndex?i.groupIndex>0:0!=(i.maskBits&s.categoryBits)&&0!=(i.categoryBits&s.maskBits)},box2d.b2ContactFilter.b2_defaultFilter=new box2d.b2ContactFilter,box2d.b2ContactImpulse=function(){this.normalImpulses=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints),this.tangentImpulses=box2d.b2MakeNumberArray(box2d.b2_maxManifoldPoints)},box2d.b2ContactImpulse.prototype.normalImpulses=null,box2d.b2ContactImpulse.prototype.tangentImpulses=null,box2d.b2ContactImpulse.prototype.count=0,box2d.b2ContactListener=function(){},box2d.b2ContactListener.prototype.BeginContact=function(){},box2d.b2ContactListener.prototype.EndContact=function(){},box2d.b2ContactListener.prototype.PreSolve=function(){},box2d.b2ContactListener.prototype.PostSolve=function(){},box2d.b2ContactListener.b2_defaultListener=new box2d.b2ContactListener,box2d.b2QueryCallback=function(){},box2d.b2QueryCallback.prototype.ReportFixture=function(){return!0},box2d.b2RayCastCallback=function(){},box2d.b2RayCastCallback.prototype.ReportFixture=function(e,t,i,s){return s},goog.provide("box2d.b2Island"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Timer"),goog.require("box2d.b2TimeStep"),goog.require("box2d.b2WorldCallbacks"),goog.require("box2d.b2ContactSolver"),box2d.b2Island=function(){this.m_bodies=new Array(1024),this.m_contacts=new Array(1024),this.m_joints=new Array(1024),this.m_positions=box2d.b2Position.MakeArray(1024),this.m_velocities=box2d.b2Velocity.MakeArray(1024)},box2d.b2Island.prototype.m_allocator=null,box2d.b2Island.prototype.m_listener=null,box2d.b2Island.prototype.m_bodies=null,box2d.b2Island.prototype.m_contacts=null,box2d.b2Island.prototype.m_joints=null,box2d.b2Island.prototype.m_positions=null,box2d.b2Island.prototype.m_velocities=null,box2d.b2Island.prototype.m_bodyCount=0,box2d.b2Island.prototype.m_jointCount=0,box2d.b2Island.prototype.m_contactCount=0,box2d.b2Island.prototype.m_bodyCapacity=0,box2d.b2Island.prototype.m_contactCapacity=0,box2d.b2Island.prototype.m_jointCapacity=0,box2d.b2Island.prototype.Initialize=function(e,t,i,s,a){for(this.m_bodyCapacity=e,this.m_contactCapacity=t,this.m_jointCapacity=i,this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0,this.m_allocator=s,this.m_listener=a;this.m_bodies.length<e;)this.m_bodies[this.m_bodies.length]=null;for(;this.m_contacts.length<t;)this.m_contacts[this.m_contacts.length]=null;for(;this.m_joints.length<i;)this.m_joints[this.m_joints.length]=null;if(this.m_positions.length<e){n=box2d.b2Max(2*this.m_positions.length,e);for(box2d.DEBUG&&window.console.log("box2d.b2Island.m_positions: "+n);this.m_positions.length<n;)this.m_positions[this.m_positions.length]=new box2d.b2Position}if(this.m_velocities.length<e){var n=box2d.b2Max(2*this.m_velocities.length,e);for(box2d.DEBUG&&window.console.log("box2d.b2Island.m_velocities: "+n);this.m_velocities.length<n;)this.m_velocities[this.m_velocities.length]=new box2d.b2Velocity}},box2d.b2Island.prototype.Clear=function(){this.m_bodyCount=0,this.m_contactCount=0,this.m_jointCount=0},box2d.b2Island.prototype.AddBody=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_bodyCount<this.m_bodyCapacity),e.m_islandIndex=this.m_bodyCount,this.m_bodies[this.m_bodyCount++]=e},box2d.b2Island.prototype.AddContact=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_contactCount<this.m_contactCapacity),this.m_contacts[this.m_contactCount++]=e},box2d.b2Island.prototype.AddJoint=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_jointCount<this.m_jointCapacity),this.m_joints[this.m_jointCount++]=e},box2d.b2Island.prototype.Solve=function(e,t,i,s){for(var a=box2d.b2Island.s_timer.Reset(),n=t.dt,o=0;o<this.m_bodyCount;++o){var r=this.m_bodies[o],l=this.m_positions[o].c.Copy(r.m_sweep.c),h=r.m_sweep.a,c=this.m_velocities[o].v.Copy(r.m_linearVelocity),p=r.m_angularVelocity;r.m_sweep.c0.Copy(r.m_sweep.c),r.m_sweep.a0=r.m_sweep.a,r.m_type===box2d.b2BodyType.b2_dynamicBody&&(c.x+=n*(r.m_gravityScale*i.x+r.m_invMass*r.m_force.x),c.y+=n*(r.m_gravityScale*i.y+r.m_invMass*r.m_force.y),p+=n*r.m_invI*r.m_torque,c.SelfMul(1/(1+n*r.m_linearDamping)),p*=1/(1+n*r.m_angularDamping)),this.m_positions[o].a=h,this.m_velocities[o].w=p}a.Reset();var d=box2d.b2Island.s_solverData;d.step.Copy(t),d.positions=this.m_positions,d.velocities=this.m_velocities;var u=box2d.b2Island.s_contactSolverDef;u.step.Copy(t),u.contacts=this.m_contacts,u.count=this.m_contactCount,u.positions=this.m_positions,u.velocities=this.m_velocities,u.allocator=this.m_allocator;var m=box2d.b2Island.s_contactSolver.Initialize(u);m.InitializeVelocityConstraints(),t.warmStarting&&m.WarmStart();for(o=0;o<this.m_jointCount;++o)this.m_joints[o].InitVelocityConstraints(d);e.solveInit=a.GetMilliseconds(),a.Reset();for(o=0;o<t.velocityIterations;++o){for(w=0;w<this.m_jointCount;++w)this.m_joints[w].SolveVelocityConstraints(d);m.SolveVelocityConstraints()}m.StoreImpulses(),e.solveVelocity=a.GetMilliseconds();for(o=0;o<this.m_bodyCount;++o){var l=this.m_positions[o].c,h=this.m_positions[o].a,c=this.m_velocities[o].v,p=this.m_velocities[o].w,g=box2d.b2MulSV(n,c,box2d.b2Island.s_translation);if(box2d.b2DotVV(g,g)>box2d.b2_maxTranslationSquared){var y=box2d.b2_maxTranslation/g.GetLength();c.SelfMul(y)}var b=n*p;b*b>box2d.b2_maxRotationSquared&&(p*=y=box2d.b2_maxRotation/box2d.b2Abs(b)),l.x+=n*c.x,l.y+=n*c.y,h+=n*p,this.m_positions[o].a=h,this.m_velocities[o].w=p}a.Reset();for(var x=!1,o=0;o<t.positionIterations;++o){for(var v=m.SolvePositionConstraints(),f=!0,w=0;w<this.m_jointCount;++w){var k=this.m_joints[w].SolvePositionConstraints(d);f=f&&k}if(v&&f){x=!0;break}}for(o=0;o<this.m_bodyCount;++o){var _=this.m_bodies[o];_.m_sweep.c.Copy(this.m_positions[o].c),_.m_sweep.a=this.m_positions[o].a,_.m_linearVelocity.Copy(this.m_velocities[o].v),_.m_angularVelocity=this.m_velocities[o].w,_.SynchronizeTransform()}if(e.solvePosition=a.GetMilliseconds(),this.Report(m.m_velocityConstraints),s){for(var S=box2d.b2_maxFloat,M=box2d.b2_linearSleepTolerance*box2d.b2_linearSleepTolerance,A=box2d.b2_angularSleepTolerance*box2d.b2_angularSleepTolerance,o=0;o<this.m_bodyCount;++o)(r=this.m_bodies[o]).GetType()!==box2d.b2BodyType.b2_staticBody&&(0==(r.m_flags&box2d.b2BodyFlag.e_autoSleepFlag)||r.m_angularVelocity*r.m_angularVelocity>A||box2d.b2DotVV(r.m_linearVelocity,r.m_linearVelocity)>M?(r.m_sleepTime=0,S=0):(r.m_sleepTime+=n,S=box2d.b2Min(S,r.m_sleepTime)));if(S>=box2d.b2_timeToSleep&&x)for(o=0;o<this.m_bodyCount;++o)(r=this.m_bodies[o]).SetAwake(!1)}},box2d.b2Island.prototype.SolveTOI=function(e,t,i){box2d.ENABLE_ASSERTS&&box2d.b2Assert(t<this.m_bodyCount),box2d.ENABLE_ASSERTS&&box2d.b2Assert(i<this.m_bodyCount);for(o=0;o<this.m_bodyCount;++o){var s=this.m_bodies[o];this.m_positions[o].c.Copy(s.m_sweep.c),this.m_positions[o].a=s.m_sweep.a,this.m_velocities[o].v.Copy(s.m_linearVelocity),this.m_velocities[o].w=s.m_angularVelocity}var a=box2d.b2Island.s_contactSolverDef;a.contacts=this.m_contacts,a.count=this.m_contactCount,a.allocator=this.m_allocator,a.step.Copy(e),a.positions=this.m_positions,a.velocities=this.m_velocities;for(var n=box2d.b2Island.s_contactSolver.Initialize(a),o=0;o<e.positionIterations&&!n.SolveTOIPositionConstraints(t,i);++o);this.m_bodies[t].m_sweep.c0.Copy(this.m_positions[t].c),this.m_bodies[t].m_sweep.a0=this.m_positions[t].a,this.m_bodies[i].m_sweep.c0.Copy(this.m_positions[i].c),this.m_bodies[i].m_sweep.a0=this.m_positions[i].a,n.InitializeVelocityConstraints();for(o=0;o<e.velocityIterations;++o)n.SolveVelocityConstraints();for(var r=e.dt,o=0;o<this.m_bodyCount;++o){var l=this.m_positions[o].c,h=this.m_positions[o].a,c=this.m_velocities[o].v,p=this.m_velocities[o].w,d=box2d.b2MulSV(r,c,box2d.b2Island.s_translation);if(box2d.b2DotVV(d,d)>box2d.b2_maxTranslationSquared){var u=box2d.b2_maxTranslation/d.GetLength();c.SelfMul(u)}var m=r*p;m*m>box2d.b2_maxRotationSquared&&(p*=u=box2d.b2_maxRotation/box2d.b2Abs(m)),l.SelfMulAdd(r,c),h+=r*p,this.m_positions[o].a=h,this.m_velocities[o].w=p;var g=this.m_bodies[o];g.m_sweep.c.Copy(l),g.m_sweep.a=h,g.m_linearVelocity.Copy(c),g.m_angularVelocity=p,g.SynchronizeTransform()}this.Report(n.m_velocityConstraints)},box2d.b2Island.prototype.Report=function(e){if(null!==this.m_listener)for(var t=0;t<this.m_contactCount;++t){var i=this.m_contacts[t];if(i){var s=e[t],a=box2d.b2Island.s_impulse;a.count=s.pointCount;for(var n=0;n<s.pointCount;++n)a.normalImpulses[n]=s.points[n].normalImpulse,a.tangentImpulses[n]=s.points[n].tangentImpulse;this.m_listener.PostSolve(i,a)}}},box2d.b2Island.s_timer=new box2d.b2Timer,box2d.b2Island.s_solverData=new box2d.b2SolverData,box2d.b2Island.s_contactSolverDef=new box2d.b2ContactSolverDef,box2d.b2Island.s_contactSolver=new box2d.b2ContactSolver,box2d.b2Island.s_translation=new box2d.b2Vec2,box2d.b2Island.s_impulse=new box2d.b2ContactImpulse,goog.provide("box2d.b2ContactFactory"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Contact"),box2d.b2ContactRegister=function(){},box2d.b2ContactRegister.prototype.createFcn=null,box2d.b2ContactRegister.prototype.destroyFcn=null,box2d.b2ContactRegister.prototype.primary=!1,box2d.b2ContactFactory=function(e){this.m_allocator=e,this.InitializeRegisters()},box2d.b2ContactFactory.prototype.m_allocator=null,box2d.b2ContactFactory.prototype.AddType=function(e,t,i,s){var a=box2d.b2MakeArray(256,function(){return e()}),n=function(t){return a.length>0?a.pop():e(t)},o=function(e){a.push(e)};this.m_registers[i][s].pool=a,this.m_registers[i][s].createFcn=n,this.m_registers[i][s].destroyFcn=o,this.m_registers[i][s].primary=!0,i!==s&&(this.m_registers[s][i].pool=a,this.m_registers[s][i].createFcn=n,this.m_registers[s][i].destroyFcn=o,this.m_registers[s][i].primary=!1)},box2d.b2ContactFactory.prototype.InitializeRegisters=function(){this.m_registers=new Array(box2d.b2ShapeType.e_shapeTypeCount);for(var e=0;e<box2d.b2ShapeType.e_shapeTypeCount;e++){this.m_registers[e]=new Array(box2d.b2ShapeType.e_shapeTypeCount);for(var t=0;t<box2d.b2ShapeType.e_shapeTypeCount;t++)this.m_registers[e][t]=new box2d.b2ContactRegister}this.AddType(box2d.b2CircleContact.Create,box2d.b2CircleContact.Destroy,box2d.b2ShapeType.e_circleShape,box2d.b2ShapeType.e_circleShape),this.AddType(box2d.b2PolygonAndCircleContact.Create,box2d.b2PolygonAndCircleContact.Destroy,box2d.b2ShapeType.e_polygonShape,box2d.b2ShapeType.e_circleShape),this.AddType(box2d.b2PolygonContact.Create,box2d.b2PolygonContact.Destroy,box2d.b2ShapeType.e_polygonShape,box2d.b2ShapeType.e_polygonShape),this.AddType(box2d.b2EdgeAndCircleContact.Create,box2d.b2EdgeAndCircleContact.Destroy,box2d.b2ShapeType.e_edgeShape,box2d.b2ShapeType.e_circleShape),this.AddType(box2d.b2EdgeAndPolygonContact.Create,box2d.b2EdgeAndPolygonContact.Destroy,box2d.b2ShapeType.e_edgeShape,box2d.b2ShapeType.e_polygonShape),this.AddType(box2d.b2ChainAndCircleContact.Create,box2d.b2ChainAndCircleContact.Destroy,box2d.b2ShapeType.e_chainShape,box2d.b2ShapeType.e_circleShape),this.AddType(box2d.b2ChainAndPolygonContact.Create,box2d.b2ChainAndPolygonContact.Destroy,box2d.b2ShapeType.e_chainShape,box2d.b2ShapeType.e_polygonShape)},box2d.b2ContactFactory.prototype.Create=function(e,t,i,s){var a=e.GetType(),n=i.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(a>=0&&a<box2d.b2ShapeType.e_shapeTypeCount),box2d.ENABLE_ASSERTS&&box2d.b2Assert(n>=0&&n<box2d.b2ShapeType.e_shapeTypeCount);var o=this.m_registers[a][n],r=o.createFcn;if(null!==r){if(o.primary)return(l=r(this.m_allocator)).Reset(e,t,i,s),l;var l=r(this.m_allocator);return l.Reset(i,s,e,t),l}return null},box2d.b2ContactFactory.prototype.Destroy=function(e){var t=e.m_fixtureA,i=e.m_fixtureB;e.m_manifold.pointCount>0&&!1===t.IsSensor()&&!1===i.IsSensor()&&(t.GetBody().SetAwake(!0),i.GetBody().SetAwake(!0));var s=t.GetType(),a=i.GetType();box2d.ENABLE_ASSERTS&&box2d.b2Assert(s>=0&&a<box2d.b2ShapeType.e_shapeTypeCount),box2d.ENABLE_ASSERTS&&box2d.b2Assert(s>=0&&a<box2d.b2ShapeType.e_shapeTypeCount),(0,this.m_registers[s][a].destroyFcn)(e,this.m_allocator)},goog.provide("box2d.b2GrowableStack"),goog.require("box2d.b2Settings"),box2d.b2GrowableStack=function(e){this.m_stack=new Array(e)},box2d.b2GrowableStack.prototype.m_stack=null,box2d.b2GrowableStack.prototype.m_count=0,box2d.b2GrowableStack.prototype.Reset=function(){return this.m_count=0,this},box2d.b2GrowableStack.prototype.Push=function(e){this.m_stack[this.m_count]=e,++this.m_count},box2d.b2GrowableStack.prototype.Pop=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_count>0),--this.m_count;var e=this.m_stack[this.m_count];return this.m_stack[this.m_count]=null,e},box2d.b2GrowableStack.prototype.GetCount=function(){return this.m_count},goog.provide("box2d.b2DynamicTree"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Collision"),goog.require("box2d.b2GrowableStack"),box2d.b2TreeNode=function(e){this.m_id=e||0,this.aabb=new box2d.b2AABB},box2d.b2TreeNode.prototype.m_id=0,box2d.b2TreeNode.prototype.aabb=null,box2d.b2TreeNode.prototype.userData=null,box2d.b2TreeNode.prototype.parent=null,box2d.b2TreeNode.prototype.child1=null,box2d.b2TreeNode.prototype.child2=null,box2d.b2TreeNode.prototype.height=0,box2d.b2TreeNode.prototype.IsLeaf=function(){return null===this.child1},box2d.b2DynamicTree=function(){},box2d.b2DynamicTree.prototype.m_root=null,box2d.b2DynamicTree.prototype.m_freeList=null,box2d.b2DynamicTree.prototype.m_path=0,box2d.b2DynamicTree.prototype.m_insertionCount=0,box2d.b2DynamicTree.s_stack=new box2d.b2GrowableStack(256),box2d.b2DynamicTree.s_r=new box2d.b2Vec2,box2d.b2DynamicTree.s_v=new box2d.b2Vec2,box2d.b2DynamicTree.s_abs_v=new box2d.b2Vec2,box2d.b2DynamicTree.s_segmentAABB=new box2d.b2AABB,box2d.b2DynamicTree.s_subInput=new box2d.b2RayCastInput,box2d.b2DynamicTree.s_combinedAABB=new box2d.b2AABB,box2d.b2DynamicTree.s_aabb=new box2d.b2AABB,box2d.b2DynamicTree.prototype.GetUserData=function(e){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==e),e.userData},box2d.b2DynamicTree.prototype.GetFatAABB=function(e){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==e),e.aabb},box2d.b2DynamicTree.prototype.Query=function(e,t){if(null!==this.m_root){var i=box2d.b2DynamicTree.s_stack.Reset();for(i.Push(this.m_root);i.GetCount()>0;){var s=i.Pop();if(null!==s&&s.aabb.TestOverlap(t))if(s.IsLeaf()){if(!1===e(s))return}else i.Push(s.child1),i.Push(s.child2)}}},box2d.b2DynamicTree.prototype.RayCast=function(e,t){if(null!==this.m_root){var i=t.p1,s=t.p2,a=box2d.b2SubVV(s,i,box2d.b2DynamicTree.s_r);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a.GetLengthSquared()>0),a.Normalize();var n=box2d.b2CrossOneV(a,box2d.b2DynamicTree.s_v),o=box2d.b2AbsV(n,box2d.b2DynamicTree.s_abs_v),r=t.maxFraction,l=box2d.b2DynamicTree.s_segmentAABB,h=i.x+r*(s.x-i.x),c=i.y+r*(s.y-i.y);l.lowerBound.x=box2d.b2Min(i.x,h),l.lowerBound.y=box2d.b2Min(i.y,c),l.upperBound.x=box2d.b2Max(i.x,h),l.upperBound.y=box2d.b2Max(i.y,c);var p=box2d.b2DynamicTree.s_stack.Reset();for(p.Push(this.m_root);p.GetCount()>0;){var d=p.Pop();if(null!==d&&!1!==box2d.b2TestOverlapAABB(d.aabb,l)){var u=d.aabb.GetCenter(),m=d.aabb.GetExtents();if(!(box2d.b2Abs(box2d.b2DotVV(n,box2d.b2SubVV(i,u,box2d.b2Vec2.s_t0)))-box2d.b2DotVV(o,m)>0))if(d.IsLeaf()){var g=box2d.b2DynamicTree.s_subInput;g.p1.Copy(t.p1),g.p2.Copy(t.p2),g.maxFraction=r;var y=e(g,d);if(0===y)return;y>0&&(r=y,h=i.x+r*(s.x-i.x),c=i.y+r*(s.y-i.y),l.lowerBound.x=box2d.b2Min(i.x,h),l.lowerBound.y=box2d.b2Min(i.y,c),l.upperBound.x=box2d.b2Max(i.x,h),l.upperBound.y=box2d.b2Max(i.y,c))}else p.Push(d.child1),p.Push(d.child2)}}}},box2d.b2DynamicTree.prototype.AllocateNode=function(){if(this.m_freeList){var e=this.m_freeList;return this.m_freeList=e.parent,e.parent=null,e.child1=null,e.child2=null,e.height=0,e.userData=null,e}return new box2d.b2TreeNode(box2d.b2DynamicTree.prototype.s_node_id++)},box2d.b2DynamicTree.prototype.s_node_id=0,box2d.b2DynamicTree.prototype.FreeNode=function(e){e.parent=this.m_freeList,e.height=-1,this.m_freeList=e},box2d.b2DynamicTree.prototype.CreateProxy=function(e,t){var i=this.AllocateNode(),s=box2d.b2_aabbExtension,a=box2d.b2_aabbExtension;return i.aabb.lowerBound.x=e.lowerBound.x-s,i.aabb.lowerBound.y=e.lowerBound.y-a,i.aabb.upperBound.x=e.upperBound.x+s,i.aabb.upperBound.y=e.upperBound.y+a,i.userData=t,i.height=0,this.InsertLeaf(i),i},box2d.b2DynamicTree.prototype.DestroyProxy=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.IsLeaf()),this.RemoveLeaf(e),this.FreeNode(e)},box2d.b2DynamicTree.prototype.MoveProxy=function(e,t,i){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.IsLeaf()),e.aabb.Contains(t))return!1;this.RemoveLeaf(e);var s=box2d.b2_aabbExtension+box2d.b2_aabbMultiplier*(i.x>0?i.x:-i.x),a=box2d.b2_aabbExtension+box2d.b2_aabbMultiplier*(i.y>0?i.y:-i.y);return e.aabb.lowerBound.x=t.lowerBound.x-s,e.aabb.lowerBound.y=t.lowerBound.y-a,e.aabb.upperBound.x=t.upperBound.x+s,e.aabb.upperBound.y=t.upperBound.y+a,this.InsertLeaf(e),!0},box2d.b2DynamicTree.prototype.InsertLeaf=function(e){if(++this.m_insertionCount,null===this.m_root)return this.m_root=e,void(this.m_root.parent=null);for(var t,i,s=e.aabb,a=(s.GetCenter(),this.m_root);!1===a.IsLeaf();){t=a.child1,i=a.child2;var n=a.aabb.GetPerimeter(),o=box2d.b2DynamicTree.s_combinedAABB;o.Combine2(a.aabb,s);var r,l,h,c=o.GetPerimeter(),p=2*c,d=2*(c-n),u=box2d.b2DynamicTree.s_aabb;t.IsLeaf()?(u.Combine2(s,t.aabb),r=u.GetPerimeter()+d):(u.Combine2(s,t.aabb),l=t.aabb.GetPerimeter(),h=u.GetPerimeter(),r=h-l+d);var m;if(i.IsLeaf()?(u.Combine2(s,i.aabb),m=u.GetPerimeter()+d):(u.Combine2(s,i.aabb),l=i.aabb.GetPerimeter(),h=u.GetPerimeter(),m=h-l+d),r>p&&m>p)break;a=m>r?t:i}var g=a,y=g.parent,b=this.AllocateNode();for(b.parent=y,b.userData=null,b.aabb.Combine2(s,g.aabb),b.height=g.height+1,y?(y.child1===g?y.child1=b:y.child2=b,b.child1=g,b.child2=e,g.parent=b,e.parent=b):(b.child1=g,b.child2=e,g.parent=b,e.parent=b,this.m_root=b),a=e.parent;null!==a;)a=this.Balance(a),t=a.child1,i=a.child2,box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==t),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==i),a.height=1+box2d.b2Max(t.height,i.height),a.aabb.Combine2(t.aabb,i.aabb),a=a.parent},box2d.b2DynamicTree.prototype.RemoveLeaf=function(e){if(e!==this.m_root){var t,i=e.parent,s=i.parent;if(t=i.child1===e?i.child2:i.child1,s){s.child1===i?s.child1=t:s.child2=t,t.parent=s,this.FreeNode(i);for(var a=s;a;){var n=(a=this.Balance(a)).child1,o=a.child2;a.aabb.Combine2(n.aabb,o.aabb),a.height=1+box2d.b2Max(n.height,o.height),a=a.parent}}else this.m_root=t,t.parent=null,this.FreeNode(i)}else this.m_root=null},box2d.b2DynamicTree.prototype.Balance=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(null!==e),e.IsLeaf()||e.height<2)return e;var t=e.child1,i=e.child2,s=i.height-t.height;if(s>1){var a=i.child1,n=i.child2;return i.child1=e,i.parent=e.parent,e.parent=i,null!==i.parent?i.parent.child1===e?i.parent.child1=i:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(i.parent.child2===e),i.parent.child2=i):this.m_root=i,a.height>n.height?(i.child2=a,e.child2=n,n.parent=e,e.aabb.Combine2(t.aabb,n.aabb),i.aabb.Combine2(e.aabb,a.aabb),e.height=1+box2d.b2Max(t.height,n.height),i.height=1+box2d.b2Max(e.height,a.height)):(i.child2=n,e.child2=a,a.parent=e,e.aabb.Combine2(t.aabb,a.aabb),i.aabb.Combine2(e.aabb,n.aabb),e.height=1+box2d.b2Max(t.height,a.height),i.height=1+box2d.b2Max(e.height,n.height)),i}if(-1>s){var o=t.child1,r=t.child2;return t.child1=e,t.parent=e.parent,e.parent=t,null!==t.parent?t.parent.child1===e?t.parent.child1=t:(box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.parent.child2===e),t.parent.child2=t):this.m_root=t,o.height>r.height?(t.child2=o,e.child1=r,r.parent=e,e.aabb.Combine2(i.aabb,r.aabb),t.aabb.Combine2(e.aabb,o.aabb),e.height=1+box2d.b2Max(i.height,r.height),t.height=1+box2d.b2Max(e.height,o.height)):(t.child2=r,e.child1=o,o.parent=e,e.aabb.Combine2(i.aabb,o.aabb),t.aabb.Combine2(e.aabb,r.aabb),e.height=1+box2d.b2Max(i.height,o.height),t.height=1+box2d.b2Max(e.height,r.height)),t}return e},box2d.b2DynamicTree.prototype.GetHeight=function(){return null===this.m_root?0:this.m_root.height},box2d.b2DynamicTree.prototype.GetAreaRatio=function(){if(null===this.m_root)return 0;var e=this.m_root.aabb.GetPerimeter(),t=function(e){if(null===e)return 0;if(e.IsLeaf())return 0;var i=e.aabb.GetPerimeter();return i+=t(e.child1),i+=t(e.child2)};return t(this.m_root)/e},box2d.b2DynamicTree.prototype.ComputeHeightNode=function(e){if(e.IsLeaf())return 0;var t=this.ComputeHeightNode(e.child1),i=this.ComputeHeightNode(e.child2);return 1+box2d.b2Max(t,i)},box2d.b2DynamicTree.prototype.ComputeHeight=function(){return this.ComputeHeightNode(this.m_root)},box2d.b2DynamicTree.prototype.ValidateStructure=function(e){if(null!==e){e===this.m_root&&box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===e.parent);var t=e,i=t.child1,s=t.child2;if(t.IsLeaf())return box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===i),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===s),void(box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===t.height));box2d.ENABLE_ASSERTS&&box2d.b2Assert(i.parent===e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(s.parent===e),this.ValidateStructure(i),this.ValidateStructure(s)}},box2d.b2DynamicTree.prototype.ValidateMetrics=function(e){if(null!==e){var t=e,i=t.child1,s=t.child2;if(t.IsLeaf())return box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===i),box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===s),void(box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===t.height));var a,n=i.height,o=s.height;a=1+box2d.b2Max(n,o),box2d.ENABLE_ASSERTS&&box2d.b2Assert(t.height===a);var r=box2d.b2DynamicTree.s_aabb;r.Combine2(i.aabb,s.aabb),box2d.ENABLE_ASSERTS&&box2d.b2Assert(r.lowerBound===t.aabb.lowerBound),box2d.ENABLE_ASSERTS&&box2d.b2Assert(r.upperBound===t.aabb.upperBound),this.ValidateMetrics(i),this.ValidateMetrics(s)}},box2d.b2DynamicTree.prototype.Validate=function(){this.ValidateStructure(this.m_root),this.ValidateMetrics(this.m_root);for(var e=0,t=this.m_freeList;null!==t;)t=t.parent,++e;box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.GetHeight()===this.ComputeHeight())},box2d.b2DynamicTree.prototype.GetMaxBalance=function(){return function(e,t){if(null===e)return t;if(e.height<=1)return t;box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===e.IsLeaf());var i=e.child1,s=e.child2,a=box2d.b2Abs(s.height-i.height);return box2d.b2Max(t,a)}(this.m_root,0)},box2d.b2DynamicTree.prototype.RebuildBottomUp=function(){this.Validate()},box2d.b2DynamicTree.prototype.ShiftOrigin=function(e){var t=function(e,i){if(null!==e&&!(e.height<=1)){box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===e.IsLeaf());var s=e.child1,a=e.child2;t(s,i),t(a,i),e.aabb.lowerBound.SelfSub(i),e.aabb.upperBound.SelfSub(i)}};t(this.m_root,e)},goog.provide("box2d.b2BroadPhase"),goog.require("box2d.b2Settings"),goog.require("box2d.b2DynamicTree"),box2d.b2Pair=function(){},box2d.b2Pair.prototype.proxyA=null,box2d.b2Pair.prototype.proxyB=null,box2d.b2BroadPhase=function(){this.m_tree=new box2d.b2DynamicTree,this.m_moveBuffer=new Array,this.m_pairBuffer=new Array},box2d.b2BroadPhase.prototype.m_tree=null,box2d.b2BroadPhase.prototype.m_proxyCount=0,box2d.b2BroadPhase.prototype.m_moveCount=0,box2d.b2BroadPhase.prototype.m_moveBuffer=null,box2d.b2BroadPhase.prototype.m_pairCount=0,box2d.b2BroadPhase.prototype.m_pairBuffer=null,box2d.b2BroadPhase.prototype.CreateProxy=function(e,t){var i=this.m_tree.CreateProxy(e,t);return++this.m_proxyCount,this.BufferMove(i),i},box2d.b2BroadPhase.prototype.DestroyProxy=function(e){this.UnBufferMove(e),--this.m_proxyCount,this.m_tree.DestroyProxy(e)},box2d.b2BroadPhase.prototype.MoveProxy=function(e,t,i){this.m_tree.MoveProxy(e,t,i)&&this.BufferMove(e)},box2d.b2BroadPhase.prototype.TouchProxy=function(e){this.BufferMove(e)},box2d.b2BroadPhase.prototype.GetFatAABB=function(e){return this.m_tree.GetFatAABB(e)},box2d.b2BroadPhase.prototype.GetUserData=function(e){return this.m_tree.GetUserData(e)},box2d.b2BroadPhase.prototype.TestOverlap=function(e,t){var i=this.m_tree.GetFatAABB(e),s=this.m_tree.GetFatAABB(t);return box2d.b2TestOverlapAABB(i,s)},box2d.b2BroadPhase.prototype.GetProxyCount=function(){return this.m_proxyCount},box2d.b2BroadPhase.prototype.GetTreeHeight=function(){return this.m_tree.GetHeight()},box2d.b2BroadPhase.prototype.GetTreeBalance=function(){return this.m_tree.GetMaxBalance()},box2d.b2BroadPhase.prototype.GetTreeQuality=function(){return this.m_tree.GetAreaRatio()},box2d.b2BroadPhase.prototype.ShiftOrigin=function(e){this.m_tree.ShiftOrigin(e)},box2d.b2BroadPhase.prototype.UpdatePairs=function(e){this.m_pairCount=0;for(a=0;a<this.m_moveCount;++a){var t=this.m_moveBuffer[a];if(null!==t){var i=this,s=this.m_tree.GetFatAABB(t);this.m_tree.Query(function(e){if(e.m_id===t.m_id)return!0;i.m_pairCount===i.m_pairBuffer.length&&(i.m_pairBuffer[i.m_pairCount]=new box2d.b2Pair);var s=i.m_pairBuffer[i.m_pairCount];return e.m_id<t.m_id?(s.proxyA=e,s.proxyB=t):(s.proxyA=t,s.proxyB=e),++i.m_pairCount,!0},s)}}this.m_moveCount=0,this.m_pairBuffer.length=this.m_pairCount,this.m_pairBuffer.sort(box2d.b2PairLessThan);for(var a=0;a<this.m_pairCount;){var n=this.m_pairBuffer[a],o=this.m_tree.GetUserData(n.proxyA),r=this.m_tree.GetUserData(n.proxyB);for(e.AddPair(o,r),++a;a<this.m_pairCount;){var l=this.m_pairBuffer[a];if(l.proxyA.m_id!==n.proxyA.m_id||l.proxyB.m_id!==n.proxyB.m_id)break;++a}}},box2d.b2BroadPhase.prototype.Query=function(e,t){this.m_tree.Query(e,t)},box2d.b2BroadPhase.prototype.RayCast=function(e,t){this.m_tree.RayCast(e,t)},box2d.b2BroadPhase.prototype.BufferMove=function(e){this.m_moveBuffer[this.m_moveCount]=e,++this.m_moveCount},box2d.b2BroadPhase.prototype.UnBufferMove=function(e){var t=this.m_moveBuffer.indexOf(e);this.m_moveBuffer[t]=null},box2d.b2PairLessThan=function(e,t){return e.proxyA.m_id===t.proxyA.m_id?e.proxyB.m_id-t.proxyB.m_id:e.proxyA.m_id-t.proxyA.m_id},goog.provide("box2d.b2ContactManager"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Math"),goog.require("box2d.b2Collision"),goog.require("box2d.b2BroadPhase"),goog.require("box2d.b2ContactFactory"),box2d.b2ContactManager=function(){this.m_broadPhase=new box2d.b2BroadPhase,this.m_contactFactory=new box2d.b2ContactFactory(this.m_allocator)},box2d.b2ContactManager.prototype.m_broadPhase=null,box2d.b2ContactManager.prototype.m_contactList=null,box2d.b2ContactManager.prototype.m_contactCount=0,box2d.b2ContactManager.prototype.m_contactFilter=box2d.b2ContactFilter.b2_defaultFilter,box2d.b2ContactManager.prototype.m_contactListener=box2d.b2ContactListener.b2_defaultListener,box2d.b2ContactManager.prototype.m_allocator=null,box2d.b2ContactManager.prototype.m_contactFactory=null,box2d.b2ContactManager.prototype.Destroy=function(e){var t=e.GetFixtureA(),i=e.GetFixtureB(),s=t.GetBody(),a=i.GetBody();this.m_contactListener&&e.IsTouching()&&this.m_contactListener.EndContact(e),e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_contactList&&(this.m_contactList=e.m_next),e.m_nodeA.prev&&(e.m_nodeA.prev.next=e.m_nodeA.next),e.m_nodeA.next&&(e.m_nodeA.next.prev=e.m_nodeA.prev),e.m_nodeA===s.m_contactList&&(s.m_contactList=e.m_nodeA.next),e.m_nodeB.prev&&(e.m_nodeB.prev.next=e.m_nodeB.next),e.m_nodeB.next&&(e.m_nodeB.next.prev=e.m_nodeB.prev),e.m_nodeB===a.m_contactList&&(a.m_contactList=e.m_nodeB.next),this.m_contactFactory.Destroy(e),--this.m_contactCount},box2d.b2ContactManager.prototype.Collide=function(){for(var e=this.m_contactList;e;){var t=e.GetFixtureA(),i=e.GetFixtureB(),s=e.GetChildIndexA(),a=e.GetChildIndexB(),n=t.GetBody(),o=i.GetBody();if(e.m_flags&box2d.b2ContactFlag.e_filterFlag){if(!1===o.ShouldCollide(n)){var r=e;e=r.m_next,this.Destroy(r);continue}if(this.m_contactFilter&&!1===this.m_contactFilter.ShouldCollide(t,i)){e=(r=e).m_next,this.Destroy(r);continue}e.m_flags&=~box2d.b2ContactFlag.e_filterFlag}var l=n.IsAwake()&&n.m_type!==box2d.b2BodyType.b2_staticBody,h=o.IsAwake()&&o.m_type!==box2d.b2BodyType.b2_staticBody;if(!1!==l||!1!==h){var c=t.m_proxies[s].proxy,p=i.m_proxies[a].proxy;!1!==this.m_broadPhase.TestOverlap(c,p)?(e.Update(this.m_contactListener),e=e.m_next):(r=e,e=r.m_next,this.Destroy(r))}else e=e.m_next}},box2d.b2ContactManager.prototype.FindNewContacts=function(){this.m_broadPhase.UpdatePairs(this)},box2d.b2ContactManager.prototype.AddPair=function(e,t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2FixtureProxy),box2d.ENABLE_ASSERTS&&box2d.b2Assert(t instanceof box2d.b2FixtureProxy);var i=e,s=t,a=i.fixture,n=s.fixture,o=i.childIndex,r=s.childIndex,l=a.GetBody(),h=n.GetBody();if(l!==h){for(var c=h.GetContactList();c;){if(c.other===l){var p=c.contact.GetFixtureA(),d=c.contact.GetFixtureB(),u=c.contact.GetChildIndexA(),m=c.contact.GetChildIndexB();if(p===a&&d===n&&u===o&&m===r)return;if(p===n&&d===a&&u===r&&m===o)return}c=c.next}if(!1!==h.ShouldCollide(l)&&(!this.m_contactFilter||!1!==this.m_contactFilter.ShouldCollide(a,n))){var g=this.m_contactFactory.Create(a,o,n,r);null!==g&&(a=g.GetFixtureA(),n=g.GetFixtureB(),o=g.GetChildIndexA(),r=g.GetChildIndexB(),l=a.m_body,h=n.m_body,g.m_prev=null,g.m_next=this.m_contactList,null!==this.m_contactList&&(this.m_contactList.m_prev=g),this.m_contactList=g,g.m_nodeA.contact=g,g.m_nodeA.other=h,g.m_nodeA.prev=null,g.m_nodeA.next=l.m_contactList,null!==l.m_contactList&&(l.m_contactList.prev=g.m_nodeA),l.m_contactList=g.m_nodeA,g.m_nodeB.contact=g,g.m_nodeB.other=l,g.m_nodeB.prev=null,g.m_nodeB.next=h.m_contactList,null!==h.m_contactList&&(h.m_contactList.prev=g.m_nodeB),h.m_contactList=g.m_nodeB,!1===a.IsSensor()&&!1===n.IsSensor()&&(l.SetAwake(!0),h.SetAwake(!0)),++this.m_contactCount)}}},goog.provide("box2d.b2JointFactory"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Math"),goog.require("box2d.b2Joint"),box2d.b2JointFactory.Create=function(e){var t=null;switch(e.type){case box2d.b2JointType.e_distanceJoint:t=new box2d.b2DistanceJoint(e instanceof box2d.b2DistanceJointDef?e:null);break;case box2d.b2JointType.e_mouseJoint:t=new box2d.b2MouseJoint(e instanceof box2d.b2MouseJointDef?e:null);break;case box2d.b2JointType.e_prismaticJoint:t=new box2d.b2PrismaticJoint(e instanceof box2d.b2PrismaticJointDef?e:null);break;case box2d.b2JointType.e_revoluteJoint:t=new box2d.b2RevoluteJoint(e instanceof box2d.b2RevoluteJointDef?e:null);break;case box2d.b2JointType.e_pulleyJoint:t=new box2d.b2PulleyJoint(e instanceof box2d.b2PulleyJointDef?e:null);break;case box2d.b2JointType.e_gearJoint:t=new box2d.b2GearJoint(e instanceof box2d.b2GearJointDef?e:null);break;case box2d.b2JointType.e_wheelJoint:t=new box2d.b2WheelJoint(e instanceof box2d.b2WheelJointDef?e:null);break;case box2d.b2JointType.e_weldJoint:t=new box2d.b2WeldJoint(e instanceof box2d.b2WeldJointDef?e:null);break;case box2d.b2JointType.e_frictionJoint:t=new box2d.b2FrictionJoint(e instanceof box2d.b2FrictionJointDef?e:null);break;case box2d.b2JointType.e_ropeJoint:t=new box2d.b2RopeJoint(e instanceof box2d.b2RopeJointDef?e:null);break;case box2d.b2JointType.e_motorJoint:t=new box2d.b2MotorJoint(e instanceof box2d.b2MotorJointDef?e:null);break;case box2d.b2JointType.e_areaJoint:t=new box2d.b2AreaJoint(e instanceof box2d.b2AreaJointDef?e:null);break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}return t},box2d.b2JointFactory.Destroy=function(){},goog.provide("box2d.b2Draw"),goog.require("box2d.b2Settings"),box2d.b2Color=function(e,t,i){this.r=e,this.g=t,this.b=i},box2d.b2Color.prototype.r=.5,box2d.b2Color.prototype.g=.5,box2d.b2Color.prototype.b=.5,box2d.b2Color.prototype.SetRGB=function(e,t,i){return this.r=e,this.g=t,this.b=i,this},box2d.b2Color.prototype.MakeStyleString=function(e){var t=Math.round(Math.max(0,Math.min(255,255*this.r))),i=Math.round(Math.max(0,Math.min(255,255*this.g))),s=Math.round(Math.max(0,Math.min(255,255*this.b))),a=void 0===e?1:Math.max(0,Math.min(1,e));return box2d.b2Color.MakeStyleString(t,i,s,a)},box2d.b2Color.MakeStyleString=function(e,t,i,s){return 1>s?"rgba("+e+","+t+","+i+","+s+")":"rgb("+e+","+t+","+i+")"},box2d.b2Color.RED=new box2d.b2Color(1,0,0),box2d.b2Color.GREEN=new box2d.b2Color(0,1,0),box2d.b2Color.BLUE=new box2d.b2Color(0,0,1),box2d.b2DrawFlags={e_none:0,e_shapeBit:1,e_jointBit:2,e_aabbBit:4,e_pairBit:8,e_centerOfMassBit:16,e_controllerBit:32,e_all:63},goog.exportProperty(box2d.b2DrawFlags,"e_none",box2d.b2DrawFlags.e_none),goog.exportProperty(box2d.b2DrawFlags,"e_shapeBit",box2d.b2DrawFlags.e_shapeBit),goog.exportProperty(box2d.b2DrawFlags,"e_jointBit",box2d.b2DrawFlags.e_jointBit),goog.exportProperty(box2d.b2DrawFlags,"e_aabbBit",box2d.b2DrawFlags.e_aabbBit),goog.exportProperty(box2d.b2DrawFlags,"e_pairBit",box2d.b2DrawFlags.e_pairBit),goog.exportProperty(box2d.b2DrawFlags,"e_centerOfMassBit",box2d.b2DrawFlags.e_centerOfMassBit),goog.exportProperty(box2d.b2DrawFlags,"e_controllerBit",box2d.b2DrawFlags.e_controllerBit),goog.exportProperty(box2d.b2DrawFlags,"e_all",box2d.b2DrawFlags.e_all),box2d.b2Draw=function(){},box2d.b2Draw.prototype.m_drawFlags=box2d.b2DrawFlags.e_none,box2d.b2Draw.prototype.SetFlags=function(e){this.m_drawFlags=e},box2d.b2Draw.prototype.GetFlags=function(){return this.m_drawFlags},box2d.b2Draw.prototype.AppendFlags=function(e){this.m_drawFlags|=e},box2d.b2Draw.prototype.ClearFlags=function(e){this.m_drawFlags&=~e},box2d.b2Draw.prototype.PushTransform=function(){},box2d.b2Draw.prototype.PopTransform=function(){},box2d.b2Draw.prototype.DrawPolygon=function(){},box2d.b2Draw.prototype.DrawSolidPolygon=function(){},box2d.b2Draw.prototype.DrawCircle=function(){},box2d.b2Draw.prototype.DrawSolidCircle=function(){},box2d.b2Draw.prototype.DrawSegment=function(){},box2d.b2Draw.prototype.DrawTransform=function(){},goog.provide("box2d.b2Fixture"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Collision"),goog.require("box2d.b2Shape"),box2d.b2Filter=function(){},box2d.b2Filter.prototype.categoryBits=1,box2d.b2Filter.prototype.maskBits=65535,box2d.b2Filter.prototype.groupIndex=0,box2d.b2Filter.prototype.Clone=function(){return(new box2d.b2Filter).Copy(this)},box2d.b2Filter.prototype.Copy=function(e){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(this!==e),this.categoryBits=e.categoryBits,this.maskBits=e.maskBits,this.groupIndex=e.groupIndex,this},box2d.b2FixtureDef=function(){this.filter=new box2d.b2Filter},box2d.b2FixtureDef.prototype.shape=null,box2d.b2FixtureDef.prototype.userData=null,box2d.b2FixtureDef.prototype.friction=.2,box2d.b2FixtureDef.prototype.restitution=0,box2d.b2FixtureDef.prototype.density=0,box2d.b2FixtureDef.prototype.isSensor=!1,box2d.b2FixtureDef.prototype.filter=null,box2d.b2FixtureProxy=function(){this.aabb=new box2d.b2AABB},box2d.b2FixtureProxy.prototype.aabb=null,box2d.b2FixtureProxy.prototype.fixture=null,box2d.b2FixtureProxy.prototype.childIndex=0,box2d.b2FixtureProxy.prototype.proxy=null,box2d.b2FixtureProxy.MakeArray=function(e){return box2d.b2MakeArray(e,function(){return new box2d.b2FixtureProxy})},box2d.b2Fixture=function(){this.m_proxyCount=0,this.m_filter=new box2d.b2Filter},box2d.b2Fixture.prototype.m_density=0,box2d.b2Fixture.prototype.m_next=null,box2d.b2Fixture.prototype.m_body=null,box2d.b2Fixture.prototype.m_shape=null,box2d.b2Fixture.prototype.m_friction=0,box2d.b2Fixture.prototype.m_restitution=0,box2d.b2Fixture.prototype.m_proxies=null,box2d.b2Fixture.prototype.m_proxyCount=0,box2d.b2Fixture.prototype.m_filter=null,box2d.b2Fixture.prototype.m_isSensor=!1,box2d.b2Fixture.prototype.m_userData=null,box2d.b2Fixture.prototype.GetType=function(){return this.m_shape.GetType()},box2d.b2Fixture.prototype.GetShape=function(){return this.m_shape},box2d.b2Fixture.prototype.IsSensor=function(){return this.m_isSensor},box2d.b2Fixture.prototype.GetFilterData=function(){return this.m_filter},box2d.b2Fixture.prototype.GetUserData=function(){return this.m_userData},box2d.b2Fixture.prototype.SetUserData=function(e){this.m_userData=e},box2d.b2Fixture.prototype.GetBody=function(){return this.m_body},box2d.b2Fixture.prototype.GetNext=function(){return this.m_next},box2d.b2Fixture.prototype.SetDensity=function(e){this.m_density=e},box2d.b2Fixture.prototype.GetDensity=function(){return this.m_density},box2d.b2Fixture.prototype.GetFriction=function(){return this.m_friction},box2d.b2Fixture.prototype.SetFriction=function(e){this.m_friction=e},box2d.b2Fixture.prototype.GetRestitution=function(){return this.m_restitution},box2d.b2Fixture.prototype.SetRestitution=function(e){this.m_restitution=e},box2d.b2Fixture.prototype.TestPoint=function(e){return this.m_shape.TestPoint(this.m_body.GetTransform(),e)},box2d.b2Fixture.prototype.RayCast=function(e,t,i){return this.m_shape.RayCast(e,t,this.m_body.GetTransform(),i)},box2d.b2Fixture.prototype.GetMassData=function(e){return e=e||new box2d.b2MassData,this.m_shape.ComputeMass(e,this.m_density),e},box2d.b2Fixture.prototype.GetAABB=function(e){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(e>=0&&e<this.m_proxyCount),this.m_proxies[e].aabb},box2d.b2Fixture.prototype.Create=function(e,t){this.m_userData=t.userData,this.m_friction=t.friction,this.m_restitution=t.restitution,this.m_body=e,this.m_next=null,this.m_filter.Copy(t.filter),this.m_isSensor=t.isSensor,this.m_shape=t.shape.Clone(),this.m_proxies=box2d.b2FixtureProxy.MakeArray(this.m_shape.GetChildCount()),this.m_proxyCount=0,this.m_density=t.density},box2d.b2Fixture.prototype.Destroy=function(){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===this.m_proxyCount),this.m_shape=null},box2d.b2Fixture.prototype.CreateProxies=function(e,t){box2d.ENABLE_ASSERTS&&box2d.b2Assert(0===this.m_proxyCount),this.m_proxyCount=this.m_shape.GetChildCount();for(var i=0;i<this.m_proxyCount;++i){var s=this.m_proxies[i];this.m_shape.ComputeAABB(s.aabb,t,i),s.proxy=e.CreateProxy(s.aabb,s),s.fixture=this,s.childIndex=i}},box2d.b2Fixture.prototype.DestroyProxies=function(e){for(var t=0;t<this.m_proxyCount;++t){var i=this.m_proxies[t];e.DestroyProxy(i.proxy),i.proxy=null}this.m_proxyCount=0},box2d.b2Fixture.prototype.Synchronize=function(e,t,i){if(0!==this.m_proxyCount)for(var s=0;s<this.m_proxyCount;++s){var a=this.m_proxies[s],n=box2d.b2Fixture.prototype.Synchronize.s_aabb1,o=box2d.b2Fixture.prototype.Synchronize.s_aabb2;this.m_shape.ComputeAABB(n,t,s),this.m_shape.ComputeAABB(o,i,s),a.aabb.Combine2(n,o);var r=box2d.b2SubVV(i.p,t.p,box2d.b2Fixture.prototype.Synchronize.s_displacement);e.MoveProxy(a.proxy,a.aabb,r)}},box2d.b2Fixture.prototype.Synchronize.s_aabb1=new box2d.b2AABB,box2d.b2Fixture.prototype.Synchronize.s_aabb2=new box2d.b2AABB,box2d.b2Fixture.prototype.Synchronize.s_displacement=new box2d.b2Vec2,box2d.b2Fixture.prototype.SetFilterData=function(e){this.m_filter.Copy(e),this.Refilter()},box2d.b2Fixture.prototype.Refilter=function(){if(!this.m_body){for(var e=this.m_body.GetContactList();e;){var t=e.contact,i=t.GetFixtureA(),s=t.GetFixtureB();(i===this||s===this)&&t.FlagForFiltering(),e=e.next}var a=this.m_body.GetWorld();if(null!==a)for(var n=a.m_contactManager.m_broadPhase,o=0;o<this.m_proxyCount;++o)n.TouchProxy(this.m_proxies[o].proxy)}},box2d.b2Fixture.prototype.SetSensor=function(e){e!==this.m_isSensor&&(this.m_body.SetAwake(!0),this.m_isSensor=e)},box2d.b2Fixture.prototype.Dump=function(e){box2d.DEBUG&&(box2d.b2Log("    /*box2d.b2FixtureDef*/ var fd = new box2d.b2FixtureDef();\n"),box2d.b2Log("    fd.friction = %.15f;\n",this.m_friction),box2d.b2Log("    fd.restitution = %.15f;\n",this.m_restitution),box2d.b2Log("    fd.density = %.15f;\n",this.m_density),box2d.b2Log("    fd.isSensor = %s;\n",this.m_isSensor?"true":"false"),box2d.b2Log("    fd.filter.categoryBits = %d;\n",this.m_filter.categoryBits),box2d.b2Log("    fd.filter.maskBits = %d;\n",this.m_filter.maskBits),box2d.b2Log("    fd.filter.groupIndex = %d;\n",this.m_filter.groupIndex),this.m_shape.Dump(),box2d.b2Log("\n"),box2d.b2Log("    fd.shape = shape;\n"),box2d.b2Log("\n"),box2d.b2Log("    bodies[%d].CreateFixture(fd);\n",e))},goog.provide("box2d.b2Body"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Math"),goog.require("box2d.b2Fixture"),box2d.b2BodyType={b2_unknown:-1,b2_staticBody:0,b2_kinematicBody:1,b2_dynamicBody:2,b2_bulletBody:3},goog.exportProperty(box2d.b2BodyType,"b2_unknown",box2d.b2BodyType.b2_unknown),goog.exportProperty(box2d.b2BodyType,"b2_staticBody",box2d.b2BodyType.b2_staticBody),goog.exportProperty(box2d.b2BodyType,"b2_kinematicBody",box2d.b2BodyType.b2_kinematicBody),goog.exportProperty(box2d.b2BodyType,"b2_dynamicBody",box2d.b2BodyType.b2_dynamicBody),goog.exportProperty(box2d.b2BodyType,"b2_bulletBody",box2d.b2BodyType.b2_bulletBody),box2d.b2BodyDef=function(){this.position=new box2d.b2Vec2(0,0),this.linearVelocity=new box2d.b2Vec2(0,0)},box2d.b2BodyDef.prototype.type=box2d.b2BodyType.b2_staticBody,box2d.b2BodyDef.prototype.position=null,box2d.b2BodyDef.prototype.angle=0,box2d.b2BodyDef.prototype.linearVelocity=null,box2d.b2BodyDef.prototype.angularVelocity=0,box2d.b2BodyDef.prototype.linearDamping=0,box2d.b2BodyDef.prototype.angularDamping=0,box2d.b2BodyDef.prototype.allowSleep=!0,box2d.b2BodyDef.prototype.awake=!0,box2d.b2BodyDef.prototype.fixedRotation=!1,box2d.b2BodyDef.prototype.bullet=!1,box2d.b2BodyDef.prototype.active=!0,box2d.b2BodyDef.prototype.userData=null,box2d.b2BodyDef.prototype.gravityScale=1,box2d.b2BodyFlag={e_none:0,e_islandFlag:1,e_awakeFlag:2,e_autoSleepFlag:4,e_bulletFlag:8,e_fixedRotationFlag:16,e_activeFlag:32,e_toiFlag:64},goog.exportProperty(box2d.b2BodyFlag,"e_none",box2d.b2BodyFlag.e_none),goog.exportProperty(box2d.b2BodyFlag,"e_islandFlag",box2d.b2BodyFlag.e_islandFlag),goog.exportProperty(box2d.b2BodyFlag,"e_awakeFlag",box2d.b2BodyFlag.e_awakeFlag),goog.exportProperty(box2d.b2BodyFlag,"e_autoSleepFlag",box2d.b2BodyFlag.e_autoSleepFlag),goog.exportProperty(box2d.b2BodyFlag,"e_bulletFlag",box2d.b2BodyFlag.e_bulletFlag),goog.exportProperty(box2d.b2BodyFlag,"e_fixedRotationFlag",box2d.b2BodyFlag.e_fixedRotationFlag),goog.exportProperty(box2d.b2BodyFlag,"e_activeFlag",box2d.b2BodyFlag.e_activeFlag),goog.exportProperty(box2d.b2BodyFlag,"e_toiFlag",box2d.b2BodyFlag.e_toiFlag),box2d.b2Body=function(e,t){this.m_xf=new box2d.b2Transform,this.m_out_xf=new box2d.b2Transform,this.m_sweep=new box2d.b2Sweep,this.m_out_sweep=new box2d.b2Sweep,this.m_linearVelocity=new box2d.b2Vec2,this.m_out_linearVelocity=new box2d.b2Vec2,this.m_force=new box2d.b2Vec2,box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.position.IsValid()),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.linearVelocity.IsValid()),box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.angle)),box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.angularVelocity)),box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.gravityScale)&&e.gravityScale>=0),box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.angularDamping)&&e.angularDamping>=0),box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.linearDamping)&&e.linearDamping>=0),this.m_flags=box2d.b2BodyFlag.e_none,e.bullet&&(this.m_flags|=box2d.b2BodyFlag.e_bulletFlag),e.fixedRotation&&(this.m_flags|=box2d.b2BodyFlag.e_fixedRotationFlag),e.allowSleep&&(this.m_flags|=box2d.b2BodyFlag.e_autoSleepFlag),e.awake&&(this.m_flags|=box2d.b2BodyFlag.e_awakeFlag),e.active&&(this.m_flags|=box2d.b2BodyFlag.e_activeFlag),this.m_world=t,this.m_xf.p.Copy(e.position),this.m_xf.q.SetAngleRadians(e.angle),this.m_sweep.localCenter.SetZero(),this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),this.m_sweep.a0=e.angle,this.m_sweep.a=e.angle,this.m_sweep.alpha0=0,this.m_linearVelocity.Copy(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_gravityScale=e.gravityScale,this.m_force.SetZero(),this.m_torque=0,this.m_sleepTime=0,this.m_type=e.type,e.type===box2d.b2BodyType.b2_dynamicBody?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_userData=e.userData,this.m_fixtureList=null,this.m_fixtureCount=0,this.m_controllerList=null,this.m_controllerCount=0},box2d.b2Body.prototype.m_flags=box2d.b2BodyFlag.e_none,box2d.b2Body.prototype.m_islandIndex=0,box2d.b2Body.prototype.m_world=null,box2d.b2Body.prototype.m_xf=null,box2d.b2Body.prototype.m_out_xf=null,box2d.b2Body.prototype.m_sweep=null,box2d.b2Body.prototype.m_out_sweep=null,box2d.b2Body.prototype.m_jointList=null,box2d.b2Body.prototype.m_contactList=null,box2d.b2Body.prototype.m_prev=null,box2d.b2Body.prototype.m_next=null,box2d.b2Body.prototype.m_linearVelocity=null,box2d.b2Body.prototype.m_out_linearVelocity=null,box2d.b2Body.prototype.m_angularVelocity=0,box2d.b2Body.prototype.m_linearDamping=0,box2d.b2Body.prototype.m_angularDamping=0,box2d.b2Body.prototype.m_gravityScale=1,box2d.b2Body.prototype.m_force=null,box2d.b2Body.prototype.m_torque=0,box2d.b2Body.prototype.m_sleepTime=0,box2d.b2Body.prototype.m_type=box2d.b2BodyType.b2_staticBody,box2d.b2Body.prototype.m_mass=1,box2d.b2Body.prototype.m_invMass=1,box2d.b2Body.prototype.m_I=0,box2d.b2Body.prototype.m_invI=0,box2d.b2Body.prototype.m_userData=null,box2d.b2Body.prototype.m_fixtureList=null,box2d.b2Body.prototype.m_fixtureCount=0,box2d.b2Body.prototype.m_controllerList=null,box2d.b2Body.prototype.m_controllerCount=0,box2d.b2Body.prototype.CreateFixture=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked()),!0===this.m_world.IsLocked())return null;var t=new box2d.b2Fixture;if(t.Create(this,e),this.m_flags&box2d.b2BodyFlag.e_activeFlag){var i=this.m_world.m_contactManager.m_broadPhase;t.CreateProxies(i,this.m_xf)}return t.m_next=this.m_fixtureList,this.m_fixtureList=t,++this.m_fixtureCount,t.m_body=this,t.m_density>0&&this.ResetMassData(),this.m_world.m_flags|=box2d.b2WorldFlag.e_newFixture,t},box2d.b2Body.prototype.CreateFixture2=function(e,t){void 0===t&&(t=0);var i=box2d.b2Body.prototype.CreateFixture2.s_def;return i.shape=e,i.density=t,this.CreateFixture(i)},box2d.b2Body.prototype.CreateFixture2.s_def=new box2d.b2FixtureDef,box2d.b2Body.prototype.DestroyFixture=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked()),!0!==this.m_world.IsLocked()){box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.m_body===this),box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_fixtureCount>0);for(var t=this.m_fixtureList,i=null,s=!1;null!==t;){if(t===e){i?i.m_next=e.m_next:this.m_fixtureList=e.m_next,s=!0;break}i=t,t=t.m_next}box2d.ENABLE_ASSERTS&&box2d.b2Assert(s);for(var a=this.m_contactList;a;){var n=a.contact;a=a.next;var o=n.GetFixtureA(),r=n.GetFixtureB();(e===o||e===r)&&this.m_world.m_contactManager.Destroy(n)}if(this.m_flags&box2d.b2BodyFlag.e_activeFlag){var l=this.m_world.m_contactManager.m_broadPhase;e.DestroyProxies(l)}e.Destroy(),e.m_body=null,e.m_next=null,--this.m_fixtureCount,this.ResetMassData()}},box2d.b2Body.prototype.SetTransformVecRadians=function(e,t){this.SetTransformXYRadians(e.x,e.y,t)},box2d.b2Body.prototype.SetTransformXYRadians=function(e,t,i){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked()),!0!==this.m_world.IsLocked()&&(this.m_xf.p.x!==e||this.m_xf.p.y!==t||this.m_xf.q.GetAngleRadians()!==i)){this.m_xf.q.SetAngleRadians(i),this.m_xf.p.SetXY(e,t),box2d.b2MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.a=i,this.m_sweep.c0.Copy(this.m_sweep.c),this.m_sweep.a0=i;for(var s=this.m_world.m_contactManager.m_broadPhase,a=this.m_fixtureList;a;a=a.m_next)a.Synchronize(s,this.m_xf,this.m_xf)}},box2d.b2Body.prototype.SetTransform=function(e){this.SetTransformVecRadians(e.p,e.GetAngleRadians())},box2d.b2Body.prototype.GetTransform=function(e){return(e=e||this.m_out_xf).Copy(this.m_xf)},box2d.b2Body.prototype.GetPosition=function(e){return(e=e||this.m_out_xf.p).Copy(this.m_xf.p)},box2d.b2Body.prototype.SetPosition=function(e){this.SetTransformVecRadians(e,this.GetAngleRadians())},box2d.b2Body.prototype.SetPositionXY=function(e,t){this.SetTransformXYRadians(e,t,this.GetAngleRadians())},box2d.b2Body.prototype.GetAngle=function(){return this.m_sweep.a},box2d.b2Body.prototype.GetAngleRadians=box2d.b2Body.prototype.GetAngle,box2d.b2Body.prototype.GetAngleDegrees=function(){return box2d.b2RadToDeg(this.GetAngle())},box2d.b2Body.prototype.SetAngle=function(e){this.SetTransformVecRadians(this.GetPosition(),e)},box2d.b2Body.prototype.SetAngleRadians=box2d.b2Body.prototype.SetAngle,box2d.b2Body.prototype.SetAngleDegrees=function(e){this.SetAngle(box2d.b2DegToRad(e))},box2d.b2Body.prototype.GetWorldCenter=function(e){return(e=e||this.m_out_sweep.c).Copy(this.m_sweep.c)},box2d.b2Body.prototype.GetLocalCenter=function(e){return(e=e||this.m_out_sweep.localCenter).Copy(this.m_sweep.localCenter)},box2d.b2Body.prototype.SetLinearVelocity=function(e){this.m_type!==box2d.b2BodyType.b2_staticBody&&(box2d.b2DotVV(e,e)>0&&this.SetAwake(!0),this.m_linearVelocity.Copy(e))},box2d.b2Body.prototype.GetLinearVelocity=function(e){return(e=e||this.m_out_linearVelocity).Copy(this.m_linearVelocity)},box2d.b2Body.prototype.SetAngularVelocity=function(e){this.m_type!==box2d.b2BodyType.b2_staticBody&&(e*e>0&&this.SetAwake(!0),this.m_angularVelocity=e)},box2d.b2Body.prototype.GetAngularVelocity=function(){return this.m_angularVelocity},box2d.b2Body.prototype.GetDefinition=function(e){return e.type=this.GetType(),e.allowSleep=(this.m_flags&box2d.b2BodyFlag.e_autoSleepFlag)===box2d.b2BodyFlag.e_autoSleepFlag,e.angle=this.GetAngleRadians(),e.angularDamping=this.m_angularDamping,e.gravityScale=this.m_gravityScale,e.angularVelocity=this.m_angularVelocity,e.fixedRotation=(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)===box2d.b2BodyFlag.e_fixedRotationFlag,e.bullet=(this.m_flags&box2d.b2BodyFlag.e_bulletFlag)===box2d.b2BodyFlag.e_bulletFlag,e.awake=(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)===box2d.b2BodyFlag.e_awakeFlag,e.linearDamping=this.m_linearDamping,e.linearVelocity.Copy(this.GetLinearVelocity()),e.position.Copy(this.GetPosition()),e.userData=this.GetUserData(),e},box2d.b2Body.prototype.ApplyForce=function(e,t,i){i=i||!0,this.m_type===box2d.b2BodyType.b2_dynamicBody&&(i&&0==(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_force.x+=e.x,this.m_force.y+=e.y,this.m_torque+=(t.x-this.m_sweep.c.x)*e.y-(t.y-this.m_sweep.c.y)*e.x))},box2d.b2Body.prototype.ApplyForceToCenter=function(e,t){t=t||!0,this.m_type===box2d.b2BodyType.b2_dynamicBody&&(t&&0==(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_force.x+=e.x,this.m_force.y+=e.y))},box2d.b2Body.prototype.ApplyTorque=function(e,t){t=t||!0,this.m_type===box2d.b2BodyType.b2_dynamicBody&&(t&&0==(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_torque+=e))},box2d.b2Body.prototype.ApplyLinearImpulse=function(e,t,i){i=i||!0,this.m_type===box2d.b2BodyType.b2_dynamicBody&&(i&&0==(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_linearVelocity.x+=this.m_invMass*e.x,this.m_linearVelocity.y+=this.m_invMass*e.y,this.m_angularVelocity+=this.m_invI*((t.x-this.m_sweep.c.x)*e.y-(t.y-this.m_sweep.c.y)*e.x)))},box2d.b2Body.prototype.ApplyAngularImpulse=function(e,t){t=t||!0,this.m_type===box2d.b2BodyType.b2_dynamicBody&&(t&&0==(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&this.SetAwake(!0),this.m_flags&box2d.b2BodyFlag.e_awakeFlag&&(this.m_angularVelocity+=this.m_invI*e))},box2d.b2Body.prototype.GetMass=function(){return this.m_mass},box2d.b2Body.prototype.GetInertia=function(){return this.m_I+this.m_mass*box2d.b2DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter)},box2d.b2Body.prototype.GetMassData=function(e){return e.mass=this.m_mass,e.I=this.m_I+this.m_mass*box2d.b2DotVV(this.m_sweep.localCenter,this.m_sweep.localCenter),e.center.Copy(this.m_sweep.localCenter),e},box2d.b2Body.prototype.SetMassData=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked()),!0!==this.m_world.IsLocked()&&this.m_type===box2d.b2BodyType.b2_dynamicBody){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=e.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,e.I>0&&0==(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)&&(this.m_I=e.I-this.m_mass*box2d.b2DotVV(e.center,e.center),box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_I>0),this.m_invI=1/this.m_I);var t=box2d.b2Body.prototype.SetMassData.s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e.center),box2d.b2MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),box2d.b2AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,box2d.b2SubVV(this.m_sweep.c,t,box2d.b2Vec2.s_t0),this.m_linearVelocity)}},box2d.b2Body.prototype.SetMassData.s_oldCenter=new box2d.b2Vec2,box2d.b2Body.prototype.ResetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.SetZero(),this.m_type===box2d.b2BodyType.b2_staticBody||this.m_type===box2d.b2BodyType.b2_kinematicBody)return this.m_sweep.c0.Copy(this.m_xf.p),this.m_sweep.c.Copy(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_type===box2d.b2BodyType.b2_dynamicBody);for(var e=box2d.b2Body.prototype.ResetMassData.s_localCenter.SetZero(),t=this.m_fixtureList;t;t=t.m_next)if(0!==t.m_density){var i=t.GetMassData(box2d.b2Body.prototype.ResetMassData.s_massData);this.m_mass+=i.mass,e.x+=i.center.x*i.mass,e.y+=i.center.y*i.mass,this.m_I+=i.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,e.x*=this.m_invMass,e.y*=this.m_invMass):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)?(this.m_I-=this.m_mass*box2d.b2DotVV(e,e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var s=box2d.b2Body.prototype.ResetMassData.s_oldCenter.Copy(this.m_sweep.c);this.m_sweep.localCenter.Copy(e),box2d.b2MulXV(this.m_xf,this.m_sweep.localCenter,this.m_sweep.c),this.m_sweep.c0.Copy(this.m_sweep.c),box2d.b2AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,box2d.b2SubVV(this.m_sweep.c,s,box2d.b2Vec2.s_t0),this.m_linearVelocity)},box2d.b2Body.prototype.ResetMassData.s_localCenter=new box2d.b2Vec2,box2d.b2Body.prototype.ResetMassData.s_oldCenter=new box2d.b2Vec2,box2d.b2Body.prototype.ResetMassData.s_massData=new box2d.b2MassData,box2d.b2Body.prototype.GetWorldPoint=function(e,t){return box2d.b2MulXV(this.m_xf,e,t)},box2d.b2Body.prototype.GetWorldVector=function(e,t){return box2d.b2MulRV(this.m_xf.q,e,t)},box2d.b2Body.prototype.GetLocalPoint=function(e,t){return box2d.b2MulTXV(this.m_xf,e,t)},box2d.b2Body.prototype.GetLocalVector=function(e,t){return box2d.b2MulTRV(this.m_xf.q,e,t)},box2d.b2Body.prototype.GetLinearVelocityFromWorldPoint=function(e,t){return box2d.b2AddVCrossSV(this.m_linearVelocity,this.m_angularVelocity,box2d.b2SubVV(e,this.m_sweep.c,box2d.b2Vec2.s_t0),t)},box2d.b2Body.prototype.GetLinearVelocityFromLocalPoint=function(e,t){return this.GetLinearVelocityFromWorldPoint(this.GetWorldPoint(e,t),t)},box2d.b2Body.prototype.GetLinearDamping=function(){return this.m_linearDamping},box2d.b2Body.prototype.SetLinearDamping=function(e){this.m_linearDamping=e},box2d.b2Body.prototype.GetAngularDamping=function(){return this.m_angularDamping},box2d.b2Body.prototype.SetAngularDamping=function(e){this.m_angularDamping=e},box2d.b2Body.prototype.GetGravityScale=function(){return this.m_gravityScale},box2d.b2Body.prototype.SetGravityScale=function(e){this.m_gravityScale=e},box2d.b2Body.prototype.SetType=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked()),!0!==this.m_world.IsLocked()&&this.m_type!==e){this.m_type=e,this.ResetMassData(),this.m_type===box2d.b2BodyType.b2_staticBody&&(this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_sweep.a0=this.m_sweep.a,this.m_sweep.c0.Copy(this.m_sweep.c),this.SynchronizeFixtures()),this.SetAwake(!0),this.m_force.SetZero(),this.m_torque=0;for(var t=this.m_contactList;t;){var i=t;t=t.next,this.m_world.m_contactManager.Destroy(i.contact)}this.m_contactList=null;for(var s=this.m_world.m_contactManager.m_broadPhase,a=this.m_fixtureList;a;a=a.m_next)for(var n=a.m_proxyCount,o=0;n>o;++o)s.TouchProxy(a.m_proxies[o].proxy)}},box2d.b2Body.prototype.GetType=function(){return this.m_type},box2d.b2Body.prototype.SetBullet=function(e){e?this.m_flags|=box2d.b2BodyFlag.e_bulletFlag:this.m_flags&=~box2d.b2BodyFlag.e_bulletFlag},box2d.b2Body.prototype.IsBullet=function(){return(this.m_flags&box2d.b2BodyFlag.e_bulletFlag)===box2d.b2BodyFlag.e_bulletFlag},box2d.b2Body.prototype.SetSleepingAllowed=function(e){e?this.m_flags|=box2d.b2BodyFlag.e_autoSleepFlag:(this.m_flags&=~box2d.b2BodyFlag.e_autoSleepFlag,this.SetAwake(!0))},box2d.b2Body.prototype.IsSleepingAllowed=function(){return(this.m_flags&box2d.b2BodyFlag.e_autoSleepFlag)===box2d.b2BodyFlag.e_autoSleepFlag},box2d.b2Body.prototype.SetAwake=function(e){e?0==(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)&&(this.m_flags|=box2d.b2BodyFlag.e_awakeFlag,this.m_sleepTime=0):(this.m_flags&=~box2d.b2BodyFlag.e_awakeFlag,this.m_sleepTime=0,this.m_linearVelocity.SetZero(),this.m_angularVelocity=0,this.m_force.SetZero(),this.m_torque=0)},box2d.b2Body.prototype.IsAwake=function(){return(this.m_flags&box2d.b2BodyFlag.e_awakeFlag)===box2d.b2BodyFlag.e_awakeFlag},box2d.b2Body.prototype.SetActive=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.m_world.IsLocked()),e!==this.IsActive())if(e){this.m_flags|=box2d.b2BodyFlag.e_activeFlag;for(var t=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.CreateProxies(t,this.m_xf)}else{this.m_flags&=~box2d.b2BodyFlag.e_activeFlag;for(var t=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.DestroyProxies(t);for(var s=this.m_contactList;s;){var a=s;s=s.next,this.m_world.m_contactManager.Destroy(a.contact)}this.m_contactList=null}},box2d.b2Body.prototype.IsActive=function(){return(this.m_flags&box2d.b2BodyFlag.e_activeFlag)===box2d.b2BodyFlag.e_activeFlag},box2d.b2Body.prototype.SetFixedRotation=function(e){(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)===box2d.b2BodyFlag.e_fixedRotationFlag!==e&&(e?this.m_flags|=box2d.b2BodyFlag.e_fixedRotationFlag:this.m_flags&=~box2d.b2BodyFlag.e_fixedRotationFlag,this.m_angularVelocity=0,this.ResetMassData())},box2d.b2Body.prototype.IsFixedRotation=function(){return(this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag)===box2d.b2BodyFlag.e_fixedRotationFlag},box2d.b2Body.prototype.GetFixtureList=function(){return this.m_fixtureList},box2d.b2Body.prototype.GetJointList=function(){return this.m_jointList},box2d.b2Body.prototype.GetContactList=function(){return this.m_contactList},box2d.b2Body.prototype.GetNext=function(){return this.m_next},box2d.b2Body.prototype.GetUserData=function(){return this.m_userData},box2d.b2Body.prototype.SetUserData=function(e){this.m_userData=e},box2d.b2Body.prototype.GetWorld=function(){return this.m_world},box2d.b2Body.prototype.SynchronizeFixtures=function(){var e=box2d.b2Body.prototype.SynchronizeFixtures.s_xf1;e.q.SetAngleRadians(this.m_sweep.a0),box2d.b2MulRV(e.q,this.m_sweep.localCenter,e.p),box2d.b2SubVV(this.m_sweep.c0,e.p,e.p);for(var t=this.m_world.m_contactManager.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.Synchronize(t,e,this.m_xf)},box2d.b2Body.prototype.SynchronizeFixtures.s_xf1=new box2d.b2Transform,box2d.b2Body.prototype.SynchronizeTransform=function(){this.m_xf.q.SetAngleRadians(this.m_sweep.a),box2d.b2MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),box2d.b2SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)},box2d.b2Body.prototype.ShouldCollide=function(e){if(this.m_type!==box2d.b2BodyType.b2_dynamicBody&&e.m_type!==box2d.b2BodyType.b2_dynamicBody)return!1;for(var t=this.m_jointList;t;t=t.next)if(t.other===e&&!1===t.joint.m_collideConnected)return!1;return!0},box2d.b2Body.prototype.Advance=function(e){this.m_sweep.Advance(e),this.m_sweep.c.Copy(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_xf.q.SetAngleRadians(this.m_sweep.a),box2d.b2MulRV(this.m_xf.q,this.m_sweep.localCenter,this.m_xf.p),box2d.b2SubVV(this.m_sweep.c,this.m_xf.p,this.m_xf.p)},box2d.b2Body.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_islandIndex;box2d.b2Log("if (true)\n"),box2d.b2Log("{\n"),box2d.b2Log("  /*box2d.b2BodyDef*/ var bd = new box2d.b2BodyDef();\n");var t="";switch(this.m_type){case box2d.b2BodyType.b2_staticBody:t="box2d.b2BodyType.b2_staticBody";break;case box2d.b2BodyType.b2_kinematicBody:t="box2d.b2BodyType.b2_kinematicBody";break;case box2d.b2BodyType.b2_dynamicBody:t="box2d.b2BodyType.b2_dynamicBody";break;default:box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1)}box2d.b2Log("  bd.type = %s;\n",t),box2d.b2Log("  bd.position.SetXY(%.15f, %.15f);\n",this.m_xf.p.x,this.m_xf.p.y),box2d.b2Log("  bd.angle = %.15f;\n",this.m_sweep.a),box2d.b2Log("  bd.linearVelocity.SetXY(%.15f, %.15f);\n",this.m_linearVelocity.x,this.m_linearVelocity.y),box2d.b2Log("  bd.angularVelocity = %.15f;\n",this.m_angularVelocity),box2d.b2Log("  bd.linearDamping = %.15f;\n",this.m_linearDamping),box2d.b2Log("  bd.angularDamping = %.15f;\n",this.m_angularDamping),box2d.b2Log("  bd.allowSleep = %s;\n",this.m_flags&box2d.b2BodyFlag.e_autoSleepFlag?"true":"false"),box2d.b2Log("  bd.awake = %s;\n",this.m_flags&box2d.b2BodyFlag.e_awakeFlag?"true":"false"),box2d.b2Log("  bd.fixedRotation = %s;\n",this.m_flags&box2d.b2BodyFlag.e_fixedRotationFlag?"true":"false"),box2d.b2Log("  bd.bullet = %s;\n",this.m_flags&box2d.b2BodyFlag.e_bulletFlag?"true":"false"),box2d.b2Log("  bd.active = %s;\n",this.m_flags&box2d.b2BodyFlag.e_activeFlag?"true":"false"),box2d.b2Log("  bd.gravityScale = %.15f;\n",this.m_gravityScale),box2d.b2Log("\n"),box2d.b2Log("  bodies[%d] = this.m_world.CreateBody(bd);\n",this.m_islandIndex),box2d.b2Log("\n");for(var i=this.m_fixtureList;i;i=i.m_next)box2d.b2Log("  if (true)\n"),box2d.b2Log("  {\n"),i.Dump(e),box2d.b2Log("  }\n");box2d.b2Log("}\n")}},box2d.b2Body.prototype.GetControllerList=function(){return this.m_controllerList},box2d.b2Body.prototype.GetControllerCount=function(){return this.m_controllerCount},goog.provide("box2d.b2World"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Draw"),goog.require("box2d.b2ContactManager"),goog.require("box2d.b2ContactSolver"),goog.require("box2d.b2Island"),goog.require("box2d.b2Body"),goog.require("box2d.b2Math"),goog.require("box2d.b2Collision"),goog.require("box2d.b2TimeStep"),goog.require("box2d.b2WorldCallbacks"),goog.require("box2d.b2JointFactory"),box2d.b2WorldFlag={e_none:0,e_newFixture:1,e_locked:2,e_clearForces:4},goog.exportProperty(box2d.b2WorldFlag,"e_none",box2d.b2WorldFlag.e_none),goog.exportProperty(box2d.b2WorldFlag,"e_newFixture",box2d.b2WorldFlag.e_newFixture),goog.exportProperty(box2d.b2WorldFlag,"e_locked",box2d.b2WorldFlag.e_locked),goog.exportProperty(box2d.b2WorldFlag,"e_clearForces",box2d.b2WorldFlag.e_clearForces),box2d.b2World=function(e){this.m_flags=box2d.b2WorldFlag.e_clearForces,this.m_contactManager=new box2d.b2ContactManager,this.m_gravity=e.Clone(),this.m_out_gravity=new box2d.b2Vec2,this.m_allowSleep=!0,this.m_destructionListener=null,this.m_debugDraw=null,this.m_warmStarting=!0,this.m_continuousPhysics=!0,this.m_subStepping=!1,this.m_stepComplete=!0,this.m_profile=new box2d.b2Profile,this.m_island=new box2d.b2Island,this.s_stack=new Array},box2d.b2World.prototype.m_flags=box2d.b2WorldFlag.e_none,box2d.b2World.prototype.m_contactManager=null,box2d.b2World.prototype.m_bodyList=null,box2d.b2World.prototype.m_jointList=null,box2d.b2World.prototype.m_bodyCount=0,box2d.b2World.prototype.m_jointCount=0,box2d.b2World.prototype.m_gravity=null,box2d.b2World.prototype.m_out_gravity=null,box2d.b2World.prototype.m_allowSleep=!0,box2d.b2World.prototype.m_destructionListener=null,box2d.b2World.prototype.m_debugDraw=null,box2d.b2World.prototype.m_inv_dt0=0,box2d.b2World.prototype.m_warmStarting=!0,box2d.b2World.prototype.m_continuousPhysics=!0,box2d.b2World.prototype.m_subStepping=!1,box2d.b2World.prototype.m_stepComplete=!0,box2d.b2World.prototype.m_profile=null,box2d.b2World.prototype.m_island=null,box2d.b2World.prototype.s_stack=null,box2d.b2World.prototype.m_controllerList=null,box2d.b2World.prototype.m_controllerCount=0,box2d.b2World.prototype.SetAllowSleeping=function(e){if(e!==this.m_allowSleep&&(this.m_allowSleep=e,!1===this.m_allowSleep))for(var t=this.m_bodyList;t;t=t.m_next)t.SetAwake(!0)},box2d.b2World.prototype.GetAllowSleeping=function(){return this.m_allowSleep},box2d.b2World.prototype.SetWarmStarting=function(e){this.m_warmStarting=e},box2d.b2World.prototype.GetWarmStarting=function(){return this.m_warmStarting},box2d.b2World.prototype.SetContinuousPhysics=function(e){this.m_continuousPhysics=e},box2d.b2World.prototype.GetContinuousPhysics=function(){return this.m_continuousPhysics},box2d.b2World.prototype.SetSubStepping=function(e){this.m_subStepping=e},box2d.b2World.prototype.GetSubStepping=function(){return this.m_subStepping},box2d.b2World.prototype.GetBodyList=function(){return this.m_bodyList},box2d.b2World.prototype.GetJointList=function(){return this.m_jointList},box2d.b2World.prototype.GetContactList=function(){return this.m_contactManager.m_contactList},box2d.b2World.prototype.GetBodyCount=function(){return this.m_bodyCount},box2d.b2World.prototype.GetJointCount=function(){return this.m_jointCount},box2d.b2World.prototype.GetContactCount=function(){return this.m_contactManager.m_contactCount},box2d.b2World.prototype.SetGravity=function(e,t){if(t=t||!0,(this.m_gravity.x!==e.x||this.m_gravity.y!==e.y)&&(this.m_gravity.Copy(e),t))for(var i=this.m_bodyList;i;i=i.m_next)i.SetAwake(!0)},box2d.b2World.prototype.GetGravity=function(e){return(e=e||this.m_out_gravity).Copy(this.m_gravity)},box2d.b2World.prototype.IsLocked=function(){return(this.m_flags&box2d.b2WorldFlag.e_locked)>0},box2d.b2World.prototype.SetAutoClearForces=function(e){e?this.m_flags|=box2d.b2WorldFlag.e_clearForces:this.m_flags&=~box2d.b2WorldFlag.e_clearForces},box2d.b2World.prototype.GetAutoClearForces=function(){return(this.m_flags&box2d.b2WorldFlag.e_clearForces)===box2d.b2WorldFlag.e_clearForces},box2d.b2World.prototype.GetContactManager=function(){return this.m_contactManager},box2d.b2World.prototype.GetProfile=function(){return this.m_profile},box2d.b2World.prototype.SetDestructionListener=function(e){this.m_destructionListener=e},box2d.b2World.prototype.SetContactFilter=function(e){this.m_contactManager.m_contactFilter=e},box2d.b2World.prototype.SetContactListener=function(e){this.m_contactManager.m_contactListener=e},box2d.b2World.prototype.SetDebugDraw=function(e){this.m_debugDraw=e},box2d.b2World.prototype.CreateBody=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked()),this.IsLocked())return null;var t=new box2d.b2Body(e,this);return t.m_prev=null,t.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=t),this.m_bodyList=t,++this.m_bodyCount,t},box2d.b2World.prototype.DestroyBody=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_bodyCount>0),box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked()),!this.IsLocked()){for(var t=e.m_jointList;t;){var i=t;t=t.next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeJoint(i.joint),this.DestroyJoint(i.joint),e.m_jointList=t}e.m_jointList=null;for(var s=e.m_controllerList;s;){var a=s;s=s.nextController,a.controller.RemoveBody(e)}for(var n=e.m_contactList;n;){var o=n;n=n.next,this.m_contactManager.Destroy(o.contact)}e.m_contactList=null;for(var r=e.m_fixtureList;r;){var l=r;r=r.m_next,this.m_destructionListener&&this.m_destructionListener.SayGoodbyeFixture(l),l.DestroyProxies(this.m_contactManager.m_broadPhase),l.Destroy(),e.m_fixtureList=r,e.m_fixtureCount-=1}e.m_fixtureList=null,e.m_fixtureCount=0,e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_bodyList&&(this.m_bodyList=e.m_next),--this.m_bodyCount}},box2d.b2World.prototype.CreateJoint=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked()),this.IsLocked())return null;var t=box2d.b2JointFactory.Create(e,null);t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.m_edgeA.joint=t,t.m_edgeA.other=t.m_bodyB,t.m_edgeA.prev=null,t.m_edgeA.next=t.m_bodyA.m_jointList,t.m_bodyA.m_jointList&&(t.m_bodyA.m_jointList.prev=t.m_edgeA),t.m_bodyA.m_jointList=t.m_edgeA,t.m_edgeB.joint=t,t.m_edgeB.other=t.m_bodyA,t.m_edgeB.prev=null,t.m_edgeB.next=t.m_bodyB.m_jointList,t.m_bodyB.m_jointList&&(t.m_bodyB.m_jointList.prev=t.m_edgeB),t.m_bodyB.m_jointList=t.m_edgeB;var i=e.bodyA,s=e.bodyB;if(!1===e.collideConnected)for(var a=s.GetContactList();a;)a.other===i&&a.contact.FlagForFiltering(),a=a.next;return t},box2d.b2World.prototype.DestroyJoint=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked()),!this.IsLocked()){var t=e.m_collideConnected;e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),e===this.m_jointList&&(this.m_jointList=e.m_next);var i=e.m_bodyA,s=e.m_bodyB;if(i.SetAwake(!0),s.SetAwake(!0),e.m_edgeA.prev&&(e.m_edgeA.prev.next=e.m_edgeA.next),e.m_edgeA.next&&(e.m_edgeA.next.prev=e.m_edgeA.prev),e.m_edgeA===i.m_jointList&&(i.m_jointList=e.m_edgeA.next),e.m_edgeA.prev=null,e.m_edgeA.next=null,e.m_edgeB.prev&&(e.m_edgeB.prev.next=e.m_edgeB.next),e.m_edgeB.next&&(e.m_edgeB.next.prev=e.m_edgeB.prev),e.m_edgeB===s.m_jointList&&(s.m_jointList=e.m_edgeB.next),e.m_edgeB.prev=null,e.m_edgeB.next=null,box2d.b2JointFactory.Destroy(e,null),box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.m_jointCount>0),--this.m_jointCount,!1===t)for(var a=s.GetContactList();a;)a.other===i&&a.contact.FlagForFiltering(),a=a.next}},box2d.b2World.prototype.Solve=function(e){for(var t=this.m_controllerList;t;t=t.m_next)t.Step(e);this.m_profile.solveInit=0,this.m_profile.solveVelocity=0,this.m_profile.solvePosition=0;var i=this.m_island;i.Initialize(this.m_bodyCount,this.m_contactManager.m_contactCount,this.m_jointCount,null,this.m_contactManager.m_contactListener);for(x=this.m_bodyList;x;x=x.m_next)x.m_flags&=~box2d.b2BodyFlag.e_islandFlag;for(var s=this.m_contactManager.m_contactList;s;s=s.m_next)s.m_flags&=~box2d.b2ContactFlag.e_islandFlag;for(var a=this.m_jointList;a;a=a.m_next)a.m_islandFlag=!1;for(var n=this.m_bodyCount,o=this.s_stack,r=this.m_bodyList;r;r=r.m_next)if(!(r.m_flags&box2d.b2BodyFlag.e_islandFlag)&&!1!==r.IsAwake()&&!1!==r.IsActive()&&r.GetType()!==box2d.b2BodyType.b2_staticBody){i.Clear();var l=0;for(o[l++]=r,r.m_flags|=box2d.b2BodyFlag.e_islandFlag;l>0;){x=o[--l];if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!0===x.IsActive()),i.AddBody(x),x.SetAwake(!0),x.GetType()!==box2d.b2BodyType.b2_staticBody){for(var h=x.m_contactList;h;h=h.next){var c=h.contact;if(!(c.m_flags&box2d.b2ContactFlag.e_islandFlag)&&!1!==c.IsEnabled()&&!1!==c.IsTouching()){var p=c.m_fixtureA.m_isSensor,d=c.m_fixtureB.m_isSensor;p||d||(i.AddContact(c),c.m_flags|=box2d.b2ContactFlag.e_islandFlag,(m=h.other).m_flags&box2d.b2BodyFlag.e_islandFlag||(box2d.ENABLE_ASSERTS&&box2d.b2Assert(n>l),o[l++]=m,m.m_flags|=box2d.b2BodyFlag.e_islandFlag))}}for(var u=x.m_jointList;u;u=u.next)if(!0!==u.joint.m_islandFlag){var m=u.other;!1!==m.IsActive()&&(i.AddJoint(u.joint),u.joint.m_islandFlag=!0,m.m_flags&box2d.b2BodyFlag.e_islandFlag||(box2d.ENABLE_ASSERTS&&box2d.b2Assert(n>l),o[l++]=m,m.m_flags|=box2d.b2BodyFlag.e_islandFlag))}}}var g=new box2d.b2Profile;i.Solve(g,e,this.m_gravity,this.m_allowSleep),this.m_profile.solveInit+=g.solveInit,this.m_profile.solveVelocity+=g.solveVelocity,this.m_profile.solvePosition+=g.solvePosition;for(y=0;y<i.m_bodyCount;++y)(x=i.m_bodies[y]).GetType()===box2d.b2BodyType.b2_staticBody&&(x.m_flags&=~box2d.b2BodyFlag.e_islandFlag)}for(var y=0;y<o.length&&o[y];++y)o[y]=null;for(var b=new box2d.b2Timer,x=this.m_bodyList;x;x=x.m_next)0!=(x.m_flags&box2d.b2BodyFlag.e_islandFlag)&&x.GetType()!==box2d.b2BodyType.b2_staticBody&&x.SynchronizeFixtures();this.m_contactManager.FindNewContacts(),this.m_profile.broadphase=b.GetMilliseconds()},box2d.b2World.prototype.SolveTOI=function(e){var t=this.m_island;if(t.Initialize(2*box2d.b2_maxTOIContacts,box2d.b2_maxTOIContacts,0,null,this.m_contactManager.m_contactListener),this.m_stepComplete){for(var i=this.m_bodyList;i;i=i.m_next)i.m_flags&=~box2d.b2BodyFlag.e_islandFlag,i.m_sweep.alpha0=0;for(n=this.m_contactManager.m_contactList;n;n=n.m_next)n.m_flags&=~(box2d.b2ContactFlag.e_toiFlag|box2d.b2ContactFlag.e_islandFlag),n.m_toiCount=0,n.m_toi=1}for(;;){for(var s=null,a=1,n=this.m_contactManager.m_contactList;n;n=n.m_next)if(!1!==n.IsEnabled()&&!(n.m_toiCount>box2d.b2_maxSubSteps)){var o=1;if(n.m_flags&box2d.b2ContactFlag.e_toiFlag)o=n.m_toi;else{var r=n.GetFixtureA(),l=n.GetFixtureB();if(r.IsSensor()||l.IsSensor())continue;var h=r.GetBody(),c=l.GetBody(),p=h.m_type,d=c.m_type;box2d.ENABLE_ASSERTS&&box2d.b2Assert(p===box2d.b2BodyType.b2_dynamicBody||d===box2d.b2BodyType.b2_dynamicBody);var u=h.IsAwake()&&p!==box2d.b2BodyType.b2_staticBody,m=c.IsAwake()&&d!==box2d.b2BodyType.b2_staticBody;if(!1===u&&!1===m)continue;var g=h.IsBullet()||p!==box2d.b2BodyType.b2_dynamicBody,y=c.IsBullet()||d!==box2d.b2BodyType.b2_dynamicBody;if(!1===g&&!1===y)continue;var b=h.m_sweep.alpha0;h.m_sweep.alpha0<c.m_sweep.alpha0?(b=c.m_sweep.alpha0,h.m_sweep.Advance(b)):c.m_sweep.alpha0<h.m_sweep.alpha0&&(b=h.m_sweep.alpha0,c.m_sweep.Advance(b)),box2d.ENABLE_ASSERTS&&box2d.b2Assert(1>b);var x=n.GetChildIndexA(),v=n.GetChildIndexB(),f=box2d.b2World.prototype.SolveTOI.s_toi_input;f.proxyA.SetShape(r.GetShape(),x),f.proxyB.SetShape(l.GetShape(),v),f.sweepA.Copy(h.m_sweep),f.sweepB.Copy(c.m_sweep),f.tMax=1;var w=box2d.b2World.prototype.SolveTOI.s_toi_output;box2d.b2TimeOfImpact(w,f);var k=w.t;o=w.state===box2d.b2TOIOutputState.e_touching?box2d.b2Min(b+(1-b)*k,1):1,n.m_toi=o,n.m_flags|=box2d.b2ContactFlag.e_toiFlag}a>o&&(s=n,a=o)}if(null===s||1-10*box2d.b2_epsilon<a){this.m_stepComplete=!0;break}var r=s.GetFixtureA(),l=s.GetFixtureB(),h=r.GetBody(),c=l.GetBody(),_=box2d.b2World.prototype.SolveTOI.s_backup1.Copy(h.m_sweep),S=box2d.b2World.prototype.SolveTOI.s_backup2.Copy(c.m_sweep);if(h.Advance(a),c.Advance(a),s.Update(this.m_contactManager.m_contactListener),s.m_flags&=~box2d.b2ContactFlag.e_toiFlag,++s.m_toiCount,!1!==s.IsEnabled()&&!1!==s.IsTouching()){h.SetAwake(!0),c.SetAwake(!0),t.Clear(),t.AddBody(h),t.AddBody(c),t.AddContact(s),h.m_flags|=box2d.b2BodyFlag.e_islandFlag,c.m_flags|=box2d.b2BodyFlag.e_islandFlag,s.m_flags|=box2d.b2ContactFlag.e_islandFlag;for(Y=0;2>Y;++Y)if((G=0===Y?h:c).m_type===box2d.b2BodyType.b2_dynamicBody)for(B=G.m_contactList;B&&t.m_bodyCount!==t.m_bodyCapacity&&t.m_contactCount!==t.m_contactCapacity;B=B.next){var M=B.contact;if(!(M.m_flags&box2d.b2ContactFlag.e_islandFlag)){var A=B.other;if(A.m_type!==box2d.b2BodyType.b2_dynamicBody||!1!==G.IsBullet()||!1!==A.IsBullet()){var C=M.m_fixtureA.m_isSensor,P=M.m_fixtureB.m_isSensor;if(!C&&!P){var T=box2d.b2World.prototype.SolveTOI.s_backup.Copy(A.m_sweep);0==(A.m_flags&box2d.b2BodyFlag.e_islandFlag)&&A.Advance(a),M.Update(this.m_contactManager.m_contactListener),!1!==M.IsEnabled()&&!1!==M.IsTouching()?(M.m_flags|=box2d.b2ContactFlag.e_islandFlag,t.AddContact(M),A.m_flags&box2d.b2BodyFlag.e_islandFlag||(A.m_flags|=box2d.b2BodyFlag.e_islandFlag,A.m_type!==box2d.b2BodyType.b2_staticBody&&A.SetAwake(!0),t.AddBody(A))):(A.m_sweep.Copy(T),A.SynchronizeTransform())}}}}var X=box2d.b2World.prototype.SolveTOI.s_subStep;X.dt=(1-a)*e.dt,X.inv_dt=1/X.dt,X.dtRatio=1,X.positionIterations=20,X.velocityIterations=e.velocityIterations,X.warmStarting=!1,t.SolveTOI(X,h.m_islandIndex,c.m_islandIndex);for(var Y=0;Y<t.m_bodyCount;++Y){var G=t.m_bodies[Y];if(G.m_flags&=~box2d.b2BodyFlag.e_islandFlag,G.m_type===box2d.b2BodyType.b2_dynamicBody){G.SynchronizeFixtures();for(var B=G.m_contactList;B;B=B.next)B.contact.m_flags&=~(box2d.b2ContactFlag.e_toiFlag|box2d.b2ContactFlag.e_islandFlag)}}if(this.m_contactManager.FindNewContacts(),this.m_subStepping){this.m_stepComplete=!1;break}}else s.SetEnabled(!1),h.m_sweep.Copy(_),c.m_sweep.Copy(S),h.SynchronizeTransform(),c.SynchronizeTransform()}},box2d.b2World.prototype.SolveTOI.s_subStep=new box2d.b2TimeStep,box2d.b2World.prototype.SolveTOI.s_backup=new box2d.b2Sweep,box2d.b2World.prototype.SolveTOI.s_backup1=new box2d.b2Sweep,box2d.b2World.prototype.SolveTOI.s_backup2=new box2d.b2Sweep,box2d.b2World.prototype.SolveTOI.s_toi_input=new box2d.b2TOIInput,box2d.b2World.prototype.SolveTOI.s_toi_output=new box2d.b2TOIOutput,box2d.b2World.prototype.Step=function(e,t,i){var s=new box2d.b2Timer;this.m_flags&box2d.b2WorldFlag.e_newFixture&&(this.m_contactManager.FindNewContacts(),this.m_flags&=~box2d.b2WorldFlag.e_newFixture),this.m_flags|=box2d.b2WorldFlag.e_locked;var a=box2d.b2World.prototype.Step.s_step;a.dt=e,a.velocityIterations=t,a.positionIterations=i,a.inv_dt=e>0?1/e:0,a.dtRatio=this.m_inv_dt0*e,a.warmStarting=this.m_warmStarting;n=new box2d.b2Timer;if(this.m_contactManager.Collide(),this.m_profile.collide=n.GetMilliseconds(),this.m_stepComplete&&a.dt>0){n=new box2d.b2Timer;this.Solve(a),this.m_profile.solve=n.GetMilliseconds()}if(this.m_continuousPhysics&&a.dt>0){var n=new box2d.b2Timer;this.SolveTOI(a),this.m_profile.solveTOI=n.GetMilliseconds()}a.dt>0&&(this.m_inv_dt0=a.inv_dt),this.m_flags&box2d.b2WorldFlag.e_clearForces&&this.ClearForces(),this.m_flags&=~box2d.b2WorldFlag.e_locked,this.m_profile.step=s.GetMilliseconds()},box2d.b2World.prototype.Step.s_step=new box2d.b2TimeStep,box2d.b2World.prototype.ClearForces=function(){for(var e=this.m_bodyList;e;e=e.m_next)e.m_force.SetZero(),e.m_torque=0},box2d.b2World.prototype.QueryAABB=function(e,t){var i=this.m_contactManager.m_broadPhase;i.Query(function(t){var s=i.GetUserData(t);box2d.ENABLE_ASSERTS&&box2d.b2Assert(s instanceof box2d.b2FixtureProxy);var a=s.fixture;return s.childIndex,e instanceof box2d.b2QueryCallback?e.ReportFixture(a):e(a)},t)},box2d.b2World.prototype.QueryShape=function(e,t,i){var s=this.m_contactManager.m_broadPhase,a=box2d.b2World.prototype.QueryShape.s_aabb;t.ComputeAABB(a,i,0),s.Query(function(a){var n=s.GetUserData(a);box2d.ENABLE_ASSERTS&&box2d.b2Assert(n instanceof box2d.b2FixtureProxy);var o=n.fixture;return n.childIndex,!box2d.b2TestOverlapShape(t,0,o.GetShape(),0,i,o.GetBody().GetTransform())||(e instanceof box2d.b2QueryCallback?e.ReportFixture(o):e(o))},a)},box2d.b2World.prototype.QueryShape.s_aabb=new box2d.b2AABB,box2d.b2World.prototype.QueryPoint=function(e,t){var i=this.m_contactManager.m_broadPhase,s=box2d.b2World.prototype.QueryPoint.s_aabb;s.lowerBound.SetXY(t.x-box2d.b2_linearSlop,t.y-box2d.b2_linearSlop),s.upperBound.SetXY(t.x+box2d.b2_linearSlop,t.y+box2d.b2_linearSlop),i.Query(function(s){var a=i.GetUserData(s);box2d.ENABLE_ASSERTS&&box2d.b2Assert(a instanceof box2d.b2FixtureProxy);var n=a.fixture;return a.childIndex,!n.TestPoint(t)||(e instanceof box2d.b2QueryCallback?e.ReportFixture(n):e(n))},s)},box2d.b2World.prototype.QueryPoint.s_aabb=new box2d.b2AABB,box2d.b2World.prototype.RayCast=function(e,t,i){var s=this.m_contactManager.m_broadPhase,a=box2d.b2World.prototype.RayCast.s_input;a.maxFraction=1,a.p1.Copy(t),a.p2.Copy(i),s.RayCast(function(a,n){var o=s.GetUserData(n);box2d.ENABLE_ASSERTS&&box2d.b2Assert(o instanceof box2d.b2FixtureProxy);var r=o.fixture,l=o.childIndex,h=box2d.b2World.prototype.RayCast.s_output;if(r.RayCast(h,a,l)){var c=h.fraction,p=box2d.b2World.prototype.RayCast.s_point;return p.SetXY((1-c)*t.x+c*i.x,(1-c)*t.y+c*i.y),e instanceof box2d.b2RayCastCallback?e.ReportFixture(r,p,h.normal,c):e(r,p,h.normal,c)}return a.maxFraction},a)},box2d.b2World.prototype.RayCast.s_input=new box2d.b2RayCastInput,box2d.b2World.prototype.RayCast.s_output=new box2d.b2RayCastOutput,box2d.b2World.prototype.RayCast.s_point=new box2d.b2Vec2,box2d.b2World.prototype.RayCastOne=function(e,t){var i=null,s=1;return this.RayCast(function(e,t,a,n){return s>n&&(s=n,i=e),s},e,t),i},box2d.b2World.prototype.RayCastAll=function(e,t,i){return i.length=0,this.RayCast(function(e){return i.push(e),1},e,t),i},box2d.b2World.prototype.DrawShape=function(e,t){var i=e.GetShape();switch(i.m_type){case box2d.b2ShapeType.e_circleShape:var s=i instanceof box2d.b2CircleShape?i:null,a=s.m_p,n=s.m_radius,o=box2d.b2Vec2.UNITX;this.m_debugDraw.DrawSolidCircle(a,n,o,t);break;case box2d.b2ShapeType.e_edgeShape:var r=i instanceof box2d.b2EdgeShape?i:null,l=r.m_vertex1,h=r.m_vertex2;this.m_debugDraw.DrawSegment(l,h,t);break;case box2d.b2ShapeType.e_chainShape:for(var c=i instanceof box2d.b2ChainShape?i:null,p=c.m_count,l=(g=c.m_vertices)[0],d=0;p>d;++d){h=g[d];this.m_debugDraw.DrawSegment(l,h,t),this.m_debugDraw.DrawCircle(h,.05,t),l=h}break;case box2d.b2ShapeType.e_polygonShape:var u=i instanceof box2d.b2PolygonShape?i:null,m=u.m_count,g=u.m_vertices;this.m_debugDraw.DrawSolidPolygon(g,m,t)}},box2d.b2World.prototype.DrawJoint=function(e){var t=e.GetBodyA(),i=e.GetBodyB(),s=t.m_xf,a=i.m_xf,n=s.p,o=a.p,r=e.GetAnchorA(box2d.b2World.prototype.DrawJoint.s_p1),l=e.GetAnchorB(box2d.b2World.prototype.DrawJoint.s_p2),h=box2d.b2World.prototype.DrawJoint.s_color.SetRGB(.5,.8,.8);switch(e.m_type){case box2d.b2JointType.e_distanceJoint:this.m_debugDraw.DrawSegment(r,l,h);break;case box2d.b2JointType.e_pulleyJoint:var c=e instanceof box2d.b2PulleyJoint?e:null,p=c.GetGroundAnchorA(box2d.b2World.prototype.DrawJoint.s_s1),d=c.GetGroundAnchorB(box2d.b2World.prototype.DrawJoint.s_s2);this.m_debugDraw.DrawSegment(p,r,h),this.m_debugDraw.DrawSegment(d,l,h),this.m_debugDraw.DrawSegment(p,d,h);break;case box2d.b2JointType.e_mouseJoint:this.m_debugDraw.DrawSegment(r,l,h);break;default:this.m_debugDraw.DrawSegment(n,r,h),this.m_debugDraw.DrawSegment(r,l,h),this.m_debugDraw.DrawSegment(o,l,h)}},box2d.b2World.prototype.DrawJoint.s_p1=new box2d.b2Vec2,box2d.b2World.prototype.DrawJoint.s_p2=new box2d.b2Vec2,box2d.b2World.prototype.DrawJoint.s_color=new box2d.b2Color(.5,.8,.8),box2d.b2World.prototype.DrawJoint.s_s1=new box2d.b2Vec2,box2d.b2World.prototype.DrawJoint.s_s2=new box2d.b2Vec2,box2d.b2World.prototype.DrawDebugData=function(){if(null!==this.m_debugDraw){var e=this.m_debugDraw.GetFlags(),t=box2d.b2World.prototype.DrawDebugData.s_color.SetRGB(0,0,0);if(e&box2d.b2DrawFlags.e_shapeBit)for(o=this.m_bodyList;o;o=o.m_next){var i=o.m_xf;this.m_debugDraw.PushTransform(i);for(r=o.GetFixtureList();r;r=r.m_next)!1===o.IsActive()?(t.SetRGB(.5,.5,.3),this.DrawShape(r,t)):o.GetType()===box2d.b2BodyType.b2_staticBody?(t.SetRGB(.5,.9,.5),this.DrawShape(r,t)):o.GetType()===box2d.b2BodyType.b2_kinematicBody?(t.SetRGB(.5,.5,.9),this.DrawShape(r,t)):!1===o.IsAwake()?(t.SetRGB(.6,.6,.6),this.DrawShape(r,t)):(t.SetRGB(.9,.7,.7),this.DrawShape(r,t));this.m_debugDraw.PopTransform(i)}if(e&box2d.b2DrawFlags.e_jointBit)for(var s=this.m_jointList;s;s=s.m_next)this.DrawJoint(s);if(e&box2d.b2DrawFlags.e_aabbBit){t.SetRGB(.9,.3,.9);for(var a=this.m_contactManager.m_broadPhase,n=box2d.b2World.prototype.DrawDebugData.s_vs,o=this.m_bodyList;o;o=o.m_next)if(!1!==o.IsActive())for(var r=o.GetFixtureList();r;r=r.m_next)for(var l=0;l<r.m_proxyCount;++l){var h=r.m_proxies[l],c=a.GetFatAABB(h.proxy);n[0].SetXY(c.lowerBound.x,c.lowerBound.y),n[1].SetXY(c.upperBound.x,c.lowerBound.y),n[2].SetXY(c.upperBound.x,c.upperBound.y),n[3].SetXY(c.lowerBound.x,c.upperBound.y),this.m_debugDraw.DrawPolygon(n,4,t)}}if(e&box2d.b2DrawFlags.e_centerOfMassBit)for(o=this.m_bodyList;o;o=o.m_next)(i=box2d.b2World.prototype.DrawDebugData.s_xf).q.Copy(o.m_xf.q),i.p.Copy(o.GetWorldCenter()),this.m_debugDraw.DrawTransform(i);if(e&box2d.b2DrawFlags.e_controllerBit)for(var p=this.m_controllerList;p;p=p.m_next)p.Draw(this.m_debugDraw)}},box2d.b2World.prototype.DrawDebugData.s_color=new box2d.b2Color(0,0,0),box2d.b2World.prototype.DrawDebugData.s_vs=box2d.b2Vec2.MakeArray(4),box2d.b2World.prototype.DrawDebugData.s_xf=new box2d.b2Transform,box2d.b2World.prototype.SetBroadPhase=function(e){var t=this.m_contactManager.m_broadPhase;this.m_contactManager.m_broadPhase=e;for(var i=this.m_bodyList;i;i=i.m_next)for(var s=i.m_fixtureList;s;s=s.m_next)s.m_proxy=e.CreateProxy(t.GetFatAABB(s.m_proxy),s)},box2d.b2World.prototype.GetProxyCount=function(){return this.m_contactManager.m_broadPhase.GetProxyCount()},box2d.b2World.prototype.GetTreeHeight=function(){return this.m_contactManager.m_broadPhase.GetTreeHeight()},box2d.b2World.prototype.GetTreeBalance=function(){return this.m_contactManager.m_broadPhase.GetTreeBalance()},box2d.b2World.prototype.GetTreeQuality=function(){return this.m_contactManager.m_broadPhase.GetTreeQuality()},box2d.b2World.prototype.ShiftOrigin=function(e){if(box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1===this.IsLocked()),!this.IsLocked()){for(var t=this.m_bodyList;t;t=t.m_next)t.m_xf.p.SelfSub(e),t.m_sweep.c0.SelfSub(e),t.m_sweep.c.SelfSub(e);for(var i=this.m_jointList;i;i=i.m_next)i.ShiftOrigin(e);this.m_contactManager.m_broadPhase.ShiftOrigin(e)}},box2d.b2World.prototype.Dump=function(){if(box2d.DEBUG){if((this.m_flags&box2d.b2WorldFlag.e_locked)===box2d.b2WorldFlag.e_locked)return;box2d.b2Log("/** @type {box2d.b2Vec2} */ var g = new box2d.b2Vec2(%.15f, %.15f);\n",this.m_gravity.x,this.m_gravity.y),box2d.b2Log("this.m_world.SetGravity(g);\n"),box2d.b2Log("/** @type {Array.<box2d.b2Body>} */ var bodies = new Array(%d);\n",this.m_bodyCount),box2d.b2Log("/** @type {Array.<box2d.b2Joint>} */ var joints = new Array(%d);\n",this.m_jointCount);for(var e=0,t=this.m_bodyList;t;t=t.m_next)t.m_islandIndex=e,t.Dump(),++e;e=0;for(i=this.m_jointList;i;i=i.m_next)i.m_index=e,++e;for(i=this.m_jointList;i;i=i.m_next)i.m_type!==box2d.b2JointType.e_gearJoint&&(box2d.b2Log("if (true)\n"),box2d.b2Log("{\n"),i.Dump(),box2d.b2Log("}\n"));for(var i=this.m_jointList;i;i=i.m_next)i.m_type===box2d.b2JointType.e_gearJoint&&(box2d.b2Log("if (true)\n"),box2d.b2Log("{\n"),i.Dump(),box2d.b2Log("}\n"))}},box2d.b2World.prototype.AddController=function(e){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(null===e.m_world,"Controller can only be a member of one world"),e.m_world=this,e.m_next=this.m_controllerList,e.m_prev=null,this.m_controllerList&&(this.m_controllerList.m_prev=e),this.m_controllerList=e,++this.m_controllerCount,e},box2d.b2World.prototype.RemoveController=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.m_world===this,"Controller is not a member of this world"),e.m_prev&&(e.m_prev.m_next=e.m_next),e.m_next&&(e.m_next.m_prev=e.m_prev),this.m_controllerList===e&&(this.m_controllerList=e.m_next),--this.m_controllerCount,e.m_prev=null,e.m_next=null,e.m_world=null},goog.provide("box2d.b2AreaJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Joint"),goog.require("box2d.b2Math"),box2d.b2AreaJointDef=function(){goog.base(this,box2d.b2JointType.e_areaJoint),this.bodies=new Array},goog.inherits(box2d.b2AreaJointDef,box2d.b2JointDef),box2d.b2AreaJointDef.prototype.world=null,box2d.b2AreaJointDef.prototype.bodies=null,box2d.b2AreaJointDef.prototype.frequencyHz=0,box2d.b2AreaJointDef.prototype.dampingRatio=0,box2d.b2AreaJointDef.prototype.AddBody=function(e){this.bodies.push(e),1===this.bodies.length?this.bodyA=e:2===this.bodies.length&&(this.bodyB=e)},box2d.b2AreaJoint=function(e){goog.base(this,e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.bodies.length>=3,"You cannot create an area joint with less than three bodies."),this.m_bodies=e.bodies,this.m_frequencyHz=e.frequencyHz,this.m_dampingRatio=e.dampingRatio,this.m_targetLengths=box2d.b2MakeNumberArray(e.bodies.length),this.m_normals=box2d.b2Vec2.MakeArray(e.bodies.length),this.m_joints=new Array(e.bodies.length),this.m_deltas=box2d.b2Vec2.MakeArray(e.bodies.length),this.m_delta=new box2d.b2Vec2;var t=new box2d.b2DistanceJointDef;t.frequencyHz=e.frequencyHz,t.dampingRatio=e.dampingRatio,this.m_targetArea=0;for(var i=0,s=this.m_bodies.length;s>i;++i){var a=this.m_bodies[i],n=this.m_bodies[(i+1)%s],o=a.GetWorldCenter(),r=n.GetWorldCenter();this.m_targetLengths[i]=box2d.b2DistanceVV(o,r),this.m_targetArea+=box2d.b2CrossVV(o,r),t.Initialize(a,n,o,r),this.m_joints[i]=e.world.CreateJoint(t)}this.m_targetArea*=.5},goog.inherits(box2d.b2AreaJoint,box2d.b2Joint),box2d.b2AreaJoint.prototype.m_bodies=null,box2d.b2AreaJoint.prototype.m_frequencyHz=0,box2d.b2AreaJoint.prototype.m_dampingRatio=0,box2d.b2AreaJoint.prototype.m_impulse=0,box2d.b2AreaJoint.prototype.m_targetLengths=null,box2d.b2AreaJoint.prototype.m_targetArea=0,box2d.b2AreaJoint.prototype.m_normals=null,box2d.b2AreaJoint.prototype.m_joints=null,box2d.b2AreaJoint.prototype.m_deltas=null,box2d.b2AreaJoint.prototype.m_delta=null,box2d.b2AreaJoint.prototype.GetAnchorA=function(e){return e.SetZero()},box2d.b2AreaJoint.prototype.GetAnchorB=function(e){return e.SetZero()},box2d.b2AreaJoint.prototype.GetReactionForce=function(e,t){return t.SetZero()},box2d.b2AreaJoint.prototype.GetReactionTorque=function(){return 0},box2d.b2AreaJoint.prototype.SetFrequency=function(e){this.m_frequencyHz=e;for(var t=0,i=this.m_joints.length;i>t;++t)this.m_joints[t].SetFrequency(e)},box2d.b2AreaJoint.prototype.GetFrequency=function(){return this.m_frequencyHz},box2d.b2AreaJoint.prototype.SetDampingRatio=function(e){this.m_dampingRatio=e;for(var t=0,i=this.m_joints.length;i>t;++t)this.m_joints[t].SetDampingRatio(e)},box2d.b2AreaJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio},box2d.b2AreaJoint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("Area joint dumping is not supported.\n")},box2d.b2AreaJoint.prototype.InitVelocityConstraints=function(e){for(var t=0,i=this.m_bodies.length;i>t;++t){var s=this.m_bodies[(t+i-1)%i],a=this.m_bodies[(t+1)%i],n=e.positions[s.m_islandIndex].c,o=e.positions[a.m_islandIndex].c,r=this.m_deltas[t];box2d.b2SubVV(o,n,r)}if(e.step.warmStarting){this.m_impulse*=e.step.dtRatio;for(var t=0,i=this.m_bodies.length;i>t;++t){var l=this.m_bodies[t],h=e.velocities[l.m_islandIndex].v,r=this.m_deltas[t];h.x+=l.m_invMass*r.y*.5*this.m_impulse,h.y+=l.m_invMass*-r.x*.5*this.m_impulse}}else this.m_impulse=0},box2d.b2AreaJoint.prototype.SolveVelocityConstraints=function(e){for(var t=0,i=0,s=0,a=this.m_bodies.length;a>s;++s){var n=this.m_bodies[s],o=e.velocities[n.m_islandIndex].v;t+=(l=this.m_deltas[s]).GetLengthSquared()/n.GetMass(),i+=box2d.b2CrossVV(o,l)}var r=-2*i/t;this.m_impulse+=r;for(var s=0,a=this.m_bodies.length;a>s;++s){var n=this.m_bodies[s],o=e.velocities[n.m_islandIndex].v,l=this.m_deltas[s];o.x+=n.m_invMass*l.y*.5*r,o.y+=n.m_invMass*-l.x*.5*r}},box2d.b2AreaJoint.prototype.SolvePositionConstraints=function(e){for(var t=0,i=0,s=0,a=this.m_bodies.length;a>s;++s){var n=this.m_bodies[s],o=this.m_bodies[(s+1)%a],r=e.positions[n.m_islandIndex].c,l=e.positions[o.m_islandIndex].c,h=(u=box2d.b2SubVV(l,r,this.m_delta)).GetLength();h<box2d.b2_epsilon&&(h=1),this.m_normals[s].x=u.y/h,this.m_normals[s].y=-u.x/h,t+=h,i+=box2d.b2CrossVV(r,l)}i*=.5;for(var c=.5*(this.m_targetArea-i)/t,p=!0,s=0,a=this.m_bodies.length;a>s;++s){var n=this.m_bodies[s],r=e.positions[n.m_islandIndex].c,d=(s+1)%a,u=box2d.b2AddVV(this.m_normals[s],this.m_normals[d],this.m_delta);u.SelfMul(c);var m=u.GetLengthSquared();m>box2d.b2Sq(box2d.b2_maxLinearCorrection)&&u.SelfMul(box2d.b2_maxLinearCorrection/box2d.b2Sqrt(m)),m>box2d.b2Sq(box2d.b2_linearSlop)&&(p=!1),r.x+=u.x,r.y+=u.y}return p},goog.provide("box2d.b2BuoyancyController"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Controller"),goog.require("box2d.b2Math"),goog.require("box2d.b2WorldCallbacks"),box2d.b2BuoyancyController=function(){goog.base(this),this.normal=new box2d.b2Vec2(0,1),this.velocity=new box2d.b2Vec2(0,0),this.gravity=new box2d.b2Vec2(0,0)},goog.inherits(box2d.b2BuoyancyController,box2d.b2Controller),box2d.b2BuoyancyController.prototype.normal=null,box2d.b2BuoyancyController.prototype.offset=0,box2d.b2BuoyancyController.prototype.density=0,box2d.b2BuoyancyController.prototype.velocity=null,box2d.b2BuoyancyController.prototype.linearDrag=0,box2d.b2BuoyancyController.prototype.angularDrag=0,box2d.b2BuoyancyController.prototype.useDensity=!1,box2d.b2BuoyancyController.prototype.useWorldGravity=!0,box2d.b2BuoyancyController.prototype.gravity=null,box2d.b2BuoyancyController.prototype.Step=function(){if(this.m_bodyList){this.useWorldGravity&&this.gravity.Copy(this.GetWorld().GetGravity());for(var e=this.m_bodyList;e;e=e.nextBody){var t=e.body;if(!1!==t.IsAwake()){for(var i=new box2d.b2Vec2,s=new box2d.b2Vec2,a=0,n=0,o=t.GetFixtureList();o;o=o.m_next){var r=new box2d.b2Vec2,l=o.GetShape().ComputeSubmergedArea(this.normal,this.offset,t.GetTransform(),r);a+=l,i.x+=l*r.x,i.y+=l*r.y;var h=0;n+=l*(h=this.useDensity?o.GetDensity():1),s.x+=l*r.x*h,s.y+=l*r.y*h}if(i.x/=a,i.y/=a,s.x/=n,s.y/=n,!(a<box2d.b2_epsilon)){var c=box2d.b2NegV(this.gravity,new box2d.b2Vec2);c.SelfMul(this.density*a),t.ApplyForce(c,s);var p=t.GetLinearVelocityFromWorldPoint(i,new box2d.b2Vec2);p.SelfSub(this.velocity),p.SelfMul(-this.linearDrag*a),t.ApplyForce(p,i),t.ApplyTorque(-t.GetInertia()/t.GetMass()*a*t.GetAngularVelocity()*this.angularDrag)}}}}},box2d.b2BuoyancyController.prototype.Draw=function(e){var t=100,i=new box2d.b2Vec2,s=new box2d.b2Vec2;i.x=this.normal.x*this.offset+this.normal.y*t,i.y=this.normal.y*this.offset-this.normal.x*t,s.x=this.normal.x*this.offset-this.normal.y*t,s.y=this.normal.y*this.offset+this.normal.x*t;var a=new box2d.b2Color(0,0,.8);e.DrawSegment(i,s,a)},goog.provide("box2d.b2TensorDampingController"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Controller"),goog.require("box2d.b2Math"),box2d.b2TensorDampingController=function(){goog.base(this),this.T=new box2d.b2Mat22,this.maxTimestep=0},goog.inherits(box2d.b2TensorDampingController,box2d.b2Controller),box2d.b2TensorDampingController.prototype.T=new box2d.b2Mat22,box2d.b2TensorDampingController.prototype.maxTimestep=0,box2d.b2TensorDampingController.prototype.Step=function(e){var t=e.dt;if(!(t<=box2d.b2_epsilon)){t>this.maxTimestep&&this.maxTimestep>0&&(t=this.maxTimestep);for(var i=this.m_bodyList;i;i=i.nextBody){var s=i.body;if(s.IsAwake()){var a=s.GetWorldVector(box2d.b2MulMV(this.T,s.GetLocalVector(s.GetLinearVelocity(),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1),box2d.b2TensorDampingController.prototype.Step.s_damping);s.SetLinearVelocity(box2d.b2AddVV(s.GetLinearVelocity(),box2d.b2MulSV(t,a,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t1))}}}},box2d.b2TensorDampingController.prototype.Step.s_damping=new box2d.b2Vec2,box2d.b2TensorDampingController.prototype.SetAxisAligned=function(e,t){this.T.ex.x=-e,this.T.ex.y=0,this.T.ey.x=0,this.T.ey.y=-t,this.maxTimestep=e>0||t>0?1/box2d.b2Max(e,t):0},goog.provide("box2d.b2DistanceJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Joint"),goog.require("box2d.b2Math"),box2d.b2DistanceJointDef=function(){goog.base(this,box2d.b2JointType.e_distanceJoint),this.localAnchorA=new box2d.b2Vec2,this.localAnchorB=new box2d.b2Vec2},goog.inherits(box2d.b2DistanceJointDef,box2d.b2JointDef),box2d.b2DistanceJointDef.prototype.localAnchorA=null,box2d.b2DistanceJointDef.prototype.localAnchorB=null,box2d.b2DistanceJointDef.prototype.length=1,box2d.b2DistanceJointDef.prototype.frequencyHz=0,box2d.b2DistanceJointDef.prototype.dampingRatio=0,box2d.b2DistanceJointDef.prototype.Initialize=function(e,t,i,s){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(s,this.localAnchorB),this.length=box2d.b2DistanceVV(i,s),this.frequencyHz=0,this.dampingRatio=0},box2d.b2DistanceJoint=function(e){goog.base(this,e),this.m_u=new box2d.b2Vec2,this.m_rA=new box2d.b2Vec2,this.m_rB=new box2d.b2Vec2,this.m_localCenterA=new box2d.b2Vec2,this.m_localCenterB=new box2d.b2Vec2,this.m_qA=new box2d.b2Rot,this.m_qB=new box2d.b2Rot,this.m_lalcA=new box2d.b2Vec2,this.m_lalcB=new box2d.b2Vec2,this.m_frequencyHz=e.frequencyHz,this.m_dampingRatio=e.dampingRatio,this.m_localAnchorA=e.localAnchorA.Clone(),this.m_localAnchorB=e.localAnchorB.Clone(),this.m_length=e.length},goog.inherits(box2d.b2DistanceJoint,box2d.b2Joint),box2d.b2DistanceJoint.prototype.m_frequencyHz=0,box2d.b2DistanceJoint.prototype.m_dampingRatio=0,box2d.b2DistanceJoint.prototype.m_bias=0,box2d.b2DistanceJoint.prototype.m_localAnchorA=null,box2d.b2DistanceJoint.prototype.m_localAnchorB=null,box2d.b2DistanceJoint.prototype.m_gamma=0,box2d.b2DistanceJoint.prototype.m_impulse=0,box2d.b2DistanceJoint.prototype.m_length=0,box2d.b2DistanceJoint.prototype.m_indexA=0,box2d.b2DistanceJoint.prototype.m_indexB=0,box2d.b2DistanceJoint.prototype.m_u=null,box2d.b2DistanceJoint.prototype.m_rA=null,box2d.b2DistanceJoint.prototype.m_rB=null,box2d.b2DistanceJoint.prototype.m_localCenterA=null,box2d.b2DistanceJoint.prototype.m_localCenterB=null,box2d.b2DistanceJoint.prototype.m_invMassA=0,box2d.b2DistanceJoint.prototype.m_invMassB=0,box2d.b2DistanceJoint.prototype.m_invIA=0,box2d.b2DistanceJoint.prototype.m_invIB=0,box2d.b2DistanceJoint.prototype.m_mass=0,box2d.b2DistanceJoint.prototype.m_qA=null,box2d.b2DistanceJoint.prototype.m_qB=null,box2d.b2DistanceJoint.prototype.m_lalcA=null,box2d.b2DistanceJoint.prototype.m_lalcB=null,box2d.b2DistanceJoint.prototype.GetAnchorA=function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)},box2d.b2DistanceJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)},box2d.b2DistanceJoint.prototype.GetReactionForce=function(e,t){return t.SetXY(e*this.m_impulse*this.m_u.x,e*this.m_impulse*this.m_u.y)},box2d.b2DistanceJoint.prototype.GetReactionTorque=function(){return 0},box2d.b2DistanceJoint.prototype.GetLocalAnchorA=function(e){return e.Copy(this.m_localAnchorA)},box2d.b2DistanceJoint.prototype.GetLocalAnchorB=function(e){return e.Copy(this.m_localAnchorB)},box2d.b2DistanceJoint.prototype.SetLength=function(e){this.m_length=e},box2d.b2DistanceJoint.prototype.GetLength=function(){return this.m_length},box2d.b2DistanceJoint.prototype.SetFrequency=function(e){this.m_frequencyHz=e},box2d.b2DistanceJoint.prototype.GetFrequency=function(){return this.m_frequencyHz},box2d.b2DistanceJoint.prototype.SetDampingRatio=function(e){this.m_dampingRatio=e},box2d.b2DistanceJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio},box2d.b2DistanceJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,t=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2DistanceJointDef*/ var jd = new box2d.b2DistanceJointDef();\n"),box2d.b2Log("  jd.bodyA = bodies[%d];\n",e),box2d.b2Log("  jd.bodyB = bodies[%d];\n",t),box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),box2d.b2Log("  jd.length = %.15f;\n",this.m_length),box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},box2d.b2DistanceJoint.prototype.InitVelocityConstraints=function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.velocities[this.m_indexA].v,a=e.velocities[this.m_indexA].w,n=e.positions[this.m_indexB].c,o=e.positions[this.m_indexB].a,r=e.velocities[this.m_indexB].v,l=e.velocities[this.m_indexB].w,h=this.m_qA.SetAngleRadians(i),c=this.m_qB.SetAngleRadians(o);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),box2d.b2MulRV(h,this.m_lalcA,this.m_rA),box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),box2d.b2MulRV(c,this.m_lalcB,this.m_rB),this.m_u.x=n.x+this.m_rB.x-t.x-this.m_rA.x,this.m_u.y=n.y+this.m_rB.y-t.y-this.m_rA.y;var p=this.m_u.GetLength();p>box2d.b2_linearSlop?this.m_u.SelfMul(1/p):this.m_u.SetZero();var d=box2d.b2CrossVV(this.m_rA,this.m_u),u=box2d.b2CrossVV(this.m_rB,this.m_u),m=this.m_invMassA+this.m_invIA*d*d+this.m_invMassB+this.m_invIB*u*u;if(this.m_mass=0!==m?1/m:0,this.m_frequencyHz>0){var g=p-this.m_length,y=2*box2d.b2_pi*this.m_frequencyHz,b=2*this.m_mass*this.m_dampingRatio*y,x=this.m_mass*y*y,v=e.step.dt;this.m_gamma=v*(b+v*x),this.m_gamma=0!==this.m_gamma?1/this.m_gamma:0,this.m_bias=g*v*x*this.m_gamma,m+=this.m_gamma,this.m_mass=0!==m?1/m:0}else this.m_gamma=0,this.m_bias=0;if(e.step.warmStarting){this.m_impulse*=e.step.dtRatio;var f=box2d.b2MulSV(this.m_impulse,this.m_u,box2d.b2DistanceJoint.prototype.InitVelocityConstraints.s_P);s.SelfMulSub(this.m_invMassA,f),a-=this.m_invIA*box2d.b2CrossVV(this.m_rA,f),r.SelfMulAdd(this.m_invMassB,f),l+=this.m_invIB*box2d.b2CrossVV(this.m_rB,f)}else this.m_impulse=0;e.velocities[this.m_indexA].w=a,e.velocities[this.m_indexB].w=l},box2d.b2DistanceJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints=function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,n=box2d.b2AddVCrossSV(t,i,this.m_rA,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpA),o=box2d.b2AddVCrossSV(s,a,this.m_rB,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpB),r=box2d.b2DotVV(this.m_u,box2d.b2SubVV(o,n,box2d.b2Vec2.s_t0)),l=-this.m_mass*(r+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=l;var h=box2d.b2MulSV(l,this.m_u,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_P);t.SelfMulSub(this.m_invMassA,h),i-=this.m_invIA*box2d.b2CrossVV(this.m_rA,h),s.SelfMulAdd(this.m_invMassB,h),a+=this.m_invIB*box2d.b2CrossVV(this.m_rB,h),e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=a},box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2,box2d.b2DistanceJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2DistanceJoint.prototype.SolvePositionConstraints=function(e){if(this.m_frequencyHz>0)return!0;var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.positions[this.m_indexB].c,a=e.positions[this.m_indexB].a,n=(this.m_qA.SetAngleRadians(i),this.m_qB.SetAngleRadians(a),box2d.b2MulRV(this.m_qA,this.m_lalcA,this.m_rA)),o=box2d.b2MulRV(this.m_qB,this.m_lalcB,this.m_rB),r=this.m_u;r.x=s.x+o.x-t.x-n.x,r.y=s.y+o.y-t.y-n.y;var l=this.m_u.Normalize()-this.m_length;l=box2d.b2Clamp(l,-box2d.b2_maxLinearCorrection,box2d.b2_maxLinearCorrection);var h=-this.m_mass*l,c=box2d.b2MulSV(h,r,box2d.b2DistanceJoint.prototype.SolvePositionConstraints.s_P);return t.SelfMulSub(this.m_invMassA,c),i-=this.m_invIA*box2d.b2CrossVV(n,c),s.SelfMulAdd(this.m_invMassB,c),a+=this.m_invIB*box2d.b2CrossVV(o,c),e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=a,box2d.b2Abs(l)<box2d.b2_linearSlop},box2d.b2DistanceJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2,goog.provide("box2d.b2FrictionJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Joint"),goog.require("box2d.b2Math"),box2d.b2FrictionJointDef=function(){goog.base(this,box2d.b2JointType.e_frictionJoint),this.localAnchorA=new box2d.b2Vec2,this.localAnchorB=new box2d.b2Vec2},goog.inherits(box2d.b2FrictionJointDef,box2d.b2JointDef),box2d.b2FrictionJointDef.prototype.localAnchorA=null,box2d.b2FrictionJointDef.prototype.localAnchorB=null,box2d.b2FrictionJointDef.prototype.maxForce=0,box2d.b2FrictionJointDef.prototype.maxTorque=0,box2d.b2FrictionJointDef.prototype.Initialize=function(e,t,i){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB)},box2d.b2FrictionJoint=function(e){goog.base(this,e),this.m_localAnchorA=e.localAnchorA.Clone(),this.m_localAnchorB=e.localAnchorB.Clone(),this.m_linearImpulse=(new box2d.b2Vec2).SetZero(),this.m_maxForce=e.maxForce,this.m_maxTorque=e.maxTorque,this.m_rA=new box2d.b2Vec2,this.m_rB=new box2d.b2Vec2,this.m_localCenterA=new box2d.b2Vec2,this.m_localCenterB=new box2d.b2Vec2,this.m_linearMass=(new box2d.b2Mat22).SetZero(),this.m_qA=new box2d.b2Rot,this.m_qB=new box2d.b2Rot,this.m_lalcA=new box2d.b2Vec2,this.m_lalcB=new box2d.b2Vec2,this.m_K=new box2d.b2Mat22},goog.inherits(box2d.b2FrictionJoint,box2d.b2Joint),box2d.b2FrictionJoint.prototype.m_localAnchorA=null,box2d.b2FrictionJoint.prototype.m_localAnchorB=null,box2d.b2FrictionJoint.prototype.m_linearImpulse=null,box2d.b2FrictionJoint.prototype.m_angularImpulse=0,box2d.b2FrictionJoint.prototype.m_maxForce=0,box2d.b2FrictionJoint.prototype.m_maxTorque=0,box2d.b2FrictionJoint.prototype.m_indexA=0,box2d.b2FrictionJoint.prototype.m_indexB=0,box2d.b2FrictionJoint.prototype.m_rA=null,box2d.b2FrictionJoint.prototype.m_rB=null,box2d.b2FrictionJoint.prototype.m_localCenterA=null,box2d.b2FrictionJoint.prototype.m_localCenterB=null,box2d.b2FrictionJoint.prototype.m_invMassA=0,box2d.b2FrictionJoint.prototype.m_invMassB=0,box2d.b2FrictionJoint.prototype.m_invIA=0,box2d.b2FrictionJoint.prototype.m_invIB=0,box2d.b2FrictionJoint.prototype.m_linearMass=null,box2d.b2FrictionJoint.prototype.m_angularMass=0,box2d.b2FrictionJoint.prototype.m_qA=null,box2d.b2FrictionJoint.prototype.m_qB=null,box2d.b2FrictionJoint.prototype.m_lalcA=null,box2d.b2FrictionJoint.prototype.m_lalcB=null,box2d.b2FrictionJoint.prototype.m_K=null,box2d.b2FrictionJoint.prototype.InitVelocityConstraints=function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].a,i=e.velocities[this.m_indexA].v,s=e.velocities[this.m_indexA].w,a=e.positions[this.m_indexB].a,n=e.velocities[this.m_indexB].v,o=e.velocities[this.m_indexB].w,r=this.m_qA.SetAngleRadians(t),l=this.m_qB.SetAngleRadians(a);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var h=box2d.b2MulRV(r,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var c=box2d.b2MulRV(l,this.m_lalcB,this.m_rB),p=this.m_invMassA,d=this.m_invMassB,u=this.m_invIA,m=this.m_invIB,g=this.m_K;if(g.ex.x=p+d+u*h.y*h.y+m*c.y*c.y,g.ex.y=-u*h.x*h.y-m*c.x*c.y,g.ey.x=g.ex.y,g.ey.y=p+d+u*h.x*h.x+m*c.x*c.x,g.GetInverse(this.m_linearMass),this.m_angularMass=u+m,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),e.step.warmStarting){this.m_linearImpulse.SelfMul(e.step.dtRatio),this.m_angularImpulse*=e.step.dtRatio;var y=this.m_linearImpulse;i.SelfMulSub(p,y),s-=u*(box2d.b2CrossVV(this.m_rA,y)+this.m_angularImpulse),n.SelfMulAdd(d,y),o+=m*(box2d.b2CrossVV(this.m_rB,y)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;e.velocities[this.m_indexA].w=s,e.velocities[this.m_indexB].w=o},box2d.b2FrictionJoint.prototype.SolveVelocityConstraints=function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,n=this.m_invMassA,o=this.m_invMassB,r=this.m_invIA,l=this.m_invIB,h=e.step.dt,c=a-i,p=-this.m_angularMass*c,d=this.m_angularImpulse,u=h*this.m_maxTorque;this.m_angularImpulse=box2d.b2Clamp(this.m_angularImpulse+p,-u,u),i-=r*(p=this.m_angularImpulse-d),a+=l*p;var c=box2d.b2SubVV(box2d.b2AddVCrossSV(s,a,this.m_rB,box2d.b2Vec2.s_t0),box2d.b2AddVCrossSV(t,i,this.m_rA,box2d.b2Vec2.s_t1),box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_Cdot),m=box2d.b2MulMV(this.m_linearMass,c,box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_impulseV).SelfNeg(),g=box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_oldImpulseV.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(m);u=h*this.m_maxForce;this.m_linearImpulse.GetLengthSquared()>u*u&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(u)),box2d.b2SubVV(this.m_linearImpulse,g,m),t.SelfMulSub(n,m),i-=r*box2d.b2CrossVV(this.m_rA,m),s.SelfMulAdd(o,m),a+=l*box2d.b2CrossVV(this.m_rB,m),e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=a},box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2,box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_impulseV=new box2d.b2Vec2,box2d.b2FrictionJoint.prototype.SolveVelocityConstraints.s_oldImpulseV=new box2d.b2Vec2,box2d.b2FrictionJoint.prototype.SolvePositionConstraints=function(){return!0},box2d.b2FrictionJoint.prototype.GetAnchorA=function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)},box2d.b2FrictionJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)},box2d.b2FrictionJoint.prototype.GetReactionForce=function(e,t){return t.SetXY(e*this.m_linearImpulse.x,e*this.m_linearImpulse.y)},box2d.b2FrictionJoint.prototype.GetReactionTorque=function(e){return e*this.m_angularImpulse},box2d.b2FrictionJoint.prototype.GetLocalAnchorA=function(e){return e.Copy(this.m_localAnchorA)},box2d.b2FrictionJoint.prototype.GetLocalAnchorB=function(e){return e.Copy(this.m_localAnchorB)},box2d.b2FrictionJoint.prototype.SetMaxForce=function(e){this.m_maxForce=e},box2d.b2FrictionJoint.prototype.GetMaxForce=function(){return this.m_maxForce},box2d.b2FrictionJoint.prototype.SetMaxTorque=function(e){this.m_maxTorque=e},box2d.b2FrictionJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque},box2d.b2FrictionJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,t=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2FrictionJointDef*/ var jd = new box2d.b2FrictionJointDef();\n"),box2d.b2Log("  jd.bodyA = bodies[%d];\n",e),box2d.b2Log("  jd.bodyB = bodies[%d];\n",t),box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),box2d.b2Log("  jd.maxForce = %.15f;\n",this.m_maxForce),box2d.b2Log("  jd.maxTorque = %.15f;\n",this.m_maxTorque),box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},goog.provide("box2d.b2MouseJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Joint"),goog.require("box2d.b2Math"),box2d.b2MouseJointDef=function(){goog.base(this,box2d.b2JointType.e_mouseJoint),this.target=new box2d.b2Vec2},goog.inherits(box2d.b2MouseJointDef,box2d.b2JointDef),box2d.b2MouseJointDef.prototype.target=null,box2d.b2MouseJointDef.prototype.maxForce=0,box2d.b2MouseJointDef.prototype.frequencyHz=5,box2d.b2MouseJointDef.prototype.dampingRatio=.7,box2d.b2MouseJoint=function(e){goog.base(this,e),this.m_localAnchorB=new box2d.b2Vec2,this.m_targetA=new box2d.b2Vec2,this.m_impulse=new box2d.b2Vec2,this.m_rB=new box2d.b2Vec2,this.m_localCenterB=new box2d.b2Vec2,this.m_mass=new box2d.b2Mat22,this.m_C=new box2d.b2Vec2,this.m_qB=new box2d.b2Rot,this.m_lalcB=new box2d.b2Vec2,this.m_K=new box2d.b2Mat22,box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.target.IsValid()),box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.maxForce)&&e.maxForce>=0),box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.frequencyHz)&&e.frequencyHz>=0),box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e.dampingRatio)&&e.dampingRatio>=0),this.m_targetA.Copy(e.target),box2d.b2MulTXV(this.m_bodyB.GetTransform(),this.m_targetA,this.m_localAnchorB),this.m_maxForce=e.maxForce,this.m_impulse.SetZero(),this.m_frequencyHz=e.frequencyHz,this.m_dampingRatio=e.dampingRatio,this.m_beta=0,this.m_gamma=0},goog.inherits(box2d.b2MouseJoint,box2d.b2Joint),box2d.b2MouseJoint.prototype.m_localAnchorB=null,box2d.b2MouseJoint.prototype.m_targetA=null,box2d.b2MouseJoint.prototype.m_frequencyHz=0,box2d.b2MouseJoint.prototype.m_dampingRatio=0,box2d.b2MouseJoint.prototype.m_beta=0,box2d.b2MouseJoint.prototype.m_impulse=null,box2d.b2MouseJoint.prototype.m_maxForce=0,box2d.b2MouseJoint.prototype.m_gamma=0,box2d.b2MouseJoint.prototype.m_indexA=0,box2d.b2MouseJoint.prototype.m_indexB=0,box2d.b2MouseJoint.prototype.m_rB=null,box2d.b2MouseJoint.prototype.m_localCenterB=null,box2d.b2MouseJoint.prototype.m_invMassB=0,box2d.b2MouseJoint.prototype.m_invIB=0,box2d.b2MouseJoint.prototype.m_mass=null,box2d.b2MouseJoint.prototype.m_C=null,box2d.b2MouseJoint.prototype.m_qB=null,box2d.b2MouseJoint.prototype.m_lalcB=null,box2d.b2MouseJoint.prototype.m_K=null,box2d.b2MouseJoint.prototype.SetTarget=function(e){!1===this.m_bodyB.IsAwake()&&this.m_bodyB.SetAwake(!0),this.m_targetA.Copy(e)},box2d.b2MouseJoint.prototype.GetTarget=function(e){return e.Copy(this.m_targetA)},box2d.b2MouseJoint.prototype.SetMaxForce=function(e){this.m_maxForce=e},box2d.b2MouseJoint.prototype.GetMaxForce=function(){return this.m_maxForce},box2d.b2MouseJoint.prototype.SetFrequency=function(e){this.m_frequencyHz=e},box2d.b2MouseJoint.prototype.GetFrequency=function(){return this.m_frequencyHz},box2d.b2MouseJoint.prototype.SetDampingRatio=function(e){this.m_dampingRatio=e},box2d.b2MouseJoint.prototype.GetDampingRatio=function(){return this.m_dampingRatio},box2d.b2MouseJoint.prototype.InitVelocityConstraints=function(e){this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexB].c,i=e.positions[this.m_indexB].a,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,n=this.m_qB.SetAngleRadians(i),o=this.m_bodyB.GetMass(),r=2*box2d.b2_pi*this.m_frequencyHz,l=2*o*this.m_dampingRatio*r,h=o*r*r,c=e.step.dt;box2d.ENABLE_ASSERTS&&box2d.b2Assert(l+c*h>box2d.b2_epsilon),this.m_gamma=c*(l+c*h),0!==this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=c*h*this.m_gamma,box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),box2d.b2MulRV(n,this.m_lalcB,this.m_rB);var p=this.m_K;p.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,p.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,p.ey.x=p.ex.y,p.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,p.GetInverse(this.m_mass),this.m_C.x=t.x+this.m_rB.x-this.m_targetA.x,this.m_C.y=t.y+this.m_rB.y-this.m_targetA.y,this.m_C.SelfMul(this.m_beta),a*=.98,e.step.warmStarting?(this.m_impulse.SelfMul(e.step.dtRatio),s.x+=this.m_invMassB*this.m_impulse.x,s.y+=this.m_invMassB*this.m_impulse.y,a+=this.m_invIB*box2d.b2CrossVV(this.m_rB,this.m_impulse)):this.m_impulse.SetZero(),e.velocities[this.m_indexB].w=a},box2d.b2MouseJoint.prototype.SolveVelocityConstraints=function(e){var t=e.velocities[this.m_indexB].v,i=e.velocities[this.m_indexB].w,s=box2d.b2AddVCrossSV(t,i,this.m_rB,box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_Cdot),a=box2d.b2MulMV(this.m_mass,box2d.b2AddVV(s,box2d.b2AddVV(this.m_C,box2d.b2MulSV(this.m_gamma,this.m_impulse,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0).SelfNeg(),box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_impulse),n=box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_oldImpulse.Copy(this.m_impulse);this.m_impulse.SelfAdd(a);var o=e.step.dt*this.m_maxForce;this.m_impulse.GetLengthSquared()>o*o&&this.m_impulse.SelfMul(o/this.m_impulse.GetLength()),box2d.b2SubVV(this.m_impulse,n,a),t.SelfMulAdd(this.m_invMassB,a),i+=this.m_invIB*box2d.b2CrossVV(this.m_rB,a),e.velocities[this.m_indexB].w=i},box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2,box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec2,box2d.b2MouseJoint.prototype.SolveVelocityConstraints.s_oldImpulse=new box2d.b2Vec2,box2d.b2MouseJoint.prototype.SolvePositionConstraints=function(){return!0},box2d.b2MouseJoint.prototype.GetAnchorA=function(e){return e.Copy(this.m_targetA)},box2d.b2MouseJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)},box2d.b2MouseJoint.prototype.GetReactionForce=function(e,t){return box2d.b2MulSV(e,this.m_impulse,t)},box2d.b2MouseJoint.prototype.GetReactionTorque=function(){return 0},box2d.b2MouseJoint.prototype.Dump=function(){box2d.DEBUG&&box2d.b2Log("Mouse joint dumping is not supported.\n")},box2d.b2MouseJoint.prototype.ShiftOrigin=function(e){this.m_targetA.SelfSub(e)},goog.provide("box2d.b2ConstantForceController"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Controller"),goog.require("box2d.b2Math"),box2d.b2ConstantForceController=function(){goog.base(this),this.F=new box2d.b2Vec2(0,0)},goog.inherits(box2d.b2ConstantForceController,box2d.b2Controller),box2d.b2ConstantAccelController.prototype.F=null,box2d.b2ConstantForceController.prototype.Step=function(){for(var e=this.m_bodyList;e;e=e.nextBody){var t=e.body;t.IsAwake()&&t.ApplyForce(this.F,t.GetWorldCenter())}},goog.provide("box2d.b2PulleyJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Joint"),goog.require("box2d.b2Math"),box2d.b2_minPulleyLength=2,box2d.b2PulleyJointDef=function(){goog.base(this,box2d.b2JointType.e_pulleyJoint),this.collideConnected=!0,this.groundAnchorA=new box2d.b2Vec2(-1,1),this.groundAnchorB=new box2d.b2Vec2(1,1),this.localAnchorA=new box2d.b2Vec2(-1,0),this.localAnchorB=new box2d.b2Vec2(1,0)},goog.inherits(box2d.b2PulleyJointDef,box2d.b2JointDef),box2d.b2PulleyJointDef.prototype.groundAnchorA=null,box2d.b2PulleyJointDef.prototype.groundAnchorB=null,box2d.b2PulleyJointDef.prototype.localAnchorA=null,box2d.b2PulleyJointDef.prototype.localAnchorB=null,box2d.b2PulleyJointDef.prototype.lengthA=0,box2d.b2PulleyJointDef.prototype.lengthB=0,box2d.b2PulleyJointDef.prototype.ratio=1,box2d.b2PulleyJointDef.prototype.Initialize=function(e,t,i,s,a,n,o){this.bodyA=e,this.bodyB=t,this.groundAnchorA.Copy(i),this.groundAnchorB.Copy(s),this.bodyA.GetLocalPoint(a,this.localAnchorA),this.bodyB.GetLocalPoint(n,this.localAnchorB),this.lengthA=box2d.b2DistanceVV(a,i),this.lengthB=box2d.b2DistanceVV(n,s),this.ratio=o,box2d.ENABLE_ASSERTS&&box2d.b2Assert(this.ratio>box2d.b2_epsilon)},box2d.b2PulleyJoint=function(e){goog.base(this,e),this.m_groundAnchorA=new box2d.b2Vec2,this.m_groundAnchorB=new box2d.b2Vec2,this.m_localAnchorA=new box2d.b2Vec2,this.m_localAnchorB=new box2d.b2Vec2,this.m_uA=new box2d.b2Vec2,this.m_uB=new box2d.b2Vec2,this.m_rA=new box2d.b2Vec2,this.m_rB=new box2d.b2Vec2,this.m_localCenterA=new box2d.b2Vec2,this.m_localCenterB=new box2d.b2Vec2,this.m_qA=new box2d.b2Rot,this.m_qB=new box2d.b2Rot,this.m_lalcA=new box2d.b2Vec2,this.m_lalcB=new box2d.b2Vec2,this.m_groundAnchorA.Copy(e.groundAnchorA),this.m_groundAnchorB.Copy(e.groundAnchorB),this.m_localAnchorA.Copy(e.localAnchorA),this.m_localAnchorB.Copy(e.localAnchorB),this.m_lengthA=e.lengthA,this.m_lengthB=e.lengthB,box2d.ENABLE_ASSERTS&&box2d.b2Assert(0!==e.ratio),this.m_ratio=e.ratio,this.m_constant=e.lengthA+this.m_ratio*e.lengthB,this.m_impulse=0},goog.inherits(box2d.b2PulleyJoint,box2d.b2Joint),box2d.b2PulleyJoint.prototype.m_groundAnchorA=null,box2d.b2PulleyJoint.prototype.m_groundAnchorB=null,box2d.b2PulleyJoint.prototype.m_lengthA=0,box2d.b2PulleyJoint.prototype.m_lengthB=0,box2d.b2PulleyJoint.prototype.m_localAnchorA=null,box2d.b2PulleyJoint.prototype.m_localAnchorB=null,box2d.b2PulleyJoint.prototype.m_constant=0,box2d.b2PulleyJoint.prototype.m_ratio=0,box2d.b2PulleyJoint.prototype.m_impulse=0,box2d.b2PulleyJoint.prototype.m_indexA=0,box2d.b2PulleyJoint.prototype.m_indexB=0,box2d.b2PulleyJoint.prototype.m_uA=null,box2d.b2PulleyJoint.prototype.m_uB=null,box2d.b2PulleyJoint.prototype.m_rA=null,box2d.b2PulleyJoint.prototype.m_rB=null,box2d.b2PulleyJoint.prototype.m_localCenterA=null,box2d.b2PulleyJoint.prototype.m_localCenterB=null,box2d.b2PulleyJoint.prototype.m_invMassA=0,box2d.b2PulleyJoint.prototype.m_invMassB=0,box2d.b2PulleyJoint.prototype.m_invIA=0,box2d.b2PulleyJoint.prototype.m_invIB=0,box2d.b2PulleyJoint.prototype.m_mass=0,box2d.b2PulleyJoint.prototype.m_qA=null,box2d.b2PulleyJoint.prototype.m_qB=null,box2d.b2PulleyJoint.prototype.m_lalcA=null,box2d.b2PulleyJoint.prototype.m_lalcB=null,box2d.b2PulleyJoint.prototype.InitVelocityConstraints=function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.velocities[this.m_indexA].v,a=e.velocities[this.m_indexA].w,n=e.positions[this.m_indexB].c,o=e.positions[this.m_indexB].a,r=e.velocities[this.m_indexB].v,l=e.velocities[this.m_indexB].w,h=this.m_qA.SetAngleRadians(i),c=this.m_qB.SetAngleRadians(o);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA),box2d.b2MulRV(h,this.m_lalcA,this.m_rA),box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB),box2d.b2MulRV(c,this.m_lalcB,this.m_rB),this.m_uA.Copy(t).SelfAdd(this.m_rA).SelfSub(this.m_groundAnchorA),this.m_uB.Copy(n).SelfAdd(this.m_rB).SelfSub(this.m_groundAnchorB);var p=this.m_uA.GetLength(),d=this.m_uB.GetLength();p>10*box2d.b2_linearSlop?this.m_uA.SelfMul(1/p):this.m_uA.SetZero(),d>10*box2d.b2_linearSlop?this.m_uB.SelfMul(1/d):this.m_uB.SetZero();var u=box2d.b2CrossVV(this.m_rA,this.m_uA),m=box2d.b2CrossVV(this.m_rB,this.m_uB),g=this.m_invMassA+this.m_invIA*u*u,y=this.m_invMassB+this.m_invIB*m*m;if(this.m_mass=g+this.m_ratio*this.m_ratio*y,this.m_mass>0&&(this.m_mass=1/this.m_mass),e.step.warmStarting){this.m_impulse*=e.step.dtRatio;var b=box2d.b2MulSV(-this.m_impulse,this.m_uA,box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PA),x=box2d.b2MulSV(-this.m_ratio*this.m_impulse,this.m_uB,box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PB);s.SelfMulAdd(this.m_invMassA,b),a+=this.m_invIA*box2d.b2CrossVV(this.m_rA,b),r.SelfMulAdd(this.m_invMassB,x),l+=this.m_invIB*box2d.b2CrossVV(this.m_rB,x)}else this.m_impulse=0;e.velocities[this.m_indexA].w=a,e.velocities[this.m_indexB].w=l},box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PA=new box2d.b2Vec2,box2d.b2PulleyJoint.prototype.InitVelocityConstraints.s_PB=new box2d.b2Vec2,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints=function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,n=box2d.b2AddVCrossSV(t,i,this.m_rA,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpA),o=box2d.b2AddVCrossSV(s,a,this.m_rB,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpB),r=-box2d.b2DotVV(this.m_uA,n)-this.m_ratio*box2d.b2DotVV(this.m_uB,o),l=-this.m_mass*r;this.m_impulse+=l;var h=box2d.b2MulSV(-l,this.m_uA,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PA),c=box2d.b2MulSV(-this.m_ratio*l,this.m_uB,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PB);t.SelfMulAdd(this.m_invMassA,h),i+=this.m_invIA*box2d.b2CrossVV(this.m_rA,h),s.SelfMulAdd(this.m_invMassB,c),a+=this.m_invIB*box2d.b2CrossVV(this.m_rB,c),e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=a},box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpA=new box2d.b2Vec2,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_vpB=new box2d.b2Vec2,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PA=new box2d.b2Vec2,box2d.b2PulleyJoint.prototype.SolveVelocityConstraints.s_PB=new box2d.b2Vec2,box2d.b2PulleyJoint.prototype.SolvePositionConstraints=function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.positions[this.m_indexB].c,a=e.positions[this.m_indexB].a,n=this.m_qA.SetAngleRadians(i),o=this.m_qB.SetAngleRadians(a);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var r=box2d.b2MulRV(n,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var l=box2d.b2MulRV(o,this.m_lalcB,this.m_rB),h=this.m_uA.Copy(t).SelfAdd(r).SelfSub(this.m_groundAnchorA),c=this.m_uB.Copy(s).SelfAdd(l).SelfSub(this.m_groundAnchorB),p=h.GetLength(),d=c.GetLength();p>10*box2d.b2_linearSlop?h.SelfMul(1/p):h.SetZero(),d>10*box2d.b2_linearSlop?c.SelfMul(1/d):c.SetZero();var u=box2d.b2CrossVV(r,h),m=box2d.b2CrossVV(l,c),g=this.m_invMassA+this.m_invIA*u*u,y=this.m_invMassB+this.m_invIB*m*m,b=g+this.m_ratio*this.m_ratio*y;b>0&&(b=1/b);var x=this.m_constant-p-this.m_ratio*d,v=box2d.b2Abs(x),f=-b*x,w=box2d.b2MulSV(-f,h,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PA),k=box2d.b2MulSV(-this.m_ratio*f,c,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PB);return t.SelfMulAdd(this.m_invMassA,w),i+=this.m_invIA*box2d.b2CrossVV(r,w),s.SelfMulAdd(this.m_invMassB,k),a+=this.m_invIB*box2d.b2CrossVV(l,k),e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=a,v<box2d.b2_linearSlop},box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PA=new box2d.b2Vec2,box2d.b2PulleyJoint.prototype.SolvePositionConstraints.s_PB=new box2d.b2Vec2,box2d.b2PulleyJoint.prototype.GetAnchorA=function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)},box2d.b2PulleyJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)},box2d.b2PulleyJoint.prototype.GetReactionForce=function(e,t){return t.SetXY(e*this.m_impulse*this.m_uB.x,e*this.m_impulse*this.m_uB.y)},box2d.b2PulleyJoint.prototype.GetReactionTorque=function(){return 0},box2d.b2PulleyJoint.prototype.GetGroundAnchorA=function(e){return e.Copy(this.m_groundAnchorA)},box2d.b2PulleyJoint.prototype.GetGroundAnchorB=function(e){return e.Copy(this.m_groundAnchorB)},box2d.b2PulleyJoint.prototype.GetLengthA=function(){return this.m_lengthA},box2d.b2PulleyJoint.prototype.GetLengthB=function(){return this.m_lengthB},box2d.b2PulleyJoint.prototype.GetRatio=function(){return this.m_ratio},box2d.b2PulleyJoint.prototype.GetCurrentLengthA=function(){var e=this.m_bodyA.GetWorldPoint(this.m_localAnchorA,box2d.b2PulleyJoint.prototype.GetCurrentLengthA.s_p),t=this.m_groundAnchorA;return box2d.b2DistanceVV(e,t)},box2d.b2PulleyJoint.prototype.GetCurrentLengthA.s_p=new box2d.b2Vec2,box2d.b2PulleyJoint.prototype.GetCurrentLengthB=function(){var e=this.m_bodyB.GetWorldPoint(this.m_localAnchorB,box2d.b2PulleyJoint.prototype.GetCurrentLengthB.s_p),t=this.m_groundAnchorB;return box2d.b2DistanceVV(e,t)},box2d.b2PulleyJoint.prototype.GetCurrentLengthB.s_p=new box2d.b2Vec2,box2d.b2PulleyJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,t=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2PulleyJointDef*/ var jd = new box2d.b2PulleyJointDef();\n"),box2d.b2Log("  jd.bodyA = bodies[%d];\n",e),box2d.b2Log("  jd.bodyB = bodies[%d];\n",t),box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),box2d.b2Log("  jd.groundAnchorA.SetXY(%.15f, %.15f);\n",this.m_groundAnchorA.x,this.m_groundAnchorA.y),box2d.b2Log("  jd.groundAnchorB.SetXY(%.15f, %.15f);\n",this.m_groundAnchorB.x,this.m_groundAnchorB.y),box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),box2d.b2Log("  jd.lengthA = %.15f;\n",this.m_lengthA),box2d.b2Log("  jd.lengthB = %.15f;\n",this.m_lengthB),box2d.b2Log("  jd.ratio = %.15f;\n",this.m_ratio),box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},box2d.b2PulleyJoint.prototype.ShiftOrigin=function(e){this.m_groundAnchorA.SelfSub(e),this.m_groundAnchorB.SelfSub(e)},goog.provide("box2d.b2CircleShape"),goog.require("box2d.b2Shape"),box2d.b2CircleShape=function(e){goog.base(this,box2d.b2ShapeType.e_circleShape,e||0),this.m_p=new box2d.b2Vec2},goog.inherits(box2d.b2CircleShape,box2d.b2Shape),box2d.b2CircleShape.prototype.m_p=null,box2d.b2CircleShape.prototype.Clone=function(){return(new box2d.b2CircleShape).Copy(this)},box2d.b2CircleShape.prototype.Copy=function(e){return goog.base(this,"Copy",e),box2d.ENABLE_ASSERTS&&box2d.b2Assert(e instanceof box2d.b2CircleShape),this.m_p.Copy(e.m_p),this},box2d.b2CircleShape.prototype.GetChildCount=function(){return 1},box2d.b2CircleShape.prototype.TestPoint=function(e,t){var i=box2d.b2MulXV(e,this.m_p,box2d.b2CircleShape.prototype.TestPoint.s_center),s=box2d.b2SubVV(t,i,box2d.b2CircleShape.prototype.TestPoint.s_d);return box2d.b2DotVV(s,s)<=box2d.b2Sq(this.m_radius)},box2d.b2CircleShape.prototype.TestPoint.s_center=new box2d.b2Vec2,box2d.b2CircleShape.prototype.TestPoint.s_d=new box2d.b2Vec2,box2d.b2CircleShape.prototype.RayCast=function(e,t,i){var s=box2d.b2MulXV(i,this.m_p,box2d.b2CircleShape.prototype.RayCast.s_position),a=box2d.b2SubVV(t.p1,s,box2d.b2CircleShape.prototype.RayCast.s_s),n=box2d.b2DotVV(a,a)-box2d.b2Sq(this.m_radius),o=box2d.b2SubVV(t.p2,t.p1,box2d.b2CircleShape.prototype.RayCast.s_r),r=box2d.b2DotVV(a,o),l=box2d.b2DotVV(o,o),h=r*r-l*n;if(0>h||l<box2d.b2_epsilon)return!1;var c=-(r+box2d.b2Sqrt(h));return c>=0&&c<=t.maxFraction*l&&(c/=l,e.fraction=c,box2d.b2AddVMulSV(a,c,o,e.normal).SelfNormalize(),!0)},box2d.b2CircleShape.prototype.RayCast.s_position=new box2d.b2Vec2,box2d.b2CircleShape.prototype.RayCast.s_s=new box2d.b2Vec2,box2d.b2CircleShape.prototype.RayCast.s_r=new box2d.b2Vec2,box2d.b2CircleShape.prototype.ComputeAABB=function(e,t){var i=box2d.b2MulXV(t,this.m_p,box2d.b2CircleShape.prototype.ComputeAABB.s_p);e.lowerBound.SetXY(i.x-this.m_radius,i.y-this.m_radius),e.upperBound.SetXY(i.x+this.m_radius,i.y+this.m_radius)},box2d.b2CircleShape.prototype.ComputeAABB.s_p=new box2d.b2Vec2,box2d.b2CircleShape.prototype.ComputeMass=function(e,t){var i=box2d.b2Sq(this.m_radius);e.mass=t*box2d.b2_pi*i,e.center.Copy(this.m_p),e.I=e.mass*(.5*i+box2d.b2DotVV(this.m_p,this.m_p))},box2d.b2CircleShape.prototype.SetupDistanceProxy=function(e){e.m_vertices=new Array(1,!0),e.m_vertices[0]=this.m_p,e.m_count=1,e.m_radius=this.m_radius},box2d.b2CircleShape.prototype.ComputeSubmergedArea=function(e,t,i,s){var a=box2d.b2MulXV(i,this.m_p,new box2d.b2Vec2),n=-(box2d.b2DotVV(e,a)-t);if(n<-this.m_radius+box2d.b2_epsilon)return 0;if(n>this.m_radius)return s.Copy(a),box2d.b2_pi*this.m_radius*this.m_radius;var o=this.m_radius*this.m_radius,r=n*n,l=o*(box2d.b2Asin(n/this.m_radius)+box2d.b2_pi/2)+n*box2d.b2Sqrt(o-r),h=-2/3*box2d.b2Pow(o-r,1.5)/l;return s.x=a.x+e.x*h,s.y=a.y+e.y*h,l},box2d.b2CircleShape.prototype.Dump=function(){box2d.b2Log("    /*box2d.b2CircleShape*/ var shape = new box2d.b2CircleShape();\n"),box2d.b2Log("    shape.m_radius = %.15f;\n",this.m_radius),box2d.b2Log("    shape.m_p.SetXY(%.15f, %.15f);\n",this.m_p.x,this.m_p.y)},goog.provide("box2d.b2Rope"),goog.require("box2d.b2Math"),goog.require("box2d.b2Draw"),box2d.b2RopeDef=function(){this.vertices=new Array,this.masses=new Array,this.gravity=new box2d.b2Vec2},box2d.b2RopeDef.prototype.vertices=null,box2d.b2RopeDef.prototype.count=0,box2d.b2RopeDef.prototype.masses=null,box2d.b2RopeDef.prototype.gravity=null,box2d.b2RopeDef.prototype.damping=.1,box2d.b2RopeDef.prototype.k2=.9,box2d.b2RopeDef.prototype.k3=.1,box2d.b2Rope=function(){this.m_gravity=new box2d.b2Vec2},box2d.b2Rope.prototype.m_count=0,box2d.b2Rope.prototype.m_ps=null,box2d.b2Rope.prototype.m_p0s=null,box2d.b2Rope.prototype.m_vs=null,box2d.b2Rope.prototype.m_ims=null,box2d.b2Rope.prototype.m_Ls=null,box2d.b2Rope.prototype.m_as=null,box2d.b2Rope.prototype.m_gravity=null,box2d.b2Rope.prototype.m_damping=0,box2d.b2Rope.prototype.m_k2=1,box2d.b2Rope.prototype.m_k3=.1,box2d.b2Rope.prototype.GetVertexCount=function(){return this.m_count},box2d.b2Rope.prototype.GetVertices=function(){return this.m_ps},box2d.b2Rope.prototype.Initialize=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(e.count>=3),this.m_count=e.count,this.m_ps=box2d.b2Vec2.MakeArray(this.m_count),this.m_p0s=box2d.b2Vec2.MakeArray(this.m_count),this.m_vs=box2d.b2Vec2.MakeArray(this.m_count),this.m_ims=box2d.b2MakeNumberArray(this.m_count);for(o=0;o<this.m_count;++o){this.m_ps[o].Copy(e.vertices[o]),this.m_p0s[o].Copy(e.vertices[o]),this.m_vs[o].SetZero();var t=e.masses[o];this.m_ims[o]=t>0?1/t:0}var i=this.m_count-1,s=this.m_count-2;this.m_Ls=box2d.b2MakeNumberArray(i),this.m_as=box2d.b2MakeNumberArray(s);for(o=0;i>o;++o){var a=this.m_ps[o],n=this.m_ps[o+1];this.m_Ls[o]=box2d.b2DistanceVV(a,n)}for(var o=0;s>o;++o){var a=this.m_ps[o],n=this.m_ps[o+1],r=this.m_ps[o+2],l=box2d.b2SubVV(n,a,box2d.b2Vec2.s_t0),h=box2d.b2SubVV(r,n,box2d.b2Vec2.s_t1),c=box2d.b2CrossVV(l,h),p=box2d.b2DotVV(l,h);this.m_as[o]=box2d.b2Atan2(c,p)}this.m_gravity.Copy(e.gravity),this.m_damping=e.damping,this.m_k2=e.k2,this.m_k3=e.k3},box2d.b2Rope.prototype.Step=function(e,t){if(0!==e){for(var i=Math.exp(-e*this.m_damping),s=0;s<this.m_count;++s)this.m_p0s[s].Copy(this.m_ps[s]),this.m_ims[s]>0&&this.m_vs[s].SelfMulAdd(e,this.m_gravity),this.m_vs[s].SelfMul(i),this.m_ps[s].SelfMulAdd(e,this.m_vs[s]);for(s=0;t>s;++s)this.SolveC2(),this.SolveC3(),this.SolveC2();for(var a=1/e,s=0;s<this.m_count;++s)box2d.b2MulSV(a,box2d.b2SubVV(this.m_ps[s],this.m_p0s[s],box2d.b2Vec2.s_t0),this.m_vs[s])}},box2d.b2Rope.prototype.SolveC2=function(){for(var e=this.m_count-1,t=0;e>t;++t){var i=this.m_ps[t],s=this.m_ps[t+1],a=box2d.b2SubVV(s,i,box2d.b2Rope.s_d),n=a.Normalize(),o=this.m_ims[t],r=this.m_ims[t+1];if(o+r!==0){var l=o/(o+r),h=r/(o+r);i.SelfMulSub(this.m_k2*l*(this.m_Ls[t]-n),a),s.SelfMulAdd(this.m_k2*h*(this.m_Ls[t]-n),a)}}},box2d.b2Rope.s_d=new box2d.b2Vec2,box2d.b2Rope.prototype.SetAngleRadians=function(e){for(var t=this.m_count-2,i=0;t>i;++i)this.m_as[i]=e},box2d.b2Rope.prototype.SolveC3=function(){for(var e=this.m_count-2,t=0;e>t;++t){var i=this.m_ps[t],s=this.m_ps[t+1],a=this.m_ps[t+2],n=this.m_ims[t],o=this.m_ims[t+1],r=this.m_ims[t+2],l=box2d.b2SubVV(s,i,box2d.b2Rope.s_d1),h=box2d.b2SubVV(a,s,box2d.b2Rope.s_d2),c=l.GetLengthSquared(),p=h.GetLengthSquared();if(c*p!=0){var d=box2d.b2CrossVV(l,h),u=box2d.b2DotVV(l,h),m=box2d.b2Atan2(d,u),g=box2d.b2MulSV(-1/c,l.SelfSkew(),box2d.b2Rope.s_Jd1),y=box2d.b2MulSV(1/p,h.SelfSkew(),box2d.b2Rope.s_Jd2),b=box2d.b2NegV(g,box2d.b2Rope.s_J1),x=box2d.b2SubVV(g,y,box2d.b2Rope.s_J2),v=y,f=n*box2d.b2DotVV(b,b)+o*box2d.b2DotVV(x,x)+r*box2d.b2DotVV(v,v);if(0!==f){f=1/f;for(var w=m-this.m_as[t];w>box2d.b2_pi;)m-=2*box2d.b2_pi,w=m-this.m_as[t];for(;w<-box2d.b2_pi;)m+=2*box2d.b2_pi,w=m-this.m_as[t];var k=-this.m_k3*f*w;i.SelfMulAdd(n*k,b),s.SelfMulAdd(o*k,x),a.SelfMulAdd(r*k,v)}}}},box2d.b2Rope.s_d1=new box2d.b2Vec2,box2d.b2Rope.s_d2=new box2d.b2Vec2,box2d.b2Rope.s_Jd1=new box2d.b2Vec2,box2d.b2Rope.s_Jd2=new box2d.b2Vec2,box2d.b2Rope.s_J1=new box2d.b2Vec2,box2d.b2Rope.s_J2=new box2d.b2Vec2,box2d.b2Rope.prototype.Draw=function(e){for(var t=new box2d.b2Color(.4,.5,.7),i=0;i<this.m_count-1;++i)e.DrawSegment(this.m_ps[i],this.m_ps[i+1],t)},goog.provide("box2d.b2WheelJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Math"),box2d.b2WheelJointDef=function(){goog.base(this,box2d.b2JointType.e_wheelJoint),this.localAnchorA=new box2d.b2Vec2(0,0),this.localAnchorB=new box2d.b2Vec2(0,0),this.localAxisA=new box2d.b2Vec2(1,0)},goog.inherits(box2d.b2WheelJointDef,box2d.b2JointDef),box2d.b2WheelJointDef.prototype.localAnchorA=null,box2d.b2WheelJointDef.prototype.localAnchorB=null,box2d.b2WheelJointDef.prototype.localAxisA=null,box2d.b2WheelJointDef.prototype.enableMotor=!1,box2d.b2WheelJointDef.prototype.maxMotorTorque=0,box2d.b2WheelJointDef.prototype.motorSpeed=0,box2d.b2WheelJointDef.prototype.frequencyHz=2,box2d.b2WheelJointDef.prototype.dampingRatio=.7,box2d.b2WheelJointDef.prototype.Initialize=function(e,t,i,s){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(i,this.localAnchorA),this.bodyB.GetLocalPoint(i,this.localAnchorB),this.bodyA.GetLocalVector(s,this.localAxisA)},box2d.b2WheelJoint=function(e){goog.base(this,e),this.m_frequencyHz=e.frequencyHz,this.m_dampingRatio=e.dampingRatio,this.m_localAnchorA=e.localAnchorA.Clone(),this.m_localAnchorB=e.localAnchorB.Clone(),this.m_localXAxisA=e.localAxisA.Clone(),this.m_localYAxisA=box2d.b2CrossOneV(this.m_localXAxisA,new box2d.b2Vec2),this.m_maxMotorTorque=e.maxMotorTorque,this.m_motorSpeed=e.motorSpeed,this.m_enableMotor=e.enableMotor,this.m_localCenterA=new box2d.b2Vec2,this.m_localCenterB=new box2d.b2Vec2,this.m_ax=new box2d.b2Vec2,this.m_ay=new box2d.b2Vec2,this.m_qA=new box2d.b2Rot,this.m_qB=new box2d.b2Rot,this.m_lalcA=new box2d.b2Vec2,this.m_lalcB=new box2d.b2Vec2,this.m_rA=new box2d.b2Vec2,this.m_rB=new box2d.b2Vec2,this.m_ax.SetZero(),this.m_ay.SetZero()},goog.inherits(box2d.b2WheelJoint,box2d.b2Joint),box2d.b2WheelJoint.prototype.m_frequencyHz=0,box2d.b2WheelJoint.prototype.m_dampingRatio=0,box2d.b2WheelJoint.prototype.m_localAnchorA=null,box2d.b2WheelJoint.prototype.m_localAnchorB=null,box2d.b2WheelJoint.prototype.m_localXAxisA=null,box2d.b2WheelJoint.prototype.m_localYAxisA=null,box2d.b2WheelJoint.prototype.m_impulse=0,box2d.b2WheelJoint.prototype.m_motorImpulse=0,box2d.b2WheelJoint.prototype.m_springImpulse=0,box2d.b2WheelJoint.prototype.m_maxMotorTorque=0,box2d.b2WheelJoint.prototype.m_motorSpeed=0,box2d.b2WheelJoint.prototype.m_enableMotor=!1,box2d.b2WheelJoint.prototype.m_indexA=0,box2d.b2WheelJoint.prototype.m_indexB=0,box2d.b2WheelJoint.prototype.m_localCenterA=null,box2d.b2WheelJoint.prototype.m_localCenterB=null,box2d.b2WheelJoint.prototype.m_invMassA=0,box2d.b2WheelJoint.prototype.m_invMassB=0,box2d.b2WheelJoint.prototype.m_invIA=0,box2d.b2WheelJoint.prototype.m_invIB=0,box2d.b2WheelJoint.prototype.m_ax=null,box2d.b2WheelJoint.prototype.m_ay=null,box2d.b2WheelJoint.prototype.m_sAx=0,box2d.b2WheelJoint.prototype.m_sBx=0,box2d.b2WheelJoint.prototype.m_sAy=0,box2d.b2WheelJoint.prototype.m_sBy=0,box2d.b2WheelJoint.prototype.m_mass=0,box2d.b2WheelJoint.prototype.m_motorMass=0,box2d.b2WheelJoint.prototype.m_springMass=0,box2d.b2WheelJoint.prototype.m_bias=0,box2d.b2WheelJoint.prototype.m_gamma=0,box2d.b2WheelJoint.prototype.m_qA=null,box2d.b2WheelJoint.prototype.m_qB=null,box2d.b2WheelJoint.prototype.m_lalcA=null,box2d.b2WheelJoint.prototype.m_lalcB=null,box2d.b2WheelJoint.prototype.m_rA=null,box2d.b2WheelJoint.prototype.m_rB=null,box2d.b2WheelJoint.prototype.GetMotorSpeed=function(){return this.m_motorSpeed},box2d.b2WheelJoint.prototype.GetMaxMotorTorque=function(){return this.m_maxMotorTorque},box2d.b2WheelJoint.prototype.SetSpringFrequencyHz=function(e){this.m_frequencyHz=e},box2d.b2WheelJoint.prototype.GetSpringFrequencyHz=function(){return this.m_frequencyHz},box2d.b2WheelJoint.prototype.SetSpringDampingRatio=function(e){this.m_dampingRatio=e},box2d.b2WheelJoint.prototype.GetSpringDampingRatio=function(){return this.m_dampingRatio},box2d.b2WheelJoint.prototype.InitVelocityConstraints=function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=this.m_invMassA,i=this.m_invMassB,s=this.m_invIA,a=this.m_invIB,n=e.positions[this.m_indexA].c,o=e.positions[this.m_indexA].a,r=e.velocities[this.m_indexA].v,l=e.velocities[this.m_indexA].w,h=e.positions[this.m_indexB].c,c=e.positions[this.m_indexB].a,p=e.velocities[this.m_indexB].v,d=e.velocities[this.m_indexB].w,u=this.m_qA.SetAngleRadians(o),m=this.m_qB.SetAngleRadians(c);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var g=box2d.b2MulRV(u,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var y=box2d.b2MulRV(m,this.m_lalcB,this.m_rB),b=box2d.b2SubVV(box2d.b2AddVV(h,y,box2d.b2Vec2.s_t0),box2d.b2AddVV(n,g,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_d);if(box2d.b2MulRV(u,this.m_localYAxisA,this.m_ay),this.m_sAy=box2d.b2CrossVV(box2d.b2AddVV(b,g,box2d.b2Vec2.s_t0),this.m_ay),this.m_sBy=box2d.b2CrossVV(y,this.m_ay),this.m_mass=t+i+s*this.m_sAy*this.m_sAy+a*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){box2d.b2MulRV(u,this.m_localXAxisA,this.m_ax),this.m_sAx=box2d.b2CrossVV(box2d.b2AddVV(b,g,box2d.b2Vec2.s_t0),this.m_ax),this.m_sBx=box2d.b2CrossVV(y,this.m_ax);var x=t+i+s*this.m_sAx*this.m_sAx+a*this.m_sBx*this.m_sBx;if(x>0){this.m_springMass=1/x;var v=box2d.b2DotVV(b,this.m_ax),f=2*box2d.b2_pi*this.m_frequencyHz,w=2*this.m_springMass*this.m_dampingRatio*f,k=this.m_springMass*f*f,_=e.step.dt;this.m_gamma=_*(w+_*k),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=v*_*k*this.m_gamma,this.m_springMass=x+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=s+a,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),e.step.warmStarting){this.m_impulse*=e.step.dtRatio,this.m_springImpulse*=e.step.dtRatio,this.m_motorImpulse*=e.step.dtRatio;var S=box2d.b2AddVV(box2d.b2MulSV(this.m_impulse,this.m_ay,box2d.b2Vec2.s_t0),box2d.b2MulSV(this.m_springImpulse,this.m_ax,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_P),M=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,A=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;r.SelfMulSub(this.m_invMassA,S),l-=this.m_invIA*M,p.SelfMulAdd(this.m_invMassB,S),d+=this.m_invIB*A}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;e.velocities[this.m_indexA].w=l,e.velocities[this.m_indexB].w=d},box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_d=new box2d.b2Vec2,box2d.b2WheelJoint.prototype.InitVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2WheelJoint.prototype.SolveVelocityConstraints=function(e){var t=this.m_invMassA,i=this.m_invMassB,s=this.m_invIA,a=this.m_invIB,n=e.velocities[this.m_indexA].v,o=e.velocities[this.m_indexA].w,r=e.velocities[this.m_indexB].v,l=e.velocities[this.m_indexB].w,h=box2d.b2DotVV(this.m_ax,box2d.b2SubVV(r,n,box2d.b2Vec2.s_t0))+this.m_sBx*l-this.m_sAx*o,c=-this.m_springMass*(h+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=c;var p=box2d.b2MulSV(c,this.m_ax,box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P),d=c*this.m_sAx,u=c*this.m_sBx;n.SelfMulSub(t,p),o-=s*d,r.SelfMulAdd(i,p);var h=(l+=a*u)-o-this.m_motorSpeed,c=-this.m_motorMass*h,m=this.m_motorImpulse,g=e.step.dt*this.m_maxMotorTorque;this.m_motorImpulse=box2d.b2Clamp(this.m_motorImpulse+c,-g,g),o-=s*(c=this.m_motorImpulse-m),l+=a*c;var h=box2d.b2DotVV(this.m_ay,box2d.b2SubVV(r,n,box2d.b2Vec2.s_t0))+this.m_sBy*l-this.m_sAy*o,c=-this.m_mass*h;this.m_impulse+=c;var p=box2d.b2MulSV(c,this.m_ay,box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P),d=c*this.m_sAy,u=c*this.m_sBy;n.SelfMulSub(t,p),o-=s*d,r.SelfMulAdd(i,p),l+=a*u,e.velocities[this.m_indexA].w=o,e.velocities[this.m_indexB].w=l},box2d.b2WheelJoint.prototype.SolveVelocityConstraints.s_P=new box2d.b2Vec2,box2d.b2WheelJoint.prototype.SolvePositionConstraints=function(e){var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.positions[this.m_indexB].c,a=e.positions[this.m_indexB].a,n=this.m_qA.SetAngleRadians(i),o=this.m_qB.SetAngleRadians(a);box2d.b2SubVV(this.m_localAnchorA,this.m_localCenterA,this.m_lalcA);var r=box2d.b2MulRV(n,this.m_lalcA,this.m_rA);box2d.b2SubVV(this.m_localAnchorB,this.m_localCenterB,this.m_lalcB);var l,h=box2d.b2MulRV(o,this.m_lalcB,this.m_rB),c=box2d.b2AddVV(box2d.b2SubVV(s,t,box2d.b2Vec2.s_t0),box2d.b2SubVV(h,r,box2d.b2Vec2.s_t1),box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_d),p=box2d.b2MulRV(n,this.m_localYAxisA,this.m_ay),d=box2d.b2CrossVV(box2d.b2AddVV(c,r,box2d.b2Vec2.s_t0),p),u=box2d.b2CrossVV(h,p),m=box2d.b2DotVV(c,this.m_ay),g=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;l=0!==g?-m/g:0;var y=box2d.b2MulSV(l,p,box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_P),b=l*d,x=l*u;return t.SelfMulSub(this.m_invMassA,y),i-=this.m_invIA*b,s.SelfMulAdd(this.m_invMassB,y),a+=this.m_invIB*x,e.positions[this.m_indexA].a=i,e.positions[this.m_indexB].a=a,box2d.b2Abs(m)<=box2d.b2_linearSlop},box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_d=new box2d.b2Vec2,box2d.b2WheelJoint.prototype.SolvePositionConstraints.s_P=new box2d.b2Vec2,box2d.b2WheelJoint.prototype.GetDefinition=function(e){return box2d.ENABLE_ASSERTS&&box2d.b2Assert(!1),e},box2d.b2WheelJoint.prototype.GetAnchorA=function(e){return this.m_bodyA.GetWorldPoint(this.m_localAnchorA,e)},box2d.b2WheelJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetWorldPoint(this.m_localAnchorB,e)},box2d.b2WheelJoint.prototype.GetReactionForce=function(e,t){return t.x=e*(this.m_impulse*this.m_ay.x+this.m_springImpulse*this.m_ax.x),t.y=e*(this.m_impulse*this.m_ay.y+this.m_springImpulse*this.m_ax.y),t},box2d.b2WheelJoint.prototype.GetReactionTorque=function(e){return e*this.m_motorImpulse},box2d.b2WheelJoint.prototype.GetLocalAnchorA=function(e){return e.Copy(this.m_localAnchorA)},box2d.b2WheelJoint.prototype.GetLocalAnchorB=function(e){return e.Copy(this.m_localAnchorB)},box2d.b2WheelJoint.prototype.GetLocalAxisA=function(e){return e.Copy(this.m_localXAxisA)},box2d.b2WheelJoint.prototype.GetJointTranslation=function(){var e=this.m_bodyA,t=this.m_bodyB,i=e.GetWorldPoint(this.m_localAnchorA,new box2d.b2Vec2),s=t.GetWorldPoint(this.m_localAnchorB,new box2d.b2Vec2),a=box2d.b2SubVV(s,i,new box2d.b2Vec2),n=e.GetWorldVector(this.m_localXAxisA,new box2d.b2Vec2);return box2d.b2DotVV(a,n)},box2d.b2WheelJoint.prototype.GetJointSpeed=function(){var e=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-e},box2d.b2WheelJoint.prototype.IsMotorEnabled=function(){return this.m_enableMotor},box2d.b2WheelJoint.prototype.EnableMotor=function(e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_enableMotor=e},box2d.b2WheelJoint.prototype.SetMotorSpeed=function(e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_motorSpeed=e},box2d.b2WheelJoint.prototype.SetMaxMotorTorque=function(e){this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_maxMotorTorque=e},box2d.b2WheelJoint.prototype.GetMotorTorque=function(e){return e*this.m_motorImpulse},box2d.b2WheelJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,t=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2WheelJointDef*/ var jd = new box2d.b2WheelJointDef();\n"),box2d.b2Log("  jd.bodyA = bodies[%d];\n",e),box2d.b2Log("  jd.bodyB = bodies[%d];\n",t),box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),box2d.b2Log("  jd.localAnchorA.SetXY(%.15f, %.15f);\n",this.m_localAnchorA.x,this.m_localAnchorA.y),box2d.b2Log("  jd.localAnchorB.SetXY(%.15f, %.15f);\n",this.m_localAnchorB.x,this.m_localAnchorB.y),box2d.b2Log("  jd.localAxisA.Set(%.15f, %.15f);\n",this.m_localXAxisA.x,this.m_localXAxisA.y),box2d.b2Log("  jd.enableMotor = %s;\n",this.m_enableMotor?"true":"false"),box2d.b2Log("  jd.motorSpeed = %.15f;\n",this.m_motorSpeed),box2d.b2Log("  jd.maxMotorTorque = %.15f;\n",this.m_maxMotorTorque),box2d.b2Log("  jd.frequencyHz = %.15f;\n",this.m_frequencyHz),box2d.b2Log("  jd.dampingRatio = %.15f;\n",this.m_dampingRatio),box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},goog.provide("box2d.b2MotorJoint"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Math"),box2d.b2MotorJointDef=function(){goog.base(this,box2d.b2JointType.e_motorJoint),this.linearOffset=new box2d.b2Vec2(0,0)},goog.inherits(box2d.b2MotorJointDef,box2d.b2JointDef),box2d.b2MotorJointDef.prototype.linearOffset=null,box2d.b2MotorJointDef.prototype.angularOffset=0,box2d.b2MotorJointDef.prototype.maxForce=1,box2d.b2MotorJointDef.prototype.maxTorque=1,box2d.b2MotorJointDef.prototype.correctionFactor=.3,box2d.b2MotorJointDef.prototype.Initialize=function(e,t){this.bodyA=e,this.bodyB=t,this.bodyA.GetLocalPoint(this.bodyB.GetPosition(),this.linearOffset);var i=this.bodyA.GetAngleRadians(),s=this.bodyB.GetAngleRadians();this.angularOffset=s-i},box2d.b2MotorJoint=function(e){goog.base(this,e),this.m_linearOffset=e.linearOffset.Clone(),this.m_linearImpulse=new box2d.b2Vec2(0,0),this.m_maxForce=e.maxForce,this.m_maxTorque=e.maxTorque,this.m_correctionFactor=e.correctionFactor,this.m_rA=new box2d.b2Vec2(0,0),this.m_rB=new box2d.b2Vec2(0,0),this.m_localCenterA=new box2d.b2Vec2(0,0),this.m_localCenterB=new box2d.b2Vec2(0,0),this.m_linearError=new box2d.b2Vec2(0,0),this.m_linearMass=new box2d.b2Mat22,this.m_qA=new box2d.b2Rot,this.m_qB=new box2d.b2Rot,this.m_K=new box2d.b2Mat22},goog.inherits(box2d.b2MotorJoint,box2d.b2Joint),box2d.b2MotorJoint.prototype.m_linearOffset=null,box2d.b2MotorJoint.prototype.m_angularOffset=0,box2d.b2MotorJoint.prototype.m_linearImpulse=null,box2d.b2MotorJoint.prototype.m_angularImpulse=0,box2d.b2MotorJoint.prototype.m_maxForce=0,box2d.b2MotorJoint.prototype.m_maxTorque=0,box2d.b2MotorJoint.prototype.m_correctionFactor=.3,box2d.b2MotorJoint.prototype.m_indexA=0,box2d.b2MotorJoint.prototype.m_indexB=0,box2d.b2MotorJoint.prototype.m_rA=null,box2d.b2MotorJoint.prototype.m_rB=null,box2d.b2MotorJoint.prototype.m_localCenterA=null,box2d.b2MotorJoint.prototype.m_localCenterB=null,box2d.b2MotorJoint.prototype.m_linearError=null,box2d.b2MotorJoint.prototype.m_angularError=0,box2d.b2MotorJoint.prototype.m_invMassA=0,box2d.b2MotorJoint.prototype.m_invMassB=0,box2d.b2MotorJoint.prototype.m_invIA=0,box2d.b2MotorJoint.prototype.m_invIB=0,box2d.b2MotorJoint.prototype.m_linearMass=null,box2d.b2MotorJoint.prototype.m_angularMass=0,box2d.b2MotorJoint.prototype.m_qA=null,box2d.b2MotorJoint.prototype.m_qB=null,box2d.b2MotorJoint.prototype.m_K=null,box2d.b2MotorJoint.prototype.GetAnchorA=function(e){return this.m_bodyA.GetPosition(e)},box2d.b2MotorJoint.prototype.GetAnchorB=function(e){return this.m_bodyB.GetPosition(e)},box2d.b2MotorJoint.prototype.GetReactionForce=function(e,t){return box2d.b2MulSV(e,this.m_linearImpulse,t)},box2d.b2MotorJoint.prototype.GetReactionTorque=function(e){return e*this.m_angularImpulse},box2d.b2MotorJoint.prototype.SetCorrectionFactor=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e)&&e>=0&&1>=e),this._correctionFactor=e},box2d.b2MotorJoint.prototype.GetCorrectionFactor=function(){return this.m_correctionFactor},box2d.b2MotorJoint.prototype.SetLinearOffset=function(e){box2d.b2IsEqualToV(e,this.m_linearOffset)||(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_linearOffset.Copy(e))},box2d.b2MotorJoint.prototype.GetLinearOffset=function(e){return e.Copy(this.m_linearOffset)},box2d.b2MotorJoint.prototype.SetAngularOffset=function(e){e!==this.m_angularOffset&&(this.m_bodyA.SetAwake(!0),this.m_bodyB.SetAwake(!0),this.m_angularOffset=e)},box2d.b2MotorJoint.prototype.GetAngularOffset=function(){return this.m_angularOffset},box2d.b2MotorJoint.prototype.SetMaxForce=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e)&&e>=0),this.m_maxForce=e},box2d.b2MotorJoint.prototype.GetMaxForce=function(){return this.m_maxForce},box2d.b2MotorJoint.prototype.SetMaxTorque=function(e){box2d.ENABLE_ASSERTS&&box2d.b2Assert(box2d.b2IsValid(e)&&e>=0),this.m_maxTorque=e},box2d.b2MotorJoint.prototype.GetMaxTorque=function(){return this.m_maxTorque},box2d.b2MotorJoint.prototype.InitVelocityConstraints=function(e){this.m_indexA=this.m_bodyA.m_islandIndex,this.m_indexB=this.m_bodyB.m_islandIndex,this.m_localCenterA.Copy(this.m_bodyA.m_sweep.localCenter),this.m_localCenterB.Copy(this.m_bodyB.m_sweep.localCenter),this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var t=e.positions[this.m_indexA].c,i=e.positions[this.m_indexA].a,s=e.velocities[this.m_indexA].v,a=e.velocities[this.m_indexA].w,n=e.positions[this.m_indexB].c,o=e.positions[this.m_indexB].a,r=e.velocities[this.m_indexB].v,l=e.velocities[this.m_indexB].w,h=this.m_qA.SetAngleRadians(i),c=this.m_qB.SetAngleRadians(o),p=box2d.b2MulRV(h,box2d.b2NegV(this.m_localCenterA,box2d.b2Vec2.s_t0),this.m_rA),d=box2d.b2MulRV(c,box2d.b2NegV(this.m_localCenterB,box2d.b2Vec2.s_t0),this.m_rB),u=this.m_invMassA,m=this.m_invMassB,g=this.m_invIA,y=this.m_invIB,b=this.m_K;if(b.ex.x=u+m+g*p.y*p.y+y*d.y*d.y,b.ex.y=-g*p.x*p.y-y*d.x*d.y,b.ey.x=b.ex.y,b.ey.y=u+m+g*p.x*p.x+y*d.x*d.x,b.GetInverse(this.m_linearMass),this.m_angularMass=g+y,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),box2d.b2SubVV(box2d.b2SubVV(box2d.b2AddVV(n,d,box2d.b2Vec2.s_t0),box2d.b2AddVV(t,p,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t2),box2d.b2MulRV(h,this.m_linearOffset,box2d.b2Vec2.s_t3),this.m_linearError),this.m_angularError=o-i-this.m_angularOffset,e.step.warmStarting){this.m_linearImpulse.SelfMul(e.step.dtRatio),this.m_angularImpulse*=e.step.dtRatio;var x=this.m_linearImpulse;s.SelfMulSub(u,x),a-=g*(box2d.b2CrossVV(p,x)+this.m_angularImpulse),r.SelfMulAdd(m,x),l+=y*(box2d.b2CrossVV(d,x)+this.m_angularImpulse)}else this.m_linearImpulse.SetZero(),this.m_angularImpulse=0;e.velocities[this.m_indexA].w=a,e.velocities[this.m_indexB].w=l},box2d.b2MotorJoint.prototype.SolveVelocityConstraints=function(e){var t=e.velocities[this.m_indexA].v,i=e.velocities[this.m_indexA].w,s=e.velocities[this.m_indexB].v,a=e.velocities[this.m_indexB].w,n=this.m_invMassA,o=this.m_invMassB,r=this.m_invIA,l=this.m_invIB,h=e.step.dt,c=e.step.inv_dt,p=a-i+c*this.m_correctionFactor*this.m_angularError,d=-this.m_angularMass*p,u=this.m_angularImpulse,m=h*this.m_maxTorque;this.m_angularImpulse=box2d.b2Clamp(this.m_angularImpulse+d,-m,m),i-=r*(d=this.m_angularImpulse-u),a+=l*d;var g=this.m_rA,y=this.m_rB,p=box2d.b2AddVV(box2d.b2SubVV(box2d.b2AddVV(s,box2d.b2CrossSV(a,y,box2d.b2Vec2.s_t0),box2d.b2Vec2.s_t0),box2d.b2AddVV(t,box2d.b2CrossSV(i,g,box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t1),box2d.b2Vec2.s_t2),box2d.b2MulSV(c*this.m_correctionFactor,this.m_linearError,box2d.b2Vec2.s_t3),box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_Cdot),d=box2d.b2MulMV(this.m_linearMass,p,box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_impulse).SelfNeg(),u=box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_oldImpulse.Copy(this.m_linearImpulse);this.m_linearImpulse.SelfAdd(d);m=h*this.m_maxForce;this.m_linearImpulse.GetLengthSquared()>m*m&&(this.m_linearImpulse.Normalize(),this.m_linearImpulse.SelfMul(m)),box2d.b2SubVV(this.m_linearImpulse,u,d),t.SelfMulSub(n,d),i-=r*box2d.b2CrossVV(g,d),s.SelfMulAdd(o,d),a+=l*box2d.b2CrossVV(y,d),e.velocities[this.m_indexA].w=i,e.velocities[this.m_indexB].w=a},box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_Cdot=new box2d.b2Vec2,box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_impulse=new box2d.b2Vec2,box2d.b2MotorJoint.prototype.SolveVelocityConstraints.s_oldImpulse=new box2d.b2Vec2,box2d.b2MotorJoint.prototype.SolvePositionConstraints=function(){return!0},box2d.b2MotorJoint.prototype.Dump=function(){if(box2d.DEBUG){var e=this.m_bodyA.m_islandIndex,t=this.m_bodyB.m_islandIndex;box2d.b2Log("  /*box2d.b2MotorJointDef*/ var jd = new box2d.b2MotorJointDef();\n"),box2d.b2Log("  jd.bodyA = bodies[%d];\n",e),box2d.b2Log("  jd.bodyB = bodies[%d];\n",t),box2d.b2Log("  jd.collideConnected = %s;\n",this.m_collideConnected?"true":"false"),box2d.b2Log("  jd.linearOffset.SetXY(%.15f, %.15f);\n",this.m_linearOffset.x,this.m_linearOffset.y),box2d.b2Log("  jd.angularOffset = %.15f;\n",this.m_angularOffset),box2d.b2Log("  jd.maxForce = %.15f;\n",this.m_maxForce),box2d.b2Log("  jd.maxTorque = %.15f;\n",this.m_maxTorque),box2d.b2Log("  jd.correctionFactor = %.15f;\n",this.m_correctionFactor),box2d.b2Log("  joints[%d] = this.m_world.CreateJoint(jd);\n",this.m_index)}},goog.provide("box2d"),goog.require("box2d.b2Settings"),goog.require("box2d.b2Draw"),goog.require("box2d.b2Timer"),goog.require("box2d.b2CircleShape"),goog.require("box2d.b2EdgeShape"),goog.require("box2d.b2ChainShape"),goog.require("box2d.b2PolygonShape"),goog.require("box2d.b2BroadPhase"),goog.require("box2d.b2Distance"),goog.require("box2d.b2DynamicTree"),goog.require("box2d.b2TimeOfImpact"),goog.require("box2d.b2Body"),goog.require("box2d.b2Fixture"),goog.require("box2d.b2WorldCallbacks"),goog.require("box2d.b2TimeStep"),goog.require("box2d.b2World"),goog.require("box2d.b2Contact"),goog.require("box2d.b2AreaJoint"),goog.require("box2d.b2DistanceJoint"),goog.require("box2d.b2FrictionJoint"),goog.require("box2d.b2GearJoint"),goog.require("box2d.b2MotorJoint"),goog.require("box2d.b2MouseJoint"),goog.require("box2d.b2PrismaticJoint"),goog.require("box2d.b2PulleyJoint"),goog.require("box2d.b2RevoluteJoint"),goog.require("box2d.b2RopeJoint"),goog.require("box2d.b2WeldJoint"),goog.require("box2d.b2WheelJoint"),goog.require("box2d.b2Rope"),goog.require("box2d.b2BuoyancyController"),goog.require("box2d.b2ConstantAccelController"),goog.require("box2d.b2ConstantForceController"),goog.require("box2d.b2GravityController"),goog.require("box2d.b2TensorDampingController"),Phaser.Physics.Box2D=function(e,t){this.game=e,this.version="1.0.2",this.ptmRatio=50,this.world=new box2d.b2World(new box2d.b2Vec2(0,0)),this.debugDraw=new Phaser.Physics.Box2D.DefaultDebugDraw(this.mpx(1)),this.world.SetDebugDraw(this.debugDraw),this.contactListener=new Phaser.Physics.Box2D.DefaultContactListener,this.world.SetContactListener(this.contactListener),this.nextBodyId=0,this.nextFixtureId=0,this.gravity=new Phaser.Physics.Box2D.PointProxy(this,this.world,this.world.GetGravity,this.world.SetGravity),this.friction=.2,this.restitution=0,this.density=1,this.frameRate=1/60,this.velocityIterations=8,this.positionIterations=3,this.useElapsedTime=!1,this.paused=!1,this.particleSystem=null;var i=new box2d.b2BodyDef;this.mouseJointBody=this.world.CreateBody(i),this.mouseJoint=null,t.hasOwnProperty("mpx")&&t.hasOwnProperty("pxm")&&(this.mpx=t.mpx,this.pxm=t.pxm),this.walls={left:null,right:null,top:null,bottom:null},this.onBodyAdded=new Phaser.Signal,this.onBodyRemoved=new Phaser.Signal,this._toRemove=[]},Phaser.Physics.Box2D.worldBoundsFilterCategory=32768,Phaser.Physics.Box2D.prototype={getNextBodyId:function(){var e=this.nextBodyId;return this.nextBodyId+=1,e},getNextFixtureId:function(){var e=this.nextFixtureId;return this.nextFixtureId+=1,e},removeBodyNextStep:function(e){this._toRemove.push(e)},preUpdate:function(){for(var e=this._toRemove.length;e--;)this.removeBody(this._toRemove[e]);this._toRemove.length=0},enable:function(e,t){void 0===t&&(t=!0);var i=1;if(Array.isArray(e))for(i=e.length;i--;)e[i]instanceof Phaser.Group?this.enable(e[i].children,t):(this.enableBody(e[i]),t&&e[i].hasOwnProperty("children")&&e[i].children.length>0&&this.enable(e[i],!0));else e instanceof Phaser.Group?this.enable(e.children,t):(this.enableBody(e),t&&e.hasOwnProperty("children")&&e.children.length>0&&this.enable(e.children,!0))},enableBody:function(e){e.hasOwnProperty("body")&&null===e.body&&(e.body=new Phaser.Physics.Box2D.Body(this.game,e,e.x,e.y,2),e.anchor.set(.5))},setBoundsToWorld:function(e,t,i,s,a,n){void 0===e&&(e=!0),void 0===t&&(t=!0),void 0===i&&(i=!0),void 0===s&&(s=!0),void 0===a&&(a=1),void 0===n&&(a=4294967295),this.setBounds(this.game.world.bounds.x,this.game.world.bounds.y,this.game.world.bounds.width,this.game.world.bounds.height,e,t,i,s,a,n)},setBounds:function(e,t,i,s,a,n,o,r,l,h){void 0===a&&(a=!0),void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===r&&(r=!0),void 0===l&&(l=1),void 0===h&&(h=4294967295),this.walls.left&&this.removeBody(this.walls.left),this.walls.right&&this.removeBody(this.walls.right),this.walls.top&&this.removeBody(this.walls.top),this.walls.bottom&&this.removeBody(this.walls.bottom);var c=new box2d.b2PolygonShape,p=new box2d.b2FixtureDef;p.shape=c,p.filter.categoryBits=Phaser.Physics.Box2D.worldBoundsFilterCategory,p.filter.maskBits=65535;var d=this.pxm(100),u=this.game.world.bounds;if(a&&(this.walls.left=this.createBody(0,0,0),c.SetAsOrientedBox(d,this.pxm(u.height)+d,new box2d.b2Vec2(d,0),0),(m=this.walls.left.data.CreateFixture(p)).id=this.getNextFixtureId()),n&&(this.walls.right=this.createBody(0,0,0),c.SetAsOrientedBox(d,this.pxm(u.height)+d,new box2d.b2Vec2(this.pxm(-u.width)-d,0),0),(m=this.walls.right.data.CreateFixture(p)).id=this.getNextFixtureId()),o&&(this.walls.top=this.createBody(0,0,0),c.SetAsOrientedBox(this.pxm(u.width)+d,d,new box2d.b2Vec2(0,d),0),(m=this.walls.top.data.CreateFixture(p)).id=this.getNextFixtureId()),r){this.walls.bottom=this.createBody(0,0,0),c.SetAsOrientedBox(this.pxm(u.width)+d,d,new box2d.b2Vec2(0,this.pxm(-u.height)-d),0);var m=this.walls.bottom.data.CreateFixture(p);m.id=this.getNextFixtureId()}},pause:function(){this.paused=!0},resume:function(){this.paused=!1},update:function(){this.paused||(this.useElapsedTime?this.world.Step(this.game.time.physicsElapsed,this.velocityIterations,this.positionIterations):this.world.Step(this.frameRate,this.velocityIterations,this.positionIterations))},reset:function(){this.clear()},clear:function(){var e=this.world.GetGravity().Clone();this.world=new box2d.b2World(e),this.world.SetDebugDraw(this.debugDraw),this.world.SetContactListener(this.contactListener),this._toRemove=[]},destroy:function(){this.clear(),this.gravity=null,this.world=null,this.game=null},createBody:function(e,t,i){return new Phaser.Physics.Box2D.Body(this.game,null,e,t,i,this)},createCircle:function(e,t,i,s,a){return this.createBody(e,t,2).setCircle(i,s,a)},createRectangle:function(e,t,i,s,a,n,o){return this.createBody(e,t,2).setRectangle(i,s,a,n,o)},createPolygon:function(e,t,i,s,a){return this.createBody(e,t,2).setPolygon(i,s,a)},addBody:function(e){return!e.data.world&&(e.data=this.world.CreateBody(e.bodyDef),e.data.world=this.world,e.data.parent=e,this.onBodyAdded.dispatch(e),!0)},removeBody:function(e){return e.data.world==this.world&&(this.world.DestroyBody(e.data),this.onBodyRemoved.dispatch(e)),e},getBodies:function(){for(var e=[],t=this.world.GetBodyList();t;t=t.GetNext())e.push(t);return e},getBody:function(e){return e instanceof box2d.b2Body?e:e instanceof Phaser.Physics.Box2D.Body?e.data:e.body&&e.body.type===Phaser.Physics.BOX2D?e.body.data:null},toJSON:function(){return this.world.toJSON()},mpx:function(e){return e*=this.ptmRatio},pxm:function(e){return e/this.ptmRatio},renderDebugDraw:function(e){if(this.game.physics.box2d){var t=this.game.physics.box2d;t.debugDraw.start(e),t.world.DrawDebugData(),t.debugDraw.stop()}},renderBodyInfo:function(e,t){e.line("Position: x: "+t.x.toFixed(3)+" y: "+t.y.toFixed(3)),e.line("Rotation: "+t.rotation.toFixed(3)+" degrees"),e.line("Velocity: x: "+t.velocity.x.toFixed(3)+" y: "+t.velocity.y.toFixed(3)),e.line("Angular velocity: "+t.angularVelocity.toFixed(3)+" degrees/sec")},getFixturesAtPoint:function(e,t,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1);var a=this.pxm(-e),n=this.pxm(-t),o=new box2d.b2Vec2(a,n),r=new box2d.b2AABB,l=new box2d.b2Vec2;l.SetXY(.001,.001),box2d.b2SubVV(o,l,r.lowerBound),box2d.b2AddVV(o,l,r.upperBound);var h=[];return this.world.QueryAABB(function(e){return!(!s||e.GetBody().GetType()===box2d.b2BodyType.b2_dynamicBody)||!e.TestPoint(o)||(h.push(e),!i)},r),h},getBodiesAtPoint:function(e,t,i,s){void 0===i&&(i=!1),void 0===s&&(s=!1);var a=this.getFixturesAtPoint(e,t,i,s);if(a.length<1)return a;for(var n=[],o=0;o<a.length;o++)n.push(a[o].GetBody().parent);return n.filter(function(e,t){return n.indexOf(e)===t}),n},mouseDragStart:function(e){this.mouseDragEnd();var t=this.getFixturesAtPoint(e.x,e.y,!0,!0);if(!(t.length<1)){var i=this.pxm(-e.x),s=this.pxm(-e.y),a=new box2d.b2Vec2(i,s),n=new box2d.b2MouseJointDef;n.bodyA=this.mouseJointBody,n.bodyB=t[0].GetBody(),n.target.Copy(a),n.maxForce=1e3*n.bodyB.GetMass(),this.mouseJoint=this.world.CreateJoint(n),n.bodyB.SetAwake(!0)}},mouseDragMove:function(e){if(this.mouseJoint){var t=this.pxm(-e.x),i=this.pxm(-e.y),s=new box2d.b2Vec2(t,i);this.mouseJoint.SetTarget(s)}},mouseDragEnd:function(){this.mouseJoint&&(this.world.DestroyJoint(this.mouseJoint),this.mouseJoint=null)},distanceJoint:function(e,t,i,s,a,n,o,r,l){void 0===s&&(s=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===l&&(l=0),s=this.pxm(-s),a=this.pxm(-a),n=this.pxm(-n),o=this.pxm(-o),e.body&&(e=e.body),t.body&&(t=t.body);var h=new box2d.b2DistanceJointDef;if(h.bodyA=e.data,h.bodyB=t.data,h.localAnchorA.SetXY(s,a),h.localAnchorB.SetXY(n,o),null===i||void 0===i){var c=new box2d.b2Vec2,p=new box2d.b2Vec2;h.bodyA.GetWorldPoint(h.localAnchorA,c),h.bodyB.GetWorldPoint(h.localAnchorB,p),c.SelfSub(p),i=c.Length()}else i=this.pxm(i);return h.length=i,h.frequencyHz=r,h.dampingRatio=l,this.world.CreateJoint(h)},ropeJoint:function(e,t,i,s,a,n,o){void 0===s&&(s=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===o&&(o=0),s=this.pxm(-s),a=this.pxm(-a),n=this.pxm(-n),o=this.pxm(-o),e.body&&(e=e.body),t.body&&(t=t.body);var r=new box2d.b2RopeJointDef;if(r.bodyA=e.data,r.bodyB=t.data,r.localAnchorA.SetXY(s,a),r.localAnchorB.SetXY(n,o),null===i||void 0===i){var l=new box2d.b2Vec2,h=new box2d.b2Vec2;r.bodyA.GetWorldPoint(r.localAnchorA,l),r.bodyB.GetWorldPoint(r.localAnchorB,h),l.SelfSub(h),i=l.Length()}else i=this.pxm(i);return r.maxLength=i,this.world.CreateJoint(r)},revoluteJoint:function(e,t,i,s,a,n,o,r,l,h,c,p){void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===l&&(l=!1),void 0===h&&(h=0),void 0===c&&(c=0),void 0===p&&(p=!1),i=this.pxm(-i),s=this.pxm(-s),a=this.pxm(-a),n=this.pxm(-n),e.body&&(e=e.body),t.body&&(t=t.body);var d=new box2d.b2RevoluteJointDef;return d.bodyA=e.data,d.bodyB=t.data,d.localAnchorA.SetXY(i,s),d.localAnchorB.SetXY(a,n),d.motorSpeed=Phaser.Math.degToRad(-o),d.maxMotorTorque=r,d.enableMotor=l,d.lowerAngle=Phaser.Math.degToRad(h),d.upperAngle=Phaser.Math.degToRad(c),d.enableLimit=p,this.world.CreateJoint(d)},prismaticJoint:function(e,t,i,s,a,n,o,r,l,h,c,p,d,u,m){void 0===i&&(i=1),void 0===s&&(s=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===l&&(l=0),void 0===h&&(h=0),void 0===p&&(p=0),void 0===d&&(d=0),void 0===u&&(u=!1),void 0===c&&(c=!1),void 0===m&&(m=0),i*=-1,s*=-1,a=this.pxm(-a),n=this.pxm(-n),o=this.pxm(-o),r=this.pxm(-r),l=this.pxm(l),p=this.pxm(p),d=this.pxm(d),e.body&&(e=e.body),t.body&&(t=t.body);var g=new box2d.b2PrismaticJointDef;return g.bodyA=e.data,g.bodyB=t.data,g.localAxisA.SetXY(i,s),g.localAnchorA.SetXY(a,n),g.localAnchorB.SetXY(o,r),g.motorSpeed=l,g.maxMotorForce=h,g.enableMotor=c,g.lowerTranslation=p,g.upperTranslation=d,g.enableLimit=u,g.referenceAngle=Phaser.Math.degToRad(-m),this.world.CreateJoint(g)},frictionJoint:function(e,t,i,s,a,n,o,r){void 0===a&&(a=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===s&&(s=0),a=this.pxm(-a),n=this.pxm(-n),o=this.pxm(-o),r=this.pxm(-r),e.body&&(e=e.body),t.body&&(t=t.body);var l=new box2d.b2FrictionJointDef;return l.bodyA=e.data,l.bodyB=t.data,l.localAnchorA.SetXY(a,n),l.localAnchorB.SetXY(o,r),l.maxForce=i,l.maxTorque=s,this.world.CreateJoint(l)},weldJoint:function(e,t,i,s,a,n,o,r){void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),i=this.pxm(-i),s=this.pxm(-s),a=this.pxm(-a),n=this.pxm(-n),e.body&&(e=e.body),t.body&&(t=t.body);var l=new box2d.b2WeldJointDef;return l.bodyA=e.data,l.bodyB=t.data,l.localAnchorA.SetXY(i,s),l.localAnchorB.SetXY(a,n),l.frequencyHz=o,l.dampingRatio=r,this.world.CreateJoint(l)},motorJoint:function(e,t,i,s,a,n,o,r){void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=1),n=this.pxm(-n),o=this.pxm(-o),e.body&&(e=e.body),t.body&&(t=t.body);var l=new box2d.b2MotorJointDef;return l.bodyA=e.data,l.bodyB=t.data,l.linearOffset.SetXY(n,o),l.maxForce=i,l.maxTorque=s,l.angularOffset=Phaser.Math.degToRad(-r),l.correctionFactor=a,this.world.CreateJoint(l)},wheelJoint:function(e,t,i,s,a,n,o,r,l,h,c,p,d){void 0===o&&(o=0),void 0===r&&(r=1),void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===c&&(c=0),void 0===p&&(p=0),void 0===d&&(d=!1),void 0===l&&(l=0),void 0===h&&(h=0),o*=-1,r*=-1,i=this.pxm(-i),s=this.pxm(-s),a=this.pxm(-a),n=this.pxm(-n),e.body&&(e=e.body),t.body&&(t=t.body);var u=new box2d.b2WheelJointDef;return u.bodyA=e.data,u.bodyB=t.data,u.localAxisA.SetXY(o,r),u.localAnchorA.SetXY(i,s),u.localAnchorB.SetXY(a,n),u.motorSpeed=Phaser.Math.degToRad(-c),u.maxMotorTorque=p,u.enableMotor=d,u.frequencyHz=l,u.dampingRatio=h,this.world.CreateJoint(u)},pulleyJoint:function(e,t,i,s,a,n,o,r,l,h,c,p,d){void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=0),void 0===n&&(n=0),void 0===o&&(o=0),void 0===r&&(r=0),void 0===l&&(l=0),void 0===h&&(h=0),void 0===c&&(c=1),void 0===p&&(p=100),void 0===d&&(d=100),i=this.pxm(-i),s=this.pxm(-s),a=this.pxm(-a),n=this.pxm(-n),o=this.pxm(-o),r=this.pxm(-r),l=this.pxm(-l),h=this.pxm(-h),p=this.pxm(p),d=this.pxm(d),e.body&&(e=e.body),t.body&&(t=t.body);var u=new box2d.b2PulleyJointDef;return u.bodyA=e.data,u.bodyB=t.data,u.localAnchorA.SetXY(i,s),u.localAnchorB.SetXY(a,n),u.groundAnchorA.SetXY(o,r),u.groundAnchorB.SetXY(l,h),u.lengthA=p,u.lengthB=d,u.ratio=c,this.world.CreateJoint(u)},gearJoint:function(e,t,i){void 0===i&&(i=1);var s=new box2d.b2GearJointDef;return s.joint1=e,s.joint2=t,s.ratio=-i,s.bodyA=e.GetBodyA(),s.bodyB=t.GetBodyB(),this.world.CreateJoint(s)},clearTilemapLayerBodies:function(e,t){t=e.getLayer(t);for(var i=e.layers[t].bodies.length;i--;)e.layers[t].bodies[i].destroy();e.layers[t].bodies.length=0},convertTilemap:function(e,t,i,s){t=e.getLayer(t),void 0===i&&(i=!0),void 0===s&&(s=!0),this.clearTilemapLayerBodies(e,t);for(var a=0,n=0,o=0,r=0,l=e.layers[t].height;l>r;r++){a=0;for(var h=0,c=e.layers[t].width;c>h;h++){var p=e.layers[t].data[r][h];if(p&&p.index>-1&&p.collides)if(s){var d=e.getTileRight(t,h,r);0===a&&(n=p.x*p.width,o=p.y*p.height,a=p.width),d&&d.collides?a+=p.width:((u=new Phaser.Physics.Box2D.Body(this.game,null,n,o,0)).addRectangle(a,p.height,a/2,p.height/2,0),i&&this.addBody(u),e.layers[t].bodies.push(u),a=0)}else{var u=this.createBody(p.x*p.width,p.y*p.height,0,!1);u.addRectangle(p.width,p.height,p.width/2,p.height/2,0),i&&this.addBody(u),e.layers[t].bodies.push(u)}}}return e.layers[t].bodies},raycast:function(e,t,i,s,a,n){void 0===a&&(a=!0),void 0===n&&(n=null),e=this.pxm(-e),t=this.pxm(-t),i=this.pxm(-i),s=this.pxm(-s);var o=new box2d.b2Vec2(e,t),r=new box2d.b2Vec2(i,s),l=[],h=new Phaser.Physics.Box2D.RayCastCallback(this,a,n);this.world.RayCast(h,o,r);for(var c=0;c<h.hits.length;c++){var p=h.hits[c];p.point={x:this.mpx(-p.point.x),y:this.mpx(-p.point.y)},p.normal={x:-p.normal.x,y:-p.normal.y},l.push(p)}return l},queryAABB:function(e,t,i,s){e=this.pxm(-e),t=this.pxm(-t),i=this.pxm(i),s=this.pxm(s);var a=new box2d.b2AABB;a.lowerBound.SetXY(e-i,t-s),a.upperBound.SetXY(e,t);var n=new Phaser.Physics.Box2D.QueryCallback(this);return this.world.QueryAABB(n,a),n.hits},queryFixture:function(e){var t=new Phaser.Physics.Box2D.QueryCallback(this);return this.world.QueryShape(t,e.GetShape(),e.GetBody().GetTransform()),t.hits},setPTMRatio:function(e){this.ptmRatio=e,this.debugDraw=new Phaser.Physics.Box2D.DefaultDebugDraw(this.ptmRatio),this.world.SetDebugDraw(this.debugDraw)}},Phaser.Physics.Box2D.RayCastCallback=function(e,t,i){this.world=e,this.closestHitOnly=t,this.filterFunction=i,this.hits=[]},goog.inherits(Phaser.Physics.Box2D.RayCastCallback,box2d.b2RayCastCallback),Phaser.Physics.Box2D.RayCastCallback.prototype.ReportFixture=function(e,t,i,s){if(null!==this.filterFunction){var a={x:this.world.mpx(-t.x),y:this.world.mpx(-t.y)},n={x:-i.x,y:-i.y},o=e.GetBody().parent;if(!this.filterFunction.call(this,o,e,a,n))return-1}this.closestHitOnly&&(this.hits=[]);var r={};return r.body=e.GetBody().parent,r.fixture=e,r.point={x:t.x,y:t.y},r.normal={x:i.x,y:i.y},this.hits.push(r),this.closestHitOnly?s:1},Phaser.Physics.Box2D.QueryCallback=function(e){this.world=e,this.hits=[]},goog.inherits(Phaser.Physics.Box2D.QueryCallback,box2d.b2QueryCallback),Phaser.Physics.Box2D.QueryCallback.prototype.ReportFixture=function(e){var t={};return t.body=e.GetBody().parent,t.fixture=e,this.hits.push(t),!0},Phaser.Physics.Box2D.renderBody=function(e,t,i,s){i=i||"rgb(255,255,255)",void 0===s&&(s=!0);var a=t.data,n=a.GetTransform(),o=t.world;n.p.x+=-t.game.camera.x/o.ptmRatio,n.p.y-=-t.game.camera.y/o.ptmRatio,o.debugDraw.start(e),o.debugDraw.PushTransform(n);var r=Phaser.Color.webToColor(i),l=o.debugDraw.color;l.r=r.r/255,l.g=r.g/255,l.b=r.b/255;for(var h=a.GetFixtureList();h;h=h.GetNext())o.world.DrawShape(h,l);o.debugDraw.PopTransform(),o.debugDraw.stop()},Phaser.Physics.Box2D.Body=function(e,t,i,s,a,n){void 0===t&&(t=null),void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=2),void 0===n&&(n=e.physics.box2d),this.game=e,this.world=n,this.id=this.world.getNextBodyId(),this.sprite=t,this.type=Phaser.Physics.BOX2D,this.offset=new Phaser.Point,this.bodyDef=new box2d.b2BodyDef,this.bodyDef.position.SetXY(-this.world.pxm(i),-this.world.pxm(s)),0===a?this.bodyDef.type=box2d.b2BodyType.b2_staticBody:1===a?this.bodyDef.type=box2d.b2BodyType.b2_kinematicBody:2===a?this.bodyDef.type=box2d.b2BodyType.b2_dynamicBody:3===a&&(this.bodyDef.type=box2d.b2BodyType.b2_bulletBody),this.data=this.world.world.CreateBody(this.bodyDef),this.data.world=this.world.world,this.data.parent=this,this.velocity=new Phaser.Physics.Box2D.PointProxy(this.world,this.data,this.data.GetLinearVelocity,this.data.SetLinearVelocity),this.removeNextStep=!1,this._fixtureContactCallbacks={},this._fixtureContactCallbackContext={},this._bodyContactCallbacks={},this._bodyContactCallbackContext={},this._categoryContactCallbacks={},this._categoryContactCallbackContext={},this._fixturePresolveCallbacks={},this._fixturePresolveCallbackContext={},this._bodyPresolveCallbacks={},this._bodyPresolveCallbackContext={},this._categoryPresolveCallbacks={},this._categoryPresolveCallbackContext={},this._fixturePostsolveCallbacks={},this._fixturePostsolveCallbackContext={},this._bodyPostsolveCallbacks={},this._bodyPostsolveCallbackContext={},this._categoryPostsolveCallbacks={},this._categoryPostsolveCallbackContext={},t&&this.setRectangleFromSprite(t)},Phaser.Physics.Box2D.Body.prototype={setBodyContactCallback:function(e,t,i){var s=-1;e.id?s=e.id:e.body&&(s=e.body.id),s>-1&&(null===t?(delete this._bodyContactCallbacks[s],delete this._bodyContactCallbackContext[s]):(this._bodyContactCallbacks[s]=t,this._bodyContactCallbackContext[s]=i))},setFixtureContactCallback:function(e,t,i){var s=e.id;s>-1&&(null===t?(delete this._fixtureContactCallbacks[s],delete this._fixtureContactCallbackContext[s]):(this._fixtureContactCallbacks[s]=t,this._fixtureContactCallbackContext[s]=i))},setCategoryContactCallback:function(e,t,i){null===t?(delete this._categoryContactCallbacks[e],delete this._categoryContactCallbacksContext[e]):(this._categoryContactCallbacks[e]=t,this._categoryContactCallbackContext[e]=i)},setBodyPresolveCallback:function(e,t,i){var s=-1;e.id?s=e.id:e.body&&(s=e.body.id),s>-1&&(null===t?(delete this._bodyPresolveCallbacks[s],delete this._bodyPresolveCallbackContext[s]):(this._bodyPresolveCallbacks[s]=t,this._bodyPresolveCallbackContext[s]=i))},setFixturePresolveCallback:function(e,t,i){var s=e.id;s>-1&&(null===t?(delete this._fixturePresolveCallbacks[s],delete this._fixturePresolveCallbackContext[s]):(this._fixturePresolveCallbacks[s]=t,this._fixturePresolveCallbackContext[s]=i))},setCategoryPresolveCallback:function(e,t,i){null===t?(delete this._categoryPresolveCallbacks[e],delete this._categoryPresolveCallbacksContext[e]):(this._categoryPresolveCallbacks[e]=t,this._categoryPresolveCallbackContext[e]=i)},setBodyPostsolveCallback:function(e,t,i){var s=-1;e.id?s=e.id:e.body&&(s=e.body.id),s>-1&&(null===t?(delete this._bodyPostsolveCallbacks[s],delete this._bodyPostsolveCallbackContext[s]):(this._bodyPostsolveCallbacks[s]=t,this._bodyPostsolveCallbackContext[s]=i))},setFixturePostsolveCallback:function(e,t,i){var s=e.id;s>-1&&(null===t?(delete this._fixturePostsolveCallbacks[s],delete this._fixturePostsolveCallbackContext[s]):(this._fixturePostsolveCallbacks[s]=t,this._fixturePostsolveCallbackContext[s]=i))},setCategoryPostsolveCallback:function(e,t,i){null===t?(delete this._categoryPostsolveCallbacks[e],delete this._categoryPostsolveCallbacksContext[e]):(this._categoryPostsolveCallbacks[e]=t,this._categoryPostsolveCallbackContext[e]=i)},setCollisionCategory:function(e,t){if(void 0===t)for(var i=this.data.GetFixtureList();i;i=i.GetNext())(s=i.GetFilterData()).categoryBits=e;else{var s=t.GetFilterData();s.categoryBits=e}},setCollisionMask:function(e,t){if(void 0===t)for(var i=this.data.GetFixtureList();i;i=i.GetNext())(s=i.GetFilterData()).maskBits=e;else{var s=t.GetFilterData();s.maskBits=e}},applyForce:function(e,t){this.data.ApplyForce(new box2d.b2Vec2(-e,-t),this.data.GetWorldCenter(),!0)},setZeroRotation:function(){this.data.SetAngularVelocity(0)},setZeroVelocity:function(){this.data.SetLinearVelocity(box2d.b2Vec2.ZERO)},setZeroDamping:function(){this.data.SetLinearDamping(0),this.data.SetAngularDamping(0)},toLocalPoint:function(e,t){return e.x=this.world.pxm(-t.x),e.y=this.world.pxm(-t.y),this.data.GetLocalPoint(e,e),e.x=this.world.mpx(-e.x),e.y=this.world.mpx(-e.y),e},toWorldPoint:function(e,t){return e.x=this.world.pxm(-t.x),e.y=this.world.pxm(-t.y),this.data.GetWorldPoint(e,e),e.x=this.world.mpx(-e.x),e.y=this.world.mpx(-e.y),e},toLocalVector:function(e,t){return e.x=this.world.pxm(-t.x),e.y=this.world.pxm(-t.y),this.data.GetLocalVector(e,e),e.x=this.world.mpx(-e.x),e.y=this.world.mpx(-e.y),e},toWorldVector:function(e,t){e.x=this.world.pxm(-t.x),e.y=this.world.pxm(-t.y),this.data.GetWorldVector(e,e),e.x=this.world.mpx(-e.x),e.y=this.world.mpx(-e.y)},rotateLeft:function(e){this.data.SetAngularVelocity(this.world.pxm(-e))},rotateRight:function(e){this.data.SetAngularVelocity(this.world.pxm(e))},moveForward:function(e){var t=this.world.pxm(e),i=new box2d.b2Vec2;this.toWorldVector(i,{x:0,y:t}),this.data.SetLinearVelocity(i)},moveBackward:function(e){var t=this.world.pxm(-e),i=new box2d.b2Vec2;this.toWorldVector(i,{x:0,y:t}),this.data.SetLinearVelocity(i)},thrust:function(e){var t=this.world.pxm(e)*this.data.GetMass(),i=new box2d.b2Vec2;this.toWorldVector(i,{x:0,y:t}),this.data.ApplyForce(i,this.data.GetWorldCenter(),!0)},reverse:function(e){var t=-this.world.pxm(e)*this.data.GetMass(),i=new box2d.b2Vec2;this.toWorldVector(i,{x:0,y:t}),this.data.ApplyForce(i,this.data.GetWorldCenter(),!0)},moveLeft:function(e){this.velocity.x=-e},moveRight:function(e){this.velocity.x=e},moveUp:function(e){this.velocity.y=-e},moveDown:function(e){this.velocity.y=e},preUpdate:function(){this.removeNextStep&&(this.removeFromWorld(),this.removeNextStep=!1)},postUpdate:function(){this.sprite&&(this.sprite.x=this.world.mpx(-this.data.GetPosition().x),this.sprite.y=this.world.mpx(-this.data.GetPosition().y),this.sprite.rotation=this.data.GetAngle())},kill:function(){this.data.SetActive(!1)},reset:function(e,t){this.data.SetPositionXY(this.world.pxm(-e),this.world.pxm(-t)),this.data.SetActive(!0)},removeFromWorld:function(){this.data.world===this.game.physics.box2d.world&&this.game.physics.box2d.removeBodyNextStep(this)},destroy:function(){this.removeFromWorld(),this._bodyCallbacks={},this._bodyCallbackContext={},this._categoryCallbacks={},this._categoryCallbackContext={},this.sprite=null},clearFixtures:function(){for(var e=[],t=this.data.GetFixtureList();t;t=t.GetNext())e.push(t);for(var i=e.length;i--;)this.data.DestroyFixture(e[i])},addCircle:function(e,t,i){var s=new box2d.b2CircleShape(this.world.pxm(e));s.m_p.SetXY(this.world.pxm(-t),this.world.pxm(-i));var a=new box2d.b2FixtureDef;a.shape=s,a.friction=this.world.friction,a.restitution=this.world.restitution,a.density=this.world.density;var n=this.data.CreateFixture(a);return n.id=this.world.getNextFixtureId(),n},addRectangle:function(e,t,i,s,a){void 0===e&&(e=16),void 0===t&&(t=16),void 0===i&&(i=0),void 0===s&&(s=0),void 0===a&&(a=0),e=this.world.pxm(e),t=this.world.pxm(t);var n=new box2d.b2PolygonShape;n.SetAsOrientedBox(.5*e,.5*t,new box2d.b2Vec2(this.world.pxm(-i),this.world.pxm(-s)),a);var o=new box2d.b2FixtureDef;o.shape=n,o.friction=this.world.friction,o.restitution=this.world.restitution,o.density=this.world.density;var r=this.data.CreateFixture(o);return r.id=this.world.getNextFixtureId(),r},addEdge:function(e,t,i,s){var a=new box2d.b2EdgeShape;a.Set(new box2d.b2Vec2(this.world.pxm(-e),this.world.pxm(-t)),new box2d.b2Vec2(this.world.pxm(-i),this.world.pxm(-s)));var n=new box2d.b2FixtureDef;n.shape=a,n.friction=this.world.friction,n.restitution=this.world.restitution,n.density=this.world.density;var o=this.data.CreateFixture(n);return o.id=this.world.getNextFixtureId(),o},addChain:function(e,t,i,s){if(void 0===e)return null;if(e.length<4)return null;void 0===t&&(t=0),void 0===i&&(i=(e.length-t)/2);for(var a=[],n=t;t+i>n;n++)a.push(new box2d.b2Vec2(this.world.pxm(-e[2*n]),this.world.pxm(-e[2*n+1])));var o=new box2d.b2ChainShape;s?o.CreateLoop(a,a.length):o.CreateChain(a,a.length);var r=new box2d.b2FixtureDef;r.shape=o,r.friction=this.world.friction,r.restitution=this.world.restitution,r.density=this.world.density;var l=this.data.CreateFixture(r);return l.id=this.world.getNextFixtureId(),l},addLoop:function(e,t,i){return this.addChain(e,t,i,!0)},addPolygon:function(e,t,i){if(void 0===e)return null;if(e.length<6)return null;void 0===t&&(t=0),void 0===i&&(i=(e.length-t)/2);for(var s=[],a=t;t+i>a;a++)s.push({x:this.world.pxm(-e[2*a]),y:this.world.pxm(-e[2*a+1])});var n=new Phaser.Physics.Box2D.Polygon;n.setFromXYObjects(s);for(var o=n.decompose(s),r=null,a=0;a<o.length;a++){var l=new box2d.b2PolygonShape;l.Set(o[a],o[a].length);var h=new box2d.b2FixtureDef;h.shape=l,h.friction=this.world.friction,h.restitution=this.world.restitution,h.density=this.world.density,(r=this.data.CreateFixture(h)).id=this.world.getNextFixtureId()}return r},removeFixture:function(e){return e.GetBody()==this.data&&(this.data.DestroyFixture(e),!0)},setCircle:function(e,t,i){return void 0===e&&(e=32),void 0===t&&(t=0),void 0===i&&(i=0),this.clearFixtures(),this.addCircle(e,t,i)},setRectangle:function(e,t,i,s,a){return this.clearFixtures(),this.addRectangle(e,t,i,s,a)},setRectangleFromSprite:function(e){return void 0===e&&(e=this.sprite),this.clearFixtures(),this.addRectangle(e.width,e.height,0,0,e.rotation)},setEdge:function(e,t,i,s){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=0),void 0===s&&(s=0),this.clearFixtures(),this.addEdge(e,t,i,s)},setChain:function(e,t,i,s){return void 0===e?null:e.length<4?null:(void 0===t&&(t=0),void 0===i&&(i=(e.length-t)/2),this.clearFixtures(),this.addChain(e,t,i,s))},setLoop:function(e,t,i){return this.setChain(e,t,i,!0)},setPolygon:function(e,t,i){return void 0===e?null:e.length<4?null:(void 0===t&&(t=0),void 0===i&&(i=(e.length-t)/2),this.clearFixtures(),this.addPolygon(e,t,i))},loadPolygon:function(e,t,i){void 0===i&&(i=null);for(var s=this.game.cache.getPhysicsData(e,t),a=0;a<s.length;a++){for(var n=[],o=0;o<s[a].shape.length;o+=2)n.push(new box2d.b2Vec2(this.world.pxm(-s[a].shape[o]),this.world.pxm(-s[a].shape[o+1])));if(i)for(var r=this.world.pxm(-.5*i.width),l=this.world.pxm(-.5*i.height),h=0;h<n.length;h++)n[h].x-=r,n[h].y-=l;var c=new box2d.b2PolygonShape;c.Set(n,n.length);var p=new box2d.b2FixtureDef;p.shape=c,p.friction=s[a].friction,p.restitution=s[a].bounce,p.density=s[a].density,p.filter.categoryBits=s[a].filter.categoryBits,p.filter.maskBits=s[a].filter.maskBits,this.data.CreateFixture(p).id=this.world.getNextFixtureId()}return!0},containsPoint:function(e){for(var t=this.world.pxm(-e.x),i=this.world.pxm(-e.y),s=new box2d.b2Vec2(t,i),a=this.data.GetFixtureList();a;a=a.GetNext())if(a.TestPoint(s))return!0;return!1}},Phaser.Physics.Box2D.Body.prototype.constructor=Phaser.Physics.Box2D.Body,Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"static",{get:function(){return this.data.GetType()===box2d.b2BodyType.b2_staticBody},set:function(e){e&&this.data.GetType()!==box2d.b2BodyType.b2_staticBody?this.data.SetType(box2d.b2BodyType.b2_staticBody):e||this.data.GetType()!==box2d.b2BodyType.b2_staticBody||this.data.SetType(box2d.b2BodyType.b2_dynamicBody)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"dynamic",{get:function(){return this.data.GetType()===box2d.b2BodyType.b2_dynamicBody},set:function(e){e&&this.data.GetType()!==box2d.b2BodyType.b2_dynamicBody?this.data.SetType(box2d.b2BodyType.b2_dynamicBody):e||this.data.GetType()!==box2d.b2BodyType.b2_dynamicBody||this.data.SetType(box2d.b2BodyType.b2_staticBody)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"kinematic",{get:function(){return this.data.GetType()===box2d.b2BodyType.b2_kinematicBody},set:function(e){e&&this.data.GetType()!==box2d.b2BodyType.b2_kinematicBody?this.data.SetType(box2d.b2BodyType.b2_kinematicBody):e||this.data.GetType()!==box2d.b2BodyType.b2_kinematicBody||this.data.SetType(box2d.b2BodyType.b2_staticBody)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"angle",{get:function(){return Phaser.Math.wrapAngle(Phaser.Math.radToDeg(this.data.GetAngle()))},set:function(e){this.data.SetAngle(Phaser.Math.degToRad(Phaser.Math.wrapAngle(e)))}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"linearDamping",{get:function(){return this.data.GetLinearDamping()},set:function(e){this.data.SetLinearDamping(e)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"angularDamping",{get:function(){return this.data.GetAngularDamping()},set:function(e){this.data.SetAngularDamping(e)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"angularVelocity",{get:function(){return this.data.GetAngularVelocity()},set:function(e){this.data.SetAngularVelocity(e)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"fixedRotation",{get:function(){return this.data.IsFixedRotation()},set:function(e){this.data.SetFixedRotation(e)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"gravityScale",{get:function(){return this.data.GetGravityScale()},set:function(e){this.data.SetGravityScale(e)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"friction",{get:function(){var e=this.data.GetFixtureList();return e?e.GetFriction():0},set:function(e){for(var t=this.data.GetFixtureList();t;t=t.GetNext())t.SetFriction(e),t.Refilter()}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"restitution",{get:function(){var e=this.data.GetFixtureList();return e?e.GetRestitution():0},set:function(e){for(var t=this.data.GetFixtureList();t;t=t.GetNext())t.SetRestitution(e),t.Refilter()}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"sensor",{get:function(){var e=this.data.GetFixtureList();return e?e.IsSensor():0},set:function(e){for(var t=this.data.GetFixtureList();t;t=t.GetNext())t.SetSensor(e),t.Refilter()}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"bullet",{get:function(){return this.data.IsBullet()},set:function(e){this.data.SetBullet(e)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"mass",{get:function(){return this.data.GetMass()},set:function(e){if(0===e)this.data.SetType(box2d.b2BodyType.b2_staticBody);else{this.data.GetType()!==box2d.b2BodyType.b2_dynamicBody&&this.data.SetType(box2d.b2BodyType.b2_dynamicBody);for(var t=e/this.data.GetMass(),i=this.data.GetFixtureList();i;i=i.GetNext()){var s=i.GetDensity();i.SetDensity(s*t)}this.data.ResetMassData()}}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"rotation",{get:function(){return this.data.GetAngle()},set:function(e){this.data.SetAngle(e)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"x",{get:function(){return this.world.mpx(-this.data.GetPosition().x)},set:function(e){this.data.SetPositionXY(this.world.pxm(-e),this.data.GetPosition().y)}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"y",{get:function(){return this.world.mpx(-this.data.GetPosition().y)},set:function(e){this.data.SetPositionXY(this.data.GetPosition().x,this.world.pxm(-e))}}),Object.defineProperty(Phaser.Physics.Box2D.Body.prototype,"collideWorldBounds",{get:function(){for(var e=this.data.GetFixtureList();e;e=e.GetNext())if(e.GetFilterData().maskBits&Phaser.Physics.Box2D.worldBoundsFilterCategory)return!0;return!1},set:function(e){for(var t=this.data.GetFixtureList();t;t=t.GetNext()){var i=t.GetFilterData();e?i.maskBits|=Phaser.Physics.Box2D.worldBoundsFilterCategory:i.maskBits&=~Phaser.Physics.Box2D.worldBoundsFilterCategory}}}),Phaser.Physics.Box2D.PointProxy=function(e,t,i,s){this.world=e,this.object=t,this.gettor=i,this.settor=s},Phaser.Physics.Box2D.PointProxy.prototype.constructor=Phaser.Physics.Box2D.PointProxy,Object.defineProperty(Phaser.Physics.Box2D.PointProxy.prototype,"x",{get:function(){return this.world.mpx(-this.gettor.call(this.object).x)},set:function(e){var t=this.gettor.call(this.object);t.x=this.world.pxm(-e),this.settor.call(this.object,t)}}),Object.defineProperty(Phaser.Physics.Box2D.PointProxy.prototype,"y",{get:function(){return this.world.mpx(-this.gettor.call(this.object).y)},set:function(e){var t=this.gettor.call(this.object);t.y=this.world.pxm(-e),this.settor.call(this.object,t)}}),Phaser.Physics.Box2D.DefaultDebugDraw=function(e){this.context=null,this.pixelsPerMeter=e,this.flags=box2d.b2DrawFlags.e_shapeBit},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.color=new box2d.b2Color(1,1,1),Phaser.Physics.Box2D.DefaultDebugDraw.prototype.SetFlags=function(e){this.flags=e},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.GetFlags=function(){return this.flags},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.start=function(e){this.context=e,this.context.save(),this.context.scale(-1,-1),this.context.scale(this.pixelsPerMeter,this.pixelsPerMeter)},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.stop=function(){this.context.restore()},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.PushTransform=function(e){var t=this.context;t.save(),t.translate(e.p.x,e.p.y),t.rotate(e.q.GetAngleRadians())},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.PopTransform=function(){this.context.restore()},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawPolygon=function(e,t,i){if(t){var s=this.context;s.lineWidth=1/this.pixelsPerMeter,s.beginPath(),s.moveTo(e[0].x,e[0].y);for(var a=1;t>a;a++)s.lineTo(e[a].x,e[a].y);s.closePath(),s.strokeStyle=i.MakeStyleString(1),s.stroke()}},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawSolidPolygon=function(e,t,i){if(t){var s=this.context;s.lineWidth=1/this.pixelsPerMeter,s.beginPath(),s.moveTo(e[0].x,e[0].y);for(var a=1;t>a;a++)s.lineTo(e[a].x,e[a].y);s.closePath(),s.fillStyle=i.MakeStyleString(.5),s.fill(),s.strokeStyle=i.MakeStyleString(1),s.stroke()}},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawCircle=function(e,t,i){if(t){var s=this.context;s.beginPath(),s.arc(e.x,e.y,t,0,2*Math.PI,!0),s.strokeStyle=i.MakeStyleString(1),s.stroke()}},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawSolidCircle=function(e,t,i,s){if(t){var a=this.context;a.lineWidth=1/this.pixelsPerMeter;var n=e.x,o=e.y;a.beginPath(),a.arc(n,o,t,0,2*Math.PI,!0),a.moveTo(n,o),a.lineTo(n+i.x*t,o+i.y*t),a.fillStyle=s.MakeStyleString(.5),a.fill(),a.strokeStyle=s.MakeStyleString(1),a.stroke()}},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawSegment=function(e,t,i){var s=this.context;s.lineWidth=1/this.pixelsPerMeter,s.beginPath(),s.moveTo(e.x,e.y),s.lineTo(t.x,t.y),s.strokeStyle=i.MakeStyleString(1),s.stroke()},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawTransform=function(e){var t=this.context;t.lineWidth=1/this.pixelsPerMeter,this.PushTransform(e),t.beginPath(),t.moveTo(0,0),t.lineTo(1,0),t.strokeStyle=box2d.b2Color.RED.MakeStyleString(1),t.stroke(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,1),t.strokeStyle=box2d.b2Color.GREEN.MakeStyleString(1),t.stroke(),this.PopTransform(e)},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawPoint=function(e,t,i){var s=this.context;s.fillStyle=i.MakeStyleString();var a=t/2;s.fillRect(e.x-a,e.y-a,t,t)},Phaser.Physics.Box2D.DefaultDebugDraw.prototype.DrawAABB=function(e,t){var i=this.context;i.strokeStyle=t.MakeStyleString();var s=e.lowerBound.x,a=e.lowerBound.y,n=e.upperBound.x-e.lowerBound.x,o=e.upperBound.y-e.lowerBound.y;i.strokeRect(s,a,n,o)},Object.defineProperty(Phaser.Physics.Box2D.DefaultDebugDraw.prototype,"shapes",{get:function(){return this.flags&box2d.b2DrawFlags.e_shapeBit},set:function(e){e?this.flags|=box2d.b2DrawFlags.e_shapeBit:this.flags&=~box2d.b2DrawFlags.e_shapeBit}}),Object.defineProperty(Phaser.Physics.Box2D.DefaultDebugDraw.prototype,"joints",{get:function(){return this.flags&box2d.b2DrawFlags.e_jointBit},set:function(e){e?this.flags|=box2d.b2DrawFlags.e_jointBit:this.flags&=~box2d.b2DrawFlags.e_jointBit}}),Object.defineProperty(Phaser.Physics.Box2D.DefaultDebugDraw.prototype,"aabbs",{get:function(){return this.flags&box2d.b2DrawFlags.e_aabbBit},set:function(e){e?this.flags|=box2d.b2DrawFlags.e_aabbBit:this.flags&=~box2d.b2DrawFlags.e_aabbBit}}),Object.defineProperty(Phaser.Physics.Box2D.DefaultDebugDraw.prototype,"pairs",{get:function(){return this.flags&box2d.b2DrawFlags.e_pairBit},set:function(e){e?this.flags|=box2d.b2DrawFlags.e_pairBit:this.flags&=~box2d.b2DrawFlags.e_pairBit}}),Object.defineProperty(Phaser.Physics.Box2D.DefaultDebugDraw.prototype,"centerOfMass",{get:function(){return this.flags&box2d.b2DrawFlags.e_centerOfMassBit},set:function(e){e?this.flags|=box2d.b2DrawFlags.e_centerOfMassBit:this.flags&=~box2d.b2DrawFlags.e_centerOfMassBit}}),Phaser.Physics.Box2D.DefaultContactListener=function(){},Phaser.Physics.Box2D.DefaultContactListener.prototype.BeginContact=function(e){this.handleContactBeginOrEnd(e,!0)},Phaser.Physics.Box2D.DefaultContactListener.prototype.EndContact=function(e){this.handleContactBeginOrEnd(e,!1)},Phaser.Physics.Box2D.DefaultContactListener.prototype.handleContactBeginOrEnd=function(e,t){var i=e.GetFixtureA(),s=e.GetFixtureB(),a=i.GetBody(),n=s.GetBody(),o=i.GetFilterData().categoryBits,r=s.GetFilterData().categoryBits,l=a.parent,h=n.parent;if(void 0!==l&&void 0!==h){var c=l.id,p=h.id;l._bodyContactCallbacks[p]&&l._bodyContactCallbacks[p].call(l._bodyContactCallbackContext[p],l,h,i,s,t,e),h._bodyContactCallbacks[c]&&h._bodyContactCallbacks[c].call(h._bodyContactCallbackContext[c],h,l,s,i,t,e),l._fixtureContactCallbacks[s.id]&&l._fixtureContactCallbacks[s.id].call(l._fixtureContactCallbackContext[s.id],l,h,i,s,t,e),h._fixtureContactCallbacks[i.id]&&h._fixtureContactCallbacks[i.id].call(h._fixtureContactCallbackContext[i.id],h,l,s,i,t,e),l._fixtureContactCallbacks[i.id]&&l._fixtureContactCallbacks[i.id].call(l._fixtureContactCallbackContext[i.id],l,h,i,s,t,e),h._fixtureContactCallbacks[s.id]&&h._fixtureContactCallbacks[s.id].call(h._fixtureContactCallbackContext[s.id],h,l,s,i,t,e),l._categoryContactCallbacks[r]&&l._categoryContactCallbacks[r].call(l._categoryContactCallbackContext[r],l,h,i,s,t,e),h._categoryContactCallbacks[o]&&h._categoryContactCallbacks[o].call(h._categoryContactCallbackContext[o],h,l,s,i,t,e),l._categoryContactCallbacks[o]&&l._categoryContactCallbacks[o].call(l._categoryContactCallbackContext[o],l,h,i,s,t,e),h._categoryContactCallbacks[r]&&h._categoryContactCallbacks[r].call(h._categoryContactCallbackContext[r],h,l,s,i,t,e)}},Phaser.Physics.Box2D.DefaultContactListener.prototype.PreSolve=function(e,t){var i=e.GetFixtureA(),s=e.GetFixtureB(),a=i.GetBody(),n=s.GetBody(),o=i.GetFilterData().categoryBits,r=s.GetFilterData().categoryBits,l=a.parent,h=n.parent;if(void 0!==l&&void 0!==h){var c=l.id,p=h.id;l._bodyPresolveCallbacks[p]&&l._bodyPresolveCallbacks[p].call(l._bodyPresolveCallbackContext[p],l,h,i,s,e,t),h._bodyPresolveCallbacks[c]&&h._bodyPresolveCallbacks[c].call(h._bodyPresolveCallbackContext[c],h,l,s,i,e,t),l._fixturePresolveCallbacks[s.id]&&l._fixturePresolveCallbacks[s.id].call(l._fixturePresolveCallbackContext[s.id],l,h,i,s,e,t),h._fixturePresolveCallbacks[i.id]&&h._fixturePresolveCallbacks[i.id].call(h._fixturePresolveCallbackContext[i.id],h,l,s,i,e,t),l._categoryPresolveCallbacks[r]&&l._categoryPresolveCallbacks[r].call(l._categoryPresolveCallbackContext[r],l,h,i,s,e,t),h._categoryPresolveCallbacks[o]&&h._categoryPresolveCallbacks[o].call(h._categoryPresolveCallbackContext[o],h,l,s,i,e,t)}},Phaser.Physics.Box2D.DefaultContactListener.prototype.PostSolve=function(e,t){var i=e.GetFixtureA(),s=e.GetFixtureB(),a=i.GetBody(),n=s.GetBody(),o=i.GetFilterData().categoryBits,r=s.GetFilterData().categoryBits,l=a.parent,h=n.parent;if(void 0!==l&&void 0!==h){var c=l.id,p=h.id;l._bodyPostsolveCallbacks[p]&&l._bodyPostsolveCallbacks[p].call(l._bodyPostsolveCallbackContext[p],l,h,i,s,e,t),h._bodyPostsolveCallbacks[c]&&h._bodyPostsolveCallbacks[c].call(h._bodyPostsolveCallbackContext[c],h,l,s,i,e,t),l._fixturePostsolveCallbacks[s.id]&&l._fixturePostsolveCallbacks[s.id].call(l._fixturePostsolveCallbackContext[s.id],l,h,i,s,e,t),h._fixturePostsolveCallbacks[i.id]&&h._fixturePostsolveCallbacks[i.id].call(h._fixturePostsolveCallbackContext[i.id],h,l,s,i,e,t),l._categoryPostsolveCallbacks[r]&&l._categoryPostsolveCallbacks[r].call(l._categoryPostsolveCallbackContext[r],l,h,i,s,e,t),h._categoryPostsolveCallbacks[o]&&h._categoryPostsolveCallbacks[o].call(h._categoryPostsolveCallbackContext[o],h,l,s,i,e,t)}},Phaser.Physics.Box2D.Polygon=function(){this.vertices=[]},Phaser.Physics.Box2D.Polygon.prototype.setFromFlatXYCoords=function(e){this.vertices=[];for(var t=0;t<e.length/2;t++)this.vertices.push({x:e[2*t],y:e[2*t+1]})},Phaser.Physics.Box2D.Polygon.prototype.setFromXYObjects=function(e){this.vertices=e.concat()},Phaser.Physics.Box2D.Polygon.prototype.addVertex=function(e){this.vertices.push(e)},Phaser.Physics.Box2D.Polygon.prototype.at=function(e){var t=this.vertices.length;return this.vertices[0>e?e%t+t:e%t]},Phaser.Physics.Box2D.Polygon.prototype.indicesAreAdjacent=function(e,t){if(e%=this.vertices.length,t%=this.vertices.length,e==t)return!0;var i=Math.abs(e-t);return 2>i||i==this.vertices.length-1},Phaser.Physics.Box2D.Polygon.prototype.areaInTriangle=function(e,t,i){return e=this.at(e),t=this.at(t),i=this.at(i),.5*((t.x-e.x)*(i.y-e.y)-(i.x-e.x)*(t.y-e.y))},Phaser.Physics.Box2D.Polygon.prototype.left=function(e,t,i){return this.areaInTriangle(e,t,i)>0},Phaser.Physics.Box2D.Polygon.prototype.leftOn=function(e,t,i){return this.areaInTriangle(e,t,i)>=0},Phaser.Physics.Box2D.Polygon.prototype.right=function(e,t,i){return this.areaInTriangle(e,t,i)<0},Phaser.Physics.Box2D.Polygon.prototype.rightOn=function(e,t,i){return this.areaInTriangle(e,t,i)<=0},Phaser.Physics.Box2D.Polygon.sqdist=function(e,t){var i=t.x-e.x,s=t.y-e.y;return i*i+s*s},Phaser.Physics.Box2D.Polygon.prototype.makeCCW=function(){for(var e=0,t=1,i=this.vertices.length;i>t;t++)(this.at(t).y<this.at(e).y||this.at(t).y===this.at(e).y&&this.at(t).x>this.at(e).x)&&(e=t);return!this.left(e-1,e,e+1)&&(this.vertices.reverse(),!0)},Phaser.Physics.Box2D.Polygon.prototype.isConvex=function(){for(var e=!1,t=!1,i=0,s=this.vertices.length;s>i;i++){var a=i,n=(i+1)%s,o=(i+2)%s;this.areaInTriangle(this.vertices[a],this.vertices[n],this.vertices[o])>0?e=!0:t=!0}return t^e},Phaser.Physics.Box2D.Polygon.prototype.isReflex=function(e){return this.right(e-1,e,e+1)},Phaser.Physics.Box2D.Polygon.areVecsEqual=function(e,t){return e.x==t.x&&e.y==t.y},Phaser.Physics.Box2D.Polygon.linesCross=function(e,t,i,s){if(Phaser.Physics.Box2D.Polygon.areVecsEqual(t,i)||Phaser.Physics.Box2D.Polygon.areVecsEqual(e,i)||Phaser.Physics.Box2D.Polygon.areVecsEqual(t,s)||Phaser.Physics.Box2D.Polygon.areVecsEqual(e,s))return null;var a={};box2d.b2SubVV(t,e,a),box2d.b2CrossVS(a,1,a);var n=box2d.b2DotVV(a,e),o=box2d.b2DotVV(a,i),r=box2d.b2DotVV(a,s);if(o>n&&r>n)return null;if(n>o&&n>r)return null;var l={};box2d.b2SubVV(s,i,l),box2d.b2CrossVS(l,1,l);var o=box2d.b2DotVV(l,i),n=box2d.b2DotVV(l,e),h=box2d.b2DotVV(l,t);if(n>o&&h>o)return null;if(o>n&&o>h)return null;var c=(o-n)/(h-n);return{x:e.x+c*(t.x-e.x),y:e.y+c*(t.y-e.y)}},Phaser.Physics.Box2D.Polygon.prototype.canSee=function(e,t){if(this.indicesAreAdjacent(e,t))return!1;if(this.leftOn(e+1,e,t)&&this.rightOn(e-1,e,t))return!1;for(var i=0;i<this.vertices.length;++i)if((i+1)%this.vertices.length!=e&&i!=e&&this.leftOn(e,t,i+1)&&this.rightOn(e,t,i)&&Phaser.Physics.Box2D.Polygon.linesCross(this.at(e),this.at(t),this.at(i),this.at(i+1)))return!1;return!0},Phaser.Physics.Box2D.Polygon.prototype.subPolygon=function(e,t){var i=new Phaser.Physics.Box2D.Polygon;if(t>e)for(s=e;t+1>s;s++)i.addVertex(this.at(s));else{for(s=e;s<this.vertices.length;s++)i.addVertex(this.at(s));for(var s=0;t+1>s;s++)i.addVertex(this.at(s))}return i},Phaser.Physics.Box2D.Polygon.prototype.decomposeOptimal=function(e){if(void 0===e&&(e=0),e>1)return this.vertices;this.makeCCW();for(var t=[],i=[],s=[],a=Number.MAX_VALUE,n=0;n<this.vertices.length;n++)if(this.isReflex(n))for(var o=0;o<this.vertices.length;o++)this.canSee(n,o)&&(i=this.subPolygon(n,o).decompose(e+1),s=this.subPolygon(o,n).decompose(e+1),i.length+s.length<a&&(t=i.concat(s),a=t.length));return 0===t.length&&t.push(this.vertices),t},Phaser.Physics.Box2D.Polygon.prototype.decompose=function(e){void 0===e&&(e=0),this.makeCCW();for(var t,i,s=[],a=Number.MAX_VALUE,n=!1,o=0;o<this.vertices.length;o++)if(this.isReflex(o)){n=!0;for(var r=this.at(o),l=0;l<this.vertices.length;l++)if(this.canSee(o,l)){var h=this.at(l),c=h.x-r.x,p=h.y-r.y,d=c*c*p*p;a>d&&(t=o,i=l,a=d)}}if(!n&&this.vertices.length>8&&(t=0,i=Math.floor(this.vertices.length/2),n=!0),n){var u=this.subPolygon(t,i).decompose(e+1),m=this.subPolygon(i,t).decompose(e+1);s=u.concat(m)}return 0===s.length&&s.push(this.vertices),s};var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function s(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(s.prototype=i.prototype,new s)}}(),__awaiter=this&&this.__awaiter||function(e,t,i,s){return new(i||(i=Promise))(function(a,n){function o(e){try{l(s.next(e))}catch(e){n(e)}}function r(e){try{l(s.throw(e))}catch(e){n(e)}}function l(e){e.done?a(e.value):new i(function(t){t(e.value)}).then(o,r)}l((s=s.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function i(e){return function(t){return s([e,t])}}function s(i){if(a)throw new TypeError("Generator is already executing.");for(;l;)try{if(a=1,n&&(o=n[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,n=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(o=l.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){l=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){l.label=i[1];break}if(6===i[0]&&l.label<o[1]){l.label=o[1],o=i;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(i);break}o[2]&&l.ops.pop(),l.trys.pop();continue}i=t.call(e,l)}catch(e){i=[6,e],n=0}finally{a=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var a,n,o,r,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r},SceneList;!function(e){e.Boot="Boot",e.Menu="Menu",e.LevelBuilder="LevelBuilder",e.Comix1="Comix1",e.Comix2="Comix2"}(SceneList||(SceneList={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=t.call(this,{enableDebug:!1,width:Constants.GAME_WIDTH,height:Constants.GAME_HEIGHT,renderer:Phaser.AUTO,parent:Constants.DIV_ID,transparent:!1,antialias:!0,preserveDrawingBuffer:!1,physicsConfig:null,seed:"",state:null,forceSetTimeOut:!1})||this;return e.soundStarted=!1,e.pausedByPanel=!1,i.instance=e,e.clearBeforeRender=!1,Phaser.Device.whenReady(function(){e.stage.disableVisibilityChange=!0;var t=e.device.desktop?"click":"touchstart";document.getElementById("content").addEventListener(t,function(t){e.gameResumed(t)}),WheelyScale.ScaleHelper.init(e)}),e.state.add("game",{create:e.stateCreator.bind(e),preload:e.statePreloader.bind(e)},!0),e}return __extends(i,t),i.prototype.statePreloader=function(){var e=this;libs.forEach(function(t){e.load.script(t,t)})},i.prototype.stateCreator=function(){this.plugins.add(Fabrique.Plugins.GameEvents),this.plugins.add(Fabrique.Plugins.GoogleAnalytics),this.plugins.add(Fabrique.Plugins.GameAnalytics),this.plugins.add(PhaserAds.AdManager),this.plugins.add(PhaserSuperStorage.StoragePlugin),this.plugins.add(PhaserCachebuster.CacheBuster),this.plugins.add(PhaserSpine.SpinePlugin),this.storage.forcePromises=!0,this.state.add(e.Boot.Name,e.Boot,!1),this.state.add(Fabrique.SplashScreen.Preloader.Name,Fabrique.SplashScreen.Preloader,!1),this.state.add(e.Menu.Name,e.Menu,!1),this.state.add(e.Comix1.Name,e.Comix1,!1),this.state.add(e.Comix2.Name,e.Comix2,!1),this.state.add(e.LevelBuilder.Name,e.LevelBuilder,!1),this.state.start(e.Boot.Name),this.state.remove("game"),this.sceneEffect=this.add.graphics(0,0),this.sceneEffect.beginFill(16777215,1),this.sceneEffect.drawRect(0,0,e.Variables.SW,e.Variables.SH),this.sceneEffect.alpha=0,this.stage.addChild(this.sceneEffect),this.state.onStateChange.add(this.changeSceneEffect,this)},i.prototype.changeSceneEffect=function(){(this.state.current===SceneList.Menu||this.state.current===SceneList.LevelBuilder||this.state)&&(e.SoundManager.removeAllSFXLoop(),this.sceneEffect.alpha=1,this.add.tween(this.sceneEffect).to({alpha:0},500,Phaser.Easing.Linear.None,!0))},i.instance=null,i.showDebugBox2d=!1,i.disablePause=!1,i}(Phaser.Game);e.Main=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n,o,r){var l=t.call(this,e.Main.instance,s,a,n,o,r)||this;return l.anchor.setTo(.5),l.id=i,l.setButtonFrames(),l.id===e.SoundType.Music?(l._onOverFrame="btnMusic instance 10002",l._onDownFrame="btnMusic instance 10003"):(l._onOverFrame="btnSFX instance 10002",l._onDownFrame="btnSFX instance 10003"),l.events.onInputOver.add(l.over,l),l.forceOut=!0,l}return __extends(i,t),i.prototype.addSprite=function(t,i){this.tileNameOn=t,this.tileNameOff=i,this.graphic=e.Main.instance.add.sprite(0,0,this.key,this.getFrame()),this.graphic.anchor.setTo(.5),this.addChild(this.graphic)},i.prototype.onInputUpHandler=function(t,i,s){!0===s&&(e.SoundManager.setEnabled(this.id),e.SoundManager.playSFX("btnClick"),this.setButtonFrames()),this.scale.setTo(1)},i.prototype.over=function(){e.SoundManager.playSFX("btnOver")},i.prototype.getFrame=function(){return!0===e.SoundManager.getEnabled(this.id)?this.tileNameOn:this.tileNameOff},i.prototype.setButtonFrames=function(){this.id===e.SoundType.Music?!1===e.SoundManager.getEnabled(this.id)?this._onOutFrame="btnMusic instance 10001":this._onOutFrame="btnMusic instance 10000":!1===e.SoundManager.getEnabled(this.id)?this._onOutFrame="btnSFX instance 10001":this._onOutFrame="btnSFX instance 10000",this.frameName=this._onOutFrame},i.prototype.destroy=function(){t.prototype.destroy.call(this),this.graphic=null},i}(Phaser.Button);e.ButtonSound=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this,i,s,a,"ui","btnWalkthrough instance 10000")||this;return n.anchor.setTo(.5),n.inputEnabled=!0,n.input.start(0,!0),n.input.useHandCursor=!0,n.events.onInputOver.add(n.onInputOverHandler,n),n.events.onInputOut.add(n.onInputOutHandler,n),n.events.onInputUp.add(n.onInputUpHandler,n),n.events.onRemovedFromWorld.add(n.removedFromWorld,n),n.text=new e.DancingText(e.Main.instance,n,-55,2,14,"WALKTHROUGH",16),n}return __extends(i,t),i.prototype.update=function(){this.text.update()},i.prototype.removedFromWorld=function(){this.inputEnabled=!1},i.prototype.onInputOverHandler=function(t,i){this.text.startDancing(),e.SoundManager.playSFX("btnOver"),this.frameName="btnWalkthrough instance 10001"},i.prototype.onInputOutHandler=function(e,t){this.frameName="btnWalkthrough instance 10000"},i.prototype.onInputUpHandler=function(e,t,i){!0===i&&window.op3n(Constants.WALKTHROUGH_URL,"_blank")},i.prototype.destroy=function(){t.prototype.destroy.call(this),this.text.free(),this.text=null},i}(Phaser.Image);e.ButtonWalkthrough=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e,i,s,a,n,o,r,l,h,c,p){var d=t.call(this,i,s,a,n,o,r,l,h,c,p)||this;return d.id=e,d.anchor.set(.5),d.name=""+e,d.onInputOver.add(d.over,d),d.onInputOut.add(d.out,d),d.levelText=d.game.make.sprite(-18,-26,"ui","numbers instance "+(e-1+1e4)),d.addChild(d.levelText),d}return __extends(i,t),i.prototype.addStars=function(){var t,i=0;return 1===e.DataManager.getInstance().saveObj["questFlag"+this.id]&&((t=this.game.make.sprite(0,17,"ui","star instance 10000")).anchor.setTo(.5),t.scale.setTo(.55),this.addChild(t),i+=1),1===e.DataManager.getInstance().saveObj["questWheel"+this.id]&&((t=this.game.make.sprite(-18,13,"ui","star instance 10000")).anchor.setTo(.5),t.scale.setTo(.55),t.angle=-9,this.addChild(t),i+=1),1===e.DataManager.getInstance().saveObj["questCar"+this.id]&&((t=this.game.make.sprite(18,13,"ui","star instance 10000")).anchor.setTo(.5),t.scale.setTo(.55),t.angle=9,this.addChild(t),i+=1),t=null,i},i.prototype.addLock=function(){this.lock=this.game.make.sprite(32,-29,"ui","lock instance 10000"),this.lock.anchor.set(.5),this.addChild(this.lock)},i.prototype.over=function(){e.SoundManager.playSFX("btnOver"),this.scale.setTo(1.1)},i.prototype.out=function(){this.scale.setTo(1)},i.prototype.destroy=function(){t.prototype.destroy.call(this),this.lock=null,this.levelText=null},i}(Phaser.Button);e.LevelSelectButton=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(e){this.scores=[],this.currentLevel=1,this.game=e}return e.getInstance=function(t){return e.instance||(e.instance=new e(t)),e.instance},e.prototype.init=function(){var e=this;this.loadData("w6_svData").then(function(t){if(null===t||void 0===t)e.saveObj=e.getSaveObj(),e.save();else{var i=JSON.parse(t);e.saveObj=i,e.scores=e.saveObj.sc,e.currentLevel=e.saveObj.lvl}})},e.prototype.getSaveObj=function(){return{m:1,fx:1,sc:this.scores,lvl:this.currentLevel,pl:1}},e.prototype.clearData=function(){this.game.storage.clear()},e.prototype.save=function(){this.game.storage.setItem("w6_svData",JSON.stringify(this.saveObj))},e.prototype.saveData=function(e,t){this.saveObj[e]=t,this.save()},e.prototype.loadData=function(e){return this.game.storage.getItem(e)},e.prototype.getData=function(e,t){return __awaiter(this,void 0,void 0,function(){var i,s;return __generator(this,function(a){switch(a.label){case 0:return[4,this.loadData(e)];case 1:return i=a.sent(),s=t,null===i&&void 0===i||(s=JSON.parse(i)),[2,s]}})})},e.prototype.saveScore=function(e,t,i){this.keepOldScore(t-1,i)||(this.setScore(t-1,i),this.save())},e.prototype.setScore=function(e,t){this.scores[e]=t},e.prototype.keepOldScore=function(e,t){var i=this.scores[e];return-1!==i&&void 0!==i&&!(t>i)},e.prototype.keepOldLevel=function(e){return!(e>this.currentLevel)},e.prototype.saveLevel=function(e){this.keepOldLevel(e)||(this.currentLevel=e,this.saveObj.lvl=this.currentLevel,this.save())},e.prototype.calcData=function(e,t,i){for(var s=0,a=0;a<this.scores.length;a++)s+=this.scores[a];return s},e}();e.DataManager=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(e){this.game=e}return e.getInstance=function(t){return e.instance||(e.instance=new e(t)),e.instance},e.prototype.init=function(){this.currentMenuScreen=0,this.currentLevel=6},e}();e.LevelManager=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=0,this.y=0,this.x=e,this.y=t}return Object.defineProperty(e.prototype,"angle",{get:function(){return this.x===this.y&&0===this.x?0:Math.atan2(this.y,this.x)},set:function(e){var t=length;this.x=t*Math.cos(e),this.y=t*Math.sin(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},set:function(e){var t=e/Math.sqrt(this.x*this.x+this.y*this.y);this.x*=t,this.y*=t},enumerable:!0,configurable:!0}),e.prototype.normalise=function(){var e=this.x*this.x+this.y*this.y,t=1/Math.sqrt(e);return this.x*=t,this.y*=t,this},e.prototype.muleq=function(e){return this.setxy(this.x*e,this.y*e)},e.prototype.setxy=function(e,t){return this.x=e,this.y=t,this},e.prototype.getBox2db2Vec2=function(e){return void 0===e&&(e=1),new box2d.b2Vec2(this.x*e,this.y*e)},e}();e.NapeVec2=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(){}return e.setGraphicsChildrensMask=function(e,t){void 0===t&&(t=!0),!0===t?e.renderType===Phaser.CANVAS?this.setDefaultMaskCanvas(e):e.renderType===Phaser.WEBGL&&this.setDefaultMaskWebGL(e):e.renderType===Phaser.CANVAS?this.setGraphicsChildrensMaskCanvas(e):e.renderType===Phaser.WEBGL&&this.setGraphicsChildrensMaskWebGL(e)},e.setGraphicsChildrensMaskCanvas=function(e){e.renderer.renderSession.maskManager.pushMask=function(e,t){var i=t.context;i.save(),i.beginPath();for(var s=0;s<e.children.length;s++){var a=e.children[s],n=a.alpha,o=a.worldTransform,r=t.resolution;i.setTransform(o.a*r,o.b*r,o.c*r,o.d*r,o.tx*r,o.ty*r),PIXI.CanvasGraphics.renderGraphicsMask(e.children[s],i),a.worldAlpha=n}i.clip()},PIXI.CanvasGraphics.renderGraphicsMask=function(e,t){var i=e.graphicsData.length;if(0!==i)for(var s=0;s<i;s++){var a=e.graphicsData[s],n=a.shape;if(a.type===Phaser.POLYGON){var o=n.points;t.moveTo(o[0],o[1]);for(var r=1;r<o.length/2;r++)t.lineTo(o[2*r],o[2*r+1]);o[0]===o[o.length-2]&&o[1]===o[o.length-1]&&t.closePath()}else if(a.type===Phaser.RECTANGLE)t.rect(n.x,n.y,n.width,n.height),t.closePath();else if(a.type===Phaser.CIRCLE)t.arc(n.x,n.y,n.radius,0,2*Math.PI),t.closePath();else if(a.type===Phaser.ELLIPSE){var l=2*n.width,h=2*n.height,c=n.x-l/2,p=n.y-h/2,d=l/2*.5522848,u=h/2*.5522848,m=c+l,g=p+h,y=c+l/2,b=p+h/2;t.moveTo(c,b),t.bezierCurveTo(c,b-u,y-d,p,y,p),t.bezierCurveTo(y+d,p,m,b-u,m,b),t.bezierCurveTo(m,b+u,y+d,g,y,g),t.bezierCurveTo(y-d,g,c,b+u,c,b),t.closePath()}else if(a.type===Phaser.ROUNDEDRECTANGLE){var x=n.x,v=n.y,f=n.width,w=n.height,k=n.radius,_=Math.min(f,w)/2|0;k=k>_?_:k,t.moveTo(x,v+k),t.lineTo(x,v+w-k),t.quadraticCurveTo(x,v+w,x+k,v+w),t.lineTo(x+f-k,v+w),t.quadraticCurveTo(x+f,v+w,x+f,v+w-k),t.lineTo(x+f,v+k),t.quadraticCurveTo(x+f,v,x+f-k,v),t.lineTo(x+k,v),t.quadraticCurveTo(x,v,x,v+k),t.closePath()}}}},e.setGraphicsChildrensMaskWebGL=function(e){e.renderer.maskManager.pushMask=function(e,t){for(var i=t.gl,s=0,a=0;a<e.children.length;a++){var n=e.children[a];n.dirty&&PIXI.WebGLGraphics.updateGraphics(n,i),void 0!==n._webGL[i.id]&&void 0!==n._webGL[i.id].data&&0!==n._webGL[i.id].data.length&&(s+=1,t.stencilManager.pushStencil(n,n._webGL[i.id].data[0],t))}0!==s&&t.stencilManager.count++},e.renderer.renderSession.stencilManager.pushStencil=function(e,t,i){var s=this.gl;this.bindGraphics(e,t,i),0===this.stencilStack.length&&(s.enable(s.STENCIL_TEST),s.clear(s.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(t);var a=this.count;s.colorMask(!1,!1,!1,!1),s.stencilFunc(s.ALWAYS,0,255),s.stencilOp(s.KEEP,s.KEEP,s.INVERT),1===t.mode?(s.drawElements(s.TRIANGLE_FAN,t.indices.length-4,s.UNSIGNED_SHORT,0),this.reverse?(s.stencilFunc(s.EQUAL,255-a,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)):(s.stencilFunc(s.EQUAL,a,255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)),s.drawElements(s.TRIANGLE_FAN,4,s.UNSIGNED_SHORT,2*(t.indices.length-4)),this.reverse?s.stencilFunc(s.EQUAL,255-(a+1),255):s.stencilFunc(s.EQUAL,a+1,255),this.reverse=!this.reverse):(this.reverse?(s.stencilFunc(s.EQUAL,a,255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)):(s.stencilFunc(s.EQUAL,255-a,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)),s.drawElements(s.TRIANGLE_STRIP,t.indices.length,s.UNSIGNED_SHORT,0),this.reverse?s.stencilFunc(s.EQUAL,a+1,255):s.stencilFunc(s.EQUAL,255-(a+1),255)),s.colorMask(!0,!0,!0,!0),s.stencilOp(s.KEEP,s.KEEP,s.KEEP)},e.renderer.maskManager.popMask=function(e,t){for(var i=this.gl,s=!0,a=0;a<e.children.length;a++){var n=e.children[a];void 0!==n._webGL[i.id]&&void 0!==n._webGL[i.id].data&&0!==n._webGL[i.id].data.length&&(!0===s&&(s=!1,t.stencilManager.count--),t.stencilManager.popStencil(n,n._webGL[i.id].data[0],t))}},e.renderer.renderSession.stencilManager.popStencil=function(e,t,i){var s=this.gl;if(this.stencilStack.pop(),0===this.stencilStack.length)s.disable(s.STENCIL_TEST);else{var a=this.count;this.bindGraphics(e,t,i),s.colorMask(!1,!1,!1,!1),1===t.mode?(this.reverse=!this.reverse,this.reverse?(s.stencilFunc(s.EQUAL,255-(a+1),255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)):(s.stencilFunc(s.EQUAL,a+1,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)),s.drawElements(s.TRIANGLE_FAN,4,s.UNSIGNED_SHORT,2*(t.indices.length-4)),s.stencilFunc(s.ALWAYS,0,255),s.stencilOp(s.KEEP,s.KEEP,s.INVERT),s.drawElements(s.TRIANGLE_FAN,t.indices.length-4,s.UNSIGNED_SHORT,0),this.reverse?s.stencilFunc(s.EQUAL,a,255):s.stencilFunc(s.EQUAL,255-a,255)):(this.reverse?(s.stencilFunc(s.EQUAL,a+1,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)):(s.stencilFunc(s.EQUAL,255-(a+1),255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)),s.drawElements(s.TRIANGLE_STRIP,t.indices.length,s.UNSIGNED_SHORT,0),this.reverse?s.stencilFunc(s.EQUAL,a,255):s.stencilFunc(s.EQUAL,255-a,255)),s.colorMask(!0,!0,!0,!0),s.stencilOp(s.KEEP,s.KEEP,s.KEEP)}}},e.setDefaultMaskCanvas=function(e){e.renderer.renderSession.maskManager.pushMask=function(e,t){var i=t.context;i.save();var s=e.alpha,a=e.worldTransform,n=t.resolution;i.setTransform(a.a*n,a.b*n,a.c*n,a.d*n,a.tx*n,a.ty*n),PIXI.CanvasGraphics.renderGraphicsMask(e,i),i.clip(),e.worldAlpha=s},PIXI.CanvasGraphics.renderGraphicsMask=function(e,t){var i=e.graphicsData.length;if(0!==i){t.beginPath();for(var s=0;s<i;s++){var a=e.graphicsData[s],n=a.shape;if(a.type===Phaser.POLYGON){var o=n.points;t.moveTo(o[0],o[1]);for(var r=1;r<o.length/2;r++)t.lineTo(o[2*r],o[2*r+1]);o[0]===o[o.length-2]&&o[1]===o[o.length-1]&&t.closePath()}else if(a.type===Phaser.RECTANGLE)t.rect(n.x,n.y,n.width,n.height),t.closePath();else if(a.type===Phaser.CIRCLE)t.arc(n.x,n.y,n.radius,0,2*Math.PI),t.closePath();else if(a.type===Phaser.ELLIPSE){var l=2*n.width,h=2*n.height,c=n.x-l/2,p=n.y-h/2,d=l/2*.5522848,u=h/2*.5522848,m=c+l,g=p+h,y=c+l/2,b=p+h/2;t.moveTo(c,b),t.bezierCurveTo(c,b-u,y-d,p,y,p),t.bezierCurveTo(y+d,p,m,b-u,m,b),t.bezierCurveTo(m,b+u,y+d,g,y,g),t.bezierCurveTo(y-d,g,c,b+u,c,b),t.closePath()}else if(a.type===Phaser.ROUNDEDRECTANGLE){var x=n.x,v=n.y,f=n.width,w=n.height,k=n.radius,_=Math.min(f,w)/2|0;k=k>_?_:k,t.moveTo(x,v+k),t.lineTo(x,v+w-k),t.quadraticCurveTo(x,v+w,x+k,v+w),t.lineTo(x+f-k,v+w),t.quadraticCurveTo(x+f,v+w,x+f,v+w-k),t.lineTo(x+f,v+k),t.quadraticCurveTo(x+f,v,x+f-k,v),t.lineTo(x+k,v),t.quadraticCurveTo(x,v,x,v+k),t.closePath()}}}}},e.setDefaultMaskWebGL=function(e){e.renderer.maskManager.pushMask=function(e,t){var i=t.gl;e.dirty&&PIXI.WebGLGraphics.updateGraphics(e,i),void 0!==e._webGL[i.id]&&void 0!==e._webGL[i.id].data&&0!==e._webGL[i.id].data.length&&t.stencilManager.pushStencil(e,e._webGL[i.id].data[0],t)},e.renderer.renderSession.stencilManager.pushStencil=function(e,t,i){var s=this.gl;this.bindGraphics(e,t,i),0===this.stencilStack.length&&(s.enable(s.STENCIL_TEST),s.clear(s.STENCIL_BUFFER_BIT),this.reverse=!0,this.count=0),this.stencilStack.push(t);var a=this.count;s.colorMask(!1,!1,!1,!1),s.stencilFunc(s.ALWAYS,0,255),s.stencilOp(s.KEEP,s.KEEP,s.INVERT),1===t.mode?(s.drawElements(s.TRIANGLE_FAN,t.indices.length-4,s.UNSIGNED_SHORT,0),this.reverse?(s.stencilFunc(s.EQUAL,255-a,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)):(s.stencilFunc(s.EQUAL,a,255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)),s.drawElements(s.TRIANGLE_FAN,4,s.UNSIGNED_SHORT,2*(t.indices.length-4)),this.reverse?s.stencilFunc(s.EQUAL,255-(a+1),255):s.stencilFunc(s.EQUAL,a+1,255),this.reverse=!this.reverse):(this.reverse?(s.stencilFunc(s.EQUAL,a,255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)):(s.stencilFunc(s.EQUAL,255-a,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)),s.drawElements(s.TRIANGLE_STRIP,t.indices.length,s.UNSIGNED_SHORT,0),this.reverse?s.stencilFunc(s.EQUAL,a+1,255):s.stencilFunc(s.EQUAL,255-(a+1),255)),s.colorMask(!0,!0,!0,!0),s.stencilOp(s.KEEP,s.KEEP,s.KEEP),this.count++},e.renderer.maskManager.popMask=function(e,t){var i=this.gl;void 0!==e._webGL[i.id]&&void 0!==e._webGL[i.id].data&&0!==e._webGL[i.id].data.length&&t.stencilManager.popStencil(e,e._webGL[i.id].data[0],t)},e.renderer.renderSession.stencilManager.popStencil=function(e,t,i){var s=this.gl;if(this.stencilStack.pop(),this.count--,0===this.stencilStack.length)s.disable(s.STENCIL_TEST);else{var a=this.count;this.bindGraphics(e,t,i),s.colorMask(!1,!1,!1,!1),1===t.mode?(this.reverse=!this.reverse,this.reverse?(s.stencilFunc(s.EQUAL,255-(a+1),255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)):(s.stencilFunc(s.EQUAL,a+1,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)),s.drawElements(s.TRIANGLE_FAN,4,s.UNSIGNED_SHORT,2*(t.indices.length-4)),s.stencilFunc(s.ALWAYS,0,255),s.stencilOp(s.KEEP,s.KEEP,s.INVERT),s.drawElements(s.TRIANGLE_FAN,t.indices.length-4,s.UNSIGNED_SHORT,0),this.reverse?s.stencilFunc(s.EQUAL,a,255):s.stencilFunc(s.EQUAL,255-a,255)):(this.reverse?(s.stencilFunc(s.EQUAL,a+1,255),s.stencilOp(s.KEEP,s.KEEP,s.DECR)):(s.stencilFunc(s.EQUAL,255-(a+1),255),s.stencilOp(s.KEEP,s.KEEP,s.INCR)),s.drawElements(s.TRIANGLE_STRIP,t.indices.length,s.UNSIGNED_SHORT,0),this.reverse?s.stencilFunc(s.EQUAL,a,255):s.stencilFunc(s.EQUAL,255-a,255)),s.colorMask(!0,!0,!0,!0),s.stencilOp(s.KEEP,s.KEEP,s.KEEP)}}},e}();e.NativeChanges=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Constants=function(){function e(){}return e.DIV_ID="content",e.GAME_SCALE=1,e.CALCULATED_WIDTH=0,e.CALCULATED_HEIGHT=0,e.GAME_WIDTH=800,e.GAME_HEIGHT=600,e.LANDSCAPE_LOCKED=!0,e.PORTRAIT_LOCKED=!1,e.GAMEDISTRIBUTION_ID="0095b1d5dcb645d88971010491627362",e.GAMEDISTRIBUTION_USER="ABD36C6C-E74B-4BA7-BE87-0AB01F98D30D-s1",e.GAME_KEY="48645f2f5c76f7832584caa1f053c592",e.SECRET_KEY="69d3d3877fed0534f0a2b3bb2df162a91d08fa93",e.GOOGLE_ID="UA-85519155-27",e.GOOGLE_APP_NAME="Wheely 6",e.LOGO_URL="http://kizi.com/?ch=3235&utm_source=GameDistribution",e.WALKTHROUGH_URL="http://kizi.com/videos/wheely-6-full-walkthrough/?ch=3236&utm_source=GameDistribution",e}(),WheelyScale;!function(e){var t=function(){function t(){}return t.init=function(e){this.game=e,this.dom=document.getElementById(this.dom_id),e.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,this.resize(),window.addEventListener("resize",function(e){return t.resize()})},t.resize=function(){var t,i,s=window.innerWidth,a=window.innerHeight,n={w:this.game_w,h:this.game_h,sw:this.game_sw,sh:this.game_sh};n.h/n.w>a/s?n.sh/n.w>a/s?t=(i=a*n.h/n.sh)*n.w/n.h:i=(t=s)*n.h/n.w:n.h/n.sw>a/s?t=(i=a)*n.w/n.h:i=(t=s*n.w/n.sw)*n.h/n.w;var o=t/n.sw,r=i/n.sh,l=Math.min(o,r);e.ScaleHelper.game.scale.setUserScale(l,l,0,0),this.dtx=(s-t)/2,this.dty=(a-i)/2,this.gameViewW=this.game_w+2*this.dtx/l,this.gameViewW>this.game_w&&(this.gameViewW=this.game_w),this.gameViewH=this.game_h+2*this.dty/l,this.gameViewH>this.game_h&&(this.gameViewH=this.game_h),this.dom.style.marginLeft=Math.round(this.dtx).toString()+"px",this.dom.style.marginTop=Math.round(this.dty).toString()+"px",this.dom.style.maxWidth=String(t)+"px",this.dom.style.maxHeight=String(i)+"px",e.ScaleHelper.game.scale.refresh(),Constants.LANDSCAPE_LOCKED?s>a?this.handleCorrect():this.handleIncorrect():Constants.PORTRAIT_LOCKED&&(s<a?this.handleCorrect():this.handleIncorrect()),setTimeout("window.scrollTo(0,0)",1e3)},t.handleCorrect=function(){this.dom.style.display="block",document.getElementById("orientation").style.display="none"},t.handleIncorrect=function(){this.dom.style.display="none",document.getElementById("orientation").style.display="block",this.game.state.current===SceneList.LevelBuilder&&Wheely.Client.LevelBuilder.instance.paused()},t.dom_id=Constants.DIV_ID,t.game_w=Constants.GAME_WIDTH,t.game_h=Constants.GAME_HEIGHT,t.game_sw=Constants.GAME_WIDTH,t.game_sh=Constants.GAME_HEIGHT,t.dtx=0,t.dty=0,t}();e.ScaleHelper=t}(WheelyScale||(WheelyScale={}));var Wheely;!function(e){!function(e){var t=function(){function e(){this.working=!1,this.counter=0,this.smartRotation=!1,this.tweenDetails=new Array}return e.prototype.start=function(e,t,i,s){void 0===s&&(s=!1),0!==this.tweenDetails.length&&this.stop(),this.smartRotation=s,this.target=e,this.working=!0;var a,n;this.counter=0,this.duration=t;for(var o=0,r=Object.keys(i);o<r.length;o++){var l=r[o];(a=this.target[l])!==(n=i[l])&&this.tweenDetails.push({propertyName:l,start:a,change:n-a})}},e.prototype.stop=function(){this.working=!1,this.tweenDetails.splice(0,this.tweenDetails.length),null!==this.target&&(this.target.name="use")},e.prototype.update=function(){if(!1!==this.working){this.counter+=1,this.percent=this.counter/this.duration;for(var e=0;e<this.tweenDetails.length;e++)if(!0!==this.smartRotation||"angle"!==this.tweenDetails[e].propertyName&&"skX"!==this.tweenDetails[e].propertyName&&"skY"!==this.tweenDetails[e].propertyName)this.target[this.tweenDetails[e].propertyName]=this.tweenDetails[e].start+this.tweenDetails[e].change*this.percent;else{var t=this.tweenDetails[e].change%360;t>180?t-=360:t<-180&&(t+=360),this.target[this.tweenDetails[e].propertyName]=this.tweenDetails[e].start+t*this.percent}this.percent>=1&&this.stop()}},e.prototype.free=function(){this.target=null,this.tweenDetails=[],this.tweenDetails=null},e}();e.SimpleTween=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t,i,s,a,n){void 0===a&&(a=null),void 0===n&&(n=null);var o=e.call(this,t,i,s,a,n)||this;return o.a=1,o.b=0,o.c=0,o.d=1,o.tx=0,o.ty=0,o.tx=i,o.ty=s,o.updateTransform=function(e){if(!e&&!this.parent&&!this.game)return this;var t=this.parent;e?t=e:this.parent||(t=this.game.world);var i=t.worldTransform,s=this.worldTransform,a=this.tx,n=this.ty;if((this.pivot.x||this.pivot.y)&&(a-=this.pivot.x*this.a+this.pivot.y*this.c,n-=this.pivot.x*this.b+this.pivot.y*this.d),s.a=this.a*i.a+this.b*i.c,s.b=this.a*i.b+this.b*i.d,s.c=this.c*i.a+this.d*i.c,s.d=this.c*i.b+this.d*i.d,s.tx=a*i.a+n*i.c+i.tx,s.ty=a*i.b+n*i.d+i.ty,this.worldAlpha=this.alpha*t.worldAlpha,this.worldPosition.set(s.tx,s.ty),this.worldScale.set(this.scale.x*Math.sqrt(s.a*s.a+s.c*s.c),this.scale.y*Math.sqrt(s.b*s.b+s.d*s.d)),this.worldRotation=Math.atan2(-s.c,s.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,s,i),!this._cacheAsBitmap){for(var o=0;o<this.children.length;o++)this.children[o].updateTransform();return this}},o}return __extends(t,e),t.prototype.setParam=function(e,t,i,s,a,n){this.position.setTo(a,n),this.a=e,this.b=t,this.c=i,this.d=s,this.tx=a,this.ty=n},t}(Phaser.Sprite);e.MatrixSprite=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t,i,s){var a=e.call(this,t)||this;return a.skX=0,a.skY=0,a._srB=0,a._srC=0,a._crA=1,a._crD=1,a._cachedRotX=0,a._cachedRotY=0,a.x=i,a.y=s,a.updateTransform=function(e){if(!e&&!this.parent&&!this.game)return this;var t=this.parent;e?t=e:this.parent||(t=this.game.world);var i,s,a,n,o,r,l=t.worldTransform,h=this.worldTransform,c=this.rotation+this.skY*(Math.PI/180),p=this.rotation+this.skX*(Math.PI/180);if(c%Phaser.Math.PI2||p%Phaser.Math.PI2?(p===this._cachedRotX&&c===this._cachedRotY||(this._cachedRotX=p,this._cachedRotY=c,this._crA=Math.cos(c),this._srB=Math.sin(c),this._srC=Math.sin(-p),this._crD=Math.cos(p)),i=this._crA*this.scale.x,s=this._srB*this.scale.x,a=this._srC*this.scale.y,n=this._crD*this.scale.y,o=this.position.x,r=this.position.y,(this.pivot.x||this.pivot.y)&&(o-=this.pivot.x*i+this.pivot.y*a,r-=this.pivot.x*s+this.pivot.y*n),h.a=i*l.a+s*l.c,h.b=i*l.b+s*l.d,h.c=a*l.a+n*l.c,h.d=a*l.b+n*l.d,h.tx=o*l.a+r*l.c+l.tx,h.ty=o*l.b+r*l.d+l.ty):(i=this.scale.x,n=this.scale.y,o=this.position.x-this.pivot.x*i,r=this.position.y-this.pivot.y*n,h.a=i*l.a,h.b=i*l.b,h.c=n*l.c,h.d=n*l.d,h.tx=o*l.a+r*l.c+l.tx,h.ty=o*l.b+r*l.d+l.ty),this.worldAlpha=this.alpha*t.worldAlpha,this.worldPosition.set(h.tx,h.ty),this.worldScale.set(this.scale.x*Math.sqrt(h.a*h.a+h.c*h.c),this.scale.y*Math.sqrt(h.b*h.b+h.d*h.d)),this.worldRotation=Math.atan2(-h.c,h.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,h,l),!this._cacheAsBitmap){for(var d=0;d<this.children.length;d++)this.children[d].updateTransform();return this}},a}return __extends(t,e),Object.defineProperty(t.prototype,"scY",{get:function(){return this.scale.y},set:function(e){this.scale.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scX",{get:function(){return this.scale.x},set:function(e){this.scale.x=e},enumerable:!0,configurable:!0}),t}(Phaser.Group);e.SAGroup=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t,i,s,a,n){void 0===a&&(a=null),void 0===n&&(n=null);var o=e.call(this,t,i,s,a,n)||this;return o._skX=0,o._skY=0,o._srB=0,o._srC=0,o._crA=1,o._crD=1,o._cachedRotX=0,o._cachedRotY=0,o.updateTransform=function(e){if(!e&&!this.parent&&!this.game)return this;var t=this.parent;e?t=e:this.parent||(t=this.game.world);var i,s,a,n,o,r,l=t.worldTransform,h=this.worldTransform,c=this.rotation+this._skY*(Math.PI/180),p=this.rotation+this._skX*(Math.PI/180);if(c%Phaser.Math.PI2||p%Phaser.Math.PI2?(p===this._cachedRotX&&c===this._cachedRotY||(this._cachedRotX=p,this._cachedRotY=c,this._crA=Math.cos(c),this._srB=Math.sin(c),this._srC=Math.sin(-p),this._crD=Math.cos(p)),i=this._crA*this.scale.x,s=this._srB*this.scale.x,a=this._srC*this.scale.y,n=this._crD*this.scale.y,o=this.position.x,r=this.position.y,(this.pivot.x||this.pivot.y)&&(o-=this.pivot.x*i+this.pivot.y*a,r-=this.pivot.x*s+this.pivot.y*n),h.a=i*l.a+s*l.c,h.b=i*l.b+s*l.d,h.c=a*l.a+n*l.c,h.d=a*l.b+n*l.d,h.tx=o*l.a+r*l.c+l.tx,h.ty=o*l.b+r*l.d+l.ty):(i=this.scale.x,n=this.scale.y,o=this.position.x-this.pivot.x*i,r=this.position.y-this.pivot.y*n,h.a=i*l.a,h.b=i*l.b,h.c=n*l.c,h.d=n*l.d,h.tx=o*l.a+r*l.c+l.tx,h.ty=o*l.b+r*l.d+l.ty),this.worldAlpha=this.alpha*t.worldAlpha,this.worldPosition.set(h.tx,h.ty),this.worldScale.set(this.scale.x*Math.sqrt(h.a*h.a+h.c*h.c),this.scale.y*Math.sqrt(h.b*h.b+h.d*h.d)),this.worldRotation=Math.atan2(-h.c,h.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,h,l),!this._cacheAsBitmap){for(var d=0;d<this.children.length;d++)this.children[d].updateTransform();return this}},o}return __extends(t,e),Object.defineProperty(t.prototype,"skX",{get:function(){return this._skX},set:function(e){e>180?e=-(180-(e-180)):e<-180&&(e=180+(e+180)),this._skX=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skY",{get:function(){return this._skY},set:function(e){e>180?e=-(180-(e-180)):e<-180&&(e=180+(e+180)),this._skY=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scY",{get:function(){return this.scale.y},set:function(e){this.scale.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scX",{get:function(){return this.scale.x},set:function(e){this.scale.x=e},enumerable:!0,configurable:!0}),t}(Phaser.Sprite);e.SASprite=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t,i,s,a,n){return void 0===a&&(a=null),void 0===n&&(n=null),e.call(this,t,i,s,a,n)||this}return __extends(t,e),Object.defineProperty(t.prototype,"pivotX",{get:function(){return this.pivot.x},set:function(e){this.pivot.x=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pivotY",{get:function(){return this.pivot.y},set:function(e){this.pivot.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleY",{get:function(){return this.scale.y},set:function(e){this.scale.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleX",{get:function(){return this.scale.x},set:function(e){this.scale.x=e},enumerable:!0,configurable:!0}),t}(Phaser.Sprite);e.ScaleSprite=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t,i,s){var a=e.call(this,t)||this;return a.skewX=0,a.skewY=0,a._srB=0,a._srC=0,a._crA=1,a._crD=1,a._cachedRotX=0,a._cachedRotY=0,a.x=i,a.y=s,a.updateTransform=function(e){if(!e&&!this.parent&&!this.game)return this;var t=this.parent;e?t=e:this.parent||(t=this.game.world);var i,s,a,n,o,r,l=t.worldTransform,h=this.worldTransform,c=this.rotation+this.skewY,p=this.rotation+this.skewX;if(c%Phaser.Math.PI2||p%Phaser.Math.PI2?(p===this._cachedRotX&&c===this._cachedRotY||(this._cachedRotX=p,this._cachedRotY=c,this._crA=Math.cos(c),this._srB=Math.sin(c),this._srC=Math.sin(-p),this._crD=Math.cos(p)),i=this._crA*this.scale.x,s=this._srB*this.scale.x,a=this._srC*this.scale.y,n=this._crD*this.scale.y,o=this.position.x,r=this.position.y,(this.pivot.x||this.pivot.y)&&(o-=this.pivot.x*i+this.pivot.y*a,r-=this.pivot.x*s+this.pivot.y*n),h.a=i*l.a+s*l.c,h.b=i*l.b+s*l.d,h.c=a*l.a+n*l.c,h.d=a*l.b+n*l.d,h.tx=o*l.a+r*l.c+l.tx,h.ty=o*l.b+r*l.d+l.ty):(i=this.scale.x,n=this.scale.y,o=this.position.x-this.pivot.x*i,r=this.position.y-this.pivot.y*n,h.a=i*l.a,h.b=i*l.b,h.c=n*l.c,h.d=n*l.d,h.tx=o*l.a+r*l.c+l.tx,h.ty=o*l.b+r*l.d+l.ty),this.worldAlpha=this.alpha*t.worldAlpha,this.worldPosition.set(h.tx,h.ty),this.worldScale.set(this.scale.x*Math.sqrt(h.a*h.a+h.c*h.c),this.scale.y*Math.sqrt(h.b*h.b+h.d*h.d)),this.worldRotation=Math.atan2(-h.c,h.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,h,l),!this._cacheAsBitmap){for(var d=0;d<this.children.length;d++)this.children[d].updateTransform();return this}},a}return __extends(t,e),Object.defineProperty(t.prototype,"scaleY",{get:function(){return this.scale.y},set:function(e){this.scale.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleX",{get:function(){return this.scale.x},set:function(e){this.scale.x=e},enumerable:!0,configurable:!0}),t}(Phaser.Group);e.SkewGroup=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t,i,s,a,n){void 0===a&&(a=null),void 0===n&&(n=null);var o=e.call(this,t,i,s,a,n)||this;return o.skewX=0,o.skewY=0,o._srB=0,o._srC=0,o._crA=1,o._crD=1,o._cachedRotX=0,o._cachedRotY=0,o.updateTransform=function(e){if(!e&&!this.parent&&!this.game)return this;var t=this.parent;e?t=e:this.parent||(t=this.game.world);var i,s,a,n,o,r,l=t.worldTransform,h=this.worldTransform,c=this.rotation+this.skewY,p=this.rotation+this.skewX;if(c%Phaser.Math.PI2||p%Phaser.Math.PI2?(p===this._cachedRotX&&c===this._cachedRotY||(this._cachedRotX=p,this._cachedRotY=c,this._crA=Math.cos(c),this._srB=Math.sin(c),this._srC=Math.sin(-p),this._crD=Math.cos(p)),i=this._crA*this.scale.x,s=this._srB*this.scale.x,a=this._srC*this.scale.y,n=this._crD*this.scale.y,o=this.position.x,r=this.position.y,(this.pivot.x||this.pivot.y)&&(o-=this.pivot.x*i+this.pivot.y*a,r-=this.pivot.x*s+this.pivot.y*n),h.a=i*l.a+s*l.c,h.b=i*l.b+s*l.d,h.c=a*l.a+n*l.c,h.d=a*l.b+n*l.d,h.tx=o*l.a+r*l.c+l.tx,h.ty=o*l.b+r*l.d+l.ty):(i=this.scale.x,n=this.scale.y,o=this.position.x-this.pivot.x*i,r=this.position.y-this.pivot.y*n,h.a=i*l.a,h.b=i*l.b,h.c=n*l.c,h.d=n*l.d,h.tx=o*l.a+r*l.c+l.tx,h.ty=o*l.b+r*l.d+l.ty),this.worldAlpha=this.alpha*t.worldAlpha,this.worldPosition.set(h.tx,h.ty),this.worldScale.set(this.scale.x*Math.sqrt(h.a*h.a+h.c*h.c),this.scale.y*Math.sqrt(h.b*h.b+h.d*h.d)),this.worldRotation=Math.atan2(-h.c,h.d),this._currentBounds=null,this.transformCallback&&this.transformCallback.call(this.transformCallbackContext,h,l),!this._cacheAsBitmap){for(var d=0;d<this.children.length;d++)this.children[d].updateTransform();return this}},o}return __extends(t,e),Object.defineProperty(t.prototype,"scaleY",{get:function(){return this.scale.y},set:function(e){this.scale.y=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scaleX",{get:function(){return this.scale.x},set:function(e){this.scale.x=e},enumerable:!0,configurable:!0}),t}(Phaser.Sprite);e.SkewSprite=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t;!function(e){e[e.Music="music"]="Music",e[e.SFX="sfx"]="SFX"}(t=e.SoundType||(e.SoundType={}));var i=function(){function i(){}return i.init=function(e){i.game=e,i.toggleSound("m",i.enabMusic),i.toggleSound("fx",i.enabSFX)},i.toggleSound=function(t,i){e.DataManager.getInstance().saveObj[t]},i.playMusic=function(e,t){void 0===t&&(t=1),null===i.music?(i.music=i.game.add.audio(e,t,!0),!0===i.enabMusic&&i.music.play()):(i.music.volume=t,!0===i.enabMusic&&(i.music.key===e?i.music.play():(i.music.destroy(),i.music=i.game.add.audio(e,t,!0),!0===i.enabMusic&&i.music.play())))},i.stopMusic=function(){null!==i.music&&i.music.stop()},i.playSFX=function(e,t,s){void 0===t&&(t=!1),void 0===s&&(s=1),!1!==i.enabSFX?!0===t?void 0===i.sfxLoop[e]?i.sfxLoop[e]=i.game.add.audio(e,s,!0).play():i.sfxLoop[e].play():i.game.add.audio(e,s).play():!0===t&&void 0===i.sfxLoop[e]&&(i.sfxLoop[e]=i.game.add.audio(e,s,!0))},i.stopSFXLoop=function(e){void 0!==i.sfxLoop[e]&&i.sfxLoop[e].stop()},i.stopAllSFXLoop=function(){for(var e=0,t=Object.keys(i.sfxLoop);e<t.length;e++){var s=t[e];i.sfxLoop[s].stop()}},i.changeEnabledMusic=function(){!0===i.enabMusic?(null!==i.music&&i.music.pause(),e.DataManager.getInstance().saveData("m",1)):(null!==i.music&&(!0===i.music.paused?i.music.resume():i.music.play()),e.DataManager.getInstance().saveData("m",0)),i.enabMusic=!i.enabMusic},i.changeEnabledSFX=function(){if(!0===i.enabSFX){for(var t=0,s=Object.keys(this.sfxLoop);t<s.length;t++){o=s[t];this.sfxLoop[o].pause()}e.DataManager.getInstance().saveData("fx",1)}else{for(var a=0,n=Object.keys(this.sfxLoop);a<n.length;a++){var o=n[a];!0===this.sfxLoop[o].paused?this.sfxLoop[o].resume():this.sfxLoop[o].play()}e.DataManager.getInstance().saveData("fx",0)}i.enabSFX=!i.enabSFX},i.setEnabled=function(e){e===t.Music?i.changeEnabledMusic():i.changeEnabledSFX()},i.getEnabled=function(e){return e===t.Music?i.enabMusic:i.enabSFX},i.removeAllSFXLoop=function(){for(var e=0,t=Object.keys(i.sfxLoop);e<t.length;e++){var s=t[e];i.sfxLoop[s].destroy()}i.sfxLoop={}},i.enabMusic=!0,i.enabSFX=!0,i.game=null,i.music=null,i.sfxLoop={},i}();e.SoundManager=i}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(){}return e.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},e.roundDec=function(e,t){void 0===t&&(t=0);var i=Math.pow(10,t);return Math.round(e*i)/i},e.clamp=function(e,t,i){return Math.max(t,Math.min(i,e))},e.toDeg=function(e){return e*(180/Math.PI)},e.toRad=function(e){return e*(Math.PI/180)},e.getInstance=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var s=Object.create(window.Wheely.Client[e].prototype);return s.constructor.apply(s,t),s},e.rotatePointByAngle=function(e,t,i,s,a){var n=Math.cos(a),o=Math.sin(a);return new Phaser.Point(e+(i-e)*n-(s-t)*o,t+(i-e)*o+(s-t)*n)},e.distance=function(e,t,i,s){return Math.sqrt((i-e)*(i-e)+(s-t)*(s-t))},e.percentTo=function(e,t){return e/t*100},e.percentToF=function(e,t){return e/t},e.percentFrom=function(e,t){return e*t/100},e.angleOfPoints=function(e,t,i,s){return 180*Math.atan2(-(s-t),-(i-e))/Math.PI},e}();e.Tools=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(e,t,i,s,a,n,o){this.m_maxTextYDelta=5,this.m_danceSpeed=2,this.m_danceOffset=5,this.m_maxDanceCount=10,this.active=!1,this.m_dancingTexts=new Array,this.m_dancingTextsDirections=new Array,this.m_dancingTextsDancesCount=new Array,this.m_dancingTextsDelays=new Array,this.x=i,this.y=s;for(var r,l=0,h=0;h<n.length;h++){var c=n.charAt(h);" "!==c?((r=new Phaser.BitmapText(e,this.x+l,this.y,"walkthrough",c,o)).anchor.setTo(.5),l+=a,t.addChild(r),this.m_dancingTexts.push(r),this.m_dancingTextsDirections.push(-1),this.m_dancingTextsDelays.push(0),this.m_dancingTextsDancesCount.push(0)):l+=a}r=null}return e.prototype.stopDancing=function(){for(var e=0;e<this.m_dancingTexts.length;e++)this.m_dancingTexts[e].y=this.y;this.active=!1},e.prototype.startDancing=function(){this.stopDancing();for(var e=0;e<this.m_dancingTextsDelays.length;e++)this.m_dancingTextsDelays[e]=5*e,this.m_dancingTextsDancesCount[e]=0;this.active=!0},e.prototype.updateTextDance=function(){for(var e,t=!1,i=0;i<this.m_dancingTexts.length;i++)((e=this.m_dancingTexts[i]).y<this.y-this.m_maxTextYDelta||e.y>this.y+this.m_maxTextYDelta)&&(this.m_dancingTextsDirections[i]*=-1,this.m_dancingTextsDancesCount[i]+=1),this.m_dancingTextsDelays[i]-=Math.abs(this.m_danceSpeed),this.m_dancingTextsDelays[i]<0&&this.m_dancingTextsDancesCount[i]<this.m_maxDanceCount?(this.m_dancingTextsDelays[i]=0,e.y+=this.m_dancingTextsDirections[i]*this.m_danceSpeed,t=!0):this.m_dancingTextsDancesCount[i]>=this.m_maxDanceCount&&e.y!==this.y&&(e.y+=this.m_dancingTextsDirections[i]*this.m_danceSpeed,t=!0);t||this.stopDancing()},e.prototype.update=function(){!1!==this.active&&this.updateTextDance()},e.prototype.free=function(){this.m_dancingTexts=[],this.m_dancingTexts=null,this.m_dancingTextsDirections=[],this.m_dancingTextsDirections=null,this.m_dancingTextsDancesCount=[],this.m_dancingTextsDancesCount=null,this.m_dancingTextsDelays=[],this.m_dancingTextsDelays=null},e}();e.DancingText=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(){}return e.SW=800,e.SH=600,e.content="game-container",e}();e.Variables=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Atlases=function(){function e(){}return e.preloadList=[],e.list=["ui","wheely","level1","comix1","level2","level3","level4","level5","dragon","level6","level7","level8","level9","level9_2","level10","level11","level12","level13","level14","comix2"],e}(),Images=function(){function e(){}return e.preloadList=[],e.list=["kiziLogo","menuBg","bgLevel1_1","bgLevel2_1","bgLevel2_2","bgLevel3_1","bgLevel3_2","bgLevel3_3","bgLevel4_1","bgLevel5_1","bgLevel5_2","bgLevel5_3","bgLevel6_1","bgLevel6_2","bgLevel6_3","bgLevel7_1","bgLevel7_2","bgLevel8_1","bgLevel8_2","bgLevel10_1","bgLevel10_2","bgLevel11_1","bgLevel11_2","bgLevel12_1","bgLevel12_2","bgLevel13_1","bgLevel14_1","bgLevel14_2","credits"],e}(),Sounds=function(){function e(){}return e.preloadList=["click"],e.list=["btnClick","btnOver","main_1","main_2","levelFail","levelWin","whelly_start","whelly_stop","questClick","spring","eShock","sfx_filmStart","sfx_spell","sfx_wheelyMagic","sfx_ambient","sfx_buy","sfx_no","s_dialog","s_engineStart","sfx_womanGladness","s_bridge","s_wheelyMagic","sfx_bubles","sfx_dragonWings","sfx_dry","sfx_lever","s_lightning","sfx_villageAmbience","sfx_wheel","s_lvl3_magicExplosion","s_sword1","sfx_lance","sfx_mace","sfx_pitFall","sfx_princess","sfx_spellTransform","sfx_crowdSurprized","sfx_trumpet","sfx_waking","sfx_whiteWizard","sfx_win","s_lvl4_bucketFall","s_lvl4_elevatorNoise","s_lvl4_gateDown","s_lvl4_gateUp","s_lvl4_playingCards","s_lvl4_secretStoneClick","s_lvl4_shrub","s_lvl4_wardenSalute","s_wheelyDrowned","s_lvl5_ambient","s_lvl5_arrowHit","s_lvl5_arrowShoot","s_lvl5_bearScratch","s_lvl5_bell","s_lvl5_birdEvent","s_lvl5_loadBow","s_lvl5_lwFall","s_lvl5_robinAgression","s_lvl5_robinFriction","s_lvl5_robinStars","s_lvl5_takeArrow","s_lvl5_trollAttack","s_lvl5_trollWakeUp","s_lvl5_woodWallUp","s_lvl6_checken","s_lvl6_rubeGladness","s_lvl6_swordDrag","s_lvl6_wheelyHexed","s_lvl10_bridgeCreak","s_lvl10_bridgeFall","s_lvl10_cloudSpell","s_lvl10_createBridge","s_lvl10_frogEating","s_lvl10_frogJump","s_lvl10_frogroaks","s_lvl10_gnatNoise","s_lvl10_runeClick","s_lvl7_armMove","s_lvl7_platformMove","s_lvl7_pressButton","s_lvl7_wheelyFall","s_8_acid","s_lvl8_ambient","s_lvl8_closeDoors","s_lvl8_closeStep","s_lvl8_cube2Complite","s_lvl8_cube3FloorMove","s_lvl8_cube5Complite","s_lvl8_drumRotate","s_lvl8_flamethrower","s_lvl8_frostBeam","s_lvl8_frostHammer","s_lvl8_frostMashine","s_lvl8_hammerHit","s_lvl8_openDoors","s_lvl8_openStep","s_lvl8_platformMove","s_lvl8_platformStart","s_lvl8_platformStop","s_lvl8_saws","s_lvl8_secretShelf","s_lvl8_squareRotate","s_lvl8_trianglesRotate","s_lvl8_water","s_lvl8_wheelyCrushed","s_barrelFire","s_boxFire","s_platformMove","s_waterNoize","sfx_closeDoor","sfx_freezeNoise","sfx_helmet","s_gear","s_lvl12_gear","s_lvl12_milldust","s_lvl12_stoneMill","s_lvl12_water1","s_lvl12_water11","s_lvl12_water2","s_lvl12_water22","s_lvl12_wheelLock","s_lvl12_woodLock","s_lvl11_arrowShield","s_lvl11_catapultMove","s_lvl11_catapultRelease","s_lvl11_dragCatapult","s_lvl11_fallStone","s_lvl11_gateDestroy","s_lvl11_hitWarden","s_lvl11_prepareCatapult","s_lvl11_shootBow","s_lvl11_takeStone","slvl11_arrowWheely","s_lvl13_shelves","s_enemymagAttack","s_dragonFire","s_l13_electricSparks","s_l13_skeletonDeath","s_lvl13_ballCrush","s_lvl13_bat","s_lvl13_batAttack","s_lvl13_batDeath","s_lvl13_batDissolved","s_lvl13_batEmergency","s_lvl13_ghostDeath","s_skeleton","s_skeletonWalk","s_sword2","s_wheelyFlame","s14_dragonSneezing","s_dust","s_pressMove","s_romanticMelody","s_whistling"],e}(),Wheely;!function(e){!function(e){var t=function(){function e(){}return e.prototype.update=function(){},e.prototype.free=function(){},e}();e.BasicElement=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t){var i=e.call(this)||this;return i.activeAnim=!1,i.currAnim="",i.counterAnim=0,i.loopAnim=0,i}return __extends(t,e),t.prototype.playAnim=function(e,t){void 0===t&&(t=0),this.currAnim=e,this.loopAnim=t,this.activeAnim=!0,this.counterAnim=0,this.setParts(this.currAnim)},t.prototype.setParts=function(e){},t.prototype.update=function(){this.updateAnimation()},t.prototype.updateAnimation=function(){},t.prototype.setPart=function(e,t,i){if(void 0===i&&(i=!1),e)for(var s=0,a=Object.keys(t);s<a.length;s++){var n=a[s];if(!0!==i||"angle"!==t[n]&&"skX"!==t[n]&&"skY"!==t[n])e[n]=t[n];else{var o=t[n]%360;o>180?o-=360:o<-180&&(o+=360),e[n]=o}}},t.prototype.animComplete=function(){this.loopAnim>0?(this.loopAnim-=1,this.counterAnim=0,this.setParts(this.currAnim)):0===this.loopAnim?this.activeAnim=!1:this.loopAnim<0&&(this.counterAnim=0,this.setParts(this.currAnim)),this.onAnimComplete()},t.prototype.onAnimComplete=function(){},t}(e.BasicElement);e.BasicSimpleAnim=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n,o){void 0===o&&(o=60);var r=t.call(this)||this;return r.counterWheels=0,r.m_active=!1,r.m_currWallsTime=0,r.springHeight=60,r.springHeight=o,r.startY=n,r.graphiSpringLeft=e.GameManager.instance.layerElements.create(a-25,n+r.springHeight,s,"changeDirSpring instance 10000"),r.graphiSpringLeft.anchor.setTo(.5,1),r.graphiSpringRight=e.GameManager.instance.layerElements.create(a+25,n+r.springHeight,s,"changeDirSpring instance 10000"),r.graphiSpringRight.anchor.setTo(.5,1),r.graphic=e.GameManager.instance.layerElements.create(a,n,s,"changeDirTop instance 10000"),r.graphic.anchor.setTo(.5),r.graphic.inputEnabled=!0,r.graphic.input.useHandCursor=!0,r.graphic.events.onInputOver.add(r.onInputOver,r),r.graphic.events.onInputOut.add(r.onInputOut,r),r.halfBtnHeight=r.springHeight,r.graphic.input.enableDrag(!0),r.graphic.input.boundsRect=new Phaser.Rectangle(a-r.graphic.width/2,n-r.graphic.height/2,r.graphic.width,r.springHeight+r.graphic.height/2+2),r.graphic.input.setDragLock(!1,!0),r.graphic.events.onDragUpdate.add(r.dragUpdate,r),r.graphic.events.onInputUp.add(r.mouseUp,r),r.tween=i.add.tween(r.graphic),r.tween.to({y:[r.startY-15,r.startY]},300,Phaser.Easing.Linear.None),r.tween.onUpdateCallback(r.dragUpdate,r),r.tween.onComplete.add(r.tweenComp,r),r.body=new Phaser.Physics.Box2D.Body(i,null,a,n-5,0),r.body.setRectangle(120,10),r.body.sensor=!0,r.body.setBodyContactCallback(e.GameManager.instance.hero.bodyWheelBack,r.onBodyContact,r),r.body.setBodyContactCallback(e.GameManager.instance.hero.bodyWheelFront,r.onBodyContact,r),r}return __extends(i,t),i.prototype.onBodyContact=function(e,t,i,s,a){e!==t&&(!0===a?(this.counterWheels+=1,this.counterWheels>2&&(this.counterWheels=2)):(this.counterWheels-=1,this.counterWheels<0&&(this.counterWheels=0)))},i.prototype.tweenComp=function(){this.graphic.y=this.startY,this.graphiSpringLeft.scale.y=1,this.graphiSpringRight.scale.y=1},i.prototype.dragUpdate=function(){var e=(this.graphic.y-this.startY)/this.halfBtnHeight;this.graphiSpringLeft.scale.y=1-e,this.graphiSpringRight.scale.y=this.graphiSpringLeft.scale.y},i.prototype.mouseUp=function(){if(this.graphic.y=this.startY,this.graphiSpringLeft.scale.y=1,this.graphiSpringRight.scale.y=1,this.tween.start(),e.SoundManager.playSFX("car_spring"),2===this.counterWheels){var t=e.GameManager.instance.hero;t.bodyWheelBack.angularVelocity=0,t.bodyWheelBack.velocity.x=0,t.bodyWheelBack.velocity.y=0,t.bodyWheelFront.angularVelocity=0,t.bodyWheelFront.velocity.x=0,t.bodyWheelFront.velocity.y=0,t.bodyBase.angularVelocity=0,t.bodyBase.velocity.x=0,t.bodyBase.velocity.y=0,t.bodyBase.data.SetPosition(new box2d.b2Vec2(this.body.data.GetPosition().x,this.body.data.GetPosition().y+1.4)),t.bodyWheelBack.y=t.bodyBase.y+t.wheelsOffY,t.bodyWheelFront.y=t.bodyBase.y+t.wheelsOffY,this.destroyJoint(),this.joint=e.Main.instance.physics.box2d.wheelJoint(this.body,t.bodyBase,0,0,0,0,0,1),this.joint.m_collideConnected=!0,t.setKeepAngle(!1),t.bodyBase.angularVelocity=10.5*t.currDirection,t.bodyBase.data.ApplyLinearImpulse(new box2d.b2Vec2(0,15),t.bodyBase.data.GetPosition()),this.heroEngineState=t.getEnableMotor(),t.setEnableMotor(!1,!1),this.m_currWallsTime=0,this.m_active=!0,t=null}},i.prototype.destroyJoint=function(){null!==this.joint&&(e.Main.instance.physics.box2d.world.DestroyJoint(this.joint),this.joint=null)},i.prototype.update=function(){!1!==this.m_active&&(this.m_currWallsTime+=1,25===this.m_currWallsTime?e.GameManager.instance.hero.changeDirection():60===this.m_currWallsTime&&(e.GameManager.instance.hero.setKeepAngle(!0),this.destroyJoint(),e.GameManager.instance.hero.setEnableMotor(this.heroEngineState,!1),this.m_active=!1))},i.prototype.onInputOut=function(){this.graphic.frameName="changeDirTop instance 10000",this.graphiSpringLeft.frameName="changeDirSpring instance 10000",this.graphiSpringRight.frameName="changeDirSpring instance 10000"},i.prototype.onInputOver=function(){this.graphic.frameName="changeDirTop instance 10001",this.graphiSpringLeft.frameName="changeDirSpring instance 10001",this.graphiSpringRight.frameName="changeDirSpring instance 10001"},i.prototype.free=function(){this.graphic=null,this.graphiSpringLeft=null,this.graphiSpringRight=null,this.tween=null,this.body=null,this.joint=null},i}(e.BasicElement);e.ChangeHeroDir=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this)||this;n.array=new Array,n.game=i;for(var o=0;o<10;o++){var r=new e.Star(i,s,a);n.array.push(r)}return n}return __extends(i,t),i.prototype.update=function(){for(var e=0;e<this.array.length;e++)this.array[e].update()},i}(e.BasicElement);e.ClickStars=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n,o,r){void 0===n&&(n=!0),void 0===o&&(o=e.GameManager.instance.layerBackground),void 0===r&&(r=!0);var l=t.call(this)||this;return l.stop=!1,l.wheelyJoy=!0,l.finishTimer=0,l.active=!1,l.game=i,l.active=n,l.flag=o.create(s,a-22,"ui"),l.flag.animations.add("move",Phaser.Animation.generateFrameNames("flag instance 1",0,11,"",4),24,!0),l.flag.play("move"),l.game.physics.box2d.enable(l.flag),l.flag.body.setRectangle(10,80,10,22,0),l.flag.body.kinematic=!0,l.flag.body.sensor=!0,l.flag.anchor.set(.5,.5),l.flag.body.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,l.checkFinish,l),l.flagShtok=l.game.make.sprite(8,-18,"ui","flagShtok instance 10000"),l.flag.addChild(l.flagShtok),l.wheelyJoy=r,l}return __extends(i,t),i.prototype.setContactHero=function(){e.GameManager.instance.hero.bodyBase.setBodyContactCallback(this.flag.body,this.checkFinish,this)},i.prototype.checkFinish=function(e,t,i,s,a){a&&!0!==this.stop&&!1!==this.active&&(this.stop=!0,this.contacted())},i.prototype.update=function(){!0===this.stop&&(this.finishTimer+=1,60===this.finishTimer&&e.LevelBuilder.instance.levelComplete()),!1===this.stop&&e.Tools.distance(this.flag.body.x,this.flag.body.y,e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y)<=40&&(!0===this.wheelyJoy&&this.contacted(),this.stop=!0)},i.prototype.contacted=function(){e.SoundManager.playSFX("levelWin"),e.GameManager.instance.finishPassed=!0,e.GameManager.instance.hero.currState=e.HeroState.finish},i}(e.BasicElement);e.Finish=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function t(t,i,s){this.wheelsOffY=32,this.wheelsOffX=31,this.motorTorque=4,this.m_wheelsFriction=1,this.onGround=!0,this.backWheelOnGround=0,this.frontWheelOnGround=0,this.game=t,this.bodyBase=new Phaser.Physics.Box2D.Body(t,null,i,s);var a;(a=this.bodyBase.setRectangle(102,24,0,10)).m_filter.categoryBits=e.FilterGroups.CAR2,a.SetUserData("heroBaseBody"),(a=this.bodyBase.addCircle(12,50,10)).m_filter.categoryBits=e.FilterGroups.CAR2,(a=this.bodyBase.addCircle(12,-50,10)).m_filter.categoryBits=e.FilterGroups.CAR2,(a=this.bodyBase.addPolygon([-50,-2,-40,-22,40,-22,50,-2])).m_filter.categoryBits=e.FilterGroups.CAR1,this.bodyBase.data.SetUserData("heroCorpus"),this.bodyBase.friction=0,this.bodyBase.mass=2.2,this.bodyWheelBack=new Phaser.Physics.Box2D.Body(t,null,i-this.wheelsOffX,s+this.wheelsOffY),(a=this.bodyWheelBack.setCircle(16)).m_filter.categoryBits=e.FilterGroups.CAR2,a.m_filter.maskBits=~e.FilterGroups.CAR1,a.m_restitution=0,this.bodyWheelBack.friction=this.m_wheelsFriction,this.bodyWheelBack.data.GetFixtureList().SetDensity(1),this.bodyWheelBack.bullet=!0,this.bodyWheelBack.setCategoryContactCallback(1,this.backWheelContact,this),this.bodyWheelFront=new Phaser.Physics.Box2D.Body(t,null,i+this.wheelsOffX,s+this.wheelsOffY),(a=this.bodyWheelFront.setCircle(16)).m_filter.categoryBits=e.FilterGroups.CAR2,a.m_filter.maskBits=~e.FilterGroups.CAR1,a.m_restitution=0,this.bodyWheelFront.friction=this.m_wheelsFriction,this.bodyWheelFront.data.GetFixtureList().SetDensity(1),this.bodyWheelFront.bullet=!0,this.bodyWheelFront.setCategoryContactCallback(1,this.frontWheelContact,this),a=null;this.jointBack=t.physics.box2d.wheelJoint(this.bodyBase,this.bodyWheelBack,-this.wheelsOffX,this.wheelsOffY,0,0,0,1,5,.3,0,this.motorTorque,!0),this.jointFront=t.physics.box2d.wheelJoint(this.bodyBase,this.bodyWheelFront,this.wheelsOffX,this.wheelsOffY,0,0,0,1,5,.3,0,this.motorTorque,!1)}return t.prototype.backWheelContact=function(e,t,i,s,a){e!==t&&!0!==e.sensor&&!0!==t.sensor&&(!0===a?this.backWheelOnGround+=1:(this.backWheelOnGround-=1,this.backWheelOnGround<0&&(this.backWheelOnGround=0)),this.checkOnGround())},t.prototype.frontWheelContact=function(e,t,i,s,a){e!==t&&(!0===a?this.frontWheelOnGround+=1:(this.frontWheelOnGround-=1,this.frontWheelOnGround<0&&(this.frontWheelOnGround=0)),this.checkOnGround())},t.prototype.checkOnGround=function(){},t.prototype.free=function(){this.bodyBase=null,this.bodyWheelBack=null,this.bodyWheelFront=null,this.jointBack=null,this.jointFront=null,this.game=null},t}();e.AHeroPhysics=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t;!function(e){e[e.stand=0]="stand",e[e.acceleration=1]="acceleration",e[e.brake=2]="brake",e[e.bumpFront=3]="bumpFront",e[e.bumpBack=4]="bumpBack",e[e.bumpHead=5]="bumpHead",e[e.bumpStars=6]="bumpStars",e[e.finish=7]="finish"}(t=e.HeroState||(e.HeroState={}));var i;!function(e){e[e.stand=0]="stand",e[e.lookUp=1]="lookUp",e[e.lookDown=2]="lookDown",e[e.bump=3]="bump",e[e.bumpForEver=4]="bumpForEver",e[e.big=5]="big",e[e.finish=6]="finish",e[e.lookForward=7]="lookForward",e[e.idle=8]="idle",e[e.turn=9]="turn",e[e.afraid=10]="afraid",e[e.tense=11]="tense",e[e.afraidTime=12]="afraidTime"}(i=e.EyesState||(e.EyesState={}));var s=function(s){function a(t,i,a){var n=s.call(this,t,i,a)||this;return n._currDirection=0,n.stopStates=!1,n.backLightActive=!1,n.totalBackLight=30,n.startEyes=!1,n.bumpHeadActive=!1,n.bumpHeadCoun=0,n.bumpHeadTotal=60,n.blackForWheels=e.GameManager.instance.layerElements.create(0,0,"wheely","blackForWeels2 instance 10000"),n.blackForWheels.anchor.setTo(0,.09),n.wheelBack=e.GameManager.instance.layerElements.create(0,0,"wheely","car_weel instance 10000"),n.wheelBack.anchor.setTo(.5),n.wheelFront=e.GameManager.instance.layerElements.create(0,0,"wheely","car_weel instance 10000"),n.wheelFront.anchor.setTo(.5),n.baseGroup=t.make.group(),e.GameManager.instance.layerElements.add(n.baseGroup),n.graphicStartSmoke=n.baseGroup.create(-58,27,"wheely","startSmoke instance 10000"),n.graphicStartSmoke.anchor.setTo(1,.5),n.graphicStartSmoke.animations.add("start",Phaser.Animation.generateFrameNames("startSmoke instance 1",0,20,"",4),30),n.graphicStartSmoke.visible=!1,n.graphicStartSmoke.animations.currentAnim.onComplete.addOnce(n.hideStartSmoke,n),n.carFrameOut="car instance 10000",n.carFrameOver="car instance 10001",n.graphicCar=new e.SkewSprite(t,-67,30,"wheely",n.carFrameOut),n.graphicCar.pivot.set(0,66),n.baseGroup.add(n.graphicCar),n.clickGraphics=n.game.make.graphics(0,0),n.clickGraphics.beginFill(16711680,0),n.clickGraphics.drawRect(-65,-32,130,64),n.clickGraphics.endFill(),n.baseGroup.addChild(n.clickGraphics),n.clickGraphics.inputEnabled=!0,n.clickGraphics.input.useHandCursor=!0,n.clickGraphics.events.onInputOver.add(n.onInputOverHandler,n),n.clickGraphics.events.onInputOut.add(n.onInputOutHandler,n),n.graphicBumpHead1=n.baseGroup.create(-50,-55,"wheely"),n.graphicBumpHead1.animations.add("bumpHead",Phaser.Animation.generateFrameNames("bumpHead instance 1",0,26,"",4),30,!0),n.graphicBumpHead1.visible=!1,n.graphicBumpHead2=n.baseGroup.create(50,-55,"wheely"),n.graphicBumpHead2.animations.add("bumpHead",Phaser.Animation.generateFrameNames("bumpHead instance 1",0,26,"",4),30,!0),n.graphicBumpHead2.scale.x=-1,n.graphicBumpHead2.visible=!1,n.graphicBackLight=t.make.sprite(-2,32,"wheely","backLight instance 10000"),n.graphicCar.addChild(n.graphicBackLight),n.graphicEyes=t.make.sprite(82,-10,"wheely"),n.graphicEyes.animations.add("stand",Phaser.Animation.generateFrameNames("eyes instance 1",0,0,"",4)),n.graphicEyes.animations.add("finish",Phaser.Animation.generateFrameNames("eyes instance 1",1,1,"",4)),n.graphicEyes.animations.add("bump",Phaser.Animation.generateFrameNames("eyes instance 1",2,2,"",4)),n.graphicEyes.animations.add("lookDown",Phaser.Animation.generateFrameNames("eyes instance 1",3,3,"",4)),n.graphicEyes.animations.add("lookUp",Phaser.Animation.generateFrameNames("eyes instance 1",4,4,"",4)),n.graphicEyes.animations.add("idle1",Phaser.Animation.generateFrameNames("eyes instance 1",5,177,"",4),30),n.graphicEyes.animations.add("idle2",Phaser.Animation.generateFrameNames("eyes instance 1",178,273,"",4),30),n.graphicEyes.animations.add("idle3",Phaser.Animation.generateFrameNames("eyes instance 1",274,324,"",4),30),n.graphicEyes.animations.add("idle4",Phaser.Animation.generateFrameNames("eyes instance 1",325,333,"",4),30),n.graphicEyes.animations.add("big",Phaser.Animation.generateFrameNames("eyes instance 1",334,334,"",4)),n.graphicEyes.animations.add("turn",Phaser.Animation.generateFrameNames("eyes instance 1",335,393,"",4),24),n.graphicEyes.animations.add("afraid",Phaser.Animation.generateFrameNames("eyes instance 1",394,400,"",4),24,!0),n.graphicEyes.animations.add("tense",Phaser.Animation.generateFrameNames("eyes instance 1",402,402,"",4),24,!1),n.graphicEyes.events.onAnimationComplete.add(n.onAnimationComplete,n),n.graphicCar.addChild(n.graphicEyes),n.gas=new e.ExhaustGas(e.GameManager.instance.layerElements,3),n}return __extends(a,s),a.prototype.checkOnGround=function(){this.backWheelOnGround>0&&this.frontWheelOnGround>0?this.onGround=!0:this.onGround=!1},a.prototype.onInputOverHandler=function(){this.graphicCar.frameName=this.carFrameOver},a.prototype.onInputOutHandler=function(){this.graphicCar.frameName=this.carFrameOut},a.prototype.setChildPos=function(e){this.graphicCar.pivot.x=this.graphicCar.width*e,this.graphicCar.x=this.graphicCar.pivot.x-64,this.blackForWheels.anchor.x=e,this.blackForWheels.pivot.x=-this.blackForWheels.width*(e-.5)},a.prototype.goAnimation=function(s){!0!==this.stopStates&&(e.Main.instance.tweens.removeFrom(this.graphicCar,!1),this.graphicCar.scale.setTo(1),this.graphicCar.skewX=0,s===t.stand?(this.setChildPos(.5),this.currEyesState=i.stand):s===t.finish?(this.setChildPos(.5),this.setClickable(!1),this.currEyesState=i.finish,this.game.add.tween(this.graphicCar).to({skewX:[-.2,0,.2,0],scaleY:[1.2,1,1.2,1]},900,Phaser.Easing.Linear.None,!0,0,-1)):s===t.bumpFront?(this.setChildPos(0),this.currEyesState=i.big,e.Main.instance.add.tween(this.blackForWheels.scale).to({x:[.9,1]},1e3,Phaser.Easing.Linear.None,!0),e.Main.instance.add.tween(this.graphicCar).to({scaleX:.9,scaleY:1.1},500,Phaser.Easing.Linear.None,!0).chain(e.Main.instance.add.tween(this.graphicCar).to({scaleX:1,scaleY:1},500,Phaser.Easing.Linear.None))):s===t.bumpBack?(this.setChildPos(1),this.currEyesState=i.big,e.Main.instance.add.tween(this.blackForWheels.scale).to({x:[.9,1]},1e3,Phaser.Easing.Linear.None,!0),e.Main.instance.add.tween(this.graphicCar).to({scaleX:.9,scaleY:1.1},500,Phaser.Easing.Linear.None,!0).chain(e.Main.instance.add.tween(this.graphicCar).to({scaleX:1,scaleY:1},500,Phaser.Easing.Linear.None))):s===t.bumpHead?(this.setChildPos(.5),this.currEyesState=i.big,e.Main.instance.add.tween(this.graphicCar).to({scaleX:1.1,scaleY:.85},300,Phaser.Easing.Linear.None,!0).chain(e.Main.instance.add.tween(this.graphicCar).to({scaleX:1,scaleY:1},500,Phaser.Easing.Linear.None)),this.graphicBumpHead1.visible=!0,this.graphicBumpHead1.animations.play("bumpHead"),this.graphicBumpHead2.visible=!0,this.graphicBumpHead2.animations.play("bumpHead"),this.bumpHeadActive=!0,this.bumpHeadCoun=0):s===t.bumpStars?(this.setChildPos(.5),this.graphicBumpHead1.visible=!0,this.graphicBumpHead1.animations.play("bumpHead"),this.graphicBumpHead2.visible=!0,this.graphicBumpHead2.animations.play("bumpHead"),this.currEyesState=i.bumpForEver,this.setClickable(!1),this.stopStates=!0):s===t.acceleration?(this.setChildPos(.5),e.Main.instance.add.tween(this.graphicCar).to({skewX:-.2},100,Phaser.Easing.Linear.None,!0).chain(e.Main.instance.add.tween(this.graphicCar).to({skewX:0},300,Phaser.Easing.Linear.None)),this.currEyesState=i.lookForward,null!==this.graphicStartSmoke&&(this.graphicStartSmoke.visible=!0,this.graphicStartSmoke.animations.play("start"))):s===t.brake&&(this.setChildPos(.5),e.Main.instance.add.tween(this.graphicCar).to({skewX:.2},100,Phaser.Easing.Linear.None,!0).chain(e.Main.instance.add.tween(this.graphicCar).to({skewX:0},300,Phaser.Easing.Linear.None)),this.currEyesState=i.stand,this.countBackLight=0,this.backLightActive=!0,this.graphicBackLight.frameName="backLight instance 10001"))},a.prototype.update=function(){this.baseGroup.x=this.bodyBase.x,this.baseGroup.y=this.bodyBase.y,this.baseGroup.rotation=this.bodyBase.rotation,this.blackForWheels.x=this.baseGroup.x,this.blackForWheels.y=this.baseGroup.y,this.blackForWheels.rotation=this.baseGroup.rotation,this.wheelBack.x=this.bodyWheelBack.x,this.wheelBack.y=this.bodyWheelBack.y,this.wheelBack.rotation=this.bodyWheelBack.rotation,this.wheelFront.x=this.bodyWheelFront.x,this.wheelFront.y=this.bodyWheelFront.y,this.wheelFront.rotation=this.bodyWheelFront.rotation,!0===this.startEyes&&(this.countEyes+=1,this.countEyes>=this.totalEyes&&(this.startEyes=!1,this._currEyesState===i.stand?this.currEyesState=i.idle:this._currEyesState===i.bump?this.currEyesState=i.stand:this._currEyesState===i.big?this.currEyesState=i.bump:this._currEyesState===i.afraidTime&&(this.currEyesState=i.idle))),!0===this.backLightActive&&(this.countBackLight+=1,this.countBackLight>=this.totalBackLight&&(this.backLightActive=!1,this.graphicBackLight.frameName="backLight instance 10000")),!0===this.bumpHeadActive&&(this.bumpHeadCoun+=1,this.bumpHeadCoun>=this.bumpHeadTotal&&(this.bumpHeadActive=!1,this.graphicBumpHead1.animations.stop("bumpHead",!0),this.graphicBumpHead2.animations.stop("bumpHead",!0),this.graphicBumpHead1.visible=!1,this.graphicBumpHead2.visible=!1))},a.prototype.hideStartSmoke=function(){this.graphicStartSmoke.visible=!1,this.graphicStartSmoke.destroy(),this.graphicStartSmoke=null},a.prototype.onAnimationComplete=function(){this._currEyesState!==i.idle&&this._currEyesState!==i.turn||(this.currEyesState=i.stand)},Object.defineProperty(a.prototype,"currEyesState",{get:function(){return this._currEyesState},set:function(t){if(!0!==this.stopStates){if(this._currEyesState===i.idle){if(t===i.lookDown||t===i.lookUp)return}else if(this._currEyesState===i.bumpForEver)return;t!==this._currEyesState&&(this._currEyesState=t,this.countEyes=0,this.startEyes=!1,t===i.stand?(this.graphicEyes.animations.play("stand"),this.totalEyes=e.Tools.random(100,200),this.startEyes=!0):t===i.idle?this.graphicEyes.animations.play("idle"+e.Tools.random(1,4)):t===i.finish?this.graphicEyes.animations.play("finish"):t===i.lookDown?this.graphicEyes.animations.play("lookDown"):t===i.lookUp?this.graphicEyes.animations.play("lookUp"):t===i.lookForward?this.graphicEyes.animations.play("stand"):t===i.bump?(this.graphicEyes.animations.play("bump"),this.totalEyes=30,this.startEyes=!0):t===i.bumpForEver?this.graphicEyes.animations.play("bump"):t===i.big?(this.graphicEyes.animations.play("big"),this.totalEyes=20,this.startEyes=!0):t===i.turn?this.graphicEyes.animations.play("turn"):t===i.afraid?this.graphicEyes.animations.play("afraid"):t===i.afraidTime?(this.graphicEyes.animations.play("afraid"),this.totalEyes=30,this.startEyes=!0):t===i.tense&&this.graphicEyes.animations.play("tense"))}},enumerable:!0,configurable:!0}),a.prototype.setClickable=function(e){},a.prototype.free=function(){s.prototype.free.call(this),this._currEyesState=null,this.baseGroup=null,this.graphicCar=null,this.graphicEyes=null,this.graphicBumpHead1=null,this.graphicBumpHead2=null,this.graphicShok=null,this.wheelBack=null,this.wheelFront=null,this.blackForWheels=null,this.graphicStartSmoke=null,this.graphicBackLight=null,this.gas.free(),this.gas=null,this.clickGraphics=null},a}(e.AHeroPhysics);e.BHeroGraphic=s}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function t(t,i,s){this.parts=new Array;for(var a,n=1;n<9;n++)a=e.GameManager.instance.layerElements.create(i,s,"wheely","car_BPart"+n+" instance 10000"),t.physics.box2d.enable(a),a.body.velocity.x=e.Tools.random(-500,500),a.body.velocity.y=e.Tools.random(-500,500),a.body.angularVelocity=e.Tools.random(-20,20);a=e.GameManager.instance.layerElements.create(i,s,"wheely","eyes instance 10335"),t.physics.box2d.enable(a),a.body.velocity.x=e.Tools.random(-500,500),a.body.velocity.y=e.Tools.random(-500,500),a.body.angularVelocity=e.Tools.random(-20,20),a=null}return t.prototype.free=function(){this.parts=[],this.parts=null},t}();e.BrokeHero=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function t(e,t){this.counterCreate=0,this.parentGroup=e,this.timeCreate=t,this.gas=new Array}return t.prototype.updateCreation=function(t,s){if(this.counterCreate+=1,!(this.counterCreate<this.timeCreate)){this.counterCreate=0;for(var a=0;a<this.gas.length;a++)if(!1===this.gas[a].visible)return void this.gas[a].start(t,s,e.Tools.random(2,10)/10);var n=new i(t,s,"wheely","exhaustgas instance 10000");n.start(t,s,e.Tools.random(2,10)/10),this.parentGroup.addChild(n),this.gas.push(n),n=null}},t.prototype.free=function(){this.gas=[],this.gas=null},t}();e.ExhaustGas=t;var i=function(t){function i(i,s,a,n){var o=t.call(this,e.Main.instance,i,s,a,n)||this;return o.counter=0,o.anchor.setTo(.5),o}return __extends(i,t),i.prototype.start=function(e,t,i){this.position.setTo(e,t),this.scale.setTo(i),this.visible=!0},i.prototype.update=function(){!1!==this.visible&&(this.counter+=1,this.counter>0&&this.counter<=7?(this.x-=.25,this.y-=.375,this.scale.x+=.0375,this.scale.y=this.scale.x):this.counter>8&&this.counter<=14?(this.x-=.375,this.y-=.9,this.scale.x-=.0875,this.scale.y=this.scale.x):15===this.counter&&(this.counter=0,this.visible=!1))},i}(Phaser.Sprite);e.GasPart=i}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n){void 0===n&&(n=1);var o=t.call(this,i,s,a)||this;return o.m_keepAngle=!0,o.freeRotateAvaliable=!1,o.maxMotorSpeed=5,o.m_motorSpeed=0,o.m_boostOn=!1,o.m_boostAngularDamping=0,o.m_countBoost=0,o.m_boostWheelsFriction=4,o.m_On=!1,o.animationEnable=!0,o.counterFinish=0,o.stopUpdateMoving=!1,o.activeClick=!0,o._clicable=!0,e.LevelManager.getInstance().currentLevel>=11&&o.addHelmet(),e.LevelManager.getInstance().currentLevel>=7&&o.addSword(),e.LevelManager.getInstance().currentLevel>=13&&o.addShield(),o.angleKeep=e.Tools.toRad(45),o.currState=e.HeroState.stand,o.currDirection=n,o.clickGraphics.events.onInputUp.add(o.onInputUpHandler,o),o}return __extends(i,t),Object.defineProperty(i.prototype,"motorSpeed",{get:function(){return this.m_motorSpeed},set:function(e){this.m_motorSpeed=e*this.currDirection},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currDirection",{get:function(){return this._currDirection},set:function(e){e!==this._currDirection&&(this._currDirection=e,1===this._currDirection?(this.currDriveWheel=this.jointBack,this.currBoostWheel=this.jointFront):(this.currDriveWheel=this.jointFront,this.currBoostWheel=this.jointBack),this.baseGroup.scale.x=this._currDirection,this.currDriveWheel.EnableMotor(!0),this.currBoostWheel.EnableMotor(!1),this.m_motorSpeed*=-1)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"currState",{get:function(){return this._currState},set:function(t){this._currState!==e.HeroState.finish&&t!==this._currState&&(this._currState=t,!0!==this.animationEnable&&t!==e.HeroState.finish||this.goAnimation(t),this.animationEnable=!0)},enumerable:!0,configurable:!0}),i.prototype.onInputUpHandler=function(t,i,s){!1!==s&&(e.GameManager.instance.level.customAction(),!0===this.activeClick&&this.setEnableMotor(!this.m_On))},i.prototype.getEnableMotor=function(){return this.m_On},i.prototype.setEnableMotor=function(t,i){void 0===i&&(i=!0),this.animationEnable=i,this.m_On!==t&&(this.m_On=t,!1===t?(!0===i&&e.SoundManager.playSFX("whelly_stop"),!1===this.freeRotateAvaliable?(this.bodyWheelBack.fixedRotation=!0,this.bodyWheelFront.fixedRotation=!0):this.currDriveWheel.EnableMotor(!1),this.motorSpeed=0,this.currState=e.HeroState.brake,this.setWheelsFrictions(this.m_wheelsFriction)):(!0===i&&e.SoundManager.playSFX("whelly_start"),this.bodyWheelBack.fixedRotation=!1,this.bodyWheelFront.fixedRotation=!1,!0===this.m_boostOn?(this.currBoostWheel.EnableMotor(!0),this.motorSpeed=this.m_boostSpeed,this.setWheelsFrictions(this.m_boostWheelsFriction)):(this.motorSpeed=this.maxMotorSpeed,this.setWheelsFrictions(this.m_wheelsFriction)),this.currState=e.HeroState.acceleration))},i.prototype.setWheelsFrictions=function(e){this.bodyWheelBack.friction=e,this.bodyWheelFront.friction=e},i.prototype.setWheelsRotateAvailable=function(t){this.freeRotateAvaliable=t,this.currState!==e.HeroState.acceleration&&(!0===t&&(e.GameManager.instance.hero.bodyWheelBack.fixedRotation=!t),this.currDriveWheel.EnableMotor(!t),e.GameManager.instance.hero.bodyWheelFront.fixedRotation=!t)},i.prototype.update=function(){this.currState===e.HeroState.finish&&(this.counterFinish+=1,50===this.counterFinish&&e.LevelBuilder.instance.levelComplete()),t.prototype.update.call(this),!1===this.stopUpdateMoving&&this.updateMoving(),this.updateBoost(),this.currState!==e.HeroState.bumpHead&&this.currEyesState!==e.EyesState.turn&&this.currState!==e.HeroState.bumpStars&&this.currEyesState!==e.EyesState.afraid&&this.currEyesState!==e.EyesState.finish&&(this.bodyBase.velocity.y>60?this.currEyesState=e.EyesState.lookDown:this.bodyBase.velocity.y<-60?this.currEyesState=e.EyesState.lookUp:this.currEyesState!==e.EyesState.lookDown&&this.currEyesState!==e.EyesState.lookUp||(!0===this.m_On&&this.currEyesState!==e.EyesState.lookForward?this.currEyesState=e.EyesState.lookForward:!1===this.m_On&&this.currEyesState!==e.EyesState.stand&&(this.currEyesState=e.EyesState.stand))),this.keepAngle()},i.prototype.updateMoving=function(){if(this.currState===e.HeroState.acceleration){!1===this.freeRotateAvaliable&&this.currDriveWheel.SetMotorSpeed(this.motorSpeed);var t=this.baseGroup.toGlobal(new PIXI.Point(5*Math.random()-67-5*Math.random(),23+5*Math.random()-5*Math.random()));this.gas.updateCreation(t.x+e.Main.instance.camera.x,t.y+e.Main.instance.camera.y)}},i.prototype.updateBoost=function(){!0===this.m_boostOn&&(this.currBoostWheel.SetMotorSpeed(this.motorSpeed),this.bodyBase.angularDamping=this.m_boostAngularDamping,!0===this.m_On&&(this.m_countBoost+=1,this.m_countBoost>=this.m_totalCountBoost&&(this.m_boostOn=!1,this.bodyBase.angularDamping=0,this.currBoostWheel.EnableMotor(!1),this.setWheelsFrictions(this.m_wheelsFriction),!0===this.m_On&&(this.motorSpeed=this.maxMotorSpeed))))},i.prototype.boost=function(e,t,i,s){void 0===i&&(i=0),void 0===s&&(s=this.m_boostWheelsFriction),this.m_boostWheelsFriction=s,this.m_countBoost=0,this.m_totalCountBoost=t,this.m_boostSpeed=e,!0!==this.m_boostOn&&(this.m_boostAngularDamping=i,this.m_boostOn=!0,!0===this.m_On&&(this.motorSpeed=this.m_boostSpeed,this.currBoostWheel.EnableMotor(!0),this.setWheelsFrictions(this.m_boostWheelsFriction)))},i.prototype.dumping=function(e){void 0===e&&(e=1),this.bodyBase.velocity.x/=e,this.bodyWheelBack.angularVelocity/=e,this.bodyWheelFront.angularVelocity/=e},i.prototype.setKeepAngle=function(e){this.m_keepAngle=e},i.prototype.keepAngle=function(){!1!==this.m_keepAngle&&(this.bodyBase.rotation>this.angleKeep?this.bodyBase.rotation=this.angleKeep:this.bodyBase.rotation<-this.angleKeep&&(this.bodyBase.rotation=-this.angleKeep))},i.prototype.setVisibility=function(e){this.baseGroup.visible=e,this.blackForWheels.visible=e,this.wheelBack.visible=e,this.wheelFront.visible=e,this.bodyBase.data.SetActive(e),this.bodyWheelBack.data.SetActive(e),this.bodyWheelFront.data.SetActive(e),!0===this._clicable&&this.setClickable(e,!1)},i.prototype.setClickable=function(e,t){void 0===t&&(t=!0),!0===t&&(this._clicable=e),this.graphicCar.frameName=this.carFrameOut,this.clickGraphics.inputEnabled=e,!0===e&&(this.clickGraphics.input.useHandCursor=e)},i.prototype.setCollideWorldBounds=function(e){this.bodyBase.collideWorldBounds=e,this.bodyWheelBack.collideWorldBounds=e,this.bodyWheelFront.collideWorldBounds=e},i.prototype.clearVelosityX=function(){this.bodyBase.velocity.x=0,this.bodyWheelBack.velocity.x=0,this.bodyWheelFront.velocity.x=0,this.bodyWheelBack.angularVelocity=0,this.bodyWheelFront.angularVelocity=0},i.prototype.setPosition=function(e,t){this.bodyBase.x=e,this.bodyBase.y=t,this.bodyWheelBack.x=e-this.wheelsOffX,this.bodyWheelBack.y=t+this.wheelsOffY,this.bodyWheelFront.x=e+this.wheelsOffX,this.bodyWheelFront.y=t+this.wheelsOffY},i.prototype.addShock=function(){this.graphicCar.visible=!1,this.graphicShok=this.baseGroup.create(0,0,"wheely"),this.graphicShok.animations.add("shock",Phaser.Animation.generateFrameNames("carBody_shock instance 1",0,5,"",4),5),this.graphicShok.anchor.setTo(.5),this.graphicShok.events.onAnimationComplete.addOnce(this.addBurn,this),e.SoundManager.playSFX("eShock"),this.graphicShok.animations.play("shock")},i.prototype.addLight=function(){this.baseGroup.create(27,-28,"wheely","light instance 10000")},i.prototype.addBurn=function(){this.graphicShok&&(this.graphicShok.destroy(),this.graphicCar.visible=!0),this.graphicCar.addChildAt(this.game.make.sprite(2,4,"wheely","burn2 instance 10000"),0)},i.prototype.addSword=function(){this.sword=this.game.make.sprite(-7,-63,"wheely","sword instance 10000"),this.sword.animations.add("appear",Phaser.Animation.generateFrameNames("sword instance 1",0,9,"",4),30,!1),this.sword.animations.add("hit",Phaser.Animation.generateFrameNames("sword instance 1",10,21,"",4),30,!1),this.sword.animations.add("hide",Phaser.Animation.generateFrameNames("sword instance 1",22,30,"",4),30,!1),this.graphicCar.addChild(this.sword)},i.prototype.addShield=function(){this.shield=this.game.make.sprite(-18,-16,"wheely","shield instance 10000"),this.shield.animations.add("start",Phaser.Animation.generateFrameNames("shield instance 1",0,12,"",4),30,!1),this.shield.animations.add("defense",Phaser.Animation.generateFrameNames("shield instance 1",13,25,"",4),30,!1),this.shield.animations.add("end",Phaser.Animation.generateFrameNames("shield instance 1",26,38,"",4),30,!1),this.graphicCar.addChild(this.shield)},i.prototype.addHelmet=function(){this.helmet=this.game.make.sprite(60,-17,"wheely","helmet instance 10000"),this.graphicCar.addChild(this.helmet)},i.prototype.changeDirection=function(t){void 0===t&&(t=!0),this.currDirection*=-1,this.currEyesState=e.EyesState.turn,!0===t&&(this.bodyBase.rotation+=e.Tools.toRad(360)*this.currDirection)},i.prototype.setActiveBodies=function(e){this.bodyBase.data.SetActive(e),this.bodyWheelBack.data.SetActive(e),this.bodyWheelFront.data.SetActive(e)},i.prototype.addAsid=function(){var e=this.game.make.sprite(0,0,"level9");e.animations.add("anim",Phaser.Animation.generateFrameNames("asid instance 1",0,17,"",4),24,!1),e.animations.play("anim"),this.graphicCar.addChildAt(e,0),e=null},i.prototype.addHelmetLvl10=function(){this.helmet=this.game.make.sprite(59,10,"level10","shlem instance 10000"),this.graphicCar.addChild(this.helmet),this.helmet.visible=!1},i.prototype.showHelmet=function(){this.helmet.visible=!0,e.SoundManager.playSFX("sfx_helmet"),this.game.add.tween(this.helmet).to({y:-17},100,"Linear",!0)},i.prototype.showBurn=function(){var e=this.game.make.sprite(2,4,"wheely","burn2 instance 10000");this.graphicCar.addChildAt(e,0)},i.prototype.free=function(){t.prototype.free.call(this),this.sword=null,this.shield=null,this.helmet=null,this._currState=null,this.currDriveWheel=null,this.currBoostWheel=null},i}(e.BHeroGraphic);e.Hero=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.active=!1,s.tutorial=!0,s.timer=0,s.group=i.make.group(),s.group.x=17,s.group.y=-5,e.GameManager.instance.hero.graphicCar.addChild(s.group),s.shieldBody=new e.SASprite(i,0,0,"level12","shieldBody instance 10000"),s.shieldBody.pivot.set(27,17),s.shieldBody.inputEnabled=!0,s.shieldBody.input.useHandCursor=!0,s.shieldBody.events.onInputUp.add(s.use,s),s.shieldBody.events.onInputOver.add(s.over,s),s.shieldBody.events.onInputOut.add(s.out,s),s.group.addChild(s.shieldBody),s.setParts("start"),s}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this),!0===this.tutorial&&(this.timer+=1,this.timer<=15?this.shieldBody.frameName="shieldBody instance 10001":this.shieldBody.frameName="shieldBody instance 10000",this.timer>30&&(this.timer=0))},i.prototype.addArrow=function(t){var i=e.Main.instance.make.sprite(e.Main.instance.rnd.integerInRange(25,35),e.Main.instance.rnd.integerInRange(-5,5),"level12","lvl11_arrow_mc instance 10000");i.anchor.set(.5),i.angle=e.Main.instance.rnd.integerInRange(-95,-85),this.shieldBody.addChild(i),this.playAnim("defense")},i.prototype.use=function(){this.tutorial=!1,this.shieldBody.frameName="shieldBody instance 10000",e.GameManager.instance.hero.setClickable(!0),this.playAnim("start")},i.prototype.over=function(){this.shieldBody.frameName="shieldBody instance 10001"},i.prototype.out=function(){this.shieldBody.frameName="shieldBody instance 10000"},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"start"===this.currAnim?1===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.shieldBody,8,{x:38,y:8,skX:5,skY:5}):9===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.shieldBody,2,{x:34,skX:1,skY:1}):11===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.shieldBody,2,{x:36,skX:3,skY:3}):13===this.counterAnim?this.setPart(this.shieldBody,{x:36,y:8,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}):14===this.counterAnim&&(this.animComplete(),this.active=!0):"defense"===this.currAnim?(this.active=!1,1===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.shieldBody,5,{y:10}):6===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.shieldBody,3,{y:4}):9===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.shieldBody,2,{y:7}):11===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.shieldBody,2,{y:8}):13===this.counterAnim?this.setPart(this.shieldBody,{x:36,y:8,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}):14===this.counterAnim&&(this.animComplete(),this.playAnim("end"))):"end"===this.currAnim&&(1===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.shieldBody,8,{x:4,y:24,skX:-37,skY:-37}):9===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.shieldBody,2,{x:7,y:21,skX:-32,skY:-32}):11===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.shieldBody,2,{x:4,y:24,skX:-37,skY:-37}):13===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"start"===e?this.setPart(this.shieldBody,{x:1,y:22,angle:0,scX:1,scY:1,skX:-37,skY:-37,alpha:1}):"defense"===e?this.setPart(this.shieldBody,{x:36,y:8,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}):"end"===e&&this.setPart(this.shieldBody,{x:38,y:8,angle:0,scX:1,scY:1,skX:5,skY:5,alpha:1})},i.prototype.free=function(){this.group=null,this.shieldBody=null},i}(e.BasicSimpleAnim);e.HeroShield=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=t.call(this)||this;return e.active=!1,e.counter=0,e.graphics=new Array,e}return __extends(i,t),i.prototype.start=function(){this.active=!0,e.SoundManager.playSFX("276_lvl10_s_boost")},i.prototype.stop=function(){this.active=!1},i.prototype.update=function(){if(!1!==this.active&&(this.counter+=1,!(this.counter<2))){this.counter=0;for(var t=0;t<this.graphics.length;t++)if(!1===this.graphics[t].visible)return this.graphics[t].x=e.GameManager.instance.hero.baseGroup.x,this.graphics[t].y=e.GameManager.instance.hero.baseGroup.y,this.graphics[t].alpha=1,this.graphics[t].visible=!0,this.graphics[t].rotation=e.GameManager.instance.hero.baseGroup.rotation,void this.addTween(t);var i=e.GameManager.instance.layerBackground.create(e.GameManager.instance.hero.baseGroup.x,e.GameManager.instance.hero.baseGroup.y,"wheely","tail instance 10000");i.anchor.setTo(.5),i.rotation=e.GameManager.instance.hero.baseGroup.rotation,this.graphics.push(i),this.addTween(this.graphics.length-1),i=null}},i.prototype.addTween=function(t){e.Main.instance.add.tween(this.graphics[t]).to({alpha:0},500,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.graphics[t].visible=!1},this)},i.prototype.free=function(){this.graphics=[],this.graphics=null},i}(e.BasicElement);e.Tail=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e){var i=t.call(this)||this;return i.active=!1,i.game=e,i}return __extends(i,t),i.prototype.addBody=function(t,i,s){this.graphicBody=e.GameManager.instance.layerUpper.create(i,s,"level1",t),this.graphicBody.anchor.setTo(.5)},i.prototype.addWheels=function(e,t,i,s,a,n){this.graphicWheel1=this.game.make.sprite(t,s,"level1",e),this.graphicWheel1.anchor.setTo(a,n),this.graphicBody.addChild(this.graphicWheel1),this.graphicWheel2=this.game.make.sprite(i,s,"level1",e),this.graphicWheel2.anchor.setTo(a,n),this.graphicBody.addChild(this.graphicWheel2)},i.prototype.addTicketsAndGlasses=function(){},i.prototype.move=function(){this.active=!0,e.GameManager.instance.level.customAction(3)},i.prototype.update=function(){!1!==this.active&&(this.graphicBody.x+=3,this.graphicWheel1.angle+=8,this.graphicWheel2.angle=this.graphicWheel1.angle,this.graphicBody.x>=900&&(this.active=!1))},i.prototype.free=function(){this.game=null,this.graphicBody=null,this.graphicEyes=null,this.graphicWheel1=null,this.graphicWheel2=null},i}(e.BasicElement);e.Lvl1BasicCar=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t,i,s){var a=e.call(this,t)||this;return a.addBody("car1 instance 10000",i,s),a.addWheels("wheel1 instance 10000",-37,32,43,.5,.52),a.graphicEyes=a.game.make.sprite(12,-32,"level1"),a.graphicEyes.animations.add("anim",Phaser.Animation.generateFrameNames("eyes1 instance 1",0,109,"",4),30,!0),a.graphicEyes.animations.play("anim"),a.graphicBody.addChild(a.graphicEyes),a}return __extends(t,e),t.prototype.addTicketsAndGlasses=function(){var e=this.game.make.sprite(-30,-12,"level1");e.animations.add("anim",Phaser.Animation.generateFrameNames("tickets instance 1",0,13,"",4),30,!1).onComplete.addOnce(this.move,this),e.animations.play("anim"),this.graphicBody.addChild(e),(e=this.game.make.sprite(9,-33,"level1")).animations.add("anim",Phaser.Animation.generateFrameNames("glasses instance 1",0,12,"",4),30,!1),e.animations.play("anim"),this.graphicBody.addChild(e),e=null},t}(e.Lvl1BasicCar);e.Lvl1Car1=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t,i,s){var a=e.call(this,t)||this;return a.addBody("car2 instance 10000",i,s),a.addWheels("wheel2 instance 10000",-38,34,26,.47,.53),a.graphicEyes=a.game.make.sprite(10,-33,"level1"),a.graphicEyes.animations.add("anim",Phaser.Animation.generateFrameNames("eyes2 instance 1",0,93,"",4),30,!0),a.graphicEyes.animations.play("anim"),a.graphicBody.addChild(a.graphicEyes),a}return __extends(t,e),t.prototype.addTicketsAndGlasses=function(){var e=this.game.make.sprite(-30,-20,"level1");e.animations.add("anim",Phaser.Animation.generateFrameNames("tickets instance 1",0,13,"",4),30,!1).onComplete.addOnce(this.move,this),e.animations.play("anim"),this.graphicBody.addChild(e),(e=this.game.make.sprite(9,-43,"level1")).animations.add("anim",Phaser.Animation.generateFrameNames("glasses instance 1",0,12,"",4),30,!1),e.animations.play("anim"),this.graphicBody.addChild(e),e=null},t}(e.Lvl1BasicCar);e.Lvl1Car2=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.buttonsActives=!1,s.btnFrameId=3,s.active=!1,s.direction=0,s.speed=0,s.currFilm=0,s.hideHelp=!1,s.fakeMove=0,s.fakeCounter=0,s.fakeDir=1,s.films=i.make.group(),s.films.x=274,s.films.y=252,e.GameManager.instance.layerBackground.add(s.films),s.films.create(0,0,"level1","film1 instance 10000"),s.films.create(500,0,"level1","film2 instance 10000"),s.films.create(500,0,"level1","film3 instance 10000");var a=i.make.graphics(0,0);return s.films.addChild(a),a.beginFill(65280,.5),a.drawRoundedRect(0,0,202,128,20),a.endFill(),s.films.mask=a,a=null,e.GameManager.instance.layerBackground.create(273,250,"level1","filmRamka instance 10000"),s.btnLeft=e.GameManager.instance.layerBackground.create(230,308,"level1","btnCinema instance 10003"),s.btnLeft.anchor.setTo(.5),s.btnLeft.scale.x=-1,s.btnLeft.events.onInputOut.add(s.btnOut,s),s.btnLeft.events.onInputOver.add(s.btnOver,s),s.btnLeft.events.onInputDown.add(s.btnDown,s),s.btnLeft.events.onInputUp.add(s.btnUp,s),s.btnLeft.name="btnCinema",s.btnRight=e.GameManager.instance.layerBackground.create(520,308,"level1","btnCinema instance 10003"),s.btnRight.anchor.setTo(.5),s.btnRight.events.onInputOut.add(s.btnOut,s),s.btnRight.events.onInputOver.add(s.btnOver,s),s.btnRight.events.onInputDown.add(s.btnDown,s),s.btnRight.events.onInputUp.add(s.btnUp,s),s.btnRight.name="btnCinema",s.btnBuy=e.GameManager.instance.layerBackground.create(374,380,"level1","btnCinemaBuy instance 10003"),s.btnBuy.anchor.setTo(.5),s.btnBuy.events.onInputOut.add(s.btnOut,s),s.btnBuy.events.onInputOver.add(s.btnOver,s),s.btnBuy.events.onInputDown.add(s.btnDown,s),s.btnBuy.events.onInputUp.add(s.btnUp,s),s.btnBuy.name="btnCinemaBuy",s}return __extends(i,t),i.prototype.btnOut=function(e){!1!==e.inputEnabled&&(e.frameName=e.name+" instance 1000"+this.btnFrameId)},i.prototype.btnOver=function(e){!1!==e.inputEnabled&&(e.frameName=e.name+" instance 1000"+(this.btnFrameId+1))},i.prototype.btnDown=function(t){if(0===this.btnFrameId)if("btnCinemaBuy"===t.name){if(2===this.currFilm)return this.btnBuy.inputEnabled=!1,this.btnBuy.frameName="btnCinemaBuy instance 10003",e.GameManager.instance.level.customAction(2),e.SoundManager.playSFX("sfx_buy"),void e.SoundManager.playSFX("sfx_womanGladness");e.SoundManager.playSFX("sfx_no"),e.GameManager.instance.level.customAction(6)}else!1===this.hideHelp&&(this.hideHelp=!0,e.GameManager.instance.level.customAction(5)),this.moveFilms(t.scale.x);t.frameName=t.name+" instance 1000"+(this.btnFrameId+2)},i.prototype.btnUp=function(e,t,i){!0===i&&!0===e.inputEnabled&&this.btnOver(e)},i.prototype.activate=function(){this.btnFrameId=0,this.btnLeft.inputEnabled=!0,this.btnLeft.input.useHandCursor=!0,this.btnLeft.frameName=this.btnLeft.name+" instance 1000"+this.btnFrameId,this.btnRight.inputEnabled=!0,this.btnRight.input.useHandCursor=!0,this.btnRight.frameName=this.btnRight.name+" instance 1000"+this.btnFrameId,this.btnBuy.inputEnabled=!0,this.btnBuy.input.useHandCursor=!0,this.btnBuy.frameName=this.btnBuy.name+" instance 1000"+this.btnFrameId},i.prototype.moveFilms=function(t){!1===this.active&&(this.active=!0,this.direction=-t,this.speed=8*this.direction,this.currFilm+=t,e.SoundManager.playSFX("btnClick"),this.currFilm<0?this.currFilm=2:this.currFilm>2&&(this.currFilm=0),this.films.getChildAt(this.currFilm).x=203*t)},i.prototype.setBtnState=function(t){1===this.fakeDir?"out"===t?this.btnOut(this.btnRight):"over"===t?this.btnOver(this.btnRight):"down"===t&&this.btnDown(this.btnRight):-1===this.fakeDir?"out"===t?this.btnOut(this.btnLeft):"over"===t?this.btnOver(this.btnLeft):"down"===t&&this.btnDown(this.btnLeft):0===this.fakeDir&&("out"===t?this.btnOut(this.btnBuy):"over"===t?this.btnOver(this.btnBuy):"down"===t&&(e.SoundManager.playSFX("sfx_buy"),this.btnDown(this.btnBuy)))},i.prototype.update=function(){if(this.updateFake(),!1!==this.active){for(var e=0;e<this.films.children.length-1;e++)this.films.getChildAt(e).x+=this.speed;(this.direction<0&&this.films.getChildAt(this.currFilm).x<0||this.direction>0&&this.films.getChildAt(this.currFilm).x>0)&&(this.films.getChildAt(this.currFilm).x=0,this.active=!1)}},i.prototype.updateFake=function(){0===this.fakeMove?(this.fakeCounter+=1,this.fakeCounter>=40&&(this.fakeCounter=0,this.fakeMove=1)):1===this.fakeMove&&(this.fakeCounter+=1,1===this.fakeCounter?this.setBtnState("over"):20===this.fakeCounter?(this.setBtnState("down"),this.moveFilms(this.fakeDir)):30===this.fakeCounter?this.setBtnState("out"):60===this.fakeCounter?this.setBtnState("over"):70===this.fakeCounter?(this.setBtnState("down"),this.moveFilms(this.fakeDir)):80===this.fakeCounter?(this.setBtnState("out"),e.SoundManager.playSFX("s_dialog")):110===this.fakeCounter?(this.fakeDir=-1,this.setBtnState("over")):120===this.fakeCounter?(this.setBtnState("down"),this.moveFilms(this.fakeDir)):130===this.fakeCounter?this.setBtnState("out"):160===this.fakeCounter?(this.fakeDir=0,this.setBtnState("over")):170===this.fakeCounter?this.setBtnState("down"):180===this.fakeCounter?this.setBtnState("out"):210===this.fakeCounter&&(this.fakeMove=2,e.GameManager.instance.level.customAction(1)))},i.prototype.free=function(){this.btnLeft=null,this.btnRight=null,this.btnBuy=null,this.films=null},i}(e.BasicElement);e.Lvl1ChooseFilm=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.counter=0,s.circle=new e.PunktirCircle(i,0,0,"level1","punktirCircle instance 10000"),e.GameManager.instance.layerUpper.add(s.circle),s.circle.visible=!1,s.arrow=e.GameManager.instance.layerUpper.create(0,0,"level1","arrow instance 10000"),s.arrow.anchor.setTo(.5),s.arrow.rotation=e.Tools.toRad(45),s.arrow.visible=!1,s.arrowSpeedX=2*Math.cos(-s.arrow.rotation),s.arrowSpeedY=2*Math.sin(-s.arrow.rotation),s}return __extends(i,t),i.prototype.show=function(e,t){this.circle.x=e,this.circle.y=t,this.circle.visible=!0,this.arrow.x=e+60,this.arrow.y=t-60,this.arrow.visible=!0,this.counter=0},i.prototype.hide=function(){this.circle.visible=!1,this.arrow.visible=!1},i.prototype.update=function(){!1!==this.arrow.visible&&(this.counter+=1,this.counter>0&&this.counter<=10?(this.arrow.x-=this.arrowSpeedX,this.arrow.y-=this.arrowSpeedY):this.counter>10&&this.counter<=20?(this.arrow.x+=this.arrowSpeedX,this.arrow.y+=this.arrowSpeedY):21===this.counter&&(this.counter=0))},i.prototype.free=function(){this.circle=null,this.arrow=null},i}(e.BasicElement);e.Lvl1CircleArrow=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this)||this;return n.state=1,n.active=!0,n.game=i,n.grBodyY=a+28,n.graphicBody=new e.SkewSprite(i,s,n.grBodyY,"level1","girlCar instance 10000"),n.graphicBody.anchor.setTo(.5,1),e.GameManager.instance.layerElements.addChild(n.graphicBody),n.graphicEyes=i.make.sprite(5,-68,"level1"),n.graphicEyes.animations.add("lookAround",Phaser.Animation.generateFrameNames("girleyes instance 1",0,114,"",4),30,!0),n.graphicEyes.animations.add("niceFilm",Phaser.Animation.generateFrameNames("girleyes instance 1",115,160,"",4),30,!0),n.graphicEyes.animations.add("angry",Phaser.Animation.generateFrameNames("girleyes instance 1",161,171,"",4),30,!1),n.graphicEyes.animations.play("lookAround"),n.graphicBody.addChild(n.graphicEyes),n.graphicWheel1=e.GameManager.instance.layerElements.create(s-32,a+26,"level1","girlweel instance 10000"),n.graphicWheel1.anchor.setTo(.5),n.graphicWheel2=e.GameManager.instance.layerElements.create(s+33,a+26,"level1","girlweel instance 10000"),n.graphicWheel2.anchor.setTo(.5),n.playAnimBody("idle"),n}return __extends(i,t),i.prototype.setAngry=function(){this.graphicEyes.animations.stop("angry",!0),this.graphicEyes.animations.play("angry")},i.prototype.setState=function(e){this.state=e,this.active=!0},i.prototype.update=function(){!1!==this.active&&(this.graphicBody.x+=1.5,this.graphicWheel1.x=this.graphicBody.x-32,this.graphicWheel2.x=this.graphicBody.x+33,this.graphicWheel1.angle+=8,this.graphicWheel2.angle=this.graphicWheel1.angle,1===this.state&&this.graphicBody.x>=125?(this.active=!1,this.addPopcorn(),e.GameManager.instance.hero.setEnableMotor(!1)):2===this.state&&this.graphicBody.x>=480?(this.active=!1,e.GameManager.instance.level.customAction(4),e.GameManager.instance.hero.setEnableMotor(!1)):2===this.state&&this.graphicBody.x>=900&&(this.active=!1))},i.prototype.addPopcorn=function(){var e=this.game.make.sprite(-5,-91,"level1");e.angle=8,e.animations.add("anim",Phaser.Animation.generateFrameNames("popcorn instance 1",0,22,"",4),30,!1).onComplete.addOnce(function(){this.playAnimBody("idle")},this),e.animations.play("anim"),this.graphicBody.addChild(e),e=null,this.playAnimBody("wiggle")},i.prototype.addGlasses=function(){this.graphicEyes.animations.play("niceFilm");var e=this.game.make.sprite(0,-70,"level1");e.animations.add("anim",Phaser.Animation.generateFrameNames("glasses instance 1",0,12,"",4),30,!1),e.animations.play("anim"),this.graphicBody.addChild(e),e=null,this.playAnimBody("glasses")},i.prototype.playAnimBody=function(t){this.game.tweens.removeFrom(this.graphicBody),"idle"===t?this.game.add.tween(this.graphicBody).to({scaleY:[1.05,1]},1300,Phaser.Easing.Linear.None,!0,0,-1):"wiggle"===t?this.game.add.tween(this.graphicBody).to({scaleY:[1.09,1,1.09,1],skewX:[e.Tools.toRad(-6.2),0,e.Tools.toRad(6.2),0]},800,Phaser.Easing.Linear.None,!0,0,-1):"glasses"===t&&this.game.add.tween(this.graphicBody).to({scaleY:[.95,1,1],y:[this.grBodyY+3,this.grBodyY-3,this.grBodyY]},500,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.playAnimBody("idle")},this)},i.prototype.free=function(){this.game=null,this.graphicBody=null,this.graphicEyes=null,this.graphicWheel1=null,this.graphicWheel2=null},i}(e.BasicElement);e.Lvl1Girl=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.graphic=e.GameManager.instance.layerElements.create(362,287,"level10","door instance 10000"),s}return __extends(i,t),i.prototype.close=function(){e.SoundManager.playSFX("sfx_closeDoor"),e.GameManager.instance.level.game.add.tween(this.graphic).to({y:398},300,"Linear",!0).onComplete.addOnce(function(){this.addDust(370,545)},this)},i.prototype.addDust=function(t,i){var s=e.GameManager.instance.layerElements.create(t,i,"level10","dorrDust instance 10000");s.anchor.set(.5,1);var a=s.animations.add("anim",Phaser.Animation.generateFrameNames("dorrDust instance 1",0,21,"",4),30,!1);a.killOnComplete=!0,a.play()},i.prototype.free=function(){t.prototype.free.call(this),this.graphic=null},i}(e.BasicElement);e.Lvl10Door=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.move=!1,s.haveHelmet=!1,s.group=new Phaser.Group(i),s.group.x=77,s.group.y=505,s.group.scale.set(1.25),e.GameManager.instance.layerElements.addChild(s.group),s.graphics=s.group.create(0,63,"level10","fireCar instance 10000"),s.graphics.anchor.set(.5,1),s.graphics.animations.add("alive",Phaser.Animation.generateFrameNames("fireCar instance 1",0,71,"",4),30,!1).onComplete.addOnce(s.addFire,s),s.graphics.animations.add("dead",Phaser.Animation.generateFrameNames("fireCar instance 1",89,154,"",4),30,!1),s.wheel1=s.group.create(-22,22,"level10","wheelFire instance 10000"),s.wheel1.anchor.set(.5),s.wheel1.visible=!1,s.wheel2=s.group.create(22,22,"level10","wheelFire instance 10000"),s.wheel2.anchor.set(.5),s.wheel2.visible=!1,s}return __extends(i,t),i.prototype.alive=function(){this.graphics.play("alive")},i.prototype.addFire=function(){this.move=!0,this.fire=this.group.create(-7,35,"level10","fire instance 10000",!0,0),this.fire.anchor.set(.5,1),e.GameManager.instance.level.game.add.tween(this.fire.scale).to({y:1.1},150,"Linear",!0,0,-1,!0),this.scaleTween=e.GameManager.instance.level.game.add.tween(this.graphics.scale).to({y:.98},200,"Linear",!0,0,-1,!0),this.moveTween=e.GameManager.instance.level.game.add.tween(this.group).to({x:190},3500,"Linear",!0),this.wheel1.visible=!0,this.wheel2.visible=!0},i.prototype.update=function(){var t=e.Tools.distance(e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y,this.group.x,this.group.y);this.move?(t<125&&(e.Main.instance.tweens.removeFrom(this.group),this.move=!1,e.GameManager.instance.level.topActions.wheelyBurn=!0,e.GameManager.instance.hero.setEnableMotor(!1),e.GameManager.instance.level.gameOver=!0),this.wheel1.angle+=1.5,this.wheel2.angle+=1.5,!0===e.GameManager.instance.level.topActions.waterWork&&this.group.x>115&&(this.move=!1,this.wheel1.visible=!1,this.wheel2.visible=!1,this.fire.visible=!1,this.graphics.play("dead"),this.moveTween.stop(),this.scaleTween.stop(),e.GameManager.instance.hero.currEyesState=e.EyesState.stand,e.GameManager.instance.hero.setCollideWorldBounds(!1))):!1===e.GameManager.instance.level.gameOver&&!1===this.haveHelmet&&t<60&&(this.haveHelmet=!0,this.hide(),e.GameManager.instance.hero.showHelmet())},i.prototype.hide=function(){this.group.visible=!1},i.prototype.free=function(){t.prototype.free.call(this),this.group=null,this.graphics=null,this.fire=null,this.wheel1=null,this.wheel2=null,this.moveTween=null,this.scaleTween=null},i}(e.BasicElement);e.Lvl10FireCar=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.iceBody=new Phaser.Physics.Box2D.Body(i,null,441,187,0),s.iceBody.setRectangle(75,50),s.group=new Phaser.Group(i),s.group.x=441,s.group.y=187,e.GameManager.instance.layerUpper.addChildAt(s.group,0),s.part11=new e.SASprite(i,0,0,"level10","part11 instance 10000"),s.part11.pivot.set(42,33),s.group.addChild(s.part11),s.part10=new e.SASprite(i,0,0,"level10","part10 instance 10000"),s.part10.pivot.set(12,32),s.group.addChild(s.part10),s.part9=new e.SASprite(i,0,0,"level10","part9 instance 10000"),s.part9.pivot.set(26,25),s.group.addChild(s.part9),s.part8=new e.SASprite(i,0,0,"level10","part8 instance 10000"),s.part8.pivot.set(40,38),s.group.addChild(s.part8),s.part7=new e.SASprite(i,0,0,"level10","part7 instance 10000"),s.part7.pivot.set(6,9),s.group.addChild(s.part7),s.part6=new e.SASprite(i,0,0,"level10","part6 instance 10000"),s.part6.pivot.set(32,33),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level10","part5 instance 10000"),s.part5.pivot.set(16,7),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level10","part4 instance 10000"),s.part4.pivot.set(9,7),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level10","part3 instance 10000"),s.part3.pivot.set(5,5),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level10","part2 instance 10000"),s.part2.pivot.set(9,5),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level10","part1 instance 10000"),s.part1.pivot.set(18,4),s.group.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(this.setPart(this.part1,{x:36,y:45,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:-5,y:30,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:16,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:-23,y:12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part5,{x:-30,y:45,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part6,{x:5,y:17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part7,{x:4,y:-12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part8,{x:-16,y:14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part9,{x:27,y:26,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part10,25,{x:-6,y:-7,skX:-5,skY:-5,scY:.74}),this.setPart(this.part11,{x:3,y:14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part7,13,{x:3,y:-8,skX:3,skY:-5,scX:1.15,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.part11,20,{y:18,scX:1.06,scY:.89})):19===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part7,7,{y:-6,skX:2,skY:-15,scY:.55,alpha:0}):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part4,5,{x:-24,y:15,scX:.96,scY:.63}),e.GameManager.instance.level.setSimpleTween(this.part5,20,{y:48,scY:.52}),this.setPart(this.part7,{x:3,y:-6,angle:0,scX:1.15,scY:.55,skX:2,skY:-15,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part8,20,{y:25,scY:.71}),e.GameManager.instance.level.setSimpleTween(this.part10,25,{x:-21,y:21,skX:-36,skY:-33,scY:.62}),e.GameManager.instance.level.setSimpleTween(this.part11,45,{y:45,scX:1.35,scY:.13})):27===this.counterAnim?this.part7.visible=!1:31===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,10,{x:-22,y:19,skX:7,skY:7,scX:.85,scY:.39,alpha:0}):41===this.counterAnim?this.setPart(this.part4,{x:-22,y:19,angle:0,scX:.85,scY:.39,skX:7,skY:7,alpha:0}):42===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part9,33,{y:42,scX:1.9,scY:.35}):46===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part5,10,{skX:1,skY:1,scX:1.3,scY:.38}),e.GameManager.instance.level.setSimpleTween(this.part8,29,{x:-19,y:41,scX:1.25,scY:.28})):49===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part3,8,{x:14,y:11,skX:-5,skY:-19,scY:.65}),e.GameManager.instance.level.setSimpleTween(this.part6,32,{y:40,scX:1.21,scY:.29})):51===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:-9,y:37,skX:-6,scY:.78}),e.GameManager.instance.level.setSimpleTween(this.part10,20,{x:-31,y:41,skX:-122,skY:-118,scY:.44})):56===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part5,7,{y:49,scY:.25,alpha:0}):57===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,7,{x:13,y:20,scY:.36,alpha:0}):63===this.counterAnim?this.setPart(this.part5,{x:-30,y:49,angle:0,scX:1.3,scY:.25,skX:1,skY:1,alpha:0}):64===this.counterAnim?(this.setPart(this.part3,{x:13,y:20,angle:0,scX:1,scY:.36,skX:-5,skY:-19,alpha:0}),this.part5.visible=!1):65===this.counterAnim?this.part3.visible=!1:66===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,10,{x:-12,y:42,skX:-4,skY:6,scY:.64,alpha:0}):71===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,10,{x:35,y:47,scY:.45}),e.GameManager.instance.level.setSimpleTween(this.part10,20,{x:-32,y:46,skX:-100,skY:-157,scX:.91,scY:.57}),e.GameManager.instance.level.setSimpleTween(this.part11,20,{y:47,scX:1.6,scY:.08})):75===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part8,24,{y:47,scX:1.48,scY:.12}),e.GameManager.instance.level.setSimpleTween(this.part9,19,{y:47,scX:2.52,scY:.15})):76===this.counterAnim?this.setPart(this.part2,{x:-12,y:42,angle:0,scX:1,scY:.64,skX:-4,skY:6,alpha:0}):77===this.counterAnim?this.part2.visible=!1:81===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,15,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part6,18,{y:46,scX:1.57,scY:.11})):91===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part10,10,{y:47,skX:-95,skY:-167,scX:.88,scY:.61,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part11,10,{scX:1.66,scY:.07,alpha:0})):94===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part9,9,{alpha:0}):96===this.counterAnim?this.setPart(this.part1,{x:35,y:47,angle:0,scX:1,scY:.45,skX:0,skY:0,alpha:0}):97===this.counterAnim?this.part1.visible=!1:99===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part6,6,{y:47,scY:.08,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part8,4,{alpha:0})):101===this.counterAnim?(this.setPart(this.part10,{x:-32,y:47,angle:0,scX:.88,scY:.61,skX:-95,skY:-167,alpha:0}),this.setPart(this.part11,{x:3,y:47,angle:0,scX:1.66,scY:.07,skX:0,skY:0,alpha:0})):102===this.counterAnim?(this.part10.visible=!1,this.part11.visible=!1):103===this.counterAnim?(this.setPart(this.part8,{x:-19,y:47,angle:0,scX:1.48,scY:.12,skX:0,skY:0,alpha:0}),this.setPart(this.part9,{x:27,y:47,angle:0,scX:2.52,scY:.15,skX:0,skY:0,alpha:0})):104===this.counterAnim?(this.part8.visible=!1,this.part9.visible=!1):105===this.counterAnim?this.setPart(this.part6,{x:5,y:47,angle:0,scX:1.57,scY:.08,skX:0,skY:0,alpha:0}):106===this.counterAnim&&this.animComplete()))},i.prototype.animComplete=function(){t.prototype.animComplete.call(this),this.iceBody.sensor=!0,e.GameManager.instance.level.addWater()},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:36,y:45,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:-5,y:30,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:16,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:-23,y:12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part5,{x:-30,y:45,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part6,{x:5,y:17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part7,{x:4,y:-12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part8,{x:-16,y:14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part9,{x:27,y:26,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part10,{x:-4,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part11,{x:3,y:14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){t.prototype.free.call(this),this.group=null,this.part1=null,this.part2=null,this.part3=null,this.part4=null,this.part5=null,this.part6=null,this.part7=null,this.part8=null,this.part9=null,this.part10=null,this.part11=null,this.iceBody=null},i}(e.BasicSimpleAnim);e.Lvl10Ice=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;s.used=!1,s.crush=!1,s.crushNow=!1,s.group=new Phaser.Group(i),s.group.x=502,s.group.y=416,e.GameManager.instance.layerElements.addChild(s.group),s.part6=new e.SASprite(i,0,0,"level10","pressPart2 instance 10000"),s.part6.pivot.set(87,16),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level10","pressPart1 instance 10000"),s.part5.pivot.set(87,15),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level10","pressPart2 instance 10000"),s.part4.pivot.set(87,16),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level10","pressPart1 instance 10000"),s.part3.pivot.set(87,15),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level10","pressPart3 instance 10000"),s.part2.pivot.set(19,10),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level10","pressPart3 instance 10000"),s.part1.pivot.set(19,10),s.group.addChild(s.part1),s.press=new e.SASprite(i,0,0,"level10","press instance 10000"),s.press.pivot.set(94,39),s.group.addChild(s.press),s.setParts("down"),s.wheel1=e.GameManager.instance.layerElements.create(420,290,"level10","wheel instance 10000"),s.wheel1.anchor.set(.5),s.wheel2=e.GameManager.instance.layerElements.create(396,330,"level10","wheel instance 10000"),s.wheel2.anchor.set(.5),e.GameManager.instance.layerElements.create(398,296,"level10","shadow instance 10000"),s.pressBody=new Phaser.Physics.Box2D.Body(i,null,s.press.world.x+94,s.press.world.y+39,1),s.pressBody.setRectangle(185,71),s.pressBody.sensor=!0,s.botPress=e.GameManager.instance.layerUpper.create(514,556,"level10","pressSensor_mc instance 10000"),i.physics.box2d.enable(s.botPress),s.botPress.body.fixedRotation=!0;var a=new Phaser.Physics.Box2D.Body(i,null,514,576,0);a.setRectangle(20,20),a.sensor=!0;return i.physics.box2d.wheelJoint(a,s.botPress.body,0,-20,0,0,0,1,4,.3,0),s.botPress.body.setBodyContactCallback(e.GameManager.instance.level.redStone.body,s.contact,s),s.botPress.body.setBodyContactCallback(e.GameManager.instance.hero.bodyWheelBack,s.contact,s),s.pressBody.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,s.crushHero,s),s.arrow1=e.GameManager.instance.layerBackground.create(435,516,"level10","arrow1 instance 10000"),s.arrow1.pivot.set(14,31),s.arrow2=e.GameManager.instance.layerBackground.create(413,450,"level10","arrow2 instance 10000"),s.arrow2.pivot.set(5.5,22),s}return __extends(i,t),i.prototype.contact=function(){!1===this.used&&(this.used=!0,e.SoundManager.playSFX("s_platformMove"),this.playAnim("down"),this.counterAnim=-25,e.Main.instance.add.tween(this.arrow1).to({angle:-90},350,"Linear",!0,0,0,!0),e.Main.instance.add.tween(this.arrow2).to({angle:45},250,"Linear",!0,0,0,!0))},i.prototype.crushHero=function(){!1===this.crush&&this.counterAnim<50&&(this.crush=!0)},i.prototype.addDust=function(t,i){var s=e.GameManager.instance.layerElements.create(t,i,"level10","pressDust instance 10000");s.anchor.set(0,1);var a=s.animations.add("anim",Phaser.Animation.generateFrameNames("pressDust instance 1",0,27,"",4),30,!1);a.killOnComplete=!0,a.play()},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"down"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.press,49,{y:102}),e.GameManager.instance.level.setSimpleTween(this.part1,49,{x:87,y:-26,scX:1,scY:2.47}),e.GameManager.instance.level.setSimpleTween(this.part2,49,{x:-37,y:-31,scX:1,scY:2.47}),e.GameManager.instance.level.setSimpleTween(this.part3,49,{y:-75,skX:36,skY:36}),e.GameManager.instance.level.setSimpleTween(this.part4,49,{y:-75,skX:-35,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.part5,49,{y:29,skX:36,skY:36}),e.GameManager.instance.level.setSimpleTween(this.part6,49,{y:29,skX:-35,skY:-35})):50===this.counterAnim?(this.setPart(this.press,{x:23,y:102,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part1,{x:87,y:-26,angle:0,scX:1,scY:2.47,skX:0,skY:180,alpha:1}),this.setPart(this.part2,{x:-37,y:-31,angle:0,scX:1,scY:2.47,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:24,y:-75,angle:0,scX:1,scY:1,skX:36,skY:36,alpha:1}),this.setPart(this.part4,{x:24,y:-75,angle:0,scX:1,scY:1,skX:-35,skY:-35,alpha:1}),this.setPart(this.part5,{x:24,y:29,angle:0,scX:1,scY:1,skX:36,skY:36,alpha:1}),this.setPart(this.part6,{x:24,y:29,angle:0,scX:1,scY:1,skX:-35,skY:-35,alpha:1}),this.addDust(400,555),this.addDust(565,555)):76===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.press,15,{y:-13}),e.GameManager.instance.level.setSimpleTween(this.part1,15,{x:98,y:-80,scX:1.11,scY:1.8}),e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:-51,y:-86,scX:1.22,scY:1.8}),e.GameManager.instance.level.setSimpleTween(this.part3,15,{y:-107,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.part4,15,{y:-107,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.part5,15,{y:-65,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.part6,15,{y:-64,skX:-9,skY:-9})):91===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.press,176,{y:-90}),e.GameManager.instance.level.setSimpleTween(this.part1,176,{x:107,y:-127,scX:1,scY:1.26}),e.GameManager.instance.level.setSimpleTween(this.part2,176,{x:-53,y:-133,scX:1,scY:1.26}),e.GameManager.instance.level.setSimpleTween(this.part3,176,{y:-128,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part4,176,{y:-128,skX:9,skY:9}),e.GameManager.instance.level.setSimpleTween(this.part5,176,{y:-128,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part6,176,{y:-127,skX:8,skY:8})):267===this.counterAnim&&this.animComplete()),this.pressBody.x=this.press.world.x+94,this.pressBody.y=this.press.world.y+39)},i.prototype.setParts=function(e){"down"===e&&(this.setPart(this.press,{x:23,y:-90,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part1,{x:106,y:-127,angle:0,scX:1.23,scY:1.26,skX:0,skY:180,alpha:1}),this.setPart(this.part2,{x:-53,y:-131,angle:0,scX:1.35,scY:1.26,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:24,y:-128,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:24,y:-128,angle:0,scX:1,scY:1,skX:9,skY:9,alpha:1}),this.setPart(this.part5,{x:24,y:-128,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part6,{x:24,y:-127,angle:0,scX:1,scY:1,skX:8,skY:8,alpha:1}))},i.prototype.update=function(){if(t.prototype.update.call(this),!0===this.crush&&!1===this.crushNow){this.crushNow=!0,e.GameManager.instance.hero.setVisibility(!1);new e.BrokeHero(e.GameManager.instance.level.game,e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y);e.GameManager.instance.level.gameOver=!0}},i.prototype.free=function(){t.prototype.free.call(this),this.group=null,this.part1=null,this.part2=null,this.part3=null,this.part4=null,this.part5=null,this.part6=null,this.press=null,this.wheel1=null,this.wheel2=null,this.pressBody=null,this.botPress=null,this.arrow1=null,this.arrow2=null},i}(e.BasicSimpleAnim);e.Lvl10Press=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.startY=525,s.counterWheels=0,s.m_active=!1,s.m_currWallsTime=0,s.springHeight=45,s.game=i,s.graphic=e.GameManager.instance.layerUpper.create(720,s.startY,"level10","spring instance 10000"),s.graphic.anchor.setTo(.5),s.graphic.inputEnabled=!0,s.graphic.input.useHandCursor=!0,s.graphic.events.onInputUp.add(s.useSpring,s),s.halfBtnHeight=s.springHeight,s.tween=s.game.add.tween(s.graphic),s.tween.to({y:[s.startY-15,s.startY]},300,Phaser.Easing.Linear.None),s.tween.onComplete.add(s.tweenComp,s),s.body=new Phaser.Physics.Box2D.Body(s.game,null,720,s.startY-20,0),s.body.setRectangle(120,10),s.body.sensor=!0,s.body.setBodyContactCallback(e.GameManager.instance.hero.bodyWheelBack,s.onBodyContact,s),s.body.setBodyContactCallback(e.GameManager.instance.hero.bodyWheelFront,s.onBodyContact,s),s}return __extends(i,t),i.prototype.onBodyContact=function(e,t,i,s,a){e!==t&&(!0===a?(this.counterWheels+=1,this.counterWheels>2&&(this.counterWheels=2)):(this.counterWheels-=1,this.counterWheels<0&&(this.counterWheels=0)))},i.prototype.tweenComp=function(){this.graphic.y=this.startY},i.prototype.useSpring=function(){if(this.graphic.y=this.startY,this.tween.start(),e.SoundManager.playSFX("spring"),2===this.counterWheels){var t=e.GameManager.instance.hero;t.bodyWheelFront.mass=.321,t.bodyWheelBack.angularVelocity=0,t.bodyWheelBack.velocity.x=0,t.bodyWheelBack.velocity.y=0,t.bodyWheelFront.angularVelocity=0,t.bodyWheelFront.velocity.x=0,t.bodyWheelFront.velocity.y=0,t.bodyBase.angularVelocity=0,t.bodyBase.velocity.x=0,t.bodyBase.velocity.y=0,t.bodyBase.data.SetPosition(new box2d.b2Vec2(this.body.data.GetPosition().x,this.body.data.GetPosition().y+1.4)),t.bodyWheelBack.y=t.bodyBase.y+t.wheelsOffY,t.bodyWheelFront.y=t.bodyBase.y+t.wheelsOffY,this.destroyJoint(),this.joint=e.Main.instance.physics.box2d.wheelJoint(this.body,t.bodyBase,0,0,0,0,0,1),this.joint.m_collideConnected=!0,t.setKeepAngle(!1),t.bodyBase.angularVelocity=10.5*t.currDirection,t.bodyBase.data.ApplyLinearImpulse(new box2d.b2Vec2(0,15),t.bodyBase.data.GetPosition()),this.heroEngineState=t.getEnableMotor(),t.setEnableMotor(!1,!1),this.m_currWallsTime=0,this.m_active=!0,t=null}},i.prototype.destroyJoint=function(){null!=this.joint&&(e.Main.instance.physics.box2d.world.DestroyJoint(this.joint),this.joint=null)},i.prototype.update=function(){!1!==this.m_active&&(this.m_currWallsTime+=1,25===this.m_currWallsTime?e.GameManager.instance.hero.changeDirection():60===this.m_currWallsTime&&(e.GameManager.instance.hero.setKeepAngle(!0),this.destroyJoint(),e.GameManager.instance.hero.setEnableMotor(this.heroEngineState,!1),this.m_active=!1))},i.prototype.free=function(){t.prototype.free.call(this),this.game=null,this.body=null,this.graphic=null,this.tween=null,this.joint=null},i}(e.BasicElement);e.Lvl10Spring=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.wheelyBurn=!1,s.fire=new Array,s.fireNow=!1,s.frostNow=!1,s.iceRockDestroy=!1,s.waterFrozen=!1,s.boxInfire=!1,s.boxBurnTimer=0,s.wheelyFrized=!1,s.emptyPool=!1,s.frozenWaterFrame=1e4,s.underWater=!1,s.active=!1,s.counterWheelyBurn=!0,s.counterBoxBurn=!0,s.drake=i.make.button(75,73,"level10",s.stopDrug,s,"drake instance 10001","drake instance 10000","drake instance 10000","drake instance 10000"),s.drake.anchor.set(.5),s.drake.events.onInputDown.add(s.startDrag,s),e.GameManager.instance.layerElements.addChild(s.drake),s.drake.inputEnabled=!0,s.drake.input.enableDrag(),s.drake.input.boundsRect=new Phaser.Rectangle(0,s.drake.y-s.drake.height/2,650,s.drake.height),s.drake.input.setDragLock(!0,!1);var a=i.make.button(45,291,"level10",s.endFire,s,"fireButton instance 10001","fireButton instance 10000","fireButton instance 10002","fireButton instance 10000");a.onInputDown.add(s.fireOn,s),a.anchor.set(.5),e.GameManager.instance.layerUpper.addChild(a);var n=i.make.button(105,291,"level10",s.endFrost,s,"frostButton instance 10001","frostButton instance 10000","frostButton instance 10002","frostButton instance 10000");n.onInputDown.add(s.frostOn,s),n.anchor.set(.5),e.GameManager.instance.layerUpper.addChild(n),s.group=new Phaser.Group(i),e.GameManager.instance.layerUpper.addChild(s.group),s.frozenWater=e.GameManager.instance.layerUpper.create(168,237,"level10","frozenWater instance 10000",!0,0),s.waterBody=new Phaser.Physics.Box2D.Body(i,null,272,247,0),s.waterBody.setRectangle(204,20),s.waterBody.sensor=!0,s.waterSensor=new Phaser.Physics.Box2D.Body(i,null,290,300,0),s.waterSensor.setRectangle(50,20),s.waterSensor.sensor=!0,s.waterSensor.setBodyContactCallback(e.GameManager.instance.hero.bodyWheelFront,s.wheelyDead,s),s.water=i.make.sprite(169,239,"level10","water instance 10000"),e.GameManager.instance.layerUpper.addChildAt(s.water,0),s.waterBlur=i.make.sprite(150,215,"level10","waterBlur instance 10000"),e.GameManager.instance.layerUpper.addChild(s.waterBlur);var o=new Phaser.Graphics(i,169,239);return o.beginFill(0,1),o.drawRect(0,0,208,91),o.endFill(),e.GameManager.instance.layerUpper.addChild(o),s.water.mask=o,e.GameManager.instance.layerUpper.create(161,275,"level10","corals instance 10000",!0,0),s.box=i.make.sprite(44,175,"level10","box instance 10000"),s.box.inputEnabled=!0,e.GameManager.instance.layerElements.addChildAt(s.box,0),s.iceRock=new e.Lvl10Ice(i),e.GameManager.instance.level.updateElements.push(s.iceRock),s.waterWheel=i.make.sprite(241,358,"level10","waterWheel instance 10000"),s.waterWheel.anchor.set(.5),e.GameManager.instance.layerUpper.addChild(s.waterWheel),s}return __extends(i,t),i.prototype.activateWheel=function(){this.active=!0,this.waterWheel.inputEnabled=!0,this.waterWheel.input.useHandCursor=!0,this.waterWheel.events.onInputOver.add(this.over,this),this.waterWheel.events.onInputOut.add(this.out,this),this.waterWheel.events.onInputUp.add(this.up,this),this.waterWheel.frameName="waterWheel instance 10001"},i.prototype.over=function(){!0===this.active&&(this.waterWheel.frameName="waterWheel instance 10002")},i.prototype.out=function(){!0===this.active&&(this.waterWheel.frameName="waterWheel instance 10001")},i.prototype.up=function(){!0===this.active&&(this.waterWheel.inputEnabled=!1,e.GameManager.instance.level.game.add.tween(this.waterWheel).to({angle:360},600,"Linear",!0).onComplete.addOnce(function(){this.waterWheel.frameName="waterWheel instance 10000"},this),e.GameManager.instance.level.game.add.tween(this.water).to({y:330},2500,"Linear",!0).onComplete.addOnce(function(){this.waterWork=!1,e.SoundManager.stopSFXLoop("s_waterNoize")},this),e.GameManager.instance.level.game.add.tween(this.waterBlur).to({alpha:0},500,"Linear",!0),this.waterWork=!0,e.SoundManager.playSFX("s_waterNoize",!0),this.emptyPool=!0)},i.prototype.wheelyDead=function(){this.underWater=!0,e.SoundManager.playSFX("sfx_bubles",!0),e.GameManager.instance.hero.setEnableMotor(!1,!1),e.GameManager.instance.level.gameOver=!0},i.prototype.fireOn=function(){this.fireNow=!0,e.SoundManager.playSFX("s_barrelFire",!0),!this.iceRockDestroy&&Math.abs(this.iceRock.group.x-this.drake.x)<50&&(0===this.iceRock.counterAnim?this.iceRock.playAnim("anim"):this.iceRock.activeAnim=!0)},i.prototype.endFire=function(){e.SoundManager.stopSFXLoop("s_barrelFire"),this.fireNow=!1,this.iceRock.counterAnim<70&&(this.iceRock.activeAnim=!1)},i.prototype.frostOn=function(){e.SoundManager.playSFX("sfx_freezeNoise",!0),this.frostNow=!0},i.prototype.endFrost=function(){e.SoundManager.stopSFXLoop("sfx_freezeNoise"),this.frostNow=!1},i.prototype.startDrag=function(){this.drag=!0},i.prototype.stopDrug=function(){this.drag=!1},i.prototype.update=function(){if(!0===this.fireNow){for(t=0;t<1;t++)null===(i=this.group.getFirstDead(!1,0,0,"level10","fireParticle instance 10000"))&&this.group.length<30&&(i=this.group.create(0,0,"level10","fireParticle instance 10000")),null!=i&&this.createParticle(i,"fireParticle",17);!1===this.wheelyBurn&&Math.abs(this.drake.y-e.GameManager.instance.hero.bodyBase.y)<155&&Math.abs(this.drake.x-e.GameManager.instance.hero.bodyBase.x)<60&&(e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.level.gameOver=!0,this.wheelyBurn=!0,e.GameManager.instance.hero.currEyesState=e.EyesState.afraid,e.GameManager.instance.hero.showBurn(),e.SoundManager.playSFX("s_wheelyFlame")),Math.abs(265-this.drake.x)<105&&this.frozenWaterFrame>1e4&&(this.frozenWaterFrame-=.5,this.frozenWater.frameName="frozenWater instance "+Math.round(this.frozenWaterFrame),this.waterFrozen=!1,this.waterBody.sensor=!0),this.box.alpha>0&&Math.abs(90-this.drake.x)<40&&(this.boxInfire=!0)}if(!0===this.frostNow){for(t=0;t<1;t++)null===(i=this.group.getFirstDead(!1,0,0,"level10","frostParticle instance 10000"))&&this.group.length<30&&(i=this.group.create(0,0,"level10","frostParticle instance 10000")),null!=i&&this.createParticle(i,"frostParticle",14);!this.wheelyBurn&&!this.wheelyFrized&&Math.abs(this.drake.y-e.GameManager.instance.hero.bodyBase.y)<155&&Math.abs(this.drake.x-e.GameManager.instance.hero.bodyBase.x)<60&&(this.wheelyFrized=!0,e.GameManager.instance.level.freeze()),!this.emptyPool&&!this.waterFrozen&&Math.abs(265-this.drake.x)<105&&(this.frozenWaterFrame<10073?(this.frozenWaterFrame+=.5,this.frozenWater.frameName="frozenWater instance "+Math.floor(this.frozenWaterFrame)):(this.waterFrozen=!0,this.waterBody.sensor=!1))}if(!0===e.GameManager.instance.level.gameOver&&(90===e.GameManager.instance.level.gameOverDelay&&(this.wheelyBurn=!1),this.boubblsUpdate()),!0===this.boxInfire&&(!0===this.counterBoxBurn&&(this.counterBoxBurn=!1,e.SoundManager.playSFX("s_wheelyFlame",!0)),this.burnObject(this.box.x+75*Math.random(),this.box.y+28+38*Math.random(),!0)),!0===this.wheelyBurn&&(!0===this.counterWheelyBurn&&(this.counterWheelyBurn=!1,e.GameManager.instance.hero.showBurn(),e.SoundManager.playSFX("s_wheelyFlame")),this.burnObject(e.GameManager.instance.hero.bodyBase.x-60+120*Math.random(),e.GameManager.instance.hero.bodyBase.y-30+60*Math.random())),!0===this.waterWork)for(var t=0;t<1;t++){var i=this.group.getFirstDead(!1,0,0,"level10","waterParticle instance 10000");null===i&&this.group.length<30&&(i=this.group.create(0,0,"level10","waterParticle instance 10000")),null!=i&&(this.createParticle(i,"waterParticle",14),i.angle=e.GameManager.instance.level.game.rnd.between(100,110),i.x=this.waterWheel.x-40-5+10*Math.random(),i.y=this.waterWheel.y+100)}},i.prototype.createParticle=function(e,t,i){e.animations.add("idle",Phaser.Animation.generateFrameNames(t+" instance 1",0,i,"",4),40,!1).killOnComplete=!0,e.play("idle"),e.anchor.set(.5,0),e.scale.set(Math.random()+1),e.x=this.drake.world.x-5+10*Math.random(),e.y=this.drake.y+this.drake.height/2-20-10*(e.scale.x-1.5),e.angle=20*Math.random()-20*Math.random()},i.prototype.burnObject=function(t,i,s){void 0===s&&(s=!1),this.boxBurnTimer+=1,110===this.boxBurnTimer?!0===s&&(e.SoundManager.stopSFXLoop("s_wheelyFlame"),e.SoundManager.playSFX("s_boxFire")):120===this.boxBurnTimer&&e.GameManager.instance.level.game.add.tween(this.box).to({alpha:0},200,Phaser.Easing.Linear.None,!0,0).onComplete.addOnce(function(){this.boxInfire=!1,this.box.inputEnabled=!1},this);for(var a=0;a<1;a++){var n=this.group.getFirstDead(!1,0,0,"level10","fireParticle instance 10000");null===n&&this.group.length<45&&(n=this.group.create(0,0,"level10","fireParticle instance 10000")),null!=n&&(n.animations.add("idle",Phaser.Animation.generateFrameNames("fireParticle instance 1",0,17,"",4),40,!1).killOnComplete=!0,n.play("idle"),n.anchor.set(.5,0),n.scale.set(Math.random()+1),n.scale.y*=-1,n.x=t,n.y=i)}},i.prototype.boubblsUpdate=function(){if(!1!==this.underWater)for(var t=0;t<1;t++){var i=this.group.getFirstDead(!1,0,0,"level10","frostParticle instance 10000");null===i&&this.group.length<5&&(i=this.group.create(0,0,"level10","frostParticle instance 10000")),null!=i&&(i.animations.add("idle",Phaser.Animation.generateFrameNames("bubbleWaterPart instance 1",0,9,"",4),25,!1).killOnComplete=!0,i.play("idle"),i.anchor.set(.5,0),i.scale.set(Math.random()+.5),i.x=e.GameManager.instance.hero.bodyBase.x-50+100*Math.random(),i.y=e.GameManager.instance.hero.bodyBase.y+10*Math.random())}},i.prototype.free=function(){t.prototype.free.call(this),this.drake=null,this.fire=[],this.fire=null,this.group=null,this.iceRock=null,this.box=null,this.frozenWater=null,this.waterBody=null,this.waterSensor=null,this.water=null,this.waterWheel=null,this.waterBlur=null},i}(e.BasicElement);e.Lvl10TopAction=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this)||this;a.findHero=!1,a.crushHero=!1,a.body=e.GameManager.instance.layerElements.create(i,s,"level11","lvl12_carBody_mc instance 10000",!0,0),a.body.anchor.set(.5,1);var n=new Phaser.Graphics(e.Main.instance,0,0);return n.beginFill(0,0),n.drawRect(-85,-55,170,110),n.endFill(),a.body.addChild(n),a.eye=e.Main.instance.make.sprite(23,-108,"level11","eye instance 10000"),a.eye.animations.add("wakeUp",Phaser.Animation.generateFrameNames("eye instance 1",1,18,"",4),30,!1).onComplete.addOnce(a.showCloud,a),a.eye.animations.add("anger",Phaser.Animation.generateFrameNames("eye instance 1",19,64,"",4),30,!1).onComplete.addOnce(a.goBack,a),a.eye.animations.add("endAnger",Phaser.Animation.generateFrameNames("eye instance 1",65,74,"",4),30,!1),a.body.addChild(a.eye),a.wheel1=e.Main.instance.make.sprite(45,-5,"level11","lvl12_carWheel_mc instance 10000"),a.wheel1.anchor.set(.5),a.body.addChild(a.wheel1),a.wheel2=e.Main.instance.make.sprite(-45,-5,"level11","lvl12_carWheel_mc instance 10000"),a.wheel2.anchor.set(.5),a.body.addChild(a.wheel2),e.Main.instance.add.tween(a.body.scale).to({y:.97},500,"Linear",!0,0,-1,!0),a.zzz=e.GameManager.instance.layerElements.create(i+50,s-130,"level11","zzz instance 10000"),a.zzz.animations.add("anim",Phaser.Animation.generateFrameNames("zzz instance 1",0,79,"",4),30,!0),a.zzz.play("anim"),a.body.inputEnabled=!0,a.wheel1.inputEnabled=!0,a}return __extends(i,t),i.prototype.showCloud=function(){this.fireCloud=e.GameManager.instance.layerElements.create(this.body.x+50,this.body.y-100,"level11","fireCloud instance 10000"),this.fireCloud.anchor.set(0,1),this.fireCloud.scale.set(0),e.Main.instance.add.tween(this.fireCloud.scale).to({x:1,y:1},200,Phaser.Easing.Back.In,!0),this.eye.play("anger")},i.prototype.wakeUp=function(){this.body.frameName="lvl12_carBody_mc instance 10001",this.zzz.animations.stop(),this.zzz.visible=!1,this.eye.play("wakeUp")},i.prototype.goBack=function(){this.fireCloud.visible=!1,e.Main.instance.add.tween(this.body).to({x:-100},1500,"Linear",!0),e.Main.instance.add.tween(this.wheel1).to({angle:-360},1500,"Linear",!0),e.Main.instance.add.tween(this.wheel2).to({angle:-360},1500,"Linear",!0).onComplete.addOnce(this.pushHero,this)},i.prototype.pushHero=function(){this.findHero=!0,this.body.y=210,this.moveCar=e.Main.instance.add.tween(this.body).to({x:380},1e3,Phaser.Easing.power2,!0,700),this.moveCar.onComplete.addOnce(this.goBack2,this),e.Main.instance.add.tween(this.wheel1).to({angle:1e3},1e3,"Linear",!0,700),e.Main.instance.add.tween(this.wheel2).to({angle:1e3},1e3,"Linear",!0,700)},i.prototype.goBack2=function(){this.eye.play("endAnger");var t=Math.floor(5e3*this.body.x/380);e.Main.instance.add.tween(this.body).to({x:-100},t,Phaser.Easing.power2,!0,700).onComplete.addOnce(this.goBack2,this),e.Main.instance.add.tween(this.wheel1).to({angle:-1e3},t,"Linear",!0,700),e.Main.instance.add.tween(this.wheel2).to({angle:-1e3},t,"Linear",!0,700)},i.prototype.addContactEffect=function(){var t=e.GameManager.instance.layerUpper.create(this.body.x+80,this.body.y-25,"level11","millerHit_mc instance 10000");t.anchor.set(.5),t.animations.add("anim",Phaser.Animation.generateFrameNames("millerHit_mc instance 1",0,10,"",4),30,!1).killOnComplete=!0,t.play("anim")},i.prototype.update=function(){!0===this.findHero&&!1===this.crushHero&&e.Tools.distance(this.body.x,this.body.y,e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y)<100&&(e.GameManager.instance.hero.setEnableMotor(!1),e.GameManager.instance.hero.bodyBase.velocity.x=350,e.GameManager.instance.hero.bodyBase.velocity.y=-50,e.GameManager.instance.hero.currState=e.HeroState.bumpStars,this.crushHero=!0,this.addContactEffect(),this.moveCar.stop(),this.goBack2(),e.GameManager.instance.level.gameOver=!0)},i.prototype.free=function(){this.body=null,this.eye=null,this.wheel1=null,this.wheel2=null,this.zzz=null,this.fireCloud=null,this.moveCar=null},i}(e.BasicElement);e.Lvl11Car=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.connect=!1,i.rotSpeed=.3,i.playRope=!1,i.rope1=new e.Lvl11Rope(448,234,8),i.rope1.angle=10,e.GameManager.instance.layerBackground.addChild(i.rope1),i.rope2=new e.Lvl11Rope(621,282,8),i.rope2.angle=10,i.rope2.scale.x=-1,e.GameManager.instance.layerBackground.addChild(i.rope2),i.wheel1=e.GameManager.instance.layerBackground.create(433,243,"level11","wheel instance 10000"),i.wheel1.anchor.set(.5),i.wheel1.angle=26,i.wheel2=e.GameManager.instance.layerBackground.create(640,280,"level11","wheel instance 10000"),i.wheel2.anchor.set(.5),i.wheel2.angle=14,i.wheel3=e.GameManager.instance.layerBackground.create(624,233,"level11","wheel instance 10000"),i.wheel3.anchor.set(.5),i.wheel3.angle=8,i.wheel3.scale.set(1.09),i.door=e.GameManager.instance.layerUpper.create(624,230,"level11","door instance 10000"),i.door.anchor.set(.5),i.door.pivot.set(74,0),e.Main.instance.physics.box2d.enable(i.door),i.door.body.setRectangle(188,20,-74,0),i.door.body.kinematic=!0,i.door.body.angle=99,i}return __extends(i,t),i.prototype.update=function(){!0===e.GameManager.instance.level.ropeWheel.redWheelConnect?(this.wheel1.angle=e.GameManager.instance.level.ropeWheel.wheel.angle,this.wheel2.angle=e.GameManager.instance.level.ropeWheel.wheel.angle,this.wheel3.angle=-e.GameManager.instance.level.ropeWheel.wheel.angle,this.door.body.angle>0?this.door.body.angle-=e.GameManager.instance.level.rotateWheel.power/10*2:this.door.body.angle=0,!1===this.playRope&&(this.rope1.playAnim(),this.rope2.playAnim(),this.playRope=!0,e.SoundManager.playSFX("s_lvl12_gear",!0))):(!0===this.playRope&&(this.playRope=!1,this.rope1.stopAnim(),this.rope2.stopAnim(),e.SoundManager.stopSFXLoop("s_lvl12_gear")),this.wheel1.angle=26,this.wheel2.angle=14,this.wheel3.angle=8)},i.prototype.free=function(){this.rope1=null,this.rope2=null,this.wheel1=null,this.wheel2=null,this.wheel3=null,this.door=null},i}(e.BasicElement);e.Lvl11Door=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=217.7,s.group.y=531.2,e.GameManager.instance.layerBackground.addChild(s.group),s.part3=new e.SASprite(i,0,0,"level11","part3 instance 10000"),s.part3.anchor.set(.5),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level11","part2 instance 10000"),s.part2.anchor.set(.5),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level11","part1 instance 10000"),s.part1.anchor.set(.5),s.group.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,26,{x:-42,scX:1,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part2,136,{y:22}),e.GameManager.instance.level.setSimpleTween(this.part3,31,{x:0,y:0,scY:1})):27===this.counterAnim?this.setPart(this.part1,{x:-42,y:17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):32===this.counterAnim?this.setPart(this.part3,{x:0,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):137===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:-37,y:17,angle:0,scX:.61,scY:1,skX:0,skY:0,alpha:0}),this.setPart(this.part2,{x:-54,y:46,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:2,y:4,angle:0,scX:1,scY:.68,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part3=null,this.part2=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl11Flour=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this)||this;return n.lowLimit=-70,n.topLimit=70,n.ratio=0,n.game=i,n.arm=n.game.make.sprite(s,a,"level11","arm instance 10000"),n.arm.pivot.set(36,72),e.GameManager.instance.layerElements.addChild(n.arm),n.arm.angle=n.lowLimit,n.button=n.game.make.sprite(35,-10,"level11","armHandlerBody instance 10000"),n.button.anchor.set(.5),n.button.inputEnabled=!0,n.button.input.useHandCursor=!0,n.arm.addChild(n.button),n.button.events.onInputDown.add(n.down,n),n.button.events.onInputUp.add(n.up,n),n.button.events.onInputOver.add(n.over,n),n.button.events.onInputOut.add(n.out,n),n}return __extends(i,t),i.prototype.down=function(){this.buttonDown=!0},i.prototype.up=function(){this.buttonDown=!1},i.prototype.over=function(){this.button.frameName="armHandlerBody instance 10001"},i.prototype.out=function(){this.button.frameName="armHandlerBody instance 10000"},i.prototype.getRatio=function(){return this.ratio},i.prototype.update=function(){if(!0===this.buttonDown){var t=Phaser.Math.angleBetween(this.game.input.activePointer.x,this.game.input.activePointer.y,this.arm.x,this.arm.y),i=e.Tools.toDeg(t-e.Tools.toRad(90));if(i>this.lowLimit&&i<this.topLimit){i<this.lowLimit?i=this.lowLimit:i>this.topLimit&&(i=this.topLimit),this.arm.angle=i;var s=0;s=i<0?Math.abs(this.lowLimit+Math.floor(Math.abs(i))):Math.round(this.topLimit+i),this.ratio=Math.round(100*s/140)/100}}},i.prototype.free=function(){this.game=null,this.arm=null,this.button=null},i}(e.BasicElement);e.Lvl11Lever=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this)||this;return a.startAnim=!1,a.wakeUpCar=!1,a.counter=0,a.musicPlay=!1,a.millWheel=e.GameManager.instance.layerElements.create(i,s,"level11","millWheel instance 10000",!0,0),a.millWheel.anchor.set(.5),e.GameManager.instance.layerElements.create(i-11,s+36,"level11","millstone instance 10000").anchor.set(.5),a.flour=new e.Lvl11Flour(e.Main.instance),e.GameManager.instance.level.updateElements.push(a.flour),a}return __extends(i,t),i.prototype.update=function(){!0===e.GameManager.instance.level.ropeWheel.millConnect?(!1===this.musicPlay&&(this.musicPlay=!0,e.SoundManager.playSFX("s_lvl12_stoneMill",!0)),this.millWheel.angle=-e.GameManager.instance.level.ropeWheel.wheel.angle,!0===e.GameManager.instance.level.rotateWheel.rotateNow&&(!1===this.startAnim&&(this.startAnim=!0,this.flour.playAnim("anim")),!1===this.wakeUpCar&&e.GameManager.instance.level.rotateWheel.power>2&&(this.counter+=1,30===this.counter&&(this.wakeUpCar=!0,this.clouds=new e.Lvl11MillCloud(e.Main.instance),e.GameManager.instance.level.updateElements.push(this.clouds),this.clouds.playAnim("anim"),e.GameManager.instance.level.car.wakeUp(),e.SoundManager.playSFX("s_lvl12_milldust"))))):!0===this.musicPlay&&(this.musicPlay=!1,e.SoundManager.stopSFXLoop("s_lvl12_stoneMill"))},i.prototype.free=function(){this.millWheel=null,this.flour=null,this.clouds=null},i}(e.BasicElement);e.Lvl11Mill=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=205,s.group.y=510,e.GameManager.instance.layerUpper.addChild(s.group),s.cloud3=new e.SASprite(i,0,0,"level11","cloud3 instance 10000"),s.cloud3.anchor.set(.5),s.group.addChild(s.cloud3),s.cloud2=new e.SASprite(i,0,0,"level11","cloud2 instance 10000"),s.cloud2.anchor.set(.5),s.group.addChild(s.cloud2),s.cloud1=new e.SASprite(i,0,0,"level11","cloud1 instance 10000"),s.cloud1.anchor.set(.5),s.group.addChild(s.cloud1),s.setParts("anim"),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.cloud1,22,{x:-40,y:20,scX:.66,scY:.66}),e.GameManager.instance.level.setSimpleTween(this.cloud2,19,{y:5,skX:-4,skY:-4,scX:.59,scY:.59,alpha:.98}),e.GameManager.instance.level.setSimpleTween(this.cloud3,29,{x:-15,y:1,scX:.73,scY:.73})):20===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.cloud2,3,{y:4,skX:-3,skY:-3,scX:.63,scY:.63}):23===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.cloud1,17,{x:-41,y:10,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.cloud2,32,{y:0,skX:0,skY:0,scX:1,scY:1,alpha:1})):30===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.cloud3,20,{x:-17,y:-3,scX:1,scY:1,alpha:0}):40===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.cloud1,30,{skX:-10,skY:-10,scX:1.43,scY:1.43,alpha:0}):50===this.counterAnim?this.setPart(this.cloud3,{x:-17,y:-3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0}):51===this.counterAnim?this.cloud3.visible=!1:55===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.cloud2,29,{scX:1.35,scY:1.35,alpha:0}):70===this.counterAnim?this.setPart(this.cloud1,{x:-41,y:10,angle:0,scX:1.43,scY:1.43,skX:-10,skY:-10,alpha:0}):71===this.counterAnim?this.cloud1.visible=!1:84===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.cloud1,{x:-39,y:36,angle:0,scX:.22,scY:.22,skX:0,skY:0,alpha:1}),this.setPart(this.cloud2,{x:7,y:7,angle:0,scX:.37,scY:.37,skX:-5,skY:-5,alpha:0}),this.setPart(this.cloud3,{x:-10,y:7,angle:0,scX:.2,scY:.2,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.cloud3=null,this.cloud2=null,this.cloud1=null},i}(e.BasicSimpleAnim);e.Lvl11MillCloud=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this)||this;return n.stopUpdate=!1,n.stopFrame=0,n.wheel=i.make.button(s,a,"level11",n.stopDrug,n,"redWheel instance 10001","redWheel instance 10002","redWheel instance 10002","redWheel instance 10002"),n.wheel.anchor.set(.5),e.GameManager.instance.layerElements.addChildAt(n.wheel,0),n.wheel.input.enableDrag(),n.wheel.input.boundsRect=new Phaser.Rectangle(s-n.wheel.width/2,n.wheel.y-n.wheel.height/2,230,n.wheel.height),n.wheel.input.setDragLock(!0,!1),n}return __extends(i,t),i.prototype.stopDrug=function(){},i.prototype.update=function(){!1===this.stopUpdate?this.wheel.x>445&&(this.stopUpdate=!0,this.wheel.inputEnabled=!1,e.GameManager.instance.level.ropeWheel.checkRedWheel()):(this.stopFrame+=1,1===this.stopFrame&&(this.wheel.frameName="redWheel instance 10000")),!0===e.GameManager.instance.level.ropeWheel.redWheelConnect&&(this.wheel.angle=-e.GameManager.instance.level.ropeWheel.wheel.angle)},i.prototype.free=function(){this.wheel=null},i}(e.BasicElement);e.Lvl11RedWheel=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this)||this;return a.group=new Phaser.Group(e.Main.instance),a.group.x=i,a.group.y=s,e.GameManager.instance.layerElements.addChildAt(a.group,0),e.GameManager.instance.layerBackground.create(i,s+111,"level11","rockBack instance 10000"),a.water1=a.group.create(176,21,"level11","water2 instance 10000"),a.water1.anchor.set(1,0),a.tween1=e.Main.instance.add.tween(a.water1.scale).to({x:1.05},250,"Linear",!0,0,-1,!0),a.water2=a.group.create(160,3,"level11","water1 instance 10000"),a.water2.anchor.set(1,0),a.tween2=e.Main.instance.add.tween(a.water2.scale).to({x:.95},200,"Linear",!0,150,-1,!0),a.group.create(152,6,"level11","rockwater instance 10000"),a.rocks=e.Main.instance.make.button(117,1,"level11",a.crushRocks,a,"rocksBody instance 10001","rocksBody instance 10000","rocksBody instance 10000","rocksBody instance 10000"),a.group.addChild(a.rocks),a.group.create(66,0,"level11","rock instance 10000"),a.group.create(-15,221,"level11","watersmoke instance 10000"),a}return __extends(i,t),i.prototype.crushRocks=function(){this.rocks.inputEnabled=!1,this.rocks.visible=!1,this.tween1.stop(),this.tween2.stop(),e.Main.instance.add.tween(this.water2.scale).to({x:1.7,y:1.5},300,"Linear",!0,0),e.Main.instance.add.tween(this.water1.scale).to({x:1.7,y:1.5},300,"Linear",!0,0).onComplete.addOnce(function(){e.Main.instance.add.tween(this.water1.scale).to({x:1.4,y:1.5},400,"Linear",!0,300),e.Main.instance.add.tween(this.water2.scale).to({x:1.4,y:1.5},400,"Linear",!0,300).onComplete.addOnce(function(){e.Main.instance.add.tween(this.water1.scale).to({x:1.45},250,"Linear",!0,0,-1,!0),e.Main.instance.add.tween(this.water2.scale).to({x:1.35},200,"Linear",!0,150,-1,!0)},this)},this),this.throwStones(),e.GameManager.instance.level.rotateWheel.power=2.5,e.SoundManager.stopSFXLoop("s_lvl12_water1"),e.SoundManager.playSFX("s_lvl12_water2",!0)},i.prototype.throwStones=function(){this.createStone(650,343,5,-50),this.createStone(664,293,3,-80),this.createStone(678,285,2,-100),this.createStone(667,272,1,-150)},i.prototype.createStone=function(t,i,s,a){var n=this.group.create(t-this.group.x,i-this.group.y,"level11","lvl12_rock"+s+"_mc instance 10000",!0,4);e.Main.instance.physics.box2d.enable(n),n.body.velocity.x=a,n.body.sensor=!0,n=null},i.prototype.free=function(){this.group=null,this.water1=null,this.water2=null,this.rocks=null,this.tween1=null,this.tween2=null},i}(e.BasicElement);e.Lvl11Rock=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){void 0===a&&(a=6);var n=t.call(this,e.Main.instance)||this;n.rope=new Array,n.x=i,n.y=s;for(var o=0;o<a;o++)n.addRopePart(25.15*o);return n}return __extends(i,t),i.prototype.addRopePart=function(e){var t=this.create(e,0,"level11","ropePart instance 10000");t.animations.add("move",Phaser.Animation.generateFrameNames("ropePart instance 1",0,7,"",4),30,!0),this.rope.push(t)},i.prototype.playAnim=function(){for(var e=0;e<this.rope.length;e++)this.rope[e].play("move")},i.prototype.stopAnim=function(){for(var e=0;e<this.rope.length;e++)this.rope[e].animations.stop()},i.prototype.destroy=function(){t.prototype.destroy.call(this),this.group=null,this.rope=[],this.rope=null},i}(Phaser.Group);e.Lvl11Rope=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this)||this;return a.millConnect=!1,a.redWheelConnect=!1,a.maxAngle=60,a.ropePlay=!1,a.oldAngle=0,a.specialRotate=!1,a.connect=!1,a.group=e.GameManager.instance.layerElements.create(i,s),a.rope1=new e.Lvl11Rope(-144,-83),a.rope1.angle=22,a.group.addChild(a.rope1),a.rope2=new e.Lvl11Rope(0,28),a.rope2.angle=27,a.rope2.scale.x=-1,a.group.addChild(a.rope2),a.wheel=e.Main.instance.make.sprite(-150,-62,"level11","bigWheel instance 10000"),a.wheel.anchor.set(.5),a.group.addChild(a.wheel),a}return __extends(i,t),i.prototype.update=function(){this.group.angle=Math.round(this.maxAngle*e.GameManager.instance.level.lever.getRatio()),!0===e.GameManager.instance.level.rotateWheel.rotateNow?(this.wheel.angle=2*e.GameManager.instance.level.rotateWheel.wheel.body.angle,!1===this.specialRotate&&(this.group.angle<2?(this.group.angle=1,this.wheel.angle=4,this.specialRotate=!0,this.millConnect=!0,e.SoundManager.playSFX("s_lvl12_wheelLock")):this.group.angle>=this.maxAngle-2&&(this.group.angle=this.maxAngle-1,this.wheel.angle=8,this.specialRotate=!0,e.SoundManager.playSFX("s_lvl12_wheelLock"),this.checkRedWheel())),this.group.angle>2&&this.group.angle<this.maxAngle-2&&this.disconnect(),!1===this.ropePlay&&(this.ropePlay=!0,this.rope1.playAnim(),this.rope2.playAnim())):(this.disconnect(),this.connect=!1,this.ropePlay=!1,this.rope1.stopAnim(),this.rope2.stopAnim())},i.prototype.checkRedWheel=function(){this.group.angle===this.maxAngle-1&&!0===e.GameManager.instance.level.redWheel.stopUpdate&&(this.redWheelConnect=!0)},i.prototype.disconnect=function(){this.specialRotate=!1,this.redWheelConnect=!1,this.millConnect=!1},i.prototype.free=function(){t.prototype.free.call(this),this.group=null,this.rope1=null,this.rope2=null,this.wheel=null},i}(e.BasicElement);e.Lvl11RopeWheel=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this)||this;a.rotateNow=!1,a.power=1.5,a.wheel=e.GameManager.instance.layerElements.create(i,s,"level11","millWheel_mc instance 10000"),e.Main.instance.physics.box2d.enable(a.wheel),a.wheel.body.setRectangle(8,190,0,0,e.Tools.toRad(-15)),a.wheel.body.addRectangle(8,190,0,0,e.Tools.toRad(-60)),a.wheel.body.addRectangle(8,190,0,0,e.Tools.toRad(30)),a.wheel.body.addRectangle(8,190,0,0,e.Tools.toRad(75)),a.wheel.body.addCircle(70,0,0),a.wheel.body.restitution=.05;var n=new Phaser.Physics.Box2D.Body(e.Main.instance,null,i,s,0);return n.setRectangle(20,20),n.sensor=!0,e.Main.instance.physics.box2d.revoluteJoint(a.wheel.body,n),a.wheelJoint=e.Main.instance.physics.box2d.wheelJoint(a.wheel.body,n,0,0,0,0,0,0,2,.1,1,4,!0),a.blocker=e.GameManager.instance.layerElements.create(512,395,"level11","blocker_mc instance 10000"),a.blocker.anchor.set(.5,.5),a.blocker.pivot.set(20,0),e.Main.instance.physics.box2d.enable(a.blocker),a.blocker.body.setRectangle(45,10,-25,0),a.blocker.body.mass=3.5,a.blocker.body.data.SetUserData("DragBody"),a.blocker.inputEnabled=!0,a.blocker.input.useHandCursor=!0,a.blocker.events.onInputOver.add(a.over,a),a.blocker.events.onInputOut.add(a.out,a),a.blocker.body.angle=-30,(n=new Phaser.Physics.Box2D.Body(e.Main.instance,null,505,406,0)).setRectangle(20,20),n.sensor=!0,e.Main.instance.physics.box2d.revoluteJoint(a.blocker.body,n),a}return __extends(i,t),i.prototype.over=function(){this.blocker.frameName="blocker_mc instance 10001"},i.prototype.out=function(){this.blocker.frameName="blocker_mc instance 10000"},i.prototype.update=function(){this.wheel.body.angularVelocity=this.power,this.blocker.body.angle<0&&this.blocker.body.angle>-90?this.rotateNow=!1:this.rotateNow=!0},i.prototype.free=function(){this.wheel=null,this.wheelJoint=null,this.blocker=null},i}(e.BasicElement);e.Lvl11RotateWheel=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=480,s.group.y=412,e.GameManager.instance.layerBackground.addChild(s.group),s.part2=new e.SASprite(i,0,0,"level12","bgEyePart instance 10000"),s.part2.pivot.set(43,53),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level12","bgEye instance 10000"),s.part1.anchor.set(.7,.7),s.part1.animations.add("anim",Phaser.Animation.generateFrameNames("bgEye instance 1",0,90,"",4),30,!0),s.part1.play("anim"),s.group.addChild(s.part1),s.part3=s.group.create(-180,-90,"level12","bgEyeMain instance 10000"),s.playAnim("anim",-1),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,22,{x:-1,y:-32,skX:20,skY:20}),e.GameManager.instance.level.setSimpleTween(this.part2,22,{y:10,scY:.92})):47===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,20,{x:-6,y:-35,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.part2,20,{y:3,scY:1.07})):67===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,9,{x:-4,y:-33,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,9,{y:6,scY:1})):76===this.counterAnim?(this.setPart(this.part1,{x:-4,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:0,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):94===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,22,{x:2,y:-39,skX:38,skY:38}):116===this.counterAnim?this.setPart(this.part1,{x:2,y:-39,angle:0,scX:1,scY:1,skX:38,skY:38,alpha:1}):134===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,11,{x:-5,y:-31,skX:-10,skY:-10}):145===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,10,{x:-4,y:-34,skX:3,skY:3}):155===this.counterAnim?this.setPart(this.part1,{x:-4,y:-34,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}):166===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:-4,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:0,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part2=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl12BgEye=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.direction=0,s.oldAngle=0,s.active=!1,s.openSpeed=.5,s.door=e.GameManager.instance.layerElements.create(724,266,"level12","door instance 10000"),i.physics.box2d.enable(s.door),s.door.body.kinematic=!0,s.door.body.sensor=!0,s.door.body.setCollisionCategory(e.FilterGroups.WALL),s.mask=new Phaser.Graphics(i,724,470),s.mask.beginFill(0,1),s.mask.drawRect(-12,-115,25,200),s.mask.endFill(),e.GameManager.instance.layerBackground.addChild(s.mask),s.door.mask=s.mask,s.group=new Phaser.Group(i),s.group.x=744,s.group.y=205,e.GameManager.instance.layerUpper.addChild(s.group),s.button=i.make.sprite(0,0,"level12","switch instance 10000"),s.button.anchor.set(.2,.5),s.group.addChild(s.button),s.button.events.onInputDown.add(s.down,s),s.button.events.onInputUp.add(s.up,s),s.button.events.onInputOver.add(s.over,s),s.button.events.onInputOut.add(s.out,s),s.wheel=e.Main.instance.make.sprite(0,0,"level12","doorWheel instance 10000"),s.wheel.anchor.set(.5),s.group.addChild(s.wheel),s}return __extends(i,t),i.prototype.closeDoor=function(){e.Main.instance.add.tween(this.door.body).to({y:466},4500,"Linear",!0)},i.prototype.show=function(){e.Main.instance.add.tween(this.group).to({y:490},1e3,Phaser.Easing.Linear.None,!0)},i.prototype.down=function(){this.buttonDown=!0},i.prototype.up=function(){this.buttonDown=!1,this.direction=0},i.prototype.over=function(){!0===this.active&&(this.button.frameName="switch instance 10001")},i.prototype.out=function(){!0===this.active&&(this.button.frameName="switch instance 10002")},i.prototype.getDirection=function(){return this.direction},i.prototype.update=function(){if(!0===this.buttonDown){var t=Phaser.Math.angleBetween(e.Main.instance.input.activePointer.x,e.Main.instance.input.activePointer.y,this.button.world.x,this.button.world.y);if(this.oldAngle===t)return void(this.direction=0);t>this.oldAngle?this.direction=-1:this.direction=1,this.button.rotation=t-e.Tools.toRad(180),this.oldAngle=t,this.wheel.angle-=3*this.direction,1===this.direction&&(this.door.body.y>266?this.door.body.y-=this.openSpeed:this.door.body.y=266)}!1===this.active&&e.GameManager.instance.hero.bodyBase.x>680&&(this.active=!0,this.button.inputEnabled=!0,this.button.input.useHandCursor=!0,this.door.body.sensor=!1,this.button.frameName="switch instance 10002")},i.prototype.free=function(){this.button=null,this.group=null},i}(e.BasicElement);e.Lvl12Door=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n){var o=t.call(this)||this;return o.side=1,o.canShoot=!0,o.shootTimer=999,o.shootDelay=360,o.hitNow=!1,o.heroLimit=0,o.carHited=!1,o.side=a,o.heroLimit=n,o.group=new Phaser.Group(e.Main.instance),o.group.x=i,o.group.y=s,o.group.scale.x*=a,e.GameManager.instance.layerElements.addChild(o.group),o.body=o.group.create(0,0,"level12","enemyBody instance 10000"),o.body.anchor.set(.5),o.eye=o.group.create(-10,-25,"level12","enemyEye instance 10000"),o.eye.animations.add("idle",Phaser.Animation.generateFrameNames("enemyEye instance 1",0,71,"",4),30,!0),o.eye.animations.add("hit",Phaser.Animation.generateFrameNames("enemyEye instance 1",72,103,"",4),30,!1),o.eye.play("idle"),o.eye.anchor.set(.5),o.stars=o.group.create(-10,-42,"level12","Stars instance 10000"),o.stars.animations.add("idle",Phaser.Animation.generateFrameNames("Stars instance 1",0,16,"",4),30,!0),o.stars.play("idle"),o.stars.visible=!1,o.stars.anchor.set(.5),o.wheel1=o.group.create(-31,30,"level12","enemyWheel instance 10000"),o.wheel1.anchor.set(.5),o.wheel2=o.group.create(29,30,"level12","enemyWheel instance 10000"),o.wheel2.anchor.set(.5),o.addArbalet(),o.addBody(),o}return __extends(i,t),i.prototype.addBody=function(){this.physics=new Phaser.Physics.Box2D.Body(e.Main.instance,null,this.group.x,this.group.y),this.physics.setRectangle(110,30,0,28),this.physics.addRectangle(50,50,-15,-25),this.physics.static=!0,this.physics.setBodyContactCallback(e.GameManager.instance.level.rock.rock.body,this.hit,this)},i.prototype.hit=function(e,t,i,s,a){a&&!0===this.canShoot&&(this.carHited=!0)},i.prototype.addArbalet=function(){this.arbalet=this.group.create(-58,5,"level12","crossbow_mc instance 10000"),this.arbalet.animations.add("shoot",Phaser.Animation.generateFrameNames("crossbow_mc instance 1",0,54,"",4),30,!1).onComplete.add(this.shoot,this),this.arbalet.animations.add("reload",Phaser.Animation.generateFrameNames("crossbow_mc instance 1",55,64,"",4),30,!1),this.arbalet.pivot.set(73,11)},i.prototype.addFake=function(){var t=e.GameManager.instance.layerElements.create(this.group.x-58,this.group.y+5,"level12","crossbow_mc instance 10000");e.Main.instance.physics.box2d.enable(t),t.body.setRectangle(60,10),t.body.setCollisionMask(e.FilterGroups.DEFAULT),t.body.velocity.x=-50},i.prototype.update=function(){if(e.GameManager.instance.hero.bodyBase.x>this.heroLimit&&e.GameManager.instance.hero.bodyBase.x<700&&!0===this.canShoot){this.shootTimer+=1,this.shootTimer>=this.shootDelay&&(this.shootTimer=0,this.arbalet.play("shoot"),e.SoundManager.playSFX("s_lvl11_shootBow"));var t=Phaser.Math.angleBetween(e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y,this.arbalet.world.x,this.arbalet.world.y);1===this.side?this.arbalet.angle=Phaser.Math.radToDeg(t):this.arbalet.angle=Phaser.Math.radToDeg(t*this.side)+180,null!=this.arrow&&!1===this.hitNow&&Phaser.Math.distance(this.arrow.body.x,this.arrow.body.y,e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y)<27&&(this.hitNow=!0,this.hitCar())}!0===this.carHited&&(this.carHited=!1,this.physics.dynamic=!0,this.physics.velocity.x=450,this.arbalet.visible=!1,this.eye.play("hit"),this.stars.visible=!0,this.canShoot=!1,this.addFake(),e.Main.instance.add.tween(this.wheel1).to({angle:360},2e3,"Linear",!0),e.Main.instance.add.tween(this.wheel2).to({angle:360},2e3,"Linear",!0),e.SoundManager.playSFX("s_lvl11_hitWarden")),this.group.x=this.physics.x,this.group.y=this.physics.y,this.group.angle=this.physics.angle},i.prototype.hitCar=function(){null!=e.GameManager.instance.level.heroShield&&!0===e.GameManager.instance.level.heroShield.active?(e.GameManager.instance.level.heroShield.addArrow(this.arrow.body.angle),this.arrow.visible=!1,this.arrow.body.data.SetActive(!1),e.SoundManager.playSFX("s_lvl11_arrowShield")):(e.GameManager.instance.hero.currState=e.HeroState.bumpStars,e.GameManager.instance.hero.setEnableMotor(!1),this.canShoot=!1,e.GameManager.instance.level.gameOver=!0,e.SoundManager.playSFX("slvl11_arrowWheely")),this.arrow.body.setZeroVelocity()},i.prototype.shoot=function(){this.hitNow=!1,null==this.arrow&&(this.arrow=e.GameManager.instance.layerBackground.create(this.arbalet.world.x,this.arbalet.world.y,"level12","arrow_mc instance 10000"),this.arrow.scale.x=this.side,e.Main.instance.physics.box2d.enable(this.arrow),this.arrow.body.kinematic=!0,this.arrow.pivot.set(-25,-6),this.arrow.body.setRectangle(50,12,25*this.side,6),this.arrow.body.sensor=!0),this.arrow.body.data.SetActive(!0),this.arrow.visible=!0,this.arrow.body.x=this.arbalet.world.x+5*this.side,this.arrow.body.y=this.arbalet.world.y+3,this.arrow.body.angle=this.arbalet.angle*this.side,this.arrow.body.setZeroVelocity();var t=new box2d.b2Vec2(e.GameManager.instance.hero.bodyBase.x-this.arbalet.world.x,e.GameManager.instance.hero.bodyBase.y-this.arbalet.world.y);t.Normalize(),t.SelfMul(350),this.arrow.body.velocity.x=t.x,this.arrow.body.velocity.y=t.y,this.arbalet.play("reload")},i.prototype.free=function(){},i}(e.BasicElement);e.Lvl12Enemy=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.doorDestroyed=!1,i.timer=0,i.door=e.GameManager.instance.layerElements.create(564,428,"level12","massiveDoor instance 10000"),e.Main.instance.physics.box2d.enable(i.door),i.door.body.setRectangle(35,150,0,0),i.door.body.kinematic=!0,i}return __extends(i,t),i.prototype.destroyDoor=function(){this.door.visible=!1,this.door.body.data.SetActive(!1),this.part1=e.GameManager.instance.layerElements.create(565,398,"level12","doorPart1 instance 10000",!0,0),e.Main.instance.physics.box2d.enable(this.part1),this.part1.body.setRectangle(30,95),this.part1.body.setCollisionMask(~e.FilterGroups.PARTICLE),this.part2=e.GameManager.instance.layerElements.create(568,476,"level12","doorPart2 instance 10000",!0,0),e.Main.instance.physics.box2d.enable(this.part2),this.part2.body.setCollisionMask(~e.FilterGroups.PARTICLE),this.part1.body.velocity.x=350,this.part1.body.velocity.y=-200,this.part1.body.angularVelocity=-2,this.part2.body.velocity.x=400,this.part2.body.velocity.y=-100,this.part2.body.angularVelocity=2,this.doorDestroyed=!0,e.SoundManager.playSFX("s_lvl11_gateDestroy")},i.prototype.update=function(){!0===this.doorDestroyed&&(this.timer+=1,90===this.timer&&(this.part1.body.static=!0,this.part1.body.sensor=!0))},i}(e.BasicElement);e.Lvl12MassiveDoor=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.back=e.GameManager.instance.layerElements.create(290,166,"level12","progressBack instance 10000"),i.back.anchor.set(.5),i.bar=e.Main.instance.make.sprite(-176,1,"level12","bar instance 10000"),i.bar.anchor.set(.5),i.back.addChild(i.bar),i.mask=new Phaser.Graphics(e.Main.instance,-5,0),i.mask.beginFill(0,1),i.mask.drawRect(-87,-20,175,40),i.mask.endFill(),i.back.addChild(i.mask),i.bar.mask=i.mask,i.stone=e.Main.instance.make.sprite(-138,-20,"level12","progressStone instance 10000"),i.back.addChild(i.stone),i.spikes=e.Main.instance.make.sprite(-8,-16,"level12","spikes instance 10000"),i.back.addChild(i.spikes),i.setProgress(50),i.hide(),i}return __extends(i,t),i.prototype.hide=function(){this.back.visible=!1},i.prototype.show=function(){this.back.visible=!0},i.prototype.setProgress=function(t){if(!0===e.GameManager.instance.level.dragNow){var i=170*t/100-176;this.bar.x=i}else this.bar.x>-176&&(this.bar.x-=10)},i.prototype.free=function(){this.back=null,this.bar=null,this.stone=null,this.spikes=null,this.mask=null},i}(e.BasicElement);e.Lvl12Progress=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n){var o=t.call(this)||this;return o.id=0,o.currentFrame=0,o.speed=1.5,o.fly=!1,o.id=n,o.stone=e.GameManager.instance.layerUpper.create(s,a,"level12","secret"+n+" instance 10000",!0,1),o.stone.anchor.set(.5),o.stone.inputEnabled=!0,o.stone.input.useHandCursor=!0,o.stone.events.onInputUp.add(o.use,o),o}return __extends(i,t),i.prototype.use=function(){this.currentFrame+=1,this.currentFrame<3&&(this.stone.frameName="secret"+this.id+" instance 1000"+this.currentFrame),3===this.currentFrame&&(this.stone.inputEnabled=!1,this.fly=!0)},i.prototype.update=function(){!0===this.fly&&this.stone.y<650&&(this.speed+=.2,this.stone.y+=this.speed)},i.prototype.free=function(){this.stone=null},i}(e.BasicElement);e.Lvl12SecretStone=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=613,s.group.y=500,s.group.angle=22,e.GameManager.instance.layerUpper.addChild(s.group),s.glow2=new e.SASprite(i,0,0,"level12","glow1 instance 10000"),s.group.addChild(s.glow2),s.glow1=new e.SASprite(i,0,0,"level12","glow2 instance 10000"),s.group.addChild(s.glow1),s.shield=s.group.create(0,0,"level12","shield instance 10000"),s.shield.anchor.set(.5),s.setParts("anim"),s}return __extends(i,t),i.prototype.pickUp=function(){this.playAnim("anim"),e.Main.instance.add.tween(this.group).to({x:this.group.x-112,y:this.group.y-60,angle:-49},1200,"Linear",!0).onComplete.add(this.hide,this)},i.prototype.hide=function(){e.GameManager.instance.level.addHeroShield(),this.group.visible=!1},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(this.setPart(this.glow1,{x:-24,y:-48,angle:0,scX:.36,scY:.67,skX:0,skY:0,alpha:.07}),e.GameManager.instance.level.setSimpleTween(this.glow2,9,{x:-85,y:-83,scX:1,scY:1,alpha:1})):2===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.glow1,8,{x:-59,y:-66,scX:.7,scY:.84,alpha:.56}):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.glow1,9,{x:-87,y:-79,scX:1,scY:1,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.glow2,9,{x:-77,y:-90,scX:.91,scY:.91,alpha:.82})):19===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.glow1,{x:-24,y:-48,angle:0,scX:.36,scY:.67,skX:0,skY:0,alpha:.07}),this.setPart(this.glow2,{x:-28,y:-48,angle:0,scX:.35,scY:.67,skX:0,skY:0,alpha:.07}))},i.prototype.free=function(){this.group=null,this.glow2=null,this.glow1=null},i}(e.BasicSimpleAnim);e.Lvl12Shield=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.deactivateNow=!1,i.activeRock=!1,i.stones=e.GameManager.instance.layerBackground.create(372,409,"level12","stones instance 10000"),i.stones.anchor.set(.5),i.stones.inputEnabled=!0,i.stones.input.useHandCursor=!0,i.stones.events.onInputDown.add(i.up,i),i.stones.events.onInputOver.add(i.over,i),i.stones.events.onInputOut.add(i.out,i),i.rock=e.GameManager.instance.layerElements.create(0,0,"level12","rockBody instance 10000"),e.Main.instance.physics.box2d.enable(i.rock),i.rock.body.setCircle(19),i.rock.body.friction=3,i.rock.body.data.SetUserData("DragBody"),i.rock.body.setCollisionMask(e.FilterGroups.DEFAULT),i.rock.anchor.set(.5),i.rock.inputEnabled=!0,i.rock.input.useHandCursor=!0,i.rock.events.onInputUp.add(i.upRock,i),i.rock.events.onInputOver.add(i.overRock,i),i.rock.events.onInputOut.add(i.outRock,i),i.hide(),i}return __extends(i,t),i.prototype.hide=function(){this.rock.body.data.SetActive(!1),this.rock.visible=!1},i.prototype.up=function(){this.rock.body.data.SetActive(!0),this.rock.visible=!0,this.rock.body.x=this.stones.x,this.rock.body.y=this.stones.y,this.activeRock=!0,this.rock.body.setZeroRotation(),this.rock.body.setZeroDamping(),this.rock.body.setZeroVelocity(),this.stones.frameName="stones instance 10002",this.stones.inputEnabled=!1,e.SoundManager.playSFX("s_lvl11_takeStone"),e.GameManager.instance.level.mouseDragStart()},i.prototype.over=function(){this.stones.frameName="stones instance 10001"},i.prototype.out=function(){!1===this.activeRock?this.stones.frameName="stones instance 10000":this.stones.frameName="stones instance 10002"},i.prototype.upRock=function(){this.rock.frameName="rockBody instance 10000"},i.prototype.overRock=function(){this.rock.frameName="rockBody instance 10001"},i.prototype.outRock=function(){this.rock.frameName="rockBody instance 10000"},i.prototype.update=function(){!1===this.deactivateNow&&!0===this.activeRock&&(this.rock.body.x<-50||this.rock.body.x>850||this.rock.body.y<-100||this.rock.body.y>650)&&(this.activeRock=!1,this.hide(),this.stones.frameName="stones instance 10000",this.stones.inputEnabled=!0,this.stones.input.useHandCursor=!0)},i.prototype.shoot=function(e){this.rock.body.x=230,this.rock.body.y=240,this.rock.body.data.SetActive(!0),this.rock.visible=!0,this.activeRock=!0,this.rock.body.setZeroRotation(),this.rock.body.setZeroDamping(),this.rock.body.setZeroVelocity(),this.rock.body.velocity.x=5.3*e,this.rock.body.velocity.y=-4.6*e},i.prototype.deactivate=function(){this.stones.frameName="stones instance 10002",this.stones.inputEnabled=!1,this.deactivateNow=!0},i.prototype.free=function(){this.stones=null,this.rock=null},i}(e.BasicElement);e.Lvl12Stones=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this)||this;n.contactNow=!1,n.doorContact=!1,n.doorDestroyed=!1,n.doorClosed=!1,n.ready=!1,n.power=0,n.newAng=0,n.timer=0,n.shootNow=!1,n.canConnect=!1,n.stopCatapultaUpdate=!1,n.haveStone=!1,n.stopMusic=!1,n.dragSound=!1;var o;return n.wheel1=e.GameManager.instance.layerElements.create(-31,45,"level12","taranWheel instance 10000",!0,0),i.physics.box2d.enable(n.wheel1),o=n.wheel1.body.setCircle(17),o.m_filter.categoryBits=e.FilterGroups.PARTICLE,n.wheel1.body.friction=5,n.wheel1.body.mass=5,n.wheel2=e.GameManager.instance.layerElements.create(10,45,"level12","taranWheel instance 10000",!0,0),i.physics.box2d.enable(n.wheel2),o=n.wheel2.body.setCircle(17),o.m_filter.categoryBits=e.FilterGroups.PARTICLE,n.wheel2.body.friction=5,n.body=e.GameManager.instance.layerElements.create(s,a,"level12","taran instance 10000",!0,0),i.physics.box2d.enable(n.body),o=n.body.body.setRectangle(130,30,0,30),o.m_filter.categoryBits=e.FilterGroups.PARTICLE,n.body.body.angle=13,n.body.body.mass=5,n.body.body.static=!0,i.physics.box2d.revoluteJoint(n.body,n.wheel1,-31,42,0,0),i.physics.box2d.revoluteJoint(n.body,n.wheel2,10,42,0,0),n.wheel1.body.fixedRotation=!0,n.wheel2.body.fixedRotation=!0,n.body.body.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,n.contact,n),e.GameManager.instance.hero.bodyBase.setBodyContactCallback(n.body.body,n.contact,n),n.body.body.setBodyContactCallback(e.GameManager.instance.level.massiveDoor.door.body,n.destroyDoor,n),n.progressBar=new e.Lvl12Progress,e.GameManager.instance.level.updateElements.push(n.progressBar),n.catapulta=e.GameManager.instance.layerElements.create(s,a,"level12","catapultArm_mc instance 10002",!0,0),n.catapulta.rotation=Phaser.Math.degToRad(25),n.catapulta.anchor.set(.5),n.catapulta.inputEnabled=!0,n.catapulta.input.useHandCursor=!0,n.catapulta.events.onInputOver.add(n.over,n),n.catapulta.events.onInputOut.add(n.out,n),n.catapultaPhysics=new Phaser.Physics.Box2D.Body(i,null,s,a,2),n.catapultaPhysics.setRectangle(60,50,-30,-15,Phaser.Math.degToRad(30)),n.catapultaPhysics.data.SetUserData("DragBody"),n.catapultaPhysics.sensor=!0,i.physics.box2d.weldJoint(n.body.body,n.catapultaPhysics,0,-10,25,27,4,.5),n.catapultaPhysics.setBodyContactCallback(e.GameManager.instance.level.rock.rock.body,n.catapultaReady,n),n}return __extends(i,t),i.prototype.over=function(){!1===this.haveStone?this.catapulta.frameName="catapultArm_mc instance 10001":this.catapulta.frameName="catapultArm_mc instance 10004"},i.prototype.out=function(){!1===this.haveStone?this.catapulta.frameName="catapultArm_mc instance 10002":this.catapulta.frameName="catapultArm_mc instance 10005"},i.prototype.catapultaReady=function(t,i,s,a,n){n&&null!==t&&null!==i&&!1===this.canConnect&&(this.canConnect=!0,this.haveStone=!0,e.SoundManager.playSFX("s_lvl11_prepareCatapult"),this.catapulta.frameName="catapultArm_mc instance 10001")},i.prototype.destroyDoor=function(){this.doorContact=!0},i.prototype.contact=function(){this.contactNow=!0},i.prototype.update=function(){!0===this.body.body.static&&!0===this.contactNow&&(e.SoundManager.playSFX("s_lvl11_catapultMove",!0),this.body.body.dynamic=!0,this.wheel1.body.fixedRotation=!1,this.wheel2.body.fixedRotation=!1,e.Main.instance.physics.box2d.mouseDragEnd(),this.catapultaPhysics.data.SetUserData("null"),e.GameManager.instance.level.rock.deactivate(),this.progressBar.hide(),this.stopCatapultaUpdate=!0,this.catapulta.inputEnabled=!1,!1===this.haveStone?this.catapulta.frameName="catapultArm_mc instance 10000":this.catapulta.frameName="catapultArm_mc instance 10003"),!0===this.doorContact&&!1===this.doorDestroyed&&(this.doorDestroyed=!0,this.body.body.velocity.x=-150,e.GameManager.instance.level.massiveDoor.destroyDoor()),this.body.body.x>650&&!1===this.doorClosed&&(this.doorClosed=!0,e.GameManager.instance.level.door.closeDoor()),this.body.body.x>800&&!1===this.stopMusic&&(this.stopMusic=!0,e.SoundManager.stopSFXLoop("s_lvl11_catapultMove")),this.catapulta.x=this.catapultaPhysics.x,this.catapulta.y=this.catapultaPhysics.y,this.catapulta.rotation=this.catapultaPhysics.rotation+Phaser.Math.degToRad(30),!1===this.stopCatapultaUpdate&&(!0===this.ready&&(this.newAng=100*(8-Math.floor(this.catapultaPhysics.angle))/55,this.newAng<-10&&this.shoot(),this.newAng=Phaser.Math.clamp(this.newAng,0,100),this.progressBar.setProgress(this.newAng),this.newAng>0&&!1===this.dragSound&&(this.dragSound=!0,e.SoundManager.playSFX("s_lvl11_dragCatapult"))),!0===this.shootNow&&(this.timer+=1,60===this.timer&&(this.timer=0,this.shootNow=!1,this.ready=!1,this.canConnect=!1)),this.catapultaPhysics.angle<-45&&(this.catapultaPhysics.angle=-45),!0===this.canConnect&&!1===this.ready&&(this.catapulta.frameName="catapultArm_mc instance 10001",e.GameManager.instance.level.rock.hide(),this.ready=!0,this.progressBar.show()))},i.prototype.dragEnd=function(){this.dragSound=!1,this.power=this.newAng},i.prototype.shoot=function(){!1===this.shootNow&&(e.SoundManager.playSFX("s_lvl11_catapultRelease"),e.GameManager.instance.level.rock.shoot(this.power),this.catapulta.frameName="catapultArm_mc instance 10000",this.shootNow=!0,this.progressBar.hide(),this.haveStone=!1)},i.prototype.free=function(){this.body=null,this.wheel1=null,this.wheel2=null},i}(e.BasicElement);e.Lvl12Taran=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t){var i=e.call(this,t)||this;return i.goNormalTime=20,i}return __extends(t,e),t.prototype.goNormal=function(){},t}(e.BasicSimpleAnim);e.BasicDragon=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;s.counter=0,s.updateParticles=!0,s.game=i,s.particle=new Array,s.group=i.make.group(),s.group.x=346,s.group.y=471,e.GameManager.instance.layerBackground.addChild(s.group),s.part29=i.make.sprite(346,471,"level13","crystalBallPart29 instance 10000"),s.part29.anchor.x=.5,e.GameManager.instance.layerBackground.addChild(s.part29),s.part28=new e.SASprite(i,0,0,"level13","crystalBallPart28 instance 10000"),s.part28.pivot.set(17,17),s.group.addChild(s.part28),s.part27=new e.SASprite(i,0,0,"level13","crystalBallPart27 instance 10000"),s.part27.pivot.set(12,11),s.group.addChild(s.part27),s.part26=new e.SASprite(i,0,0,"level13","crystalBallPart26 instance 10000"),s.part26.pivot.set(40,40),s.group.addChild(s.part26),s.part25=new e.SASprite(i,0,0,"level13","crystalBallPart25 instance 10000"),s.part25.pivot.set(11,5),s.group.addChild(s.part25),s.part24=new e.SASprite(i,0,0,"level13","crystalBallPart24 instance 10000"),s.part24.pivot.set(6,5),s.group.addChild(s.part24),s.part23=new e.SASprite(i,0,0,"level13","crystalBallPart23 instance 10000"),s.part23.pivot.set(3,7),s.group.addChild(s.part23),s.part22=new e.SASprite(i,0,0,"level13","crystalBallPart22 instance 10000"),s.part22.pivot.set(5,6),s.group.addChild(s.part22),s.part21=new e.SASprite(i,0,0,"level13","crystalBallPart21 instance 10000"),s.part21.pivot.set(6,6),s.group.addChild(s.part21),s.part20=new e.SASprite(i,0,0,"level13","crystalBallPart20 instance 10000"),s.part20.pivot.set(5,11),s.group.addChild(s.part20),s.part19=new e.SASprite(i,0,0,"level13","crystalBallPart19 instance 10000"),s.part19.pivot.set(6,7),s.group.addChild(s.part19),s.part18=new e.SASprite(i,0,0,"level13","crystalBallPart18 instance 10000"),s.part18.pivot.set(5,4),s.group.addChild(s.part18),s.part17=new e.SASprite(i,0,0,"level13","crystalBallPart17 instance 10000"),s.part17.pivot.set(5,2),s.group.addChild(s.part17),s.part16=new e.SASprite(i,0,0,"level13","crystalBallPart16 instance 10000"),s.part16.pivot.set(5,2),s.group.addChild(s.part16),s.part15=new e.SASprite(i,0,0,"level13","crystalBallPart15 instance 10000"),s.part15.pivot.set(4,3),s.group.addChild(s.part15),s.part14=new e.SASprite(i,0,0,"level13","crystalBallPart14 instance 10000"),s.part14.pivot.set(4,4),s.group.addChild(s.part14),s.part13=new e.SASprite(i,0,0,"level13","crystalBallPart13 instance 10000"),s.part13.pivot.set(1,3),s.group.addChild(s.part13),s.part12=new e.SASprite(i,0,0,"level13","crystalBallPart12 instance 10000"),s.part12.pivot.set(1,1),s.group.addChild(s.part12),s.part11=new e.SASprite(i,0,0,"level13","crystalBallPart11 instance 10000"),s.part11.pivot.set(4,6),s.group.addChild(s.part11),s.part10=new e.SASprite(i,0,0,"level13","crystalBallPart10 instance 10000"),s.part10.pivot.set(1,2),s.group.addChild(s.part10),s.part9=new e.SASprite(i,0,0,"level13","crystalBallPart9 instance 10000"),s.part9.pivot.set(7,8),s.group.addChild(s.part9),s.part8=new e.SASprite(i,0,0,"level13","crystalBallPart8 instance 10000"),s.part8.pivot.set(10,6),s.group.addChild(s.part8),s.part7=new e.SASprite(i,0,0,"level13","crystalBallPart7 instance 10000"),s.part7.pivot.set(5,4),s.group.addChild(s.part7),s.part6=new e.SASprite(i,0,0,"level13","crystalBallPart6 instance 10000"),s.part6.pivot.set(5,10),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level13","crystalBallPart5 instance 10000"),s.part5.pivot.set(13,7),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level13","crystalBallPart4 instance 10000"),s.part4.pivot.set(7,11),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level13","crystalBallPart3 instance 10000"),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level13","crystalBallPart2 instance 10000"),s.part2.pivot.set(7,4),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level13","crystalBallPart1 instance 10000"),s.part1.pivot.set(46,46),s.group.addChild(s.part1),s.setParts("anim");for(var a=0;a<4;a++)s.setParticle();return s.magicLightning2=e.GameManager.instance.layerUpper.create(250,415,"level13"),s.magicLightning2.animations.add("anim",Phaser.Animation.generateFrameNames("magicLightning2 instance 1",0,12,"",4),30,!1).killOnComplete=!0,s.magicLightning2.visible=!1,s.magicLightning1=e.GameManager.instance.layerUpper.create(115,305,"level13"),s.magicLightning1.animations.add("anim",Phaser.Animation.generateFrameNames("magicLightning1 instance 1",0,20,"",4),30,!1).onComplete.addOnce(s.lightingComp,s),s.magicLightning1.angle=26,s.magicLightning1.visible=!1,s.magicLightning3=e.GameManager.instance.layerUpper.create(280,455,"level13"),s.magicLightning3.animations.add("anim",Phaser.Animation.generateFrameNames("magicLightning3 instance 1",0,18,"",4),30,!1).killOnComplete=!0,s.magicLightning3.angle=-60,s.magicLightning3.visible=!1,s.magicLightning4=e.GameManager.instance.layerUpper.create(335,460,"level13"),s.magicLightning4.animations.add("anim",Phaser.Animation.generateFrameNames("magicLightning4 instance 1",0,16,"",4),30,!1).killOnComplete=!0,s.magicLightning4.visible=!1,s}return __extends(i,t),i.prototype.lightingComp=function(){this.magicLightning1.destroy(),this.magicLightning2.destroy(),this.magicLightning3.destroy(),this.magicLightning4.destroy(),e.GameManager.instance.level.customAction(3)},i.prototype.crash=function(){this.playAnim("anim"),this.updateParticles=!1,this.magicLightning1.visible=!0,this.magicLightning2.visible=!0,this.magicLightning3.visible=!0,this.magicLightning4.visible=!0,this.magicLightning1.animations.play("anim"),this.magicLightning2.animations.play("anim"),this.magicLightning3.animations.play("anim"),this.magicLightning4.animations.play("anim")},i.prototype.update=function(){t.prototype.update.call(this),!0===this.updateParticles&&(this.counter+=1,4===this.counter&&(this.counter=0,this.setParticle()))},i.prototype.setParticle=function(){for(var t=e.Tools.random(0,360),i=0;i<this.particle.length;i++)if(!1===this.particle[i].visible)return this.particle[i].visible=!0,this.particle[i].angle=t,void this.particle[i].animations.play("anim");var s=e.GameManager.instance.layerUpper.create(346,471,"level13");s.anchor.y=.5,s.pivot.x=-10,s.animations.add("anim",Phaser.Animation.generateFrameNames("magicPinkPart instance 1",0,29,"",4),30,!1).onComplete.add(this.particleAnimComplete,this),s.animations.play("anim"),s.angle=t,this.particle.push(s),s=null},i.prototype.particleAnimComplete=function(e,t){e.visible=!1},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(2===this.counterAnim?(this.part1.visible=!0,this.setPart(this.part1,{x:0,y:1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part1,29,{y:2,scX:1.35,scY:1.35,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part2,29,{x:-15,y:-33,skX:-17,skY:-17,scX:1.35,scY:1.35}),this.part3.visible=!1,this.part4.visible=!0,this.setPart(this.part4,{x:-10,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part4,29,{x:-22,y:-11,scX:1.38,scY:1.38}),this.part5.visible=!0,this.setPart(this.part5,{x:-2,y:10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part5,29,{x:-7,y:22,skX:2,skY:2,scX:1.38,scY:1.38}),this.part6.visible=!0,this.setPart(this.part6,{x:12,y:3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part6,29,{x:27,y:10,scX:1.38,scY:1.38}),this.part7.visible=!0,this.setPart(this.part7,{x:11,y:-6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part7,29,{x:24,y:-14,skX:1,skY:1,scX:1.41,scY:1.41}),this.part8.visible=!0,this.setPart(this.part8,{x:3,y:-11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part8,29,{x:6,y:-25,scX:1.38,scY:1.38}),this.part9.visible=!0,this.setPart(this.part9,{x:2,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part9,29,{y:6,scX:1.47,scY:1.47}),this.part10.visible=!0,this.setPart(this.part10,{x:13,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part10,29,{x:24,y:-20,scX:1.38,scY:1.38}),this.part11.visible=!0,this.setPart(this.part11,{x:13,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part11,29,{x:23,y:8,scX:1.38,scY:1.38}),this.part12.visible=!0,this.setPart(this.part12,{x:10,y:-6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part12,29,{x:17,y:-7,scX:1.56,scY:1.56}),this.part13.visible=!0,this.setPart(this.part13,{x:-4,y:5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part13,29,{x:-10,y:9,scX:1.58,scY:1.47}),this.part14.visible=!0,this.setPart(this.part14,{x:-7,y:9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part14,29,{x:-12,y:16,scX:1.38,scY:1.38}),this.part15.visible=!0,this.setPart(this.part15,{x:-9,y:13,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part15,29,{x:-16,y:21,skX:1,skY:1,scX:1.38,scY:1.38}),this.part16.visible=!0,this.setPart(this.part16,{x:-1,y:15,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part16,29,{y:31,scX:1.38,scY:1.38}),this.part17.visible=!0,this.setPart(this.part17,{x:7,y:15,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part17,29,{x:13,y:29,skX:-1,skY:-1,scX:1.38,scY:1.38}),this.part18.visible=!0,this.setPart(this.part18,{x:10,y:10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part18,29,{x:17,y:17,scX:1.43,scY:1.43}),this.part19.visible=!0,this.setPart(this.part19,{x:2,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part19,29,{x:6,y:17,scX:1.39,scY:1.39}),this.part20.visible=!0,this.setPart(this.part20,{x:-11,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part20,29,{x:-25,skX:1,skY:1,scX:1.38,scY:1.38}),this.part21.visible=!0,this.setPart(this.part21,{x:-2,y:-2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part21,29,{x:-10,y:-5,skX:3,skY:3,scX:1.38,scY:1.38}),this.part22.visible=!0,this.setPart(this.part22,{x:6,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part22,29,{x:13,y:-4,skX:-1,skY:-1,scX:1.4,scY:1.4}),this.part23.visible=!0,this.setPart(this.part23,{x:14,y:-2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part23,29,{x:26,y:-3,skX:1,skY:1,scX:1.38,scY:1.38}),this.part24.visible=!0,this.setPart(this.part24,{x:5,y:-12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part24,29,{x:12,y:-23,skX:1,skY:1,scX:1.38,scY:1.38}),this.part25.visible=!0,this.setPart(this.part25,{x:-2,y:-11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part25,29,{x:-4,y:-22,skX:1,skY:1,scX:1.38,scY:1.38}),this.part26.visible=!0,this.setPart(this.part26,{x:0,y:-1,angle:0,scX:.76,scY:.76,skX:0,skY:0,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part26,29,{y:0,scX:1.35,scY:1.35,alpha:1}),this.part27.visible=!1,this.part28.visible=!1):31===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,9,{y:1,scX:1,scY:1,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part2,14,{x:-62,y:-89,skX:-45,skY:-45,scX:1,scY:1,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part4,9,{x:-57,y:-35,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part5,9,{x:-26,y:58,skX:12,skY:12,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part6,9,{x:67,y:37,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part7,9,{x:64,y:-36,skX:5,skY:5,scX:1.34,scY:1.34}),e.GameManager.instance.level.setSimpleTween(this.part8,9,{x:14,y:-67,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part9,9,{x:0,y:32,scX:1.66,scY:1.66}),e.GameManager.instance.level.setSimpleTween(this.part10,9,{x:51,y:-46,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part11,9,{x:45,y:29,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part12,9,{x:28,y:1,scX:2.15,scY:2.15}),e.GameManager.instance.level.setSimpleTween(this.part13,9,{x:-26,y:15,scX:2.22,scY:1.66}),e.GameManager.instance.level.setSimpleTween(this.part14,9,{x:-18,y:30,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part15,9,{x:-33,y:33,skX:11,skY:11,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part16,9,{x:0,y:73,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part17,9,{x:23,y:64,skX:-7,skY:-7,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part18,9,{x:32,y:25,scX:1.4,scY:1.4}),e.GameManager.instance.level.setSimpleTween(this.part19,9,{x:16,y:47,scX:1.23,scY:1.23}),e.GameManager.instance.level.setSimpleTween(this.part20,9,{x:-61,y:1,skX:5,skY:5,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part21,9,{x:-39,y:-17,skX:21,skY:21,scX:1.15,scY:1.15}),e.GameManager.instance.level.setSimpleTween(this.part22,9,{x:33,y:-18,skX:-5,skY:-5,scX:1.26,scY:1.26}),e.GameManager.instance.level.setSimpleTween(this.part23,9,{x:52,y:-4,skX:9,skY:9,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part24,9,{x:31,y:-50,skX:8,skY:8,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part25,9,{x:-14,y:-49,skX:9,skY:9,scX:1.14,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.part26,9,{scX:1.95,scY:1.95,alpha:0})):40===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part4,5,{x:-87,y:-47,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part5,5,{x:-38,y:91,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part6,5,{x:97,y:52,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part7,5,{x:85,y:-50,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part8,5,{x:21,y:-92,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part9,5,{x:2,y:59,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part10,5,{x:65,y:-58,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part11,5,{x:69,y:45,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part12,5,{x:56,y:9,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part13,5,{x:-38,y:26,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part14,5,{x:-29,y:63,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part15,5,{x:-49,y:57,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part16,5,{x:-1,y:97,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part17,5,{x:38,y:84,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part18,5,{x:56,y:41,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part19,5,{x:23,y:71,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part20,5,{x:-87,y:9,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part21,5,{x:-61,y:-27,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part22,5,{x:61,y:-24,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part23,5,{x:80,y:4,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part24,5,{x:50,y:-71,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part25,5,{x:-24,y:-69,alpha:0}),this.part26.visible=!1):41===this.counterAnim?this.part1.visible=!1:46===this.counterAnim&&(this.animComplete(),this.group.destroy())))},i.prototype.setParts=function(e){"anim"===e&&(this.part1.visible=!1,this.setPart(this.part2,{x:-5,y:-15,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:-17,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.part4.visible=!1,this.part5.visible=!1,this.part6.visible=!1,this.part7.visible=!1,this.part8.visible=!1,this.part9.visible=!1,this.part10.visible=!1,this.part11.visible=!1,this.part12.visible=!1,this.part13.visible=!1,this.part14.visible=!1,this.part15.visible=!1,this.part16.visible=!1,this.part17.visible=!1,this.part18.visible=!1,this.part19.visible=!1,this.part20.visible=!1,this.part21.visible=!1,this.part22.visible=!1,this.part23.visible=!1,this.part24.visible=!1,this.part25.visible=!1,this.part26.visible=!1,this.setPart(this.part27,{x:-2,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part28,{x:0,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.game=null,this.particle=[],this.particle=null,this.group=null,this.part29=null,this.part28=null,this.part27=null,this.part26=null,this.part25=null,this.part24=null,this.part23=null,this.part22=null,this.part21=null,this.part20=null,this.part19=null,this.part18=null,this.part17=null,this.part16=null,this.part15=null,this.part14=null,this.part13=null,this.part12=null,this.part11=null,this.part10=null,this.part9=null,this.part8=null,this.part7=null,this.part6=null,this.part5=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null,this.magicLightning1=null,this.magicLightning2=null,this.magicLightning3=null,this.magicLightning4=null},i}(e.BasicDragon);e.Lvl13CrystalBall=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.updateDragonBall=!1,s.explodeHeroCount=0,s.game=i,s.updateElements=new Array,s.group=i.make.group(),s.group.x=120,s.group.y=381,s.group.scale.x=-1,e.GameManager.instance.layerUpper.addChild(s.group),s.wheely=new e.SASprite(i,0,0,"dragon","carcorpus instance 10000"),s.wheely.pivot.set(69,57),s.wheely.visible=!1,s.group.addChild(s.wheely),s.fLeg1=new e.Lvl13DragonLegFront(i,1),s.group.addChild(s.fLeg1.group),s.updateElements.push(s.fLeg1),s.bLeg1=new e.Lvl13DragonLegBack(i,1),s.group.addChild(s.bLeg1.group),s.updateElements.push(s.bLeg1),s.tors=new e.Lvl13DragonTors(i),s.group.addChild(s.tors.group),s.updateElements.push(s.tors),s.fLeg2=new e.Lvl13DragonLegFront(i,2),s.group.addChild(s.fLeg2.group),s.updateElements.push(s.fLeg2),s.bLeg2=new e.Lvl13DragonLegBack(i,2),s.group.addChild(s.bLeg2.group),s.updateElements.push(s.bLeg2),s.sedlo=new e.SASprite(i,0,0,"dragon","dragonSeddle instance 10000"),s.sedlo.pivot.set(57,24),s.group.addChild(s.sedlo),s.mage=new e.Lvl13DragonMage(i),s.group.addChild(s.mage.group),s.updateElements.push(s.mage),s.wing=new e.Lvl13DragonWing(i),s.group.addChild(s.wing.group),s.updateElements.push(s.wing),s.setParts("shoot"),s.dragonBall=e.GameManager.instance.layerUpper.create(0,0,"level13"),s.dragonBall.anchor.setTo(.5),s.dragonBall.animations.add("anim",Phaser.Animation.generateFrameNames("dragonBall instance 1",0,17,"",4),30,!0),s.dragonBall.visible=!1,s.dragonBallExploading=e.GameManager.instance.layerUpper.create(0,0,"level13"),s.dragonBallExploading.scale.setTo(2),s.dragonBallExploading.anchor.setTo(.5),s.dragonBallExploading.animations.add("anim",Phaser.Animation.generateFrameNames("dragonExplosion instance 1",0,55,"",4),30,!1),s.dragonBallExploading.visible=!1,s.bodyDragonBall=new Phaser.Physics.Box2D.Body(i,null,-100,-100,1),s.bodyDragonBall.setCircle(14),s.bodyDragonBall.sensor=!0,s.bodyDragonBall.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,s.explodeHero,s),s}return __extends(i,t),i.prototype.goNormal=function(){e.SoundManager.playSFX("sfx_spellTransform");for(var t=0;t<this.updateElements.length;t++)this.updateElements[t].goNormal()},i.prototype.shootDragon=function(){this.playAnim("shoot"),this.bLeg1.playAnim("anim1"),this.bLeg2.playAnim("anim1"),this.fLeg1.playAnim("anim1"),this.fLeg2.playAnim("anim1"),this.tors.shoot(),this.wing.open()},i.prototype.endShootDragon=function(){this.bLeg1.playAnim("anim2"),this.bLeg2.playAnim("anim2"),this.fLeg1.playAnim("anim2"),this.fLeg2.playAnim("anim2"),this.wing.close()},i.prototype.shootMage=function(){this.mage.shoot()},i.prototype.dieMage=function(){this.goNormal(),this.playAnim("magDies"),this.tors.magDies(),this.mage.group.removeChild(this.mage.hat),this.mage.hatOffX=this.group.x+this.mage.group.x,this.mage.hatOffY=this.group.y+this.mage.group.y,e.GameManager.instance.layerUpper.addChildAt(this.mage.hat,e.GameManager.instance.layerUpper.getChildIndex(this.group)+1),this.mage.playAnim("magDies"),this.mage.hat.x=this.mage.hatOffX-38,this.mage.hat.y=this.mage.hatOffY+7,this.mage.setScepter(this.group.x,this.group.y)},i.prototype.flyAway=function(){this.tors.flyAway(),this.playAnim("sitHero"),this.wing.playAnim("anim3")},i.prototype.goDragonBall=function(){this.bodyDragonBall.x=280,this.bodyDragonBall.y=468,this.bodyDragonBall.velocity.x=180,this.updateDragonBall=!0,this.dragonBall.visible=!0,this.dragonBall.animations.play("anim")},i.prototype.update=function(){t.prototype.update.call(this);for(var i=0;i<this.updateElements.length;i++)this.updateElements[i].update();!0===this.updateDragonBall&&(this.dragonBall.x=this.bodyDragonBall.x,this.dragonBall.y=this.bodyDragonBall.y,this.dragonBall.angle=this.bodyDragonBall.angle,this.bodyDragonBall.x>850&&this.deactivateDragonBall()),1===this.explodeHeroCount&&(this.explodeHeroCount=2,e.GameManager.instance.layerUpper.setChildIndex(this.dragonBallExploading,e.GameManager.instance.layerUpper.children.length-1),this.dragonBallExploading.x=this.bodyDragonBall.x,this.dragonBallExploading.y=this.bodyDragonBall.y,this.dragonBallExploading.visible=!0,this.dragonBallExploading.animations.play("anim"),e.GameManager.instance.level.customAction(6),this.deactivateDragonBall())},i.prototype.deactivateDragonBall=function(){this.bodyDragonBall.x=-100,this.bodyDragonBall.y=-100,this.bodyDragonBall.velocity.x=0,this.bodyDragonBall.velocity.y=0,this.dragonBall.visible=!1,this.dragonBall.animations.stop("anim",!0)},i.prototype.explodeHero=function(){0===this.explodeHeroCount&&(this.explodeHeroCount=1)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"shoot"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing.group,9,{x:-23,y:27,skX:-33,skY:-33}),e.GameManager.instance.level.setSimpleTween(this.mage.group,9,{x:-39,y:-58,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.sedlo,9,{x:-17,y:14,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,19,{x:29,y:71}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,19,{x:-36,y:96}),this.setPart(this.tors.group,{x:41,y:-5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,19,{x:15,y:70}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,19,{x:-50,y:96})):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing.group,10,{x:-30,y:34,skX:-56,skY:-56}),e.GameManager.instance.level.setSimpleTween(this.mage.group,10,{x:-71,y:-41,skX:-38,skY:-38}),e.GameManager.instance.level.setSimpleTween(this.sedlo,10,{x:-29,y:21,skX:-39,skY:-39})):20===this.counterAnim?(this.setPart(this.bLeg2.group,{x:29,y:71,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg2.group,{x:-36,y:96,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bLeg1.group,{x:15,y:70,angle:0,scX:.89,scY:1.02,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg1.group,{x:-50,y:96,angle:0,scX:.95,scY:.95,skX:0,skY:0,alpha:1})):40===this.counterAnim?(this.goDragonBall(),e.SoundManager.playSFX("s_dragonFire")):60===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing.group,10,{x:-22,y:28,skX:-33,skY:-33}),e.GameManager.instance.level.setSimpleTween(this.mage.group,11,{x:-34,y:-58,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.sedlo,11,{x:-15,y:15,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,20,{x:21,y:78}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,19,{x:-48,y:85}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,20,{x:8,y:77}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,20,{x:-62,y:85}),this.endShootDragon()):70===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.wing.group,10,{x:-13,y:18,skX:-12,skY:-12}):71===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.mage.group,9,{x:5,y:-66,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.sedlo,9,{x:-1,y:9,skX:0,skY:0})):79===this.counterAnim?this.setPart(this.fLeg2.group,{x:-48,y:85,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):80===this.counterAnim?(this.setPart(this.bLeg2.group,{x:21,y:78,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg2.group,{x:-48,y:84,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bLeg1.group,{x:8,y:77,angle:0,scX:.89,scY:1.02,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg1.group,{x:-62,y:85,angle:0,scX:.95,scY:.95,skX:0,skY:0,alpha:1})):81===this.counterAnim&&this.animComplete():"magDies"===this.currAnim?62===this.counterAnim?this.mage.eated():73===this.counterAnim?this.group.setChildIndex(this.mage.group,this.group.getChildIndex(this.tors.group)):85===this.counterAnim&&this.animComplete():"sitHero"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing.group,15,{y:29,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.sedlo,14,{x:-5,y:20,skX:-8,skY:-8}),this.setPart(this.bLeg2.group,{x:21,y:78,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg2.group,{x:-48,y:84,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.tors.group,10,{x:30,y:-11,skX:-10,skY:-10}),this.setPart(this.bLeg1.group,{x:8,y:77,angle:0,scX:.89,scY:1.01,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg1.group,{x:-62,y:85,angle:0,scX:.95,scY:.95,skX:0,skY:0,alpha:1})):7===this.counterAnim?this.wing.playAnim("anim4"):12===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tors.group,3,{x:21,y:0}):16===this.counterAnim?(this.bLeg2.playAnim("anim3"),this.fLeg1.playAnim("anim3"),this.bLeg1.playAnim("anim4"),e.GameManager.instance.level.setSimpleTween(this.wing.group,7,{y:35,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.sedlo,20,{x:-6,y:30,skX:-9,skY:-9}),this.setPart(this.bLeg2.group,{x:22,y:77,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.tors.group,20,{x:17,y:11,skX:-15,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,20,{x:4,y:62,skX:-5,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,20,{y:89})):23===this.counterAnim?(this.wing.animCycle=!0,this.wing.playAnim("anim"),e.GameManager.instance.level.setSimpleTween(this.wing.group,13,{x:-15,y:38,skX:0,skY:0})):36===this.counterAnim?(this.fLeg2.setParts("anim4"),this.setPart(this.wing.group,{x:-15,y:38,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.hero.setVisibility(!1),this.wheely.visible=!0,this.setPart(this.wheely,{x:-18,y:61,angle:0,scX:1,scY:1,skX:0,skY:-180,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.wheely,11,{x:-17,y:-52,skX:3,skY:-177}),this.setPart(this.sedlo,{x:-6,y:30,angle:0,scX:1,scY:1,skX:-9,skY:-9,alpha:1}),this.setPart(this.bLeg2.group,{x:22,y:77,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg2.group,{x:-43,y:88,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.tors.group,35,{x:16,y:12}),this.setPart(this.bLeg1.group,{x:4,y:62,angle:0,scX:.8,scY:1.01,skX:-5,skY:-6,alpha:1}),this.setPart(this.fLeg1.group,{x:-62,y:89,angle:0,scX:.95,scY:.95,skX:0,skY:0,alpha:1})):47===this.counterAnim?(this.group.setChildIndex(this.wheely,this.group.getChildIndex(this.wing.group)-1),this.setPart(this.wheely,{x:-17,y:-52,angle:0,scX:1,scY:1,skX:3,skY:-177,alpha:1})):48===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.wheely,14,{x:-18,y:-16,skX:-7,skY:-187,scY:.93}):59===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.sedlo,3,{x:-5,skX:-13,skY:-13,scY:.93}):62===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wheely,5,{y:-24,scY:1}),e.GameManager.instance.level.setSimpleTween(this.sedlo,3,{x:-6,skX:-9,skY:-9,scY:1})):65===this.counterAnim?this.setPart(this.sedlo,{x:-6,y:30,angle:0,scX:1,scY:1,skX:-9,skY:-9,alpha:1}):67===this.counterAnim?this.setPart(this.wheely,{x:-18,y:-24,angle:0,scX:1,scY:1,skX:-7,skY:173,alpha:1}):71===this.counterAnim&&(this.animComplete(),this.playAnim("fly"),this.wing.allAnimRound=!0,this.wing.playAnim("anim"),this.fLeg1.playAnim("anim4"),this.fLeg2.playAnim("anim4"),this.bLeg1.playAnim("anim4"),this.bLeg2.playAnim("anim4")):"fly"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wheely,18,{x:-20,y:-27,skX:-11,skY:169}),e.GameManager.instance.level.setSimpleTween(this.sedlo,18,{x:-5,y:25,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,18,{x:25,y:67}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,18,{y:78}),e.GameManager.instance.level.setSimpleTween(this.tors.group,18,{x:4,y:16,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,18,{y:62})):19===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing.group,11,{x:-31,y:20}),e.GameManager.instance.level.setSimpleTween(this.wheely,11,{x:-36,y:-45,skX:-6,skY:174}),e.GameManager.instance.level.setSimpleTween(this.sedlo,11,{x:-26,y:9,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,11,{x:5}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,11,{x:-64,y:70,skX:-15,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.tors.group,11,{x:-11,y:5,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,11,{x:-6,y:67}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,11,{y:84})):22===this.counterAnim?(this.bLeg1.playAnim("anim5"),this.bLeg2.playAnim("anim5")):30===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing.group,12,{x:-124,y:-73}),e.GameManager.instance.level.setSimpleTween(this.wheely,12,{x:-122,y:-139,skX:5,skY:185}),e.GameManager.instance.level.setSimpleTween(this.sedlo,12,{x:-118,y:-84,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,12,{x:-78,y:-33,skX:-15,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,12,{x:-156,y:-7,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.tors.group,12,{x:-114,y:-96,skX:-43,skY:-43}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,12,{x:-84,y:-29}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,12,{x:-150,y:-2})):42===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing.group,10,{x:-200,y:-93}),e.GameManager.instance.level.setSimpleTween(this.wheely,10,{x:-210,y:-156,skX:-6,skY:-186}),e.GameManager.instance.level.setSimpleTween(this.sedlo,10,{x:-192,y:-107,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,10,{x:-145,y:-62,skX:-30,skY:-30}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,10,{x:-223,y:-20}),e.GameManager.instance.level.setSimpleTween(this.tors.group,10,{x:-197,y:-117,skX:-54,skY:-54}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,10,{x:-160,y:-52}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,10,{x:-213,y:-15})):52===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing.group,14,{x:-297,y:0}),e.GameManager.instance.level.setSimpleTween(this.wheely,14,{x:-323,y:-57,skX:-22,skY:158}),e.GameManager.instance.level.setSimpleTween(this.sedlo,14,{x:-295,y:-12,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,14,{x:-240,y:19,skX:-54,skY:-54}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,14,{x:-293,y:71,skX:-39,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.tors.group,14,{x:-293,y:-25,skX:-66,skY:-66}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,14,{x:-248,y:37,skX:-20,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,14,{x:-283,y:73,skX:-37,skY:-37})):66===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing.group,24,{x:-490,y:-78}),e.GameManager.instance.level.setSimpleTween(this.wheely,24,{x:-487,y:-144,skX:4,skY:179}),e.GameManager.instance.level.setSimpleTween(this.sedlo,24,{x:-480,y:-91,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,24,{x:-438,y:-42,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,24,{x:-511,y:-2,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.tors.group,24,{x:-475,y:-103,skX:-43,skY:-43}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,24,{x:-456,y:-34,skX:-15,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,24,{x:-491,y:-13,skX:-24,skY:-24})):90===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing.group,46,{x:-1013,y:269}),e.GameManager.instance.level.setSimpleTween(this.wheely,46,{x:-1028,y:204,skX:-21,skY:159}),e.GameManager.instance.level.setSimpleTween(this.sedlo,46,{x:-1010,y:256,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,46,{x:-954,y:308,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,46,{x:-1017,y:337,skX:-39,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.tors.group,46,{x:-995,y:249}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,46,{x:-951,y:300,skX:-13,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,46,{x:-1004,y:331,skX:-35,skY:-35})):110===this.counterAnim?e.SoundManager.playSFX("levelWin"):136===this.counterAnim&&(this.animComplete(),e.LevelBuilder.instance.levelComplete())))},i.prototype.setParts=function(e){"shoot"===e?(this.setPart(this.wing.group,{x:-13,y:18,angle:0,scX:1,scY:1,skX:-12,skY:-12,alpha:1}),this.setPart(this.mage.group,{x:5,y:-66,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.sedlo,{x:-1,y:9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bLeg2.group,{x:21,y:78,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg2.group,{x:-48,y:84,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tors.group,{x:41,y:-5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bLeg1.group,{x:8,y:77,angle:0,scX:.89,scY:1.02,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg1.group,{x:-62,y:85,angle:0,scX:.95,scY:.95,skX:0,skY:0,alpha:1})):"magDies"===e?(this.setPart(this.wing.group,{x:-13,y:18,angle:0,scX:1,scY:1,skX:-12,skY:-12,alpha:1}),this.setPart(this.mage.group,{x:5,y:-66,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.sedlo,{x:-1,y:9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bLeg2.group,{x:21,y:78,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg2.group,{x:-48,y:84,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tors.group,{x:41,y:-5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bLeg1.group,{x:8,y:77,angle:0,scX:.89,scY:1.02,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg1.group,{x:-62,y:85,angle:0,scX:.95,scY:.95,skX:0,skY:0,alpha:1})):"sitHero"===e?(this.setPart(this.wing.group,{x:-13,y:17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.wheely.visible=!1,this.setPart(this.sedlo,{x:-1,y:9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bLeg2.group,{x:21,y:78,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg2.group,{x:-48,y:84,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tors.group,{x:41,y:-5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bLeg1.group,{x:8,y:77,angle:0,scX:.89,scY:1.01,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg1.group,{x:-62,y:85,angle:0,scX:.95,scY:.95,skX:0,skY:0,alpha:1})):"fly"===e&&(this.setPart(this.wing.group,{x:-15,y:38,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.wheely,{x:-18,y:-24,angle:0,scX:1,scY:1,skX:-7,skY:173,alpha:1}),this.setPart(this.sedlo,{x:-6,y:30,angle:0,scX:1,scY:1,skX:-9,skY:-9,alpha:1}),this.setPart(this.bLeg2.group,{x:22,y:77,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.fLeg2.group,{x:-43,y:88,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tors.group,{x:16,y:12,angle:0,scX:1,scY:1,skX:-15,skY:-15,alpha:1}),this.setPart(this.bLeg1.group,{x:4,y:77,angle:0,scX:.8,scY:1.01,skX:-5,skY:-6,alpha:1}),this.setPart(this.fLeg1.group,{x:-62,y:89,angle:0,scX:.95,scY:.95,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.game=null,this.group=null;for(var e=0;e<this.updateElements.length;e++)this.updateElements[e].free();this.updateElements=[],this.updateElements=null,this.fLeg1=null,this.fLeg2=null,this.bLeg1=null,this.bLeg2=null,this.wing=null,this.sedlo=null,this.mage=null,this.tors=null,this.wheely=null,this.dragonBall=null,this.dragonBallExploading=null,this.bodyDragonBall=null},i}(e.BasicDragon);e.Lvl13Dragon=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.flame=new e.SASprite(i,0,0,"dragon","flame instance 10000"),s.flame.pivot.set(25,25),s.group.addChild(s.flame),s.tongue=new e.SASprite(i,0,0,"dragon","tongue instance 10000"),s.tongue.pivot.set(15,3),s.group.addChild(s.tongue),s.part1=new e.SASprite(i,0,0,"dragon","spike1 instance 10000"),s.part1.pivot.set(24,10),s.group.addChild(s.part1),s.part1_1=i.make.sprite(0,0,"dragon","spike1_1 instance 10000"),s.part1.addChild(s.part1_1),s.jawBot=new e.Lvl13DragonJawBot(i),s.group.addChild(s.jawBot.group),s.jawTop=new e.Lvl13DragonJawTop(i),s.group.addChild(s.jawTop.group),s.setParts("shoot"),s}return __extends(i,t),i.prototype.goNormal=function(){e.GameManager.instance.level.setSimpleTween(this.part1_1,this.goNormalTime,{alpha:0}),this.jawBot.goNormal(),this.jawTop.goNormal()},i.prototype.flyAway=function(){this.jawTop.flyAway()},i.prototype.update=function(){t.prototype.update.call(this),this.jawBot.update(),this.jawTop.update()},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"shoot"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.jawTop.group,2,{x:2,y:6,skX:7,skY:7}),e.GameManager.instance.level.setSimpleTween(this.jawBot.group,2,{x:-21,y:27,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.part1,14,{x:25,y:27,skX:37,skY:37}),this.setPart(this.tongue,{x:-16,y:13,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):3===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.jawTop.group,12,{x:7,y:5,skX:27,skY:27}),e.GameManager.instance.level.setSimpleTween(this.jawBot.group,12,{x:-14,y:33,skX:-15,skY:-15})):15===this.counterAnim?(this.setPart(this.jawTop.group,{x:7,y:5,angle:0,scX:1,scY:1,skX:27,skY:27,alpha:1}),this.setPart(this.jawBot.group,{x:-14,y:33,angle:0,scX:1,scY:1,skX:-15,skY:-15,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part1,7,{x:27,y:24,skX:23,skY:23}),e.GameManager.instance.level.setSimpleTween(this.tongue,13,{y:15,skX:-6,skY:-6}),this.flame.visible=!0,this.setPart(this.flame,{x:-17,y:13,angle:0,scX:.74,scY:.74,skX:0,skY:0,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.flame,22,{x:-20,y:8,scX:1,scY:1,alpha:1})):22===this.counterAnim?this.setPart(this.part1,{x:27,y:24,angle:0,scX:1,scY:1,skX:23,skY:23,alpha:1}):28===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tongue,9,{y:13,skX:0,skY:0}):37===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tongue,7,{y:15,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.flame,9,{alpha:0})):44===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tongue,6,{y:13,skX:0,skY:0}):46===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.jawTop.group,10,{x:1,y:7,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.jawBot.group,10,{x:-23,y:25,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part1,10,{x:26,y:18,skX:0,skY:0}),this.setPart(this.flame,{x:-20,y:8,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0})):50===this.counterAnim?this.setPart(this.tongue,{x:-16,y:13,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):56===this.counterAnim&&this.animComplete():"nom"===this.currAnim&&(51===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.jawTop.group,3,{x:2,y:6,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.jawBot.group,3,{x:-13,y:38,skX:-29,skY:-29}),e.GameManager.instance.level.setSimpleTween(this.part1,3,{x:25,y:21,skX:13,skY:13})):54===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.jawTop.group,6,{x:1,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.jawBot.group,6,{x:-21,y:29,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.part1,6,{y:20,skX:8,skY:8})):60===this.counterAnim?(this.setPart(this.jawTop.group,{x:1,y:6,angle:0,scX:1,scY:1,skX:10,skY:10,alpha:1}),this.setPart(this.jawBot.group,{x:-21,y:29,angle:0,scX:1,scY:1,skX:-7,skY:-7,alpha:1}),this.setPart(this.part1,{x:25,y:20,angle:0,scX:1,scY:1,skX:8,skY:8,alpha:1})):61===this.counterAnim?this.setPart(this.flame,{x:-20,y:8,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0}):63===this.counterAnim?this.setPart(this.tongue,{x:-16,y:19,angle:0,scX:1,scY:1,skX:-18,skY:-18,alpha:1}):65===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.jawTop.group,5,{x:4,y:5,skX:31,skY:31}),e.GameManager.instance.level.setSimpleTween(this.jawBot.group,5,{x:-11,y:39,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:23,y:25,skX:27,skY:27})):66===this.counterAnim?this.flame.visible=!1:68===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tongue,5,{y:14,skX:-3,skY:-3}):70===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.jawTop.group,7,{x:1,y:7,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.jawBot.group,7,{x:-23,y:25,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part1,7,{x:26,y:18,skX:0,skY:0})):73===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tongue,7,{y:13,skX:0,skY:0}):77===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"shoot"===e?(this.setPart(this.jawTop.group,{x:1,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.jawBot.group,{x:-23,y:25,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part1,{x:26,y:18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tongue,{x:-16,y:13,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.flame.visible=!1):"nom"===e&&(this.setPart(this.jawTop.group,{x:1,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.jawBot.group,{x:-23,y:25,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part1,{x:26,y:18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tongue,{x:-16,y:13,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.flame,{x:-20,y:8,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0}))},i.prototype.free=function(){this.group=null,this.flame=null,this.tongue=null,this.part1=null,this.part1_1=null,this.jawBot.group=null,this.jawTop.group=null},i}(e.BasicDragon);e.Lvl13DragonHead=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.part3=new e.SASprite(i,0,0,"dragon","crystalPart3 instance 10000"),s.part3.pivot.set(6,9),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"dragon","crystalPart2 instance 10000"),s.part2.pivot.set(6,8),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"dragon","crystalPart1 instance 10000"),s.part1.pivot.set(5,5),s.group.addChild(s.part1),s.blick3=new e.SASprite(i,0,0,"dragon","crystalBlick3 instance 10000"),s.blick3.pivot.set(17,18),s.group.addChild(s.blick3),s.blick2=new e.SASprite(i,0,0,"dragon","crystalBlick2 instance 10000"),s.blick2.pivot.set(55,64),s.group.addChild(s.blick2),s.blick=new e.SASprite(i,0,0,"dragon","crystalBlick instance 10000"),s.group.addChild(s.blick),s.setParts("anim"),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(this.setPart(this.blick,{x:-31,y:-31,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.blick2,14,{x:14,y:-1,scX:1,scY:1,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.blick3,14,{y:-15,scX:2.05,scY:2.05,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part1,14,{x:3,y:-23,scX:1.55,scY:1.55}),e.GameManager.instance.level.setSimpleTween(this.part2,14,{x:8,y:-11,skX:9,skY:9}),e.GameManager.instance.level.setSimpleTween(this.part3,14,{y:-9,skX:-3,skY:-3})):2===this.counterAnim?this.blick.visible=!1:15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.blick2,11,{x:24,y:7,scX:2,scY:2,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.blick3,11,{scX:3,scY:3,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part1,11,{y:-50,scX:.88,scY:.88,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part2,11,{x:32,y:-20,skX:59,skY:59,scX:.55,scY:.55,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part3,11,{x:-21,y:-15,skX:-33,skY:-33,scX:.56,scY:.56,alpha:0})):26===this.counterAnim&&(this.animComplete(),this.group.destroy())))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.blick,{x:-31,y:-31,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.blick2,{x:4,y:4,angle:0,scX:.44,scY:.44,skX:0,skY:0,alpha:0}),this.setPart(this.blick3,{x:1,y:-3,angle:0,scX:.85,scY:.85,skX:0,skY:0,alpha:0}),this.setPart(this.part1,{x:0,y:-5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:3,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:-1,y:4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part3=null,this.part2=null,this.part1=null,this.blick3=null,this.blick2=null,this.blick=null},i}(e.BasicSimpleAnim);e.Lvl13DragonHeadCrystal=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.part3=new e.SASprite(i,0,0,"dragon","botJawPart1_3 instance 10000"),s.part3.pivot.set(6,13),s.group.addChild(s.part3),s.part3_1=i.make.sprite(0,0,"dragon","botJawPart1_3_1 instance 10000"),s.part3.addChild(s.part3_1),s.part2=new e.SASprite(i,0,0,"dragon","botJawPart1_2 instance 10000"),s.part2.pivot.set(9,18),s.group.addChild(s.part2),s.part2_1=i.make.sprite(0,0,"dragon","botJawPart1_2_1 instance 10000"),s.part2.addChild(s.part2_1),s.part1=new e.SASprite(i,0,0,"dragon","botJawPart1_1 instance 10000"),s.part1.pivot.set(28,17),s.group.addChild(s.part1),s.part1_1=i.make.sprite(0,0,"dragon","botJawPart1_1_1 instance 10000"),s.part1.addChild(s.part1_1),s.setParts("normal"),s}return __extends(i,t),i.prototype.goNormal=function(){this.playAnim("normal")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"normal"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,20,{x:11,y:9}),e.GameManager.instance.level.setSimpleTween(this.part3,20,{x:-14,y:9}),e.GameManager.instance.level.setSimpleTween(this.part1_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part2_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part3_1,this.goNormalTime,{alpha:0})):21===this.counterAnim?(this.part1_1.destroy(),this.part2_1.destroy(),this.part3_1.destroy()):22===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"normal"===e&&(this.setPart(this.part1,{x:5,y:-7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:13,y:15,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:-13,y:14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part3=null,this.part2=null,this.part1=null,this.part1_1=null,this.part2_1=null,this.part3_1=null},i}(e.BasicDragon);e.Lvl13DragonJawBot=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.crystal=new e.Lvl13DragonHeadCrystal(i),s.crystal.group.x=-2,s.crystal.group.y=-25,s.group.addChild(s.crystal.group),s.part6=new e.SASprite(i,0,0,"dragon","botJawPart2_6 instance 10000"),s.part6.pivot.set(14,13),s.group.addChild(s.part6),s.part6_1=i.make.sprite(0,0,"dragon","botJawPart2_6_1 instance 10000"),s.part6.addChild(s.part6_1),s.part5=new e.SASprite(i,0,0,"dragon","botJawPart2_5 instance 10000"),s.part5.pivot.set(10,5),s.group.addChild(s.part5),s.part5_1=i.make.sprite(0,0,"dragon","botJawPart2_5_1 instance 10000"),s.part5.addChild(s.part5_1),s.part4=new e.SASprite(i,0,0,"dragon","botJawPart2_4 instance 10000"),s.part4.pivot.set(8,8),s.group.addChild(s.part4),s.part4_1=i.make.sprite(0,0,"dragon","botJawPart2_4_1 instance 10000"),s.part4.addChild(s.part4_1),s.part3=new e.SASprite(i,0,0,"dragon","botJawPart2_3 instance 10000"),s.part3.pivot.set(6,11),s.group.addChild(s.part3),s.part3_1=i.make.sprite(0,0,"dragon","botJawPart2_3_1 instance 10000"),s.part3.addChild(s.part3_1),s.part2=new e.SASprite(i,0,0,"dragon","botJawPart2_2 instance 10000"),s.part2.pivot.set(10,6),s.group.addChild(s.part2),s.part2_1=i.make.sprite(0,0,"dragon","botJawPart2_2_1 instance 10000"),s.part2.addChild(s.part2_1),s.part1=new e.SASprite(i,0,0,"dragon","botJawPart2_1 instance 10000"),s.part1.pivot.set(41,25),s.group.addChild(s.part1),s.part1_1=i.make.sprite(0,0,"dragon","botJawPart2_1_1 instance 10000"),s.part1.addChild(s.part1_1),s.eye=i.make.sprite(36,-5,"dragon"),s.eye.animations.add("anim",Phaser.Animation.generateFrameNames("dragonEye instance 1",0,0,"",4),30,!1),s.eye.animations.add("anim2",Phaser.Animation.generateFrameNames("dragonEye instance 1",1,84,"",4),30,!0),s.eye.animations.add("normal",Phaser.Animation.generateFrameNames("dragonEye instance 1",85,105,"",4),30,!1),s.eye.animations.add("anim3",Phaser.Animation.generateFrameNames("dragonEye instance 1",106,190,"",4),30,!0),s.eye.animations.play("anim2"),s.part1.addChild(s.eye),s.part7_1=i.make.sprite(52,45,"dragon","botJawPart2_7_1 instance 10000"),s.part1.addChild(s.part7_1),s.setParts("normal"),s}return __extends(i,t),i.prototype.goNormal=function(){this.playAnim("normal"),this.eye.animations.play("normal"),this.crystal.playAnim("anim")},i.prototype.flyAway=function(){this.eye.animations.play("anim3")},i.prototype.update=function(){t.prototype.update.call(this),this.crystal.update()},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"normal"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,20,{x:29,skX:7,skY:7}),e.GameManager.instance.level.setSimpleTween(this.part3,20,{x:-40,y:-12,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.part4,20,{x:-16,y:-25,skX:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part5,20,{x:10,y:-23}),e.GameManager.instance.level.setSimpleTween(this.part6,20,{x:27,y:-16,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.part1_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part2_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part3_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part4_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part5_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part6_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part7_1,this.goNormalTime,{alpha:0})):21===this.counterAnim?(this.part1_1.destroy(),this.part2_1.destroy(),this.part3_1.destroy(),this.part4_1.destroy(),this.part5_1.destroy(),this.part6_1.destroy(),this.part7_1.destroy()):22===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"normal"===e&&(this.setPart(this.part1,{x:-9,y:3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:36,y:1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:-41,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:-15,y:-26,angle:0,scX:1,scY:1.34,skX:6,skY:0,alpha:1}),this.setPart(this.part5,{x:12,y:-29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part6,{x:36,y:-21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part6=null,this.part5=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null,this.part1_1=null,this.part2_1=null,this.part3_1=null,this.part4_1=null,this.part5_1=null,this.part6_1=null,this.part7_1=null,this.eye=null,this.crystal.free(),this.crystal=null},i}(e.BasicDragon);e.Lvl13DragonJawTop=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this,i)||this;return a.group=new e.SAGroup(i,0,0),a.part4=new e.SASprite(i,0,0,"dragon","bLeg1 instance 10000"),a.part4.pivot.set(26,36),a.group.addChild(a.part4),a.part4_1=i.make.sprite(0,0,"dragon","bLeg"+s+"_1 instance 10000"),a.part4.addChild(a.part4_1),a.part3=new e.SASprite(i,0,0,"dragon","bLeg2 instance 10000"),a.part3.pivot.set(8,13),a.group.addChild(a.part3),a.part3_1=i.make.sprite(0,0,"dragon","bLeg"+s+"_2 instance 10000"),a.part3.addChild(a.part3_1),a.part2=new e.SASprite(i,0,0,"dragon","bLeg3 instance 10000"),a.part2.pivot.set(18,21),a.group.addChild(a.part2),a.part2_1=i.make.sprite(0,0,"dragon","bLeg"+s+"_3 instance 10000"),a.part2.addChild(a.part2_1),a.part1=new e.SASprite(i,0,0,"dragon","bLeg4 instance 10000"),a.part1.pivot.set(20,11),a.group.addChild(a.part1),a.part1_1=i.make.sprite(0,0,"dragon","bLeg"+s+"_4 instance 10000"),a.part1.addChild(a.part1_1),a.setParts("anim1"),a}return __extends(i,t),i.prototype.goNormal=function(){e.GameManager.instance.level.setSimpleTween(this.part1_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part2_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part3_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part4_1,this.goNormalTime,{alpha:0})},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim1"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,19,{x:10,y:48}),e.GameManager.instance.level.setSimpleTween(this.part2,19,{x:24,y:27,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.part3,19,{y:13,skX:-37,skY:-37}),e.GameManager.instance.level.setSimpleTween(this.part4,19,{x:1,skX:-64,skY:-64})):20===this.counterAnim&&this.animComplete():"anim2"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,20,{x:19,y:42}),e.GameManager.instance.level.setSimpleTween(this.part2,20,{x:27,y:21,skX:-37,skY:-37}),e.GameManager.instance.level.setSimpleTween(this.part3,20,{y:11,skX:-46,skY:-46}),e.GameManager.instance.level.setSimpleTween(this.part4,20,{x:0,skX:-62,skY:-62})):21===this.counterAnim&&this.animComplete():"anim3"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,16,{x:30,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.part3,16,{x:12,y:15,skX:-66,skY:-66}),e.GameManager.instance.level.setSimpleTween(this.part4,16,{x:2,y:3})):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:-1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:15,skX:-15,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-1,y:12}),e.GameManager.instance.level.setSimpleTween(this.part4,4,{x:-6,y:-3,skX:-56,skY:-56})):21===this.counterAnim&&this.animComplete():"anim4"===this.currAnim?2===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,18,{x:-11,y:55}),e.GameManager.instance.level.setSimpleTween(this.part2,18,{x:8,y:36,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.part3,18,{x:-10,y:22,skX:-39,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.part4,18,{x:-9,y:9,skX:-46,skY:-46})):20===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,2,{x:-3,y:57,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,2,{x:14,y:37,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.part3,2,{x:-6,y:23}),e.GameManager.instance.level.setSimpleTween(this.part4,2,{x:-6,skX:-51,skY:-51})):22===this.counterAnim&&this.animComplete():"anim5"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,3,{x:10,y:59,skX:2,skY:2}),e.GameManager.instance.level.setSimpleTween(this.part2,9,{x:39,y:35,skX:-53,skY:-53}),e.GameManager.instance.level.setSimpleTween(this.part3,9,{x:11,y:25,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.part4,9,{x:6,y:7,skX:-73,skY:-73})):4===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:36,y:52,skX:5,skY:5}):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:-1,y:81,skX:-43,skY:-43}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:10,y:51,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-8,y:29,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.part4,12,{x:-17,skX:-31,skY:-31})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:-35,y:82,skX:-91,skY:-91}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:-23,y:53,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-28,y:25,skX:14,skY:14})):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,11,{x:-42,y:70}),e.GameManager.instance.level.setSimpleTween(this.part2,24,{x:-30,y:32,skX:48,skY:48}),e.GameManager.instance.level.setSimpleTween(this.part3,24,{x:-35,y:12,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.part4,24,{x:-27,y:1,skX:-11,skY:-11})):33===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,13,{x:-49,y:52,skX:-92,skY:-92}):46===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,11,{x:-44,y:67,skX:-91,skY:-91}),e.GameManager.instance.level.setSimpleTween(this.part2,24,{x:-23,y:53,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.part3,24,{x:-28,y:25,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.part4,24,{x:-17,y:7,skX:-31,skY:-31})):57===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,13,{x:-35,y:82}):86===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim1"===e?(this.setPart(this.part1,{x:19,y:42,angle:0,scX:.99,scY:.99,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:27,y:21,angle:0,scX:.99,scY:.99,skX:-37,skY:-37,alpha:1}),this.setPart(this.part3,{x:3,y:11,angle:0,scX:.99,scY:.99,skX:-46,skY:-46,alpha:1}),this.setPart(this.part4,{x:0,y:-5,angle:0,scX:.99,scY:.99,skX:-62,skY:-62,alpha:1})):"anim2"===e?(this.setPart(this.part1,{x:10,y:48,angle:0,scX:.99,scY:.99,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:24,y:27,angle:0,scX:.99,scY:.99,skX:-20,skY:-20,alpha:1}),this.setPart(this.part3,{x:3,y:13,angle:0,scX:.99,scY:.99,skX:-37,skY:-37,alpha:1}),this.setPart(this.part4,{x:1,y:-5,angle:0,scX:.99,scY:.99,skX:-64,skY:-64,alpha:1})):"anim3"===e?(this.setPart(this.part1,{x:19,y:42,angle:0,scX:.99,scY:.99,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:27,y:21,angle:0,scX:.99,scY:.99,skX:-37,skY:-37,alpha:1}),this.setPart(this.part3,{x:3,y:11,angle:0,scX:.99,scY:.99,skX:-46,skY:-46,alpha:1}),this.setPart(this.part4,{x:0,y:-5,angle:0,scX:.99,scY:.99,skX:-62,skY:-62,alpha:1})):"anim4"===e?(this.setPart(this.part1,{x:-1,y:42,angle:0,scX:.99,scY:.99,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:15,y:21,angle:0,scX:.99,scY:.99,skX:-15,skY:-15,alpha:1}),this.setPart(this.part3,{x:-1,y:12,angle:0,scX:.99,scY:.99,skX:-66,skY:-66,alpha:1}),this.setPart(this.part4,{x:-6,y:-3,angle:0,scX:.99,scY:.99,skX:-56,skY:-56,alpha:1})):"anim5"===e&&(this.setPart(this.part1,{x:-3,y:57,angle:0,scX:.99,scY:.99,skX:1,skY:1,alpha:1}),this.setPart(this.part2,{x:14,y:37,angle:0,scX:.99,scY:.99,skX:-13,skY:-13,alpha:1}),this.setPart(this.part3,{x:-6,y:23,angle:0,scX:.99,scY:.99,skX:-39,skY:-39,alpha:1}),this.setPart(this.part4,{x:-6,y:9,angle:0,scX:.99,scY:.99,skX:-51,skY:-51,alpha:1}))},i.prototype.free=function(){this.group=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null,this.part1_1=null,this.part2_1=null,this.part3_1=null,this.part4_1=null},i}(e.BasicDragon);e.Lvl13DragonLegBack=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this,i)||this;return a.group=new e.SAGroup(i,0,0),a.part3=new e.SASprite(i,0,0,"dragon","fLeg3 instance 10000"),a.part3.pivot.set(21,19),a.group.addChild(a.part3),a.part3_1=i.make.sprite(0,0,"dragon","fLeg"+s+"_3 instance 10000"),a.part3.addChild(a.part3_1),a.part2=new e.SASprite(i,0,0,"dragon","fLeg2 instance 10000"),a.part2.pivot.set(16,8),a.group.addChild(a.part2),a.part2_1=i.make.sprite(0,0,"dragon","fLeg"+s+"_2 instance 10000"),a.part2.addChild(a.part2_1),a.part1=new e.SASprite(i,0,0,"dragon","fLeg1 instance 10000"),a.part1.pivot.set(15,29),a.group.addChild(a.part1),a.part1_1=i.make.sprite(0,0,"dragon","fLeg"+s+"_1 instance 10000"),a.part1.addChild(a.part1_1),a.setParts("anim1"),a}return __extends(i,t),i.prototype.goNormal=function(){e.GameManager.instance.level.setSimpleTween(this.part1_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part2_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part3_1,this.goNormalTime,{alpha:0})},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim1"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,19,{x:8,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.part2,19,{x:-26,y:29,skX:-1,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.part3,19,{x:5,y:10,skX:24,skY:24})):20===this.counterAnim&&this.animComplete():"anim2"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,20,{x:9,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.part2,20,{x:-15,y:41,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part3,20,{x:10,y:14,skX:4,skY:4})):21===this.counterAnim&&this.animComplete():"anim3"===this.currAnim?1===this.counterAnim?(this.setPart(this.part1,{x:9,y:-14,angle:0,scX:.99,scY:.99,skX:-11,skY:-11,alpha:1}),this.setPart(this.part2,{x:-15,y:41,angle:0,scX:.99,scY:.99,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:10,y:14,angle:0,scX:.99,scY:.99,skX:4,skY:4,alpha:1})):2===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,13,{x:13,y:-16,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.part2,13,{x:-15,y:29}),e.GameManager.instance.level.setSimpleTween(this.part3,13,{x:14,y:7,skX:17,skY:17})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:11,y:-15,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.part2,5,{x:-16,y:33}),e.GameManager.instance.level.setSimpleTween(this.part3,5,{x:11,y:10,skX:13,skY:13})):20===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,2,{x:10,y:-14,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.part2,2,{x:-15,y:37,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.part3,2,{x:10,y:12,skX:8,skY:8})):22===this.counterAnim&&this.animComplete():"anim4"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,9,{x:4,y:-13,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,9,{x:-9,y:54,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.part3,9,{x:5,y:23,skX:-17,skY:-17})):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,12,{x:-7,skX:27,skY:27}),e.GameManager.instance.level.setSimpleTween(this.part2,12,{x:-47,y:40,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.part3,12,{x:-23,y:15,skX:20,skY:20})):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,24,{x:-5,skX:24,skY:24}),e.GameManager.instance.level.setSimpleTween(this.part2,24,{x:-49,y:14,skX:-69,skY:-69}),e.GameManager.instance.level.setSimpleTween(this.part3,24,{x:-21,y:5,skX:55,skY:55})):46===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,22,{x:-7,skX:27,skY:27}),e.GameManager.instance.level.setSimpleTween(this.part2,22,{x:-47,y:40,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.part3,22,{x:-23,y:15,skX:20,skY:20})):101===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim1"===e?(this.setPart(this.part1,{x:9,y:-14,angle:0,scX:.99,scY:.99,skX:-11,skY:-11,alpha:1}),this.setPart(this.part2,{x:-15,y:41,angle:0,scX:.99,scY:.99,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:10,y:14,angle:0,scX:.99,scY:.99,skX:4,skY:4,alpha:1})):"anim2"===e?(this.setPart(this.part1,{x:8,y:-14,angle:0,scX:.99,scY:.99,skX:-8,skY:-8,alpha:1}),this.setPart(this.part2,{x:-26,y:29,angle:0,scX:.99,scY:.99,skX:-1,skY:-1,alpha:1}),this.setPart(this.part3,{x:5,y:10,angle:0,scX:.99,scY:.99,skX:24,skY:24,alpha:1})):"anim3"===e?(this.setPart(this.part1,{x:9,y:-14,angle:0,scX:.99,scY:.99,skX:-11,skY:-11,alpha:1}),this.setPart(this.part2,{x:-15,y:41,angle:0,scX:.99,scY:.99,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:10,y:14,angle:0,scX:.99,scY:.99,skX:4,skY:4,alpha:1})):"anim4"===e&&(this.setPart(this.part1,{x:10,y:-14,angle:0,scX:.99,scY:.99,skX:-13,skY:-13,alpha:1}),this.setPart(this.part2,{x:-15,y:37,angle:0,scX:.99,scY:.99,skX:-2,skY:-2,alpha:1}),this.setPart(this.part3,{x:10,y:12,angle:0,scX:.99,scY:.99,skX:8,skY:8,alpha:1}))},i.prototype.free=function(){this.group=null,this.part3=null,this.part2=null,this.part1=null,this.part1_1=null,this.part2_1=null,this.part3_1=null},i}(e.BasicDragon);e.Lvl13DragonLegFront=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;s.updateFireBall=!1,s.magDied=!1,s.explodeHeroCount=0,s.game=i,s.group=new e.SAGroup(i,0,0),s.base=new e.SASprite(i,0,0,"dragon","dragonMageBase instance 10000"),s.base.pivot.set(55,33),s.group.addChild(s.base),s.eyes=new e.SASprite(i,0,0,"dragon","dragonMageEyes instance 10000"),s.eyes.pivot.set(14,24),s.eyes.animations.add("anim",Phaser.Animation.generateFrameNames("dragonMageEyes instance 1",0,107,"",4),30,!0),s.eyes.animations.add("eated",Phaser.Animation.generateFrameNames("dragonMageEyes instance 1",108,117,"",4),30,!1),s.eyes.animations.play("anim"),s.group.addChild(s.eyes),s.hat=new e.SASprite(i,0,0,"dragon","dragonMageHat instance 10000"),s.hat.pivot.set(23,87),s.group.addChild(s.hat),s.scepter=new e.SASprite(i,0,0,"dragon","dragonMageScepter instance 10000"),s.scepter.pivot.set(22,59),s.group.addChild(s.scepter),s.brown=new e.SASprite(i,0,0,"dragon","dragonMageBrown instance 10000"),s.brown.pivot.set(12,24),s.brown.animations.add("anim",Phaser.Animation.generateFrameNames("dragonMageBrown instance 1",0,107,"",4),30,!0),s.brown.animations.play("anim"),s.group.addChild(s.brown),s.cast=new e.SASprite(i,28,28,"dragon","mageCast instance 10000"),s.cast.pivot.set(38,38),s.cast.animations.add("anim",Phaser.Animation.generateFrameNames("mageCast instance 1",0,22,"",4),30,!1).onComplete.add(s.goMagBall,s),s.cast.animations.add("anim2",Phaser.Animation.generateFrameNames("mageCast instance 1",23,44,"",4),30,!1),s.scepter.addChild(s.cast),s.cast.visible=!1,s.fireBall=e.GameManager.instance.layerUpper.create(0,0,"level13"),s.fireBall.anchor.setTo(.6,.5),s.fireBall.animations.add("anim",Phaser.Animation.generateFrameNames("magBall instance 1",0,7,"",4),30,!0),s.fireBall.visible=!1;for(var a,n=0,o=0;o<6;o++)(a=i.make.sprite(0,26*Math.random()-13,"level13")).anchor.y=.5,a.pivot.x=-10,a.animations.add("anim",Phaser.Animation.generateFrameNames("magicPinkPart instance 1",0,29,"",4),e.Tools.random(50,80),!1).onComplete.add(function(e,t){e.y=26*Math.random()-13,e.scale.setTo(.5+.5*Math.random()),e.animations.play("anim")},s),a.animations.play("anim"),a.animations.currentAnim.frame=n,a.angle=180,a.scale.setTo(.5+.5*Math.random()),s.fireBall.addChild(a),n+=5;a=null,s.bodyFireBall=new Phaser.Physics.Box2D.Body(i,null,-100,-100,1),s.bodyFireBall.setCircle(14),s.bodyFireBall.sensor=!0,s.bodyFireBall.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,s.explodeHero,s),s.fireBallExploading=e.GameManager.instance.layerUpper.create(0,0,"level13"),s.fireBallExploading.anchor.setTo(.5),s.fireBallExploading.animations.add("anim",Phaser.Animation.generateFrameNames("magicExplosion instance 1",0,30,"",4),30,!1),s.fireBallExploading.visible=!1,s.bodyQuestCar=new Phaser.Physics.Box2D.Body(i,null,355,248,2),s.bodyQuestCar.setCircle(25),s.bodyQuestCar.sensor=!0;var r=new Phaser.Physics.Box2D.Body(i,null,355,248,0);return r.setRectangle(4,4),r.sensor=!0,i.physics.box2d.revoluteJoint(s.bodyQuestCar,r),r=null,s.bodyFireBall.setBodyContactCallback(s.bodyQuestCar,s.explodeHero,s),s.setParts("magDies"),s}return __extends(i,t),i.prototype.setScepter=function(t,i){this.group.removeChild(this.scepter),this.scepter.x=t+this.group.x+this.scepter.x-47,this.scepter.y=i+this.group.y+this.scepter.y,this.scepter.skX=0,this.scepter.skY=0,this.scepter.scale.x=-1,this.scepter.pivot.set(0,0),e.GameManager.instance.layerUpper.addChildAt(this.scepter,e.GameManager.instance.layerUpper.getChildIndex(this.hat)+1),this.game.physics.box2d.enable(this.scepter,!1),this.scepter.body.setRectangle(18,100,0,0,e.Tools.toRad(-20)),this.scepter.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.scepter.body.angle=-8,this.scepter.inputEnabled=!0,this.scepter.input.useHandCursor=!0,this.scepter.events.onInputOut.add(this.scepterOut,this),this.scepter.events.onInputOver.add(this.scepterOver,this),this.scepter.events.onInputDown.add(this.scepterDown,this),this.cast.x=8,this.cast.y=-34},i.prototype.scepterOut=function(){!0===this.scepter.inputEnabled&&(this.scepter.frameName="dragonMageScepter instance 10000")},i.prototype.scepterOver=function(){!0===this.scepter.inputEnabled&&(this.scepter.frameName="dragonMageScepter instance 10001")},i.prototype.scepterDown=function(){this.scepter.inputEnabled=!1,this.scepter.frameName="dragonMageScepter instance 10002",this.shoot(),e.SoundManager.playSFX("s_enemymagAttack")},i.prototype.explodeHero=function(){0===this.explodeHeroCount&&(this.explodeHeroCount=1)},i.prototype.explodeComp=function(){!1===this.magDied?e.GameManager.instance.level.customAction(4):e.GameManager.instance.level.customAction(5)},i.prototype.shoot=function(){this.cast.visible=!0,this.cast.animations.play("anim")},i.prototype.goMagBall=function(){if(this.cast.animations.play("anim2"),this.updateFireBall=!0,!1===this.magDied)this.bodyFireBall.x=90,this.bodyFireBall.y=295,this.bodyFireBall.velocity.x=180,this.bodyFireBall.velocity.y=12,this.bodyFireBall.angle=15;else{this.bodyFireBall.x=this.scepter.body.x-30,this.bodyFireBall.y=this.scepter.body.y,this.bodyFireBall.angle=e.Tools.toDeg(e.Tools.angleOfPoints(this.bodyQuestCar.x,this.bodyQuestCar.y,this.scepter.body.x,this.scepter.body.y))-180;var t=this.bodyQuestCar.data.GetPosition();t.SelfSub(this.bodyFireBall.data.GetPosition()),t.SelfMul(.8),this.bodyFireBall.data.SetLinearVelocity(t)}this.fireBall.visible=!0,this.fireBall.animations.play("anim")},i.prototype.update=function(){t.prototype.update.call(this),!0===this.updateFireBall&&(this.fireBall.x=this.bodyFireBall.x,this.fireBall.y=this.bodyFireBall.y,this.fireBall.angle=this.bodyFireBall.angle,this.bodyFireBall.x>850&&this.deactivateFireBall()),1===this.explodeHeroCount&&(this.explodeHeroCount=2,this.fireBallExploading.x=this.bodyFireBall.x,this.fireBallExploading.y=this.bodyFireBall.y,this.fireBallExploading.visible=!0,this.fireBallExploading.animations.play("anim"),this.explodeComp(),this.deactivateFireBall())},i.prototype.deactivateFireBall=function(){this.bodyFireBall.x=-100,this.bodyFireBall.y=-100,this.bodyFireBall.velocity.x=0,this.bodyFireBall.velocity.y=0,this.updateFireBall=!1,this.fireBall.visible=!1,this.fireBall.animations.stop("anim",!0)},i.prototype.eated=function(){this.playAnim("eated"),this.eyes.animations.play("eated")},i.prototype.onAnimComplete=function(){"eated"===this.currAnim&&(this.brown.visible=!1,this.eyes.visible=!1,this.base.visible=!1)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"magDies"===this.currAnim?2===this.counterAnim?(this.magDied=!0,this.cast.visible=!1,this.cast.animations.stop("anim",!0),e.GameManager.instance.level.setSimpleTween(this.brown,8,{x:-103,y:-13,skX:-60,skY:-60}),e.GameManager.instance.level.setSimpleTween(this.hat,6,{x:this.hatOffX-22,y:this.hatOffY-59,skX:15,skY:15}),e.GameManager.instance.level.setSimpleTween(this.eyes,8,{x:-105,y:-11,skX:-47,skY:-47,scX:.59,scY:.59}),e.GameManager.instance.level.setSimpleTween(this.base,8,{x:-89,y:-22,skX:-54,skY:-54,scX:.55,scY:.55})):8===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.hat,17,{x:this.hatOffX-28,y:this.hatOffY+203,skX:5,skY:5}):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brown,7,{x:-138,y:100,skX:-129,skY:-129}),e.GameManager.instance.level.setSimpleTween(this.eyes,7,{x:-138,y:103,skX:-120,skY:-120,scX:.6}),e.GameManager.instance.level.setSimpleTween(this.base,7,{x:-142,y:84,skX:-121,skY:-121})):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brown,4,{x:-137,y:175,skX:-149,skY:-149}),e.GameManager.instance.level.setSimpleTween(this.eyes,4,{y:175,skX:-154,skY:-154}),e.GameManager.instance.level.setSimpleTween(this.base,4,{x:-151,y:162,skX:-154,skY:-154})):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brown,4,{x:-141,y:184,skX:-181,skY:-181}),e.GameManager.instance.level.setSimpleTween(this.eyes,4,{x:-142,y:185,skX:-186,skY:-186}),e.GameManager.instance.level.setSimpleTween(this.base,4,{x:-160,y:180,skX:-186,skY:-186})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brown,5,{x:-145,y:185,scX:.81,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.eyes,5,{x:-148,skX:171,skY:171}),e.GameManager.instance.level.setSimpleTween(this.base,5,{x:-167,y:181,skX:171,skY:171})):30===this.counterAnim?this.setPart(this.eyes,{x:-148,y:185,angle:0,scX:.6,scY:.59,skX:171,skY:171,alpha:1}):31===this.counterAnim&&this.animComplete():"eated"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brown,3,{x:-176,y:99,skX:165,skY:165}),e.GameManager.instance.level.setSimpleTween(this.eyes,3,{x:-176,y:99,skX:163,skY:156}),e.GameManager.instance.level.setSimpleTween(this.base,3,{x:-195,y:97,skX:161,skY:161})):4===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brown,3,{x:-163,y:13,skX:-165,skY:-165,scX:.7,scY:.7}),e.GameManager.instance.level.setSimpleTween(this.eyes,3,{x:-163,y:12,skX:-167,skY:-174}),e.GameManager.instance.level.setSimpleTween(this.base,3,{x:-175,y:0,skX:-165,skY:-165})):7===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brown,6,{x:-157,y:-76,skX:-120,skY:-120}),e.GameManager.instance.level.setSimpleTween(this.eyes,6,{x:-155,y:-77,skX:-122,skY:-129}),e.GameManager.instance.level.setSimpleTween(this.base,6,{x:-155,y:-94,skX:-121,skY:-121})):13===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brown,6,{x:-113,y:2,skX:-135,skY:-135,scX:.49,scY:.49}),e.GameManager.instance.level.setSimpleTween(this.eyes,6,{x:-112,y:2,scX:.44,scY:.44}),e.GameManager.instance.level.setSimpleTween(this.base,6,{x:-115,y:-10,skX:-132,skY:-132,scX:.36,scY:.36})):19===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brown,2,{x:-98,y:19,skX:-141,skY:-141}),e.GameManager.instance.level.setSimpleTween(this.eyes,2,{x:-97,y:18,skX:-137,skY:-144}),e.GameManager.instance.level.setSimpleTween(this.base,2,{x:-102,y:9,skX:-151,skY:-151})):22===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"magDies"===e?(this.setPart(this.brown,{x:-44,y:9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.scepter,{x:18,y:5,angle:0,scX:1,scY:1,skX:8,skY:8,alpha:1}),this.setPart(this.hat,{x:-38,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eyes,{x:-43,y:13,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.base,{x:-17,y:24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"eated"===e&&(this.setPart(this.brown,{x:-145,y:180,angle:0,scX:.81,scY:.81,skX:180,skY:180,alpha:1}),this.setPart(this.eyes,{x:-148,y:180,angle:0,scX:.6,scY:.59,skX:178,skY:171,alpha:1}),this.setPart(this.base,{x:-167,y:176,angle:0,scX:.55,scY:.55,skX:171,skY:171,alpha:1}))},i.prototype.free=function(){this.game=null,this.group=null,this.base=null,this.eyes=null,this.hat=null,this.scepter=null,this.brown=null,this.cast=null,this.fireBall=null,this.bodyFireBall=null,this.fireBallExploading=null,this.bodyQuestCar=null},i}(e.BasicDragon);e.Lvl13DragonMage=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.tors=new e.SASprite(i,0,0,"dragon","tors instance 10000"),s.tors.pivot.set(61,39),s.group.addChild(s.tors),s.tors_1=i.make.sprite(0,0,"dragon","tors_1 instance 10000"),s.tors.addChild(s.tors_1),s.tail1=new e.SASprite(i,0,0,"dragon","tail1 instance 10000"),s.tail1.pivot.set(27,28),s.group.addChild(s.tail1),s.tail1_1=i.make.sprite(0,0,"dragon","tail1_1 instance 10000"),s.tail1.addChild(s.tail1_1),s.tail2=new e.SASprite(i,0,0,"dragon","tail2 instance 10000"),s.tail2.pivot.set(20,21),s.group.addChild(s.tail2),s.tail2_1=i.make.sprite(0,0,"dragon","tail2_1 instance 10000"),s.tail2.addChild(s.tail2_1),s.tail3=new e.SASprite(i,0,0,"dragon","tail3 instance 10000"),s.tail3.pivot.set(18,15),s.group.addChild(s.tail3),s.tail3_1=i.make.sprite(0,0,"dragon","tail3_1 instance 10000"),s.tail3.addChild(s.tail3_1),s.tail4=new e.SASprite(i,0,0,"dragon","tail4 instance 10000"),s.tail4.pivot.set(19,12),s.group.addChild(s.tail4),s.tail4_1=i.make.sprite(0,0,"dragon","tail4_1 instance 10000"),s.tail4.addChild(s.tail4_1),s.tail5=new e.SASprite(i,0,0,"dragon","tail5 instance 10000"),s.tail5.pivot.set(18,14),s.group.addChild(s.tail5),s.tail5_1=i.make.sprite(0,0,"dragon","tail5_1 instance 10000"),s.tail5.addChild(s.tail5_1),s.tail6=new e.SASprite(i,0,0,"dragon","tail6 instance 10000"),s.tail6.pivot.set(16,12),s.group.addChild(s.tail6),s.tail6_1=i.make.sprite(0,0,"dragon","tail6_1 instance 10000"),s.tail6.addChild(s.tail6_1),s.tail7=new e.SASprite(i,0,0,"dragon","tail7 instance 10000"),s.tail7.pivot.set(14,43),s.group.addChild(s.tail7),s.tail7_1=i.make.sprite(0,0,"dragon","tail7_1 instance 10000"),s.tail7.addChild(s.tail7_1),s.neck3=new e.SASprite(i,0,0,"dragon","neck3 instance 10000"),s.neck3.pivot.set(23,36),s.group.addChild(s.neck3),s.neck3_1=i.make.sprite(1,1,"dragon","neck3_1 instance 10000"),s.neck3.addChild(s.neck3_1),s.neck2=new e.SASprite(i,0,0,"dragon","neck2 instance 10000"),s.neck2.pivot.set(23,38),s.group.addChild(s.neck2),s.neck2_1=i.make.sprite(0,0,"dragon","neck2_1 instance 10000"),s.neck2.addChild(s.neck2_1),s.neck1=new e.SASprite(i,0,0,"dragon","neck1 instance 10000"),s.neck1.pivot.set(19,29),s.group.addChild(s.neck1),s.neck1_1=i.make.sprite(0,0,"dragon","neck1_1 instance 10000"),s.neck1.addChild(s.neck1_1),s.head=new e.Lvl13DragonHead(i),s.group.addChild(s.head.group),s.setParts("shoot"),s}return __extends(i,t),i.prototype.goNormal=function(){this.head.goNormal(),e.GameManager.instance.level.setSimpleTween(this.tors_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.tail1_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.tail2_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.tail3_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.tail4_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.tail5_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.tail6_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.tail7_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.neck3_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.neck2_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.neck1_1,this.goNormalTime,{alpha:0})},i.prototype.shoot=function(){this.playAnim("shoot")},i.prototype.magDies=function(){this.playAnim("magDies"),this.head.playAnim("nom")},i.prototype.flyAway=function(){this.playAnim("flyAway"),this.head.flyAway()},i.prototype.update=function(){t.prototype.update.call(this),this.head.update()},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"shoot"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,4,{x:-178,y:0,skX:-30,skY:-30,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.neck1,4,{x:-146,y:14,skX:-76,skY:-76,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.neck2,4,{x:-114,y:26,skX:-54,skY:-54}),e.GameManager.instance.level.setSimpleTween(this.neck3,4,{x:-98,y:36,skX:-26,skY:-26,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail7,4,{x:122,y:-6,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.tail6,4,{x:125,y:43,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.tail5,4,{x:108,y:59,skX:-28,skY:-28,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail4,4,{x:85,y:73,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.tail3,4,{x:62,y:70,skX:-23,skY:-23}),e.GameManager.instance.level.setSimpleTween(this.tail2,4,{x:27,y:65,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.tail1,4,{x:8,y:49,skX:-7,skY:-7,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tors,4,{x:-48,y:52,skX:2,skY:2})):5===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-180,y:29,skX:-22,skY:-22,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-149,y:38,skX:-105,skY:-105}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{x:-116,y:36,skX:-72,skY:-72}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-99,y:42,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.tail7,5,{x:93,y:-39,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.tail6,5,{x:115,y:7,skX:-60,skY:-60}),e.GameManager.instance.level.setSimpleTween(this.tail5,5,{x:106,y:28,skX:-51,skY:-51}),e.GameManager.instance.level.setSimpleTween(this.tail4,5,{x:89,y:49,skX:-51,skY:-51}),e.GameManager.instance.level.setSimpleTween(this.tail3,5,{x:65,y:53,skX:-39,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.tail2,5,{x:31,y:55,skX:-40,skY:-40}),e.GameManager.instance.level.setSimpleTween(this.tail1,5,{x:9,y:43,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-46,y:55,skX:-6,skY:-6})):10===this.counterAnim?(this.head.playAnim("shoot"),e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-179,y:56,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-146,y:67,skX:-104,skY:-104}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{y:61,skX:-85,skY:-85}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-97,y:62,skX:-60,skY:-60}),e.GameManager.instance.level.setSimpleTween(this.tail7,5,{x:81,y:-56,skX:-50,skY:-50}),e.GameManager.instance.level.setSimpleTween(this.tail6,5,{x:108,y:-12,skX:-64,skY:-64}),e.GameManager.instance.level.setSimpleTween(this.tail5,5,{x:102,y:10,skX:-61,skY:-61}),e.GameManager.instance.level.setSimpleTween(this.tail4,5,{y:34,skX:-61,skY:-61}),e.GameManager.instance.level.setSimpleTween(this.tail3,5,{x:66,y:41,skX:-48,skY:-48,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail2,5,{x:32,y:49,skX:-48,skY:-48}),e.GameManager.instance.level.setSimpleTween(this.tail1,5,{y:39,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-45,y:57,skX:-11,skY:-11})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-168,y:83,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-142,y:97,skX:-103,skY:-103,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{x:-108,y:86,skX:-98,skY:-98}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-90,y:82,skX:-88,skY:-88}),e.GameManager.instance.level.setSimpleTween(this.tail7,5,{x:67,y:-71,skX:-56,skY:-56}),e.GameManager.instance.level.setSimpleTween(this.tail6,5,{x:98,y:-30,skX:-69,skY:-69}),e.GameManager.instance.level.setSimpleTween(this.tail5,5,{x:95,y:-6,skX:-71,skY:-71,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail4,5,{x:87,y:19,skX:-71,skY:-71}),e.GameManager.instance.level.setSimpleTween(this.tail3,5,{x:65,y:31,skX:-58,skY:-58,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail2,5,{x:33,y:43,skX:-56,skY:-56}),e.GameManager.instance.level.setSimpleTween(this.tail1,5,{x:10,y:35,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-44,y:58,skX:-16,skY:-16})):60===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-179,y:56,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-146,y:67,skX:-104,skY:-104,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{x:-116,y:61,skX:-85,skY:-85}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-97,y:62,skX:-60,skY:-60}),e.GameManager.instance.level.setSimpleTween(this.tail7,5,{x:81,y:-56,skX:-50,skY:-50}),e.GameManager.instance.level.setSimpleTween(this.tail6,5,{x:108,y:-12,skX:-64,skY:-64}),e.GameManager.instance.level.setSimpleTween(this.tail5,5,{x:102,y:10,skX:-61,skY:-61,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail4,5,{x:89,y:34,skX:-61,skY:-61}),e.GameManager.instance.level.setSimpleTween(this.tail3,5,{x:66,y:41,skX:-48,skY:-48,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail2,5,{x:32,y:49,skX:-48,skY:-48}),e.GameManager.instance.level.setSimpleTween(this.tail1,5,{x:9,y:39,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-45,y:57,skX:-11,skY:-11})):65===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-180,y:29,skX:-22,skY:-22}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-149,y:38,skX:-105,skY:-105}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{y:36,skX:-72,skY:-72}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-99,y:42,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.tail7,5,{x:93,y:-39,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.tail6,5,{x:115,y:7,skX:-60,skY:-60}),e.GameManager.instance.level.setSimpleTween(this.tail5,5,{x:106,y:28,skX:-51,skY:-51}),e.GameManager.instance.level.setSimpleTween(this.tail4,5,{y:49,skX:-51,skY:-51}),e.GameManager.instance.level.setSimpleTween(this.tail3,5,{x:65,y:53,skX:-39,skY:-39,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail2,5,{x:31,y:55,skX:-40,skY:-40}),e.GameManager.instance.level.setSimpleTween(this.tail1,5,{y:43,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-46,y:55,skX:-6,skY:-6})):70===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-178,y:0,skX:-30,skY:-30,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-146,y:14,skX:-76,skY:-76}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{x:-114,y:26,skX:-54,skY:-54}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-98,y:36,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.tail7,5,{x:122,y:-6,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.tail6,5,{x:125,y:43,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.tail5,5,{x:108,y:59,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.tail4,5,{x:85,y:73,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.tail3,5,{x:62,y:70,skX:-23,skY:-23}),e.GameManager.instance.level.setSimpleTween(this.tail2,5,{x:27,y:65,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.tail1,5,{x:8,y:49,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-48,y:52,skX:2,skY:2})):75===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-158,y:-32,skX:-41,skY:-41,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-131,y:-13,skX:-38,skY:-38}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{x:-108,y:13,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-97,y:29,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.tail7,5,{x:141,y:54,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.tail6,5,{x:123,y:95,skX:8,skY:8}),e.GameManager.instance.level.setSimpleTween(this.tail5,5,{x:99,y:100,skX:3,skY:3,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail4,5,{x:72,y:102,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.tail3,5,{x:52,y:92,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.tail2,5,{x:21,y:76,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.tail1,5,{x:6,y:56,skX:7,skY:7}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-50,y:48,skX:12,skY:12})):80===this.counterAnim&&this.animComplete():"magDies"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,41,{scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.neck2,41,{y:14}),e.GameManager.instance.level.setSimpleTween(this.tail7,41,{y:53})):42===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,10,{x:-186,y:15,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.neck1,10,{x:-151,y:18,skX:-83,skY:-83}),e.GameManager.instance.level.setSimpleTween(this.neck2,10,{x:-117,y:23,skX:-67,skY:-67}),e.GameManager.instance.level.setSimpleTween(this.neck3,10,{x:-99,y:31,skX:-33,skY:-33}),e.GameManager.instance.level.setSimpleTween(this.tail7,10,{x:134,y:19,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.tail6,10,{y:68,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.tail5,10,{x:103,y:81,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.tail4,10,{x:79,y:91,skX:-22,skY:-22}),e.GameManager.instance.level.setSimpleTween(this.tail3,10,{x:56,y:84,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.tail2,10,{x:23,y:74,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.tail1,10,{y:54,skX:3,skY:3})):52===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,10,{x:-180,y:67,skX:-74,skY:-74}),e.GameManager.instance.level.setSimpleTween(this.neck1,10,{x:-149,y:53,skX:-128,skY:-128}),e.GameManager.instance.level.setSimpleTween(this.neck2,10,{x:-119,y:35,skX:-102,skY:-102}),e.GameManager.instance.level.setSimpleTween(this.neck3,10,{x:-102,y:33,skX:-47,skY:-47}),e.GameManager.instance.level.setSimpleTween(this.tail7,10,{x:116,y:-10,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.tail6,10,{x:117,y:43,skX:-45,skY:-45}),e.GameManager.instance.level.setSimpleTween(this.tail5,10,{x:104,y:62,skX:-38,skY:-38,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail4,10,{x:83,y:78,skX:-39,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.tail3,10,{x:59,y:77,skX:-26,skY:-26,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail2,10,{x:25,y:71,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.tail1,10,{y:53,skX:-2,skY:-2})):62===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,3,{x:-182,y:2,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.neck1,7,{x:-124,y:-31,skX:-39,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.neck2,7,{x:-102,y:-4,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.neck3,7,{x:-93,y:12,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.tail7,7,{x:141,y:53,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.tail6,7,{x:122,y:95,skX:8,skY:8}),e.GameManager.instance.level.setSimpleTween(this.tail5,7,{x:99,y:100,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.tail4,7,{x:73,y:102,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.tail3,7,{x:52,y:92,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.tail2,7,{x:21,y:76,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.tail1,7,{x:5,y:56,skX:7,skY:7})):65===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.head.group,4,{x:-128,y:-63,skX:51,skY:51}):69===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tail6,39,{x:123}),e.GameManager.instance.level.setSimpleTween(this.tail5,39,{scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail4,39,{x:72}),e.GameManager.instance.level.setSimpleTween(this.tail3,39,{scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail1,39,{x:6,scX:1,scY:1})):83===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-150,y:-48,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-129,y:-20,skX:-38,skY:-38}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{x:-106,y:7,skX:-29,skY:-29}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-95,y:23,skX:-15,skY:-15})):88===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-158,y:-32,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-131,y:-13}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{x:-108,y:14,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-97,y:29,skX:-19,skY:-19})):108===this.counterAnim&&this.animComplete():"flyAway"===this.currAnim&&(12===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,3,{x:-164,y:-4,skX:-15,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.neck1,3,{x:-134,y:8,skX:-102,skY:-102}),e.GameManager.instance.level.setSimpleTween(this.neck2,3,{x:-102,y:12,skX:-54,skY:-54}),e.GameManager.instance.level.setSimpleTween(this.neck3,3,{x:-84,y:20,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.tail7,3,{x:150,y:-16,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.tail6,3,{x:138,y:34,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.tail5,3,{x:119,y:46,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.tail4,3,{x:92,y:57,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.tail3,3,{x:70,y:55,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.tail2,3,{x:46,y:54,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.tail1,3,{x:18,y:42,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.tors,3,{x:-34,y:46,skX:6,skY:6})):71===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,24,{x:-131,y:-63,skX:29,skY:29}),e.GameManager.instance.level.setSimpleTween(this.neck1,24,{x:-117,y:-35,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.neck2,24,{x:-91,y:-13,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.neck3,24,{x:-81,y:3,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.tail7,24,{x:177,y:74,skX:41,skY:41,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail6,24,{x:133,y:102,skX:23,skY:23}),e.GameManager.instance.level.setSimpleTween(this.tail5,24,{x:110,y:97,skX:23,skY:23,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail4,24,{x:85,y:88,skX:17,skY:17}),e.GameManager.instance.level.setSimpleTween(this.tail3,24,{x:67,y:76,skX:12,skY:12,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail2,24,{x:42,y:60,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.tail1,24,{x:20,y:38,skX:2,skY:2}),e.GameManager.instance.level.setSimpleTween(this.tors,24,{x:-35,y:36})):95===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,7,{x:-119,y:-76,skX:36,skY:36,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.neck1,7,{x:-110,y:-48,skX:-49,skY:-49,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.neck2,7,{x:-86,y:-21,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.neck3,7,{x:-78,y:-5,skX:-3,skY:-3}),e.GameManager.instance.level.setSimpleTween(this.tail7,29,{x:154,y:162,skX:93,skY:93,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail6,29,{x:105,y:146,skX:72,skY:72}),e.GameManager.instance.level.setSimpleTween(this.tail5,29,{x:87,y:128,skX:51,skY:51}),e.GameManager.instance.level.setSimpleTween(this.tail4,29,{x:65,y:113,skX:33,skY:33}),e.GameManager.instance.level.setSimpleTween(this.tail3,29,{x:55,y:93,skX:38,skY:38}),e.GameManager.instance.level.setSimpleTween(this.tail2,29,{x:34,y:71,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.tail1,29,{x:16,y:46,skX:9,skY:9}),e.GameManager.instance.level.setSimpleTween(this.tors,29,{y:31,skX:19,skY:19})):102===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,7,{x:-117,y:-80,skX:30,skY:30}),e.GameManager.instance.level.setSimpleTween(this.neck1,22,{x:-99,y:-56,skX:-38,skY:-38,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.neck2,22,{x:-81,y:-26,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.neck3,22,{x:-76,y:-9,skX:0,skY:0})):109===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.head.group,15,{x:-113,y:-87,skX:17,skY:17,scX:.99,scY:.99}):124===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,24,{x:-117,skX:13,skY:13}),e.GameManager.instance.level.setSimpleTween(this.neck1,24,{x:-103,skX:-37,skY:-37,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.neck2,24,{x:-83,y:-27,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.neck3,24,{y:-11,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.tail7,24,{x:177,y:103,skX:55,skY:55}),e.GameManager.instance.level.setSimpleTween(this.tail6,24,{x:128,y:117,skX:43,skY:43}),e.GameManager.instance.level.setSimpleTween(this.tail5,24,{x:105,y:107,skX:32,skY:32}),e.GameManager.instance.level.setSimpleTween(this.tail4,24,{x:80,y:97,skX:21,skY:21}),e.GameManager.instance.level.setSimpleTween(this.tail3,24,{x:65,y:80,skX:23,skY:23}),e.GameManager.instance.level.setSimpleTween(this.tail2,24,{x:40,y:64,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.tail1,24,{y:44,skX:-3,skY:-3})):148===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,24,{x:-113,skX:17,skY:17}),e.GameManager.instance.level.setSimpleTween(this.neck1,24,{x:-99,skX:-38,skY:-38,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.neck2,24,{x:-81,y:-26,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.neck3,24,{y:-9,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.tail7,24,{x:154,y:162,skX:93,skY:93}),e.GameManager.instance.level.setSimpleTween(this.tail6,24,{x:105,y:146,skX:72,skY:72}),e.GameManager.instance.level.setSimpleTween(this.tail5,24,{x:87,y:128,skX:51,skY:51}),e.GameManager.instance.level.setSimpleTween(this.tail4,24,{x:65,y:113,skX:33,skY:33}),e.GameManager.instance.level.setSimpleTween(this.tail3,24,{x:55,y:93,skX:38,skY:38}),e.GameManager.instance.level.setSimpleTween(this.tail2,24,{x:34,y:71,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.tail1,24,{y:46,skX:9,skY:9})):206===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"shoot"===e?(this.setPart(this.head.group,{x:-158,y:-32,angle:0,scX:.99,scY:.99,skX:-41,skY:-41,alpha:1}),this.setPart(this.neck1,{x:-131,y:-13,angle:0,scX:.99,scY:.99,skX:-38,skY:-38,alpha:1}),this.setPart(this.neck2,{x:-108,y:13,angle:0,scX:.98,scY:.98,skX:-31,skY:-31,alpha:1}),this.setPart(this.neck3,{x:-97,y:29,angle:0,scX:1,scY:1,skX:-19,skY:-19,alpha:1}),this.setPart(this.tail7,{x:141,y:53,angle:0,scX:.99,scY:.99,skX:-4,skY:-4,alpha:1}),this.setPart(this.tail6,{x:123,y:95,angle:0,scX:.99,scY:.99,skX:8,skY:8,alpha:1}),this.setPart(this.tail5,{x:99,y:100,angle:0,scX:.99,scY:.99,skX:3,skY:3,alpha:1}),this.setPart(this.tail4,{x:72,y:102,angle:0,scX:.99,scY:.99,skX:-5,skY:-5,alpha:1}),this.setPart(this.tail3,{x:52,y:92,angle:0,scX:.99,scY:.99,skX:-2,skY:-2,alpha:1}),this.setPart(this.tail2,{x:21,y:76,angle:0,scX:.99,scY:.99,skX:-8,skY:-8,alpha:1}),this.setPart(this.tail1,{x:6,y:56,angle:0,scX:1,scY:1,skX:7,skY:7,alpha:1}),this.setPart(this.tors,{x:-50,y:48,angle:0,scX:.99,scY:.99,skX:12,skY:12,alpha:1})):"magDies"===e?(this.setPart(this.head.group,{x:-158,y:-32,angle:0,scX:.99,scY:.99,skX:-41,skY:-41,alpha:1}),this.setPart(this.neck1,{x:-131,y:-13,angle:0,scX:.98,scY:.98,skX:-38,skY:-38,alpha:1}),this.setPart(this.neck2,{x:-108,y:13,angle:0,scX:.98,scY:.98,skX:-31,skY:-31,alpha:1}),this.setPart(this.neck3,{x:-97,y:29,angle:0,scX:.99,scY:.99,skX:-19,skY:-19,alpha:1}),this.setPart(this.tail7,{x:141,y:54,angle:0,scX:.99,scY:.99,skX:-4,skY:-4,alpha:1}),this.setPart(this.tail6,{x:123,y:95,angle:0,scX:.99,scY:.99,skX:8,skY:8,alpha:1}),this.setPart(this.tail5,{x:99,y:100,angle:0,scX:.99,scY:.99,skX:3,skY:3,alpha:1}),this.setPart(this.tail4,{x:72,y:102,angle:0,scX:.99,scY:.99,skX:-5,skY:-5,alpha:1}),this.setPart(this.tail3,{x:52,y:92,angle:0,scX:.99,scY:.99,skX:-2,skY:-2,alpha:1}),this.setPart(this.tail2,{x:21,y:76,angle:0,scX:.99,scY:.99,skX:-8,skY:-8,alpha:1}),this.setPart(this.tail1,{x:6,y:56,angle:0,scX:.99,scY:.99,skX:7,skY:7,alpha:1}),this.setPart(this.tors,{x:-50,y:48,angle:0,scX:.99,scY:.99,skX:12,skY:12,alpha:1})):"flyAway"===e&&(this.setPart(this.head.group,{x:-158,y:-32,angle:0,scX:.99,scY:.99,skX:-41,skY:-41,alpha:1}),this.setPart(this.neck1,{x:-131,y:-13,angle:0,scX:.99,scY:.99,skX:-38,skY:-38,alpha:1}),this.setPart(this.neck2,{x:-108,y:13,angle:0,scX:.98,scY:.98,skX:-31,skY:-31,alpha:1}),this.setPart(this.neck3,{x:-97,y:29,angle:0,scX:.99,scY:.99,skX:-19,skY:-19,alpha:1}),this.setPart(this.tail7,{x:141,y:53,angle:0,scX:.99,scY:.99,skX:-4,skY:-4,alpha:1}),this.setPart(this.tail6,{x:123,y:95,angle:0,scX:.99,scY:.99,skX:8,skY:8,alpha:1}),this.setPart(this.tail5,{x:99,y:100,angle:0,scX:.99,scY:.99,skX:3,skY:3,alpha:1}),this.setPart(this.tail4,{x:73,y:102,angle:0,scX:.99,scY:.99,skX:-5,skY:-5,alpha:1}),this.setPart(this.tail3,{x:52,y:92,angle:0,scX:.99,scY:.99,skX:-2,skY:-2,alpha:1}),this.setPart(this.tail2,{x:21,y:76,angle:0,scX:.99,scY:.99,skX:-8,skY:-8,alpha:1}),this.setPart(this.tail1,{x:6,y:56,angle:0,scX:.99,scY:.99,skX:7,skY:7,alpha:1}),this.setPart(this.tors,{x:-50,y:48,angle:0,scX:.99,scY:.99,skX:12,skY:12,alpha:1}))},i.prototype.free=function(){this.group=null,this.tors=null,this.tail1=null,this.tail2=null,this.tail3=null,this.tail4=null,this.tail5=null,this.tail6=null,this.tail7=null,this.neck3=null,this.neck2=null,this.neck1=null,this.head.free(),this.head=null,this.tors_1=null,this.tail1_1=null,this.tail2_1=null,this.tail3_1=null,this.tail4_1=null,this.tail5_1=null,this.tail6_1=null,this.tail7_1=null,this.neck3_1=null,this.neck2_1=null,this.neck1_1=null},i}(e.BasicDragon);e.Lvl13DragonTors=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.animCycle=!1,s.allAnimRound=!1,s.group=new e.SAGroup(i,0,0),s.dragonWing7=new e.SASprite(i,0,0,"dragon","dragonWing7 instance 10000"),s.dragonWing7.pivot.set(17,-4),s.group.addChild(s.dragonWing7),s.dragonWing8=new e.SASprite(i,0,0,"dragon","dragonWing8 instance 10000"),s.group.addChild(s.dragonWing8),s.dragonWing9=new e.SASprite(i,0,0,"dragon","dragonWing9 instance 10000"),s.dragonWing9.pivot.set(14,-7),s.group.addChild(s.dragonWing9),s.dragonWing10=new e.SASprite(i,0,0,"dragon","dragonWing10 instance 10000"),s.group.addChild(s.dragonWing10),s.dragonWing1=new e.SASprite(i,0,0,"dragon","dragonWing0_1 instance 10000"),s.dragonWing1.pivot.set(39,33),s.group.addChild(s.dragonWing1),s.dragonWing1_1=i.make.sprite(0,0,"dragon","dragonWing1 instance 10000"),s.dragonWing1.addChild(s.dragonWing1_1),s.dragonWing2=new e.SASprite(i,0,0,"dragon","dragonWing0_2 instance 10000"),s.dragonWing2.pivot.set(26,28),s.group.addChild(s.dragonWing2),s.dragonWing2_1=i.make.sprite(0,0,"dragon","dragonWing2 instance 10000"),s.dragonWing2.addChild(s.dragonWing2_1),s.dragonWing3=new e.SASprite(i,0,0,"dragon","dragonWing0_3 instance 10000"),s.dragonWing3.pivot.set(-16,4),s.group.addChild(s.dragonWing3),s.dragonWing3_1=i.make.sprite(0,0,"dragon","dragonWing3 instance 10000"),s.dragonWing3.addChild(s.dragonWing3_1),s.dragonWing4=new e.SASprite(i,0,0,"dragon","dragonWing0_4 instance 10000"),s.dragonWing4.pivot.set(21,53),s.group.addChild(s.dragonWing4),s.dragonWing4_1=i.make.sprite(0,0,"dragon","dragonWing4 instance 10000"),s.dragonWing4.addChild(s.dragonWing4_1),s.dragonWing5=new e.SASprite(i,0,0,"dragon","dragonWing0_5 instance 10000"),s.dragonWing5.pivot.set(38,64),s.group.addChild(s.dragonWing5),s.dragonWing5_1=i.make.sprite(0,0,"dragon","dragonWing5 instance 10000"),s.dragonWing5.addChild(s.dragonWing5_1),s.dragonWing6=new e.SASprite(i,0,0,"dragon","dragonWing0_6 instance 10000"),s.dragonWing6.pivot.set(79,66),s.group.addChild(s.dragonWing6),s.dragonWing6_1=i.make.sprite(0,0,"dragon","dragonWing6 instance 10000"),s.dragonWing6.addChild(s.dragonWing6_1),s.setParts("anim3"),s}return __extends(i,t),i.prototype.goNormal=function(){e.GameManager.instance.level.setSimpleTween(this.dragonWing1_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5_1,this.goNormalTime,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.dragonWing6_1,this.goNormalTime,{alpha:0})},i.prototype.open=function(){this.playAnim("anim3")},i.prototype.close=function(){this.playAnim("anim2")},i.prototype.onAnimComplete=function(){!1!==this.animCycle&&("anim"===this.currAnim?this.playAnim("anim2"):"anim2"===this.currAnim?this.playAnim("anim3"):"anim3"===this.currAnim?this.playAnim("anim4"):"anim4"===this.currAnim&&!0===this.allAnimRound&&this.playAnim("anim"))},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,5,{x:83,y:-172,skX:-71,skY:-71}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,5,{x:93,y:-122,skX:-57,skY:-57}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,5,{x:71,y:-95,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,5,{x:42,y:-56,skX:-34,skY:-34,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,5,{x:40,y:-95}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,5,{x:30,y:-34,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,5,{x:24,y:-171,skX:8,skY:8,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,5,{x:40,y:-220,skX:4,skY:-4,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,5,{x:32,y:-69,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,5,{x:50,y:-138,skX:18,skY:26,scX:.95,scY:.91})):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:116,y:-124,skX:-53,skY:-53}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:109,y:-80,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:85,y:-62,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:59,y:-37,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:59,y:-72}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:39,y:-22,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:56,y:-144,skX:23,skY:23,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:89,y:-181,skX:19,skY:13,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:53,y:-58,skX:30,skY:30}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:77,y:-108,skX:25,skY:38,scX:.89,scY:.81})):12===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:132,y:-49,skX:-29,skY:-29}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{y:-19,skX:-22,skY:-22}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:84,y:-13,skX:-16,skY:-16,scX:.98}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:68,y:-6,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:70,y:-33,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:44,y:-3,skX:38,skY:38}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:83,y:-92,skX:43,skY:42,scY:.69}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:135,y:-105,skX:49,skY:34,scX:.96,scY:.71}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:73,y:-29,skX:52,skY:52}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:102,y:-48,skX:48,skY:58,scX:.84,scY:.64})):18===this.counterAnim&&this.animComplete():"anim2"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:130,y:-10,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:101,y:11,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:78,y:11,skX:-8,skY:-8,scX:.99}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:69,y:10,skX:13,skY:13}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{y:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{y:8,skX:51,skY:51}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:91,y:-62,skX:54,skY:52,scY:.63}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:140,y:-61,skX:63,skY:44,scY:.65}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:74,y:-14,skX:60,skY:60}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:109,y:-11,skX:62,skY:70,scX:.76,scY:.55})):7===this.counterAnim&&this.animComplete():"anim3"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:132,y:-68,skX:-35,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:113,y:-35,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:87,y:-26,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:68,y:-14,skX:-3,skY:-3}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:69,y:-43}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{y:-8,skX:32,skY:32}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:78,y:-107,skX:37,skY:37,scY:.72}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:130,y:-126,skX:42,skY:29,scX:.95,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:72,y:-36,skX:47,skY:47}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:96,y:-65,skX:42,skY:53,scX:.87,scY:.69})):7===this.counterAnim&&this.animComplete():"anim4"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:116,y:-125,skX:-53,skY:-53}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:109,y:-80,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:85,y:-62,skX:-32,skY:-32,scX:.98}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:59,y:-37,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:59,y:-72,skX:4,skY:4}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:39,y:-22,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:56,y:-144,skX:23,skY:23,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:89,y:-181,skX:19,skY:13,scX:1,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:53,y:-58,skX:30,skY:30}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:77,y:-108,skX:25,skY:38,scX:.89,scY:.81})):7===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:82,y:-172,skX:-71,skY:-71}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:93,y:-122,skX:-57,skY:-57}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:71,y:-95,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:42,y:-56,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:40,y:-95}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:30,y:-34,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:24,y:-171,skX:8,skY:8,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:40,y:-220,skX:4,skY:-4,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:32,y:-69,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:50,y:-138,skX:18,skY:26,scX:.95,scY:.91})):13===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,5,{x:45,y:-201,skX:-86,skY:-86}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,5,{x:72,y:-150,skX:-70,skY:-70}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,5,{x:53,y:-117,skX:-54,skY:-54,scX:.99}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,5,{x:23,y:-65,skX:-47,skY:-47,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,5,{x:18,y:-109}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,5,{x:19,y:-41,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,5,{x:0,y:-193,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,5,{x:-9,y:-245,skX:-15,skY:-15,scY:1}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,5,{x:14,y:-77,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,5,{x:22,y:-157,skX:13,skY:15,scX:1,scY:1})):18===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e?(this.setPart(this.dragonWing6,{x:45,y:-201,angle:0,scX:.98,scY:.98,skX:-86,skY:-86,alpha:1}),this.setPart(this.dragonWing5,{x:72,y:-150,angle:0,scX:.99,scY:.99,skX:-70,skY:-70,alpha:1}),this.setPart(this.dragonWing4,{x:53,y:-117,angle:0,scX:.99,scY:.99,skX:-54,skY:-54,alpha:1}),this.setPart(this.dragonWing3,{x:23,y:-65,angle:0,scX:.99,scY:.99,skX:-47,skY:-47,alpha:1}),this.setPart(this.dragonWing2,{x:18,y:-109,angle:0,scX:1,scY:1,skX:4,skY:4,alpha:1}),this.setPart(this.dragonWing1,{x:19,y:-41,angle:0,scX:.99,scY:.99,skX:-24,skY:-24,alpha:1}),this.setPart(this.dragonWing10,{x:0,y:-193,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.dragonWing9,{x:-9,y:-245,angle:0,scX:1,scY:1,skX:-15,skY:-15,alpha:1}),this.setPart(this.dragonWing8,{x:14,y:-77,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.dragonWing7,{x:22,y:-157,angle:0,scX:1,scY:1,skX:13,skY:15,alpha:1})):"anim2"===e?(this.setPart(this.dragonWing6,{x:132,y:-49,angle:0,scX:.98,scY:.98,skX:-29,skY:-29,alpha:1}),this.setPart(this.dragonWing5,{x:109,y:-19,angle:0,scX:.99,scY:.99,skX:-22,skY:-22,alpha:1}),this.setPart(this.dragonWing4,{x:84,y:-13,angle:0,scX:.98,scY:.99,skX:-16,skY:-16,alpha:1}),this.setPart(this.dragonWing3,{x:68,y:-6,angle:0,scX:.98,scY:.98,skX:3,skY:3,alpha:1}),this.setPart(this.dragonWing2,{x:70,y:-33,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}),this.setPart(this.dragonWing1,{x:44,y:-3,angle:0,scX:.99,scY:.99,skX:38,skY:38,alpha:1}),this.setPart(this.dragonWing10,{x:83,y:-92,angle:0,scX:1,scY:.69,skX:43,skY:42,alpha:1}),this.setPart(this.dragonWing9,{x:135,y:-105,angle:0,scX:.96,scY:.71,skX:49,skY:34,alpha:1}),this.setPart(this.dragonWing8,{x:73,y:-29,angle:0,scX:1,scY:1,skX:52,skY:52,alpha:1}),this.setPart(this.dragonWing7,{x:102,y:-48,angle:0,scX:.84,scY:.64,skX:48,skY:58,alpha:1})):"anim3"===e?(this.setPart(this.dragonWing6,{x:130,y:-10,angle:0,scX:.98,scY:.98,skX:-17,skY:-17,alpha:1}),this.setPart(this.dragonWing5,{x:101,y:11,angle:0,scX:.99,scY:.99,skX:-13,skY:-13,alpha:1}),this.setPart(this.dragonWing4,{x:78,y:11,angle:0,scX:.99,scY:.99,skX:-8,skY:-8,alpha:1}),this.setPart(this.dragonWing3,{x:69,y:10,angle:0,scX:.98,scY:.98,skX:13,skY:13,alpha:1}),this.setPart(this.dragonWing2,{x:70,y:-13,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}),this.setPart(this.dragonWing1,{x:44,y:8,angle:0,scX:.99,scY:.99,skX:51,skY:51,alpha:1}),this.setPart(this.dragonWing10,{x:91,y:-62,angle:0,scX:1,scY:.63,skX:54,skY:52,alpha:1}),this.setPart(this.dragonWing9,{x:140,y:-61,angle:0,scX:.96,scY:.65,skX:63,skY:44,alpha:1}),this.setPart(this.dragonWing8,{x:74,y:-14,angle:0,scX:1,scY:1,skX:60,skY:60,alpha:1}),this.setPart(this.dragonWing7,{x:109,y:-11,angle:0,scX:.76,scY:.55,skX:62,skY:70,alpha:1})):"anim4"===e&&(this.setPart(this.dragonWing6,{x:132,y:-68,angle:0,scX:.98,scY:.98,skX:-35,skY:-35,alpha:1}),this.setPart(this.dragonWing5,{x:113,y:-35,angle:0,scX:.99,scY:.99,skX:-27,skY:-27,alpha:1}),this.setPart(this.dragonWing4,{x:87,y:-26,angle:0,scX:.99,scY:.99,skX:-20,skY:-20,alpha:1}),this.setPart(this.dragonWing3,{x:68,y:-14,angle:0,scX:.98,scY:.98,skX:-3,skY:-3,alpha:1}),this.setPart(this.dragonWing2,{x:69,y:-43,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}),this.setPart(this.dragonWing1,{x:44,y:-8,angle:0,scX:.99,scY:.99,skX:32,skY:32,alpha:1}),this.setPart(this.dragonWing10,{x:78,y:-107,angle:0,scX:1,scY:.72,skX:37,skY:37,alpha:1}),this.setPart(this.dragonWing9,{x:130,y:-126,angle:0,scX:.95,scY:.74,skX:42,skY:29,alpha:1}),this.setPart(this.dragonWing8,{x:72,y:-36,angle:0,scX:1,scY:1,skX:47,skY:47,alpha:1}),this.setPart(this.dragonWing7,{x:96,y:-65,angle:0,scX:.87,scY:.69,skX:42,skY:53,alpha:1}))},i.prototype.free=function(){this.group=null,this.dragonWing6=null,this.dragonWing5=null,this.dragonWing4=null,this.dragonWing3=null,this.dragonWing2=null,this.dragonWing1=null,this.dragonWing1_1=null,this.dragonWing2_1=null,this.dragonWing3_1=null,this.dragonWing4_1=null,this.dragonWing5_1=null,this.dragonWing6_1=null,this.dragonWing7=null,this.dragonWing8=null,this.dragonWing9=null,this.dragonWing10=null},i}(e.BasicDragon);e.Lvl13DragonWing=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.flying=!1,s.noming=!1,s.counterNom=0,s.updateGraphic=!1,s.counter=0,s.game=i,s.graphic=e.GameManager.instance.layerElements.create(765,-81,"level13","bat instance 10000"),s.graphic.animations.add("fly",Phaser.Animation.generateFrameNames("bat instance 1",0,24,"",4),30,!0),s.graphic.animations.add("hit",Phaser.Animation.generateFrameNames("bat instance 1",25,45,"",4),30,!1).onComplete.addOnce(function(){this.hit2()},s),s.graphic.animations.add("hit2",Phaser.Animation.generateFrameNames("bat instance 1",46,99,"",4),30,!1).onComplete.addOnce(s.hit3,s),s.graphic.animations.add("hit3",Phaser.Animation.generateFrameNames("bat instance 1",100,144,"",4),30,!1).killOnComplete=!0,s.graphic.animations.add("nom",Phaser.Animation.generateFrameNames("bat instance 1",145,158,"",4),30,!1).onComplete.addOnce(function(){this.graphic.animations.play("nomCycle")},s),s.graphic.animations.add("nomCycle",Phaser.Animation.generateFrameNames("bat instance 1",159,174,"",4),30,!0),s.graphic.visible=!1,s}return __extends(i,t),i.prototype.fly=function(){this.graphic.visible=!0,this.graphic.animations.play("fly"),this.flying=!0,e.SoundManager.playSFX("s_lvl13_bat",!0)},i.prototype.hit=function(){this.graphic.animations.play("hit"),this.flying=!1,e.SoundManager.stopSFXLoop("s_lvl13_bat"),e.SoundManager.playSFX("s_lvl13_batDeath")},i.prototype.hit2=function(){this.graphic.animations.play("hit2"),e.GameManager.instance.level.setSimpleTween(this.graphic,10,{y:50})},i.prototype.hit3=function(){this.graphic.animations.play("hit3"),e.SoundManager.playSFX("s_lvl13_batDissolved")},i.prototype.nom=function(){e.SoundManager.playSFX("s_lvl13_batAttack"),e.SoundManager.stopSFXLoop("s_lvl13_bat"),this.graphic.animations.play("nom"),e.GameManager.instance.hero.setEnableMotor(!1,!1),e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.currEyesState=e.EyesState.bumpForEver,e.GameManager.instance.level.customAction(1);var t=this.game.make.sprite(2,1,"level13","batCarDeath instance 10000");e.GameManager.instance.hero.graphicCar.addChildAt(t,0);var i=this.game.make.graphics(200,100);i.beginFill(16711680,.5),i.drawEllipse(0,0,100,50),i.endFill(),t.addChild(i),t.mask=i,e.GameManager.instance.level.setSimpleTween(i,180,{x:60,y:40}),i=null,t=null,this.noming=!0},i.prototype.update=function(){!0===this.flying&&(this.counter+=.7,this.plot(Math.floor(this.counter)),this.graphic.x<=e.GameManager.instance.hero.bodyBase.x-32&&(this.flying=!1,this.nom(),this.updateGraphic=!0)),!0===this.updateGraphic&&(this.graphic.x=e.GameManager.instance.hero.bodyBase.x-32,this.graphic.y=e.GameManager.instance.hero.bodyBase.y-98),!0===this.noming&&(this.counterNom+=1,200===this.counterNom&&(this.noming=!1,e.LevelBuilder.instance.levelFailed()))},i.prototype.plot=function(e){1===e?this.groupPos(767,-76):2===e?this.groupPos(765,-70):3===e?this.groupPos(763,-64):4===e?this.groupPos(760,-59):5===e?this.groupPos(757,-54):6===e?this.groupPos(755,-49):7===e?this.groupPos(752,-44):8===e?this.groupPos(748,-39):9===e?this.groupPos(745,-34):10===e?this.groupPos(742,-29):11===e?this.groupPos(739,-23):12===e?this.groupPos(734,-18):13===e?this.groupPos(730,-14):14===e?this.groupPos(725,-10):15===e?this.groupPos(720,-6):16===e?this.groupPos(716,-3):17===e?this.groupPos(711,1):18===e?this.groupPos(706,5):19===e?this.groupPos(702,8):20===e?this.groupPos(697,12):21===e?this.groupPos(692,15):22===e?this.groupPos(687,18):23===e?this.groupPos(683,22):24===e?this.groupPos(678,25):25===e?this.groupPos(673,28):26===e?this.groupPos(668,32):27===e?this.groupPos(664,36):28===e?this.groupPos(660,40):29===e?this.groupPos(656,44):30===e?this.groupPos(651,47):31===e?this.groupPos(647,51):32===e?this.groupPos(643,55):33===e?this.groupPos(638,59):34===e?this.groupPos(633,62):35===e?this.groupPos(629,65):36===e?this.groupPos(624,69):37===e?this.groupPos(619,72):38===e?this.groupPos(614,75):39===e?this.groupPos(609,78):40===e?this.groupPos(603,80):41===e?this.groupPos(598,83):42===e?this.groupPos(593,85):43===e?this.groupPos(587,87):44===e?this.groupPos(582,89):45===e?this.groupPos(576,89):46===e?this.groupPos(570,89):47===e?this.groupPos(564,89):48===e?this.groupPos(558,89):49===e?this.groupPos(552,89):50===e?this.groupPos(547,88):51===e?this.groupPos(541,87):52===e?this.groupPos(535,85):53===e?this.groupPos(530,83):54===e?this.groupPos(525,80):55===e?this.groupPos(520,77):56===e?this.groupPos(514,74):57===e?this.groupPos(509,70):58===e?this.groupPos(505,67):59===e?this.groupPos(500,63):60===e?this.groupPos(495,60):61===e?this.groupPos(490,56):62===e?this.groupPos(485,53):63===e?this.groupPos(480,50):64===e?this.groupPos(475,48):65===e?this.groupPos(470,46):66===e?this.groupPos(464,43):67===e?this.groupPos(458,42):68===e?this.groupPos(453,40):69===e?this.groupPos(447,39):70===e?this.groupPos(441,38):71===e?this.groupPos(435,36):72===e?this.groupPos(429,36):73===e?this.groupPos(423,36):74===e?this.groupPos(418,36):75===e?this.groupPos(412,36):76===e?this.groupPos(406,36):77===e?this.groupPos(400,37):78===e?this.groupPos(395,39):79===e?this.groupPos(389,41):80===e?this.groupPos(384,44):81===e?this.groupPos(378,46):82===e?this.groupPos(373,48):83===e?this.groupPos(367,51):84===e?this.groupPos(362,53):85===e?this.groupPos(356,55):86===e?this.groupPos(351,58):87===e?this.groupPos(345,60):88===e?this.groupPos(340,63):89===e?this.groupPos(334,65):90===e?this.groupPos(329,68):91===e?this.groupPos(324,70):92===e?this.groupPos(319,72):93===e?this.groupPos(313,74):94===e?this.groupPos(308,76):95===e?this.groupPos(303,78):96===e?this.groupPos(297,80):97===e?this.groupPos(292,82):98===e?this.groupPos(286,83):99===e?this.groupPos(281,83):100===e?this.groupPos(275,83):101===e?this.groupPos(269,82):102===e?this.groupPos(263,80):103===e?this.groupPos(258,78):104===e?this.groupPos(253,75):105===e?this.groupPos(248,71):106===e?this.groupPos(243,68):107===e?this.groupPos(238,65):108===e?this.groupPos(233,61):109===e?this.groupPos(228,58):110===e?this.groupPos(223,55):111===e?this.groupPos(218,52):112===e?this.groupPos(213,49):113===e?this.groupPos(207,47):114===e?this.groupPos(202,45):115===e?this.groupPos(196,43):116===e?this.groupPos(191,41):117===e?this.groupPos(185,40):118===e?this.groupPos(179,39):119===e?this.groupPos(173,38):120===e?this.groupPos(167,37):121===e?this.groupPos(162,37):122===e?this.groupPos(156,37):123===e?this.groupPos(151,37):124===e?this.groupPos(145,37):125===e?this.groupPos(140,37):126===e?this.groupPos(134,37):127===e?this.groupPos(128,37):128===e?this.groupPos(123,37):129===e?this.groupPos(117,37):130===e?this.groupPos(112,38):131===e?this.groupPos(106,38):132===e?this.groupPos(101,38):133===e?this.groupPos(95,38):134===e?this.groupPos(90,38):135===e?this.groupPos(84,38):136===e?this.groupPos(79,38):137===e?this.groupPos(73,38):138===e?this.groupPos(68,38):139===e?this.groupPos(62,38):140===e?this.groupPos(56,38):141===e?this.groupPos(51,38):142===e?this.groupPos(45,39):143===e?this.groupPos(39,39):144===e?this.groupPos(34,39):145===e&&this.groupPos(28,38)},i.prototype.groupPos=function(e,t){this.graphic.x=e,this.graphic.y=t},i.prototype.free=function(){this.game=null,this.graphic=null},i}(e.BasicElement);e.Lvl13Bat=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.ropeL=new e.SASprite(i,0,0,"level13","cageRope instance 10000"),s.ropeL.anchor.setTo(.5),e.GameManager.instance.layerBackground.addChild(s.ropeL),s.ropeR=new e.SASprite(i,0,0,"level13","cageRope instance 10000"),s.ropeR.anchor.setTo(.5),e.GameManager.instance.layerBackground.addChild(s.ropeR),s.diamond=new e.SASprite(i,0,0,"level13","cageDiamond instance 10000"),s.diamond.anchor.setTo(.5),e.GameManager.instance.layerBackground.addChild(s.diamond),s.bg=new e.SASprite(i,0,0,"level13","cageBg instance 10000"),e.GameManager.instance.layerBackground.addChild(s.bg),s.playAnim("anim",-1),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(this.setPart(this.bg,{x:482,y:93,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.diamond,37,{y:125,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.ropeR,37,{x:523,y:150,skX:2,skY:-178,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.ropeL,37,{y:147,skX:-3,skY:-3,scY:1.16})):38===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.diamond,31,{y:130,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.ropeR,31,{x:526,y:153,skX:0,skY:-180,scY:1}),e.GameManager.instance.level.setSimpleTween(this.ropeL,31,{y:153,skX:0,skY:0,scY:1})):69===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.diamond,30,{y:126,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.ropeR,30,{y:149,skX:3,skY:-177,scY:1.16}),e.GameManager.instance.level.setSimpleTween(this.ropeL,30,{x:498,y:150,scY:1.14})):99===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.diamond,37,{y:130,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.ropeR,37,{y:153,skX:0,skY:-180,scY:1}),e.GameManager.instance.level.setSimpleTween(this.ropeL,37,{x:497,y:153,scY:1})):136===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.bg,{x:482,y:93,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.diamond,{x:512,y:130,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.ropeR,{x:526,y:153,angle:0,scX:1,scY:1,skX:0,skY:-180,alpha:1}),this.setPart(this.ropeL,{x:497,y:153,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.bg=null,this.diamond=null,this.ropeL=null,this.ropeR=null},i}(e.BasicSimpleAnim);e.Lvl13Cage=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.wheelyActive=!1,s.wheelyCounter=0,s.soul=new e.SASprite(i,0,0,"level13","ghostSoul instance 10000"),s.soul.pivot.set(23,37),e.GameManager.instance.layerUpper.addChild(s.soul),s.wave2=new e.SASprite(i,0,0,"level13","ghostWave instance 10000"),s.wave2.pivot.set(253,23),e.GameManager.instance.layerUpper.addChild(s.wave2),s.boss3=new e.SASprite(i,0,0,"level13","ghostBoss3 instance 10000"),s.boss3.pivot.set(60,47),e.GameManager.instance.layerUpper.addChild(s.boss3),s.wave1=new e.SASprite(i,0,0,"level13","ghostWave instance 10000"),s.wave1.pivot.set(253,23),e.GameManager.instance.layerUpper.addChild(s.wave1),s.wheelySoul=new e.SASprite(i,0,0,"level13","ghostWheely instance 10000"),s.wheelySoul.pivot.set(65,40),e.GameManager.instance.layerUpper.addChild(s.wheelySoul),s.wheelySoul.visible=!1,s.playAnim("anim",-1),s}return __extends(i,t),i.prototype.showWheely=function(){this.wheelyX=e.GameManager.instance.hero.bodyBase.x,this.wheelySoul.visible=!0,this.wheelyActive=!0,this.setPart(this.wheelySoul,{x:this.wheelyX,y:669,angle:0,scX:1,scY:1,skX:45,skY:45,alpha:1})},i.prototype.update=function(){t.prototype.update.call(this),!0===this.wheelyActive&&(this.wheelyCounter+=1,1===this.wheelyCounter?e.GameManager.instance.level.setSimpleTween(this.wheelySoul,34,{x:this.wheelyX-74,y:542}):35===this.wheelyCounter?e.GameManager.instance.level.setSimpleTween(this.wheelySoul,75,{x:this.wheelyX+130,y:653}):110===this.wheelyCounter&&(this.wheelyActive=!1,e.LevelBuilder.instance.levelFailed()))},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wave1,101,{x:549,y:575}),e.GameManager.instance.level.setSimpleTween(this.boss3,101,{x:444,y:595}),e.GameManager.instance.level.setSimpleTween(this.wave2,101,{x:585,y:559}),e.GameManager.instance.level.setSimpleTween(this.soul,101,{x:577,y:651})):102===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wave1,52,{y:567}),e.GameManager.instance.level.setSimpleTween(this.boss3,105,{x:419,y:675}),e.GameManager.instance.level.setSimpleTween(this.wave2,105,{x:587,y:570}),e.GameManager.instance.level.setSimpleTween(this.soul,105,{x:546,y:603})):154===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.wave1,53,{x:548,y:560}):207===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.wave1,{x:548,y:560,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.boss3,{x:419,y:675,angle:0,scX:1,scY:1,skX:-27,skY:-27,alpha:1}),this.setPart(this.wave2,{x:587,y:570,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.soul,{x:546,y:603,angle:0,scX:1,scY:1,skX:-57,skY:-57,alpha:1}))},i.prototype.free=function(){this.wave1=null,this.boss3=null,this.wave2=null,this.soul=null,this.wheelySoul=null},i}(e.BasicSimpleAnim);e.Lvl13Ghosts=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.shineDown=!0,s.startTop=410,s.endTop=420,s.endBot=547,s.moveVertical=0,s.speedVertical=100,s.shootStarted=!1,s.horLiftStoped=0,s.contactHeroCount=0,s.game=i,s.graphic=e.GameManager.instance.layerUpper.create(710,s.startTop,"level13","liftBack instance 10000"),i.physics.box2d.enable(s.graphic),s.graphic.body.setRectangle(134,40,0,-13),s.graphic.body.friction=1,s.graphic.body.kinematic=!0,s.graphicShine=i.make.sprite(6,0,"level13","liftShine instance 10000"),s.graphicShine.anchor.setTo(.5),s.graphic.addChild(s.graphicShine);var a=i.make.sprite(-40,-5,"level13");return a.animations.add("anim",Phaser.Animation.generateFrameNames("liftParticle instance 1",0,89,"",4),30,!0),a.animations.play("anim"),s.graphic.addChild(a),(a=i.make.sprite(0,-14,"level13","liftFront instance 10000")).anchor.setTo(.5),s.graphic.addChild(a),a=null,s.btnBack=e.GameManager.instance.layerUpper.create(568,216,"level13","btnLiftBack instance 10000"),s.btnBack.anchor.setTo(.5),s.btnUp=e.GameManager.instance.layerUpper.create(571,217,"level13","btnLift instance 10000"),s.btnUp.anchor.setTo(.5),s.btnUp.inputEnabled=!0,s.btnUp.input.useHandCursor=!0,s.btnUp.events.onInputOut.add(s.btnUpOut,s),s.btnUp.events.onInputOver.add(s.btnUpOver,s),s.btnUp.events.onInputDown.add(s.goUp,s),s.btnDown=i.make.button(571,276,"level13",null,null,"btnLift instance 10001","btnLift instance 10000"),s.btnDown.anchor.setTo(.5),s.btnDown.scale.y=-1,s.btnDown.onInputDown.add(s.goDown,s),e.GameManager.instance.layerUpper.addChild(s.btnDown),s.bodyContact=new Phaser.Physics.Box2D.Body(i,null,710,s.graphic.body.y-100,1),s.bodyContact.setRectangle(100,20),s.bodyContact.sensor=!0,s.bodyContact.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,s.contactHero,s),s}return __extends(i,t),i.prototype.btnUpOut=function(){!0===this.btnUp.inputEnabled&&(this.btnUp.frameName="btnLift instance 10000")},i.prototype.btnUpOver=function(){!0===this.btnUp.inputEnabled&&(this.btnUp.frameName="btnLift instance 10001")},i.prototype.goUp=function(){!1!==this.btnUp.inputEnabled&&(-1===this.moveVertical||0===this.moveVertical&&this.graphic.body.y<=this.endTop||(this.moveVertical=-1,this.graphic.body.velocity.y=-this.speedVertical,e.SoundManager.playSFX("btnClick")))},i.prototype.goDown=function(){1===this.moveVertical||0===this.moveVertical&&this.graphic.body.y>=this.endBot||(this.moveVertical=1,this.graphic.body.velocity.y=this.speedVertical+10,e.SoundManager.playSFX("btnClick"))},i.prototype.crashBtnUp=function(){this.btnUp.inputEnabled=!1,this.btnUp.y=215,this.btnUp.frameName="btnLift instance 10003",this.btnBack.frameName="btnLiftBack instance 10001"},i.prototype.stopLiftVertical=function(){this.moveVertical=0,this.graphic.body.velocity.y=0},i.prototype.destroyJoint=function(t){void 0===t&&(t=!0),this.game.physics.box2d.world.DestroyJoint(this.joint),e.GameManager.instance.hero.setClickable(t)},i.prototype.update=function(){1===this.moveVertical?this.graphic.body.y>=this.endBot&&(this.graphic.body.y=this.endBot,this.stopLiftVertical()):-1===this.moveVertical&&this.graphic.body.y<=this.endTop&&(this.graphic.body.y=this.endTop,this.stopLiftVertical()),!0===this.shineDown?(this.graphicShine.y+=.5,this.graphicShine.y>=10&&(this.shineDown=!1)):(this.graphicShine.y-=.5,this.graphicShine.y<=0&&(this.shineDown=!0)),!1===this.shootStarted&&e.GameManager.instance.hero.bodyBase.y>335&&(e.GameManager.instance.level.customAction(7),this.shootStarted=!0),0===this.contactHeroCount?this.bodyContact.y=this.graphic.body.y-40:1===this.contactHeroCount&&(this.contactHeroCount=2,this.graphic.body.velocity.x=-20,this.horLiftStoped=1,this.joint=this.game.physics.box2d.ropeJoint(e.GameManager.instance.hero.bodyBase,this.graphic.body,80))},i.prototype.stopHor=function(){this.horLiftStoped=2,this.graphic.body.velocity.x=0},i.prototype.contactHero=function(){0===this.contactHeroCount&&(this.contactHeroCount=1)},i.prototype.free=function(){this.game=null,this.graphic=null,this.graphicShine=null,this.btnDown=null,this.btnUp=null,this.btnBack=null,this.bodyContact=null,this.joint=null},i}(e.BasicElement);e.Lvl13Lift=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;s.part13=new e.SASprite(i,0,0,"ui","carBody instance 10000"),s.part13.anchor.setTo(.5,.4),s.part13.events.onInputOut.add(s.questCarOut,s),s.part13.events.onInputOver.add(s.questCarOver,s),s.part13.events.onInputUp.add(s.questCarUp,s),e.GameManager.instance.layerBackground.addChild(s.part13);var a=i.make.sprite(-4,-22,"ui","carEye instance 10000");return a.animations.add("idle",Phaser.Animation.generateFrameNames("carEye instance 1",0,89,"",4),35,!0),a.play("idle"),s.part13.addChild(a),s.part12=new e.SASprite(i,0,0,"level13","qcp11 instance 10000"),s.part12.pivot.set(12,22),e.GameManager.instance.layerBackground.addChild(s.part12),s.part11=new e.SASprite(i,0,0,"level13","qcp10 instance 10000"),s.part11.pivot.set(14,7),e.GameManager.instance.layerBackground.addChild(s.part11),s.part10=new e.SASprite(i,0,0,"level13","qcp9 instance 10000"),s.part10.pivot.set(6,8),e.GameManager.instance.layerBackground.addChild(s.part10),s.part9=new e.SASprite(i,0,0,"level13","qcp9 instance 10000"),s.part9.pivot.set(6,8),e.GameManager.instance.layerBackground.addChild(s.part9),s.part8=new e.SASprite(i,0,0,"level13","qcp8 instance 10000"),s.part8.pivot.set(13,12),e.GameManager.instance.layerBackground.addChild(s.part8),s.part7=new e.SASprite(i,0,0,"level13","qcp7 instance 10000"),s.part7.pivot.set(4,11),e.GameManager.instance.layerBackground.addChild(s.part7),s.part6=new e.SASprite(i,0,0,"level13","qcp6 instance 10000"),s.part6.pivot.set(4,10),e.GameManager.instance.layerBackground.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level13","qcp5 instance 10000"),s.part5.pivot.set(14,7),e.GameManager.instance.layerBackground.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level13","qcp4 instance 10000"),s.part4.pivot.set(16,13),e.GameManager.instance.layerBackground.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level13","qcp3 instance 10000"),s.part3.pivot.set(46,9),e.GameManager.instance.layerBackground.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level13","qcp2 instance 10000"),s.part2.pivot.set(33,9),e.GameManager.instance.layerBackground.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level13","qcp1 instance 10000"),s.part1.pivot.set(23,8),e.GameManager.instance.layerBackground.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.questCarOut=function(){this.part13.frameName="carBody instance 10000"},i.prototype.questCarOver=function(){this.part13.frameName="carBody instance 10001"},i.prototype.questCarUp=function(){e.GameManager.instance.level.clickQuestCar2(this.part13.x,this.part13.y),this.part13.destroy()},i.prototype.activate=function(){this.playAnim("anim"),e.SoundManager.playSFX("s_lvl13_shelves")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(13===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:382,y:270,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{y:273,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{y:250,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.part4,4,{x:371,y:232,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.part5,4,{x:333,y:239,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.part8,4,{y:230}),e.GameManager.instance.level.setSimpleTween(this.part9,4,{x:326,y:234,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.part10,4,{x:341,y:259,skX:-23,skY:157}),e.GameManager.instance.level.setSimpleTween(this.part11,4,{x:368,y:256,skX:103,skY:103}),e.GameManager.instance.level.setSimpleTween(this.part12,4,{x:375,y:287,skX:10,skY:20,scX:.94,scY:.76}),e.GameManager.instance.level.setSimpleTween(this.part13,4,{y:253,skX:-5,skY:-5})):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,8,{x:384,y:284,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.part2,8,{x:330,y:291,skX:35,skY:35}),e.GameManager.instance.level.setSimpleTween(this.part3,8,{y:257,skX:4,skY:4}),e.GameManager.instance.level.setSimpleTween(this.part4,8,{x:380,y:244,skX:43,skY:43}),e.GameManager.instance.level.setSimpleTween(this.part5,8,{x:330,y:246,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part6,8,{x:381,y:272,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.part7,8,{y:270,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.part8,8,{x:346,y:242,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.part9,8,{x:324,y:241,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.part10,8,{x:343,y:285,skX:60,skY:-120}),e.GameManager.instance.level.setSimpleTween(this.part11,8,{x:367,y:282,skX:35,skY:35}),e.GameManager.instance.level.setSimpleTween(this.part12,8,{x:379,y:311,skX:0,skY:-21,scX:.95,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part13,13,{x:353,y:275,skX:15,skY:15})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,2,{x:331,y:289,skX:31,skY:31}),e.GameManager.instance.level.setSimpleTween(this.part4,3,{x:377,y:243,skX:19,skY:19}),e.GameManager.instance.level.setSimpleTween(this.part7,2,{y:269}),e.GameManager.instance.level.setSimpleTween(this.part10,2,{x:347,y:287,skX:91,skY:-89}),e.GameManager.instance.level.setSimpleTween(this.part11,5,{x:364,y:286,skX:-30,skY:-30})):27===this.counterAnim?(this.setPart(this.part1,{x:384,y:284,angle:0,scX:1,scY:1,skX:-27,skY:-27,alpha:1}),this.setPart(this.part2,{x:331,y:289,angle:0,scX:1,scY:1,skX:31,skY:31,alpha:1}),this.setPart(this.part3,{x:356,y:257,angle:0,scX:1,scY:1,skX:4,skY:4,alpha:1}),this.setPart(this.part5,{x:330,y:246,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part6,{x:381,y:272,angle:0,scX:1,scY:1,skX:10,skY:10,alpha:1}),this.setPart(this.part7,{x:326,y:269,angle:0,scX:1,scY:1,skX:-5,skY:-5,alpha:1}),this.setPart(this.part8,{x:346,y:242,angle:0,scX:1,scY:1,skX:-16,skY:-16,alpha:1}),this.setPart(this.part9,{x:324,y:241,angle:0,scX:1,scY:1,skX:-13,skY:-13,alpha:1}),this.setPart(this.part10,{x:347,y:287,angle:0,scX:1,scY:1,skX:91,skY:-89,alpha:1}),this.setPart(this.part12,{x:379,y:311,angle:0,scX:.95,scY:1,skX:0,skY:-21,alpha:1})):28===this.counterAnim?this.setPart(this.part4,{x:377,y:243,angle:0,scX:1,scY:1,skX:19,skY:19,alpha:1}):30===this.counterAnim&&(this.animComplete(),this.part13.inputEnabled=!0,this.part13.input.useHandCursor=!0)))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:381,y:275,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:334,y:276,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:356,y:255,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:370,y:239,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part5,{x:335,y:247,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part6,{x:383,y:267,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part7,{x:326,y:266,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part8,{x:352,y:242,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part9,{x:331,y:242,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part10,{x:344,y:267,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),this.setPart(this.part11,{x:371,y:269,angle:0,scX:1,scY:1,skX:108,skY:108,alpha:1}),this.setPart(this.part12,{x:374,y:298,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part13,{x:348,y:259,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.part1=null,this.part2=null,this.part3=null,this.part4=null,this.part5=null,this.part6=null,this.part7=null,this.part8=null,this.part9=null,this.part10=null,this.part11=null,this.part12=null,this.part13=null},i}(e.BasicSimpleAnim);e.Lvl13QuestCar=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.alive=!1,s.counterDefeat=0,s.heroAlreadyDie=!1,s.killHeroCount=0,s.bumpHero=!1,s.game=i,s.body=new Phaser.Physics.Box2D.Body(i,null,510,136,2),s.body.setRectangle(120,84),s.group=i.make.group(),s.group.x=s.body.x,s.group.y=s.body.y,e.GameManager.instance.layerBackground.addChild(s.group),s.part11=new e.SASprite(i,0,0,"level13","skeletonPart11 instance 10000"),s.part11.pivot.set(14,5),s.group.addChild(s.part11),s.part10=new e.SASprite(i,0,0,"level13","skeletonPart10 instance 10000"),s.part10.pivot.set(11,16),s.group.addChild(s.part10),s.part9=new e.SASprite(i,0,0,"level13","skeletonPart9 instance 10000"),s.part9.pivot.set(11,10),s.group.addChild(s.part9),s.part8=new e.SASprite(i,0,0,"level13","skeletonPart8 instance 10000"),s.part8.pivot.set(18,17),s.group.addChild(s.part8),s.part7=new e.SASprite(i,0,0,"level13","skeletonPart7 instance 10000"),s.part7.pivot.set(22,18),s.group.addChild(s.part7),s.part6=new e.SASprite(i,0,0,"level13","skeletonPart6 instance 10000"),s.part6.pivot.set(21,15),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level13","skeletonPart5 instance 10000"),s.part5.pivot.set(11,11),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level13","skeletonPart4 instance 10000"),s.part4.pivot.set(18,15),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level13","skeletonPart3 instance 10000"),s.part3.pivot.set(8,10),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level13","skeletonPart2 instance 10000"),s.part2.pivot.set(17,14),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level13","skeletonPart1 instance 10000"),s.part1.pivot.set(24,13),s.group.addChild(s.part1),s.jaw=new e.SASprite(i,0,0,"level13","skeletonJaw instance 10000"),s.jaw.pivot.set(8,5),s.group.addChild(s.jaw),s.head=new e.SASprite(i,0,0,"level13","skeletonHead instance 10000"),s.head.pivot.set(37,27),s.group.addChild(s.head),s.eyes=i.make.sprite(20,13,"level13","skeletonEyes instance 10000"),s.eyes.visible=!1,s.head.addChild(s.eyes),s.dust=e.GameManager.instance.layerBackground.create(450,150,"level13","dust instance 10000"),s.dust.animations.add("anim",Phaser.Animation.generateFrameNames("dust instance 1",0,19,"",4),30,!1).killOnComplete=!0,s.wheel1=e.GameManager.instance.layerBackground.create(s.body.x-30,s.body.y+35,"level13","skeletonWheel instance 10000"),i.physics.box2d.enable(s.wheel1),s.wheel1.body.setCircle(11),s.wheel1.body.setCollisionCategory(e.FilterGroups.CAR1),s.wheel1.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),s.joint1=i.physics.box2d.revoluteJoint(s.body,s.wheel1,-30,35),s.wheel2=e.GameManager.instance.layerBackground.create(s.body.x+30,s.body.y+35,"level13","skeletonWheel instance 10000"),i.physics.box2d.enable(s.wheel2),s.wheel2.body.setCircle(11),s.wheel2.body.setCollisionCategory(e.FilterGroups.CAR1),s.wheel2.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),s.joint2=i.physics.box2d.revoluteJoint(s.body,s.wheel2,30,35,0,0,0,5,!1),s.setParts("appear"),s}return __extends(i,t),i.prototype.onAnimComplete=function(){"appear"===this.currAnim&&this.move()},i.prototype.appear=function(){this.playAnim("appear"),this.dust.animations.play("anim"),this.eyes.visible=!0,e.SoundManager.playSFX("s_skeleton"),this.body.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.killHero,this)},i.prototype.move=function(){this.alive=!0,this.playAnim("move",-1),this.joint2.EnableMotor(!0),this.joint2.SetMotorSpeed(-5),e.SoundManager.playSFX("s_skeletonWalk",!0)},i.prototype.killHero=function(){0===this.killHeroCount&&(this.killHeroCount=1)},i.prototype.die=function(){e.SoundManager.playSFX("s_l13_skeletonDeath"),e.SoundManager.stopSFXLoop("s_skeletonWalk"),this.alive=!1,this.activeAnim=!1,this.eyes.visible=!1,this.body.destroy(),this.game.physics.box2d.world.DestroyJoint(this.joint1),this.game.physics.box2d.world.DestroyJoint(this.joint2),this.wheel1.body.velocity.x=0,this.wheel1.body.velocity.y=0,this.wheel1.body.angularVelocity=0,this.wheel2.body.velocity.x=0,this.wheel2.body.velocity.y=0,this.wheel2.body.angularVelocity=0,this.activateBody(this.part11),this.activateBody(this.part10),this.activateBody(this.part9),this.activateBody(this.part8),this.activateBody(this.part7),this.activateBody(this.part6),this.activateBody(this.part5),this.activateBody(this.part4),this.activateBody(this.part3),this.activateBody(this.part2),this.activateBody(this.part1),this.activateBody(this.jaw),this.activateBody(this.head),this.head.body.angularVelocity=3,this.head.body.data.ApplyLinearImpulse(new box2d.b2Vec2(-2,1),this.head.body.data.GetPosition()),this.group.x=0,this.group.y=0},i.prototype.activateBody=function(t){t.pivot.set(0,0),this.game.physics.box2d.enable(t),t.body.x=this.group.x+t.x,t.body.y=this.group.y+t.y,t.body.friction=.4,t.body.setCollisionCategory(e.FilterGroups.CAR1),t.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR)},i.prototype.update=function(){t.prototype.update.call(this),!0===this.alive&&(this.group.x=this.body.x),1===this.killHeroCount?(!1===this.heroAlreadyDie?(this.killHeroCount=2,e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.level.customAction(2),!0===e.GameManager.instance.hero.getEnableMotor()&&e.GameManager.instance.hero.setEnableMotor(!1,!1),e.GameManager.instance.hero.currState=e.HeroState.bumpStars,e.SoundManager.playSFX("s_sword2"),e.SoundManager.stopSFXLoop("s_skeletonWalk")):this.killHeroCount=3,this.bumpHero=!0,this.joint2.EnableMotor(!1),e.GameManager.instance.hero.bodyBase.data.ApplyLinearImpulse(new box2d.b2Vec2(5,0),e.GameManager.instance.hero.bodyBase.data.GetPosition()),this.body.velocity.x=10):2===this.killHeroCount&&(this.counterDefeat+=1,120===this.counterDefeat&&(this.killHeroCount=3,e.LevelBuilder.instance.levelFailed())),!0===this.bumpHero&&this.body.x>=510&&(this.bumpHero=!1,this.body.velocity.x=0,this.wheel1.body.velocity.x=0,this.wheel1.body.velocity.y=0,this.wheel1.body.angularVelocity=0,this.wheel2.body.velocity.x=0,this.wheel2.body.velocity.y=0,this.wheel2.body.angularVelocity=0)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"appear"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head,12,{x:-34,y:8,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.jaw,34,{y:18}),this.setPart(this.part1,{x:-34,y:31,angle:0,scX:1,scY:1,skX:13,skY:13,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part2,34,{x:35,y:19}),e.GameManager.instance.level.setSimpleTween(this.part3,34,{x:35,y:1}),e.GameManager.instance.level.setSimpleTween(this.part4,12,{x:-2,y:28,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.part5,12,{y:32,skX:-73,skY:-73}),this.setPart(this.part6,{x:9,y:11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part7,{x:34,y:11,angle:0,scX:1,scY:1,skX:-27,skY:-27,alpha:1}),this.setPart(this.part8,{x:54,y:20,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part9,{x:57,y:33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part10,34,{x:-19,y:3})):6===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part9,29,{x:58,y:18}):12===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,23,{y:21,skX:0,skY:0}):13===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head,22,{x:-26,y:-16,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part4,22,{x:2,y:-2,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part5,9,{skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.part8,22,{x:57,y:-4})):18===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part7,17,{x:40,y:-23,skX:0,skY:0}):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part5,13,{x:17,y:10,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part6,13,{x:16,y:-35})):36===this.counterAnim&&this.animComplete():"move"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head,24,{x:-28,y:-15}),e.GameManager.instance.level.setSimpleTween(this.jaw,24,{x:-59,y:22,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.part1,24,{x:-35,y:23}),e.GameManager.instance.level.setSimpleTween(this.part2,24,{x:33,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.part3,24,{x:37,skX:6,skY:6}),e.GameManager.instance.level.setSimpleTween(this.part4,24,{x:0,y:-3,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.part5,24,{x:15,y:12,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.part6,24,{x:13,y:-32,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.part7,24,{x:39,y:-26,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.part8,24,{x:58,y:-8,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.part9,24,{y:15,skX:4,skY:4}),e.GameManager.instance.level.setSimpleTween(this.part10,24,{x:-20,y:4}),e.GameManager.instance.level.setSimpleTween(this.part11,24,{x:3,y:25})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head,25,{x:-26,y:-16}),e.GameManager.instance.level.setSimpleTween(this.jaw,25,{x:-58,y:18,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part1,25,{x:-34,y:21}),e.GameManager.instance.level.setSimpleTween(this.part2,25,{x:35,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part3,25,{x:35,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part4,25,{x:2,y:-2,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part5,25,{x:17,y:10,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part6,25,{x:16,y:-35,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part7,25,{x:40,y:-23,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part8,25,{x:57,y:-4,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part9,25,{y:18,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part10,25,{x:-19,y:3}),e.GameManager.instance.level.setSimpleTween(this.part11,25,{x:4,y:23})):50===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"appear"===e?(this.setPart(this.head,{x:-31,y:20,angle:0,scX:1,scY:1,skX:15,skY:15,alpha:1}),this.setPart(this.jaw,{x:-58,y:35,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part1,{x:-34,y:31,angle:0,scX:1,scY:1,skX:13,skY:13,alpha:1}),this.setPart(this.part2,{x:34,y:36,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:33,y:28,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:1,y:34,angle:0,scX:1,scY:1,skX:-49,skY:-49,alpha:1}),this.setPart(this.part5,{x:19,y:28,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part6,{x:9,y:11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part7,{x:34,y:11,angle:0,scX:1,scY:1,skX:-27,skY:-27,alpha:1}),this.setPart(this.part8,{x:54,y:20,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part9,{x:57,y:33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part10,{x:-22,y:24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part11,{x:4,y:23,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"move"===e&&(this.setPart(this.head,{x:-26,y:-16,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.jaw,{x:-58,y:18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part1,{x:-34,y:21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:35,y:19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:35,y:1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:2,y:-2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part5,{x:17,y:10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part6,{x:16,y:-35,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part7,{x:40,y:-23,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part8,{x:57,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part9,{x:58,y:18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part10,{x:-19,y:3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part11,{x:4,y:23,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part11=null,this.part10=null,this.part9=null,this.part8=null,this.part7=null,this.part6=null,this.part5=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null,this.jaw=null,this.head=null,this.eyes=null,this.dust=null,this.body=null,this.wheel1=null,this.wheel2=null,this.joint1=null,this.joint2=null},i}(e.BasicSimpleAnim);e.Lvl13Skeleton=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.moveLamp=!1,s.game=i,s.updateElements=new Array,s.group=i.make.group(),s.group.x=-100,s.group.y=336,s.group.scale.x=-1,e.GameManager.instance.layerElements.addChild(s.group),s.wing1=new e.Lvl14DragonWing(i,"1","_1"),s.group.addChild(s.wing1.group),s.updateElements.push(s.wing1),s.fLeg1=new e.Lvl14DragonFrontLeg(i,"1"),s.group.addChild(s.fLeg1.group),s.updateElements.push(s.fLeg1),s.bLeg1=new e.Lvl14DragonBackLeg(i,"1"),s.group.addChild(s.bLeg1.group),s.updateElements.push(s.bLeg1),s.tors=new e.Lvl14DragonTors(i),s.group.addChild(s.tors.group),s.updateElements.push(s.tors),s.sound=new e.Lvl14DragonSound(i),s.sound.group.visible=!1,s.group.addChild(s.sound.group),s.updateElements.push(s.sound),s.fLeg2=new e.Lvl14DragonFrontLeg(i),s.group.addChild(s.fLeg2.group),s.updateElements.push(s.fLeg2),s.bLeg2=new e.Lvl14DragonBackLeg(i),s.group.addChild(s.bLeg2.group),s.updateElements.push(s.bLeg2),s.sedlo=new e.SASprite(i,0,0,"dragon","dragonSeddle instance 10000"),s.sedlo.pivot.set(57,24),s.group.addChild(s.sedlo),s.wheely=new e.SASprite(i,0,0,"dragon","carcorpus instance 10000"),s.wheely.pivot.set(69,57),s.group.addChild(s.wheely),s.wing2=new e.Lvl14DragonWing(i),s.group.addChild(s.wing2.group),s.updateElements.push(s.wing2),s.smoke=i.make.sprite(-260,-160,"dragon"),s.smoke.animations.add("anim",Phaser.Animation.generateFrameNames("smoke instance 1",0,11,"",4),30,!1).onComplete.addOnce(s.smokeComp,s),s.group.addChild(s.smoke),s.smoke.visible=!1,s.playNormal(),s.wing2.playAnim("anim1",-1),s.wing1.playAnim("anim1",-1),s}return __extends(i,t),i.prototype.smokeComp=function(){this.smoke.destroy(),!0===this.moveLamp&&e.GameManager.instance.level.customAction(9)},i.prototype.playNormal=function(){this.playAnim("normal",-1),this.bLeg2.playAnim("normal",-1),this.fLeg2.playAnim("normal",-1),this.tors.playAnim("normal",-1),this.bLeg1.playAnim("normal",-1),this.fLeg1.playAnim("normal",-1)},i.prototype.playSmoke=function(t){void 0===t&&(t=!1),this.moveLamp=t,this.playAnim("smoke"),this.bLeg2.playAnim("smoke"),this.fLeg2.playAnim("smoke"),this.tors.playAnim("smoke"),this.tors.head.playAnim("smoke"),this.bLeg1.playAnim("smoke"),this.fLeg1.playAnim("smoke"),e.SoundManager.playSFX("s14_dragonSneezing")},i.prototype.playStart=function(){e.SoundManager.playSFX("s_whistling",!0),this.wheely.frameName="carcorpus instance 10001",this.playAnim("start"),this.bLeg1.playAnim("start"),this.bLeg2.playAnim("start"),this.fLeg1.playAnim("start"),this.fLeg2.playAnim("start"),this.tors.playStart(),this.wing1.loopAnim=0,this.wing2.loopAnim=0},i.prototype.onAnimComplete=function(){"smoke"===this.currAnim?this.playNormal():"start"===this.currAnim&&(this.playAnim("cycle",-1),this.sound.playAnim("anim",-1))},i.prototype.update=function(){t.prototype.update.call(this);for(var e=0;e<this.updateElements.length;e++)this.updateElements[e].update()},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"normal"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing2.group,24,{x:-17,y:-33,skX:-7,skY:3,scY:1.01}),e.GameManager.instance.level.setSimpleTween(this.wheely,24,{x:-4,y:-101,skX:4,skY:4}),e.GameManager.instance.level.setSimpleTween(this.sedlo,24,{x:-9,y:-44,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,24,{x:45,y:25,skX:-22,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,24,{x:-20,y:32,skX:-31,skY:-30}),e.GameManager.instance.level.setSimpleTween(this.tors.group,24,{x:21,y:-68,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,24,{x:25,y:24,skX:-22,skY:-22}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,24,{x:-33,y:35,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.wing1.group,24,{x:-15,y:-37,skX:-23,skY:-15,scY:1.01})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing2.group,25,{x:-20,y:-7,skX:-11,skY:-11,scY:1}),e.GameManager.instance.level.setSimpleTween(this.wheely,25,{x:-16,y:-75,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.sedlo,25,{x:-14,y:-18,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,25,{x:36,y:54,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,25,{x:-29,y:56,skX:-26,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.tors.group,25,{x:20,y:-41,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,25,{x:16,y:52,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,25,{x:-43,y:57,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.wing1.group,25,{x:-52,y:-12,skX:-11,skY:-11,scY:1})):50===this.counterAnim&&this.animComplete():"smoke"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing2.group,15,{x:-13,y:-62,skX:-3,skY:-3}),e.GameManager.instance.level.setSimpleTween(this.wheely,15,{x:1,y:-128,skX:2,skY:2}),e.GameManager.instance.level.setSimpleTween(this.sedlo,15,{x:-4,y:-71,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,15,{x:34,y:7,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,15,{x:-33,y:-4,skX:-14,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.tors.group,15,{x:32,y:-89,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,15,{x:15,y:2,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,15,{y:-10,skX:-15,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.wing1.group,15,{x:-23,y:-86,skX:-3,skY:-3})):16===this.counterAnim?(this.smoke.visible=!0,this.smoke.animations.play("anim"),e.GameManager.instance.level.setSimpleTween(this.wing2.group,10,{x:12,y:-97,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.wheely,10,{x:12,y:-166,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.sedlo,10,{x:20,y:-109,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,10,{x:77,y:-42,skX:-23,skY:-22}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,10,{x:12,y:-34,skX:-32,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.tors.group,10,{x:52,y:-135,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,10,{x:57,y:-42,skX:-23,skY:-23}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,10,{x:-1,y:-31,skX:-33,skY:-33}),e.GameManager.instance.level.setSimpleTween(this.wing1.group,10,{x:20,y:-115,skX:-16,skY:-16})):26===this.counterAnim?(this.wheely.visible=!1,e.GameManager.instance.level.blowHero(this.group.x+this.wheely.x,this.group.y+this.wheely.y,this.wheely.skX,this.moveLamp),e.GameManager.instance.level.setSimpleTween(this.wing2.group,10,{x:-12,y:-29,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.sedlo,10,{x:-4,y:-40,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,10,{x:45,y:33,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,10,{x:-19,y:35,skX:-26,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.tors.group,10,{x:30,y:-62,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,10,{x:26,y:31,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,10,{x:-34,y:36,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.wing1.group,10,{x:-39,y:-43,skX:-11,skY:-11})):36===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing2.group,10,{x:-19,y:-9}),e.GameManager.instance.level.setSimpleTween(this.sedlo,10,{x:-14,y:-18}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,10,{x:36,y:54}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,10,{x:-29,y:56}),e.GameManager.instance.level.setSimpleTween(this.tors.group,10,{x:20,y:-41}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,10,{x:16,y:52}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,10,{x:-43,y:57}),e.GameManager.instance.level.setSimpleTween(this.wing1.group,10,{x:-41,y:-13})):46===this.counterAnim&&this.animComplete():"start"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing2.group,14,{x:-16,y:-12,skX:25,skY:35,scY:.96}),e.GameManager.instance.level.setSimpleTween(this.wheely,14,{x:6,y:-76,skX:15,skY:15}),e.GameManager.instance.level.setSimpleTween(this.sedlo,14,{x:-6,y:-21,skX:11,skY:11}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,14,{x:38,y:46,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,14,{x:-27,y:35,skX:-32,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.tors.group,20,{x:34,y:-38,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,14,{x:9,y:47,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,14,{x:-49,y:37,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.wing1.group,10,{x:-17,y:-10,skX:16,skY:20,scY:.92})):11===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.wing1.group,20,{x:-15,y:-11,skX:-1,skY:-1,scY:1}):15===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.wing2.group,16,{y:-13,skX:-13,skY:-13,scY:1}):31===this.counterAnim&&this.animComplete():"cycle"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing2.group,50,{x:-13,skX:57,skY:45,scY:.84}),e.GameManager.instance.level.setSimpleTween(this.wheely,50,{x:-11,y:-78,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.sedlo,50,{skX:2,skY:2}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,50,{x:36,y:58,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,50,{x:-18,y:41,skX:-51,skY:-50}),e.GameManager.instance.level.setSimpleTween(this.sound.group,50,{x:-140,y:-121}),this.setPart(this.tors.group,{x:34,y:-38,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,50,{x:16,y:54,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,50,{x:-44,y:50,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.wing1.group,50,{x:-13,y:-13,skX:54,skY:54,scY:.83})):51===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing2.group,37,{x:-16,y:-14,skX:-13,skY:-13,scY:1}),e.GameManager.instance.level.setSimpleTween(this.wheely,37,{x:6,y:-76,skX:15,skY:15}),e.GameManager.instance.level.setSimpleTween(this.sedlo,37,{skX:11,skY:11}),e.GameManager.instance.level.setSimpleTween(this.bLeg2.group,37,{x:38,y:46,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.fLeg2.group,37,{x:-27,y:35,skX:-32,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.sound.group,37,{x:-131,y:-145}),e.GameManager.instance.level.setSimpleTween(this.bLeg1.group,37,{x:9,y:47,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.fLeg1.group,37,{x:-49,y:37,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.wing1.group,37,{x:-15,y:-11,skX:-1,skY:-1,scY:1})):88===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"normal"===e?(this.setPart(this.wing2.group,{x:-20,y:-7,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1}),this.setPart(this.wheely,{x:-16,y:-75,angle:0,scX:-1,scY:1,skX:-6,skY:-6,alpha:1}),this.setPart(this.sedlo,{x:-14,y:-18,angle:0,scX:1,scY:1,skX:-10,skY:-10,alpha:1}),this.setPart(this.bLeg2.group,{x:36,y:54,angle:0,scX:1,scY:.94,skX:-17,skY:-17,alpha:1}),this.setPart(this.fLeg2.group,{x:-29,y:56,angle:0,scX:1,scY:.94,skX:-26,skY:-25,alpha:1}),this.setPart(this.tors.group,{x:20,y:-41,angle:0,scX:1,scY:1,skX:-14,skY:-14,alpha:1}),this.setPart(this.bLeg1.group,{x:16,y:52,angle:0,scX:.89,scY:1.01,skX:-17,skY:-17,alpha:1}),this.setPart(this.fLeg1.group,{x:-43,y:57,angle:0,scX:.95,scY:.95,skX:-27,skY:-27,alpha:1}),this.setPart(this.wing1.group,{x:-52,y:-12,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1})):"smoke"===e?(this.setPart(this.wing2.group,{x:-20,y:-7,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1}),this.setPart(this.wheely,{x:-16,y:-75,angle:0,scX:-1,scY:1,skX:-6,skY:-6,alpha:1}),this.setPart(this.sedlo,{x:-14,y:-18,angle:0,scX:1,scY:1,skX:-10,skY:-10,alpha:1}),this.setPart(this.bLeg2.group,{x:36,y:54,angle:0,scX:1,scY:.94,skX:-17,skY:-17,alpha:1}),this.setPart(this.fLeg2.group,{x:-29,y:56,angle:0,scX:1,scY:.94,skX:-26,skY:-25,alpha:1}),this.setPart(this.tors.group,{x:20,y:-41,angle:0,scX:1,scY:1,skX:-14,skY:-14,alpha:1}),this.setPart(this.bLeg1.group,{x:16,y:52,angle:0,scX:.89,scY:1.01,skX:-17,skY:-17,alpha:1}),this.setPart(this.fLeg1.group,{x:-43,y:57,angle:0,scX:.95,scY:.95,skX:-27,skY:-27,alpha:1}),this.setPart(this.wing1.group,{x:-52,y:-12,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1})):"start"===e?(this.setPart(this.wing2.group,{x:-21,y:-9,angle:0,scX:1,scY:1,skX:-13,skY:-13,alpha:1}),this.setPart(this.wheely,{x:-16,y:-70,angle:0,scX:-1,scY:1,skX:-6,skY:-6,alpha:1}),this.setPart(this.sedlo,{x:-14,y:-18,angle:0,scX:1,scY:1,skX:-10,skY:-10,alpha:1}),this.setPart(this.bLeg2.group,{x:36,y:54,angle:0,scX:1,scY:.94,skX:-17,skY:-17,alpha:1}),this.setPart(this.fLeg2.group,{x:-29,y:56,angle:0,scX:1,scY:.94,skX:-26,skY:-25,alpha:1}),this.setPart(this.tors.group,{x:34,y:-38,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bLeg1.group,{x:16,y:52,angle:0,scX:.89,scY:1.01,skX:-17,skY:-17,alpha:1}),this.setPart(this.fLeg1.group,{x:-43,y:57,angle:0,scX:.95,scY:.95,skX:-27,skY:-27,alpha:1}),this.setPart(this.wing1.group,{x:-20,y:-13,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1})):"cycle"===e&&(this.setPart(this.wing2.group,{x:-16,y:-13,angle:0,scX:1,scY:1,skX:-13,skY:-13,alpha:1}),this.setPart(this.wheely,{x:6,y:-76,angle:0,scX:-1,scY:1,skX:15,skY:15,alpha:1}),this.setPart(this.sedlo,{x:-6,y:-21,angle:0,scX:1,scY:1,skX:11,skY:11,alpha:1}),this.setPart(this.bLeg2.group,{x:38,y:46,angle:0,scX:1,scY:.94,skX:-25,skY:-25,alpha:1}),this.setPart(this.fLeg2.group,{x:-27,y:35,angle:0,scX:1,scY:.94,skX:-32,skY:-31,alpha:1}),this.sound.group.visible=!0,this.setPart(this.sound.group,{x:-131,y:-145,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tors.group,{x:34,y:-38,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bLeg1.group,{x:9,y:47,angle:0,scX:.89,scY:1.01,skX:-2,skY:-2,alpha:1}),this.setPart(this.fLeg1.group,{x:-49,y:37,angle:0,scX:.95,scY:.95,skX:-12,skY:-12,alpha:1}),this.setPart(this.wing1.group,{x:-15,y:-11,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1}))},i.prototype.free=function(){this.game=null,this.group=null;for(var e=0;e<this.updateElements.length;e++)this.updateElements[e].free();this.updateElements=[],this.updateElements=null,this.wing1=null,this.fLeg1=null,this.bLeg1=null,this.tors=null,this.fLeg2=null,this.bLeg2=null,this.sedlo=null,this.wheely=null,this.wing2=null,this.smoke=null,this.sound=null},i}(e.BasicDragon);e.Lvl14Dragon=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.tongue=new e.SASprite(i,0,0,"dragon","tongue instance 10000"),s.tongue.pivot.set(15,3),s.group.addChild(s.tongue),s.jawBot=new e.SASprite(i,0,0,"dragon","jawBot instance 10000"),s.jawBot.pivot.set(24,24),s.group.addChild(s.jawBot),s.jawTop=new e.SASprite(i,0,0,"dragon","jawTop instance 10000"),s.jawTop.pivot.set(50,34),s.group.addChild(s.jawTop),s.eye=i.make.sprite(36,5,"dragon"),s.eye.animations.add("anim",Phaser.Animation.generateFrameNames("dragonEye instance 1",106,190,"",4),30,!0),s.eye.animations.add("sound",Phaser.Animation.generateFrameNames("dragonEye instance 1",191,191,"",4),30,!1),s.eye.animations.play("anim"),s.jawTop.addChild(s.eye),s.setParts("smoke"),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"smoke"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.jawTop,14,{x:2,y:1,skX:19,skY:19}),e.GameManager.instance.level.setSimpleTween(this.jawBot,14,{x:-21,y:29,skX:-7,skY:-7})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.jawTop,10,{x:1,y:3,skX:2,skY:2}),e.GameManager.instance.level.setSimpleTween(this.jawBot,10,{x:-20,y:31,skX:-12,skY:-12})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.jawTop,10,{y:7,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.jawBot,10,{x:-23,y:25,skX:0,skY:0})):35===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.jawBot,10,{x:-21,y:30,skX:-8,skY:-8}):45===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.jawBot,10,{x:-23,y:25,skX:0,skY:0}):55===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"smoke"===e?(this.setPart(this.jawTop,{x:1,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.jawBot,{x:-23,y:25,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tongue,{x:-16,y:13,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"start"===e&&(this.setPart(this.jawTop,{x:1,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.jawBot,{x:-21,y:30,angle:0,scX:1,scY:1,skX:-9,skY:-9,alpha:1}),this.setPart(this.tongue,{x:-27,y:16,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.tongue=null,this.jawBot=null,this.jawTop=null,this.eye=null},i}(e.BasicDragon);e.Lvl14DragonHead=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){void 0===s&&(s="");var a=t.call(this,i)||this;return a.group=new e.SAGroup(i,0,0),a.part4=new e.SASprite(i,0,0,"dragon","bLeg1"+s+" instance 10000"),a.part4.pivot.set(26,36),a.group.addChild(a.part4),a.part3=new e.SASprite(i,0,0,"dragon","bLeg2"+s+" instance 10000"),a.part3.pivot.set(8,13),a.group.addChild(a.part3),a.part2=new e.SASprite(i,0,0,"dragon","bLeg3"+s+" instance 10000"),a.part2.pivot.set(18,21),a.group.addChild(a.part2),a.part1=new e.SASprite(i,0,0,"dragon","bLeg4"+s+" instance 10000"),a.part1.pivot.set(20,11),a.group.addChild(a.part1),a.setParts("normal"),a}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"normal"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,11,{x:-42,y:56,skX:-91,skY:-91}),e.GameManager.instance.level.setSimpleTween(this.part2,24,{x:-23,y:39,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.part3,24,{x:-27,y:11,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.part4,24,{x:-16,y:-7,skX:-31,skY:-31})):12===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,13,{x:-34,y:68}):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,12,{x:-43,y:53}),e.GameManager.instance.level.setSimpleTween(this.part2,25,{x:-30,y:18,skX:48,skY:48}),e.GameManager.instance.level.setSimpleTween(this.part3,25,{x:-34,y:-2,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.part4,25,{x:-26,y:-13,skX:-11,skY:-11})):37===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,13,{x:-48,y:38,skX:-92,skY:-92}):50===this.counterAnim&&this.animComplete():"smoke"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,15,{x:-34,y:68,skX:-91,skY:-91}),e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:-23,y:39,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:-27,y:11,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.part4,15,{x:-16,y:-7,skX:-31,skY:-31})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,19,{x:-48,y:38,skX:-92,skY:-92}),e.GameManager.instance.level.setSimpleTween(this.part2,19,{x:-30,y:18,skX:48,skY:48}),e.GameManager.instance.level.setSimpleTween(this.part3,19,{x:-34,y:-2,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.part4,19,{x:-26,y:-13,skX:-11,skY:-11})):35===this.counterAnim&&this.animComplete():"start"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,12,{x:-42,y:56,skX:-91,skY:-91}),e.GameManager.instance.level.setSimpleTween(this.part2,30,{x:-23,y:39,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.part3,30,{x:-27,y:11,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.part4,30,{x:-16,y:-7,skX:-31,skY:-31})):13===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,18,{x:-34,y:68}):31===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"normal"===e?(this.setPart(this.part1,{x:-48,y:38,angle:0,scX:.99,scY:.99,skX:-92,skY:-92,alpha:1}),this.setPart(this.part2,{x:-30,y:18,angle:0,scX:.99,scY:.99,skX:48,skY:48,alpha:1}),this.setPart(this.part3,{x:-34,y:-2,angle:0,scX:.99,scY:.99,skX:-2,skY:-2,alpha:1}),this.setPart(this.part4,{x:-26,y:-13,angle:0,scX:.99,scY:.99,skX:-11,skY:-11,alpha:1})):"smoke"===e?(this.setPart(this.part1,{x:-48,y:38,angle:0,scX:.99,scY:.99,skX:-92,skY:-92,alpha:1}),this.setPart(this.part2,{x:-30,y:18,angle:0,scX:.99,scY:.99,skX:48,skY:48,alpha:1}),this.setPart(this.part3,{x:-34,y:-2,angle:0,scX:.99,scY:.99,skX:-2,skY:-2,alpha:1}),this.setPart(this.part4,{x:-26,y:-13,angle:0,scX:.99,scY:.99,skX:-11,skY:-11,alpha:1})):"start"===e&&(this.setPart(this.part1,{x:-48,y:38,angle:0,scX:.99,scY:.99,skX:-92,skY:-92,alpha:1}),this.setPart(this.part2,{x:-30,y:18,angle:0,scX:.99,scY:.99,skX:48,skY:48,alpha:1}),this.setPart(this.part3,{x:-34,y:-2,angle:0,scX:.99,scY:.99,skX:-2,skY:-2,alpha:1}),this.setPart(this.part4,{x:-26,y:-13,angle:0,scX:.99,scY:.99,skX:-11,skY:-11,alpha:1}))},i.prototype.free=function(){this.group=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null},i}(e.BasicDragon);e.Lvl14DragonBackLeg=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){void 0===s&&(s="");var a=t.call(this,i)||this;return a.group=new e.SAGroup(i,0,0),a.part3=new e.SASprite(i,0,0,"dragon","fLeg3"+s+" instance 10000"),a.part3.pivot.set(21,19),a.group.addChild(a.part3),a.part2=new e.SASprite(i,0,0,"dragon","fLeg2"+s+" instance 10000"),a.part2.pivot.set(16,8),a.group.addChild(a.part2),a.part1=new e.SASprite(i,0,0,"dragon","fLeg1"+s+" instance 10000"),a.part1.pivot.set(15,29),a.group.addChild(a.part1),a.setParts("normal"),a}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"normal"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,24,{x:-7,skX:27,skY:27}),e.GameManager.instance.level.setSimpleTween(this.part2,24,{x:-47,y:40,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.part3,24,{x:-23,y:15,skX:20,skY:20})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,25,{x:-5,skX:24,skY:24}),e.GameManager.instance.level.setSimpleTween(this.part2,25,{x:-49,y:14,skX:-69,skY:-69}),e.GameManager.instance.level.setSimpleTween(this.part3,25,{x:-21,y:5,skX:55,skY:55})):50===this.counterAnim&&this.animComplete():"smoke"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,15,{x:-13,y:-16,skX:42,skY:42}),e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:-58,y:36,skX:-63,skY:-63}),e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:-35,y:11,skX:20,skY:20})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,19,{x:-5,y:-13,skX:24,skY:24}),e.GameManager.instance.level.setSimpleTween(this.part2,19,{x:-49,y:14,skX:-69,skY:-69}),e.GameManager.instance.level.setSimpleTween(this.part3,19,{x:-21,y:5,skX:55,skY:55})):35===this.counterAnim&&this.animComplete():"start"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,30,{x:-7,skX:27,skY:27}),e.GameManager.instance.level.setSimpleTween(this.part2,30,{x:-47,y:40,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.part3,30,{x:-23,y:15,skX:20,skY:20})):31===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"normal"===e?(this.setPart(this.part1,{x:-5,y:-13,angle:0,scX:.99,scY:.99,skX:24,skY:24,alpha:1}),this.setPart(this.part2,{x:-49,y:14,angle:0,scX:.99,scY:.99,skX:-69,skY:-69,alpha:1}),this.setPart(this.part3,{x:-21,y:5,angle:0,scX:.99,scY:.99,skX:55,skY:55,alpha:1})):"smoke"===e?(this.setPart(this.part1,{x:-5,y:-13,angle:0,scX:.99,scY:.99,skX:24,skY:24,alpha:1}),this.setPart(this.part2,{x:-49,y:14,angle:0,scX:.99,scY:.99,skX:-69,skY:-69,alpha:1}),this.setPart(this.part3,{x:-21,y:5,angle:0,scX:.99,scY:.99,skX:55,skY:55,alpha:1})):"start"===e&&(this.setPart(this.part1,{x:-5,y:-13,angle:0,scX:.99,scY:.99,skX:24,skY:24,alpha:1}),this.setPart(this.part2,{x:-49,y:14,angle:0,scX:.99,scY:.99,skX:-69,skY:-69,alpha:1}),this.setPart(this.part3,{x:-21,y:5,angle:0,scX:.99,scY:.99,skX:55,skY:55,alpha:1}))},i.prototype.free=function(){this.group=null,this.part3=null,this.part2=null,this.part1=null},i}(e.BasicDragon);e.Lvl14DragonFrontLeg=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.part3=new e.SASprite(i,0,0,"dragon","sound instance 10000"),s.part3.pivot.set(4,7),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"dragon","sound instance 10000"),s.part2.pivot.set(4,7),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"dragon","sound instance 10000"),s.part1.pivot.set(4,7),s.group.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(this.part2.visible=!0,this.part3.visible=!0,e.GameManager.instance.level.setSimpleTween(this.part2,33,{x:-34,y:-53,skX:44,skY:44,scX:2.63,scY:2.63}),e.GameManager.instance.level.setSimpleTween(this.part3,18,{x:-34,y:-53,skX:44,skY:44,scX:2.63,scY:2.63})):19===this.counterAnim?(this.part1.visible=!0,this.setPart(this.part1,{x:20,y:6,angle:0,scX:1,scY:1,skX:49,skY:49,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part1,33,{x:-80,y:-19,skX:-51,skY:-51,scX:2.63,scY:2.63}),e.GameManager.instance.level.setSimpleTween(this.part3,37,{x:-169,y:-74,skX:-39,skY:-39,scX:4.46,scY:4.46,alpha:0})):34===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,37,{x:-169,y:-74,skX:-39,skY:-39,scX:4.46,scY:4.46,alpha:0}):52===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,37,{x:-108,y:-120,skX:32,skY:32,scX:4.46,scY:4.46,alpha:0}):57===this.counterAnim?this.part3.visible=!1:72===this.counterAnim?this.part2.visible=!1:74===this.counterAnim?(this.part3.visible=!0,this.setPart(this.part3,{x:8,y:8,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:-16,y:-21,skX:20,skY:20,scX:1.74,scY:1.74})):89===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.part1.visible=!1,this.setPart(this.part2,{x:1,y:17,angle:0,scX:1,scY:1,skX:-45,skY:-45,alpha:1}),this.setPart(this.part3,{x:-16,y:-21,angle:0,scX:1.74,scY:1.74,skX:20,skY:20,alpha:1}))},i.prototype.free=function(){this.group=null,this.part3=null,this.part2=null,this.part1=null},i}(e.BasicDragon);e.Lvl14DragonSound=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.tors=new e.SASprite(i,0,0,"dragon","tors instance 10000"),s.tors.pivot.set(61,39),s.group.addChild(s.tors),s.tail1=new e.SASprite(i,0,0,"dragon","tail1 instance 10000"),s.tail1.pivot.set(27,28),s.group.addChild(s.tail1),s.tail2=new e.SASprite(i,0,0,"dragon","tail2 instance 10000"),s.tail2.pivot.set(20,21),s.group.addChild(s.tail2),s.tail3=new e.SASprite(i,0,0,"dragon","tail3 instance 10000"),s.tail3.pivot.set(18,15),s.group.addChild(s.tail3),s.tail4=new e.SASprite(i,0,0,"dragon","tail4 instance 10000"),s.tail4.pivot.set(19,12),s.group.addChild(s.tail4),s.tail5=new e.SASprite(i,0,0,"dragon","tail5 instance 10000"),s.tail5.pivot.set(18,14),s.group.addChild(s.tail5),s.tail6=new e.SASprite(i,0,0,"dragon","tail6 instance 10000"),s.tail6.pivot.set(16,12),s.group.addChild(s.tail6),s.tail7=new e.SASprite(i,0,0,"dragon","tail7 instance 10000"),s.tail7.pivot.set(14,43),s.group.addChild(s.tail7),s.neck3=new e.SASprite(i,0,0,"dragon","neck3 instance 10000"),s.neck3.pivot.set(23,36),s.group.addChild(s.neck3),s.neck2=new e.SASprite(i,0,0,"dragon","neck2 instance 10000"),s.neck2.pivot.set(23,38),s.group.addChild(s.neck2),s.neck1=new e.SASprite(i,0,0,"dragon","neck1 instance 10000"),s.neck1.pivot.set(19,29),s.group.addChild(s.neck1),s.head=new e.Lvl14DragonHead(i),s.group.addChild(s.head.group),s.setParts("normal"),s}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this),this.head.update()},i.prototype.playStart=function(){this.playAnim("start"),this.head.setParts("start"),this.head.eye.animations.play("sound")},i.prototype.onAnimComplete=function(){"start"===this.currAnim&&this.playAnim("cycle",-1)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"normal"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,24,{x:-139,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.neck1,24,{x:-122,y:-30,skX:-45,skY:-45}),e.GameManager.instance.level.setSimpleTween(this.neck2,24,{x:-101,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.neck3,24,{y:14,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.tail7,24,{x:156,y:157,skX:86,skY:86,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail6,24,{x:105,y:146,skX:65,skY:65}),e.GameManager.instance.level.setSimpleTween(this.tail5,24,{x:85,y:131,skX:44,skY:44}),e.GameManager.instance.level.setSimpleTween(this.tail4,24,{x:61,y:118,skX:27,skY:27}),e.GameManager.instance.level.setSimpleTween(this.tail3,24,{x:48,y:99,skX:31,skY:31}),e.GameManager.instance.level.setSimpleTween(this.tail2,24,{x:25,y:80,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.tail1,24,{x:4,y:57,skX:2,skY:2})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,25,{x:-143,skX:6,skY:6}),e.GameManager.instance.level.setSimpleTween(this.neck1,25,{x:-126,y:-29,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.neck2,25,{x:-103,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.neck3,25,{y:12,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.tail7,25,{x:171,y:95,skX:49,skY:49,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail6,25,{x:124,y:114,skX:36,skY:36}),e.GameManager.instance.level.setSimpleTween(this.tail5,25,{x:100,y:108,skX:25,skY:25}),e.GameManager.instance.level.setSimpleTween(this.tail4,25,{x:74,y:100,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.tail3,25,{x:58,y:85,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.tail2,25,{x:30,y:73,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.tail1,25,{x:5,y:56,skX:-9,skY:-9})):50===this.counterAnim&&this.animComplete():"smoke"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,14,{x:-120,y:-81,skX:36,skY:36}),e.GameManager.instance.level.setSimpleTween(this.neck1,14,{x:-113,y:-49,skX:-38,skY:-38}),e.GameManager.instance.level.setSimpleTween(this.neck2,14,{x:-91,y:-22,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.neck3,14,{x:-83,y:-5,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.tail7,14,{x:155,y:157,skX:86,skY:86,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail6,14,{x:105,y:146,skX:65,skY:65,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail5,14,{x:85,y:131,skX:44,skY:44}),e.GameManager.instance.level.setSimpleTween(this.tail4,14,{x:61,y:118,skX:26,skY:26}),e.GameManager.instance.level.setSimpleTween(this.tail3,14,{x:48,y:99,skX:31,skY:31}),e.GameManager.instance.level.setSimpleTween(this.tail2,14,{x:25,y:80,skX:4,skY:4}),e.GameManager.instance.level.setSimpleTween(this.tail1,14,{x:4,y:57,skX:2,skY:2}),e.GameManager.instance.level.setSimpleTween(this.tors,14,{x:-49,scX:.98,scY:.98})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-158,y:-46,skX:6,skY:6,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-137,y:-19,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{x:-107,y:-1,skX:-47,skY:-47}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-94,y:12,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.tail7,10,{x:152,y:169,skX:101,skY:101}),e.GameManager.instance.level.setSimpleTween(this.tail6,10,{x:104,y:148,skX:73,skY:73}),e.GameManager.instance.level.setSimpleTween(this.tail5,10,{skX:48,skY:48}),e.GameManager.instance.level.setSimpleTween(this.tail4,10,{x:62,y:117,skX:29,skY:29}),e.GameManager.instance.level.setSimpleTween(this.tail3,10,{x:50,y:98,skX:33,skY:33}),e.GameManager.instance.level.setSimpleTween(this.tail2,10,{x:26,y:79,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.tail1,10,{x:3,y:59,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.tors,10,{x:-50,y:48})):20===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,5,{x:-182,y:3,skX:-25,skY:-25,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.neck1,5,{x:-151,y:18,skX:-78,skY:-78}),e.GameManager.instance.level.setSimpleTween(this.neck2,5,{x:-116,y:24,skX:-68,skY:-68}),e.GameManager.instance.level.setSimpleTween(this.neck3,5,{x:-100,y:31,skX:-34,skY:-34})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,10,{x:-143,y:-59,skX:6,skY:6}),e.GameManager.instance.level.setSimpleTween(this.neck1,10,{x:-126,y:-29,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.neck2,10,{x:-103,y:-3,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.neck3,10,{x:-93,y:12,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.tail7,10,{x:171,y:95,skX:49,skY:49,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.tail6,10,{x:124,y:114,skX:36,skY:36,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.tail5,10,{x:100,y:108,skX:25,skY:25}),e.GameManager.instance.level.setSimpleTween(this.tail4,10,{x:74,y:100,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.tail3,10,{x:58,y:85,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.tail2,10,{x:30,y:73,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.tail1,10,{x:5,y:56,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.tors,10,{y:49,scX:.99,scY:.99})):35===this.counterAnim&&this.animComplete():"start"===this.currAnim?2===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,14,{x:-111,y:-74,skX:7,skY:7}),e.GameManager.instance.level.setSimpleTween(this.neck1,14,{x:-103,y:-44,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.neck2,14,{x:-96,y:-9,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.neck3,14,{x:-92,y:8,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.tail7,14,{x:192,y:104,skX:108,skY:108}),e.GameManager.instance.level.setSimpleTween(this.tail6,14,{x:152,y:82,skX:64,skY:64}),e.GameManager.instance.level.setSimpleTween(this.tail5,14,{x:135,y:70,skX:37,skY:37}),e.GameManager.instance.level.setSimpleTween(this.tail4,14,{x:109,y:57,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.tail3,14,{x:79,y:49,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.tail2,14,{x:48,y:52,skX:-46,skY:-46}),e.GameManager.instance.level.setSimpleTween(this.tail1,14,{x:5,y:52,skX:-30,skY:-30}),e.GameManager.instance.level.setSimpleTween(this.tors,14,{x:-48,y:45,skX:13,skY:13})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,16,{x:-92,y:-75,skX:21,skY:21}),e.GameManager.instance.level.setSimpleTween(this.neck1,16,{x:-100,skX:15,skY:15}),e.GameManager.instance.level.setSimpleTween(this.tail7,16,{x:171,y:94,skX:49,skY:49}),e.GameManager.instance.level.setSimpleTween(this.tail6,16,{x:124,y:113,skX:37,skY:37}),e.GameManager.instance.level.setSimpleTween(this.tail5,16,{x:101,y:106,skX:26,skY:26}),e.GameManager.instance.level.setSimpleTween(this.tail4,16,{x:75,y:98,skX:15,skY:15}),e.GameManager.instance.level.setSimpleTween(this.tail3,16,{x:59,y:83,skX:17,skY:17}),e.GameManager.instance.level.setSimpleTween(this.tail2,16,{x:31,y:70,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.tail1,16,{x:6,skX:-9,skY:-9})):32===this.counterAnim&&this.animComplete():"cycle"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,50,{x:-103,y:-60,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.neck1,50,{x:-108,y:-29,skX:9,skY:9}),e.GameManager.instance.level.setSimpleTween(this.neck2,50,{x:-100,y:6,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.neck3,50,{x:-94,y:22,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.tail7,50,{x:178,y:102,skX:69,skY:69}),e.GameManager.instance.level.setSimpleTween(this.tail6,50,{x:129,y:107,skX:48,skY:48}),e.GameManager.instance.level.setSimpleTween(this.tail5,50,{x:109,y:99,skX:31,skY:31}),e.GameManager.instance.level.setSimpleTween(this.tail4,50,{x:87,y:88,skX:23,skY:23}),e.GameManager.instance.level.setSimpleTween(this.tail3,50,{x:68,y:74,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.tail2,50,{x:39,y:64,skX:-30,skY:-30}),e.GameManager.instance.level.setSimpleTween(this.tail1,50,{x:8,y:55,skX:-15,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.tors,50,{x:-46,y:53,skX:6,skY:6})):51===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.head.group,37,{x:-92,y:-75,skX:21,skY:21}),e.GameManager.instance.level.setSimpleTween(this.neck1,37,{x:-100,y:-44,skX:15,skY:15}),e.GameManager.instance.level.setSimpleTween(this.neck2,37,{x:-96,y:-9,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.neck3,37,{x:-92,y:8,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.tail7,37,{x:171,y:94,skX:49,skY:49}),e.GameManager.instance.level.setSimpleTween(this.tail6,37,{x:124,y:113,skX:37,skY:37}),e.GameManager.instance.level.setSimpleTween(this.tail5,37,{x:101,y:106,skX:26,skY:26}),e.GameManager.instance.level.setSimpleTween(this.tail4,37,{x:75,y:98,skX:15,skY:15}),e.GameManager.instance.level.setSimpleTween(this.tail3,37,{x:59,y:83,skX:17,skY:17}),e.GameManager.instance.level.setSimpleTween(this.tail2,37,{x:31,y:70,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.tail1,37,{x:6,y:52,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.tors,37,{x:-48,y:45,skX:13,skY:13})):88===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"normal"===e?(this.setPart(this.head.group,{x:-143,y:-59,angle:0,scX:.99,scY:.99,skX:6,skY:6,alpha:1}),this.setPart(this.neck1,{x:-126,y:-29,angle:0,scX:.98,scY:.98,skX:-44,skY:-44,alpha:1}),this.setPart(this.neck2,{x:-103,y:-3,angle:0,scX:.98,scY:.98,skX:-27,skY:-27,alpha:1}),this.setPart(this.neck3,{x:-93,y:12,angle:0,scX:.99,scY:.99,skX:-10,skY:-10,alpha:1}),this.setPart(this.tail7,{x:171,y:95,angle:0,scX:.98,scY:.98,skX:49,skY:49,alpha:1}),this.setPart(this.tail6,{x:124,y:114,angle:0,scX:.99,scY:.99,skX:36,skY:36,alpha:1}),this.setPart(this.tail5,{x:100,y:108,angle:0,scX:.98,scY:.98,skX:25,skY:25,alpha:1}),this.setPart(this.tail4,{x:74,y:100,angle:0,scX:.99,scY:.99,skX:14,skY:14,alpha:1}),this.setPart(this.tail3,{x:58,y:85,angle:0,scX:.98,scY:.98,skX:16,skY:16,alpha:1}),this.setPart(this.tail2,{x:30,y:73,angle:0,scX:.99,scY:.99,skX:-12,skY:-12,alpha:1}),this.setPart(this.tail1,{x:5,y:56,angle:0,scX:.99,scY:.99,skX:-9,skY:-9,alpha:1}),this.setPart(this.tors,{x:-50,y:49,angle:0,scX:.99,scY:.99,skX:12,skY:12,alpha:1})):"smoke"===e?(this.setPart(this.head.group,{x:-143,y:-59,angle:0,scX:.99,scY:.99,skX:6,skY:6,alpha:1}),this.setPart(this.neck1,{x:-126,y:-29,angle:0,scX:.98,scY:.98,skX:-44,skY:-44,alpha:1}),this.setPart(this.neck2,{x:-103,y:-3,angle:0,scX:.98,scY:.98,skX:-27,skY:-27,alpha:1}),this.setPart(this.neck3,{x:-93,y:12,angle:0,scX:.99,scY:.99,skX:-10,skY:-10,alpha:1}),this.setPart(this.tail7,{x:171,y:95,angle:0,scX:.98,scY:.98,skX:49,skY:49,alpha:1}),this.setPart(this.tail6,{x:124,y:114,angle:0,scX:.99,scY:.99,skX:36,skY:36,alpha:1}),this.setPart(this.tail5,{x:100,y:108,angle:0,scX:.98,scY:.98,skX:25,skY:25,alpha:1}),this.setPart(this.tail4,{x:74,y:100,angle:0,scX:.99,scY:.99,skX:14,skY:14,alpha:1}),this.setPart(this.tail3,{x:58,y:85,angle:0,scX:.98,scY:.98,skX:16,skY:16,alpha:1}),this.setPart(this.tail2,{x:30,y:73,angle:0,scX:.99,scY:.99,skX:-12,skY:-12,alpha:1}),this.setPart(this.tail1,{x:5,y:56,angle:0,scX:.99,scY:.99,skX:-9,skY:-9,alpha:1}),this.setPart(this.tors,{x:-50,y:49,angle:0,scX:.99,scY:.99,skX:12,skY:12,alpha:1})):"start"===e?(this.setPart(this.head.group,{x:-143,y:-59,angle:0,scX:.99,scY:.99,skX:6,skY:6,alpha:1}),this.setPart(this.neck1,{x:-126,y:-29,angle:0,scX:.98,scY:.98,skX:-44,skY:-44,alpha:1}),this.setPart(this.neck2,{x:-103,y:-3,angle:0,scX:.98,scY:.98,skX:-27,skY:-27,alpha:1}),this.setPart(this.neck3,{x:-93,y:12,angle:0,scX:.99,scY:.99,skX:-10,skY:-10,alpha:1}),this.setPart(this.tail7,{x:171,y:95,angle:0,scX:.98,scY:.98,skX:49,skY:49,alpha:1}),this.setPart(this.tail6,{x:124,y:114,angle:0,scX:.99,scY:.99,skX:36,skY:36,alpha:1}),this.setPart(this.tail5,{x:100,y:108,angle:0,scX:.98,scY:.98,skX:25,skY:25,alpha:1}),this.setPart(this.tail4,{x:74,y:100,angle:0,scX:.99,scY:.99,skX:14,skY:14,alpha:1}),this.setPart(this.tail3,{x:58,y:85,angle:0,scX:.98,scY:.98,skX:16,skY:16,alpha:1}),this.setPart(this.tail2,{x:30,y:73,angle:0,scX:.99,scY:.99,skX:-12,skY:-12,alpha:1}),this.setPart(this.tail1,{x:5,y:56,angle:0,scX:.99,scY:.99,skX:-9,skY:-9,alpha:1}),this.setPart(this.tors,{x:-50,y:49,angle:0,scX:.99,scY:.99,skX:12,skY:12,alpha:1})):"cycle"===e&&(this.setPart(this.head.group,{x:-92,y:-75,angle:0,scX:.99,scY:.99,skX:21,skY:21,alpha:1}),this.setPart(this.neck1,{x:-100,y:-44,angle:0,scX:.99,scY:.99,skX:15,skY:15,alpha:1}),this.setPart(this.neck2,{x:-96,y:-9,angle:0,scX:.99,scY:.99,skX:-14,skY:-14,alpha:1}),this.setPart(this.neck3,{x:-92,y:8,angle:0,scX:1,scY:1,skX:-10,skY:-10,alpha:1}),this.setPart(this.tail7,{x:171,y:94,angle:0,scX:.99,scY:.99,skX:49,skY:49,alpha:1}),this.setPart(this.tail6,{x:124,y:113,angle:0,scX:.99,scY:.99,skX:37,skY:37,alpha:1}),this.setPart(this.tail5,{x:101,y:106,angle:0,scX:.99,scY:.99,skX:26,skY:26,alpha:1}),this.setPart(this.tail4,{x:75,y:98,angle:0,scX:.99,scY:.99,skX:15,skY:15,alpha:1}),this.setPart(this.tail3,{x:59,y:83,angle:0,scX:.99,scY:.99,skX:17,skY:17,alpha:1}),this.setPart(this.tail2,{x:31,y:70,angle:0,scX:.99,scY:.99,skX:-11,skY:-11,alpha:1}),this.setPart(this.tail1,{x:6,y:52,angle:0,scX:.99,scY:.99,skX:-9,skY:-9,alpha:1}),this.setPart(this.tors,{x:-48,y:45,angle:0,scX:.99,scY:.99,skX:13,skY:13,alpha:1}))},i.prototype.free=function(){this.group=null,this.tors=null,this.tail1=null,this.tail2=null,this.tail3=null,this.tail4=null,this.tail5=null,this.tail6=null,this.tail7=null,this.neck3=null,this.neck2=null,this.neck1=null,this.head.free(),this.head=null},i}(e.BasicDragon);e.Lvl14DragonTors=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){void 0===s&&(s="0"),void 0===a&&(a="");var n=t.call(this,i)||this;return n.group=new e.SAGroup(i,0,0),n.dragonWing7=new e.SASprite(i,0,0,"dragon","dragonWing7"+a+" instance 10000"),n.dragonWing7.pivot.set(17,-4),n.group.addChild(n.dragonWing7),n.dragonWing8=new e.SASprite(i,0,0,"dragon","dragonWing8"+a+" instance 10000"),n.group.addChild(n.dragonWing8),n.dragonWing9=new e.SASprite(i,0,0,"dragon","dragonWing9"+a+" instance 10000"),n.dragonWing9.pivot.set(14,-7),n.group.addChild(n.dragonWing9),n.dragonWing10=new e.SASprite(i,0,0,"dragon","dragonWing10"+a+" instance 10000"),n.group.addChild(n.dragonWing10),n.dragonWing1=new e.SASprite(i,0,0,"dragon","dragonWing"+s+"_1 instance 10000"),n.dragonWing1.pivot.set(39,33),n.group.addChild(n.dragonWing1),n.dragonWing2=new e.SASprite(i,0,0,"dragon","dragonWing"+s+"_2 instance 10000"),n.dragonWing2.pivot.set(26,28),n.group.addChild(n.dragonWing2),n.dragonWing3=new e.SASprite(i,0,0,"dragon","dragonWing"+s+"_3 instance 10000"),n.dragonWing3.pivot.set(-16,4),n.group.addChild(n.dragonWing3),n.dragonWing4=new e.SASprite(i,0,0,"dragon","dragonWing"+s+"_4 instance 10000"),n.dragonWing4.pivot.set(21,53),n.group.addChild(n.dragonWing4),n.dragonWing5=new e.SASprite(i,0,0,"dragon","dragonWing"+s+"_5 instance 10000"),n.dragonWing5.pivot.set(38,64),n.group.addChild(n.dragonWing5),n.dragonWing6=new e.SASprite(i,0,0,"dragon","dragonWing"+s+"_6 instance 10000"),n.dragonWing6.pivot.set(79,66),n.group.addChild(n.dragonWing6),n.setParts("anim1"),n}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim1"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,5,{x:83,y:-172,skX:-71,skY:-71}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,5,{x:93,y:-122,skX:-57,skY:-57}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,5,{x:71,y:-95,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,5,{x:42,y:-56,skX:-34,skY:-34,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,5,{x:40,y:-95}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,5,{x:30,y:-34,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,5,{x:24,y:-171,skX:8,skY:8,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,5,{x:40,y:-220,skX:4,skY:-4,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,5,{x:32,y:-69,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,5,{x:50,y:-138,skX:18,skY:26,scX:.95,scY:.91})):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:116,y:-124,skX:-53,skY:-53}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:109,y:-80,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:85,y:-62,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:59,y:-37,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:59,y:-72}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:39,y:-22,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:56,y:-144,skX:23,skY:23,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:89,y:-181,skX:19,skY:13,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:53,y:-58,skX:30,skY:30}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:77,y:-108,skX:25,skY:38,scX:.89,scY:.81})):12===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:132,y:-69,skX:-35,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:112,y:-35,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:87,y:-26,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:68,y:-14,skX:-3,skY:-3,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:69,y:-43,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:44,y:-8,skX:32,skY:32}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:78,y:-107,skX:37,skY:37,scY:.72}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:130,y:-126,skX:42,skY:29,scX:.95,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:72,y:-36,skX:47,skY:47}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:96,y:-65,skX:42,skY:53,scX:.87,scY:.69})):18===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:130,y:-10,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:101,y:11,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:78,y:11,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:69,y:10,skX:13,skY:13,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:70,y:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{y:8,skX:51,skY:51}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:91,y:-62,skX:54,skY:52,scY:.63}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:140,y:-61,skX:63,skY:44,scX:.96,scY:.65}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:74,y:-14,skX:60,skY:60}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:109,y:-11,skX:62,skY:70,scX:.76,scY:.55})):24===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:132,y:-68,skX:-35,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:113,y:-35,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:87,y:-26,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:68,y:-14,skX:-3,skY:-3}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:69,y:-43}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{y:-8,skX:32,skY:32}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:78,y:-107,skX:37,skY:37,scY:.72}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:130,y:-126,skX:42,skY:29,scX:.95,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:72,y:-36,skX:47,skY:47}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:96,y:-65,skX:42,skY:53,scX:.87,scY:.69})):30===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:116,y:-125,skX:-53,skY:-53}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:109,y:-80,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:85,y:-62,skX:-32,skY:-32,scX:.98}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:59,y:-37,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:59,y:-72,skX:4,skY:4}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:39,y:-22,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:56,y:-144,skX:23,skY:23,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:89,y:-181,skX:19,skY:13,scX:1,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:53,y:-58,skX:30,skY:30}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:77,y:-108,skX:25,skY:38,scX:.89,scY:.81})):36===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:82,y:-172,skX:-71,skY:-71}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:93,y:-122,skX:-57,skY:-57}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:71,y:-95,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:42,y:-56,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:40,y:-95}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:30,y:-34,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:24,y:-171,skX:8,skY:8,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:40,y:-220,skX:4,skY:-4,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:32,y:-69,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:50,y:-138,skX:18,skY:26,scX:.95,scY:.91})):42===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,5,{x:45,y:-201,skX:-86,skY:-86}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,5,{x:72,y:-150,skX:-70,skY:-70}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,5,{x:53,y:-117,skX:-54,skY:-54,scX:.99}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,5,{x:23,y:-65,skX:-47,skY:-47,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,5,{x:18,y:-109}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,5,{x:19,y:-41,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,5,{x:0,y:-193,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,5,{x:-9,y:-245,skX:-15,skY:-15,scY:1}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,5,{x:14,y:-77,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,5,{x:22,y:-157,skX:13,skY:15,scX:1,scY:1})):47===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim1"===e&&(this.setPart(this.dragonWing6,{x:45,y:-201,angle:0,scX:.98,scY:.98,skX:-86,skY:-86,alpha:1}),this.setPart(this.dragonWing5,{x:72,y:-150,angle:0,scX:.99,scY:.99,skX:-70,skY:-70,alpha:1}),this.setPart(this.dragonWing4,{x:53,y:-117,angle:0,scX:.99,scY:.99,skX:-54,skY:-54,alpha:1}),this.setPart(this.dragonWing3,{x:23,y:-65,angle:0,scX:.99,scY:.99,skX:-47,skY:-47,alpha:1}),this.setPart(this.dragonWing2,{x:18,y:-109,angle:0,scX:1,scY:1,skX:4,skY:4,alpha:1}),this.setPart(this.dragonWing1,{x:19,y:-41,angle:0,scX:.99,scY:.99,skX:-24,skY:-24,alpha:1}),this.setPart(this.dragonWing10,{x:0,y:-193,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.dragonWing9,{x:-9,y:-245,angle:0,scX:1,scY:1,skX:-15,skY:-15,alpha:1}),this.setPart(this.dragonWing8,{x:14,y:-77,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.dragonWing7,{x:22,y:-157,angle:0,scX:1,scY:1,skX:13,skY:15,alpha:1}))},i.prototype.free=function(){this.group=null,this.dragonWing7=null,this.dragonWing8=null,this.dragonWing9=null,this.dragonWing10=null,this.dragonWing1=null,this.dragonWing2=null,this.dragonWing3=null,this.dragonWing4=null,this.dragonWing5=null,this.dragonWing6=null},i}(e.BasicDragon);e.Lvl14DragonWing=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.active=!1,s.startY=255,s.endY=400,s.graphic=e.GameManager.instance.layerBackground.create(530,s.startY,"level14","door instance 10000"),s.graphic.anchor.setTo(.5),s}return __extends(i,t),i.prototype.open=function(){this.active=!0},i.prototype.update=function(){!1!==this.active&&(this.graphic.y+=2,this.graphic.y>=this.endY&&(this.active=!1,this.graphic.y=this.endY,e.GameManager.instance.level.customAction(2)))},i.prototype.free=function(){this.graphic=null},i}(e.BasicElement);e.Lvl14Door=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.moving=!1,s.surprised=!1,s.contactHeroCount=0,s.game=i,s.body=new Phaser.Physics.Box2D.Body(i,null,655,297,2),s.body.setRectangle(100,52),s.body.setCollisionCategory(e.FilterGroups.CAR1),s.wheel1=e.GameManager.instance.layerBackground.create(s.body.x-32,s.body.y+26,"level14","girlWeel instance 10000"),i.physics.box2d.enable(s.wheel1),s.wheel1.body.setCircle(12),s.wheel1.body.setCollisionCategory(e.FilterGroups.CAR1),i.physics.box2d.revoluteJoint(s.body,s.wheel1,-32,26),s.wheel2=e.GameManager.instance.layerBackground.create(s.body.x+33,s.body.y+26,"level14","girlWeel instance 10000"),i.physics.box2d.enable(s.wheel2),s.wheel2.body.setCircle(12),s.wheel2.body.setCollisionCategory(e.FilterGroups.CAR1),i.physics.box2d.revoluteJoint(s.body,s.wheel2,33,26),s.group=i.make.group(),s.group.x=s.body.x,s.group.y=s.body.y,s.group.scale.x=-1,e.GameManager.instance.layerBackground.addChild(s.group),s.base=new e.SASprite(i,0,0,"level14","girlBase instance 10000"),s.base.pivot.set(1,-1),s.group.addChild(s.base),s.crown=new e.SASprite(i,0,0,"level14","girlCrown instance 10000"),s.crown.pivot.set(1,2),s.group.addChild(s.crown),s.eyes=new e.SASprite(i,0,0,"level14"),s.eyes.pivot.set(10,13),s.eyes.animations.add("lookAround",Phaser.Animation.generateFrameNames("girlEyes instance 1",0,114,"",4),30,!0),s.eyes.animations.add("surprise",Phaser.Animation.generateFrameNames("girlEyes instance 1",115,140,"",4),30,!1).onComplete.addOnce(s.endSurprise1,s),s.eyes.animations.add("surprise2",Phaser.Animation.generateFrameNames("girlEyes instance 1",141,224,"",4),30,!1).onComplete.addOnce(s.endSurprise,s),s.eyes.animations.add("niceFilm",Phaser.Animation.generateFrameNames("girlEyes instance 1",225,270,"",4),30,!0),s.eyes.animations.play("lookAround"),s.group.addChild(s.eyes),s.playAnim("idle",-1),s.createParts(),s}return __extends(i,t),i.prototype.createParts=function(){this.princessPart1=e.GameManager.instance.layerBackground.create(568,198,"level14","princessPart1 instance 10000"),this.game.physics.box2d.enable(this.princessPart1),this.princessPart1.body.setRectangle(20,22),this.princessPart1.body.kinematic=!0,this.princessPart1.body.setCollisionCategory(e.FilterGroups.CAR1),this.princessPart1.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.princessPart1.visible=!1,this.princessPart2=e.GameManager.instance.layerBackground.create(696,198,"level14","princessPart2 instance 10000"),this.game.physics.box2d.enable(this.princessPart2),this.princessPart2.body.setRectangle(22,30),this.princessPart2.body.kinematic=!0,this.princessPart2.body.setCollisionCategory(e.FilterGroups.CAR1),this.princessPart2.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.princessPart2.visible=!1,this.princessPart3=e.GameManager.instance.layerBackground.create(593,199,"level14","princessPart3 instance 10000"),this.game.physics.box2d.enable(this.princessPart3),this.princessPart3.body.setRectangle(10,22),this.princessPart3.body.angle=-36,this.princessPart3.body.kinematic=!0,this.princessPart3.body.setCollisionCategory(e.FilterGroups.CAR1),this.princessPart3.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.princessPart3.visible=!1,this.princessPart4=e.GameManager.instance.layerBackground.create(656,201,"level14","princessPart4 instance 10000"),this.game.physics.box2d.enable(this.princessPart4),this.princessPart4.body.setRectangle(50,8),this.princessPart4.body.kinematic=!0,this.princessPart4.body.setCollisionCategory(e.FilterGroups.CAR1),this.princessPart4.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.princessPart4.visible=!1,this.princessPart5=e.GameManager.instance.layerBackground.create(660,181,"level14","princessPart5 instance 10000"),this.game.physics.box2d.enable(this.princessPart5),this.princessPart5.body.setRectangle(24,24),this.princessPart5.body.kinematic=!0,this.princessPart5.body.setCollisionCategory(e.FilterGroups.CAR1),this.princessPart5.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.princessPart5.visible=!1,this.princessPart6=e.GameManager.instance.layerBackground.create(616,176,"level14","princessPart6 instance 10000"),this.game.physics.box2d.enable(this.princessPart6),this.princessPart6.body.setRectangle(46,22),this.princessPart6.body.kinematic=!0,this.princessPart6.body.setCollisionCategory(e.FilterGroups.CAR1),this.princessPart6.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.princessPart6.visible=!1},i.prototype.stopVelocityY=function(){this.body.velocity.y=0,this.wheel1.body.velocity.y=0,this.wheel2.body.velocity.y=0},i.prototype.surprise=function(){this.eyes.animations.play("surprise"),this.surprised=!0},i.prototype.onAnimComplete=function(){!0===this.surprised&&(this.activeAnim=!1)},i.prototype.endSurprise1=function(){this.eyes.animations.play("surprise2"),this.moving=!0},i.prototype.endSurprise=function(){this.eyes.animations.play("lookAround")},i.prototype.brokeCar=function(){this.group.visible=!1,this.wheel1.visible=!1,this.wheel2.visible=!1,this.activeAnim=!1,this.princessPart1.visible=!0,this.princessPart1.body.dynamic=!0,this.princessPart1.body.data.ApplyLinearImpulse(new box2d.b2Vec2(.5,.5),this.princessPart1.body.data.GetPosition()),this.princessPart2.visible=!0,this.princessPart2.body.dynamic=!0,this.princessPart2.body.data.ApplyLinearImpulse(new box2d.b2Vec2(-.5,.5),this.princessPart2.body.data.GetPosition()),this.princessPart3.visible=!0,this.princessPart3.body.dynamic=!0,this.princessPart3.body.data.ApplyLinearImpulse(new box2d.b2Vec2(.5,.3),this.princessPart3.body.data.GetPosition()),this.princessPart4.visible=!0,this.princessPart4.body.dynamic=!0,this.princessPart4.body.data.ApplyLinearImpulse(new box2d.b2Vec2(-.6,.3),this.princessPart4.body.data.GetPosition()),this.princessPart5.visible=!0,this.princessPart5.body.dynamic=!0,this.princessPart5.body.data.ApplyLinearImpulse(new box2d.b2Vec2(-1,.7),this.princessPart5.body.data.GetPosition()),this.princessPart6.visible=!0,this.princessPart6.body.dynamic=!0,this.princessPart6.body.data.ApplyLinearImpulse(new box2d.b2Vec2(1.8,.5),this.princessPart6.body.data.GetPosition())},i.prototype.update=function(){t.prototype.update.call(this),!0===this.moving&&(this.body.velocity.x=-40,this.body.x<=600&&(this.moving=!1,this.body.velocity.x=0,this.wheel1.body.velocity.x=0,this.wheel2.body.velocity.x=0,this.wheel1.body.angularVelocity=0,this.wheel2.body.angularVelocity=0,this.body.kinematic=!0,this.body.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.contactHero,this))),1===this.contactHeroCount&&(this.contactHeroCount=2,e.GameManager.instance.level.customAction(10),this.eyes.animations.play("niceFilm")),this.group.x=this.body.x,this.group.y=this.body.y},i.prototype.contactHero=function(){0===this.contactHeroCount&&(this.contactHeroCount=1)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"idle"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,16,{x:12,y:-26}),e.GameManager.instance.level.setSimpleTween(this.crown,16,{y:-46}),e.GameManager.instance.level.setSimpleTween(this.base,16,{y:-26})):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,15,{y:-27}),e.GameManager.instance.level.setSimpleTween(this.crown,15,{y:-48}),e.GameManager.instance.level.setSimpleTween(this.base,15,{y:-28})):32===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,9,{x:16,y:-31}),e.GameManager.instance.level.setSimpleTween(this.crown,9,{x:-15,y:-53}),e.GameManager.instance.level.setSimpleTween(this.base,9,{x:-52,y:-34,skX:5,scY:.82})):41===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,29,{x:11,y:-28}),e.GameManager.instance.level.setSimpleTween(this.crown,29,{x:-22,y:-48}),e.GameManager.instance.level.setSimpleTween(this.base,29,{x:-58,y:-28,skX:0,scY:.75})):70===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"idle"===e&&(this.setPart(this.eyes,{x:11,y:-28,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.crown,{x:-22,y:-48,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.base,{x:-58,y:-28,angle:0,scX:.75,scY:.75,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.game=null,this.group=null,this.base=null,this.crown=null,this.eyes=null,this.body=null,this.wheel1=null,this.wheel2=null,this.princessPart1=null,this.princessPart2=null,this.princessPart3=null,this.princessPart4=null,this.princessPart5=null,this.princessPart6=null},i}(e.BasicSimpleAnim);e.Lvl14Girl=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=498,s.group.y=204,e.GameManager.instance.layerBackground.addChild(s.group),s.part2=new e.SASprite(i,0,0,"level14","lampPart2 instance 10000"),s.part2.pivot.set(4,9),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level14","lampPart1 instance 10000"),s.part1.pivot.set(15,22),s.group.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.activate=function(){this.playAnim("anim")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,14,{x:-19,y:4,skX:46,skY:46,scX:1.02}),e.GameManager.instance.level.setSimpleTween(this.part2,14,{x:-3,y:-15,skX:27,skY:27})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,15,{x:-1,y:10,skX:0,skY:0,scX:1}),e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:0,y:-14,skX:0,skY:0})):30===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:5,y:9,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.part2,10,{x:2,y:-15,skX:-23,skY:-23})):36===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,4,{skX:-5,skY:-5}):40===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,7,{x:1,y:10,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.part2,7,{x:0,y:-14,skX:-4,skY:-4})):47===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,9,{x:-5,y:9,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.part2,9,{x:-1,skX:4,skY:4})):56===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,11,{x:-1,y:10,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,11,{x:0,skX:0,skY:0})):67===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:-1,y:10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:0,y:-14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part2=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl14Lamp=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.pressed=!1,s.game=i,s.graphic=e.GameManager.instance.layerBackground.create(515,490,"level14","lever1 instance 10000"),s.graphic.anchor.y=.5,s.graphic.pivot.x=110,s.graphic.events.onInputOut.add(s.out,s),s.graphic.events.onInputOver.add(s.over,s),s.graphic.events.onInputDown.add(s.down,s),s.graphic.events.onInputUp.add(s.up,s),s.graphic.angle=30,s.graphicPod=i.make.sprite(s.graphic.pivot.x,0,"level14","lever1pod instance 10000"),s.graphicPod.anchor.setTo(.5),s.graphicPod.angle=-30,s.graphic.addChild(s.graphicPod),s}return __extends(i,t),i.prototype.activate=function(){this.graphic.inputEnabled=!0,this.graphic.input.useHandCursor=!0,this.out()},i.prototype.deactivate=function(){this.graphic.frameName="lever1 instance 10000",this.graphic.inputEnabled=!1,this.up()},i.prototype.out=function(){!1!==this.graphic.inputEnabled&&(this.graphic.frameName="lever1 instance 10002")},i.prototype.over=function(){!1!==this.graphic.inputEnabled&&(this.graphic.frameName="lever1 instance 10001")},i.prototype.down=function(){this.pressed=!0,this.offAngle=e.Tools.angleOfPoints(this.graphic.x,this.graphic.y,this.game.input.worldX,this.game.input.worldY)-this.graphic.angle},i.prototype.up=function(){this.pressed=!1},i.prototype.update=function(){!1!==this.pressed&&(this.graphic.angle=e.Tools.angleOfPoints(this.graphic.x,this.graphic.y,this.game.input.worldX,this.game.input.worldY)-this.offAngle,this.graphic.angle>30?this.graphic.angle=30:this.graphic.angle<-40&&(this.graphic.angle=-40,e.SoundManager.playSFX("sfx_lever"),e.GameManager.instance.level.customAction(5)))},i.prototype.free=function(){this.game=null,this.graphic=null,this.graphicPod=null},i}(e.BasicElement);e.Lvl14Lever1=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n){var o=t.call(this)||this;o.pressed=!1,o.game=i,o.numLever=n,o.podStartY=a,o.graphicPod2=e.GameManager.instance.layerBackground.create(s,o.podStartY-15,"level14","lever2pod instance 10000"),o.graphicPod2.anchor.setTo(.5);var r=i.make.graphics(s-20,a-29);return r.beginFill(16711680,.4),r.drawRect(0,0,40,60),r.endFill(),e.GameManager.instance.layerBackground.addChild(r),o.graphicPod2.mask=r,o.graphicPod=e.GameManager.instance.layerBackground.create(s,a,"level14","lever2pod2 instance 10000"),o.graphicPod.anchor.setTo(.5),o.graphicPod.events.onInputOut.add(o.out,o),o.graphicPod.events.onInputOver.add(o.over,o),o.graphicPod.events.onInputDown.add(o.down,o),o.graphicPod.events.onInputUp.add(o.up,o),o.graphic=i.make.sprite(.5,-10,"level14","lever2 instance 10000"),o.graphic.anchor.setTo(.5,1),o.graphic.scale.x=.95,o.graphicPod.addChild(o.graphic),o.graphicNad=i.make.sprite(1,-95,"level14","lever2part instance 10000"),o.graphicNad.anchor.setTo(.5),o.graphicNad.visible=!1,o.graphicPod.addChild(o.graphicNad),o}return __extends(i,t),i.prototype.activate=function(){this.graphicPod.inputEnabled=!0,this.graphicPod.input.useHandCursor=!0,this.out()},i.prototype.deactivate=function(){this.graphic.frameName="lever2 instance 10000",this.graphicPod.inputEnabled=!1,this.graphicNad.frameName="lever2part instance 10000",this.up()},i.prototype.out=function(){!1!==this.graphicPod.inputEnabled&&(this.graphic.frameName="lever2 instance 10002",this.graphicNad.frameName="lever2part instance 10002")},i.prototype.over=function(){!1!==this.graphicPod.inputEnabled&&(this.graphic.frameName="lever2 instance 10001",this.graphicNad.frameName="lever2part instance 10001")},i.prototype.down=function(){this.pressed=!0,this.offY=this.game.input.worldY-this.graphicPod.y-this.graphicNad.y},i.prototype.up=function(){this.pressed=!1},i.prototype.update=function(){if(!1!==this.pressed){this.graphicNad.y=this.game.input.worldY-this.graphicPod.y-this.offY,this.graphicNad.y<-95?this.graphicNad.y=-95:this.graphicNad.y>65&&(this.graphicNad.y=65,e.SoundManager.playSFX("sfx_lever"),2===this.numLever?e.GameManager.instance.level.customAction(6):e.GameManager.instance.level.customAction(7));var t=-e.Tools.percentToF(this.graphicNad.y,95);this.graphic.y=-10*t,this.graphic.scale.y=t,t>-.65&&t<.65?(this.graphicNad.visible=!0,this.graphicNad.scale.y=1-Math.abs(t)):this.graphicNad.visible=!1,this.graphicPod2.y=this.podStartY-15*t}},i.prototype.free=function(){this.game=null,this.graphic=null,this.graphicNad=null,this.graphicPod=null,this.graphicPod2=null},i}(e.BasicElement);e.Lvl14Lever2=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=513,s.group.y=494,e.GameManager.instance.layerBackground.addChild(s.group),s.part11=new e.SASprite(i,0,0,"level14","pipePart11 instance 10000"),s.part11.pivot.y=1,s.group.addChild(s.part11),s.part10=new e.SASprite(i,0,0,"level14","pipePart10 instance 10000"),s.part10.pivot.set(34,22),s.group.addChild(s.part10),s.part9=new e.SASprite(i,0,0,"level14","pipePart9 instance 10000"),s.part9.pivot.set(15,31),s.group.addChild(s.part9),s.part8=new e.SASprite(i,0,0,"level14","pipePart8 instance 10000"),s.part8.pivot.set(15,8),s.group.addChild(s.part8),s.part7=new e.SASprite(i,0,0,"level14","pipePart7 instance 10000"),s.part7.pivot.set(19,15),s.group.addChild(s.part7),s.part6=new e.SASprite(i,0,0,"level14","pipePart6 instance 10000"),s.part6.pivot.set(13,13),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level14","pipePart5 instance 10000"),s.part5.pivot.set(7,10),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level14","pipePart4 instance 10000"),s.part4.pivot.set(13,12),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level14","pipePart3 instance 10000"),s.part3.pivot.set(15,11),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level14","pipePart2 instance 10000"),s.part2.pivot.set(7,10),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level14","pipePart1 instance 10000"),s.part1.pivot.set(4,8),s.group.addChild(s.part1),s.setParts("anim"),s.magicSmoke=e.GameManager.instance.layerUpper.create(175,148,"level14"),s.magicSmoke.scale.setTo(1.82),s.magicSmoke.animations.add("anim",Phaser.Animation.generateFrameNames("magicSmoke instance 1",0,25,"",4),30,!1).onComplete.addOnce(s.magicSmokeComp,s),s.magicSmoke.animations.add("anim2",Phaser.Animation.generateFrameNames("magicSmoke instance 1",26,55,"",4),30,!1).killOnComplete=!0,s.magicSmoke.visible=!1,s}return __extends(i,t),i.prototype.magicSmokeComp=function(){e.GameManager.instance.level.customAction(4),this.magicSmoke.animations.play("anim2")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:24,y:43,skX:6,scY:.73}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:41,y:26,scX:1.13,scY:1.13}),e.GameManager.instance.level.setSimpleTween(this.part9,4,{x:38,y:-11,skX:-4,skY:-4,scY:1.26}),e.GameManager.instance.level.setSimpleTween(this.part10,4,{x:15,y:40,skX:4,skY:4})):8===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,2,{x:28,y:-43,skX:-3,skY:-3}):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:23,y:40,skX:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:40,y:20,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part4,3,{x:27,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.part9,4,{x:37,skX:-3,skY:-3,scY:1.2}),e.GameManager.instance.level.setSimpleTween(this.part10,4,{x:13,y:37,skX:0,skY:0})):12===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:7,skX:-6,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.part8,5,{x:11,skX:-3,skY:-10,scX:1.51})):13===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,4,{y:-44,skX:1,skY:1,scX:1.09,scY:1.06}):14===this.counterAnim?(this.setPart(this.part2,{x:23,y:40,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:40,y:20,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part5,6,{x:-6,y:-48,skX:-1,skY:-1,scX:1.09,scY:1.09}),e.GameManager.instance.level.setSimpleTween(this.part9,3,{x:35,y:-13,skX:1,skY:4,scY:1.07}),this.setPart(this.part10,{x:13,y:37,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part6,4,{x:-43,y:-66,skX:-5,skY:-8,scY:1.05}),e.GameManager.instance.level.setSimpleTween(this.part7,4,{y:-55,skX:-5,skY:-8,scX:.96})):17===this.counterAnim?(this.setPart(this.part1,{x:7,y:-37,angle:0,scX:1,scY:.98,skX:-6,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part4,6,{y:-42,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part9,3,{y:-12,skX:0,skY:0,scY:1})):20===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,3,{x:8,skX:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part5,4,{x:-5,y:-51,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part6,5,{x:-45,y:-74,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part7,5,{y:-59,skX:0,skY:0,scX:1}),e.GameManager.instance.level.setSimpleTween(this.part8,3,{x:13,skX:0,skY:0,scX:1}),this.setPart(this.part9,{x:35,y:-12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):23===this.counterAnim?(this.setPart(this.part1,{x:8,y:-37,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:27,y:-42,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part8,{x:13,y:-48,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):24===this.counterAnim?this.setPart(this.part5,{x:-5,y:-51,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):25===this.counterAnim&&(this.animComplete(),this.magicSmoke.visible=!0,this.magicSmoke.animations.play("anim"),e.SoundManager.playSFX("s_dust"))))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:8,y:-37,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:23,y:40,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:40,y:20,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:27,y:-42,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part5,{x:-5,y:-51,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part6,{x:-45,y:-74,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part7,{x:-23,y:-59,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part8,{x:13,y:-48,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part9,{x:35,y:-12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part10,{x:13,y:37,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part11,{x:-32,y:30,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part11=null,this.part10=null,this.part9=null,this.part8=null,this.part7=null,this.part6=null,this.part5=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null,this.magicSmoke=null},i}(e.BasicSimpleAnim);e.Lvl14Pipe=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.active=!1,s.endY=267,s.bodyStop=!1,s.counter=0,s.graphic=e.GameManager.instance.layerBackground.create(635,480,"level14","press instance 10000"),s.graphic.anchor.setTo(.5),s.body=new Phaser.Physics.Box2D.Body(i,null,635,480,1),s.body.setRectangle(160,166),s.dust=e.GameManager.instance.layerUpper.create(530,183,"level14"),s.dust.animations.add("anim",Phaser.Animation.generateFrameNames("pressDust instance 1",0,26,"",4),30,!1).killOnComplete=!0,s.dust.visible=!1,s}return __extends(i,t),i.prototype.start=function(){this.active=!0,this.body.velocity.y=-150},i.prototype.update=function(){!1!==this.active&&(this.counter+=1,40===this.counter&&e.SoundManager.playSFX("s_pressMove"),this.body.y>this.endY+60?this.graphic.y=this.body.y-2:(!1===this.bodyStop&&(this.body.velocity.y=0,e.GameManager.instance.level.customAction(8)),this.graphic.y-=2.5,this.graphic.y<=this.endY&&(this.active=!1,this.graphic.y=this.endY,this.dust.visible=!0,this.dust.animations.play("anim"),e.GameManager.instance.level.customAction(3))))},i.prototype.free=function(){this.body=null,this.graphic=null,this.dust=null},i}(e.BasicElement);e.Lvl14Press=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n){var o=t.call(this)||this;if(o.bodysActive=!1,o.currSideNum=n,o.partBot=e.GameManager.instance.layerBackground.create(s,a,"level14","tree3 instance 10000"),i.physics.box2d.enable(o.partBot),o.partBot.body.setRectangle(90,66),o.partBot.body.sensor=!0,o.partBot.body.static=!0,o.partBot.inputEnabled=!0,o.partBot.events.onInputDown.addOnce(o.down,o),o.partBot.events.onInputOut.add(o.out,o),o.partBot.events.onInputOver.add(o.over,o),o.partMid=e.GameManager.instance.layerBackground.create(s-3,a-53,"level14","tree2 instance 10000"),i.physics.box2d.enable(o.partMid),o.partMid.body.setRectangle(70,40),o.partMid.body.sensor=!0,o.partMid.body.static=!0,o.partMid.body.data.SetUserData("DragBody"),o.partMid.inputEnabled=!0,o.partMid.events.onInputDown.addOnce(o.down,o),o.partMid.events.onInputOut.add(o.out,o),o.partMid.events.onInputOver.add(o.over,o),o.partTop=e.GameManager.instance.layerBackground.create(s+1,a-110,"level14","tree1 instance 10000"),i.physics.box2d.enable(o.partTop),o.partTop.body.setRectangle(48,60,0,7),o.partTop.body.sensor=!0,o.partTop.body.static=!0,o.partTop.body.data.SetUserData("DragBody"),o.partTop.inputEnabled=!0,o.partTop.events.onInputDown.addOnce(o.down,o),o.partTop.events.onInputOut.add(o.out,o),o.partTop.events.onInputOver.add(o.over,o),1===n)o.partMid.body.x=s+3,o.partMid.body.y=a-53,o.partMid.body.angle=12,o.partTop.body.x=s+20,o.partTop.body.y=a-107,o.partTop.body.angle=12,i.physics.box2d.revoluteJoint(o.partBot,o.partMid,-3,-33,0,20,0,0,!1,-25,35,!0),i.physics.box2d.revoluteJoint(o.partMid,o.partTop,3,-20,0,37,0,0,!1,-15,15,!0);else if(2===n){var r=new Phaser.Physics.Box2D.Body(i,null,s,a+48,0);r.setRectangle(90,30),r.sensor=!0,o.partBot.body.data.SetUserData("DragBody"),i.physics.box2d.revoluteJoint(r,o.partBot,0,-15,0,33,0,0,!1,-20,20,!0),i.physics.box2d.revoluteJoint(o.partBot,o.partMid,-3,-33,0,20,0,0,!1,-30,30,!0),i.physics.box2d.revoluteJoint(o.partMid,o.partTop,3,-20,0,37,0,0,!1,-20,20,!0),r=null}else 3===n&&(o.partMid.body.x=s-8,o.partMid.body.y=a-53,o.partMid.body.angle=-12,o.partTop.body.x=s-15,o.partTop.body.y=a-107,o.partTop.body.angle=-12,i.physics.box2d.revoluteJoint(o.partBot,o.partMid,-3,-33,0,20,0,0,!1,-35,25,!0),i.physics.box2d.revoluteJoint(o.partMid,o.partTop,3,-20,0,37,0,0,!1,-15,15,!0));return o}return __extends(i,t),i.prototype.out=function(){this.partBot.frameName="tree3 instance 10000",this.partMid.frameName="tree2 instance 10000",this.partTop.frameName="tree1 instance 10000"},i.prototype.over=function(){this.partBot.frameName="tree3 instance 10001",this.partMid.frameName="tree2 instance 10001",this.partTop.frameName="tree1 instance 10001"},i.prototype.down=function(){!0!==this.bodysActive&&(this.bodysActive=!0,2===this.currSideNum&&(this.partBot.body.dynamic=!0),this.partMid.body.dynamic=!0,this.partTop.body.dynamic=!0,e.GameManager.instance.level.customAction(1))},i.prototype.free=function(){this.partBot=null,this.partMid=null,this.partTop=null},i}(e.BasicElement);e.Lvl14Tree=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.leverPressed=0,s.bridgeEndL=291,s.bridgeEndR=418,s.bridgeMoving=0,s.game=i,s.lever=e.GameManager.instance.layerBackground.create(353,420,"level2","bridgeLever instance 10000"),s.lever.anchor.setTo(.42,.95),s.lever.inputEnabled=!0,s.lever.input.useHandCursor=!0,s.lever.events.onInputOut.add(s.leverOut,s),s.lever.events.onInputOver.add(s.leverOver,s),s.lever.events.onInputDown.add(s.leverDown,s),s.lever.events.onInputUp.add(s.leverUp,s),s.bridgeRopeL2=e.GameManager.instance.layerBackground.create(365,420,"level2","bridgeRope2 instance 10000"),s.bridgeRopeL2.anchor.setTo(1,.5),s.bridgeRopeL2.angle=-5,s.bridgeRopeL2.animations.add("forward",Phaser.Animation.generateFrameNames("bridgeRope2 instance 1",0,14,"",4),50,!0),s.bridgeRopeL2.animations.add("backward",Phaser.Animation.generateFrameNames("bridgeRope2 instance 1",14,0,"",4),50,!0),s.bridgeRopeR2=e.GameManager.instance.layerBackground.create(349,420,"level2","bridgeRope2 instance 10000"),s.bridgeRopeR2.anchor.setTo(0,.5),s.bridgeRopeR2.angle=5,s.bridgeRopeR2.animations.add("forward",Phaser.Animation.generateFrameNames("bridgeRope2 instance 1",0,14,"",4),50,!0),s.bridgeRopeR2.animations.add("backward",Phaser.Animation.generateFrameNames("bridgeRope2 instance 1",14,0,"",4),50,!0),s.gear=e.GameManager.instance.layerBackground.create(340,436,"level2","bridgeGear instance 10000"),s.gear.anchor.setTo(.5),s.part=e.GameManager.instance.layerBackground.create(353,425,"level2","bridgePart instance 10000"),s.part.anchor.setTo(.55,.105),s.bridgeRopeL=e.GameManager.instance.layerUpper.create(309,454,"level2","bridgeRope instance 10000"),s.bridgeRopeL.anchor.setTo(1,.5),s.bridgeRopeL.angle=4,s.bridgeRopeR=e.GameManager.instance.layerUpper.create(398,454,"level2","bridgeRope instance 10000"),s.bridgeRopeR.anchor.setTo(0,.5),s.bridgeRopeR.angle=-4;var a=s.game.make.graphics(353,400);return a.beginFill(16711680,.5),a.drawRect(-150,0,310,200),a.endFill(),e.GameManager.instance.layerUpper.add(a),s.bridgeRopeL.mask=a,s.bridgeRopeR.mask=a,a=null,s.bridge=e.GameManager.instance.layerUpper.create(s.bridgeEndR,459,"level2","bridge instance 10000"),s.game.physics.box2d.enable(s.bridge),s.bridge.body.setRectangle(148,20,0,14),s.bridge.body.kinematic=!0,s.updateRope(),s}return __extends(i,t),i.prototype.leverOut=function(){!1!==this.lever.inputEnabled&&(this.lever.frameName="bridgeLever instance 10000")},i.prototype.leverOver=function(){!1!==this.lever.inputEnabled&&(this.lever.frameName="bridgeLever instance 10001")},i.prototype.deactivate=function(){this.lever.inputEnabled=!1,this.lever.frameName="bridgeLever instance 10002",this.leverUp()},i.prototype.leverDown=function(){this.leverPressed=1,e.SoundManager.playSFX("s_bridge",!0)},i.prototype.leverUp=function(){this.leverPressed=2,this.bridge.body.velocity.x=0,this.bridgeMoving=0,this.bridgeRopeL2.animations.stop(),this.bridgeRopeR2.animations.stop(),e.SoundManager.stopSFXLoop("s_bridge")},i.prototype.update=function(){if(0!==this.leverPressed)if(1===this.leverPressed){var t=Math.atan2(this.lever.y-this.game.input.worldY,this.lever.x-this.game.input.worldX);this.lever.angle=e.Tools.toDeg(t)-90,this.lever.angle>0?(this.lever.angle>60&&(this.lever.angle=60),this.bridgeMoving>=0&&this.bridge.body.x>this.bridgeEndL?(this.bridge.body.velocity.x=-60,this.bridgeMoving=-1,this.bridgeRopeL2.animations.play("forward"),this.bridgeRopeR2.animations.play("forward")):-1===this.bridgeMoving&&(this.gear.angle+=3,this.bridge.body.x<=this.bridgeEndL&&(this.bridge.body.x=this.bridgeEndL,this.bridge.body.velocity.x=0,this.bridgeMoving=-2,this.bridgeRopeL2.animations.stop(),this.bridgeRopeR2.animations.stop(),e.SoundManager.stopSFXLoop("s_bridge")))):this.lever.angle<0&&(this.lever.angle<-60&&(this.lever.angle=-60),this.bridgeMoving<=0&&this.bridge.body.x<this.bridgeEndR?(this.bridge.body.velocity.x=60,this.bridgeMoving=1,this.bridgeRopeL2.animations.play("backward"),this.bridgeRopeR2.animations.play("backward")):1===this.bridgeMoving&&(this.gear.angle-=3,this.bridge.body.x>=this.bridgeEndR&&(this.bridge.body.x=this.bridgeEndR,this.bridge.body.velocity.x=0,this.bridgeMoving=2,this.bridgeRopeL2.animations.stop(),this.bridgeRopeR2.animations.stop(),e.SoundManager.stopSFXLoop("s_bridge")))),1===Math.abs(this.bridgeMoving)&&this.updateRope()}else 2===this.leverPressed&&(this.lever.angle<0?this.lever.angle+=3:this.lever.angle-=3,Math.abs(this.lever.angle)<4&&(this.lever.angle=0,this.leverPressed=0))},i.prototype.updateRope=function(){this.bridgeRopeL.x=this.bridge.body.x-44,this.bridgeRopeR.x=this.bridge.body.x+45,this.bridgeRopeL.y=this.bridgeRopeR.y=this.bridge.body.y-5;var t=e.Tools.roundDec((this.bridge.body.x-this.bridgeEndL)/(this.bridgeEndR-this.bridgeEndL),2);this.bridgeRopeL.angle=4-3*t,this.bridgeRopeR.angle=-5+this.bridgeRopeL.angle},i.prototype.free=function(){this.game=null,this.part=null,this.lever=null,this.gear=null,this.bridge=null,this.bridgeRopeL=null,this.bridgeRopeR=null,this.bridgeRopeL2=null,this.bridgeRopeR2=null},i}(e.BasicElement);e.Lvl2Bridge=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.wheel2Connectd=!1,s.thinkShowed=0,s.counterThink=0,s.counterConnect=0,s.game=i,s.graphic=e.GameManager.instance.layerBackground.create(620,415,"level2","carBody instance 10000"),s.game.physics.box2d.enable(s.graphic),s.graphic.body.setRectangle(142,68),s.graphic.body.setCollisionCategory(e.FilterGroups.CAR1),s.graphic.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),s.graphicEyes=s.game.make.sprite(0,-60,"level2"),s.graphicEyes.animations.add("idle",Phaser.Animation.generateFrameNames("carEye instance 1",0,113,"",4),30,!0),s.graphicEyes.animations.add("surprise",Phaser.Animation.generateFrameNames("carEye instance 1",114,139,"",4),30,!1).onComplete.addOnce(function(){this.graphicEyes.animations.play("idle")},s),s.graphicEyes.animations.play("idle"),s.graphic.addChild(s.graphicEyes),s.wheel1=e.GameManager.instance.layerBackground.create(573,452,"level2","wheel1 instance 10000"),s.game.physics.box2d.enable(s.wheel1),s.wheel1.body.setCircle(17),s.wheel1.body.setCollisionCategory(e.FilterGroups.CAR1),s.wheel1.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),s.wheel1.body.friction=1.5,s.game.physics.box2d.revoluteJoint(s.graphic,s.wheel1,-47,37),s.wheel2Contact=new Phaser.Physics.Box2D.Body(s.game,null,645,452,2),s.wheel2Contact.setCircle(5),s.wheel2Contact.sensor=!0,s.game.physics.box2d.revoluteJoint(s.graphic,s.wheel2Contact,25,37),s.wheel2=e.GameManager.instance.layerElements.create(750,444,"level2","wheel2 instance 10000"),s.game.physics.box2d.enable(s.wheel2),s.wheel2.body.setCircle(17),s.wheel2.body.data.SetUserData("DragBody"),s.wheel2.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),s.wheel2.inputEnabled=!0,s.wheel2.input.useHandCursor=!0,s.wheel2.events.onInputOut.add(function(){!0===this.wheel2.inputEnabled&&(this.wheel2.frameName="wheel2 instance 10000")},s),s.wheel2.events.onInputOver.add(function(){!0===this.wheel2.inputEnabled&&(this.wheel2.frameName="wheel2 instance 10001")},s),s.wheel2Contact.setBodyContactCallback(s.wheel2,s.connectWheel,s),s.graphic.body.angle=10,s.bodyStopper=new Phaser.Physics.Box2D.Body(s.game,null,550,400,1),s.bodyStopper.setRectangle(10,100),s.bodyStopper.setCollisionCategory(e.FilterGroups.CAR1),s.bodyStopper.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,s.showThink2,s),s.think=e.GameManager.instance.layerElements.create(660,300,"level2"),s.think.animations.add("anim1",Phaser.Animation.generateFrameNames("think instance 1",0,9,"",4),30,!1).onComplete.add(s.showPart2AnimThink,s),s.think.animations.add("anim2",Phaser.Animation.generateFrameNames("think instance 1",10,51,"",4),30,!1).onComplete.add(function(){this.think.visible=!1},s),s.think.visible=!1,s}return __extends(i,t),i.prototype.showPart2AnimThink=function(){this.think.animations.play("anim2");var e;1===this.thinkShowed?e=this.game.make.sprite(51,51,"level2","thinkWheel instance 10000"):2===this.thinkShowed&&(e=this.game.make.sprite(53,50,"level2","thinkRepair instance 10000")),e.anchor.setTo(.5),this.think.addChild(e),e=null},i.prototype.showThink1=function(){if(!0!==this.wheel2Connectd){this.thinkShowed+=1;for(var e=0;e<this.think.children.length;e++)this.think.removeChildAt(e);this.think.animations.play("anim1"),this.think.visible=!0}},i.prototype.showThink2=function(){0===this.counterThink&&(this.counterThink=1,this.showThink1())},i.prototype.update=function(){1===this.counterConnect?(this.counterConnect=2,this.graphicEyes.animations.play("surprise"),this.graphic.body.angle=-3,this.wheel2.body.velocity.x=this.wheel2.body.velocity.y=this.wheel2.body.angularVelocity=0,this.wheel2.body.x=this.graphic.body.x+25,this.wheel2.body.y=this.graphic.body.y+37,this.game.physics.box2d.revoluteJoint(this.graphic,this.wheel2,25,37),this.wheel2.body.data.SetUserData(null),this.wheel2.inputEnabled=!1,this.wheel2.frameName="wheel2 instance 10002",e.GameManager.instance.level.customAction(1),this.wheel2.body.collideWorldBounds=!1,this.graphic.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.wheel1.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.graphic.body.collideWorldBounds=!1,this.wheel1.body.collideWorldBounds=!1,this.wheel2Connectd=!0,this.bodyStopper.destroy(),e.SoundManager.playSFX("sfx_wheel"),e.SoundManager.playSFX("sfx_dry",!0)):2===this.counterConnect&&(this.graphic.body.velocity.x=100,this.wheel1.body.angularVelocity=8,this.wheel2.body.angularVelocity=8,this.graphic.body.x>850&&(this.counterConnect=3,e.SoundManager.stopSFXLoop("sfx_dry")))},i.prototype.connectWheel=function(){0===this.counterConnect&&(this.counterConnect=1)},i.prototype.free=function(){this.game=null,this.graphic=null,this.wheel1=null,this.wheel2=null,this.wheel2Contact=null,this.graphicEyes=null,this.bodyStopper=null,this.think=null},i}(e.BasicElement);e.Lvl2Peasant=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.active=!1,s.counter=0,s.light=e.GameManager.instance.layerBackground.create(315,473,"level3","doorLight instance 10000"),s.mask=i.make.graphics(s.light.width/2,-5),s.mask.beginFill(16711680,0),s.mask.drawRect(0,0,0,0),s.mask.endFill(),s.light.addChild(s.mask),s.light.mask=s.mask,s.doorLeft=e.GameManager.instance.layerUpper.create(311,478,"level3","door instance 10000"),s.doorLeft.anchor.setTo(0,.5),s.doorRight=e.GameManager.instance.layerUpper.create(500,478,"level3","door instance 10000"),s.doorRight.anchor.setTo(0,.5),s.doorRight.scale.x=-1;var a=e.GameManager.instance.layerUpper.create(311,480,"level3","doorCircle instance 10000");return a.anchor.setTo(.5),a.cacheAsBitmap=!0,(a=e.GameManager.instance.layerUpper.create(500,480,"level3","doorCircle instance 10000")).anchor.setTo(.5),a.scale.x=-1,a.cacheAsBitmap=!0,a=null,s.body=new Phaser.Physics.Box2D.Body(i,null,405,484,1),s.body.setRectangle(200,20),s}return __extends(i,t),i.prototype.open=function(){this.active=!0,this.body.y=589},i.prototype.update=function(){!1!==this.active&&(this.counter+=1,1===this.counter?(e.GameManager.instance.level.setSimpleTween(this.doorLeft,19,{angle:81}),e.GameManager.instance.level.setSimpleTween(this.doorRight,19,{angle:-81})):20===this.counter?(e.GameManager.instance.level.setSimpleTween(this.doorLeft,5,{angle:77}),e.GameManager.instance.level.setSimpleTween(this.doorRight,5,{angle:-77})):25===this.counter?(e.GameManager.instance.level.setSimpleTween(this.doorLeft,5,{angle:81}),e.GameManager.instance.level.setSimpleTween(this.doorRight,5,{angle:-81})):30===this.counter&&(this.active=!1),this.drawMask(e.Tools.percentToF(this.doorLeft.angle,81)))},i.prototype.drawMask=function(e){this.mask.clear(),this.mask.beginFill(16711680,.5),this.mask.drawTriangle([new Phaser.Point(-95,0),new Phaser.Point(95,0),new Phaser.Point(80*e,80*e),new Phaser.Point(75*e,130),new Phaser.Point(-75*e,130),new Phaser.Point(-80*e,80*e)]),this.mask.endFill()},i.prototype.free=function(){this.doorLeft=null,this.doorRight=null,this.light=null,this.mask=null,this.body=null},i}(e.BasicElement);e.Lvl3Door=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function a(a){var n=t.call(this,a)||this;return n.group=new e.SAGroup(a,875,-218),e.GameManager.instance.layerUpper.addChild(n.group),n.dragonWing2=new i(a,"_1"),n.group.addChild(n.dragonWing2.group),n.dragonLeg1_1=new e.SASprite(a,0,0,"dragon","dragonLeg1_1 instance 10000"),n.dragonLeg1_1.pivot.set(56,42),n.group.addChild(n.dragonLeg1_1),n.dragonLeg2_1=new e.SASprite(a,0,0,"dragon","dragonLeg2_1 instance 10000"),n.dragonLeg2_1.pivot.set(46,47),n.group.addChild(n.dragonLeg2_1),n.dragonBase=new e.SASprite(a,0,0,"dragon","dragonBase instance 10000"),n.dragonBase.pivot.set(61,39),n.group.addChild(n.dragonBase),n.dragonTail1=new e.SASprite(a,0,0,"dragon","dragonTail1 instance 10000"),n.dragonTail1.pivot.set(27,28),n.group.addChild(n.dragonTail1),n.dragonTail2=new e.SASprite(a,0,0,"dragon","dragonTail2 instance 10000"),n.dragonTail2.pivot.set(20,21),n.group.addChild(n.dragonTail2),n.dragonTail3=new e.SASprite(a,0,0,"dragon","dragonTail3 instance 10000"),n.dragonTail3.pivot.set(19,12),n.group.addChild(n.dragonTail3),n.dragonTail4=new e.SASprite(a,0,0,"dragon","dragonTail4 instance 10000"),n.dragonTail4.pivot.set(18,14),n.group.addChild(n.dragonTail4),n.dragonTail5=new e.SASprite(a,0,0,"dragon","dragonTail5 instance 10000"),n.dragonTail5.pivot.set(16,12),n.group.addChild(n.dragonTail5),n.dragonTail6=new e.SASprite(a,0,0,"dragon","dragonTail6 instance 10000"),n.dragonTail6.pivot.set(14,43),n.group.addChild(n.dragonTail6),n.dragonNeck3=new e.SASprite(a,0,0,"dragon","dragonNeck3 instance 10000"),n.dragonNeck3.pivot.set(23,36),n.group.addChild(n.dragonNeck3),n.dragonNeck2=new e.SASprite(a,0,0,"dragon","dragonNeck2 instance 10000"),n.dragonNeck2.pivot.set(23,38),n.group.addChild(n.dragonNeck2),n.dragonNeck1=new e.SASprite(a,0,0,"dragon","dragonNeck1 instance 10000"),n.dragonNeck1.pivot.set(19,29),n.group.addChild(n.dragonNeck1),n.dragonHead=new e.SASprite(a,0,0,"dragon","dragonHead instance 10000"),n.dragonHead.pivot.set(49,27),n.group.addChild(n.dragonHead),n.dragonEye=a.make.sprite(36,6,"dragon"),n.dragonEye.animations.add("anim",Phaser.Animation.generateFrameNames("dragonEye instance 1",0,0,"",4),30,!1),n.dragonEye.animations.add("anim2",Phaser.Animation.generateFrameNames("dragonEye instance 1",1,84,"",4),30,!0),n.dragonEye.animations.play("anim2"),n.dragonHead.addChild(n.dragonEye),n.princess=new e.Lvl3Princess(a),n.group.addChild(n.princess.group),n.dragonLeg1_2=new e.SASprite(a,0,0,"dragon","dragonLeg1_2 instance 10000"),n.dragonLeg1_2.pivot.set(56,42),n.group.addChild(n.dragonLeg1_2),n.dragonLeg2_2=new e.SASprite(a,0,0,"dragon","dragonLeg2_2 instance 10000"),n.dragonLeg2_2.pivot.set(46,47),n.group.addChild(n.dragonLeg2_2),n.dragonSeddle=new e.SASprite(a,0,0,"dragon","dragonSeddle instance 10000"),n.dragonSeddle.pivot.set(57,24),n.group.addChild(n.dragonSeddle),n.dragonMage=new s(a),n.group.addChild(n.dragonMage.group),n.dragonWing1=new i(a),n.group.addChild(n.dragonWing1.group),n.setParts("appear"),n}return __extends(a,t),a.prototype.playAppear=function(){this.playAnim("appear"),this.dragonMage.play()},a.prototype.update=function(){t.prototype.update.call(this),this.dragonWing1.update(),this.dragonWing2.update(),this.dragonMage.update(),this.princess.update()},a.prototype.onAnimComplete=function(){"appear"===this.currAnim?(e.GameManager.instance.level.customAction(2),this.princess.activate(),this.playAnim("dragon_cycle"),this.dragonWing1.playAnim("anim",3),this.dragonWing2.playAnim("anim",3)):"dragon_cycle"===this.currAnim?(e.GameManager.instance.level.customAction(3),this.playAnim("attack2"),this.dragonMage.playCast()):"attack2"===this.currAnim?this.playAnim("princess"):"princess"===this.currAnim&&(this.group.visible=!1,e.SoundManager.playSFX("levelWin"),e.LevelBuilder.instance.levelComplete())},a.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"appear"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,14,{x:-31,y:377,skX:44,skY:44}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,14,{x:-50,y:296,skX:-33,skY:-33}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,14,{x:-25,y:360,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,14,{x:44,y:406,skX:-40,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,14,{x:-12,y:431,skX:-48,skY:-47}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,14,{x:-148,y:381,skX:-30,skY:-30}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,14,{x:-117,y:386,skX:-113,skY:-113}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,14,{x:-87,y:380,skX:-114,skY:-114}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,14,{x:-67,y:390,skX:-47,skY:-47}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,14,{x:155,y:308,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,14,{x:131,y:349,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,14,{x:109,y:357,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,14,{x:85,y:366,skX:-23,skY:-23}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,14,{x:60,y:367,skX:-49,skY:-49}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,14,{x:31,y:368,skX:-46,skY:-46}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,14,{x:-14,y:393,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,14,{x:26,y:411,skX:-39,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,14,{x:-23,y:437,skX:-49,skY:-49}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,14,{x:-56,y:382,skX:25,skY:25})):15===this.counterAnim?(e.SoundManager.playSFX("sfx_crowdSurprized"),e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,15,{x:-90,y:425,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,15,{x:-77,y:342,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,15,{x:-78,y:412,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,15,{x:-30,y:479,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,15,{x:-102,y:479,skX:-9,skY:-8,scY:.75}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,15,{x:-189,y:374,skX:-33,skY:-33}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,15,{x:-168,y:393,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,15,{x:-141,y:412,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,15,{x:-129,y:424,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,15,{x:113,y:430,skX:34,skY:34}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,15,{x:75,y:459,skX:22,skY:22}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,15,{x:52,y:458,skX:11,skY:11}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,15,{x:27,y:457,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,15,{x:-2,y:451,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,15,{x:-29,y:440,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,15,{x:-80,y:446,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,15,{x:-50,y:478,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,15,{x:-105,y:476,skX:8,skY:8,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,15,{x:-116,y:420,skX:-1,skY:-1})):30===this.counterAnim&&this.animComplete():"dragon_cycle"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,22,{y:444}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,22,{y:361}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,22,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,22,{x:-32,y:499,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,22,{x:-93,y:501,skX:-26,skY:-25,scY:.88}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,22,{y:393}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,22,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,22,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,22,{y:443}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,22,{y:449}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,22,{y:478}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,22,{y:477}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,22,{y:476}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,22,{y:470}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,22,{y:459}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,22,{y:465}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,22,{y:497,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,22,{x:-106,y:502,skX:-27,skY:-27,scY:.89}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,22,{y:439})):23===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,22,{y:425}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,22,{y:342}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,22,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,22,{x:-30,y:479,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,22,{x:-90,y:480,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,22,{y:374}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,22,{y:393}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,22,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,22,{y:424}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,22,{y:430}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,22,{y:459}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,22,{y:458}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,22,{y:457}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,22,{y:451}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,22,{y:440}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,22,{y:446}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,22,{y:478}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,22,{y:483,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,22,{y:420})):45===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,19,{y:444}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,19,{y:360}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,19,{y:430}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,19,{x:-32,y:499,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,19,{x:-93,y:500,skX:-26,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,19,{y:392}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,19,{y:411}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,19,{y:430}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,19,{y:442}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,19,{y:448}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,19,{y:477}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,19,{y:476}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,19,{y:475}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,19,{y:469,scX:.93,scY:.93}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,19,{y:459}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,19,{y:465}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,19,{y:496}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,19,{y:501,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,19,{y:438})):64===this.counterAnim&&this.animComplete():"attack2"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,20,{x:-83,y:361,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,20,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,20,{y:501}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,20,{y:393}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,20,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,20,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,20,{y:443}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,20,{y:449}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,20,{y:478}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,20,{y:477}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,20,{y:476}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,20,{y:470,scX:.94,scY:.94}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,20,{y:497}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,20,{y:502}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,20,{y:439})):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,27,{y:425}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,27,{y:343}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,27,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,27,{x:-30,y:479,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,27,{x:-90,y:480,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,27,{y:374}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,27,{y:393}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,27,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,27,{y:424}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,27,{y:430}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,27,{y:459}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,27,{y:458}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,27,{y:457}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,27,{y:451}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,27,{y:440}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,27,{y:446}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,27,{y:478}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,27,{y:483,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,27,{y:420})):48===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,19,{y:444}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,19,{x:-76,y:366,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,19,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,19,{x:-32,y:499,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,19,{x:-93,y:501,skX:-26,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,19,{y:393}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,19,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,19,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,19,{y:443}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,19,{y:449}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,19,{y:478}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,19,{y:477}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,19,{y:476}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,19,{y:470}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,19,{y:459}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,19,{y:465}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,19,{y:497}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,19,{y:502,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,19,{y:439})):67===this.counterAnim&&this.animComplete():"princess"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,22,{x:-206,y:415,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,22,{x:-213,y:336,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,22,{x:-199,y:399,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,22,{x:-134,y:451,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,22,{x:-192,y:470,skX:-43,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,22,{x:-316,y:395,skX:-50,skY:-50}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,22,{x:-290,y:407,skX:-75,skY:-75}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,22,{x:-259,y:417,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,22,{x:-244,y:425,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,22,{x:-11,y:360,skX:17,skY:17}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,22,{x:-39,y:399,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,22,{x:-61,y:405,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,22,{x:-85,y:411,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,22,{x:-115,y:414,skX:-43,skY:-43}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,22,{x:-144,y:412,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,22,{x:-191,y:432,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,22,{x:-153,y:454,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,22,{x:-230,y:463,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,22,{x:-232,y:418,skX:-28,skY:-28})):23===this.counterAnim?(e.SoundManager.playSFX("sfx_princess"),e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,14,{x:-209,y:403,skX:44,skY:44}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,14,{x:-206,y:323,skX:-15,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,14,{x:-200,y:388,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,14,{x:-142,y:447,skX:-28,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,14,{x:-201,y:459,skX:-36,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,14,{x:-315,y:370,skX:-43,skY:-43}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,14,{x:-291,y:385,skX:-68,skY:-68}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,14,{x:-261,y:399,skX:-51,skY:-51}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,14,{x:-247,y:408,skX:-35,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,14,{x:-8,y:371,skX:24,skY:24}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,14,{x:-41,y:406,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,14,{x:-63,y:409,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,14,{x:-88,y:413,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,14,{x:-118,y:412,skX:-37,skY:-37}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,14,{x:-146,y:407,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,14,{x:-196,y:422,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,14,{x:-160,y:448,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,14,{x:-262,y:447,skX:25,skY:25}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,14,{x:-235,y:403,skX:14,skY:14})):37===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,5,{x:-264,y:406,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,5,{x:-270,y:327,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,5,{x:-256,y:390,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,5,{x:-191,y:442,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,5,{x:-269,y:471,skX:-2,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.princess.group,10,{x:-250,y:447,skX:6,skY:-174}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,5,{x:-373,y:386,skX:-50,skY:-50}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,5,{x:-347,y:398,skX:-75,skY:-75}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,5,{x:-316,y:408,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,5,{x:-301,y:416,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,5,{x:-68,y:351,skX:17,skY:17}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,5,{x:-96,y:390,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,5,{x:-118,y:396,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,5,{x:-142,y:402,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,5,{x:-172,y:405,skX:-43,skY:-43}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,5,{x:-201,y:403,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,5,{x:-248,y:423,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,5,{x:-210,y:445,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,5,{x:-298,y:453,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,5,{x:-289,y:409,skX:-18,skY:-18})):42===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,14,{x:-306,y:281,skX:117,skY:117}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,14,{x:-280,y:206,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,14,{x:-292,y:270,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,14,{x:-258,y:346,skX:-7,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,14,{x:-312,y:329,skX:-14,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,14,{x:-394,y:213,skX:-23,skY:-23}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,14,{x:-377,y:236,skX:-48,skY:-48}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,14,{x:-353,y:259,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,14,{x:-344,y:273,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,14,{x:-106,y:322,skX:45,skY:45}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,14,{x:-149,y:343,skX:32,skY:32}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,14,{x:-171,y:339,skX:21,skY:21}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,14,{x:-196,y:333,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,14,{x:-224,y:322,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,14,{x:-248,y:307,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,14,{x:-300,y:304,skX:8,skY:8}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,14,{x:-276,y:341,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,14,{x:-344,y:317,skX:-22,skY:-22}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,14,{x:-330,y:272,skX:90,skY:90})):47===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.princess.group,9,{x:-272,y:394,skX:32,skY:-148}):56===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,14,{x:-305,y:276,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,14,{x:-279,y:201}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,14,{x:-291,y:265}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,14,{x:-257,y:341}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,14,{x:-311,y:324}),e.GameManager.instance.level.setSimpleTween(this.princess.group,14,{y:372,skX:18,skY:-162}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,14,{x:-393,y:208}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,14,{x:-376,y:231}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,14,{x:-352,y:254}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,14,{x:-343,y:268}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,14,{x:-105,y:317}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,14,{x:-148,y:338}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,14,{x:-170,y:334}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,14,{x:-195,y:328}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,14,{x:-223,y:317}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,14,{x:-247,y:302}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,14,{x:-299,y:299}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,14,{x:-275,y:336}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,14,{x:-343,y:312}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,14,{x:-329,y:267,skX:9,skY:9})):70===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,15,{x:-322,y:192,skX:87,skY:87}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,15,{x:-310,y:113,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,15,{x:-309,y:179,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,15,{x:-263,y:247,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,15,{x:-319,y:240,skX:-24,skY:-23}),e.GameManager.instance.level.setSimpleTween(this.princess.group,15,{x:-273,y:311,skX:29,skY:-151}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,15,{x:-420,y:140,skX:-33,skY:-33}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,15,{x:-399,y:160,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,15,{x:-372,y:178,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,15,{x:-360,y:190,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,15,{x:-118,y:196,skX:34,skY:34}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,15,{x:-156,y:225,skX:22,skY:22}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,15,{x:-179,y:224,skX:11,skY:11}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,15,{x:-204,y:224,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,15,{x:-233,y:217,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,15,{x:-260,y:207,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,15,{x:-312,y:213,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,15,{x:-281,y:245,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,15,{x:-353,y:234,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,15,{x:-347,y:187,skX:72,skY:72})):85===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,10,{x:-319,y:221,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,10,{x:-307,y:142}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,10,{x:-306,y:208}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,10,{x:-260,y:276}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,10,{x:-316,y:269}),e.GameManager.instance.level.setSimpleTween(this.princess.group,10,{x:-270,y:325,skX:17,skY:-163}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,10,{x:-417,y:169}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,10,{x:-396,y:189}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,10,{x:-369,y:207}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,10,{x:-357,y:219}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,10,{x:-115,y:225}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,10,{x:-153,y:254}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,10,{x:-176,y:253}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,10,{x:-201,y:253}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,10,{x:-230,y:246}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,10,{x:-257,y:236}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,10,{x:-309,y:242}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,10,{x:-278,y:274}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,10,{x:-350,y:263}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,10,{x:-344,y:216,skX:-1,skY:-1})):95===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,14,{x:-376,y:35,skX:85,skY:85}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,14,{x:-388,y:-43,skX:-29,skY:-29}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,14,{x:-368,y:20,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,14,{x:-303,y:71,skX:-35,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,14,{x:-359,y:81,skX:-41,skY:-40}),e.GameManager.instance.level.setSimpleTween(this.princess.group,14,{x:-298,y:162,skX:35,skY:-145}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,14,{x:-485,y:16,skX:-50,skY:-50}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,14,{x:-459,y:28,skX:-75,skY:-75}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,14,{x:-428,y:38,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,14,{x:-413,y:46,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,14,{x:-180,y:-20,skX:17,skY:17}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,14,{x:-208,y:19,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,14,{x:-230,y:25,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,14,{x:-254,y:31,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,14,{x:-284,y:34,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,14,{x:-313,y:32,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,14,{x:-360,y:53,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,14,{x:-321,y:74,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,14,{x:-393,y:85,skX:-49,skY:-49}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,14,{x:-401,y:39,skX:67,skY:67})):109===this.counterAnim&&this.animComplete()))},a.prototype.setParts=function(e){"appear"===e?(this.setPart(this.dragonWing1.group,{x:150,y:300,angle:0,scX:.94,scY:.94,skX:-13,skY:-13}),this.setPart(this.dragonMage.group,{x:163,y:217,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonSeddle,{x:162,y:287,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonLeg2_2,{x:208,y:355,angle:0,scX:.94,scY:.88,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_2,{x:147,y:357,angle:0,scX:.94,scY:.88,skX:-26,skY:-25}),this.setPart(this.princess.group,{x:-252,y:442,angle:0,scX:1,scY:1,skX:0,skY:-179}),this.setPart(this.dragonHead,{x:49,y:245,angle:0,scX:.93,scY:.93,skX:-8,skY:-8}),this.setPart(this.dragonNeck1,{x:72,y:268,angle:0,scX:.93,scY:.93,skX:-58,skY:-58}),this.setPart(this.dragonNeck2,{x:99,y:287,angle:0,scX:.93,scY:.93,skX:-41,skY:-41}),this.setPart(this.dragonNeck3,{x:111,y:299,angle:0,scX:.94,scY:.94,skX:-25,skY:-25}),this.setPart(this.dragonTail6,{x:354,y:307,angle:0,scX:.93,scY:.93,skX:34,skY:34}),this.setPart(this.dragonTail5,{x:316,y:336,angle:0,scX:.93,scY:.93,skX:22,skY:22}),this.setPart(this.dragonTail4,{x:293,y:335,angle:0,scX:.93,scY:.93,skX:11,skY:11}),this.setPart(this.dragonTail3,{x:267,y:334,angle:0,scX:.93,scY:.93,skX:0,skY:0}),this.setPart(this.dragonTail2,{x:238,y:326,angle:0,scX:.94,scY:.94,skX:-26,skY:-26}),this.setPart(this.dragonTail1,{x:211,y:315,angle:0,scX:.94,scY:.94,skX:-24,skY:-24}),this.setPart(this.dragonBase,{x:160,y:321,angle:0,scX:.93,scY:.93,skX:-2,skY:-2}),this.setPart(this.dragonLeg2_1,{x:190,y:353,angle:0,scX:.84,scY:.96,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_1,{x:134,y:358,angle:0,scX:.89,scY:.89,skX:-27,skY:-27}),this.setPart(this.dragonWing2.group,{x:124,y:295,angle:0,scX:.94,scY:.94,skX:-1,skY:-1})):"dragon_cycle"===e?(this.setPart(this.dragonWing1.group,{x:-90,y:425,angle:0,scX:.94,scY:.94,skX:-13,skY:-13}),this.setPart(this.dragonMage.group,{x:-77,y:342,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonSeddle,{x:-78,y:412,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonLeg2_2,{x:-30,y:479,angle:0,scX:.94,scY:.88,skX:-21,skY:-21}),this.setPart(this.dragonLeg1_2,{x:-102,y:479,angle:0,scX:.94,scY:.75,skX:-9,skY:-8}),this.setPart(this.princess.group,{x:-252,y:442,angle:0,scX:1,scY:1,skX:0,skY:-179}),this.setPart(this.dragonHead,{x:-189,y:374,angle:0,scX:.93,scY:.93,skX:-33,skY:-33}),this.setPart(this.dragonNeck1,{x:-168,y:393,angle:0,scX:.93,scY:.93,skX:-58,skY:-58}),this.setPart(this.dragonNeck2,{x:-141,y:412,angle:0,scX:.93,scY:.93,skX:-41,skY:-41}),this.setPart(this.dragonNeck3,{x:-129,y:424,angle:0,scX:.94,scY:.94,skX:-25,skY:-25}),this.setPart(this.dragonTail6,{x:113,y:430,angle:0,scX:.93,scY:.93,skX:34,skY:34}),this.setPart(this.dragonTail5,{x:75,y:459,angle:0,scX:.93,scY:.93,skX:22,skY:22}),this.setPart(this.dragonTail4,{x:52,y:458,angle:0,scX:.93,scY:.93,skX:11,skY:11}),this.setPart(this.dragonTail3,{x:27,y:457,angle:0,scX:.93,scY:.93,skX:0,skY:0}),this.setPart(this.dragonTail2,{x:-2,y:451,angle:0,scX:.94,scY:.94,skX:-26,skY:-26}),this.setPart(this.dragonTail1,{x:-29,y:440,angle:0,scX:.94,scY:.94,skX:-24,skY:-24}),this.setPart(this.dragonBase,{x:-80,y:446,angle:0,scX:.93,scY:.93,skX:-2,skY:-2}),this.setPart(this.dragonLeg2_1,{x:-50,y:478,angle:0,scX:.84,scY:.96,skX:-9,skY:-9}),this.setPart(this.dragonLeg1_1,{x:-105,y:476,angle:0,scX:.89,scY:.74,skX:8,skY:8}),this.setPart(this.dragonWing2.group,{x:-116,y:420,angle:0,scX:.94,scY:.94,skX:-1,skY:-1})):"attack2"===e?(this.setPart(this.dragonWing1.group,{x:-90,y:444,angle:0,scX:.94,scY:.94,skX:-13,skY:-13}),this.setPart(this.dragonMage.group,{x:-77,y:360,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonSeddle,{x:-78,y:430,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonLeg2_2,{x:-32,y:499,angle:0,scX:.94,scY:.88,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_2,{x:-93,y:500,angle:0,scX:.94,scY:.88,skX:-26,skY:-25}),this.setPart(this.princess.group,{x:-252,y:442,angle:0,scX:1,scY:1,skX:0,skY:-179}),this.setPart(this.dragonHead,{x:-189,y:392,angle:0,scX:.93,scY:.93,skX:-33,skY:-33}),this.setPart(this.dragonNeck1,{x:-168,y:411,angle:0,scX:.93,scY:.93,skX:-58,skY:-58}),this.setPart(this.dragonNeck2,{x:-141,y:430,angle:0,scX:.93,scY:.93,skX:-41,skY:-41}),this.setPart(this.dragonNeck3,{x:-129,y:442,angle:0,scX:.94,scY:.94,skX:-25,skY:-25}),this.setPart(this.dragonTail6,{x:113,y:448,angle:0,scX:.93,scY:.93,skX:34,skY:34}),this.setPart(this.dragonTail5,{x:75,y:477,angle:0,scX:.93,scY:.93,skX:22,skY:22}),this.setPart(this.dragonTail4,{x:52,y:476,angle:0,scX:.93,scY:.93,skX:11,skY:11}),this.setPart(this.dragonTail3,{x:27,y:475,angle:0,scX:.93,scY:.93,skX:0,skY:0}),this.setPart(this.dragonTail2,{x:-2,y:469,angle:0,scX:.93,scY:.93,skX:-26,skY:-26}),this.setPart(this.dragonTail1,{x:-29,y:459,angle:0,scX:.94,scY:.94,skX:-24,skY:-24}),this.setPart(this.dragonBase,{x:-80,y:465,angle:0,scX:.93,scY:.93,skX:-2,skY:-2}),this.setPart(this.dragonLeg2_1,{x:-50,y:496,angle:0,scX:.84,scY:.96,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_1,{x:-106,y:501,angle:0,scX:.89,scY:.89,skX:-27,skY:-27}),this.setPart(this.dragonWing2.group,{x:-116,y:438,angle:0,scX:.94,scY:.94,skX:-1,skY:-1})):"princess"===e&&(this.setPart(this.dragonWing1.group,{x:-90,y:444,angle:0,scX:.94,scY:.94,skX:-13,skY:-13}),this.setPart(this.dragonMage.group,{x:-76,y:366,angle:0,scX:.94,scY:.94,skX:-9,skY:-9}),this.setPart(this.dragonSeddle,{x:-78,y:431,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonLeg2_2,{x:-32,y:499,angle:0,scX:.94,scY:.88,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_2,{x:-93,y:501,angle:0,scX:.94,scY:.88,skX:-26,skY:-25}),this.setPart(this.princess.group,{x:-252,y:442,angle:0,scX:1,scY:1,skX:0,skY:-179}),this.setPart(this.dragonHead,{x:-189,y:393,angle:0,scX:.93,scY:.93,skX:-33,skY:-33}),this.setPart(this.dragonNeck1,{x:-168,y:412,angle:0,scX:.93,scY:.93,skX:-58,skY:-58}),this.setPart(this.dragonNeck2,{x:-141,y:431,angle:0,scX:.93,scY:.93,skX:-41,skY:-41}),this.setPart(this.dragonNeck3,{x:-129,y:443,angle:0,scX:.94,scY:.94,skX:-25,skY:-25}),this.setPart(this.dragonTail6,{x:113,y:449,angle:0,scX:.93,scY:.93,skX:34,skY:34}),this.setPart(this.dragonTail5,{x:75,y:478,angle:0,scX:.93,scY:.93,skX:22,skY:22}),this.setPart(this.dragonTail4,{x:52,y:477,angle:0,scX:.93,scY:.93,skX:11,skY:11}),this.setPart(this.dragonTail3,{x:27,y:476,angle:0,scX:.93,scY:.93,skX:0,skY:0}),this.setPart(this.dragonTail2,{x:-2,y:470,angle:0,scX:.94,scY:.94,skX:-26,skY:-26}),this.setPart(this.dragonTail1,{x:-29,y:459,angle:0,scX:.94,scY:.94,skX:-24,skY:-24}),this.setPart(this.dragonBase,{x:-80,y:465,angle:0,scX:.93,scY:.93,skX:-2,skY:-2}),this.setPart(this.dragonLeg2_1,{x:-50,y:497,angle:0,scX:.84,scY:.96,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_1,{x:-106,y:502,angle:0,scX:.89,scY:.89,skX:-27,skY:-27}),this.setPart(this.dragonWing2.group,{x:-116,y:439,angle:0,scX:.94,scY:.94,skX:-1,skY:-1}))},a.prototype.free=function(){this.group=null,this.dragonSeddle=null,this.dragonLeg2_2=null,this.dragonLeg1_2=null,this.dragonHead=null,this.dragonEye=null,this.dragonNeck1=null,this.dragonNeck2=null,this.dragonNeck3=null,this.dragonTail6=null,this.dragonTail5=null,this.dragonTail4=null,this.dragonTail3=null,this.dragonTail2=null,this.dragonTail1=null,this.dragonBase=null,this.dragonLeg2_1=null,this.dragonLeg1_1=null,this.dragonWing1.free(),this.dragonWing1=null,this.dragonWing2.free(),this.dragonWing2=null,this.dragonMage.free(),this.dragonMage=null,this.princess.free(),this.princess=null},a}(e.BasicSimpleAnim);e.Lvl3Dragon=t;var i=function(t){function i(i,s){void 0===s&&(s="");var a=t.call(this,i)||this;return a.group=new e.SAGroup(i,0,0),a.dragonWing7=new e.SASprite(i,0,0,"dragon","dragonWing7"+s+" instance 10000"),a.dragonWing7.pivot.set(17,-4),a.group.addChild(a.dragonWing7),a.dragonWing8=new e.SASprite(i,0,0,"dragon","dragonWing8"+s+" instance 10000"),a.group.addChild(a.dragonWing8),a.dragonWing9=new e.SASprite(i,0,0,"dragon","dragonWing9"+s+" instance 10000"),a.dragonWing9.pivot.set(14,-7),a.group.addChild(a.dragonWing9),a.dragonWing10=new e.SASprite(i,0,0,"dragon","dragonWing10"+s+" instance 10000"),a.group.addChild(a.dragonWing10),a.dragonWing1=new e.SASprite(i,0,0,"dragon","dragonWing1"+s+" instance 10000"),a.dragonWing1.pivot.set(39,33),a.group.addChild(a.dragonWing1),a.dragonWing2=new e.SASprite(i,0,0,"dragon","dragonWing2"+s+" instance 10000"),a.dragonWing2.pivot.set(26,28),a.group.addChild(a.dragonWing2),a.dragonWing3=new e.SASprite(i,0,0,"dragon","dragonWing3"+s+" instance 10000"),a.dragonWing3.pivot.set(-16,4),a.group.addChild(a.dragonWing3),a.dragonWing4=new e.SASprite(i,0,0,"dragon","dragonWing4"+s+" instance 10000"),a.dragonWing4.pivot.set(21,53),a.group.addChild(a.dragonWing4),a.dragonWing5=new e.SASprite(i,0,0,"dragon","dragonWing5"+s+" instance 10000"),a.dragonWing5.pivot.set(38,64),a.group.addChild(a.dragonWing5),a.dragonWing6=new e.SASprite(i,0,0,"dragon","dragonWing6"+s+" instance 10000"),a.dragonWing6.pivot.set(79,66),a.group.addChild(a.dragonWing6),a.setParts("anim"),a}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,5,{x:83,y:-172,skX:-71,skY:-71}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,5,{x:93,y:-122,skX:-57,skY:-57}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,5,{x:71,y:-95,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,5,{x:42,y:-56,skX:-34,skY:-34,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,5,{x:40,y:-95}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,5,{x:30,y:-34,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,5,{x:24,y:-171,skX:8,skY:8,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,5,{x:40,y:-220,skX:4,skY:-4,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,5,{x:32,y:-69,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,5,{x:50,y:-138,skX:18,skY:26,scX:.95,scY:.91})):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:116,y:-124,skX:-53,skY:-53}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:109,y:-80,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:85,y:-62,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:59,y:-37,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:59,y:-72}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:39,y:-22,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:56,y:-144,skX:23,skY:23,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:89,y:-181,skX:19,skY:13,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:53,y:-58,skX:30,skY:30}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:77,y:-108,skX:25,skY:38,scX:.89,scY:.81})):12===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:132,y:-69,skX:-35,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:112,y:-35,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:87,y:-26,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:68,y:-14,skX:-3,skY:-3,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:69,y:-43,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:44,y:-8,skX:32,skY:32}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:78,y:-107,skX:37,skY:37,scY:.72}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:130,y:-126,skX:42,skY:29,scX:.95,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:72,y:-36,skX:47,skY:47}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:96,y:-65,skX:42,skY:53,scX:.87,scY:.69})):18===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:130,y:-10,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:101,y:11,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:78,y:11,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:69,y:10,skX:13,skY:13,scX:.98,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:70,y:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{y:8,skX:51,skY:51}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:91,y:-62,skX:54,skY:52,scY:.63}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:140,y:-61,skX:63,skY:44,scX:.96,scY:.65}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:74,y:-14,skX:60,skY:60}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:109,y:-11,skX:62,skY:70,scX:.76,scY:.55})):24===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:132,y:-68,skX:-35,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:113,y:-35,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:87,y:-26,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:68,y:-14,skX:-3,skY:-3}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:69,y:-43}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{y:-8,skX:32,skY:32}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:78,y:-107,skX:37,skY:37,scY:.72}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:130,y:-126,skX:42,skY:29,scX:.95,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:72,y:-36,skX:47,skY:47}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:96,y:-65,skX:42,skY:53,scX:.87,scY:.69})):30===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:116,y:-125,skX:-53,skY:-53}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:109,y:-80,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:85,y:-62,skX:-32,skY:-32,scX:.98}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:59,y:-37,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:59,y:-72,skX:4,skY:4}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:39,y:-22,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:56,y:-144,skX:23,skY:23,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:89,y:-181,skX:19,skY:13,scX:1,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:53,y:-58,skX:30,skY:30}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:77,y:-108,skX:25,skY:38,scX:.89,scY:.81})):36===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,6,{x:82,y:-172,skX:-71,skY:-71}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,6,{x:93,y:-122,skX:-57,skY:-57}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,6,{x:71,y:-95,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,6,{x:42,y:-56,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,6,{x:40,y:-95}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,6,{x:30,y:-34,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,6,{x:24,y:-171,skX:8,skY:8,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,6,{x:40,y:-220,skX:4,skY:-4,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,6,{x:32,y:-69,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,6,{x:50,y:-138,skX:18,skY:26,scX:.95,scY:.91})):42===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing6,5,{x:45,y:-201,skX:-86,skY:-86}),e.GameManager.instance.level.setSimpleTween(this.dragonWing5,5,{x:72,y:-150,skX:-70,skY:-70}),e.GameManager.instance.level.setSimpleTween(this.dragonWing4,5,{x:53,y:-117,skX:-54,skY:-54,scX:.99}),e.GameManager.instance.level.setSimpleTween(this.dragonWing3,5,{x:23,y:-65,skX:-47,skY:-47,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2,5,{x:18,y:-109}),e.GameManager.instance.level.setSimpleTween(this.dragonWing1,5,{x:19,y:-41,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.dragonWing10,5,{x:0,y:-193,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.dragonWing9,5,{x:-9,y:-245,skX:-15,skY:-15,scY:1}),e.GameManager.instance.level.setSimpleTween(this.dragonWing8,5,{x:14,y:-77,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonWing7,5,{x:22,y:-157,skX:13,skY:15,scX:1,scY:1})):47===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.dragonWing6,{x:45,y:-201,angle:0,scX:.98,scY:.98,skX:-86,skY:-86}),this.setPart(this.dragonWing5,{x:72,y:-150,angle:0,scX:.99,scY:.99,skX:-70,skY:-70}),this.setPart(this.dragonWing4,{x:53,y:-117,angle:0,scX:.99,scY:.99,skX:-54,skY:-54}),this.setPart(this.dragonWing3,{x:23,y:-65,angle:0,scX:.99,scY:.99,skX:-47,skY:-47}),this.setPart(this.dragonWing2,{x:18,y:-109,angle:0,scX:1,scY:1,skX:4,skY:4}),this.setPart(this.dragonWing1,{x:19,y:-41,angle:0,scX:.99,scY:.99,skX:-24,skY:-24}),this.setPart(this.dragonWing10,{x:0,y:-193,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.dragonWing9,{x:-9,y:-245,angle:0,scX:1,scY:1,skX:-15,skY:-15}),this.setPart(this.dragonWing8,{x:14,y:-77,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.dragonWing7,{x:22,y:-157,angle:0,scX:1,scY:1,skX:13,skY:15}))},i.prototype.free=function(){this.group=null,this.dragonWing6=null,this.dragonWing5=null,this.dragonWing4=null,this.dragonWing3=null,this.dragonWing2=null,this.dragonWing1=null,this.dragonWing7=null,this.dragonWing8=null,this.dragonWing9=null,this.dragonWing10=null},i}(e.BasicSimpleAnim);e.Lvl3DragonWing=i;var s=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.base=new e.SASprite(i,0,0,"dragon","dragonMageBase instance 10000"),s.base.pivot.set(55,33),s.group.addChild(s.base),s.eyes=new e.SASprite(i,0,0,"dragon","dragonMageEyes instance 10000"),s.eyes.pivot.set(14,16),s.eyes.animations.add("anim",Phaser.Animation.generateFrameNames("dragonMageEyes instance 1",0,107,"",4),30,!1),s.group.addChild(s.eyes),s.hat=new e.SASprite(i,0,0,"dragon","dragonMageHat instance 10000"),s.hat.pivot.set(23,87),s.group.addChild(s.hat),s.brown=new e.SASprite(i,0,0,"dragon","dragonMageBrown instance 10000"),s.brown.pivot.set(12,24),s.brown.animations.add("anim",Phaser.Animation.generateFrameNames("dragonMageBrown instance 1",0,107,"",4),30,!1),s.group.addChild(s.brown),s.scepter=new e.SASprite(i,0,0,"dragon","dragonMageScepter instance 10000"),s.scepter.pivot.set(22,59),s.group.addChild(s.scepter),s.castAnim=i.make.sprite(-344,-75,"level3","magicBad1 instance 10000"),s.castAnim.animations.add("anim",Phaser.Animation.generateFrameNames("magicBad1 instance 1",0,24,"",4),30,!1).killOnComplete=!0,s.castAnim.angle=13,s.group.addChild(s.castAnim),s.castAnim.visible=!1,s.setParts("cast"),s}return __extends(i,t),i.prototype.play=function(){this.setParts("cast"),this.eyes.animations.play("anim"),this.brown.animations.play("anim")},i.prototype.playCast=function(){this.playAnim("cast")},i.prototype.update=function(){t.prototype.update.call(this)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"cast"===this.currAnim&&(1===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,20,{x:-92,y:34,skX:-102,skY:-102}):21===this.counterAnim?(this.castAnim.visible=!0,this.castAnim.animations.play("anim"),e.GameManager.instance.level.setSimpleTween(this.scepter,4,{x:-89,y:30,skX:-87,skY:-87})):25===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,4,{x:-92,y:34,skX:-102,skY:-102}):29===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,4,{x:-89,y:30,skX:-87,skY:-87}):33===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,4,{x:-92,y:34,skX:-102,skY:-102}):37===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,4,{x:-89,y:30,skX:-87,skY:-87}):41===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,7,{x:-4,y:12,skX:25,skY:25}):48===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,19,{x:22,y:11}):67===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"cast"===e&&(this.setPart(this.scepter,{x:9,y:16,angle:0,scX:.94,scY:.94,skX:16,skY:16}),this.setPart(this.brown,{x:-48,y:19,angle:0,scX:.94,scY:.94,skX:-12,skY:-12}),this.setPart(this.hat,{x:-48,y:19,angle:0,scX:.94,scY:.94,skX:-12,skY:-12}),this.setPart(this.eyes,{x:-48,y:19,angle:0,scX:.94,scY:.94,skX:-12,skY:-12}),this.setPart(this.base,{x:-22,y:28,angle:0,scX:.94,scY:.94,skX:-5,skY:-5}))},i.prototype.free=function(){this.group=null,this.scepter=null,this.brown=null,this.hat=null,this.eyes=null,this.base=null,this.castAnim=null},i}(e.BasicSimpleAnim);e.Lvl3DragonMage=s}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n){void 0===n&&(n=1);var o=t.call(this,i)||this;return o.active=!1,o.speed=2*n,o.speedWheels=5,o.group=new e.SAGroup(i,s,a),o.group.scale.x=n,e.GameManager.instance.layerBackground.addChild(o.group),o.axe=new e.SASprite(i,0,0,"level3","guardAxe instance 10000"),o.group.addChild(o.axe),o.base=new e.SASprite(i,0,0,"level3","guardBase instance 10000"),o.base.pivot.set(2,10),o.group.addChild(o.base),o.eyes=new e.SASprite(i,0,0,"level3","guardEyes instance 10000"),o.eyes.anchor.setTo(.15,.15),o.group.addChild(o.eyes),o.helmet=new e.SASprite(i,0,0,"level3","guardHelmet instance 10000"),o.helmet.anchor.setTo(.5),o.helmet.animations.add("anim",Phaser.Animation.generateFrameNames("guardHelmet instance 1",0,61,"",4),30,!0),o.helmet.animations.play("anim"),o.group.addChild(o.helmet),o.wheel2=new e.SASprite(i,0,0,"level3","guardWheel instance 10000"),o.wheel2.anchor.setTo(.5),o.group.addChild(o.wheel2),o.wheel1=new e.SASprite(i,0,0,"level3","guardWheel instance 10000"),o.wheel1.anchor.setTo(.5),o.group.addChild(o.wheel1),o.setParts("shock"),o}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this),!0===this.active&&(this.group.x+=this.speed,this.wheel1.angle+=this.speedWheels,this.wheel2.angle+=this.speedWheels,(1===this.group.scale.x&&this.group.x>900||-1===this.group.scale.x&&this.group.x<-100)&&(this.active=!1))},i.prototype.activate=function(){this.playAnim("shock")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"shock"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.helmet,14,{y:-8,scY:.78}),e.GameManager.instance.level.setSimpleTween(this.eyes,14,{x:-16,y:-19}),e.GameManager.instance.level.setSimpleTween(this.base,14,{x:-54,y:-26,scX:.96,scY:.78}),e.GameManager.instance.level.setSimpleTween(this.axe,14,{x:-66,y:-53,skX:-20.46,skY:-20.46})):15===this.counterAnim?(this.active=!0,e.GameManager.instance.level.setSimpleTween(this.wheel1,3,{x:-28,scY:1.01,skX:7.01}),e.GameManager.instance.level.setSimpleTween(this.wheel2,3,{x:38,skX:3.75}),e.GameManager.instance.level.setSimpleTween(this.helmet,3,{x:-17,y:-18,scY:1.04,skX:10.76}),e.GameManager.instance.level.setSimpleTween(this.eyes,3,{x:-7,y:-29,scX:.99,scY:1.01,skX:-11.48,skY:171.44}),e.GameManager.instance.level.setSimpleTween(this.base,3,{x:-41,y:-42,scY:1.04,skX:10.76}),e.GameManager.instance.level.setSimpleTween(this.axe,3,{x:-10,y:-76,scX:1.02,scY:.98,skX:18.15,skY:20.22})):18===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.axe,4,{x:-2,y:-75,skX:24.39,skY:26.46}):22===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.axe,6,{x:-12,y:-76,skX:15.91,skY:17.97}):28===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.axe,10,{x:-10,skX:18.15,skY:20.22}):38===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wheel1,24,{x:-30,scY:1,skX:0}),e.GameManager.instance.level.setSimpleTween(this.wheel2,24,{x:37,skX:0}),e.GameManager.instance.level.setSimpleTween(this.helmet,24,{x:-26,y:-17,scY:1,skX:0}),e.GameManager.instance.level.setSimpleTween(this.eyes,24,{x:-12,scX:1,scY:1,skX:-8.49,skY:171.51}),e.GameManager.instance.level.setSimpleTween(this.base,24,{x:-57,y:-40,scX:1,scY:1,skX:0}),e.GameManager.instance.level.setSimpleTween(this.axe,24,{x:-42,y:-79,scX:1,scY:1,skX:0,skY:0})):62===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"shock"===e&&(this.setPart(this.wheel1,{x:-30,y:26,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.wheel2,{x:37,y:26,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.helmet,{x:-26,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.eyes,{x:-12,y:-29,angle:0,scX:1,scY:1,skX:-8.49,skY:171.51}),this.setPart(this.base,{x:-57,y:-40,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.axe,{x:-42,y:-79,angle:0,scX:1,scY:1,skX:0,skY:0}))},i.prototype.free=function(){this.group=null,this.wheel1=null,this.wheel2=null,this.helmet=null,this.eyes=null,this.base=null,this.axe=null},i}(e.BasicSimpleAnim);e.Lvl3Guard=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function s(s){var a=t.call(this,s)||this;return a.active=!1,a.group=new e.SAGroup(s,719,306),a.group.angle=3,e.GameManager.instance.layerBackground.addChild(a.group),a.base=new e.SASprite(s,0,0,"level3","jesterBase instance 10000"),a.group.addChild(a.base),a.hat=new e.SASprite(s,0,0,"level3","jesterHat instance 10000"),a.hat.anchor.setTo(.5),a.group.addChild(a.hat),a.eyes=new e.SASprite(s,0,0,"level3","jesterEyes instance 10000"),a.eyes.anchor.setTo(.15,.23),a.eyes.animations.add("anim",Phaser.Animation.generateFrameNames("jesterEyes instance 1",0,164,"",4),30,!1),a.group.addChild(a.eyes),a.trumpet=new i(s),a.group.addChild(a.trumpet.group),a.wheel1=new e.SASprite(s,0,0,"level3","jesterWheel instance 10000"),a.wheel1.anchor.setTo(.5),a.group.addChild(a.wheel1),a.wheel2=new e.SASprite(s,0,0,"level3","jesterWheel instance 10000"),a.wheel2.anchor.setTo(.5),a.group.addChild(a.wheel2),a.setParts("shock"),a}return __extends(s,t),s.prototype.update=function(){t.prototype.update.call(this),this.trumpet.update(),!0===this.active&&(this.group.x+=2,this.group.y+=.1,this.wheel1.angle+=5,this.wheel2.angle+=5,this.group.x>900&&(this.active=!1))},s.prototype.activate=function(){this.playAnim("shock")},s.prototype.matchStart=function(){e.SoundManager.playSFX("sfx_trumpet"),this.trumpet.playAnim("signal_start"),this.eyes.animations.play("anim")},s.prototype.matchEnd=function(){e.SoundManager.playSFX("sfx_win"),this.trumpet.playAnim("signal_win"),this.eyes.animations.play("anim")},s.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"shock"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.trumpet.group,9,{y:4,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.eyes,9,{x:-14,y:-23}),e.GameManager.instance.level.setSimpleTween(this.hat,11,{x:-16,y:-37}),e.GameManager.instance.level.setSimpleTween(this.base,9,{y:-19,scY:.74})):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wheel2,3,{x:39,skY:-77.97}),e.GameManager.instance.level.setSimpleTween(this.wheel1,3,{x:-27,scY:1.01,skX:7.1}),e.GameManager.instance.level.setSimpleTween(this.trumpet.group,3,{x:-25,y:-5,scY:1.08,skX:17.13}),e.GameManager.instance.level.setSimpleTween(this.eyes,3,{x:6,y:-35}),e.GameManager.instance.level.setSimpleTween(this.base,3,{x:-37,y:-38,scY:1.08,skX:17.13})):12===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.hat,4,{x:14,y:-55,skX:21.71,skY:21.71}):13===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.trumpet.group,19,{x:-19,y:-10,scY:1.3,skX:22.81}),e.GameManager.instance.level.setSimpleTween(this.eyes,19,{x:12,y:-41}),e.GameManager.instance.level.setSimpleTween(this.base,19,{x:-26,y:-48,scY:1.3,skX:22.81})):16===this.counterAnim?(this.active=!0,e.GameManager.instance.level.setSimpleTween(this.hat,16,{x:28,y:-64,skX:32.65,skY:32.65})):54===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wheel2,15,{x:38,skY:-81.98}),e.GameManager.instance.level.setSimpleTween(this.wheel1,15,{x:-29,scY:1,skX:0}),e.GameManager.instance.level.setSimpleTween(this.trumpet.group,15,{x:-35,y:-4,scY:1,skX:0}),e.GameManager.instance.level.setSimpleTween(this.eyes,15,{x:-13,y:-31}),e.GameManager.instance.level.setSimpleTween(this.base,15,{x:-57,y:-35,scY:1,skX:0})):56===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.hat,17,{x:-14,y:-49,skX:0,skY:0}):73===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.hat,3,{x:-19,y:-50,skX:-9.19,skY:-9.19}):76===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.hat,4,{x:-14,y:-49,skX:0,skY:0}):80===this.counterAnim&&this.animComplete()))},s.prototype.setParts=function(e){"shock"===e&&(this.setPart(this.wheel2,{x:38,y:26,angle:0,scX:1,scY:1,skX:-81.98,skY:-81.98}),this.setPart(this.wheel1,{x:-29,y:28,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.trumpet.group,{x:-35,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.eyes,{x:-13,y:-31,angle:0,scX:1,scY:1,skX:-8.49,skY:171.51}),this.setPart(this.hat,{x:-14,y:-49,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:-57,y:-35,angle:0,scX:1,scY:1,skX:0,skY:0}))},s.prototype.free=function(){this.group=null,this.wheel2=null,this.wheel1=null,this.trumpet.free(),this.trumpet=null,this.eyes=null,this.hat=null,this.base=null},s}(e.BasicSimpleAnim);e.Lvl3Jester=t;var i=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.part1=new e.SASprite(i,0,0,"level3","jesterTrumpet1 instance 10000"),s.part1.anchor.setTo(.5),s.group.addChild(s.part1),s.part2=new e.SASprite(i,0,0,"level3","jesterTrumpet2 instance 10000"),s.part2.anchor.setTo(.5),s.group.addChild(s.part2),s.part3=new e.SASprite(i,0,0,"level3","jesterTrumpet3 instance 10000"),s.part3.anchor.setTo(.5),s.group.addChild(s.part3),s.setParts("signal_start"),s}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"signal_start"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:24,y:14,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part2,5,{x:-1,y:2,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part3,5,{x:-17,y:-12,scX:.86,scY:.94,skY:-2.53})):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:19,y:11,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,5,{x:-12,y:-4,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part3,5,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):11===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,5,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,5,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:19,y:11,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part2,5,{x:-12,y:-4,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part3,5,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:16,y:8,scX:1.22,scY:1.11,skY:5.37}),e.GameManager.instance.level.setSimpleTween(this.part2,5,{x:-17,y:-8,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part3,5,{x:-38,y:-27,scX:1.09,scY:1.11,skY:0})):30===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:24,y:14,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:-1,y:2,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-17,y:-12,scX:.86,scY:.94,skY:-2.53})):36===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:19,y:11,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:-12,y:-4,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):42===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,7,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,7,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,7,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):49===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,8,{x:19,y:11,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part2,8,{x:-12,y:-4,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part3,8,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):57===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):64===this.counterAnim?this.animComplete():63===this.counterAnim&&(this.setPart(this.part1,{x:21,scX:1}),this.setPart(this.part2,{x:-8,y:-1}),this.setPart(this.part3,{x:-27,y:-17,scX:1,skY:0})):"signal_win"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,13,{x:24,y:14,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part2,13,{x:-1,y:2,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part3,13,{x:-17,y:-12,scX:.86,scY:.94,skY:-2.53})):14===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:19,y:11,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-12,y:-4,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):18===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:19,y:11,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-12,y:-4,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):30===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:24,y:14,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-1,y:2,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-17,y:-12,scX:.86,scY:.94,skY:-2.53})):34===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:19,y:11,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-12,y:-4,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):38===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):42===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:19,y:11,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-12,y:-4,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):46===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):50===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:24,y:14,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-1,y:2,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-17,y:-12,scX:.86,scY:.94,skY:-2.53})):54===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:19,y:11,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-12,y:-4,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):58===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):62===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:19,y:11,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-12,y:-4,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):66===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):70===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:24,y:14,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-1,y:2,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-17,y:-12,scX:.86,scY:.94,skY:-2.53})):74===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:19,y:11,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-12,y:-4,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):78===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):82===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:19,y:11,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-12,y:-4,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):86===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):90===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:24,y:14,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-1,y:2,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-17,y:-12,scX:.86,scY:.94,skY:-2.53})):94===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:19,y:11,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:-12,y:-4,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):98===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):104===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:19,y:11,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part2,5,{x:-12,y:-4,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part3,5,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):109===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):115===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:24,y:14,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:-1,y:2,scX:.86,scY:.94,skY:-2.53}),e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-17,y:-12,scX:.86,scY:.94,skY:-2.53})):121===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,7,{x:19,y:11,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,7,{x:-12,y:-4,scX:1.09,scY:1.11,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part3,7,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):128===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,7,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,7,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,7,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):135===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,7,{x:19,y:11,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part2,7,{x:-12,y:-4,scX:1.09,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.part3,7,{x:-33,y:-22,scX:1.09,scY:1.11,skY:0})):142===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,7,{x:23,y:12,scX:.89,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,7,{x:-3,y:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,7,{x:-18,y:-15,scX:.77,scY:1,skY:-10.37})):149===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"signal_start"===e?(this.setPart(this.part1,{x:21,y:12,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.part2,{x:-8,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.part3,{x:-27,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0})):"signal_win"===e&&(this.setPart(this.part1,{x:21,y:12,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.part2,{x:-8,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.part3,{x:-27,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0}))},i.prototype.free=function(){this.group=null,this.part1=null,this.part2=null,this.part3=null},i}(e.BasicSimpleAnim);e.Lvl3JesterTrumpet=i}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.enX=370,s.active=!1,s.body=new Phaser.Physics.Box2D.Body(i,null,410,232,2),s.body.setRectangle(66,96),s.body.fixedRotation=!0,s.body.setCollisionMask(~e.FilterGroups.WALL),s.group=new e.SAGroup(i,s.body.x,s.body.y),e.GameManager.instance.layerBackground.addChild(s.group),s.exhaustPipe=new e.SASprite(i,-50,0,"level3","kingExhaustPipe instance 10000"),s.exhaustPipe.anchor.setTo(.5),s.group.addChild(s.exhaustPipe),s.base=new e.SASprite(i,0,0,"level3","kingBase instance 10000"),s.group.addChild(s.base),s.wheelBase=new e.SASprite(i,0,0,"level3","kingWheelBAse instance 10000"),s.group.addChild(s.wheelBase),s.crown=new e.SASprite(i,0,0,"level3","kingCrown instance 10000"),s.crown.anchor.setTo(.49,.57),s.group.addChild(s.crown),s.eyes=new e.SASprite(i,0,0,"level3","kingEyes instance 10000"),s.eyes.anchor.setTo(.54,.67),s.eyes.animations.add("idle",Phaser.Animation.generateFrameNames("kingEyes instance 1",0,53,"",4),30,!0),s.eyes.animations.add("fear_start",Phaser.Animation.generateFrameNames("kingEyes instance 1",54,68,"",4),30,!1),s.eyes.animations.add("fear_end",Phaser.Animation.generateFrameNames("kingEyes instance 1",69,74,"",4),30,!1),s.eyes.animations.play("idle"),s.group.addChild(s.eyes),s.mustache=new e.SASprite(i,0,0,"level3","kingMustache instance 10000"),s.mustache.pivot.y=-1,s.group.addChild(s.mustache),s.wheel1=e.GameManager.instance.layerBackground.create(s.body.x-18,s.body.y+47,"level3","kingWheel1 instance 10000"),i.physics.box2d.enable(s.wheel1),s.wheel1.body.setCircle(10),s.wheel1.body.setCollisionMask(~e.FilterGroups.WALL),i.physics.box2d.revoluteJoint(s.body,s.wheel1,-18,47),s.wheel2=e.GameManager.instance.layerBackground.create(s.body.x+17,s.body.y+42,"level3","kingWheel2 instance 10000"),i.physics.box2d.enable(s.wheel2),s.wheel2.body.setCircle(14),s.wheel2.body.setCollisionMask(~e.FilterGroups.WALL),i.physics.box2d.revoluteJoint(s.body,s.wheel2,17,42),s.body.data.SetActive(!1),s.wheel1.body.data.SetActive(!1),s.wheel2.body.data.SetActive(!1),s.playAnim("idle",-1),s}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this),!0===this.active&&this.body.x<=this.enX&&(this.active=!1,this.body.velocity.x=0,this.wheel1.body.velocity.x=0,this.wheel2.body.velocity.x=0,this.wheel1.body.angularVelocity=0,this.wheel2.body.angularVelocity=0,this.body.kinematic=!0),this.group.x=this.body.x,this.group.y=this.body.y,this.group.rotation=this.body.rotation},i.prototype.activate=function(){this.active=!0,this.body.velocity.x=-15,this.body.data.SetActive(!0),this.wheel1.body.data.SetActive(!0),this.wheel2.body.data.SetActive(!0),this.playAnim("fear_start"),this.eyes.animations.play("fear_start")},i.prototype.onAnimComplete=function(){"fear_start"===this.currAnim&&this.playAnim("fear_cycle",-1)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"idle"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,15,{x:29,y:-12,skX:-21.22,skY:-21.22}),e.GameManager.instance.level.setSimpleTween(this.mustache,15,{x:27,y:3,skX:-20.22,skY:-20.22}),e.GameManager.instance.level.setSimpleTween(this.crown,15,{x:14,y:-41,skX:-12.99,skY:-12.99}),e.GameManager.instance.level.setSimpleTween(this.wheelBase,15,{y:29,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.base,15,{x:-52,y:-35,scY:.92,skX:5.43}),e.GameManager.instance.level.setSimpleTween(this.exhaustPipe,15,{y:-12,skX:-19.67,skY:-19.67})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,9,{x:27,y:-21,skX:-14.49,skY:-14.49}),e.GameManager.instance.level.setSimpleTween(this.mustache,9,{x:28,y:-8,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.crown,9,{x:9,y:-56,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.wheelBase,9,{y:28,scY:1}),e.GameManager.instance.level.setSimpleTween(this.base,9,{x:-60,y:-50,scY:1.08,skX:0}),e.GameManager.instance.level.setSimpleTween(this.exhaustPipe,9,{y:-21,skX:0,skY:0})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,14,{x:21,y:-12}),e.GameManager.instance.level.setSimpleTween(this.mustache,14,{x:25,y:-6,skX:5.81,skY:5.81}),e.GameManager.instance.level.setSimpleTween(this.crown,14,{x:8,y:-42,skX:11.77,skY:11.77}),e.GameManager.instance.level.setSimpleTween(this.base,14,{x:-65,y:-35,scY:.91,skX:-3.35}),e.GameManager.instance.level.setSimpleTween(this.exhaustPipe,14,{x:-51,y:-16,skX:4.99,skY:4.99})):39===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,9,{x:27,y:-21}),e.GameManager.instance.level.setSimpleTween(this.mustache,9,{x:28,y:-8,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.crown,9,{x:9,y:-56,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.base,9,{x:-60,y:-50,scY:1.08,skX:0}),e.GameManager.instance.level.setSimpleTween(this.exhaustPipe,9,{x:-53,y:-21,skX:0,skY:0})):48===this.counterAnim&&this.animComplete():"fear_start"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,5,{x:31,y:-33}),e.GameManager.instance.level.setSimpleTween(this.mustache,5,{x:29,y:-19}),e.GameManager.instance.level.setSimpleTween(this.crown,5,{x:19,y:-64}),e.GameManager.instance.level.setSimpleTween(this.base,5,{x:-52,y:-62,scY:1.21,skX:3.86}),e.GameManager.instance.level.setSimpleTween(this.exhaustPipe,5,{x:-57,y:-26,skX:-12.73,skY:-12.73})):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,5,{x:25,y:-11}),e.GameManager.instance.level.setSimpleTween(this.mustache,5,{x:22,y:-2}),e.GameManager.instance.level.setSimpleTween(this.crown,5,{x:12,y:-38}),e.GameManager.instance.level.setSimpleTween(this.base,5,{x:-60,y:-31,scY:.86,skX:0}),e.GameManager.instance.level.setSimpleTween(this.exhaustPipe,5,{x:-46,y:-13,skX:10.74,skY:10.74})):11===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,3,{x:26}),e.GameManager.instance.level.setSimpleTween(this.mustache,3,{x:23}),e.GameManager.instance.level.setSimpleTween(this.crown,3,{x:13,skX:2.7,skY:2.7}),e.GameManager.instance.level.setSimpleTween(this.base,3,{x:-59}),e.GameManager.instance.level.setSimpleTween(this.exhaustPipe,3,{x:-45})):14===this.counterAnim&&this.animComplete():"fear_cycle"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,4,{x:22,scX:.99,scY:1.01,skX:-16.87,skY:-14.65}),e.GameManager.instance.level.setSimpleTween(this.mustache,4,{x:21,y:-3,skX:.39,skY:2.95}),e.GameManager.instance.level.setSimpleTween(this.crown,4,{x:8,skX:-2.57,skY:0}),e.GameManager.instance.level.setSimpleTween(this.wheelBase,4,{x:-32,skX:-2.57}),e.GameManager.instance.level.setSimpleTween(this.base,4,{x:-63,scY:.87,skX:-2.57}),e.GameManager.instance.level.setSimpleTween(this.exhaustPipe,4,{x:-48,scX:1.01,scY:.99,skX:5.5,skY:7.99})):5===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,4,{x:25,scX:1,scY:1,skX:-14.49,skY:-14.49}),e.GameManager.instance.level.setSimpleTween(this.mustache,4,{x:22,y:-2,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.crown,4,{x:12,skX:0}),e.GameManager.instance.level.setSimpleTween(this.wheelBase,4,{x:-31,skX:0}),e.GameManager.instance.level.setSimpleTween(this.base,4,{x:-60,scY:.86,skX:0}),e.GameManager.instance.level.setSimpleTween(this.exhaustPipe,4,{x:-46,scX:1,scY:1,skX:10.74,skY:10.74})):9===this.counterAnim&&this.animComplete():"fear_end"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,10,{x:27,y:-21}),e.GameManager.instance.level.setSimpleTween(this.mustache,10,{x:28,y:-8}),e.GameManager.instance.level.setSimpleTween(this.crown,10,{x:9,y:-56}),e.GameManager.instance.level.setSimpleTween(this.base,10,{y:-50,scY:1.08}),e.GameManager.instance.level.setSimpleTween(this.exhaustPipe,10,{x:-53,y:-21,skX:0,skY:0})):11===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"idle"===e?(this.setPart(this.eyes,{x:27,y:-21,angle:0,scX:1,scY:1,skX:-14.49,skY:-14.49}),this.setPart(this.mustache,{x:28,y:-8,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.crown,{x:9,y:-56,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.wheelBase,{x:-31,y:28,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:-60,y:-50,angle:0,scX:1,scY:1.08,skX:0,skY:0}),this.setPart(this.exhaustPipe,{x:-53,y:-21,angle:0,scX:1,scY:1,skX:0,skY:0})):"fear_start"===e?(this.setPart(this.eyes,{x:27,y:-21,angle:0,scX:1,scY:1,skX:-14.49,skY:-14.49}),this.setPart(this.mustache,{x:28,y:-8,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.crown,{x:9,y:-56,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.wheelBase,{x:-31,y:28,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:-60,y:-50,angle:0,scX:1,scY:1.08,skX:0,skY:0}),this.setPart(this.exhaustPipe,{x:-53,y:-21,angle:0,scX:1,scY:1,skX:0,skY:0})):"fear_cycle"===e?(this.setPart(this.eyes,{x:26,y:-11,angle:0,scX:1,scY:1,skX:-14.49,skY:-14.49}),this.setPart(this.mustache,{x:23,y:-2,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.crown,{x:13,y:-38,angle:0,scX:1,scY:1,skX:2.7,skY:2.7}),this.setPart(this.wheelBase,{x:-31,y:28,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:-59,y:-31,angle:0,scX:1,scY:.86,skX:0,skY:0}),this.setPart(this.exhaustPipe,{x:-45,y:-13,angle:0,scX:1,scY:1,skX:10.74,skY:10.74})):"fear_end"===e&&(this.setPart(this.eyes,{x:25,y:-11,angle:0,scX:1,scY:1,skX:-14.49,skY:-14.49}),this.setPart(this.mustache,{x:22,y:-2,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.crown,{x:12,y:-38,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.wheelBase,{x:-31,y:28,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:-60,y:-31,angle:0,scX:1,scY:.86,skX:0,skY:0}),this.setPart(this.exhaustPipe,{x:-46,y:-13,angle:0,scX:1,scY:1,skX:10.74,skY:10.74}))},i.prototype.free=function(){this.group=null,this.eyes=null,this.mustache=null,this.crown=null,this.wheelBase=null,this.base=null,this.exhaustPipe=null,this.body=null,this.wheel1=null,this.wheel2=null},i}(e.BasicSimpleAnim);e.Lvl3King=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function a(a){var n=t.call(this,a)||this;if(n.questCarFounded=!1,n.game=a,n.questCarFounded=e.GameManager.instance.level.questCarFounded,n.body=new Phaser.Physics.Box2D.Body(a,null,250,275,2),n.body.setRectangle(80,50),n.body.setCollisionMask(~e.FilterGroups.WALL),n.body.kinematic=!0,n.group=new e.SAGroup(a,n.body.x,n.body.y),e.GameManager.instance.layerBackground.addChild(n.group),n.zzz=n.group.create(27,-114,"level3"),n.zzz.animations.add("anim",Phaser.Animation.generateFrameNames("mageZZZ instance 1",0,54,"",4),30,!0),n.zzz.animations.play("anim"),n.base=new e.SASprite(a,0,0,"level3","mageBase instance 10000"),n.base.pivot.y=8,n.group.addChild(n.base),n.beard=new e.SASprite(a,0,0,"level3","mageBeard instance 10000"),n.beard.pivot.set(2,6),n.group.addChild(n.beard),n.eyes=new e.SASprite(a,0,0,"level3","mageEyes instance 10000"),n.eyes.anchor.setTo(.5,.67),n.eyes.animations.add("sleep",Phaser.Animation.generateFrameNames("mageEyes instance 1",0,0,"",4),30,!1),n.eyes.animations.add("fear",Phaser.Animation.generateFrameNames("mageEyes instance 1",1,43,"",4),30,!1),n.eyes.animations.add("wakeUp",Phaser.Animation.generateFrameNames("mageEyes instance 1",1,23,"",4),30,!1).onComplete.addOnce(function(){this.eyes.animations.play("blink")},n),n.eyes.animations.add("blink",Phaser.Animation.generateFrameNames("mageEyes instance 1",24,43,"",4),30,!0),n.eyes.animations.play("sleep"),n.group.addChild(n.eyes),n.questCar=new e.SASprite(a,0,0,"ui","carBody instance 10000"),n.questCar.anchor.setTo(.5),!1===n.questCarFounded){n.questCar.inputEnabled=!0,n.questCar.input.useHandCursor=!0,n.questCar.events.onInputOut.add(function(){!0===this.questCar.inputEnabled&&(this.questCar.frameName="carBody instance 10000")},n),n.questCar.events.onInputOver.add(function(){!0===this.questCar.inputEnabled&&(this.questCar.frameName="carBody instance 10001")},n),n.questCar.events.onInputUp.addOnce(n.clickQuestCar,n);var o=a.make.sprite(-4,-27,"ui","carEye instance 10000");o.animations.add("idle",Phaser.Animation.generateFrameNames("carEye instance 1",0,89,"",4),35,!0),o.play("idle"),n.questCar.addChild(o),n.group.addChild(n.questCar)}else n.questCar.visible=!1;return n.hat=new i(a,n.body.x-19,n.body.y-110),a.physics.box2d.prismaticJoint(n.body,n.hat.body,0,-1,-19,0,0,0,0,0,!1,110,230,!0),n.wheel1=e.GameManager.instance.layerBackground.create(n.body.x-21,n.body.y+23,"level3","mageWheel instance 10000"),a.physics.box2d.enable(n.wheel1),n.wheel1.body.setCircle(14),n.wheel1.body.setCollisionMask(~e.FilterGroups.WALL),a.physics.box2d.revoluteJoint(n.body,n.wheel1,-21,23),n.wheel2=e.GameManager.instance.layerBackground.create(n.body.x+29,n.body.y+23,"level3","mageWheel instance 10000"),a.physics.box2d.enable(n.wheel2),n.wheel2.body.setCircle(14),n.wheel2.body.setCollisionMask(~e.FilterGroups.WALL),a.physics.box2d.revoluteJoint(n.body,n.wheel2,29,23),n.scepter=new s(a,n.body.x+10,n.body.y),n.playAnim("idle",-1),n}return __extends(a,t),a.prototype.clickQuestCar=function(){this.questCarFounded=!0,this.questCar.inputEnabled=!1,this.questCar.visible=!1,e.GameManager.instance.level.clickQuestCar2(this.group.x+this.questCar.x,this.group.y+this.questCar.y)},a.prototype.update=function(){t.prototype.update.call(this),this.scepter.update(),this.hat.update(),this.group.x=this.body.x,this.group.y=this.body.y,this.group.rotation=this.body.rotation},a.prototype.playAttack=function(){this.scepter.playAttack(),this.playAnim("fear_cycle")},a.prototype.playFear=function(){this.zzz&&this.zzz.destroy(),this.hat.disable(),this.questCarFounded=!0,this.questCar.inputEnabled=!1,this.questCar.visible=!1,this.playAnim("fear_start"),this.eyes.animations.play("fear")},a.prototype.wakeUp=function(){e.SoundManager.playSFX("sfx_spellTransform"),e.SoundManager.playSFX("sfx_waking"),this.zzz.destroy(),this.zzz=null,this.playAnim("fear_start"),this.eyes.animations.play("wakeUp"),this.scepter.byMace()},a.prototype.explosion=function(){this.body.dynamic=!0,this.body.data.ApplyLinearImpulse(new box2d.b2Vec2(30,20),this.body.data.GetPosition()),this.body.angularVelocity=-100},a.prototype.onAnimComplete=function(){"fear_start"===this.currAnim?this.playAnim("fear_cycle"):"fear_cycle"===this.currAnim&&this.playAnim("fear_end")},a.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"idle"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hat.graphic,27,{y:10}),e.GameManager.instance.level.setSimpleTween(this.questCar,27,{x:-22,y:-81}),e.GameManager.instance.level.setSimpleTween(this.eyes,20,{y:-44}),e.GameManager.instance.level.setSimpleTween(this.beard,27,{y:-25}),e.GameManager.instance.level.setSimpleTween(this.base,27,{y:-72,scY:.9})):21===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.eyes,7,{y:-43}):28===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hat.graphic,28,{y:0}),e.GameManager.instance.level.setSimpleTween(this.questCar,28,{x:-23,y:-90}),e.GameManager.instance.level.setSimpleTween(this.eyes,28,{y:-49}),e.GameManager.instance.level.setSimpleTween(this.beard,28,{y:-27}),e.GameManager.instance.level.setSimpleTween(this.base,28,{y:-83,scY:1})):56===this.counterAnim&&this.animComplete():"fear_start"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hat.graphic,5,{x:-8,y:35}),e.GameManager.instance.level.setSimpleTween(this.questCar,5,{x:-31,y:-56}),e.GameManager.instance.level.setSimpleTween(this.eyes,5,{x:6,y:-29,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.beard,5,{x:20,y:-19}),e.GameManager.instance.level.setSimpleTween(this.base,5,{x:-80,y:-45,skX:-8,scY:.66})):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hat.graphic,3,{x:20,y:-13,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.questCar,3,{x:-6,y:-105,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.eyes,3,{x:22,y:-62,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.beard,3,{x:30,y:-38,scY:1.34}),e.GameManager.instance.level.setSimpleTween(this.base,3,{x:-55,y:-99,skX:7,scY:1.16})):9===this.counterAnim&&this.animComplete():"fear_cycle"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hat.graphic,14,{x:13,y:-15,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.questCar,14,{x:-10,y:-106,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.eyes,14,{x:18,skX:-10,scY:1.01}),e.GameManager.instance.level.setSimpleTween(this.beard,14,{x:27,skX:-2}),e.GameManager.instance.level.setSimpleTween(this.base,14,{x:-60,skX:5,scY:1.15})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hat.graphic,13,{x:21,y:-14,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.questCar,13,{x:-6,y:-107,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.eyes,13,{x:22,skX:-8,scY:1}),e.GameManager.instance.level.setSimpleTween(this.beard,13,{x:30,skX:0}),e.GameManager.instance.level.setSimpleTween(this.base,13,{x:-55,skX:7,scY:1.16})):28===this.counterAnim&&this.animComplete():"fear_end"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hat.graphic,12,{x:0,y:0,skX:-20,skY:-20}),e.GameManager.instance.level.setSimpleTween(this.questCar,12,{x:-23,y:-90,skX:-15,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.eyes,12,{x:13,y:-49}),e.GameManager.instance.level.setSimpleTween(this.beard,12,{x:24,y:-27,scY:1}),e.GameManager.instance.level.setSimpleTween(this.base,12,{x:-71,y:-83,skX:0,scY:1})):13===this.counterAnim&&this.animComplete()))},a.prototype.setParts=function(e){"idle"===e?(this.setPart(this.hat.graphic,{x:0,y:0,angle:0,scX:1,scY:1,skX:-20,skY:-20}),this.setPart(this.questCar,{x:-23,y:-90,angle:0,scX:.89,scY:.89,skX:-15,skY:-15}),this.setPart(this.eyes,{x:13,y:-49,angle:0,scX:1,scY:1,skX:-8,skY:-8}),this.setPart(this.beard,{x:24,y:-27,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:-71,y:-83,angle:0,scX:1,scY:1,skX:0,skY:0})):"fear_start"===e?(this.setPart(this.hat.graphic,{x:0,y:0,angle:0,scX:1,scY:1,skX:-20,skY:-20}),this.setPart(this.questCar,{x:-23,y:-90,angle:0,scX:.89,scY:.89,skX:-15,skY:-15}),this.setPart(this.eyes,{x:13,y:-49,angle:0,scX:1,scY:1,skX:-8,skY:-8}),this.setPart(this.beard,{x:24,y:-27,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:-71,y:-83,angle:0,scX:1,scY:1,skX:0,skY:0})):"fear_cycle"===e?(this.setPart(this.hat.graphic,{x:20,y:-13,angle:0,scX:1,scY:1,skX:-10,skY:-10}),this.setPart(this.questCar,{x:-6,y:-105,angle:0,scX:.89,scY:.89,skX:-19,skY:-19}),this.setPart(this.eyes,{x:22,y:-62,angle:0,scX:1,scY:1,skX:-8,skY:-8}),this.setPart(this.beard,{x:30,y:-38,angle:0,scX:1,scY:1.34,skX:0,skY:0}),this.setPart(this.base,{x:-55,y:-99,angle:0,scX:1,scY:1.16,skX:7,skY:0})):"fear_end"===e&&(this.setPart(this.hat.graphic,{x:21,y:-14,angle:0,scX:1,scY:1,skX:-10,skY:-10}),this.setPart(this.questCar,{x:-6,y:-107,angle:0,scX:.89,scY:.89,skX:-21,skY:-21}),this.setPart(this.eyes,{x:22,y:-62,angle:0,scX:1,scY:1,skX:-8,skY:-8}),this.setPart(this.beard,{x:30,y:-38,angle:0,scX:1,scY:1.34,skX:0,skY:0}),this.setPart(this.base,{x:-55,y:-99,angle:0,scX:1,scY:1.16,skX:7,skY:0}))},a.prototype.free=function(){this.game=null,this.group=null,this.hat.free(),this.hat=null,this.eyes=null,this.beard=null,this.base=null,this.scepter.free(),this.scepter=null,this.zzz=null,this.questCar=null,this.body=null,this.wheel1=null,this.wheel2=null},a}(e.BasicSimpleAnim);e.Lvl3Mag=t;var i=function(t){function i(i,s,a){var n=t.call(this,i)||this;return n.stY=a,n.game=i,n.body=new Phaser.Physics.Box2D.Body(i,null,s,a,2),n.body.setRectangle(90,88,-8,-2,e.Tools.toRad(-19)),n.body.data.SetUserData("DragBody"),n.body.setCollisionMask(~e.FilterGroups.WALL),n.group=new e.SAGroup(i,n.body.x,n.body.y),e.GameManager.instance.layerBackground.addChild(n.group),n.graphic=new e.SASprite(i,0,0,"level3","mageHat instance 10000"),n.graphic.anchor.setTo(.57,.64),n.graphic.inputEnabled=!0,n.graphic.input.useHandCursor=!0,n.graphic.events.onInputOut.add(function(){!0===this.graphic.inputEnabled&&(this.graphic.frameName="mageHat instance 10000")},n),n.graphic.events.onInputOver.add(function(){!0===this.graphic.inputEnabled&&(this.graphic.frameName="mageHat instance 10001")},n),n.graphic.events.onInputDown.add(n.hatDown,n),n.graphic.events.onInputUp.add(n.hatUp,n),n.group.addChild(n.graphic),n}return __extends(i,t),i.prototype.disable=function(){this.graphic.frameName="mageHat instance 10000",this.graphic.inputEnabled=!1,this.body.data.SetUserData(null)},i.prototype.hatDown=function(){this.mtY=this.game.input.worldY},i.prototype.hatUp=function(){Math.abs(this.mtY-this.game.input.worldY)<20&&Math.abs(this.stY-this.body.y)<20&&this.body.data.ApplyLinearImpulse(new box2d.b2Vec2(0,22),this.body.data.GetPosition())},i.prototype.update=function(){t.prototype.update.call(this),this.group.x=this.body.x,this.group.y=this.body.y,this.group.rotation=this.body.rotation},i.prototype.free=function(){this.game=null,this.group=null,this.graphic=null,this.body=null},i}(e.BasicSimpleAnim);e.Lvl3MagHat=i;var s=function(t){function i(i,s,a){var n=t.call(this,i)||this;return n.updateByBody=!1,n.movingByMace=0,n.counterMace=0,n.game=i,n.startX=s,n.startY=a,n.graphic=new e.SASprite(i,s,a,"level3","mageScepter instance 10000"),n.graphic.anchor.setTo(.5),n.graphic.angle=24,e.GameManager.instance.layerBackground.addChild(n.graphic),n.transform=i.make.sprite(20,-80,"level3"),n.transform.angle=55,n.transform.animations.add("anim",Phaser.Animation.generateFrameNames("mageTransform instance 1",0,27,"",4),30,!1).killOnComplete=!0,n.transform.visible=!1,n.graphic.addChild(n.transform),n.body=new Phaser.Physics.Box2D.Body(i,null,s,a,2),n.body.setRectangle(8,160),n.body.angle=24,n.body.setCollisionMask(~e.FilterGroups.WALL),n.body.data.SetActive(!1),n.body.mass=.01,n.body.friction=2,n.castAnim=i.make.sprite(s+90,a-90,"level3","magicGood1 instance 10000"),n.castAnim.animations.add("anim",Phaser.Animation.generateFrameNames("magicGood1 instance 1",0,24,"",4),30,!1).killOnComplete=!0,e.GameManager.instance.layerBackground.addChild(n.castAnim),n.castAnim.visible=!1,n}return __extends(i,t),i.prototype.byMace=function(){this.movingByMace=1},i.prototype.playAttack=function(){this.graphic.angle=0,this.playAnim("anim")},i.prototype.update=function(){t.prototype.update.call(this),this.magicExplosion&&this.magicExplosion.update(),1===this.movingByMace&&(this.counterMace+=1,1===this.counterMace?e.GameManager.instance.level.setSimpleTween(this.graphic,7,{x:this.startX-20,y:this.startY-3,angle:0,scX:1,scY:1,skX:-17,skY:-17}):8===this.counterMace?(this.transform.visible=!0,this.transform.animations.play("anim")):14===this.counterMace&&(this.movingByMace=2,e.GameManager.instance.level.customAction(6))),!0===this.updateByBody&&(this.graphic.x=this.body.x,this.graphic.y=this.body.y,this.graphic.rotation=this.body.rotation)},i.prototype.onAnimComplete=function(){this.updateByBody=!0,this.body.x=this.graphic.x,this.body.y=this.graphic.y,this.body.angle=29,this.body.data.SetActive(!0),this.graphic.skX=this.graphic.skY=0},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,7,{skX:13,skY:13}):8===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,6,{x:this.startX+48,y:this.startY-35,skX:29,skY:29}):14===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,6,{x:this.startX+66,y:this.startY-34,skX:78,skY:78}):20===this.counterAnim?(this.castAnim.visible=!0,this.castAnim.animations.play("anim"),e.GameManager.instance.level.setSimpleTween(this.graphic,4,{skX:87,skY:87})):24===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,4,{skX:78,skY:78}):28===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,4,{skX:87,skY:87}):32===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,3,{skX:78,skY:78}):35===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,5,{skX:87,skY:87}):40===this.counterAnim?(this.magicExplosion=new e.Lvl3MagicExplosion(this.game,470,200),e.GameManager.instance.level.setSimpleTween(this.graphic,7,{x:this.startX+48,y:this.startY-35,skX:29,skY:29})):47===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&this.setPart(this.graphic,{x:this.startX-20,y:this.startY-3,angle:0,scX:1,scY:1,skX:-17,skY:-17})},i.prototype.free=function(){this.game=null,this.graphic=null,this.body=null,this.castAnim=null,this.magicExplosion&&this.magicExplosion.free(),this.magicExplosion=null,this.transform=null},i}(e.BasicSimpleAnim);e.Lvl3MagScepter=s}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this,i)||this;return n.stX=s,n.stY=a,n.magicBad=new e.SASprite(i,0,0,"level3","magicBad2 instance 10000"),e.GameManager.instance.layerUpper.addChild(n.magicBad),n.magicGood=new e.SASprite(i,0,0,"level3","magicGood2 instance 10000"),e.GameManager.instance.layerUpper.addChild(n.magicGood),n.playAnim("anim"),n}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.SoundManager.playSFX("s_lvl3_magicExplosion"),e.GameManager.instance.level.setSimpleTween(this.magicGood,7,{x:this.stX-129,y:this.stY-145,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.magicBad,2,{x:this.stX-149,y:this.stY-158,scX:.63,scY:.63})):3===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.magicBad,5,{x:this.stX-241,y:this.stY-262,scX:.99,scY:.99}):8===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.magicGood,6,{x:this.stX-266,y:this.stY-206,scX:1.59,scY:1.59,alpha:.4}),e.GameManager.instance.level.setSimpleTween(this.magicBad,6,{x:this.stX-352,y:this.stY-388,scX:1.45,scY:1.45,alpha:0})):10===this.counterAnim?e.GameManager.instance.level.customAction(4):14===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.magicGood,4,{x:this.stX-319,y:this.stY-334,scX:2,scY:2,alpha:0}):18===this.counterAnim&&(this.animComplete(),this.magicBad.visible=!1,this.magicGood.visible=!1)))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.magicGood,{x:this.stX,y:this.stY,angle:0,scX:.09,scY:.09,skX:0,skY:0,alpha:1}),this.setPart(this.magicBad,{x:this.stX-9,y:this.stY-6,angle:0,scX:.06,scY:.06,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.magicBad=null,this.magicGood=null},i}(e.BasicSimpleAnim);e.Lvl3MagicExplosion=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.active=0,s.counter=0,s.opened=!1,s.lever=e.GameManager.instance.layerBackground.create(311,480,"level3","mishenLever instance 10000"),s.lever.anchor.x=.5,s.lever.pivot.y=67,s.lever.inputEnabled=!0,s.lever.input.useHandCursor=!0,s.lever.events.onInputOut.add(function(){!0===this.lever.inputEnabled&&(this.lever.frameName="mishenLever instance 10000")},s),s.lever.events.onInputOver.add(function(){!0===this.lever.inputEnabled&&(this.lever.frameName="mishenLever instance 10001")},s),s.lever.events.onInputDown.addOnce(s.leverDown,s),s.graphic=e.GameManager.instance.layerBackground.create(286,500,"level3","mishen instance 10000"),s.graphic.anchor.x=.5,s.graphic.pivot.y=83,s.graphic.angle=-90,s}return __extends(i,t),i.prototype.leverDown=function(){this.lever.inputEnabled=!1,this.lever.frameName="mishenLever instance 10000",this.active=1,this.opened=!0,e.SoundManager.playSFX("sfx_lever")},i.prototype.punch=function(){this.active=2,this.counter=0},i.prototype.update=function(){1===this.active?(this.counter+=1,1===this.counter?(e.GameManager.instance.level.setSimpleTween(this.lever,10,{angle:105}),e.GameManager.instance.level.setSimpleTween(this.graphic,10,{y:480,angle:23})):11===this.counter?e.GameManager.instance.level.setSimpleTween(this.graphic,5,{angle:-7}):16===this.counter?e.GameManager.instance.level.setSimpleTween(this.graphic,5,{angle:4}):20===this.counter?e.GameManager.instance.level.setSimpleTween(this.graphic,2,{angle:0}):22===this.counter&&(this.active=0)):2===this.active&&(this.counter+=1,1===this.counter&&e.GameManager.instance.level.setSimpleTween(this.graphic,16,{x:350,y:500,angle:90}))},i.prototype.free=function(){this.lever=null,this.graphic=null},i}(e.BasicElement);e.Lvl3Mishen=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.wheel1=new e.SASprite(i,0,0,"level3","girlweel instance 10000"),s.wheel1.anchor.setTo(.5,.51),s.group.addChild(s.wheel1),s.wheel2=new e.SASprite(i,0,0,"level3","girlweel instance 10000"),s.wheel2.anchor.setTo(.5,.51),s.group.addChild(s.wheel2),s.base=new e.SASprite(i,0,0,"level3","girlcorpus instance 10000"),s.base.pivot.set(1,-1),s.group.addChild(s.base),s.crown=new e.SASprite(i,0,0,"level3","girlcrown instance 10000"),s.crown.pivot.set(1,2),s.group.addChild(s.crown),s.eyes=new e.SASprite(i,0,0,"level3","girlEyes instance 10000"),s.eyes.pivot.set(10,11),s.eyes.animations.add("anim1",Phaser.Animation.generateFrameNames("girlEyes instance 1",0,0,"",4),30,!1),s.eyes.animations.add("anim2",Phaser.Animation.generateFrameNames("girlEyes instance 1",1,1,"",4),30,!1),s.group.addChild(s.eyes),s.playAnim("idle",-1),s}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this)},i.prototype.activate=function(){this.playAnim("fear_start"),this.eyes.animations.play("anim2")},i.prototype.onAnimComplete=function(){"fear_start"===this.currAnim&&this.playAnim("fear_cycle",-1)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"idle"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,16,{y:2}),e.GameManager.instance.level.setSimpleTween(this.crown,16,{y:-19}),e.GameManager.instance.level.setSimpleTween(this.base,16,{y:1})):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,15,{y:0}),e.GameManager.instance.level.setSimpleTween(this.crown,15,{y:-20}),e.GameManager.instance.level.setSimpleTween(this.base,15,{y:0})):32===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.crown,9,{x:43,y:-26}),e.GameManager.instance.level.setSimpleTween(this.base,9,{x:6,y:-6,skX:5,scY:.82})):33===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.eyes,8,{x:75,y:-3}):41===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,29,{x:70,y:0}),e.GameManager.instance.level.setSimpleTween(this.crown,29,{x:36,y:-20}),e.GameManager.instance.level.setSimpleTween(this.base,29,{x:0,y:0,skX:0,scY:.75})):70===this.counterAnim&&this.animComplete():"fear_start"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,5,{x:66,y:-10,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.crown,5,{x:31,y:-27,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.base,5,{x:-3,y:-4,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.wheel1,5,{y:40,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.wheel2,8,{y:43})):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,6,{x:71,y:-1,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.crown,6,{x:40,y:-24,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.base,6,{x:7,y:-7,skX:5,skY:5,scX:.69}),e.GameManager.instance.level.setSimpleTween(this.wheel1,6,{x:85,y:53,skX:5,skY:5})):9===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.wheel2,3,{y:39,skX:6,skY:6}):12===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,5,{x:70,y:10,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.crown,5,{x:36,y:-10,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.base,5,{x:6,y:10,skX:0,skY:0,scX:.68}),e.GameManager.instance.level.setSimpleTween(this.wheel1,5,{x:87,y:54,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.wheel2,5,{x:30,y:53,skX:0,skY:0})):17===this.counterAnim&&this.animComplete():"fear_cycle"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,2,{x:69}),e.GameManager.instance.level.setSimpleTween(this.crown,2,{x:37}),e.GameManager.instance.level.setSimpleTween(this.base,2,{x:5})):3===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,2,{x:70}),e.GameManager.instance.level.setSimpleTween(this.crown,2,{x:36}),e.GameManager.instance.level.setSimpleTween(this.base,2,{x:6})):5===this.counterAnim&&this.animComplete():"fear_end"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,7,{y:0}),e.GameManager.instance.level.setSimpleTween(this.crown,7,{y:-20}),e.GameManager.instance.level.setSimpleTween(this.base,7,{x:0,y:0,scX:.75}),e.GameManager.instance.level.setSimpleTween(this.wheel1,7,{x:91,y:53}),e.GameManager.instance.level.setSimpleTween(this.wheel2,7,{x:26})):8===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"idle"===e?(this.setPart(this.eyes,{x:70,y:0,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.crown,{x:36,y:-20,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:0,y:0,angle:0,scX:.75,scY:.75,skX:0,skY:0}),this.setPart(this.wheel1,{x:91,y:53,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.wheel2,{x:26,y:53,angle:0,scX:1,scY:1,skX:0,skY:0})):"fear_start"===e?(this.setPart(this.eyes,{x:70,y:0,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.crown,{x:36,y:-20,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:0,y:0,angle:0,scX:.75,scY:.75,skX:0,skY:0}),this.setPart(this.wheel1,{x:91,y:53,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.wheel2,{x:26,y:53,angle:0,scX:1,scY:1,skX:0,skY:0})):"fear_cycle"===e?(this.setPart(this.eyes,{x:70,y:10,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.crown,{x:36,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:6,y:10,angle:0,scX:.68,scY:.75,skX:0,skY:0}),this.setPart(this.wheel1,{x:87,y:54,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.wheel2,{x:30,y:53,angle:0,scX:1,scY:1,skX:0,skY:0})):"fear_end"===e&&(this.setPart(this.eyes,{x:70,y:10,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.crown,{x:36,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.base,{x:6,y:10,angle:0,scX:.68,scY:.75,skX:0,skY:0}),this.setPart(this.wheel1,{x:87,y:54,angle:0,scX:1,scY:1,skX:0,skY:0}),this.setPart(this.wheel2,{x:30,y:53,angle:0,scX:1,scY:1,skX:0,skY:0}))},i.prototype.free=function(){this.group=null,this.eyes=null,this.crown=null,this.base=null,this.wheel1=null,this.wheel2=null},i}(e.BasicSimpleAnim);e.Lvl3Princess=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.roof2=e.GameManager.instance.layerBackground.create(531,117,"level3","roof2 instance 10000"),i.physics.box2d.enable(s.roof2),s.roof2.body.setRectangle(276,10),s.roof2.body.angle=5,s.roof2.body.static=!0,s.roof2.body.setCollisionCategory(e.FilterGroups.WALL),s.roof1=e.GameManager.instance.layerBackground.create(260,120,"level3","roof1 instance 10000"),i.physics.box2d.enable(s.roof1),s.roof1.body.setRectangle(250,10),s.roof1.body.angle=-6,s.roof1.body.static=!0,s.roof1.body.sensor=!0,s.roof1.body.setCollisionCategory(e.FilterGroups.WALL),s.column1=e.GameManager.instance.layerBackground.create(164,218,"level3","column1 instance 10000"),i.physics.box2d.enable(s.column1),s.column1.body.setRectangle(22,196),s.column1.pivot.x=7,s.column1.body.setCollisionCategory(e.FilterGroups.WALL),s.column2=e.GameManager.instance.layerBackground.create(305,211,"level3","column2 instance 10000"),i.physics.box2d.enable(s.column2),s.column2.body.setRectangle(22,208),s.column2.body.setCollisionCategory(e.FilterGroups.WALL),s.column3=e.GameManager.instance.layerBackground.create(496,213,"level3","column3 instance 10000"),i.physics.box2d.enable(s.column3),s.column3.body.setRectangle(22,208),s.column3.pivot.x=-4,s.column3.body.setCollisionCategory(e.FilterGroups.WALL),s.column4=e.GameManager.instance.layerBackground.create(627,218,"level3","column4 instance 10000"),i.physics.box2d.enable(s.column4),s.column4.body.setRectangle(28,172),s.column4.pivot.x=-13,s.column4.body.kinematic=!0,s.column4.body.setCollisionCategory(e.FilterGroups.WALL);var a=new Phaser.Physics.Box2D.Body(i,null,400,320,0);return a.setRectangle(488,16),i.physics.box2d.revoluteJoint(s.column1,a,11,98,-225,-4),i.physics.box2d.revoluteJoint(s.column2,a,0,104,-84,-5),i.physics.box2d.revoluteJoint(s.column3,a,0,104,107,-3),i.physics.box2d.revoluteJoint(s.column4,a,14,98,241,-4),i.physics.box2d.revoluteJoint(s.column1,s.roof1,0,-88,-96,0),i.physics.box2d.revoluteJoint(s.column2,s.roof1,0,-97,57,0),i.physics.box2d.revoluteJoint(s.column3,s.roof2,0,-98,-24,0),s}return __extends(i,t),i.prototype.crash=function(){this.roof1.body.dynamic=!0,this.roof2.body.dynamic=!0,this.column4.body.dynamic=!0},i.prototype.free=function(){this.column1=null,this.column2=null,this.column3=null,this.column4=null,this.roof1=null,this.roof2=null},i}(e.BasicElement);e.Lvl3Roof=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.active=!1,s.percent=.5,s.bg=e.GameManager.instance.layerBackground.create(308,295,"level3","swordPanel instance 10000"),s.bg.visible=!1,s.progress=i.make.sprite(53,28,"level3","swordPanelProgress instance 10000"),s.bg.addChild(s.progress),s.progress.scale.x=s.percent,s.btn=i.make.button(5,8,"level3",null,null,"swordPanelBtn instance 10001","swordPanelBtn instance 10000","swordPanelBtn instance 10002"),s.btn.onInputDown.add(s.btnDown,s),s.bg.addChild(s.btn),s}return __extends(i,t),i.prototype.btnDown=function(){this.percent+=.1,this.setProgress()},i.prototype.show=function(){this.bg.visible=!0,this.active=!0},i.prototype.complete=function(){this.active=!1,this.bg.visible=!1,e.GameManager.instance.level.customAction(7)},i.prototype.failed=function(){this.active=!1,this.bg.visible=!1,e.GameManager.instance.level.customAction(8)},i.prototype.update=function(){!0===this.active&&(this.percent-=.004,this.setProgress())},i.prototype.setProgress=function(){this.percent>=1?(this.percent=1,this.complete()):this.percent<=0&&(this.percent=0,this.failed()),this.progress.scale.x=this.percent},i.prototype.free=function(){this.bg=null,this.btn=null,this.progress=null},i}(e.BasicElement);e.Lvl3SwordPanel=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.updateWheels=!0,s.moving=!1,s.weaponTrowed=!1,s.game=i,s.bodyBase=new Phaser.Physics.Box2D.Body(i,null,860,433,2),s.bodyBase.setRectangle(106,52),s.bodyBase.setCollisionCategory(e.FilterGroups.CAR2),s.group=new e.SAGroup(i,s.bodyBase.x,s.bodyBase.y),e.GameManager.instance.layerBackground.addChild(s.group),s.tube=new e.SASprite(i,0,0,"level3"),s.tube.pivot.set(17,14),s.tube.animations.add("anim",Phaser.Animation.generateFrameNames("warriorTube instance 1",0,14,"",4),30,!0),s.tube.animations.play("anim"),s.group.addChild(s.tube),s.base=new e.SASprite(i,0,0,"level3","warriorBody instance 10000"),s.base.pivot.set(59,28),s.group.addChild(s.base),s.eyes=new e.SASprite(i,0,0,"level3"),s.eyes.pivot.set(10,29),s.eyes.animations.add("stand",Phaser.Animation.generateFrameNames("warriorEyes instance 1",0,0,"",4),30,!1),s.eyes.animations.add("close",Phaser.Animation.generateFrameNames("warriorEyes instance 1",1,45,"",4),30,!1),s.eyes.animations.add("hit",Phaser.Animation.generateFrameNames("warriorEyes instance 1",46,69,"",4),30,!1),s.eyes.animations.play("stand"),s.group.addChild(s.eyes),s.wheel1=new e.SASprite(i,0,0,"level3","warriorWheel1 instance 10000"),s.wheel1.anchor.setTo(.5),e.GameManager.instance.layerBackground.addChild(s.wheel1),s.wheel2=new e.SASprite(i,0,0,"level3","warriorWheel2 instance 10000"),s.wheel2.anchor.setTo(.5),e.GameManager.instance.layerBackground.addChild(s.wheel2),s.bodyWheel1=new Phaser.Physics.Box2D.Body(i,null,s.bodyBase.x-29,s.bodyBase.y+25,2),s.bodyWheel1.setCircle(16),s.bodyWheel1.friction=1,s.bodyWheel1.setCollisionCategory(e.FilterGroups.CAR2),i.physics.box2d.revoluteJoint(s.bodyBase,s.bodyWheel1,-29,25),s.bodyWheel2=new Phaser.Physics.Box2D.Body(i,null,s.bodyBase.x+37,s.bodyBase.y+25,2),s.bodyWheel2.setCircle(16),s.bodyWheel2.friction=1,s.bodyWheel2.setCollisionCategory(e.FilterGroups.CAR2),s.joint=i.physics.box2d.revoluteJoint(s.bodyBase,s.bodyWheel2,37,25,0,0,0,5,!1),s.whiteBlick=new e.SASprite(i,0,0,"level3","whiteBlick instance 10000"),s.whiteBlick.pivot.set(55,55),s.group.addChild(s.whiteBlick),s.frogLeg2=new e.SASprite(i,0,0,"level3","frogLeg2 instance 10000"),s.frogLeg2.pivot.set(4,7),s.group.addChild(s.frogLeg2),s.frogLeg1=new e.SASprite(i,0,0,"level3","frogLeg1 instance 10000"),s.frogLeg1.pivot.set(8,2),s.group.addChild(s.frogLeg1),s.frogBase=new e.SASprite(i,0,0,"level3"),s.frogBase.pivot.set(24,21),s.frogBase.animations.add("anim",Phaser.Animation.generateFrameNames("frogBase instance 1",0,46,"",4),30,!0),s.frogBase.animations.play("anim"),s.group.addChild(s.frogBase),s.frogEyes=new e.SASprite(i,0,0,"level3"),s.frogEyes.pivot.set(13,11),s.frogEyes.animations.add("anim",Phaser.Animation.generateFrameNames("frogEyes instance 1",0,21,"",4),30,!0),s.frogEyes.animations.play("anim"),s.group.addChild(s.frogEyes),s.frogLeg3=new e.SASprite(i,0,0,"level3","frogLeg3 instance 10000"),s.frogLeg3.pivot.set(5,7),s.group.addChild(s.frogLeg3),s.frogLeg4=new e.SASprite(i,0,0,"level3","frogLeg4 instance 10000"),s.frogLeg4.pivot.set(9,2),s.group.addChild(s.frogLeg4),s.frogLeg5=new e.SASprite(i,0,0,"level3","frogLeg5 instance 10000"),s.frogLeg5.pivot.set(11,13),s.group.addChild(s.frogLeg5),s.blueBlick=new e.SASprite(i,0,0,"level3","blueBlick instance 10000"),s.blueBlick.pivot.set(51,51),s.group.addChild(s.blueBlick),s.light=new e.SASprite(i,0,0,"level3","warriorLight instance 10000"),s.light.pivot.set(14,14),s.group.addChild(s.light),s.frogAnim=new e.SASprite(i,0,0,"level3"),s.frogAnim.pivot.set(60,100),s.frogAnim.animations.add("anim",Phaser.Animation.generateFrameNames("frogAnim instance 1",0,13,"",4),30,!1),s.group.addChild(s.frogAnim),s.setParts("anim"),s}return __extends(i,t),i.prototype.transformation=function(){this.updateWheels=!1,this.wheel1.rotation=0,this.wheel2.rotation=0,e.GameManager.instance.layerBackground.removeChild(this.wheel1),e.GameManager.instance.layerBackground.removeChild(this.wheel2),this.group.addChildAt(this.wheel1,this.group.getChildIndex(this.eyes)),this.group.addChildAt(this.wheel2,this.group.getChildIndex(this.eyes)),this.playAnim("anim"),this.moveStop(!0)},i.prototype.moveStart=function(e){this.moving=!0,this.speed=e,this.joint.EnableMotor(!0)},i.prototype.moveStop=function(e){void 0===e&&(e=!1),this.moving=!1,this.joint.EnableMotor(!1),!0===e&&(this.bodyBase.velocity.x=0,this.bodyWheel1.velocity.x=0,this.bodyWheel2.velocity.x=0,this.bodyWheel1.angularVelocity=0,this.bodyWheel2.angularVelocity=0)},i.prototype.takeWeapon=function(t){this.weapon=t,this.eyes.animations.play("close"),e.GameManager.instance.layerBackground.removeChild(this.weapon.graphic),this.weapon.graphic.x=t.graphic.x-this.group.x,this.weapon.graphic.y=t.graphic.y-this.group.y,this.group.addChild(this.weapon.graphic),this.weapon.takeWarrior()},i.prototype.defeatSwordBattle=function(){this.eyes.animations.play("hit"),this.headStars=this.group.create(-40,-60,"level3"),this.headStars.animations.add("anim",Phaser.Animation.generateFrameNames("stars instance 1",0,16,"",4),30,!0),this.headStars.animations.play("anim")},i.prototype.trowWeapon=function(){this.weaponTrowed=!0,this.group.removeChild(this.weapon.graphic),this.weapon.graphic.x=this.bodyBase.x,this.weapon.graphic.y=this.bodyBase.y,this.weapon.graphic.angle=0,this.weapon.graphic.pivot.set(0,0),this.weapon.graphic.anchor.setTo(.5),e.GameManager.instance.layerElements.addChild(this.weapon.graphic),this.bodyWeapon=new Phaser.Physics.Box2D.Body(this.game,null,this.bodyBase.x+40,this.bodyBase.y,2),"sword"===this.weapon.frameName?(this.bodyWeapon.setRectangle(96,12),this.bodyWeapon.addRectangle(10,32,33)):"mace"===this.weapon.frameName?(this.bodyWeapon.setRectangle(94,10),this.bodyWeapon.addRectangle(10,34,-33)):"spear"===this.weapon.frameName&&(this.bodyWeapon.setRectangle(108,4),this.bodyWeapon.addRectangle(10,20,25)),this.bodyWeapon.setCollisionMask(~e.FilterGroups.IGNORE_CAR)},i.prototype.update=function(){t.prototype.update.call(this),!0===this.weaponTrowed&&(this.weapon.graphic.x=this.bodyWeapon.x,this.weapon.graphic.y=this.bodyWeapon.y,this.weapon.graphic.rotation=this.bodyWeapon.rotation),!0===this.moving&&this.joint.SetMotorSpeed(this.speed),this.group.x=this.bodyBase.x,this.group.y=this.bodyBase.y,this.group.rotation=this.bodyBase.rotation,!0===this.updateWheels&&(this.wheel1.x=this.bodyWheel1.x,this.wheel1.y=this.bodyWheel1.y,this.wheel1.rotation=this.bodyWheel1.rotation,this.wheel2.x=this.bodyWheel2.x,this.wheel2.y=this.bodyWheel2.y,this.wheel2.rotation=this.bodyWheel2.rotation,this.bodyBase.angle<-40&&(this.bodyBase.angularVelocity=2))},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.light,20,{x:-55,y:-58,scX:.95,scY:.95,alpha:1}),this.setPart(this.wheel2,{x:37,y:25,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.wheel1,{x:-29,y:25,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eyes,{x:-7,y:-31,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),this.setPart(this.base,{x:1,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tube,{x:34,y:-24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):21===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.light,20,{x:-58,y:-60,scX:1,scY:1,alpha:0}):41===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.light,15,{x:-55,y:-57,scX:.95,scY:.94,alpha:1}):56===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.light,20,{x:-58,y:-60,scX:1,scY:1,alpha:0}):76===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.light,20,{x:-60,y:-73,skX:-3,skY:-3,scY:1.08,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.wheel2,20,{x:42,y:15}),e.GameManager.instance.level.setSimpleTween(this.wheel1,20,{x:-26,y:20}),e.GameManager.instance.level.setSimpleTween(this.eyes,20,{x:-6,y:-44,skX:-6,skY:174}),e.GameManager.instance.level.setSimpleTween(this.base,20,{x:2,y:-12,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.tube,20,{x:32,y:-40,skX:-18,skY:-18})):96===this.counterAnim?(e.SoundManager.playSFX("sfx_whiteWizard"),e.GameManager.instance.level.setSimpleTween(this.light,19,{x:-37,y:-91,skX:18,skY:17,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.wheel2,10,{x:40,y:27,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.wheel1,10,{x:-40,y:18,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.eyes,10,{x:-9,y:-48,skX:3,skY:190,scY:1.07}),e.GameManager.instance.level.setSimpleTween(this.base,10,{x:0,y:-16,skX:8,skY:8}),e.GameManager.instance.level.setSimpleTween(this.tube,10,{x:51,y:-29,skX:1,skY:7,scX:1.26})):106===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wheel2,20,{x:-4,y:-16,skX:61,skY:61,scX:.25,scY:.25}),e.GameManager.instance.level.setSimpleTween(this.wheel1,20,{x:-9,y:-23,skX:61,skY:61,scX:.25,scY:.25}),e.GameManager.instance.level.setSimpleTween(this.eyes,20,{x:1,y:-24,skX:48,skY:-125,scX:.25,scY:.26}),e.GameManager.instance.level.setSimpleTween(this.base,20,{x:-4,y:-22,skX:52,skY:52,scX:.23,scY:.23}),e.GameManager.instance.level.setSimpleTween(this.tube,20,{x:4,y:-17,skX:46,skY:52,scX:.34,scY:.27})):115===this.counterAnim?(this.setPart(this.light,{x:-37,y:-91,angle:0,scX:1,scY:1.08,skX:18,skY:17,alpha:0}),this.blueBlick.visible=!0,this.setPart(this.blueBlick,{x:-2,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.blueBlick,8,{alpha:1})):116===this.counterAnim?this.light.visible=!1:123===this.counterAnim?(this.frogAnim.visible=!0,this.frogAnim.animations.play("anim"),this.setPart(this.frogAnim,{x:0,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.blueBlick,6,{x:-3,y:-35,alpha:.4}),this.whiteBlick.visible=!0,this.setPart(this.whiteBlick,{x:-3,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.whiteBlick,3,{alpha:1})):124===this.counterAnim?(this.frogBase.visible=!0,this.setPart(this.frogBase,{x:-5,y:-19,angle:0,scX:.34,scY:.34,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.frogBase,5,{y:-27,scX:1.06,scY:1.06})):126===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.whiteBlick,6,{x:-2,y:-35,scX:1.73,scY:1.73,alpha:0}),this.setPart(this.wheel2,{x:-4,y:-16,angle:0,scX:.25,scY:.25,skX:61,skY:61,alpha:1}),this.setPart(this.wheel1,{x:-9,y:-23,angle:0,scX:.25,scY:.25,skX:61,skY:61,alpha:1}),this.setPart(this.eyes,{x:1,y:-24,angle:0,scX:.25,scY:.26,skX:48,skY:-125,alpha:1}),this.setPart(this.base,{x:-4,y:-22,angle:0,scX:.23,scY:.23,skX:52,skY:52,alpha:1}),this.setPart(this.tube,{x:4,y:-17,angle:0,scX:.34,scY:.27,skX:46,skY:52,alpha:1})):127===this.counterAnim?(this.wheel2.visible=!1,this.wheel1.visible=!1,this.eyes.visible=!1,this.base.visible=!1,this.tube.visible=!1):129===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.blueBlick,4,{y:-46,alpha:0}),this.frogLeg5.visible=!0,this.setPart(this.frogLeg5,{x:9,y:-24,angle:0,scX:.36,scY:.36,skX:-84,skY:-84,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.frogLeg5,4,{x:13,y:-35,skX:-112,skY:-112,scX:.68,scY:.68}),this.frogLeg4.visible=!0,this.setPart(this.frogLeg4,{x:4,y:-45,angle:0,scX:.34,scY:.36,skX:124,skY:123,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.frogLeg4,4,{x:14,y:-82,skX:106,skY:104,scX:1.09,scY:1.11}),this.frogLeg3.visible=!0,this.setPart(this.frogLeg3,{x:1,y:-40,angle:0,scX:.35,scY:.35,skX:-160,skY:-160,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.frogLeg3,4,{x:6,y:-64,skX:-178,skY:-178,scX:1.1,scY:1.1}),this.frogEyes.visible=!0,this.setPart(this.frogEyes,{x:-19,y:-39,angle:0,scX:.37,scY:.26,skX:17,skY:17,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.frogEyes,4,{x:-17,y:-53,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.frogBase,4,{y:-52}),this.frogLeg1.visible=!0,this.setPart(this.frogLeg1,{x:-27,y:-34,angle:0,scX:.68,scY:.68,skX:-136,skY:-136,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.frogLeg1,4,{x:-36,y:-76,skX:-110,skY:-110,scX:1,scY:1}),this.frogLeg2.visible=!0,this.setPart(this.frogLeg2,{x:-12,y:-34,angle:0,scX:1,scY:1.33,skX:123,skY:123,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.frogLeg2,4,{x:-28,y:-61,skX:149,skY:149})):132===this.counterAnim?this.setPart(this.whiteBlick,{x:-2,y:-35,angle:0,scX:1.73,scY:1.73,skX:0,skY:0,alpha:0}):133===this.counterAnim?(this.setPart(this.blueBlick,{x:-3,y:-46,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.frogLeg5,4,{x:12,y:1,skX:-145,skY:-145,scY:.87}),e.GameManager.instance.level.setSimpleTween(this.frogLeg4,4,{x:11,y:-24}),e.GameManager.instance.level.setSimpleTween(this.frogLeg3,4,{x:3,y:-7}),e.GameManager.instance.level.setSimpleTween(this.frogEyes,4,{x:-18,y:13}),e.GameManager.instance.level.setSimpleTween(this.frogBase,4,{y:14}),e.GameManager.instance.level.setSimpleTween(this.frogLeg1,4,{x:-28,y:-16,skX:-93,skY:-93}),e.GameManager.instance.level.setSimpleTween(this.frogLeg2,4,{x:-24,y:1,skX:166,skY:166}),this.whiteBlick.visible=!1):134===this.counterAnim?this.blueBlick.visible=!1:137===this.counterAnim?(this.frogAnim.visible=!1,e.GameManager.instance.level.setSimpleTween(this.frogLeg5,2,{x:20,y:29,skX:-52,skY:-52}),e.GameManager.instance.level.setSimpleTween(this.frogLeg4,2,{x:28,y:16,skX:170,skY:172,scY:1.1}),e.GameManager.instance.level.setSimpleTween(this.frogLeg3,2,{x:9,y:15,skX:-112,skY:-112}),e.GameManager.instance.level.setSimpleTween(this.frogEyes,2,{y:23}),e.GameManager.instance.level.setSimpleTween(this.frogBase,2,{y:25,scY:.76}),this.setPart(this.frogLeg1,{x:-28,y:-16,angle:0,scX:1,scY:1,skX:-93,skY:-93,alpha:1}),this.setPart(this.frogLeg2,{x:-24,y:1,angle:0,scX:1,scY:1.33,skX:166,skY:166,alpha:1})):138===this.counterAnim?(this.setPart(this.frogLeg1,{x:-44,y:-3,angle:0,scX:1,scY:1,skX:-137,skY:-137,alpha:1}),this.setPart(this.frogLeg2,{x:-31,y:8,angle:0,scX:1,scY:1.33,skX:132,skY:132,alpha:1})):139===this.counterAnim?(this.setPart(this.frogLeg5,{x:20,y:29,angle:0,scX:.68,scY:.87,skX:-52,skY:-52,alpha:1}),this.setPart(this.frogLeg4,{x:28,y:16,angle:0,scX:1.09,scY:1.1,skX:170,skY:172,alpha:1}),this.setPart(this.frogLeg3,{x:9,y:15,angle:0,scX:1.1,scY:1.1,skX:-112,skY:-112,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.frogEyes,2,{y:13}),e.GameManager.instance.level.setSimpleTween(this.frogBase,2,{y:15,scY:1.02}),this.setPart(this.frogLeg1,{x:-46,y:9,angle:0,scX:1,scY:1,skX:-171,skY:-171,alpha:1}),this.setPart(this.frogLeg2,{x:-32,y:14,angle:0,scX:1,scY:1.33,skX:116,skY:116,alpha:1})):140===this.counterAnim?(this.setPart(this.frogLeg5,{x:21,y:27,angle:0,scX:.8,scY:.98,skX:-26,skY:-26,alpha:1}),this.setPart(this.frogLeg4,{x:25,y:26,angle:0,scX:1,scY:1.1,skX:-138,skY:-138,alpha:1}),this.setPart(this.frogLeg3,{x:11,y:14,angle:0,scX:1.1,scY:1.1,skX:-89,skY:-89,alpha:1}),this.setPart(this.frogLeg1,{x:-48,y:15,angle:0,scX:1,scY:1,skX:154,skY:154,alpha:1}),this.setPart(this.frogLeg2,{x:-33,y:13,angle:0,scX:1,scY:1.33,skX:99,skY:99,alpha:1})):141===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.frogLeg5,4,{x:11,y:16,skX:2,skY:2,scX:1.04,scY:1.24}),this.setPart(this.frogLeg4,{x:10,y:33,angle:0,scX:.9,scY:1.1,skX:-86,skY:-88,alpha:1}),this.setPart(this.frogLeg3,{x:6,y:20,angle:0,scX:1.1,scY:1.1,skX:-63,skY:-63,alpha:1}),this.setPart(this.frogEyes,{x:-18,y:13,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.frogBase,4,{y:-13,scY:1.11}),this.setPart(this.frogLeg1,{x:-46,y:20,angle:0,scX:1,scY:1,skX:120,skY:120,alpha:1}),this.setPart(this.frogLeg2,{x:-34,y:13,angle:0,scX:1,scY:1.33,skX:82,skY:82,alpha:1})):142===this.counterAnim?(this.setPart(this.frogLeg4,{x:2,y:32,angle:0,scX:.76,scY:1.08,skX:-111,skY:-113,alpha:1}),this.setPart(this.frogLeg3,{x:3,y:16,angle:0,scX:1.1,scY:1.1,skX:-12,skY:-12,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.frogEyes,3,{x:-19,y:-11}),this.setPart(this.frogLeg1,{x:-38,y:23,angle:0,scX:1,scY:1,skX:85,skY:85,alpha:1}),this.setPart(this.frogLeg2,{x:-30,y:14,angle:0,scX:1,scY:1.33,skX:65,skY:65,alpha:1})):143===this.counterAnim?(this.setPart(this.frogLeg4,{x:-7,y:28,angle:0,scX:.5,scY:1.05,skX:-89,skY:-91,alpha:1}),this.setPart(this.frogLeg3,{x:0,y:18,angle:0,scX:1.05,scY:1.05,skX:16,skY:16,alpha:1}),this.setPart(this.frogLeg1,{x:-26,y:26,angle:0,scX:1,scY:1,skX:43,skY:43,alpha:1}),this.setPart(this.frogLeg2,{x:-27,y:16,angle:0,scX:1,scY:1.16,skX:32,skY:32,alpha:1})):144===this.counterAnim?(this.setPart(this.frogLeg4,{x:-10,y:20,angle:0,scX:1,scY:1,skX:-38,skY:-35,alpha:1}),this.setPart(this.frogLeg3,{x:0,y:10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.frogLeg1,{x:-23,y:26,angle:0,scX:1,scY:1,skX:82,skY:82,alpha:1}),this.setPart(this.frogLeg2,{x:-24,y:12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):145===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.frogLeg5,6,{x:13,y:23,skX:1,skY:1,scX:.93,scY:1.11}),e.GameManager.instance.level.setSimpleTween(this.frogLeg4,6,{x:-11,y:36,skX:-3,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.frogLeg3,6,{x:2,y:29}),e.GameManager.instance.level.setSimpleTween(this.frogEyes,6,{x:-18,y:13}),e.GameManager.instance.level.setSimpleTween(this.frogBase,3,{y:19,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.frogLeg1,6,{x:-19,y:36,skX:2,skY:2}),e.GameManager.instance.level.setSimpleTween(this.frogLeg2,6,{x:-25,y:31})):148===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.frogBase,3,{y:15,scY:1.03}):151===this.counterAnim&&(e.GameManager.instance.level.customAction(9),this.animComplete())))},i.prototype.setParts=function(e){"anim"===e&&(this.frogAnim.visible=!1,this.setPart(this.light,{x:-58,y:-60,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0}),this.blueBlick.visible=!1,this.frogLeg5.visible=!1,this.frogLeg4.visible=!1,this.frogLeg3.visible=!1,this.frogEyes.visible=!1,this.frogBase.visible=!1,this.frogLeg1.visible=!1,this.frogLeg2.visible=!1,this.whiteBlick.visible=!1,this.setPart(this.wheel2,{x:37,y:25,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.wheel1,{x:-29,y:25,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eyes,{x:-7,y:-31,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),this.setPart(this.base,{x:1,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tube,{x:34,y:-24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.game=null,this.group=null,this.stars=null,this.tube=null,this.base=null,this.eyes=null,this.wheel1=null,this.wheel2=null,this.light=null,this.blueBlick=null,this.whiteBlick=null,this.frogBase=null,this.frogEyes=null,this.frogLeg1=null,this.frogLeg2=null,this.frogLeg3=null,this.frogLeg4=null,this.frogLeg5=null,this.frogAnim=null,this.headStars=null,this.bodyBase=null,this.bodyWheel1=null,this.bodyWheel2=null,this.weapon=null,this.joint=null,this.bodyWeapon=null},i}(e.BasicSimpleAnim);e.Lvl3Warrior=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n,o,r){var l=t.call(this)||this;return l.activeElement=!1,l.attackActive=!1,l.attackCounter=0,l.onHero=!1,l.weaponTrowed=!1,l.game=i,l.activeElement=r,l.graphic=e.GameManager.instance.layerBackground.create(a,n,"level3",s+" instance 10002"),"sword"===s?l.graphic.anchor.setTo(.08,.47):"mace"===s?l.graphic.anchor.setTo(.12,.58):"spear"===s&&l.graphic.anchor.setTo(.09,.5),l.frameName=s,!0===r?(l.graphic.events.onInputOut.add(l.btnOut,l),l.graphic.events.onInputOver.add(l.btnOver,l),l.graphic.events.onInputDown.addOnce(l.btnDown,l)):l.graphic.scale.x=-1,l.graphic.angle=o*l.graphic.scale.x,l}return __extends(i,t),i.prototype.btnOut=function(){!0===this.graphic.inputEnabled&&(this.graphic.frameName=this.frameName+" instance 10000")},i.prototype.btnOver=function(){!0===this.graphic.inputEnabled&&(this.graphic.frameName=this.frameName+" instance 10001")},i.prototype.btnDown=function(){this.onHero=!0,e.SoundManager.playSFX("btnClick"),e.GameManager.instance.level.customAction(1),this.take()},i.prototype.activate=function(){!1!==this.activeElement&&(this.graphic.inputEnabled=!0,this.graphic.input.useHandCursor=!0,this.btnOut())},i.prototype.deactivate=function(){!1!==this.activeElement&&(this.graphic.inputEnabled=!1,this.graphic.frameName=this.frameName+" instance 10002")},i.prototype.take=function(){e.GameManager.instance.layerBackground.removeChild(this.graphic),this.graphic.x=this.graphic.x-e.GameManager.instance.hero.baseGroup.x,this.graphic.y=this.graphic.y-e.GameManager.instance.hero.baseGroup.y,e.GameManager.instance.hero.baseGroup.addChild(this.graphic),"sword"===this.frameName?e.GameManager.instance.level.setSimpleTween(this.graphic,20,{x:35,y:5,angle:-60}):"mace"===this.frameName?(e.GameManager.instance.level.setSimpleTween(this.graphic,20,{x:35,y:5,angle:-134}),this.stX=35,this.stY=5):"spear"===this.frameName&&(e.GameManager.instance.level.setSimpleTween(this.graphic,20,{x:-10,y:5,angle:0}),this.stX=-10,this.stY=5)},i.prototype.takeWarrior=function(){"sword"===this.frameName?e.GameManager.instance.level.setSimpleTween(this.graphic,20,{x:-35,y:0,angle:60}):"mace"===this.frameName?(e.GameManager.instance.level.setSimpleTween(this.graphic,20,{x:-20,y:0,angle:134}),this.stX=-20,this.stY=0):"spear"===this.frameName&&(e.GameManager.instance.level.setSimpleTween(this.graphic,20,{x:10,y:5,angle:0}),this.stX=10,this.stY=5)},i.prototype.attack=function(){!0!==this.attackActive&&(this.attackActive=!0,this.attackCounter=0)},i.prototype.trowWeapon=function(){this.weaponTrowed=!0,e.GameManager.instance.hero.baseGroup.removeChild(this.graphic),this.graphic.x=e.GameManager.instance.hero.bodyBase.x,this.graphic.y=e.GameManager.instance.hero.bodyBase.y,this.graphic.angle=0,this.graphic.pivot.set(0,0),this.graphic.anchor.setTo(.5),e.GameManager.instance.layerElements.addChild(this.graphic),this.bodyWeapon=new Phaser.Physics.Box2D.Body(this.game,null,e.GameManager.instance.hero.bodyBase.x-40,e.GameManager.instance.hero.bodyBase.y,2),"sword"===this.frameName?(this.bodyWeapon.setRectangle(96,12),this.bodyWeapon.addRectangle(10,32,-33)):"mace"===this.frameName?(this.bodyWeapon.setRectangle(94,10),this.bodyWeapon.addRectangle(10,34,33)):"spear"===this.frameName&&(this.bodyWeapon.setRectangle(108,4),this.bodyWeapon.addRectangle(10,20,-25)),this.bodyWeapon.setCollisionMask(~e.FilterGroups.IGNORE_CAR)},i.prototype.update=function(){!0===this.weaponTrowed&&(this.graphic.x=this.bodyWeapon.x,this.graphic.y=this.bodyWeapon.y,this.graphic.rotation=this.bodyWeapon.rotation),!0===this.attackActive&&(this.attackCounter+=1,!0===this.onHero?this.animOnHero():this.animOnWarrior())},i.prototype.animOnHero=function(){"sword"===this.frameName?1===this.attackCounter?(e.SoundManager.playSFX("s_sword1"),e.GameManager.instance.level.setSimpleTween(this.graphic,5,{angle:-71})):6===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,3,{angle:-37}):9===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,4,{angle:30}):13===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,7,{angle:-60}):20===this.attackCounter&&(this.attackActive=!1):"mace"===this.frameName?(this.attackCounter<8&&e.GameManager.instance.level.customAction(5),1===this.attackCounter?(e.SoundManager.playSFX("sfx_mace"),e.GameManager.instance.level.setSimpleTween(this.graphic,3,{x:this.stX+9,y:this.stY-20,angle:-81})):4===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,5,{x:this.stX+26,y:this.stY-12,angle:7}):9===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,2,{x:this.stX,y:this.stY-13,angle:0}):11===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,4,{x:this.stX-11,y:this.stY-13,angle:0}):15===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,18,{x:this.stX,y:this.stY,angle:-134}):33===this.attackCounter&&(this.attackActive=!1)):"spear"===this.frameName&&(1===this.attackCounter?(e.SoundManager.playSFX("sfx_lance"),this.graphic.x=this.stX-20):2===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,8,{x:this.stX+37}):10===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,13,{x:this.stX,y:this.stY,angle:-90}):23===this.attackCounter&&(this.attackActive=!1))},i.prototype.animOnWarrior=function(){"sword"===this.frameName?1===this.attackCounter?(e.SoundManager.playSFX("s_sword1"),e.GameManager.instance.level.setSimpleTween(this.graphic,5,{angle:71})):6===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,3,{angle:37}):9===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,4,{angle:-30}):13===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,7,{angle:60}):20===this.attackCounter&&(this.attackActive=!1):"mace"===this.frameName?1===this.attackCounter?(e.SoundManager.playSFX("sfx_mace"),e.GameManager.instance.level.setSimpleTween(this.graphic,3,{x:this.stX-9,y:this.stY-20,angle:81})):4===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,5,{x:this.stX-26,y:this.stY-12,angle:-7}):9===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,2,{x:this.stX,y:this.stY-13,angle:0}):11===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,4,{x:this.stX+11,y:this.stY-13,angle:0}):15===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,18,{x:this.stX,y:this.stY,angle:134}):33===this.attackCounter&&(this.attackActive=!1):"spear"===this.frameName&&(1===this.attackCounter?(e.SoundManager.playSFX("sfx_lance"),this.graphic.x=this.stX+20):2===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,8,{x:this.stX-37}):10===this.attackCounter?e.GameManager.instance.level.setSimpleTween(this.graphic,13,{x:this.stX,y:this.stY,angle:90}):23===this.attackCounter&&(this.attackActive=!1))},i.prototype.free=function(){this.graphic=null,this.game=null,this.bodyWeapon=null},i}(e.BasicElement);e.Lvl3Weapon=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this,i)||this;return n.kingMove=!1,n.opened=!1,n.playerUseBridge=!1,n.game=i,n.bridge=new Phaser.Group(i),n.bridge.x=s,n.bridge.y=a,n.bridge.pivot.set(20,248),e.GameManager.instance.layerUpper.addChild(n.bridge),n.mask=new Phaser.Graphics(i,130,251),n.mask.beginFill(0,1),n.mask.drawRect(0,0,300,270),n.mask.endFill(),e.GameManager.instance.layerUpper.addChild(n.mask),n.chain=n.bridge.create(10,15,"level4","chain instance 10000"),n.chain.angle=-27,n.chain.anchor.set(0,.5),n.chain.mask=n.mask,n.bridge.create(0,0,"level4","floor instance 10000"),e.GameManager.instance.layerUpper.create(447,260,"level4","bridgeWheel instance 10000").anchor.set(.5),n.arm=e.GameManager.instance.layerUpper.create(350,188,"level4","armBody instance 10000"),n.arm.anchor.set(.5,1),n.arm.angle=15,n.arm.inputEnabled=!1,n.arm.events.onInputUp.add(n.useArm,n),n.arm.events.onInputOver.add(n.over,n),n.arm.events.onInputOut.add(n.out,n),e.GameManager.instance.layerUpper.create(330,178,"level4","armPart instance 10000"),n.body=new Phaser.Physics.Box2D.Body(n.game,null,259,531,0),n.body.setRectangle(242,20),n}return __extends(i,t),i.prototype.over=function(){this.arm.frameName="armBody instance 10001"},i.prototype.out=function(){this.arm.frameName="armBody instance 10002"},i.prototype.useArm=function(){this.playerUseBridge=!0,!1===this.opened?this.game.add.tween(this.arm).to({angle:50},400,"Linear",!0).onComplete.add(this.openBridge,this):this.game.add.tween(this.arm).to({angle:15},400,"Linear",!0).onComplete.add(this.openBridge,this),!0===e.GameManager.instance.level.topCar.patrool&&e.GameManager.instance.level.topCar.closeGate()},i.prototype.carUseArm=function(){!1===this.opened?this.game.add.tween(this.arm).to({angle:50},400,"Linear",!0).onComplete.add(this.openBridge,this):this.game.add.tween(this.arm).to({angle:15},400,"Linear",!0).onComplete.add(this.openBridge,this)},i.prototype.openBridge=function(){this.arm.inputEnabled=!1,this.arm.frameName="armBody instance 10000",!1===this.opened?this.open():this.close()},i.prototype.open=function(){this.game.add.tween(this.bridge).to({angle:-25},1e3,"Linear",!0).onComplete.add(function(){!0===e.GameManager.instance.level.topCar.patrool?!1===this.playerUseBridge?this.fastOpen():(e.SoundManager.stopSFXLoop("s_lvl4_gateUp"),e.SoundManager.playSFX("s_lvl4_gateDown",!0),this.game.add.tween(this.arm).to({angle:15},400,"Linear",!0),this.game.add.tween(this.bridge).to({angle:0},1e3,"Linear",!0),this.game.add.tween(this.chain).to({angle:-27},1e3,"Linear",!0).onComplete.addOnce(this.activateArm,this)):this.fastOpen()},this),this.game.add.tween(this.chain).to({angle:9},1e3,"Linear",!0)},i.prototype.fastOpen=function(){e.SoundManager.stopSFXLoop("s_lvl4_gateUp"),e.SoundManager.playSFX("s_lvl4_gateDown",!0),this.opened=!0,this.game.add.tween(this.bridge).to({angle:-91},1700,"Linear",!0),this.game.add.tween(this.chain).to({angle:46},1700,"Linear",!0).onComplete.add(this.chekKing,this)},i.prototype.close=function(){e.SoundManager.stopSFXLoop("s_lvl4_gateDown"),e.SoundManager.playSFX("s_lvl4_gateUp",!0),this.body.sensor=!0,this.game.add.tween(this.bridge).to({angle:-25},1700,"Linear",!0),this.game.add.tween(this.chain).to({angle:9},1700,"Linear",!0).onComplete.add(function(){this.opened=!1,this.game.add.tween(this.bridge).to({angle:0},1e3,"Linear",!0),this.game.add.tween(this.chain).to({angle:-27},1e3,"Linear",!0).onComplete.addOnce(this.activateArm,this)},this)},i.prototype.activateArm=function(){e.SoundManager.stopSFXLoop("s_lvl4_gateDown"),e.SoundManager.stopSFXLoop("s_lvl4_gateUp"),!0===this.kingMove&&(!1===this.opened?(this.arm.inputEnabled=!0,this.arm.input.useHandCursor=!0,this.arm.frameName="armBody instance 10002",e.GameManager.instance.level.topCar.activateKorzina()):e.GameManager.instance.level.addEye())},i.prototype.chekKing=function(){e.SoundManager.stopSFXLoop("s_lvl4_gateDown"),e.SoundManager.stopSFXLoop("s_lvl4_gateUp"),this.body.sensor=!1,!1===this.kingMove?(this.kingMove=!0,e.GameManager.instance.level.king.goToCastle(),e.GameManager.instance.level.mage.goToCastle()):this.activateArm()},i.prototype.free=function(){this.game=null,this.bridge=null,this.chain=null,this.mask=null,this.arm=null,this.playerUseBridge=null,this.body=null},i}(e.BasicSimpleAnim);e.Lvl4Bridge=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.start=!1,i.step=0,i.counter=0,i.bouble=e.GameManager.instance.layerBackground.create(0,0,"level4","kingBubble instance 10000"),i.bouble.anchor.set(0,1),i.icon=e.Main.instance.make.sprite(55,-55,"level4","bubbleIcon instance 10000"),i.icon.anchor.set(.5),i.bouble.addChild(i.icon),i.bouble.visible=!1,i}return __extends(i,t),i.prototype.showBubbles=function(t,i,s,a){this.bouble.visible=!0,this.icon.frameName="bubbleIcon instance 1000"+a,this.bouble.x=t,this.bouble.y=i,this.bouble.scale.set(0),e.Main.instance.add.tween(this.bouble.scale).to({x:1*s,y:1},350,"Linear",!0)},i.prototype.update=function(){!0===this.start&&(this.counter+=1,0===this.step?(this.showBubbles(1260,390,1,0),this.step=1):1===this.step&&90===this.counter?(e.GameManager.instance.level.king.group.scale.x*=-1,e.GameManager.instance.level.king.group.x-=e.GameManager.instance.level.king.group.width,this.showBubbles(1050,430,1,1),this.step=2,this.counter=0,e.SoundManager.playSFX("s_dialog")):2===this.step&&90===this.counter?(this.bouble.visible=!1,this.step=3,this.counter=0,e.GameManager.instance.level.addMap()):3===this.step&&260===this.counter?(this.showBubbles(1190,410,-1,2),this.step=4,this.counter=0):4===this.step&&120===this.counter&&(this.start=!1,e.SoundManager.playSFX("levelWin"),e.LevelBuilder.instance.levelComplete()))},i.prototype.free=function(){this.bouble=null,this.icon=null},i}(e.BasicElement);e.Lvl4Bubbles=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n,o){var r=t.call(this,i)||this;return r.timer=0,r.canPlay=!0,r.group=i.make.group(),r.group.x=s,r.group.y=a,r.group.scale.x=n,e.GameManager.instance.layerBackground.addChildAt(r.group,1),r.card=new e.SASprite(i,0,0,"level4","card instance 1000"+e.Main.instance.rnd.integerInRange(1,8)),r.card.pivot.set(9,12),r.group.addChild(r.card),0===o&&(r.timer=60),r}return __extends(i,t),i.prototype.setUpdate=function(e){this.canPlay=e},i.prototype.update=function(){t.prototype.update.call(this),this.timer+=1,this.timer>=120&&(this.timer=0,!0===this.canPlay&&this.playAnim("anim"))},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.card,10,{x:-36,y:-24,skX:-126,skY:-126}):11===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.card,10,{x:-46,y:6,skX:-93,skY:-93}):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.card,5,{x:-48,y:11,scX:.15}),!1===e.GameManager.instance.level.cameraMooved&&e.SoundManager.playSFX("s_lvl4_playingCards")):26===this.counterAnim&&(this.animComplete(),this.card.frameName="card instance 1000"+e.Main.instance.rnd.integerInRange(1,8))))},i.prototype.setParts=function(e){"anim"===e&&this.setPart(this.card,{x:-5,y:4,angle:0,scX:1,scY:1,skX:-44,skY:-44,alpha:1})},i.prototype.free=function(){this.group=null,this.card=null},i}(e.BasicSimpleAnim);e.Lvl4Card=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this)||this;a.speed=.003,a.direction=0,a.canUpdate=!0,a.opened=!1,a.back=e.GameManager.instance.layerBackground.create(i,s,"level4","eyeBg instance 10000"),a.progress=e.Main.instance.make.sprite(0,-1,"level4","redProgress instance 10000"),a.progress.scale.x=0,a.back.addChild(a.progress);var n=e.Main.instance.make.sprite(-2,-2,"level4","border instance 10000");return a.back.addChild(n),a.eye=e.Main.instance.make.sprite(-65,-12,"level4","eye instance 10000"),a.eye.animations.add("open",Phaser.Animation.generateFrameNames("eye instance 1",0,4,"",4),30,!1),a.eye.animations.add("close",Phaser.Animation.generateFrameNames("eye instance 1",4,0,"",4),30,!1),a.back.addChild(a.eye),a}return __extends(i,t),i.prototype.update=function(){!0===this.canUpdate&&(!0===e.GameManager.instance.hero.getEnableMotor()?(this.direction=1,!0===e.GameManager.instance.level.heroHided?this.speed=.003:this.speed=.005,!1===this.opened&&(this.opened=!0,this.eye.play("open"))):(this.direction=-1,!0===e.GameManager.instance.level.heroHided?this.speed=.003:this.speed=0,!0===this.opened&&(this.opened=!1,this.eye.play("close"))),this.progress.scale.x+=this.speed*this.direction,this.progress.scale.x>1?(this.progress.scale.x=1,this.canUpdate=!1,e.GameManager.instance.level.warden1.card.setUpdate(!1),e.GameManager.instance.level.warden2.card.setUpdate(!1),e.GameManager.instance.level.warden1.playAnim("hide"),e.GameManager.instance.level.warden2.playAnim("hide"),e.GameManager.instance.hero.bodyBase.x>570?e.GameManager.instance.level.warden1.attackHero(-1):e.GameManager.instance.level.warden2.attackHero(1)):this.progress.scale.x<0&&(this.progress.scale.x=0),e.GameManager.instance.hero.bodyBase.x>725&&(this.canUpdate=!1,this.back.visible=!1))},i.prototype.free=function(){this.back=null,this.eye=null,this.progress=null},i}(e.BasicElement);e.Lvl4Eye=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.dir=0,s.group=i.make.group(),s.group.x=-160,s.group.y=393,e.GameManager.instance.layerElements.addChildAt(s.group,0),s.kingBody=new e.SASprite(i,0,0,"level4","kingBody instance 10000"),s.kingBody.pivot.set(59,46),s.group.addChild(s.kingBody),s.eye=new e.SASprite(i,0,0,"level4","kingEye instance 10000"),s.eye.pivot.set(17,30),s.eye.animations.add("idle",Phaser.Animation.generateFrameNames("kingEye instance 1",0,50,"",4),30,!0),s.eye.play("idle"),s.group.addChild(s.eye),s.hat=new e.SASprite(i,0,0,"level4","kingHat instance 10000"),s.hat.pivot.set(16,20),s.group.addChild(s.hat),s.wheel1=new e.SASprite(i,42,118,"level4","kingWheel2_mc instance 10000"),s.wheel1.anchor.set(.5),s.group.addChild(s.wheel1),s.wheel2=new e.SASprite(i,78,115,"level4","kingWheel1_mc instance 10000"),s.wheel2.anchor.set(.5),s.group.addChild(s.wheel2),s.playAnim("idle2",-1),s}return __extends(i,t),i.prototype.goToCastle=function(){this.dir=1,e.Main.instance.add.tween(this.group).to({x:1e3},8e3,"Linear",!0).onComplete.add(function(){this.dir=0,this.group.x=1180,this.group.y=370,this.playAnim("cycle",-1)},this)},i.prototype.update=function(){t.prototype.update.call(this),this.wheel1.angle+=2*this.dir,this.wheel2.angle+=2*this.dir},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"cycle"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye,15,{x:93,y:51}),e.GameManager.instance.level.setSimpleTween(this.hat,15,{x:76,y:18,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.kingBody,15,{x:61,y:70,skX:4,scY:1})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye,16,{x:94,y:58}),e.GameManager.instance.level.setSimpleTween(this.hat,16,{x:78,y:24}),e.GameManager.instance.level.setSimpleTween(this.kingBody,16,{y:75,scY:.91})):32===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye,13,{x:89,y:56}),e.GameManager.instance.level.setSimpleTween(this.hat,13,{x:72,y:20,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.kingBody,13,{x:58,y:73,skX:0,scY:.95})):45===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye,15,{x:85,y:51}),e.GameManager.instance.level.setSimpleTween(this.hat,15,{x:69,y:18,skX:7,skY:7}),e.GameManager.instance.level.setSimpleTween(this.kingBody,15,{x:54,y:70,skX:-4,scY:1})):60===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye,14,{y:56}),e.GameManager.instance.level.setSimpleTween(this.hat,14,{y:25}),e.GameManager.instance.level.setSimpleTween(this.kingBody,14,{x:55,y:74,scY:.92})):74===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye,15,{x:89}),e.GameManager.instance.level.setSimpleTween(this.hat,15,{x:72,y:20,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.kingBody,15,{x:58,y:73,skX:0,scY:.95})):89===this.counterAnim?(this.setPart(this.eye,{x:89,y:56,angle:0,scX:1,scY:1,skX:-14,skY:-14,alpha:1}),this.setPart(this.hat,{x:72,y:20,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.kingBody,{x:58,y:73,angle:0,scX:1,scY:.95,skX:0,skY:0,alpha:1})):90===this.counterAnim&&this.animComplete():"idle2"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye,12,{y:57}),e.GameManager.instance.level.setSimpleTween(this.hat,20,{y:22}),e.GameManager.instance.level.setSimpleTween(this.kingBody,12,{y:76})):13===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye,14,{y:53}),e.GameManager.instance.level.setSimpleTween(this.kingBody,14,{y:70})):21===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.hat,6,{y:18}):27===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"cycle"===e?(this.setPart(this.eye,{x:89,y:56,angle:0,scX:1,scY:1,skX:-14,skY:-14,alpha:1}),this.setPart(this.hat,{x:72,y:20,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.kingBody,{x:58,y:73,angle:0,scX:1,scY:.95,skX:0,skY:0,alpha:1})):"idle2"===e&&(this.setPart(this.eye,{x:88,y:53,angle:0,scX:1,scY:1,skX:-14,skY:-14,alpha:1}),this.setPart(this.hat,{x:71,y:18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.kingBody,{x:58,y:70,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.eye=null,this.kingBody=null,this.hat=null,this.wheel1=null,this.wheel2=null},i}(e.BasicSimpleAnim);e.Lvl4King=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.dir=0,s.group=i.make.group(),s.group.x=-160,s.group.y=484,e.GameManager.instance.layerElements.addChildAt(s.group,0),s.mage_body=new e.SASprite(i,0,0,"level4","mage_body instance 10000"),s.mage_body.pivot.set(1,1),s.group.addChild(s.mage_body),s.mage_eye=new e.SASprite(i,0,0,"level4","mageEye instance 10000"),s.mage_eye.pivot.set(16,32),s.mage_eye.animations.add("idle",Phaser.Animation.generateFrameNames("mageEye instance 1",0,33,"",4),30,!0),s.mage_eye.play("idle"),s.group.addChild(s.mage_eye),s.mage_beard=new e.SASprite(i,0,0,"level4","mage_beard instance 10000"),s.mage_beard.pivot.set(1,1),s.group.addChild(s.mage_beard),s.mage_hat=new e.SASprite(i,0,0,"level4","magehat instance 10000"),s.mage_hat.pivot.set(34,38),s.group.addChild(s.mage_hat),s.wheel1=new e.SASprite(i,-24,23,"level4","mageWheel_mc instance 10000"),s.wheel1.anchor.set(.5),s.group.addChild(s.wheel1),s.wheel2=new e.SASprite(i,25,23,"level4","mageWheel_mc instance 10000"),s.wheel2.anchor.set(.5),s.group.addChild(s.wheel2),s.playAnim("idle",-1),s}return __extends(i,t),i.prototype.goToCastle=function(){this.dir=1,e.Main.instance.add.tween(this.group).to({x:1e3},8e3,"Linear",!0,700).onComplete.add(function(){this.dir=0,this.group.x=1450,this.group.y=470,this.group.scale.x*=-1},this)},i.prototype.update=function(){t.prototype.update.call(this),this.wheel1.angle+=2*this.dir,this.wheel2.angle+=2*this.dir},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"idle"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.mage_eye,19,{y:-48}),e.GameManager.instance.level.setSimpleTween(this.mage_beard,19,{y:-29}),e.GameManager.instance.level.setSimpleTween(this.mage_hat,27,{y:-95}),e.GameManager.instance.level.setSimpleTween(this.mage_body,19,{y:-78,scY:.92})):20===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.mage_eye,20,{y:-52}),e.GameManager.instance.level.setSimpleTween(this.mage_beard,20,{y:-32}),e.GameManager.instance.level.setSimpleTween(this.mage_body,20,{y:-86,scY:1})):28===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.mage_hat,12,{y:-101}):40===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"idle"===e&&(this.setPart(this.mage_eye,{x:11,y:-52,angle:0,scX:1,scY:1,skX:-8,skY:-8,alpha:1}),this.setPart(this.mage_beard,{x:20,y:-32,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.mage_hat,{x:-22,y:-101,angle:0,scX:1.24,scY:1.24,skX:0,skY:0,alpha:1}),this.setPart(this.mage_body,{x:-73,y:-86,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.mage_body=null,this.mage_body=null,this.mage_beard=null,this.mage_hat=null,this.wheel1=null,this.wheel2=null},i}(e.BasicSimpleAnim);e.Lvl4Mage=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this)||this;return n.roadParts=new Array,n.parts=new Array,n.counter=0,n.current=0,n.start=!1,n.roadParts=[[1.3,148.9,0],[43.05,123.95,14],[91.45,109.15,29],[138.45,108.35,36],[187.05,120.15,53],[133.65,96.05,-16],[230.75,137.65,59],[178.65,68.55,29],[268.8,149.75,29],[225.3,82.4,59],[264.8,92.4,44],[295.75,89.45,0],[331.5,49.65,99],[299.4,13.8,74],[254.55,-10.15,53],[194.95,-6.4,14],[157.95,18.05,-9],[126,39.35,6],[90.95,45.75,29]],n.map=new Phaser.Group(i),n.map.x=s,n.map.y=a,n.map.pivot.set(437,245),e.GameManager.instance.layerUpper.addChild(n.map),n.map.create(0,0,"level4","mapBg instance 10000"),n.map.scale.set(.2),n.map.alpha=.3,e.Main.instance.add.tween(n.map.scale).to({x:1,y:1},700,"Linear",!0),e.Main.instance.add.tween(n.map).to({alpha:1},700,"Linear",!0).onComplete.add(n.addElements,n),e.Main.instance.add.tween(n.map).to({alpha:0},300,"Linear",!0,3500),n}return __extends(i,t),i.prototype.addElements=function(){this.road=new Phaser.Group(e.Main.instance),this.road.x=50,this.road.y=30,this.map.addChild(this.road),this.buildRoad(),this.mapDrake=this.map.create(8,16,"level4","mapDrake instance 10000"),this.help=this.map.create(75,55,"level4","MapHelp instance 10000"),this.help.anchor.set(0,1),this.help.angle=-10,e.Main.instance.add.tween(this.help).to({angle:10},250,"Linear",!0,0,-1,!0),this.mapMage=this.map.create(348,150,"level4","mapMage instance 10000"),this.mapMage.visible=!1,this.start=!0},i.prototype.buildRoad=function(){for(var e=0;e<this.roadParts.length;e++){var t=this.road.create(0,0,"level4","road_part instance 10000");t.x=this.roadParts[e][0],t.y=this.roadParts[e][1],t.angle=this.roadParts[e][2],t.visible=!1,this.parts.push(t)}},i.prototype.update=function(){!0===this.start&&this.current<this.parts.length&&(this.counter+=1,5===this.counter&&(this.parts[this.current].visible=!0,this.counter=0,this.current+=1,8===this.current&&(this.mapMage.visible=!0)))},i.prototype.free=function(){this.map=null,this.road=null,this.roadParts=[],this.roadParts=null,this.parts=[],this.parts=null,this.mapDrake=null,this.mapMage=null,this.help=null},i}(e.BasicElement);e.Lvl4Map=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=100,s.group.y=291,e.GameManager.instance.layerBackground.addChild(s.group),s.stone=new e.SASprite(i,0,0,"level4","stoneBody instance 10000"),s.stone.anchor.set(.5),s.group.addChild(s.stone),s.stone.inputEnabled=!0,s.stone.input.useHandCursor=!0,s.stone.events.onInputUp.add(s.use,s),s.setParts("anim"),s}return __extends(i,t),i.prototype.use=function(){this.stone.inputEnabled=!1,this.playAnim("anim"),this.counterAnim=-15,e.SoundManager.playSFX("s_lvl4_secretStoneClick")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.stone,10,{x:20,skX:48,skY:48}):11===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.stone,9,{x:43,y:5,skX:84,skY:84}):20===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.stone,15,{x:74,y:45,skX:128,skY:128}):35===this.counterAnim&&(this.animComplete(),e.GameManager.instance.level.waterfall2.hide())))},i.prototype.setParts=function(e){"anim"===e&&this.setPart(this.stone,{x:0,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})},i.prototype.free=function(){this.group=null,this.stone=null},i}(e.BasicSimpleAnim);e.Lvl4Stone=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.dir=0,s.waitKing=!0,s.patrool=!0,s.countUse=0,s.group=i.make.group(),s.group.x=577,s.group.y=217,e.GameManager.instance.layerBackground.addChild(s.group),s.truba=new e.SASprite(i,0,0,"level4","truba instance 10000"),s.truba.pivot.set(10,23),s.group.addChild(s.truba),s.weapon=new e.SASprite(i,0,0,"level4","weapon instance 10000"),s.weapon.pivot.set(18,59),s.group.addChild(s.weapon),s.body=new e.SASprite(i,0,0,"level4","body instance 10000"),s.body.pivot.set(61,31),s.group.addChild(s.body),s.eyes=new e.SASprite(i,0,0,"level4","eyes instance 10000"),s.eyes.pivot.set(6,5),s.eyes.animations.add("idle",Phaser.Animation.generateFrameNames("eyes instance 1",0,43,"",4),30,!0),s.eyes.play("idle"),s.group.addChild(s.eyes),s.kaska=new e.SASprite(i,0,0,"level4","kaska instance 10000"),s.kaska.pivot.set(28,25),s.kaska.animations.add("anim",Phaser.Animation.generateFrameNames("kaska instance 1",0,61,"",4),30,!0),s.kaska.play("anim"),s.group.addChild(s.kaska),s.korzina=new e.SASprite(i,0,0,"level4","korzina instance 10000"),s.korzina.pivot.set(38,26),s.korzina.visible=!1,s.group.addChild(s.korzina),s.shield=new e.SASprite(i,0,0,"level4","shield instance 10000"),s.shield.pivot.set(15,16),s.group.addChild(s.shield),s.wheel1=new e.SASprite(i,-29,26,"level4","warden_wheel1 instance 10000"),s.wheel1.anchor.set(.5),s.group.addChild(s.wheel1),s.wheel2=new e.SASprite(i,38,26,"level4","warden_wheel2 instance 10000"),s.wheel2.anchor.set(.5),s.group.addChild(s.wheel2),s.setParts("surprise"),s.mask=new Phaser.Graphics(i,509,115),s.mask.beginFill(0,1),s.mask.drawRect(0,0,146,159),s.mask.endFill(),e.GameManager.instance.layerBackground.addChild(s.mask),s.lift=e.GameManager.instance.layerBackground.create(510,90,"level4","lift instance 10000",!0,1),s.lift.mask=s.mask,s.topCorzina=e.GameManager.instance.layerBackground.create(436,86,"level4","korzina instance 10000",!0,1),s.topCorzina.anchor.set(.5),s.topCorzina.inputEnabled=!1,s.topCorzina.events.onInputUp.add(s.up,s),s.topCorzina.events.onInputOver.add(s.over,s),s.topCorzina.events.onInputOut.add(s.out,s),s.startLevel(),s}return __extends(i,t),i.prototype.over=function(){this.topCorzina.frameName="korzina instance 10002"},i.prototype.out=function(){this.topCorzina.frameName="korzina instance 10001"},i.prototype.up=function(){e.SoundManager.playSFX("s_lvl4_bucketFall"),this.patrool=!1,this.topCorzina.inputEnabled=!1,this.topCorzina.frameName="korzina instance 10000",e.Main.instance.add.tween(this.topCorzina).to({y:this.topCorzina.y+50,x:this.topCorzina.x-19,angle:154},500,"Linear",!0).onComplete.add(function(){this.topCorzina.visible=!1,this.korzina.visible=!0,this.playAnim("surprise")},this)},i.prototype.activateKorzina=function(){this.topCorzina.frameName="korzina instance 10001",this.topCorzina.inputEnabled=!0,this.topCorzina.input.useHandCursor=!0},i.prototype.startLevel=function(){e.SoundManager.playSFX("s_lvl4_elevatorNoise",!0),e.Main.instance.add.tween(this.group).to({y:this.group.y-52},1200,"Linear",!0),e.Main.instance.add.tween(this.lift).to({y:this.lift.y-52},1200,"Linear",!0).onComplete.addOnce(function(){e.SoundManager.stopSFXLoop("s_lvl4_elevatorNoise"),this.dir=-1,e.Main.instance.add.tween(this.group).to({x:this.group.x-155},2e3,"Linear",!0).onComplete.add(function(){this.dir=1,e.GameManager.instance.level.bridge.carUseArm(),e.Main.instance.add.tween(this.group).to({x:this.group.x+40},1200,"Linear",!0).onComplete.add(this.stopCar,this)},this)},this)},i.prototype.closeGate=function(){this.dir=-1,e.Main.instance.add.tween(this.group).to({x:this.group.x-40},1200,"Linear",!0).onComplete.add(function(){this.dir=1,0===this.countUse&&e.GameManager.instance.level.bridge.carUseArm(),this.countUse++,e.Main.instance.add.tween(this.group).to({x:this.group.x+40},1200,"Linear",!0).onComplete.add(this.stopCar,this)},this)},i.prototype.stopCar=function(){this.dir=0},i.prototype.update=function(){t.prototype.update.call(this),this.wheel1.angle+=2*this.dir,this.wheel2.angle+=2*this.dir,!0===this.waitKing&&e.GameManager.instance.level.king.group.x>450&&(this.closeGate(),e.GameManager.instance.hero.setEnableMotor(!0,!1),this.waitKing=!1)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"surprise"===this.currAnim?10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.shield,12,{x:5,y:4,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.korzina,12,{x:-36,y:-33,skX:149,skY:149}),e.GameManager.instance.level.setSimpleTween(this.kaska,12,{y:-22}),e.GameManager.instance.level.setSimpleTween(this.eyes,12,{y:-34}),e.GameManager.instance.level.setSimpleTween(this.body,12,{y:-7}),e.GameManager.instance.level.setSimpleTween(this.weapon,12,{x:-36,y:-31,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.truba,12,{x:45,y:-21,skX:7,skY:7})):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.shield,7,{x:16,y:7,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.korzina,7,{x:-33,y:-28,skX:152,skY:152}),e.GameManager.instance.level.setSimpleTween(this.kaska,7,{y:-17}),e.GameManager.instance.level.setSimpleTween(this.eyes,7,{y:-29}),e.GameManager.instance.level.setSimpleTween(this.body,7,{y:-4}),e.GameManager.instance.level.setSimpleTween(this.weapon,7,{x:-26,y:-34,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.truba,7,{x:42,y:-18,skX:0,skY:0})):29===this.counterAnim?(this.setPart(this.shield,{x:16,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.korzina,{x:-33,y:-28,angle:0,scX:1,scY:1,skX:152,skY:152,alpha:1}),this.setPart(this.kaska,{x:-26,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eyes,{x:-12,y:-29,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),this.setPart(this.body,{x:4,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.weapon,{x:-26,y:-34,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.truba,{x:42,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):35===this.counterAnim&&(this.animComplete(),this.playAnim("noVision",-1)):"noVision"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.shield,38,{x:14,y:-4,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.korzina,12,{x:-35,y:-32}),e.GameManager.instance.level.setSimpleTween(this.kaska,38,{y:-20}),e.GameManager.instance.level.setSimpleTween(this.eyes,38,{y:-32}),e.GameManager.instance.level.setSimpleTween(this.body,38,{y:-7}),e.GameManager.instance.level.setSimpleTween(this.weapon,12,{x:-21,y:-35,skX:7,skY:7}),e.GameManager.instance.level.setSimpleTween(this.truba,38,{x:45,y:-22,skX:11,skY:11})):13===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.korzina,8,{x:-33,y:-29}),e.GameManager.instance.level.setSimpleTween(this.weapon,8,{x:-26,y:-36,skX:0,skY:0})):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.korzina,9,{x:-30,y:-33,skX:157,skY:157}),e.GameManager.instance.level.setSimpleTween(this.weapon,12,{x:-23,y:-37,skX:4,skY:4})):30===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.korzina,9,{x:-33,y:-30,skX:152,skY:152}):33===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.weapon,6,{x:-26,skX:0,skY:0}):39===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.shield,20,{x:16,y:7,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.korzina,20,{y:-28}),e.GameManager.instance.level.setSimpleTween(this.kaska,20,{y:-17}),e.GameManager.instance.level.setSimpleTween(this.eyes,20,{y:-29}),e.GameManager.instance.level.setSimpleTween(this.body,20,{y:-4}),e.GameManager.instance.level.setSimpleTween(this.weapon,20,{y:-34}),e.GameManager.instance.level.setSimpleTween(this.truba,20,{x:42,y:-18,skX:0,skY:0})):59===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"surprise"===e?(this.setPart(this.shield,{x:16,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.korzina,{x:-33,y:-28,angle:0,scX:1,scY:1,skX:152,skY:152,alpha:1}),this.setPart(this.kaska,{x:-26,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eyes,{x:-12,y:-29,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),this.setPart(this.body,{x:4,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.weapon,{x:-26,y:-34,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.truba,{x:42,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"noVision"===e&&(this.setPart(this.shield,{x:16,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.korzina,{x:-33,y:-28,angle:0,scX:1,scY:1,skX:152,skY:152,alpha:1}),this.setPart(this.kaska,{x:-26,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eyes,{x:-12,y:-29,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),this.setPart(this.body,{x:4,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.weapon,{x:-26,y:-34,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.truba,{x:42,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.truba=null,this.weapon=null,this.body=null,this.eyes=null,this.kaska=null,this.korzina=null,this.shield=null,this.wheel1=null,this.wheel2=null,this.lift=null,this.mask=null},i}(e.BasicSimpleAnim);e.Lvl4TopCar=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n){var o=t.call(this,i)||this;return o.id=0,o.chekKing=!0,o.firstPause=0,o.timer=0,o.etap=0,o.attackSide=1,o.id=n,o.firstPause=i.rnd.integerInRange(0,10),o.group=i.make.group(),o.group.x=s,o.group.y=a,e.GameManager.instance.layerBackground.addChild(o.group),o.truba=new e.SASprite(i,0,0,"level4","truba instance 10000"),o.truba.pivot.set(10,23),o.group.addChild(o.truba),o.cards=new e.SASprite(i,0,0,"level4","cards instance 10000"),o.cards.pivot.set(19,18),o.group.addChild(o.cards),o.weapon=new e.SASprite(i,0,0,"level4","weapon instance 10000"),o.weapon.pivot.set(18,59),o.group.addChild(o.weapon),o.body=new e.SASprite(i,0,0,"level4","carBody instance 10000"),o.body.pivot.set(61,31),o.group.addChild(o.body),o.lampa=new e.SASprite(i,0,0,"level4","lampa instance 10000"),o.lampa.pivot.set(7,12),o.group.addChild(o.lampa),o.eye=new e.SASprite(i,0,0,"level4","eyes instance 10000"),o.eye.pivot.set(6,5),o.eye.animations.add("idle",Phaser.Animation.generateFrameNames("eyes instance 1",0,43,"",4),30,!0),o.eye.animations.add("watch",Phaser.Animation.generateFrameNames("eyes instance 1",110,205,"",4),25,!1).onComplete.add(function(){this.eye.play("idle"),0===this.id&&(this.group.scale.x*=-1),this.playAnim("show")},o),o.group.addChild(o.eye),o.kaska=new e.SASprite(i,0,0,"level4","kaska instance 10000"),o.kaska.pivot.set(28,25),o.kaska.animations.add("anim",Phaser.Animation.generateFrameNames("kaska instance 1",0,61,"",4),30,!0),o.kaska.play("anim"),o.group.addChild(o.kaska),o.shield=new e.SASprite(i,0,0,"level4","shield instance 10000"),o.shield.pivot.set(15,16),o.group.addChild(o.shield),o.wheel1=new e.SASprite(i,-29,26,"level4","warden_wheel1 instance 10000"),o.wheel1.anchor.set(.5),o.group.addChild(o.wheel1),o.wheel2=new e.SASprite(i,38,26,"level4","warden_wheel3 instance 10000"),o.wheel2.anchor.set(.5),o.group.addChild(o.wheel2),o.setParts("idle"),o}return __extends(i,t),i.prototype.setScale=function(e){this.group.scale.x*=e},i.prototype.addCards=function(){this.card=new e.Lvl4Card(e.Main.instance,this.group.x+53*this.group.scale.x*-1,this.group.y-10,this.group.scale.x,this.id),e.GameManager.instance.level.updateElements.push(this.card)},i.prototype.attackHero=function(t){this.attackSide=t,e.GameManager.instance.hero.setEnableMotor(!1,!1);var i=200+Math.abs(e.GameManager.instance.hero.bodyBase.x-this.group.x);e.Main.instance.add.tween(this.group).to({x:e.GameManager.instance.hero.baseGroup.x+110*t},i,Phaser.Easing.power2,!0,0).onComplete.add(this.pushHero,this)},i.prototype.pushHero=function(){e.GameManager.instance.hero.bodyBase.velocity.x=-250*this.attackSide,e.GameManager.instance.hero.currState=e.HeroState.bumpStars,e.GameManager.instance.level.gameOver=!0},i.prototype.update=function(){t.prototype.update.call(this),!0===this.chekKing&&(e.GameManager.instance.level.king.group.x>50&&(0===this.etap?(this.card.setUpdate(!1),this.playAnim("hide"),-1===this.group.scale.x&&(this.group.scale.x*=-1,e.SoundManager.playSFX("s_lvl4_wardenSalute")),this.etap=1):1===this.etap&&e.GameManager.instance.level.king.group.x>350&&(this.eye.play("watch"),this.chekKing=!1)),this.timer+=1,this.timer===this.firstPause&&this.eye.play("idle"))},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"idle"===this.currAnim?1===this.counterAnim?(this.setPart(this.shield,{x:16,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.kaska,{x:-26,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eye,{x:-12,y:-29,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),this.setPart(this.lampa,{x:58,y:-7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.body,{x:4,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.weapon,20,{x:-32,y:-32,skX:-12,skY:-12}),this.setPart(this.cards,{x:-48,y:-14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.truba,{x:42,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):21===this.counterAnim?this.setPart(this.weapon,{x:-32,y:-32,angle:0,scX:1,scY:1,skX:-12,skY:-12,alpha:1}):40===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.weapon,14,{x:-26,y:-34,skX:0,skY:0}):54===this.counterAnim&&this.animComplete():"surprise"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.shield,10,{y:1,skX:-8,skY:-8,scX:1.06,scY:1.06}),e.GameManager.instance.level.setSimpleTween(this.kaska,10,{x:-27,y:-22,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.eye,10,{x:-14,y:-34,skX:-10,skY:170}),e.GameManager.instance.level.setSimpleTween(this.lampa,10,{y:-15,skX:-1,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.body,10,{x:3,y:-10,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.weapon,10,{x:-31,y:-38,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.cards,10,{x:-49,y:-18,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.truba,10,{x:40,y:-25,skX:-2,skY:-2})):11===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.shield,4,{y:7,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.kaska,4,{x:-26,y:-17,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.eye,4,{x:-12,y:-29,skX:-8,skY:172}),e.GameManager.instance.level.setSimpleTween(this.lampa,4,{x:63,y:-8,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.body,4,{x:4,y:-4,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.weapon,4,{x:-26,y:-34,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.cards,4,{x:-48,y:-14,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.truba,4,{x:42,y:-18,skX:0,skY:0})):15===this.counterAnim?(this.setPart(this.shield,{x:16,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.kaska,{x:-26,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eye,{x:-12,y:-29,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.lampa,5,{x:56,skX:13,skY:13}),this.setPart(this.body,{x:4,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.weapon,{x:-26,y:-34,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.cards,{x:-48,y:-14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.truba,{x:42,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):20===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.lampa,4,{x:58,y:-7,skX:0,skY:0}):24===this.counterAnim?this.setPart(this.lampa,{x:58,y:-7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):30===this.counterAnim&&this.animComplete():"hide"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.shield,6,{x:7,y:5,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.kaska,6,{x:-28,y:-16,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.eye,6,{x:-16,skX:-13,skY:167}),e.GameManager.instance.level.setSimpleTween(this.lampa,6,{x:57,y:-13,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.body,6,{x:3,y:-5,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.weapon,6,{x:-30,y:-33}),e.GameManager.instance.level.setSimpleTween(this.cards,6,{x:-24,y:1,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.truba,6,{x:39,y:-22,skX:-4,skY:-4})):7===this.counterAnim?(this.setPart(this.shield,{x:7,y:5,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.kaska,{x:-28,y:-16,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.eye,{x:-16,y:-29,angle:0,scX:1,scY:1,skX:-13,skY:167,alpha:1}),this.setPart(this.lampa,{x:57,y:-13,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.body,{x:3,y:-5,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.weapon,{x:-30,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.cards,{x:-24,y:1,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.truba,{x:39,y:-22,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1})):10===this.counterAnim&&this.animComplete():"show"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.shield,6,{x:16,y:8,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.kaska,6,{x:-26,y:-17,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.eye,6,{x:-12,skX:-8,skY:172}),e.GameManager.instance.level.setSimpleTween(this.lampa,6,{x:58,y:-7,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.body,6,{x:4,y:-4,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.weapon,6,{x:-26,y:-34}),e.GameManager.instance.level.setSimpleTween(this.cards,6,{x:-48,y:-14,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.truba,6,{x:42,y:-18,skX:0,skY:0})):7===this.counterAnim?(this.setPart(this.shield,{x:16,y:8,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.kaska,{x:-26,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eye,{x:-12,y:-29,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),this.setPart(this.lampa,{x:58,y:-7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.body,{x:4,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.weapon,{x:-26,y:-34,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.cards,{x:-48,y:-14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.truba,{x:42,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):16===this.counterAnim&&(this.animComplete(),this.card.setUpdate(!0),0===this.id&&this.playAnim("idle",-1))))},i.prototype.setParts=function(e){"idle"===e?(this.setPart(this.shield,{x:16,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.kaska,{x:-26,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eye,{x:-12,y:-29,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),this.setPart(this.lampa,{x:58,y:-7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.body,{x:4,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.weapon,{x:-26,y:-34,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.cards,{x:-48,y:-14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.truba,{x:42,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"surprise"===e?(this.setPart(this.shield,{x:16,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.kaska,{x:-26,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eye,{x:-12,y:-29,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),this.setPart(this.lampa,{x:58,y:-7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.body,{x:4,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.weapon,{x:-32,y:-32,angle:0,scX:1,scY:1,skX:-12,skY:-12,alpha:1}),this.setPart(this.cards,{x:-48,y:-14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.truba,{x:42,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"hide"===e?(this.setPart(this.shield,{x:16,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.kaska,{x:-26,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eye,{x:-12,y:-29,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1}),this.setPart(this.lampa,{x:58,y:-7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.body,{x:4,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.weapon,{x:-26,y:-34,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.cards,{x:-48,y:-14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.truba,{x:42,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"show"===e&&(this.setPart(this.shield,{x:7,y:5,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.kaska,{x:-28,y:-16,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.eye,{x:-16,y:-29,angle:0,scX:1,scY:1,skX:-13,skY:167,alpha:1}),this.setPart(this.lampa,{x:57,y:-13,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.body,{x:3,y:-5,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.weapon,{x:-30,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.cards,{x:-24,y:1,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.truba,{x:39,y:-22,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}))},i.prototype.free=function(){this.group=null,this.truba=null,this.cards=null,this.weapon=null,this.body=null,this.lampa=null,this.eye=null,this.kaska=null,this.shield=null,this.wheel1=null,this.wheel2=null,this.card=null},i}(e.BasicSimpleAnim);e.Lvl4Warden=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=173,s.group.y=437,e.GameManager.instance.layerBackground.addChild(s.group),s.water=s.group.create(0,0,"level4","waterFallWater instance 10000"),s.water.anchor.set(.5),s.water.inputEnabled=!0,s.botWater=s.group.create(5,85,"level4","botWater instance 10000"),s.botWater.animations.add("anim",Phaser.Animation.generateFrameNames("botWater instance 1",0,26,"",4),30,!0),s.botWater.play("anim"),s.botWater.anchor.set(.5),s.botWater.scale.set(1.2),s.topWater=s.group.create(0,-85,"level4","topWater instance 10000"),s.topWater.anchor.set(.5,0),i.add.tween(s.topWater.scale).to({y:1.1},150,"Linear",!0,0,-1,!0),s.glow=s.group.create(0,84,"level4","glow instance 10000"),s.glow.anchor.set(.5),s.glow.scale.set(1.2),s.part4=new e.SASprite(i,0,0,"level4","part1 instance 10000"),s.part4.anchor.set(.5),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level4","part1 instance 10000"),s.part3.anchor.set(.5),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level4","part1 instance 10000"),s.part2.anchor.set(.5),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level4","part1 instance 10000"),s.part1.anchor.set(.5),s.group.addChild(s.part1),s.playAnim("anim",-1),s}return __extends(i,t),i.prototype.hide=function(){this.water.inputEnabled=!1,e.Main.instance.add.tween(this.group).to({alpha:0},500,"Linear",!0).onComplete.add(function(){e.GameManager.instance.level.waterfall3.show()},this)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,15,{y:11,scY:.94}),e.GameManager.instance.level.setSimpleTween(this.part2,5,{y:67,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.part3,23,{y:67,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.part4,10,{y:-48,scY:.91})):6===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,10,{y:86,scY:.22}):11===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,49,{y:67,scY:.98}):16===this.counterAnim?(this.setPart(this.part1,{x:9,y:11,angle:0,scX:1,scY:.94,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:9,y:86,angle:0,scX:1,scY:.22,skX:0,skY:0,alpha:1})):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,23,{y:67,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.part2,10,{y:-48,scY:.91})):24===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,10,{y:86,scY:.22}):27===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,43,{y:53,scY:.97}):34===this.counterAnim?this.setPart(this.part3,{x:-14,y:86,angle:0,scX:1,scY:.22,skX:0,skY:0,alpha:1}):35===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,10,{y:-48,scY:.91}):40===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,10,{y:86,scY:.22}):45===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,25,{y:11,scY:.94}):50===this.counterAnim?this.setPart(this.part1,{x:9,y:86,angle:0,scX:1,scY:.22,skX:0,skY:0,alpha:1}):51===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,10,{y:-48,scY:.91}):60===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,10,{y:86,scY:.22}):61===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,9,{y:-27,scY:.92}):70===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:9,y:-24,angle:0,scX:1,scY:.92,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:9,y:56,angle:0,scX:1,scY:.97,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:-14,y:13,angle:0,scX:1,scY:.94,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:-14,y:-79,angle:0,scX:1,scY:.33,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null,this.water=null,this.glow=null,this.botWater=null,this.topWater=null},i}(e.BasicSimpleAnim);e.Lvl4WaterFall1=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=190,s.group.y=238,e.GameManager.instance.layerBackground.addChild(s.group),s.water=s.group.create(-12,60,"level4","waterfallBack instance 10000"),s.water.anchor.set(.5),s.botWater=s.group.create(-18,113,"level4","waterPart instance 10000"),s.botWater.animations.add("anim",Phaser.Animation.generateFrameNames("waterPart instance 1",0,26,"",4),30,!0),s.botWater.play("anim"),s.botWater.anchor.set(.5),s.group.create(0,0,"level4","glow instance 10000").anchor.set(.5),s.group.create(0,55,"level4","glow instance 10000").anchor.set(.5),s.part4=new e.SASprite(i,0,0,"level4","fallPart1 instance 10000"),s.part4.anchor.set(.5),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level4","fallPart1 instance 10000"),s.part3.anchor.set(.5),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level4","fallPart1 instance 10000"),s.part2.anchor.set(.5),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level4","fallPart1 instance 10000"),s.part1.anchor.set(.5),s.group.addChild(s.part1),s.playAnim("anim",-1),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,8,{x:-8,y:42,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,13,{y:100,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.part3,29,{x:-26,y:99,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.part4,9,{x:-13,y:16,skX:28,skY:28,scY:1})):9===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:-9,y:51,skX:-1,skY:-1}):10===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,15,{x:-20,y:42,skX:5,skY:5}):14===this.counterAnim?(this.setPart(this.part1,{x:-9,y:51,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1}),this.setPart(this.part2,{x:-9,y:100,angle:0,scX:1,scY:1,skX:-7,skY:-7,alpha:1})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,29,{y:100,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.part2,9,{x:-4,y:17,skX:23,skY:23,scY:1})):24===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:-8,y:42,skX:0,skY:0}):25===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,35,{x:-26,y:99,skX:-2,skY:-2}):30===this.counterAnim?this.setPart(this.part3,{x:-26,y:99,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}):31===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,9,{x:-13,y:16,skX:28,skY:28,scY:1}):39===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,21,{x:-9,y:77,skX:-5,skY:-5}):40===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:-20,y:42,skX:5,skY:5}):44===this.counterAnim?this.setPart(this.part1,{x:-9,y:100,angle:0,scX:1,scY:1,skX:-7,skY:-7,alpha:1}):45===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,9,{x:-4,y:17,skX:23,skY:23,scY:1}):54===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,6,{x:-6,y:27,skX:14,skY:14}):55===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,5,{x:-21,y:50,skX:4,skY:4}):60===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:-6,y:29,angle:0,scX:1,scY:1,skX:12,skY:12,alpha:1}),this.setPart(this.part2,{x:-9,y:79,angle:0,scX:1,scY:1,skX:-5,skY:-5,alpha:1}),this.setPart(this.part3,{x:-21,y:52,angle:0,scX:1,scY:1,skX:4,skY:4,alpha:1}),this.setPart(this.part4,{x:2,y:-3,angle:0,scX:1,scY:.6,skX:34,skY:34,alpha:1}))},i.prototype.free=function(){this.group=null,this.part4=null,this.part3=null,this.part2=null,this.part3=null,this.water=null,this.glow=null,this.botWater=null,this.topWater=null},i}(e.BasicSimpleAnim);e.Lvl4WaterFall2=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=210,s.group.y=345,e.GameManager.instance.layerBackground.addChild(s.group),s.water=s.group.create(-15,0,"level4","water3 instance 10000"),s.water.anchor.set(.5,0),s.botWater=s.group.create(-15,185,"level4","botWater instance 10000"),s.botWater.animations.add("anim",Phaser.Animation.generateFrameNames("botWater instance 1",0,26,"",4),30,!0),s.botWater.play("anim"),s.botWater.anchor.set(.5),s.botWater.scale.set(.8),s.topWater=s.group.create(-11,122,"level4","botWater instance 10000"),s.topWater.animations.add("anim",Phaser.Animation.generateFrameNames("botWater instance 1",0,26,"",4),30,!0),s.topWater.play("anim"),s.topWater.anchor.set(.5),s.topWater.scale.set(.5),s.topWater.angle=18,s.part4=new e.SASprite(i,0,0,"level4","part1 instance 10000"),s.part4.anchor.set(.5),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level4","part1 instance 10000"),s.part3.anchor.set(.5),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level4","part1 instance 10000"),s.part2.anchor.set(.5),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level4","part1 instance 10000"),s.part1.anchor.set(.5),s.group.addChild(s.part1),s.playAnim("anim",-1),s.group.alpha=0,s.group.visible=!1,s}return __extends(i,t),i.prototype.show=function(){this.group.visible=!0,e.Main.instance.add.tween(this.group).to({alpha:1},500,"Linear",!0,200)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,5,{y:154}),e.GameManager.instance.level.setSimpleTween(this.part2,9,{x:-16,y:131,skX:0,skY:0,scY:.54}),e.GameManager.instance.level.setSimpleTween(this.part3,16,{x:0,y:92,skX:18,skY:18,scY:.33}),e.GameManager.instance.level.setSimpleTween(this.part4,9,{x:1,y:15,skX:0,skY:0,scY:.54})):6===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,10,{y:170,scY:.13}):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,15,{y:154}),e.GameManager.instance.level.setSimpleTween(this.part4,27,{x:5,y:63,scY:.66})):16===this.counterAnim?this.setPart(this.part1,{x:-16,y:170,angle:0,scX:.37,scY:.13,skX:0,skY:0,alpha:1}):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,9,{x:-16,y:131,skX:0,skY:0,scY:.54}),e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:-12,y:112,skX:27,skY:27,scY:.22})):25===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,10,{y:170,scY:.13}):26===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,15,{y:154}):32===this.counterAnim?this.setPart(this.part3,{x:-12,y:112,angle:0,scX:.57,scY:.22,skX:27,skY:27,alpha:1}):33===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,9,{x:1,y:15,skX:0,skY:0,scY:.54}):35===this.counterAnim?this.setPart(this.part2,{x:-16,y:170,angle:0,scX:.37,scY:.13,skX:0,skY:0,alpha:1}):36===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,9,{x:-16,y:131,skX:0,skY:0,scY:.54}):37===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,18,{x:0,y:92,skX:18,skY:18,scY:.33}):41===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,10,{y:170,scY:.13}):42===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,27,{x:5,y:63,scY:.66}):45===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,15,{y:154}):51===this.counterAnim?this.setPart(this.part1,{x:-16,y:170,angle:0,scX:.37,scY:.13,skX:0,skY:0,alpha:1}):52===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,9,{x:-16,y:131,skX:0,skY:0,scY:.54}):55===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,15,{x:-12,y:112,skX:27,skY:27,scY:.22}):60===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,10,{y:170,scY:.13}):61===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,9,{y:145}):69===this.counterAnim?this.setPart(this.part3,{x:5,y:63,angle:0,scX:.57,scY:.66,skX:0,skY:0,alpha:1}):70===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:-16,y:146,angle:0,scX:.37,scY:.54,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:-13,y:116,angle:0,scX:.37,scY:.25,skX:17,skY:17,alpha:1}),this.setPart(this.part3,{x:4,y:66,angle:0,scX:.57,scY:.63,skX:2,skY:2,alpha:1}),this.setPart(this.part4,{x:0,y:0,angle:0,scX:.57,scY:.17,skX:-51,skY:-51,alpha:1}))},i.prototype.free=function(){this.group=null,this.part4=null,this.part3=null,this.part3=null,this.part3=null,this.water=null,this.glow=null,this.botWater=null,this.topWater=null},i}(e.BasicSimpleAnim);e.Lvl4WaterFall3=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=-16,s.group.y=448,e.GameManager.instance.layerUpper.addChild(s.group),s.graphic=new e.SASprite(i,0,0,"level5","barrier instance 10000"),s.graphic.pivot.set(57,93),s.group.addChild(s.graphic),s.setParts("anim"),s}return __extends(i,t),i.prototype.activate=function(){this.playAnim("anim"),e.SoundManager.playSFX("s_lvl5_woodWallUp")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,28,{skX:0,skY:0}):29===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,6,{skX:-5,skY:-5}):35===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,6,{skX:0,skY:0}):41===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&this.setPart(this.graphic,{x:59,y:86,angle:0,scX:1,scY:1,skX:-90,skY:-90,alpha:1})},i.prototype.free=function(){this.group=null,this.graphic=null},i}(e.BasicSimpleAnim);e.Lvl5Barrier=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.startCount=!0,s.counter=0,s.group=i.make.group(),s.group.x=693,s.group.y=405,s.group.scale.x=-1,s.group.angle=14,e.GameManager.instance.layerBackground.addChild(s.group),s.part2=new e.SASprite(i,0,0,"level5","bearPart2 instance 10000"),s.part2.pivot.set(5,4),s.group.addChild(s.part2),s.part3=new e.SASprite(i,0,0,"level5","bearPart3 instance 10000"),s.part3.pivot.set(53,23),s.group.addChild(s.part3),s.part1=new e.SASprite(i,0,0,"level5","bearPart1 instance 10000"),s.part1.pivot.set(61,30),s.group.addChild(s.part1),s.group.visible=!1,s}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this),!0===this.startCount&&(this.counter+=1,200===this.counter&&(this.counter=0,this.startCount=!1,this.group.visible=!0,e.SoundManager.playSFX("s_lvl5_bearScratch"),this.playAnim("play"),this.counterAnim=-30))},i.prototype.onAnimComplete=function(){this.startCount=!0,this.group.visible=!1},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"play"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,15,{x:3,y:17,skX:1,scY:.97}),e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:19,y:14,skX:24,skY:23,scY:.97})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:0,y:16,skX:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:14,y:11,skX:0,skY:0,scY:1})):20===this.counterAnim?(this.setPart(this.part1,{x:0,y:16,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:14,y:11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):25===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:15,y:14,skX:32,skY:32}):29===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,5,{x:13,y:9,skX:-32,skY:-32}):34===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:14,y:11,skX:0,skY:0}):38===this.counterAnim?this.setPart(this.part2,{x:14,y:11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):46===this.counterAnim?(this.part3.visible=!0,this.setPart(this.part3,{x:-30,y:-15,angle:0,scX:1,scY:1,skX:-69,skY:-69,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part3,14,{x:-4,y:-25,skX:0,skY:0})):60===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,7,{x:-1,y:-14,skX:9,skY:9}):67===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-9,y:-19,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:13,y:8,skX:-16,skY:-16})):73===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-1,y:-14,skX:9,skY:9}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:14,y:11,skX:0,skY:0})):79===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-9,y:-19,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:13,y:8,skX:-16,skY:-16})):85===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part3,6,{x:-4,y:-25,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:14,y:11,skX:0,skY:0})):91===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part3,10,{x:-30,y:-15,skX:-69,skY:-69}),this.setPart(this.part2,{x:14,y:11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):101===this.counterAnim?this.setPart(this.part3,{x:-30,y:-15,angle:0,scX:1,scY:1,skX:-69,skY:-69,alpha:1}):102===this.counterAnim?this.part3.visible=!1:109===this.counterAnim?this.setPart(this.part2,{x:14,y:11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):110===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:15,y:14,skX:32,skY:32}):114===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,5,{x:13,y:9,skX:-32,skY:-32}):119===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,4,{x:14,y:11,skX:0,skY:0}):123===this.counterAnim?this.setPart(this.part2,{x:14,y:11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):132===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,9,{x:-60,y:18,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,9,{x:-47,y:13,skX:0,skY:0})):141===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"play"===e&&(this.setPart(this.part1,{x:-60,y:18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.part3.visible=!1,this.setPart(this.part2,{x:-47,y:13,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part2=null,this.part3=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl5Bear=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.graphic=new e.SASprite(i,0,0,"level5","bird1 instance 10000"),s.graphic.pivot.set(23,-7),e.GameManager.instance.layerBackground.addChild(s.graphic),s.setParts("anim"),s}return __extends(i,t),i.prototype.activate=function(){this.playAnim("anim",-1)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(this.graphic.visible=!0,this.graphic.frameName="bird1 instance 10000",e.GameManager.instance.level.setSimpleTween(this.graphic,9,{x:661,y:131})):10===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,6,{x:666,y:157}):16===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,7,{x:654,y:146}):23===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,7,{y:163}):30===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,2,{y:167,scY:.79}):32===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,5,{y:155,scY:1}):35===this.counterAnim?this.graphic.frameName="bird1 instance 10001":37===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,5,{y:163}):42===this.counterAnim?this.setPart(this.graphic,{x:654,y:163,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):50===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,18,{x:663,y:169,skX:25,skY:25}):68===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,10,{x:646,y:159,skX:-17,skY:-17}):78===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,4,{x:654,y:163,skX:0,skY:0}):82===this.counterAnim?this.setPart(this.graphic,{x:654,y:163,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):90===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.graphic,25,{x:696,y:126}):116===this.counterAnim?this.graphic.visible=!1:120===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&this.setPart(this.graphic,{x:689,y:136,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})},i.prototype.free=function(){this.graphic=null},i}(e.BasicSimpleAnim);e.Lvl5Bird1=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=378,s.group.y=508,s.group.visible=!1,e.GameManager.instance.layerBackground.addChild(s.group),s.eye2=new e.SASprite(i,0,0,"level5","bird2Eye instance 10000"),s.eye2.pivot.set(5,5),s.group.addChild(s.eye2),s.hair=new e.SASprite(i,0,0,"level5","bird2Hair instance 10000"),s.hair.pivot.set(9,8),s.group.addChild(s.hair),s.tors=new e.SASprite(i,0,0,"level5","bird2Tors instance 10000"),s.tors.pivot.set(15,23),s.group.addChild(s.tors),s.hand=new e.SASprite(i,0,0,"level5","bird2Hand instance 10000"),s.hand.pivot.set(11,8),s.group.addChild(s.hand),s.nose=new e.SASprite(i,0,0,"level5","bird2Nose instance 10000"),s.nose.pivot.set(6,3),s.group.addChild(s.nose),s.eye1=new e.SASprite(i,0,0,"level5","bird2Eye instance 10000"),s.eye1.pivot.set(5,5),s.group.addChild(s.eye1),s.leg2=new e.SASprite(i,0,0,"level5","bird2Leg instance 10000"),s.leg2.pivot.set(3,6),s.group.addChild(s.leg2),s.leg1=new e.SASprite(i,0,0,"level5","bird2Leg instance 10000"),s.leg1.pivot.set(3,6),s.group.addChild(s.leg1),s.setParts("play"),s}return __extends(i,t),i.prototype.activate=function(){this.group.visible=!0,this.playAnim("play"),this.counterAnim=-40,e.SoundManager.playSFX("s_lvl5_birdEvent")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"play"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1,14,{y:-58}),e.GameManager.instance.level.setSimpleTween(this.leg2,14,{y:-57}),e.GameManager.instance.level.setSimpleTween(this.eye1,14,{y:-97}),e.GameManager.instance.level.setSimpleTween(this.nose,14,{y:-92,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.hand,14,{x:-11,y:-89,skX:57,skY:57}),e.GameManager.instance.level.setSimpleTween(this.tors,14,{y:-83}),e.GameManager.instance.level.setSimpleTween(this.hair,14,{x:1,y:-108,skX:57,skY:68,scX:1.02}),e.GameManager.instance.level.setSimpleTween(this.eye2,14,{x:7,y:-97})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1,3,{y:-57}),e.GameManager.instance.level.setSimpleTween(this.leg2,3,{y:-55}),e.GameManager.instance.level.setSimpleTween(this.eye1,8,{y:-74,scY:.8}),e.GameManager.instance.level.setSimpleTween(this.nose,8,{y:-66,skX:9,skY:8,scX:.99,scY:.81}),e.GameManager.instance.level.setSimpleTween(this.hand,8,{x:-10,y:-59,skX:13,skY:7,scX:.99,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.tors,8,{y:-62,scY:.8}),e.GameManager.instance.level.setSimpleTween(this.hair,8,{x:-3,y:-78,skX:-19,skY:-7,scX:1,scY:.82}),e.GameManager.instance.level.setSimpleTween(this.eye2,8,{y:-74,scY:.8})):18===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1,5,{y:-42}),e.GameManager.instance.level.setSimpleTween(this.leg2,5,{y:-40})):23===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1,7,{y:-44}),e.GameManager.instance.level.setSimpleTween(this.leg2,7,{y:-43}),e.GameManager.instance.level.setSimpleTween(this.eye1,7,{y:-82,scY:1}),e.GameManager.instance.level.setSimpleTween(this.nose,7,{y:-74,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.hand,7,{x:-9,y:-64,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.tors,7,{y:-68,scY:1}),e.GameManager.instance.level.setSimpleTween(this.hair,7,{x:-1,y:-92,skX:29,skY:29,scY:1}),e.GameManager.instance.level.setSimpleTween(this.eye2,7,{x:8,y:-82,scY:1})):30===this.counterAnim?(this.setPart(this.eye1,{x:2,y:-82,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.nose,{x:13,y:-74,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hand,{x:-9,y:-64,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:-5,y:-68,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.hair,4,{x:-2,y:-91,skX:18,skY:18}),this.setPart(this.eye2,{x:8,y:-82,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):31===this.counterAnim?this.setPart(this.leg2,{x:-6,y:-43,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):34===this.counterAnim?this.setPart(this.hair,{x:-2,y:-91,angle:0,scX:1,scY:1,skX:18,skY:18,alpha:1}):40===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1,15,{x:4,y:-47,skX:-47,skY:-47}),e.GameManager.instance.level.setSimpleTween(this.eye1,15,{x:-13,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.nose,15,{x:0,y:-80,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.hand,15,{x:-18,y:-63,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.tors,15,{x:-13,y:-66,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.hair,15,{x:-21,y:-87,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.eye2,15,{x:-8,y:-85,skX:-28,skY:-28})):55===this.counterAnim?(this.setPart(this.leg1,{x:4,y:-47,angle:0,scX:1,scY:1,skX:-47,skY:-47,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.eye1,5,{x:6,skX:7,skY:6}),e.GameManager.instance.level.setSimpleTween(this.nose,5,{x:16,y:-74,skX:-4,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.hand,5,{x:-8,y:-65,skX:9,skY:8,scX:.99,scY:1.01}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-3,y:-69,skX:7,skY:6}),e.GameManager.instance.level.setSimpleTween(this.hair,5,{x:6,y:-93,skX:64,skY:63}),e.GameManager.instance.level.setSimpleTween(this.eye2,5,{x:11,y:-82,skX:7,skY:6})):60===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye1,5,{x:-13,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.nose,5,{x:0,y:-80,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.hand,5,{x:-18,y:-63,skX:-5,skY:-5,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-13,y:-66,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.hair,5,{x:-21,y:-87,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.eye2,5,{x:-8,y:-85,skX:-28,skY:-28})):65===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye1,5,{x:6,skX:7,skY:6}),e.GameManager.instance.level.setSimpleTween(this.nose,5,{x:16,y:-74,skX:-4,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.hand,5,{x:-8,y:-65,skX:9,skY:8,scX:.99,scY:1.01}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-3,y:-69,skX:7,skY:6}),e.GameManager.instance.level.setSimpleTween(this.hair,5,{x:6,y:-93,skX:64,skY:63}),e.GameManager.instance.level.setSimpleTween(this.eye2,5,{x:11,y:-82,skX:7,skY:6})):70===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye1,4,{x:-13,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.nose,4,{x:0,y:-80,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.hand,4,{x:-18,y:-63,skX:-5,skY:-5,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.tors,4,{x:-13,y:-66,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.hair,4,{x:-21,y:-87,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.eye2,4,{x:-8,y:-85,skX:-28,skY:-28})):74===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye1,4,{x:6,skX:7,skY:6}),e.GameManager.instance.level.setSimpleTween(this.nose,4,{x:16,y:-74,skX:-4,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.hand,4,{x:-8,y:-65,skX:9,skY:8,scX:.99,scY:1.01}),e.GameManager.instance.level.setSimpleTween(this.tors,4,{x:-3,y:-69,skX:7,skY:6}),e.GameManager.instance.level.setSimpleTween(this.hair,4,{x:6,y:-93,skX:64,skY:63}),e.GameManager.instance.level.setSimpleTween(this.eye2,4,{x:11,y:-82,skX:7,skY:6})):78===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1,6,{x:-1,y:-44,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.eye1,6,{x:2,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.nose,6,{x:13,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.hand,6,{x:-9,y:-64,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.tors,6,{x:-5,y:-68,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.hair,6,{x:-2,y:-91,skX:18,skY:18}),e.GameManager.instance.level.setSimpleTween(this.eye2,6,{x:8,skX:0,skY:0})):84===this.counterAnim?(this.setPart(this.leg1,{x:-1,y:-44,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eye1,{x:2,y:-82,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.nose,{x:13,y:-74,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hand,{x:-9,y:-64,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:-5,y:-68,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hair,{x:-2,y:-91,angle:0,scX:1,scY:1,skX:18,skY:18,alpha:1}),this.setPart(this.eye2,{x:8,y:-82,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):90===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye1,8,{y:-84,scY:1.03}),e.GameManager.instance.level.setSimpleTween(this.nose,8,{y:-75,scY:1.03}),e.GameManager.instance.level.setSimpleTween(this.hand,8,{x:-12,y:-70,skX:31,skY:31,scY:1.03}),e.GameManager.instance.level.setSimpleTween(this.tors,8,{y:-69,scY:1.03}),e.GameManager.instance.level.setSimpleTween(this.hair,8,{x:0,y:-94,skX:48,skY:49,scY:1.02}),e.GameManager.instance.level.setSimpleTween(this.eye2,8,{y:-84,scY:1.03})):98===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eye1,8,{y:-82,scY:1}),e.GameManager.instance.level.setSimpleTween(this.nose,8,{y:-74,scY:1}),e.GameManager.instance.level.setSimpleTween(this.hand,8,{x:-9,y:-64,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.tors,8,{y:-68,scY:1}),e.GameManager.instance.level.setSimpleTween(this.hair,8,{x:-3,y:-90,skX:-8,skY:-7,scY:1.01}),e.GameManager.instance.level.setSimpleTween(this.eye2,8,{y:-82,scY:1})):106===this.counterAnim?(this.setPart(this.eye1,{x:2,y:-82,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.nose,{x:13,y:-74,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hand,{x:-9,y:-64,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:-5,y:-68,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.hair,6,{x:-2,y:-91,skX:18,skY:18,scY:1}),this.setPart(this.eye2,{x:8,y:-82,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):112===this.counterAnim?this.setPart(this.hair,{x:-2,y:-91,angle:0,scX:1,scY:1,skX:18,skY:18,alpha:1}):130===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1,7,{y:-43,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.leg2,7,{y:-42,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.eye1,7,{y:-78,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.nose,7,{y:-70,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.hand,7,{x:-10,skX:17,skY:17,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.tors,7,{x:-6,y:-65,scX:1.13,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.hair,7,{y:-86,skX:20,skY:16,scX:.99,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.eye2,7,{y:-78,scY:.9})):137===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1,10,{x:3,y:-68,skX:-63,skY:-63,scY:1}),e.GameManager.instance.level.setSimpleTween(this.leg2,10,{x:-8,y:-67,skX:47,skY:47,scY:1}),e.GameManager.instance.level.setSimpleTween(this.eye1,10,{y:-105,scY:1}),e.GameManager.instance.level.setSimpleTween(this.nose,10,{y:-98,skX:-12,skY:-12,scY:1}),e.GameManager.instance.level.setSimpleTween(this.hand,10,{y:-101,skX:78,skY:78,scY:1}),e.GameManager.instance.level.setSimpleTween(this.tors,10,{x:-5,y:-91,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.hair,10,{x:-3,y:-110,skX:-23,skY:-23,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.eye2,10,{y:-105,scY:1})):147===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1,12,{y:26}),e.GameManager.instance.level.setSimpleTween(this.leg2,12,{y:27}),e.GameManager.instance.level.setSimpleTween(this.eye1,12,{y:-11}),e.GameManager.instance.level.setSimpleTween(this.nose,12,{y:-4}),e.GameManager.instance.level.setSimpleTween(this.hand,12,{x:-6,y:-11,skX:101,skY:101,scX:1.2}),e.GameManager.instance.level.setSimpleTween(this.tors,12,{y:3}),e.GameManager.instance.level.setSimpleTween(this.hair,12,{x:2,y:-23,skX:74,skY:74,scX:1.26}),e.GameManager.instance.level.setSimpleTween(this.eye2,12,{y:-11})):159===this.counterAnim&&(this.animComplete(),this.group.visible=!1)))},i.prototype.setParts=function(e){"play"===e&&(this.setPart(this.leg1,{x:-1,y:24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.leg2,{x:-6,y:26,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eye1,{x:2,y:-14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.nose,{x:13,y:-6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hand,{x:-9,y:4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:-5,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hair,{x:-3,y:-22,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eye2,{x:8,y:-14,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.eye2=null,this.hair=null,this.tors=null,this.hand=null,this.nose=null,this.eye1=null,this.leg2=null,this.leg1=null},i}(e.BasicSimpleAnim);e.Lvl5Bird2=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this,i)||this;return n.group=i.make.group(),n.group.x=s,n.group.y=a,e.GameManager.instance.layerUpper.addChild(n.group),n.part4=new e.SASprite(i,0,0,"level5","dirtyCloud1 instance 10000"),n.part4.pivot.set(53,44),n.group.addChild(n.part4),n.part3=new e.SASprite(i,0,0,"level5","dirtyCloud1 instance 10000"),n.part3.pivot.set(53,44),n.group.addChild(n.part3),n.part2=new e.SASprite(i,0,0,"level5","dirtyCloud2 instance 10000"),n.part2.pivot.set(118,79),n.group.addChild(n.part2),n.part1=new e.SASprite(i,0,0,"level5","dirtyCloud3 instance 10000"),n.part1.pivot.set(81,61),n.group.addChild(n.part1),n.playAnim("anim"),n}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,17,{x:-41,y:15,scX:.82,scY:.82,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part2,12,{y:27,skX:-4,skY:-4,scX:.76,scY:.76,alpha:.98}),e.GameManager.instance.level.setSimpleTween(this.part3,18,{x:-75,y:29,scX:1.86,scY:1.01,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part4,18,{x:-8,y:25,scX:.73,scY:.73,alpha:1})):13===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,12,{y:21,skX:0,skY:0,scX:1.28,scY:1.28,alpha:.84}):18===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,4,{y:10,scX:1,scY:1}):19===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:-81,y:24,scX:2.57,scY:1.39,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.part4,15,{x:-10,y:21,scX:1,scY:1,alpha:0})):22===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,16,{skX:-10,skY:-10,scX:1.43,scY:1.43,alpha:0}):25===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,15,{scX:1.73,scY:1.73,alpha:0}):34===this.counterAnim?(this.setPart(this.part3,{x:-81,y:24,angle:0,scX:2.57,scY:1.39,skX:0,skY:0,alpha:0}),this.setPart(this.part4,{x:-10,y:21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0})):38===this.counterAnim?this.setPart(this.part1,{x:-41,y:10,angle:0,scX:1.43,scY:1.43,skX:-10,skY:-10,alpha:0}):40===this.counterAnim&&(this.animComplete(),this.group.visible=!1)))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:-39,y:33,angle:0,scX:.25,scY:.25,skX:0,skY:0,alpha:.05}),this.setPart(this.part2,{x:-31,y:30,angle:0,scX:.51,scY:.51,skX:-5,skY:-5,alpha:0}),this.setPart(this.part3,{x:-64,y:37,angle:0,scX:.59,scY:.32,skX:0,skY:0,alpha:0}),this.setPart(this.part4,{x:-4,y:31,angle:0,scX:.23,scY:.23,skX:0,skY:0,alpha:0}))},i.prototype.free=function(){this.group=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl5DirtyCloud=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=407,s.group.y=300,e.GameManager.instance.layerBackground.addChild(s.group),s.part3=new e.SASprite(i,0,0,"level5","doorPart2 instance 10000"),s.part3.pivot.set(0,4),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level5","doorPart2 instance 10000"),s.part2.pivot.set(0,4),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level5","doorPart1 instance 10000"),s.group.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.activate=function(){this.playAnim("anim")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(this.setPart(this.part1,{x:-39,y:-7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part2,6,{skX:-104,skY:76}),e.GameManager.instance.level.setSimpleTween(this.part3,6,{skX:104,skY:104})):7===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,4,{skX:-80,skY:100}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{skX:80,skY:80})):11===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,4,{skX:-90,skY:90}),e.GameManager.instance.level.setSimpleTween(this.part3,4,{skX:90,skY:90})):15===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:-39,y:-7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:100,y:1,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),this.setPart(this.part3,{x:-33,y:1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part3=null,this.part2=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl5Door=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.game=i,s.body=new Phaser.Physics.Box2D.Body(i,null,653,540,1),s.body.setCircle(60),s.body.sensor=!0,s.group=i.make.group(),s.group.x=643,s.group.y=485,e.GameManager.instance.layerUpper.addChild(s.group),s.tail=new e.SASprite(i,0,0,"level5","monsterTail instance 10000"),s.tail.pivot.set(7,10),s.group.addChild(s.tail),s.leg2_2=new e.SASprite(i,0,0,"level5","monsterLeg1_2 instance 10000"),s.leg2_2.pivot.set(17,15),s.group.addChild(s.leg2_2),s.leg2_1=new e.SASprite(i,0,0,"level5","monsterLeg1_1 instance 10000"),s.leg2_1.pivot.set(16,16),s.group.addChild(s.leg2_1),s.hand2_3=new e.SASprite(i,0,0,"level5","monsterHand1_3 instance 10000"),s.hand2_3.pivot.set(22,30),s.group.addChild(s.hand2_3),s.hand2_2=new e.SASprite(i,0,0,"level5","monsterHand1_2 instance 10000"),s.hand2_2.pivot.set(19,30),s.group.addChild(s.hand2_2),s.hand2_1=new e.SASprite(i,0,0,"level5","monsterHand1_1 instance 10000"),s.hand2_1.pivot.set(22,22),s.group.addChild(s.hand2_1),s.tors=new e.SASprite(i,0,0,"level5","monsterTors instance 10000"),s.tors.pivot.set(47,67),s.group.addChild(s.tors),s.palka=new e.SASprite(i,0,0,"level5","monsterPalka instance 10000"),s.palka.pivot.set(40,42),s.group.addChild(s.palka),s.leg1_2=new e.SASprite(i,0,0,"level5","monsterLeg1_2 instance 10000"),s.leg1_2.pivot.set(17,15),s.group.addChild(s.leg1_2),s.leg1_1=new e.SASprite(i,0,0,"level5","monsterLeg1_1 instance 10000"),s.leg1_1.pivot.set(16,16),s.group.addChild(s.leg1_1),s.head=new e.SASprite(i,0,0,"level5","monsterHead instance 10000"),s.head.pivot.set(30,38),s.head.animations.add("anim1",Phaser.Animation.generateFrameNames("monsterHead instance 1",0,10,"",4),30,!1),s.head.animations.add("anim2",Phaser.Animation.generateFrameNames("monsterHead instance 1",11,11,"",4),30,!1),s.head.animations.add("anim3",Phaser.Animation.generateFrameNames("monsterHead instance 1",12,12,"",4),30,!1),s.head.animations.add("anim4",Phaser.Animation.generateFrameNames("monsterHead instance 1",44,69,"",4),30,!1),s.group.addChild(s.head),s.hand1_3=new e.SASprite(i,0,0,"level5","monsterHand1_3 instance 10000"),s.hand1_3.pivot.set(22,30),s.group.addChild(s.hand1_3),s.hand1_2=new e.SASprite(i,0,0,"level5","monsterHand1_2 instance 10000"),s.hand1_2.pivot.set(19,30),s.group.addChild(s.hand1_2),s.hand1_1=new e.SASprite(i,0,0,"level5","monsterHand1_1 instance 10000"),s.hand1_1.pivot.set(22,22),s.group.addChild(s.hand1_1),s.tattoo=new e.SASprite(i,0,0,"level5","monsterTattoo instance 10000"),s.tattoo.pivot.set(11,6),s.group.addChild(s.tattoo),s.playAnim("sleep",-1),s}return __extends(i,t),i.prototype.addArrow=function(t,i,s,a){var n=this.tors.toLocal(new PIXI.Point(t,i),e.GameManager.instance.layerUpper);this.arrow=new e.SASprite(this.game,n.x,n.y,"level5","arrow instance 10001"),this.arrow.anchor.setTo(.5),this.arrow.angle=s+134,this.tors.addChild(this.arrow),this.body.destroy(),!1===a&&this.wakeUp()},i.prototype.wakeUp=function(){this.playAnim("wakeUp"),e.SoundManager.playSFX("s_lvl5_trollWakeUp")},i.prototype.moveLeft=function(){this.playAnim("move_left",-1)},i.prototype.attack=function(){this.playAnim("attack")},i.prototype.moveRight=function(){this.playAnim("move_right",-1)},i.prototype.destroy=function(){this.activeAnim=!1,this.group.visible=!1},i.prototype.onAnimComplete=function(){"wakeUp"===this.currAnim?(e.GameManager.instance.level.customAction(3),this.moveLeft()):"attack"===this.currAnim&&(e.GameManager.instance.level.customAction(5),this.moveRight())},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"sleep"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tattoo,17,{y:-15,skX:6,skY:6},!0),this.setPart(this.hand1_1,{x:40,y:47,angle:0,scX:1,scY:1,skX:-82,skY:-82,alpha:1},!0),this.setPart(this.hand1_2,{x:12,y:41,angle:0,scX:1,scY:1,skX:-71,skY:-71,alpha:1},!0),this.setPart(this.hand1_3,{x:-23,y:43,angle:0,scX:1,scY:1,skX:-95,skY:-95,alpha:1},!0),this.setPart(this.head,{x:-33,y:107,angle:0,scX:1,scY:1,skX:-153,skY:-153,alpha:1},!0),this.setPart(this.leg1_1,{x:31,y:3,angle:0,scX:1,scY:1,skX:-47,skY:133,alpha:1},!0),this.setPart(this.leg1_2,{x:22,y:1,angle:0,scX:1,scY:1,skX:-51,skY:129,alpha:1},!0),this.setPart(this.palka,{x:97,y:67,angle:0,scX:1,scY:1,skX:98,skY:98,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.tors,17,{skY:-133,scX:1.06},!0),this.setPart(this.hand2_1,{x:61,y:38,angle:0,scX:1,scY:1,skX:-130,skY:50,alpha:1},!0),this.setPart(this.hand2_2,{x:41,y:59,angle:0,scX:1,scY:1,skX:-141,skY:39,alpha:1},!0),this.setPart(this.hand2_3,{x:8,y:81,angle:0,scX:1,scY:1,skX:-141,skY:39,alpha:1},!0),this.setPart(this.leg2_1,{x:58,y:34,angle:0,scX:1,scY:1,skX:-54,skY:-54,alpha:1},!0),this.setPart(this.leg2_2,{x:51,y:25,angle:0,scX:1,scY:1,skX:-50,skY:-50,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.tail,17,{x:40,skX:20,skY:20},!0)):18===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tattoo,10,{y:-11,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.tors,10,{skY:-135,scX:1},!0),e.GameManager.instance.level.setSimpleTween(this.tail,10,{x:39,skX:0,skY:0},!0)):28===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tattoo,12,{y:-18,skX:8,skY:8},!0),e.GameManager.instance.level.setSimpleTween(this.tors,12,{x:-2,y:34,scX:1.1},!0),this.setPart(this.tail,{x:39,y:-23,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0)):36===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tail,4,{x:44,y:-24,skX:24,skY:24,scY:1.23},!0):40===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tattoo,14,{y:-11,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.tors,14,{x:-1,y:38,scX:1},!0),e.GameManager.instance.level.setSimpleTween(this.tail,4,{x:39,y:-23,skX:0,skY:0,scY:1},!0)):44===this.counterAnim?this.setPart(this.tail,{x:39,y:-23,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0):54===this.counterAnim?(this.setPart(this.tattoo,{x:21,y:-11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.tors,{x:-1,y:38,angle:0,scX:1,scY:1,skX:-135,skY:-135,alpha:1},!0)):55===this.counterAnim&&this.animComplete():"wakeUp"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tattoo,7,{x:58,y:-2,skX:24,skY:24},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_1,14,{x:30,y:41,skX:29,skY:29},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,14,{x:42,y:11,skX:15,skY:15},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,14,{x:31,y:-13,skX:-42,skY:-42},!0),e.GameManager.instance.level.setSimpleTween(this.head,14,{x:-34,y:-48,skX:-30,skY:-30},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,14,{x:86,y:39,skX:-9,skY:171},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,14,{x:81,y:28,skX:-13,skY:167},!0),e.GameManager.instance.level.setSimpleTween(this.palka,14,{x:-7,y:120,skX:175,skY:175},!0),e.GameManager.instance.level.setSimpleTween(this.tors,14,{x:33,y:-2,skX:-64,skY:-64},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,14,{x:8,y:82,skX:-53,skY:127},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,14,{x:-12,y:51,skX:-31,skY:149},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,14,{x:-21,y:12,skX:-31,skY:149},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,14,{x:84,y:53,skX:-68,skY:-68},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,14,{x:75,y:47,skX:-64,skY:-64},!0),e.GameManager.instance.level.setSimpleTween(this.tail,7,{x:78,y:-3,skX:51,skY:51},!0)):8===this.counterAnim?(this.setPart(this.tattoo,{x:58,y:-2,angle:0,scX:1,scY:1,skX:24,skY:24,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.tail,7,{x:104,y:12,skX:76,skY:76},!0)):9===this.counterAnim?this.tattoo.visible=!1:15===this.counterAnim?this.head.animations.play("anim1"):48===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,7,{x:1,y:-18,skX:-5,skY:-5},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,7,{x:9,y:-46,skX:25,skY:25},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,7,{x:2,y:-86,skX:-9,skY:-9},!0),e.GameManager.instance.level.setSimpleTween(this.head,7,{x:-61,y:-116,skX:-23,skY:-23},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,7,{x:5,y:28,skX:3,skY:-177},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,7,{x:3,y:17,skX:0,skY:180},!0),e.GameManager.instance.level.setSimpleTween(this.palka,7,{x:-96,y:24,skX:-144,skY:-144},!0),e.GameManager.instance.level.setSimpleTween(this.tors,7,{x:-18,y:-46,skX:-23,skY:-23},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,7,{x:-54,y:6,skX:-12,skY:168},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,7,{x:-62,y:-21,skX:-23,skY:157},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,7,{x:-67,y:-61,skX:-23,skY:157},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,7,{x:-28,y:29,skX:-7,skY:-7},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,7,{x:-24,y:19,skX:16,skY:16},!0),e.GameManager.instance.level.setSimpleTween(this.tail,7,{x:34,y:-3,skX:103,skY:103},!0)):55===this.counterAnim?(this.head.animations.play("anim2"),this.arrow.destroy(),e.GameManager.instance.level.setSimpleTween(this.hand1_1,4,{x:-7,y:-12,skX:-8,skY:-8},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,4,{x:-3,y:-40,skX:14,skY:14},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,4,{x:-12,y:-79,skX:-5,skY:-5},!0),e.GameManager.instance.level.setSimpleTween(this.head,4,{x:-71,y:-118,skX:-13,skY:-13},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,4,{x:-33,y:30,skX:-13,skY:167},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,4,{x:-36,y:15,skX:37,skY:-143},!0),e.GameManager.instance.level.setSimpleTween(this.palka,4,{x:-130,y:12,skX:-134,skY:-134},!0),e.GameManager.instance.level.setSimpleTween(this.tors,4,{x:-42,y:-43,skX:-13,skY:-13},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,4,{x:-84,y:1,skX:-1,skY:179},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,4,{x:-88,y:-26,skX:-13,skY:167},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,4,{x:-86,y:-65,skX:-13,skY:167},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,4,{x:-22,y:26,skX:-29,skY:-29},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,4,{x:-23,y:16,skX:-15,skY:-15},!0),e.GameManager.instance.level.setSimpleTween(this.tail,4,{x:-1,y:4},!0)):59===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,5,{x:-16,y:-5,skX:-11,skY:-11},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,5,{x:-18,y:-33,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,5,{x:-30,y:-71,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.head,5,{x:-82,y:-120,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,5,{x:-50,y:32,skX:4,skY:-176},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,5,{x:-52,y:21,skX:0,skY:180},!0),e.GameManager.instance.level.setSimpleTween(this.palka,5,{x:-170,y:-4,skX:-121,skY:-121},!0),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-71,y:-38,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,5,{x:-123,y:-5,skX:11,skY:-169},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,5,{x:-121,y:-33,skX:0,skY:180},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,5,{x:-109,y:-71,skX:0,skY:180},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,5,{x:-98,y:32,skX:-4,skY:-4},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,5,{x:-96,y:21,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.tail,5,{x:-26,y:2},!0)):64===this.counterAnim&&this.animComplete():"move_left"===this.currAnim?1===this.counterAnim?(this.head.animations.play("anim3"),this.setPart(this.hand1_1,{x:-16,y:-5,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1},!0),this.setPart(this.hand1_2,{x:-18,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.hand1_3,{x:-30,y:-71,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.head,{x:-82,y:-120,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,5,{x:-37,y:30,skX:-48,skY:132},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,5,{x:-51,y:18,skX:-12,skY:168},!0),this.setPart(this.palka,{x:-170,y:-4,angle:0,scX:1,scY:1,skX:-121,skY:-121,alpha:1},!0),this.setPart(this.tors,{x:-71,y:-38,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.hand2_1,{x:-123,y:-5,angle:0,scX:1,scY:1,skX:11,skY:-169,alpha:1},!0),this.setPart(this.hand2_2,{x:-121,y:-33,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.hand2_3,{x:-109,y:-71,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,5,{x:-111,y:27,skX:18,skY:18},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,5,{x:-102,y:17,skX:41,skY:41},!0),this.setPart(this.tail,{x:-26,y:2,angle:0,scX:1,scY:1,skX:103,skY:103,alpha:1},!0)):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1_1,5,{x:-73,y:29},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,5,{x:-64,y:17,skX:60,skY:-120},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,5,{x:-81,y:33,skX:-10,skY:-10},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,5,{x:-84,y:12,skX:-10,skY:-10},!0)):11===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1_1,5,{x:-107,y:24,skX:-3,skY:177},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,5,{x:-97,y:8,skX:48,skY:-132},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,5,{x:-42,y:29,skX:-28,skY:-28},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,5,{x:-51,y:11,skX:-34,skY:-34},!0)):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1_1,5,{x:-71,y:33},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,5,{x:-70,y:19,skX:3,skY:-177},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,5,{x:-84,y:23},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,5,{x:-81,y:8,skX:48,skY:48},!0)):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.leg1_1,5,{x:-37,y:30,skX:-48,skY:132},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,5,{x:-51,y:18,skX:-12,skY:168},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,5,{x:-111,y:27,skX:18,skY:18},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,5,{x:-102,y:17,skX:41,skY:41},!0)):26===this.counterAnim?(this.setPart(this.leg1_1,{x:-37,y:30,angle:0,scX:1,scY:1,skX:-48,skY:132,alpha:1},!0),this.setPart(this.leg1_2,{x:-51,y:18,angle:0,scX:1,scY:1,skX:-12,skY:168,alpha:1},!0),this.setPart(this.leg2_1,{x:-111,y:27,angle:0,scX:1,scY:1,skX:18,skY:18,alpha:1},!0),this.setPart(this.leg2_2,{x:-102,y:17,angle:0,scX:1,scY:1,skX:41,skY:41,alpha:1},!0)):27===this.counterAnim&&(this.counterAnim=5):"attack"===this.currAnim?1===this.counterAnim?(this.head.animations.play("anim4"),e.GameManager.instance.level.setSimpleTween(this.hand1_1,10,{x:-15,y:-16,skX:21,skY:19,scX:1.01,scY:.99},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,10,{x:-5,y:-44,skX:-3,skY:-5},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,10,{x:-20,y:-74,skX:-14,skY:-16},!0),e.GameManager.instance.level.setSimpleTween(this.head,10,{x:-72,y:-121,skX:11,skY:11},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,10,{skX:6},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,10,{x:-51,skX:2},!0),e.GameManager.instance.level.setSimpleTween(this.palka,10,{x:-145,y:-124,skX:9,skY:7},!0),e.GameManager.instance.level.setSimpleTween(this.tors,10,{x:-70,y:-40,skX:2},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,10,{x:-174,y:-87,skX:140,skY:-40,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,10,{x:-144,y:-79,skX:90,skY:-88},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,10,{x:-116,y:-86,skX:42,skY:-139,scX:.98,scY:1.02},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,10,{skX:-2},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,10,{x:-95,skX:2},!0),e.GameManager.instance.level.setSimpleTween(this.tail,10,{x:-31,y:5,skX:122,skY:122},!0)):11===this.counterAnim?(e.GameManager.instance.level.customAction(4),e.GameManager.instance.level.setSimpleTween(this.hand1_1,5,{x:-46,y:-26,skX:61,skY:59,scX:1},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,5,{x:-29,y:-33,skX:37,skY:35},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,5,{y:-61,skX:16,skY:14},!0),e.GameManager.instance.level.setSimpleTween(this.head,5,{x:-56,y:-123,skX:14,skY:14},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,5,{x:-51,skX:2,skY:-178},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,5,{x:-53,skX:9,skY:-173},!0),e.GameManager.instance.level.setSimpleTween(this.palka,5,{x:-65,y:-143,skX:61,skY:59,scX:.99},!0),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-63,y:-42,skX:6,skY:4},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,5,{x:-115,y:-148,skX:-128,skY:52,scX:1.01},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,5,{x:-119,y:-125,skX:176,skY:-2},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,5,{x:-108,y:-103,skX:97,skY:-84},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,5,{x:-103,y:24,skX:-5,skY:-7},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,5,{x:-99,y:13,skX:24,skY:22},!0),e.GameManager.instance.level.setSimpleTween(this.tail,5,{x:-28,y:8,skX:131,skY:131},!0)):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,10,{x:-74,y:-36,skX:101,skY:99,scX:1.01},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,10,{x:-44,y:-31,skX:77,skY:76},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,10,{x:-22,y:-54,skX:45,skY:43},!0),e.GameManager.instance.level.setSimpleTween(this.head,10,{x:-40,y:-125,skX:17,skY:17},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,10,{x:-53,skX:-1,skY:180},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,10,{x:-54,skX:16,skY:-166},!0),e.GameManager.instance.level.setSimpleTween(this.palka,10,{x:-19,y:-114,skX:113,skY:111,scX:1},!0),e.GameManager.instance.level.setSimpleTween(this.tors,10,{x:-55,y:-43,skX:10,skY:8},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,10,{x:-46,skX:-72,skY:108,scX:1.02},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,10,{x:-73,y:-133,skX:-136,skY:45},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,10,{x:-81,skX:149,skY:-32},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,10,{x:-108,y:16,skX:-9,skY:-10},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,10,{x:-102,y:5,skX:46,skY:44},!0),e.GameManager.instance.level.setSimpleTween(this.tail,10,{x:-27,y:13,skX:136,skY:136},!0)):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,3,{x:-57,y:-45,skX:48,skY:47,scX:1},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,3,{x:-48,y:-48,skX:24,skY:22},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,3,{x:-37,y:-68,skX:-3,skY:-5},!0),e.GameManager.instance.level.setSimpleTween(this.head,3,{x:-87,skX:1,skY:1},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,3,{x:-46,y:26,skX:-35,skY:145},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,3,{x:-51,y:18,skX:-9,skY:169},!0),e.GameManager.instance.level.setSimpleTween(this.palka,3,{x:-98,y:-145,skX:39,skY:37,scX:.99},!0),e.GameManager.instance.level.setSimpleTween(this.tors,3,{x:-74,y:-46,skX:-9,skY:-11},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,3,{x:-141,y:-139,skX:-148,skY:31,scX:1.01},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,3,{x:-141,y:-110,skX:166,skY:-12},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,3,{x:-124,y:-92,skX:82,skY:-98},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,3,{x:-103,y:23,skX:-6,skY:-7},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,3,{x:-99,y:13,skX:26,skY:24},!0),e.GameManager.instance.level.setSimpleTween(this.tail,5,{x:-38,y:-15,skX:84,skY:84},!0)):29===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,2,{x:-30,y:-58,skX:-15,skY:-16,scX:1.01},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,2,{x:-43,y:-91,skX:-40,skY:-41},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,2,{x:-71,y:-103,skX:-61,skY:-63},!0),e.GameManager.instance.level.setSimpleTween(this.head,2,{x:-138,y:-114,skX:-19,skY:-19},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,2,{x:-38,y:19,skX:-76,skY:102},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,2,{x:-48,y:12,skX:-40,skY:138},!0),e.GameManager.instance.level.setSimpleTween(this.palka,2,{x:-211,y:-97,skX:-50,skY:-52,scX:1},!0),e.GameManager.instance.level.setSimpleTween(this.tors,2,{x:-96,y:-42,skX:-33,skY:-35},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,2,{x:-199,y:-47,skX:120,skY:-61,scX:1.02},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,2,{x:-168,y:-50,skX:69,skY:-109},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,2,{x:-144,y:-67,skX:21,skY:-160},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,2,{x:-98,y:32,skX:-2,skY:-4},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,2,{x:-95,y:21,skX:2,skY:0},!0)):31===this.counterAnim?(e.GameManager.instance.level.customAction(6),e.GameManager.instance.level.setSimpleTween(this.hand1_1,2,{y:-68,skX:-35,skY:-37},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,2,{x:-54,y:-95,skX:-60,skY:-62},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,2,{x:-86},!0),e.GameManager.instance.level.setSimpleTween(this.head,2,{x:-152,y:-103,skX:-36,skY:-36},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,2,{x:-49,y:20,skX:-54,skY:124},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,2,{x:-59,y:7,skX:-15,skY:164},!0),e.GameManager.instance.level.setSimpleTween(this.palka,2,{x:-234,y:-38,skX:-104,skY:-106},!0),e.GameManager.instance.level.setSimpleTween(this.tors,2,{x:-99,y:-43,skX:-39,skY:-39},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,2,{x:-188,y:-18,skX:97,skY:-84},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,2,{x:-160,y:-33,skX:46,skY:-132},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,2,{x:-145,y:-58,skX:-2,skY:177},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,2,{x:-97,skX:-5},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,2,{y:18},!0),e.GameManager.instance.level.setSimpleTween(this.tail,2,{x:-39,y:-16,skX:69,skY:69},!0)):33===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,4,{x:-47,y:-41,skX:-17,skY:-19},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,4,{x:-62,y:-74,skX:-42,skY:-44},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,4,{x:-89,y:-91,skX:-43,skY:-45},!0),e.GameManager.instance.level.setSimpleTween(this.head,4,{x:-154,y:-100},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,4,{x:-53,y:27,skX:-8,skY:170},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,4,{y:11,skX:-6,skY:172},!0),e.GameManager.instance.level.setSimpleTween(this.palka,4,{x:-228,y:-62,skX:-77,skY:-79},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,4,{x:-195,y:-26,skX:104,skY:-76},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,4,{x:-166,y:-38,skX:53,skY:-125},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,4,{x:-148,y:-60,skX:5,skY:-175},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,4,{x:-101,y:30,skX:-20,skY:-19},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,4,{x:-99,y:15,skX:29,skY:27},!0),e.GameManager.instance.level.setSimpleTween(this.tail,4,{y:-9,skX:101,skY:101},!0)):37===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,9,{x:-16,y:-5,skX:-11,skY:-11,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,9,{x:-18,y:-33,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,9,{x:-30,y:-71,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.head,9,{x:-82,y:-120,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,9,{x:-50,y:32,skX:4,skY:-176},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,9,{x:-52,y:21,skX:0,skY:180},!0),e.GameManager.instance.level.setSimpleTween(this.palka,9,{x:-170,y:-4,skX:-121,skY:-121},!0),e.GameManager.instance.level.setSimpleTween(this.tors,9,{x:-71,y:-38,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,9,{x:-123,y:-5,skX:11,skY:-169,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,9,{x:-121,y:-33,skX:0,skY:180},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,9,{x:-109,y:-71,skX:0,skY:180,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,9,{x:-98,y:32,skX:-4,skY:-4},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,9,{x:-96,y:21,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.tail,9,{x:-26,y:3},!0)):62===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,7,{x:-24,y:-21,skX:-23,skY:-23},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,7,{x:-32,y:-48,skX:-12,skY:-12},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,7,{x:-56,y:-80,skX:-20,skY:-20},!0),e.GameManager.instance.level.setSimpleTween(this.head,7,{x:-117,y:-110,skX:-22,skY:-22},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,7,{x:-80,y:31,skX:-7,skY:173},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,7,{x:-80,y:20,skX:20,skY:-160},!0),e.GameManager.instance.level.setSimpleTween(this.palka,7,{x:-189,y:-76,skX:-38,skY:-38},!0),e.GameManager.instance.level.setSimpleTween(this.tors,7,{x:-89,y:-37,skX:-9,skY:-9},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,7,{x:-182,y:-30,skX:94,skY:-86},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,7,{x:-155,y:-37,skX:64,skY:-116},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,7,{x:-133,y:-65,skX:-6,skY:174},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,7,{x:-101},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,7,{x:-99},!0),e.GameManager.instance.level.setSimpleTween(this.tail,7,{x:-46,y:9,skX:105,skY:105},!0)):69===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,8,{x:-73,y:-25,skX:-17,skY:-17},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,8,{x:-74,y:-65,skX:-6,skY:-6},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,8,{x:-93,y:-91,skX:-33,skY:-33},!0),e.GameManager.instance.level.setSimpleTween(this.head,8,{x:-163,y:-115,skX:-25,skY:-25},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,8,{x:-140,y:28,skX:1,skY:-179},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,8,{x:-137,y:19,skX:46,skY:-134},!0),e.GameManager.instance.level.setSimpleTween(this.palka,8,{x:-147,y:-107,skX:40,skY:40},!0),e.GameManager.instance.level.setSimpleTween(this.tors,8,{x:-126,y:-42,skX:-12,skY:-12},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,8,{x:-190,y:-102,skX:-133,skY:47},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,8,{x:-186,y:-67,skX:163,skY:-17},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,8,{x:-168,y:-62,skX:31,skY:-149},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,8,{x:-113,y:29,skX:-13,skY:-13},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,8,{x:-114,y:17,skX:11,skY:11},!0),e.GameManager.instance.level.setSimpleTween(this.tail,8,{x:-82,y:7,skX:117,skY:117},!0)):77===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,10,{x:-115,y:-17,skX:-5,skY:-5},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,10,{x:-107,y:-56,skX:6,skY:6},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,10,{x:-121,y:-86,skX:-21,skY:-21},!0),e.GameManager.instance.level.setSimpleTween(this.head,10,{x:-171,y:-125,skX:5,skY:5},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,10,{x:-145,y:32},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,10,{x:-148,y:14,skX:1,skY:-179},!0),e.GameManager.instance.level.setSimpleTween(this.palka,10,{x:-161,y:-112,skX:63,skY:63},!0),e.GameManager.instance.level.setSimpleTween(this.tors,10,{x:-163,y:-44,skX:-1,skY:-1},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,10,{x:-204,y:-119,skX:-122,skY:58},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,10,{x:-209,y:-82,skX:174,skY:-6},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,10,{x:-194,y:-71,skX:43,skY:-137},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,10,{x:-189,y:31,skX:-3,skY:-3},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,10,{x:-187,y:15,skX:-2,skY:-2},!0),e.GameManager.instance.level.setSimpleTween(this.tail,10,{x:-120,y:-3},!0)):91===this.counterAnim?(this.setPart(this.hand1_1,{x:-217,y:-17,angle:0,scX:1,scY:1,skX:5,skY:-175,alpha:1},!0),this.setPart(this.hand1_2,{x:-225,y:-56,angle:0,scX:1,scY:1,skX:-6,skY:174,alpha:1},!0),this.setPart(this.hand1_3,{x:-211,y:-86,angle:0,scX:1,scY:1,skX:21,skY:-159,alpha:1},!0),this.setPart(this.head,{x:-158,y:-128,angle:0,scX:1,scY:1,skX:-5,skY:175,alpha:1},!0),this.setPart(this.leg1_1,{x:-186,y:32,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1},!0),this.setPart(this.leg1_2,{x:-184,y:14,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1},!0),this.setPart(this.palka,{x:-171,y:-112,angle:0,scX:1,scY:1,skX:-63,skY:117,alpha:1},!0),this.setPart(this.tors,{x:-169,y:-44,angle:0,scX:1,scY:1,skX:1,skY:-179,alpha:1},!0),this.setPart(this.hand2_1,{x:-128,y:-119,angle:0,scX:1,scY:1,skX:122,skY:122,alpha:1},!0),this.setPart(this.hand2_2,{x:-123,y:-82,angle:0,scX:1,scY:1,skX:-174,skY:-174,alpha:1},!0),this.setPart(this.hand2_3,{x:-138,y:-71,angle:0,scX:1,scY:1,skX:-43,skY:-43,alpha:1},!0),this.setPart(this.leg2_1,{x:-143,y:31,angle:0,scX:1,scY:1,skX:3,skY:-177,alpha:1},!0),this.setPart(this.leg2_2,{x:-145,y:15,angle:0,scX:1,scY:1,skX:2,skY:-178,alpha:1},!0),this.setPart(this.tail,{x:-204,y:10,angle:0,scX:1,scY:1,skX:-132,skY:48,alpha:1},!0)):92===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,9,{x:-229,y:-11,skX:13,skY:-167},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,9,{x:-226,y:-48,skX:4,skY:-176},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,9,{x:-207,y:-81,skX:22,skY:-158},!0),e.GameManager.instance.level.setSimpleTween(this.head,9,{x:-152,y:-119,skX:0,skY:180},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,9,{x:-180,skX:2},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,9,{x:-180,y:17,skX:-39,skY:-39},!0),e.GameManager.instance.level.setSimpleTween(this.palka,9,{x:-178,y:-108,skX:-58,skY:122},!0),e.GameManager.instance.level.setSimpleTween(this.tors,9,{x:-170,y:-37,skX:5,skY:-175},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,9,{x:-135,y:-111,skX:119,skY:119},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,9,{x:-126,y:-76,skX:178,skY:178},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,9,{y:-69,skX:-49,skY:-49},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,9,{x:-136,skX:6},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,9,{x:-142,skX:-36,skY:144},!0),e.GameManager.instance.level.setSimpleTween(this.tail,9,{x:-208,y:13,skX:-121,skY:59},!0)):101===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,10,{x:-224,y:-13,skX:6,skY:-174},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,10,{y:-50,skX:-3,skY:177},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,10,{x:-212,y:-85,skX:15,skY:-165},!0),e.GameManager.instance.level.setSimpleTween(this.head,10,{x:-162,y:-130,skX:-8,skY:172},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,10,{x:-182,y:35},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,10,{y:14,skX:-19,skY:-19},!0),e.GameManager.instance.level.setSimpleTween(this.palka,10,{x:-186,y:-115,skX:-65,skY:115},!0),e.GameManager.instance.level.setSimpleTween(this.tors,10,{x:-169,y:-47,skX:-2,skY:178},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,10,{x:-143,y:-124,skX:112,skY:112},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,10,{x:-130,y:-91,skX:170,skY:170},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,10,{x:-141,y:-82,skX:-57,skY:-56},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,10,{x:-140,y:33},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,10,{x:-143,y:13,skX:-6,skY:174},!0),e.GameManager.instance.level.setSimpleTween(this.tail,10,{x:-207,y:3,skX:-114,skY:66},!0)):116===this.counterAnim&&this.animComplete():"move_right"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,5,{y:-24,skX:12,skY:-168},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,5,{x:-221,y:-60,skX:3,skY:-177},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,5,{x:-204,y:-94,skX:21,skY:-159},!0),e.GameManager.instance.level.setSimpleTween(this.head,5,{x:-149,y:-134,skX:-2,skY:178},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,5,{x:-133,y:30,skX:-5,skY:-3},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,5,{x:-140,y:10,skX:-52,skY:-52},!0),e.GameManager.instance.level.setSimpleTween(this.palka,5,{x:-175,y:-122,skX:-59,skY:121},!0),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-165,y:-52,skX:4,skY:-176},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,5,{x:-132,y:-126,skX:118,skY:118},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,5,{x:-122,skX:176,skY:176},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,5,{x:-134,y:-84,skX:-51,skY:-50},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,5,{x:-186,y:28,skX:42,skY:-141},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,5,{x:-182,y:10,skX:13,skY:-167},!0),e.GameManager.instance.level.setSimpleTween(this.tail,5,{x:-203,y:-1,skX:-129,skY:51},!0)):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,8,{x:-225,y:-21,skX:8,skY:-172},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,8,{x:-228,y:-59,skX:-1,skY:179},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,8,{x:-209,y:-92,skX:24,skY:-156},!0),e.GameManager.instance.level.setSimpleTween(this.head,8,{x:-156,y:-132,skX:-5,skY:175},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,8,{x:-169,y:33,skX:-2,skY:-5},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,8,{x:-169,skX:-16,skY:-16},!0),e.GameManager.instance.level.setSimpleTween(this.palka,8,{x:-180,y:-118,skX:-63,skY:117},!0),e.GameManager.instance.level.setSimpleTween(this.tors,8,{x:-167,y:-49,skX:1,skY:-179},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,8,{x:-138,y:-125,skX:114,skY:114},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,8,{x:-126,skX:173,skY:173},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,8,{x:-137,y:-83,skX:-54,skY:-54},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,8,{x:-146,y:18,skX:20,skY:-163},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,8,{x:-155,y:3,skX:-49,skY:131},!0),e.GameManager.instance.level.setSimpleTween(this.tail,8,{y:3,skX:-148,skY:32},!0)):14===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,8,{x:-224,y:-24,skX:12,skY:-168},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,8,{x:-221,y:-60,skX:3,skY:-177},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,8,{x:-204,y:-94,skX:21,skY:-159},!0),e.GameManager.instance.level.setSimpleTween(this.head,8,{x:-149,y:-134,skX:-2,skY:178},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,8,{x:-188,y:26,skX:48,skY:45},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,8,{x:-183,y:9},!0),e.GameManager.instance.level.setSimpleTween(this.palka,8,{x:-175,y:-122,skX:-59,skY:121},!0),e.GameManager.instance.level.setSimpleTween(this.tors,8,{x:-165,y:-52,skX:4,skY:-176},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,8,{x:-132,y:-126,skX:118,skY:118},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,8,{x:-122,skX:176,skY:176},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,8,{x:-134,y:-84,skX:-51,skY:-50},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,8,{x:-131,y:30,skX:5,skY:-178},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,8,{x:-137,y:11,skX:-25,skY:155},!0),e.GameManager.instance.level.setSimpleTween(this.tail,8,{y:-1,skX:-129,skY:51},!0)):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,8,{x:-225,y:-21,skX:8,skY:-172},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,8,{x:-228,y:-59,skX:-1,skY:179},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,8,{x:-209,y:-92,skX:24,skY:-156},!0),e.GameManager.instance.level.setSimpleTween(this.head,8,{x:-156,y:-132,skX:-5,skY:175},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,8,{x:-146,y:21,skX:19,skY:16},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,8,{x:-150,y:6,skX:-54,skY:-54},!0),e.GameManager.instance.level.setSimpleTween(this.palka,8,{x:-180,y:-118,skX:-63,skY:117},!0),e.GameManager.instance.level.setSimpleTween(this.tors,8,{x:-167,y:-49,skX:1,skY:-179},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,8,{x:-138,y:-125,skX:114,skY:114},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,8,{x:-126,skX:173,skY:173},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,8,{x:-137,y:-83,skX:-54,skY:-54},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,8,{x:-167,y:31,skX:10,skY:-173},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,8,{x:-165,y:10,skX:11,skY:-169},!0),e.GameManager.instance.level.setSimpleTween(this.tail,8,{y:3,skX:-148,skY:32},!0)):30===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hand1_1,8,{x:-224,y:-24,skX:12,skY:-168},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_2,8,{x:-221,y:-60,skX:3,skY:-177},!0),e.GameManager.instance.level.setSimpleTween(this.hand1_3,8,{x:-204,y:-94,skX:21,skY:-159},!0),e.GameManager.instance.level.setSimpleTween(this.head,8,{x:-149,y:-134,skX:-2,skY:178},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_1,8,{x:-133,y:30,skX:-5,skY:-3},!0),e.GameManager.instance.level.setSimpleTween(this.leg1_2,8,{x:-140,y:10,skX:-52,skY:-52},!0),e.GameManager.instance.level.setSimpleTween(this.palka,8,{x:-175,y:-122,skX:-59,skY:121},!0),e.GameManager.instance.level.setSimpleTween(this.tors,8,{x:-165,y:-52,skX:4,skY:-176},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_1,8,{x:-132,y:-126,skX:118,skY:118},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_2,8,{x:-122,skX:176,skY:176},!0),e.GameManager.instance.level.setSimpleTween(this.hand2_3,8,{x:-134,y:-84,skX:-51,skY:-50},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_1,8,{x:-186,y:28,skX:42,skY:-141},!0),e.GameManager.instance.level.setSimpleTween(this.leg2_2,8,{x:-182,skX:13,skY:-167},!0),e.GameManager.instance.level.setSimpleTween(this.tail,8,{y:-1,skX:-129,skY:51},!0)):38===this.counterAnim&&(this.counterAnim=5)))},i.prototype.setParts=function(e){"sleep"===e?(this.setPart(this.tattoo,{x:21,y:-11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.hand1_1,{x:40,y:47,angle:0,scX:1,scY:1,skX:-82,skY:-82,alpha:1},!0),this.setPart(this.hand1_2,{x:12,y:41,angle:0,scX:1,scY:1,skX:-71,skY:-71,alpha:1},!0),this.setPart(this.hand1_3,{x:-23,y:43,angle:0,scX:1,scY:1,skX:-95,skY:-95,alpha:1},!0),this.setPart(this.head,{x:-33,y:107,angle:0,scX:1,scY:1,skX:-153,skY:-153,alpha:1},!0),this.setPart(this.leg1_1,{x:31,y:3,angle:0,scX:1,scY:1,skX:-47,skY:133,alpha:1},!0),this.setPart(this.leg1_2,{x:22,y:1,angle:0,scX:1,scY:1,skX:-51,skY:129,alpha:1},!0),this.setPart(this.palka,{x:97,y:67,angle:0,scX:1,scY:1,skX:98,skY:98,alpha:1},!0),this.setPart(this.tors,{x:-1,y:38,angle:0,scX:1,scY:1,skX:-135,skY:-135,alpha:1},!0),this.setPart(this.hand2_1,{x:61,y:38,angle:0,scX:1,scY:1,skX:-130,skY:50,alpha:1},!0),this.setPart(this.hand2_2,{x:41,y:59,angle:0,scX:1,scY:1,skX:-141,skY:39,alpha:1},!0),this.setPart(this.hand2_3,{x:8,y:81,angle:0,scX:1,scY:1,skX:-141,skY:39,alpha:1},!0),this.setPart(this.leg2_1,{x:58,y:34,angle:0,scX:1,scY:1,skX:-54,skY:-54,alpha:1},!0),this.setPart(this.leg2_2,{x:51,y:25,angle:0,scX:1,scY:1,skX:-50,skY:-50,alpha:1},!0),this.setPart(this.tail,{x:39,y:-23,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0)):"wakeUp"===e?(this.setPart(this.tattoo,{x:21,y:-11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.hand1_1,{x:40,y:47,angle:0,scX:1,scY:1,skX:-82,skY:-82,alpha:1},!0),this.setPart(this.hand1_2,{x:12,y:41,angle:0,scX:1,scY:1,skX:-71,skY:-71,alpha:1},!0),this.setPart(this.hand1_3,{x:-23,y:43,angle:0,scX:1,scY:1,skX:-95,skY:-95,alpha:1},!0),this.setPart(this.head,{x:-33,y:107,angle:0,scX:1,scY:1,skX:-153,skY:-153,alpha:1},!0),this.setPart(this.leg1_1,{x:31,y:3,angle:0,scX:1,scY:1,skX:-47,skY:133,alpha:1},!0),this.setPart(this.leg1_2,{x:22,y:1,angle:0,scX:1,scY:1,skX:-51,skY:129,alpha:1},!0),this.setPart(this.palka,{x:97,y:67,angle:0,scX:1,scY:1,skX:98,skY:98,alpha:1},!0),this.setPart(this.tors,{x:-1,y:38,angle:0,scX:1,scY:1,skX:-135,skY:-135,alpha:1},!0),this.setPart(this.hand2_1,{x:61,y:38,angle:0,scX:1,scY:1,skX:-130,skY:50,alpha:1},!0),this.setPart(this.hand2_2,{x:41,y:59,angle:0,scX:1,scY:1,skX:-141,skY:39,alpha:1},!0),this.setPart(this.hand2_3,{x:8,y:81,angle:0,scX:1,scY:1,skX:-141,skY:39,alpha:1},!0),this.setPart(this.leg2_1,{x:58,y:34,angle:0,scX:1,scY:1,skX:-54,skY:-54,alpha:1},!0),this.setPart(this.leg2_2,{x:51,y:25,angle:0,scX:1,scY:1,skX:-50,skY:-50,alpha:1},!0),this.setPart(this.tail,{x:39,y:-23,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0)):"move_left"===e?(this.tattoo.visible=!1,this.setPart(this.hand1_1,{x:-16,y:-5,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1},!0),this.setPart(this.hand1_2,{x:-18,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.hand1_3,{x:-30,y:-71,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.head,{x:-82,y:-120,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.leg1_1,{x:-50,y:32,angle:0,scX:1,scY:1,skX:4,skY:-176,alpha:1},!0),this.setPart(this.leg1_2,{x:-52,y:21,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.palka,{x:-170,y:-4,angle:0,scX:1,scY:1,skX:-121,skY:-121,alpha:1},!0),this.setPart(this.tors,{x:-71,y:-38,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.hand2_1,{x:-123,y:-5,angle:0,scX:1,scY:1,skX:11,skY:-169,alpha:1},!0),this.setPart(this.hand2_2,{x:-121,y:-33,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.hand2_3,{x:-109,y:-71,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.leg2_1,{x:-98,y:32,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1},!0),this.setPart(this.leg2_2,{x:-96,y:21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.tail,{x:-26,y:2,angle:0,scX:1,scY:1,skX:103,skY:103,alpha:1},!0)):"attack"===e?(this.tattoo.visible=!1,this.setPart(this.hand1_1,{x:-16,y:-5,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1},!0),this.setPart(this.hand1_2,{x:-18,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.hand1_3,{x:-30,y:-71,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.head,{x:-82,y:-120,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.leg1_1,{x:-50,y:32,angle:0,scX:1,scY:1,skX:4,skY:-176,alpha:1},!0),this.setPart(this.leg1_2,{x:-52,y:21,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.palka,{x:-170,y:-4,angle:0,scX:1,scY:1,skX:-121,skY:-121,alpha:1},!0),this.setPart(this.tors,{x:-71,y:-38,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.hand2_1,{x:-123,y:-5,angle:0,scX:1,scY:1,skX:11,skY:-169,alpha:1},!0),this.setPart(this.hand2_2,{x:-121,y:-33,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.hand2_3,{x:-109,y:-71,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.leg2_1,{x:-98,y:32,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1},!0),this.setPart(this.leg2_2,{x:-96,y:21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.tail,{x:-26,y:2,angle:0,scX:1,scY:1,skX:103,skY:103,alpha:1},!0)):"move_right"===e&&(this.tattoo.visible=!1,this.setPart(this.hand1_1,{x:-224,y:-13,angle:0,scX:1,scY:1,skX:6,skY:-174,alpha:1},!0),this.setPart(this.hand1_2,{x:-226,y:-50,angle:0,scX:1,scY:1,skX:-3,skY:177,alpha:1},!0),this.setPart(this.hand1_3,{x:-212,y:-85,angle:0,scX:1,scY:1,skX:15,skY:-165,alpha:1},!0),this.setPart(this.head,{x:-162,y:-130,angle:0,scX:1,scY:1,skX:-8,skY:172,alpha:1},!0),this.setPart(this.leg1_1,{x:-182,y:35,angle:0,scX:1,scY:1,skX:2,skY:-1,alpha:1},!0),this.setPart(this.leg1_2,{x:-180,y:14,angle:0,scX:1,scY:1,skX:-19,skY:-19,alpha:1},!0),this.setPart(this.palka,{x:-186,y:-115,angle:0,scX:1,scY:1,skX:-65,skY:115,alpha:1},!0),this.setPart(this.tors,{x:-169,y:-47,angle:0,scX:1,scY:1,skX:-2,skY:178,alpha:1},!0),this.setPart(this.hand2_1,{x:-143,y:-124,angle:0,scX:1,scY:1,skX:112,skY:112,alpha:1},!0),this.setPart(this.hand2_2,{x:-130,y:-91,angle:0,scX:1,scY:1,skX:170,skY:170,alpha:1},!0),this.setPart(this.hand2_3,{x:-141,y:-82,angle:0,scX:1,scY:1,skX:-57,skY:-56,alpha:1},!0),this.setPart(this.leg2_1,{x:-140,y:33,angle:0,scX:1,scY:1,skX:6,skY:-177,alpha:1},!0),this.setPart(this.leg2_2,{x:-143,y:13,angle:0,scX:1,scY:1,skX:-6,skY:174,alpha:1},!0),this.setPart(this.tail,{x:-207,y:3,angle:0,scX:1,scY:1,skX:-114,skY:66,alpha:1},!0))},i.prototype.free=function(){this.game=null,this.group=null,this.tail=null,this.leg2_2=null,this.leg2_1=null,this.hand2_3=null,this.hand2_2=null,this.hand2_1=null,this.tors=null,this.palka=null,this.leg1_2=null,this.leg1_1=null,this.head=null,this.hand1_3=null,this.hand1_2=null,this.hand1_1=null,this.tattoo=null,this.body=null,this.arrow=null},i}(e.BasicSimpleAnim);e.Lvl5Monster=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.stop=!1,s.group=i.make.group(),s.group.x=605,s.group.y=187,e.GameManager.instance.layerBackground.addChild(s.group),s.rope2=new e.SASprite(i,0,0,"level5","questCarRope instance 10000"),s.rope2.pivot.set(6,15),s.group.addChild(s.rope2),s.bag=new e.SASprite(i,0,0,"level5","questCarBag instance 10000"),s.bag.pivot.set(23,29),s.bag.animations.add("anim",Phaser.Animation.generateFrameNames("questCarBag instance 1",10,12,"",4),30,!1).onComplete.addOnce(s.goCar,s),s.bag.animations.add("anim2",Phaser.Animation.generateFrameNames("questCarBag instance 1",13,40,"",4),30,!1),s.group.addChild(s.bag),s.rope1=new e.SASprite(i,0,0,"level5","questCarRope2 instance 10000"),s.rope1.pivot.set(6,6),s.group.addChild(s.rope1),s.playAnim("anim",-1),s}return __extends(i,t),i.prototype.goCar=function(){e.SoundManager.playSFX("s_lvl5_lwFall"),this.bag.animations.play("anim2"),e.GameManager.instance.level.customAction(7)},i.prototype.activate=function(){this.bag.animations.play("anim"),this.stop=!0},i.prototype.onAnimComplete=function(){!0===this.stop&&"anim"===this.currAnim&&(this.activeAnim=!1)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.rope1,6,{skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.bag,6,{x:1,y:1,skX:-2,scY:1.03})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.rope1,6,{skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.bag,6,{x:0,y:0,skX:0,scY:1})):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.rope1,6,{y:-18,skX:7,skY:12}),e.GameManager.instance.level.setSimpleTween(this.bag,6,{x:-1,skX:3,scY:1.02})):28===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.rope1,7,{y:-17,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.bag,7,{x:0,skX:0,scY:1})):35===this.counterAnim?(this.setPart(this.rope1,{x:2,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bag,{x:0,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):50===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.rope1,{x:2,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bag,{x:0,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rope2,{x:0,y:-71,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.rope2=null,this.bag=null,this.rope1=null},i}(e.BasicSimpleAnim);e.Lvl5QuesCarBag=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.dead=!1,s.startDefeat=!1,s.counterDefeat=0,s.contactHeroCount=0,s.countStars=0,s.game=i,s.body=new Phaser.Physics.Box2D.Body(i,null,447,247,1),s.body.setRectangle(130,72),s.body.setCollisionCategory(e.FilterGroups.CAR2),e.GameManager.instance.hero.bodyBase.setBodyContactCallback(s.body,s.contactHero,s),s.bodyBow=new Phaser.Physics.Box2D.Body(i,null,482,240,2),s.bodyBow.setRectangle(50,22),s.bodyBow.fixedRotation=!0,s.bodyBow.sensor=!0,i.physics.box2d.revoluteJoint(s.body,s.bodyBow,35,-7),s.group=i.make.group(),s.group.x=s.body.x,s.group.y=s.body.y,e.GameManager.instance.layerElements.addChild(s.group),s.bubble=s.group.create(-150,-105,"level5"),s.bubble.animations.add("anim",Phaser.Animation.generateFrameNames("robinBubble instance 1",0,61,"",4),30,!1).killOnComplete=!0,s.bubble.visible=!1,s.bodyWheel1=new Phaser.Physics.Box2D.Body(i,null,s.body.x-35,s.body.y+35,2),s.bodyWheel1.setCircle(15),s.bodyWheel1.setCollisionCategory(e.FilterGroups.CAR2),i.physics.box2d.revoluteJoint(s.body,s.bodyWheel1,-35,35),s.bodyWheel2=new Phaser.Physics.Box2D.Body(i,null,s.body.x+30,s.body.y+35,2),s.bodyWheel2.setCircle(15),s.bodyWheel2.setCollisionCategory(e.FilterGroups.CAR2),i.physics.box2d.revoluteJoint(s.body,s.bodyWheel2,30,35),s.lamp=new e.SASprite(i,0,0,"level5","robinLamp instance 10000"),s.lamp.pivot.set(7,9),s.group.addChild(s.lamp),s.tors=new e.SASprite(i,0,0,"level5","robinTors instance 10000"),s.tors.pivot.set(69,37),s.group.addChild(s.tors),s.hat=new e.SASprite(i,0,0,"level5","robinHead instance 10000"),s.hat.pivot.set(32,24),s.group.addChild(s.hat),s.eyes=new e.SASprite(i,0,0,"level5","robinEye instance 10000"),s.eyes.pivot.set(11,12),s.group.addChild(s.eyes),s.zzz=new e.SASprite(i,0,0,"level5","robinZZZ instance 10000"),s.zzz.pivot.set(20,25),s.zzz.animations.add("anim",Phaser.Animation.generateFrameNames("robinZZZ instance 1",0,49,"",4),30,!0),s.zzz.animations.play("anim"),s.group.addChild(s.zzz),s.wheel1=s.group.create(-35,35,"level5","robinWheel instance 10000"),s.wheel1.anchor.setTo(.5),s.wheel2=s.group.create(32,32,"level5","robinWheel instance 10000"),s.wheel2.anchor.setTo(.5),s.wheel2.scale.setTo(1.2),s.weapon=new e.Lvl5RobinWeapon(i),s.playAnim("sleep",-1),s}return __extends(i,t),i.prototype.destroy=function(){this.activeAnim=!1,this.group.destroy(),this.body.destroy(),this.bodyWheel1.destroy(),this.bodyWheel2.destroy()},i.prototype.contactHero=function(){0===this.contactHeroCount&&(this.contactHeroCount=1)},i.prototype.update=function(){t.prototype.update.call(this),1===this.contactHeroCount&&(this.contactHeroCount=2,this.attack(),e.GameManager.instance.level.customAction(8)),!0===this.startDefeat&&(this.counterDefeat+=1,this.counterDefeat>=90&&(this.startDefeat=!1,e.LevelBuilder.instance.levelFailed())),this.group.x=this.body.x,this.group.y=this.body.y,this.wheel1.angle=this.bodyWheel1.angle,this.wheel2.angle=this.bodyWheel2.angle,!1===this.dead&&(this.weapon.group.x=this.group.x+10,this.weapon.group.y=this.group.y),this.weapon.update()},i.prototype.wakeUp=function(){this.playAnim("wakeUp"),this.eyes.frameName="robinEye instance 10001",this.weapon.playAnim("wakeUp"),e.SoundManager.playSFX("s_lvl5_robinAgression")},i.prototype.menace=function(){this.bubble.visible=!0,this.bubble.animations.play("anim"),this.playAnim("menace",-1),this.weapon.playAnim("menace",-1),this.body.velocity.x=-20},i.prototype.attack=function(){this.playAnim("attack"),this.weapon.playAnim("attack"),e.SoundManager.playSFX("s_sword1")},i.prototype.die=function(){this.dead=!0,this.body.velocity.x=0,this.bodyWheel1.angularVelocity=0,this.bodyWheel2.angularVelocity=0,this.bodyWheel1.velocity.x=0,this.bodyWheel2.velocity.x=0,this.eyes.frameName="robinEye instance 10002";var t=this.game.make.sprite(-15,-30,"level5");t.animations.add("cycle",Phaser.Animation.generateFrameNames("stars instance 1",0,18,"",4),30,!1).onComplete.add(this.endCycle,this),t.animations.add("end",Phaser.Animation.generateFrameNames("stars instance 1",19,74,"",4),30,!1).killOnComplete=!0,t.animations.play("cycle"),this.eyes.addChild(t),this.playAnim("die"),e.SoundManager.playSFX("s_lvl5_robinStars",!0),this.weapon.playAnim("die")},i.prototype.endCycle=function(e,t){this.countStars+=1,this.countStars>=6?e.animations.play("end"):e.animations.play("cycle")},i.prototype.onAnimComplete=function(){"wakeUp"===this.currAnim?(e.GameManager.instance.level.customAction(2),this.body.dynamic=!0):"attack"===this.currAnim&&(e.GameManager.instance.hero.currState=e.HeroState.bumpStars,this.startDefeat=!0)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"sleep"===this.currAnim?1===this.counterAnim?(this.setPart(this.zzz,{x:-53,y:-9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.eyes,25,{y:-12}),e.GameManager.instance.level.setSimpleTween(this.hat,25,{y:-38}),e.GameManager.instance.level.setSimpleTween(this.tors,25,{y:-2,scY:1.03}),e.GameManager.instance.level.setSimpleTween(this.lamp,25,{y:-31})):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,16,{y:-9}),e.GameManager.instance.level.setSimpleTween(this.hat,16,{y:-35}),e.GameManager.instance.level.setSimpleTween(this.tors,16,{y:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.lamp,16,{y:-28})):42===this.counterAnim&&this.animComplete():"wakeUp"===this.currAnim?11===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.hat,6,{x:-11,y:-36,skX:-2,skY:-2}):17===this.counterAnim&&this.animComplete():"menace"===this.currAnim?14===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,8,{x:-33,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.hat,8,{x:-12,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.tors,8,{x:-4}),e.GameManager.instance.level.setSimpleTween(this.lamp,8,{y:-30,skX:-19,skY:-19})):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,7,{x:-32,scY:1}),e.GameManager.instance.level.setSimpleTween(this.hat,7,{x:-11,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.tors,7,{x:-3}),e.GameManager.instance.level.setSimpleTween(this.lamp,7,{x:33,y:-27,skX:10,skY:10})):29===this.counterAnim?(this.setPart(this.eyes,{x:-32,y:-9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hat,{x:-11,y:-36,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.tors,{x:-3,y:1,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.lamp,4,{x:35,y:-28,skX:0,skY:0})):33===this.counterAnim?this.setPart(this.lamp,{x:35,y:-28,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):56===this.counterAnim&&this.animComplete():"attack"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,15,{x:-28,skX:-1,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.hat,15,{x:-8,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.tors,15,{x:1,skX:-3,skY:-3}),e.GameManager.instance.level.setSimpleTween(this.lamp,15,{x:38,y:-29,skX:-1,skY:-1})):16===this.counterAnim?(this.setPart(this.eyes,{x:-28,y:-9,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1}),this.setPart(this.hat,{x:-8,y:-36,angle:0,scX:1,scY:1,skX:-5,skY:-5,alpha:1}),this.setPart(this.tors,{x:1,y:1,angle:0,scX:1,scY:1,skX:-3,skY:-3,alpha:1}),this.setPart(this.lamp,{x:38,y:-29,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1})):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,8,{x:-40,y:-15,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.hat,8,{x:-17,y:-44,skX:4,skY:4}),e.GameManager.instance.level.setSimpleTween(this.tors,8,{x:-11,y:-3,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.lamp,8,{x:30,y:-32,skX:-18,skY:-18})):34===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,5,{x:-32,y:-9,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.hat,5,{x:-11,y:-33,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-3,y:1,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.lamp,5,{x:33,y:-27,skX:15,skY:15})):39===this.counterAnim?(this.setPart(this.eyes,{x:-32,y:-9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.hat,4,{y:-36}),this.setPart(this.tors,{x:-3,y:1,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.lamp,4,{x:35,y:-28,skX:0,skY:0})):43===this.counterAnim&&this.animComplete():"die"===this.currAnim&&(13===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.hat,4,{x:0,y:-44,skX:8,skY:8}),e.GameManager.instance.level.setSimpleTween(this.lamp,4,{x:50,y:-25,skX:-61,skY:-61})):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.eyes,5,{x:-32,y:-15,skX:15,skY:15,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.hat,5,{x:-4,y:-38}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{x:-2,y:0,skX:6,skY:6,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.lamp,5,{x:43,y:-27,skX:-46,skY:-46})):22===this.counterAnim?(this.setPart(this.eyes,{x:-32,y:-15,angle:0,scX:1,scY:1,skX:15,skY:15,alpha:1}),this.setPart(this.hat,{x:-4,y:-38,angle:0,scX:1,scY:1,skX:8,skY:8,alpha:1}),this.setPart(this.tors,{x:-2,y:0,angle:0,scX:1,scY:.98,skX:6,skY:6,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.lamp,5,{x:39,y:-23,skX:0,skY:0})):27===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"sleep"===e?(this.setPart(this.zzz,{x:-53,y:-9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eyes,{x:-32,y:-9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hat,{x:-9,y:-35,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1}),this.setPart(this.tors,{x:-3,y:1,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.lamp,{x:35,y:-28,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"wakeUp"===e?(this.setPart(this.zzz,{x:-53,y:-9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.eyes,{x:-32,y:-9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hat,{x:-9,y:-35,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1}),this.setPart(this.tors,{x:-3,y:1,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.lamp,{x:35,y:-28,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"menace"===e?(this.zzz.visible=!1,this.setPart(this.eyes,{x:-32,y:-9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hat,{x:-11,y:-36,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.tors,{x:-3,y:1,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.lamp,{x:35,y:-28,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"attack"===e?(this.zzz.visible=!1,this.setPart(this.eyes,{x:-32,y:-9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hat,{x:-11,y:-36,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.tors,{x:-3,y:1,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.lamp,{x:35,y:-28,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"die"===e&&(this.zzz.visible=!1,this.setPart(this.eyes,{x:-32,y:-9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.hat,{x:-11,y:-36,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.tors,{x:-3,y:1,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.lamp,{x:35,y:-28,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.game=null,this.group=null,this.lamp=null,this.tors=null,this.hat=null,this.eyes=null,this.zzz=null,this.bubble=null,this.wheel1=null,this.wheel2=null,this.body=null,this.bodyWheel1=null,this.bodyWheel2=null,this.bodyBow=null,this.weapon.free(),this.weapon=null},i}(e.BasicSimpleAnim);e.Lvl5Robin=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.bowPressed=!1,s.bowVec=new e.NapeVec2,s.currentFrame=0,s.game=i,s.group=i.make.group(),e.GameManager.instance.layerElements.addChild(s.group),s.knife=new e.SASprite(i,0,0,"level5","robinKnife instance 10000"),s.knife.pivot.set(27,18),s.group.addChild(s.knife),s.bowGroup=new e.SAGroup(i,0,0),s.group.addChild(s.bowGroup),s.bow=s.bowGroup.create(0,0,"level5","robinBow instance 10000"),s.bow.anchor.setTo(.7,.52),s.bow.angle=-48,s.bow.animations.add("shoot",Phaser.Animation.generateFrameNames("robinBow instance 1",18,32,"",4),30,!1),s.bow.events.onInputOut.add(s.bowOut,s),s.bow.events.onInputOver.add(s.bowOver,s),s.bow.events.onInputDown.add(s.bowDown,s),s.bow.events.onInputUp.add(s.bowUp,s),s.arrow=s.bowGroup.create(0,0,"level5","arrow instance 10000"),s.arrow.anchor.setTo(.7,.5),s.arrow.angle=-48,s.arrow.visible=!1,s.playAnim("sleep",-1),s}return __extends(i,t),i.prototype.takeArrow=function(){this.arrow.visible=!0,e.SoundManager.playSFX("s_lvl5_takeArrow")},i.prototype.bowOut=function(){!0!==this.bowPressed&&(this.bow.frameName="robinBow instance 10000")},i.prototype.bowOver=function(){!0!==this.bowPressed&&(this.bow.frameName="robinBow instance 10001")},i.prototype.bowDown=function(){!1!==this.arrow.visible&&(this.bowPressed=!0)},i.prototype.bowUp=function(){!1!==this.arrow.visible&&(this.bowPressed=!1,this.arrow.visible=!1,this.bow.animations.play("shoot"),e.SoundManager.playSFX("s_lvl5_arrowShoot"),e.GameManager.instance.level.blowArrow(this.group.x+this.bowGroup.x,this.group.y+this.bowGroup.y,this.arrow.angle,this.bowVec))},i.prototype.update=function(){if(t.prototype.update.call(this),!0===this.bowPressed){this.bowVec.x=this.group.x+(this.bowGroup.x+10)-this.game.input.worldX,this.bowVec.y=this.group.y+(this.bowGroup.y-10)-this.game.input.worldY,this.bow.rotation=this.bowVec.angle,this.arrow.rotation=this.bow.rotation;var i=this.bowVec.length/12;0===this.currentFrame&&i>=10?(e.SoundManager.playSFX("s_lvl5_loadBow"),this.currentFrame=1):this.currentFrame=0,i>15&&(i=15),this.bow.frameName="robinBow instance "+(10002+e.Tools.roundDec(i))}},i.prototype.playAnim=function(e,i){void 0===i&&(i=0),t.prototype.playAnim.call(this,e,i),"menace"===e?(this.bow.inputEnabled=!0,this.bow.input.useHandCursor=!0):"die"===e&&(this.bow.angle=0,this.bow.inputEnabled=!1,this.bowOut())},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"sleep"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bowGroup,25,{y:-4}),e.GameManager.instance.level.setSimpleTween(this.knife,25,{y:27})):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bowGroup,16,{y:-1}),e.GameManager.instance.level.setSimpleTween(this.knife,16,{y:30})):42===this.counterAnim&&this.animComplete():"wakeUp"===this.currAnim?11===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.knife,6,{x:-29,y:15,skX:0,skY:0}):17===this.counterAnim&&this.animComplete():"menace"===this.currAnim?14===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bowGroup,8,{x:31,y:0,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.knife,8,{x:-44,y:8,skX:-12,skY:-12})):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bowGroup,7,{x:36,y:-1,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.knife,7,{x:-29,y:15,skX:0,skY:0})):29===this.counterAnim?(this.setPart(this.bowGroup,{x:36,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.knife,{x:-29,y:15,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):56===this.counterAnim&&this.animComplete():"attack"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bowGroup,15,{x:43,y:-2,skX:-1,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.knife,3,{x:-27,y:13,skX:9,skY:9})):4===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.knife,4,{x:-25,y:16,skX:-1,skY:-1}):8===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.knife,4,{x:-23,y:14,skX:5,skY:5}):12===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.knife,4,{x:-21,y:16,skX:-1,skY:-1}):16===this.counterAnim?(this.setPart(this.bowGroup,{x:43,y:-2,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1}),this.setPart(this.knife,{x:-21,y:16,angle:0,scX:1,scY:1,skX:-1,skY:-1,alpha:1})):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bowGroup,8,{x:28,y:-7,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.knife,8,{x:-54,y:-3,skX:22,skY:22})):34===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bowGroup,5,{x:36,y:3,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.knife,5,{x:-46,y:23,skX:-13,skY:-13})):39===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bowGroup,4,{y:-1}),e.GameManager.instance.level.setSimpleTween(this.knife,4,{x:-29,y:15,skX:0,skY:0})):43===this.counterAnim&&this.animComplete():"die"===this.currAnim&&(13===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bowGroup,4,{x:76,y:-48,skX:-40,skY:-40}),e.GameManager.instance.level.setSimpleTween(this.knife,4,{x:-53,y:-45,skX:98,skY:98})):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bowGroup,10,{x:121,y:47,skX:-97,skY:-97}),e.GameManager.instance.level.setSimpleTween(this.knife,10,{x:-68,y:43,skX:160,skY:160})):27===this.counterAnim?(this.setPart(this.bowGroup,{x:121,y:47,angle:0,scX:1,scY:1,skX:-97,skY:-97,alpha:1}),this.setPart(this.knife,{x:-68,y:43,angle:0,scX:1,scY:1,skX:160,skY:160,alpha:1})):87===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"sleep"===e?(this.setPart(this.bowGroup,{x:36,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.knife,{x:-32,y:30,angle:0,scX:1,scY:1,skX:-18,skY:-18,alpha:1})):"wakeUp"===e?(this.setPart(this.bowGroup,{x:36,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.knife,{x:-32,y:30,angle:0,scX:1,scY:1,skX:-18,skY:-18,alpha:1})):"menace"===e?(this.setPart(this.bowGroup,{x:36,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.knife,{x:-29,y:15,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"attack"===e?(this.setPart(this.bowGroup,{x:36,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.knife,{x:-29,y:15,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"die"===e&&(this.setPart(this.bowGroup,{x:36,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.knife,{x:-29,y:15,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.knife=null,this.bowGroup=null,this.bow=null,this.arrow=null,this.game=null},i}(e.BasicSimpleAnim);e.Lvl5RobinWeapon=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=356,s.group.y=386,e.GameManager.instance.layerBackground.addChild(s.group),s.signal12=new e.SASprite(i,0,0,"level5","signal2 instance 10000"),s.signal12.pivot.set(6,6),s.group.addChild(s.signal12),s.signal11=new e.SASprite(i,0,0,"level5","signal4 instance 10000"),s.signal11.pivot.set(2,38),s.group.addChild(s.signal11),s.signal10=new e.SASprite(i,0,0,"level5","signal4 instance 10000"),s.signal10.pivot.set(2,38),s.group.addChild(s.signal10),s.signal9=new e.SASprite(i,0,0,"level5","signal4 instance 10000"),s.signal9.pivot.set(2,38),s.group.addChild(s.signal9),s.signal8=new e.SASprite(i,0,0,"level5","signal4 instance 10000"),s.signal8.pivot.set(2,38),s.group.addChild(s.signal8),s.signal7=new e.SASprite(i,0,0,"level5","signal3 instance 10000"),s.signal7.pivot.set(6,7),s.signal7.animations.add("anim",Phaser.Animation.generateFrameNames("signal3 instance 1",0,34,"",4),30,!1),s.group.addChild(s.signal7),s.signal6=new e.SASprite(i,0,0,"level5","signal3 instance 10000"),s.signal6.pivot.set(6,7),s.signal6.animations.add("anim",Phaser.Animation.generateFrameNames("signal3 instance 1",0,34,"",4),30,!1),s.group.addChild(s.signal6),s.signal5=new e.SASprite(i,0,0,"level5","signal3 instance 10000"),s.signal5.pivot.set(6,7),s.signal5.animations.add("anim",Phaser.Animation.generateFrameNames("signal3 instance 1",0,34,"",4),30,!1),s.group.addChild(s.signal5),s.signal4=new e.SASprite(i,0,0,"level5","signal3 instance 10000"),s.signal4.pivot.set(6,7),s.signal4.animations.add("anim",Phaser.Animation.generateFrameNames("signal3 instance 1",0,34,"",4),30,!1),s.group.addChild(s.signal4),s.signal3=new e.SASprite(i,0,0,"level5","signal5 instance 10000"),s.signal3.pivot.set(3,8),s.group.addChild(s.signal3),s.signal2=new e.SASprite(i,0,0,"level5","signal1 instance 10000"),s.signal2.pivot.set(6,6),s.group.addChild(s.signal2),s.signal1=new e.SASprite(i,0,0,"level5","signal instance 10000"),s.signal1.pivot.set(5,10),s.signal1.animations.add("anim",Phaser.Animation.generateFrameNames("signal instance 1",0,19,"",4),30,!1),s.group.addChild(s.signal1),s.signal0=new e.SASprite(i,0,0,"level5","signal instance 10000"),s.signal0.pivot.set(5,15),s.signal0.animations.add("anim",Phaser.Animation.generateFrameNames("signal instance 1",0,19,"",4),30,!1),s.group.addChild(s.signal0),s.setParts("anim"),s}return __extends(i,t),i.prototype.activate=function(){this.playAnim("anim"),this.signal4.animations.play("anim"),this.signal5.animations.play("anim"),this.signal6.animations.play("anim"),this.signal7.animations.play("anim"),e.SoundManager.playSFX("s_lvl5_bell")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.signal2,5,{x:23,y:-123,skX:46,skY:46}),e.GameManager.instance.level.setSimpleTween(this.signal3,5,{x:-49,y:137,skX:30,skY:30}),this.setPart(this.signal4,{x:36,y:132,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),this.setPart(this.signal5,{x:52,y:54,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),this.setPart(this.signal6,{x:6,y:-85,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.signal7,{x:23,y:-141,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.signal8,5,{x:-4,y:134,skX:-92,skY:-92,scY:1.11}),this.setPart(this.signal9,{x:45,y:94,angle:0,scX:1,scY:1,skX:10,skY:10,alpha:1}),this.setPart(this.signal10,{x:29,y:-15,angle:0,scX:1,scY:1.92,skX:-18,skY:-18,alpha:1}),this.setPart(this.signal11,{x:14,y:-113,angle:0,scX:1,scY:.73,skX:16,skY:16,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.signal12,5,{x:27,y:-134,skX:33,skY:33})):6===this.counterAnim?(this.signal0.visible=!0,this.signal0.animations.play("anim"),this.setPart(this.signal0,{x:54,y:-122,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.signal1.visible=!0,this.signal1.animations.play("anim"),this.setPart(this.signal1,{x:0,y:-122,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.signal2,9,{x:41,y:-140,skX:-94,skY:-94}),this.setPart(this.signal3,{x:-49,y:137,angle:0,scX:1,scY:1,skX:30,skY:30,alpha:1}),this.setPart(this.signal8,{x:-4,y:134,angle:0,scX:1,scY:1.11,skX:-92,skY:-92,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.signal12,9,{x:31,y:-141,skX:-33,skY:-33})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.signal2,6,{x:27,y:-125,skX:41,skY:41}),e.GameManager.instance.level.setSimpleTween(this.signal12,6,{x:28,y:-135,skX:19,skY:19})):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.signal2,6,{x:38,y:-130,skX:-61,skY:-61}),e.GameManager.instance.level.setSimpleTween(this.signal12,6,{x:30,y:-137,skX:0,skY:0})):27===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.signal2,4,{x:32,y:-127,skX:24,skY:24}),this.setPart(this.signal12,{x:30,y:-137,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):31===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.signal2,4,{x:34,skX:0,skY:0}):35===this.counterAnim?this.setPart(this.signal2,{x:34,y:-127,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):59===this.counterAnim&&(this.animComplete(),e.GameManager.instance.level.customAction(1))))},i.prototype.setParts=function(e){"anim"===e&&(this.signal0.visible=!1,this.signal1.visible=!1,this.setPart(this.signal2,{x:34,y:-127,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.signal3,{x:-53,y:136,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.signal4,{x:36,y:132,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),this.setPart(this.signal5,{x:52,y:54,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),this.setPart(this.signal6,{x:6,y:-85,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.signal7,{x:23,y:-141,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.signal8,{x:-9,y:133,angle:0,scX:1,scY:1.14,skX:-90,skY:-90,alpha:1}),this.setPart(this.signal9,{x:45,y:94,angle:0,scX:1,scY:1,skX:10,skY:10,alpha:1}),this.setPart(this.signal10,{x:29,y:-15,angle:0,scX:1,scY:1.92,skX:-18,skY:-18,alpha:1}),this.setPart(this.signal11,{x:14,y:-113,angle:0,scX:1,scY:.73,skX:16,skY:16,alpha:1}),this.setPart(this.signal12,{x:30,y:-137,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.signal12=null,this.signal11=null,this.signal10=null,this.signal9=null,this.signal8=null,this.signal7=null,this.signal6=null,this.signal5=null,this.signal4=null,this.signal3=null,this.signal2=null,this.signal1=null,this.signal0=null},i}(e.BasicSimpleAnim);e.Lvl5Signal=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;s.game=i,s.brunch6=new e.SASprite(i,0,0,"level5","branch6 instance 10000"),s.brunch6.pivot.set(272,161),e.GameManager.instance.layerBackground0.addChild(s.brunch6),s.brunch8=new e.SASprite(i,0,0,"level5","branch2 instance 10000"),s.brunch8.pivot.set(106,99),e.GameManager.instance.layerBackground0.addChild(s.brunch8),s.brunch7=new e.SASprite(i,0,0,"level5","branch2 instance 10000"),s.brunch7.pivot.set(106,99),e.GameManager.instance.layerBackground0.addChild(s.brunch7),s.branch1=new e.SASprite(i,0,0,"level5","branch1 instance 10000"),s.branch1.pivot.set(142,106),e.GameManager.instance.layerBackground0.addChild(s.branch1),s.brunch4=new e.SASprite(i,0,0,"level5","branch4 instance 10000"),s.brunch4.pivot.set(169,189),e.GameManager.instance.layerBackground.addChild(s.brunch4),s.bird=new e.Lvl5Bird1(i),s.brunch5=new e.SASprite(i,0,0,"level5","branch5 instance 10000"),s.brunch5.pivot.set(69,58),e.GameManager.instance.layerBackground.addChild(s.brunch5);var a=e.GameManager.instance.layerBackground.create(526,84,"level5","bgPart1 instance 10000");return a.cacheAsBitmap=!0,a=null,s.brunch3=new e.SASprite(i,0,0,"level5","branch3 instance 10000"),s.brunch3.pivot.set(186,206),e.GameManager.instance.layerBackground.addChild(s.brunch3),s.brunch2=new e.SASprite(i,0,0,"level5","branch2 instance 10000"),s.brunch2.pivot.set(106,99),e.GameManager.instance.layerBackground.addChild(s.brunch2),s.setParts("anim"),s}return __extends(i,t),i.prototype.activate=function(){this.playAnim("anim")},i.prototype.createLeaf=function(e,t,i){var s=this.game.make.sprite(t,i-30,"level5");Math.random()<.5?s.animations.add("anim",Phaser.Animation.generateFrameNames("leafAnim1 instance 1",0,48,"",4),30,!1).killOnComplete=!0:s.animations.add("anim",Phaser.Animation.generateFrameNames("leafAnim2 instance 1",0,91,"",4),30,!1).killOnComplete=!0,s.animations.play("anim"),e.parent.addChildAt(s,e.parent.getChildIndex(e)+1),s=null},i.prototype.onAnimComplete=function(){this.bird.activate()},i.prototype.update=function(){t.prototype.update.call(this),this.bird.update()},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(20===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brunch5,2,{x:713,y:128,skX:33,skY:32}),e.GameManager.instance.level.setSimpleTween(this.brunch4,2,{x:649,y:162,skX:2,skY:1}),e.GameManager.instance.level.setSimpleTween(this.brunch3,2,{y:127,skX:-1,skY:-2,scY:1.02}),e.GameManager.instance.level.setSimpleTween(this.brunch2,2,{x:335,y:157,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.branch1,2,{x:262,y:178,skX:-2,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.brunch7,2,{x:462,y:122,skX:-158,skY:-158}),e.GameManager.instance.level.setSimpleTween(this.brunch8,2,{x:604,y:161,skX:77,skY:77}),e.GameManager.instance.level.setSimpleTween(this.brunch6,3,{scX:1.01})):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brunch5,2,{x:711,y:126,skX:31,skY:31}),e.GameManager.instance.level.setSimpleTween(this.brunch4,2,{x:647,y:161,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.brunch3,2,{x:486,y:128,skX:0,skY:0,scY:1.01}),e.GameManager.instance.level.setSimpleTween(this.brunch2,2,{x:338,y:155,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.branch1,2,{x:265,y:176,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.brunch7,2,{x:459,y:123,skX:-156,skY:-156}),e.GameManager.instance.level.setSimpleTween(this.brunch8,2,{x:606,y:163,skX:79,skY:79})):23===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.brunch6,3,{scX:1}):24===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brunch5,2,{x:713,y:128,skX:33,skY:32}),e.GameManager.instance.level.setSimpleTween(this.brunch4,2,{x:649,y:162,skX:2,skY:1}),e.GameManager.instance.level.setSimpleTween(this.brunch3,2,{x:485,y:127,skX:-1,skY:-2,scY:1.03}),e.GameManager.instance.level.setSimpleTween(this.brunch2,2,{x:335,y:157,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.branch1,2,{x:262,y:178,skX:-2,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.brunch7,2,{x:462,y:122,skX:-158,skY:-158}),e.GameManager.instance.level.setSimpleTween(this.brunch8,2,{x:604,y:161,skX:77,skY:77})):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brunch5,2,{x:711,y:126,skX:31,skY:31}),e.GameManager.instance.level.setSimpleTween(this.brunch4,2,{x:647,y:161,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.brunch3,2,{y:129,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.brunch2,2,{x:338,y:155,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.branch1,2,{x:265,y:176,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.brunch7,2,{x:459,y:123,skX:-156,skY:-156}),e.GameManager.instance.level.setSimpleTween(this.brunch8,2,{x:606,y:163,skX:79,skY:79}),e.GameManager.instance.level.setSimpleTween(this.brunch6,3,{scX:1.01})):28===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brunch5,2,{x:713,y:128,skX:33,skY:32}),e.GameManager.instance.level.setSimpleTween(this.brunch4,2,{x:649,y:162,skX:2,skY:1}),e.GameManager.instance.level.setSimpleTween(this.brunch3,2,{y:127,skX:-1,skY:-2,scY:1.03}),e.GameManager.instance.level.setSimpleTween(this.brunch2,2,{x:335,y:157,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.branch1,2,{x:262,y:178,skX:-2,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.brunch7,2,{x:462,y:122,skX:-158,skY:-158}),e.GameManager.instance.level.setSimpleTween(this.brunch8,2,{x:604,y:161,skX:77,skY:77})):29===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brunch6,3,{scX:1}),this.createLeaf(this.branch1,144,255),this.createLeaf(this.branch1,213,238),this.createLeaf(this.brunch2,315,175),this.createLeaf(this.brunch2,470,80),this.createLeaf(this.brunch3,585,88),this.createLeaf(this.brunch4,685,130),this.createLeaf(this.brunch5,755,185),this.createLeaf(this.brunch6,565,335)):30===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.brunch5,2,{x:711,y:126,skX:31,skY:31}),e.GameManager.instance.level.setSimpleTween(this.brunch4,2,{x:647,y:161,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.brunch3,2,{y:129,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.brunch2,2,{x:338,y:155,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.branch1,2,{x:265,y:176,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.brunch7,2,{x:459,y:123,skX:-156,skY:-156}),e.GameManager.instance.level.setSimpleTween(this.brunch8,2,{x:606,y:163,skX:79,skY:79})):40===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.brunch5,{x:711,y:126,angle:0,scX:1,scY:1,skX:31,skY:31,alpha:1}),this.setPart(this.brunch4,{x:647,y:161,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.brunch3,{x:485,y:129,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.brunch2,{x:338,y:155,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.branch1,{x:265,y:176,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.brunch7,{x:459,y:123,angle:0,scX:1,scY:1,skX:-156,skY:-156,alpha:1}),this.setPart(this.brunch8,{x:606,y:163,angle:0,scX:1,scY:1,skX:79,skY:79,alpha:1}),this.setPart(this.brunch6,{x:437,y:173,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.game=null,this.brunch6=null,this.brunch8=null,this.brunch7=null,this.branch1=null,this.brunch2=null,this.brunch3=null,this.brunch4=null,this.brunch5=null,this.bird.free(),this.bird=null},i}(e.BasicSimpleAnim);e.Lvl5TreeBranch=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n){var o=t.call(this,i)||this;return o.group=i.make.group(),o.group.x=s,o.group.y=a+20,o.group.angle=n,e.GameManager.instance.layerBackground.addChild(o.group),o.capePart5=new e.SASprite(i,0,0,"level6","car2Part8 instance 10000"),o.capePart5.anchor.set(.5),o.group.addChild(o.capePart5),o.capePart4=new e.SASprite(i,0,0,"level6","car2Part7 instance 10000"),o.capePart4.anchor.set(.5),o.group.addChild(o.capePart4),o.capePart3=new e.SASprite(i,0,0,"level6","car2Part6 instance 10000"),o.capePart3.anchor.set(.5),o.group.addChild(o.capePart3),o.caprPart2=new e.SASprite(i,0,0,"level6","car2Part5 instance 10000"),o.caprPart2.anchor.set(.5),o.group.addChild(o.caprPart2),o.capePart1=new e.SASprite(i,0,0,"level6","car2Part4 instance 10000"),o.capePart1.anchor.set(.5),o.group.addChild(o.capePart1),o.playAnim("out"),o}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"out"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.capePart1,14,{x:15,y:7,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.caprPart2,14,{x:19,y:9}),e.GameManager.instance.level.setSimpleTween(this.capePart3,14,{x:-20,y:-3,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.capePart4,14,{x:31,y:31,skX:-3}),e.GameManager.instance.level.setSimpleTween(this.capePart5,14,{x:-25,y:26,skX:3})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.capePart1,11,{x:20,y:44}),e.GameManager.instance.level.setSimpleTween(this.caprPart2,11,{x:26,y:48,skX:6,skY:6}),e.GameManager.instance.level.setSimpleTween(this.capePart3,11,{x:-24,y:45,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.capePart4,11,{x:34,y:52,skX:16,scY:.23}),e.GameManager.instance.level.setSimpleTween(this.capePart5,11,{x:-26,y:51,scY:.21})):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.capePart1,9,{y:46,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.caprPart2,9,{y:51,skX:11,skY:8,scY:.75}),e.GameManager.instance.level.setSimpleTween(this.capePart3,9,{y:49,skX:-15,skY:-7,scY:.75}),e.GameManager.instance.level.setSimpleTween(this.capePart4,9,{y:54,scY:.17}),e.GameManager.instance.level.setSimpleTween(this.capePart5,9,{x:-27,y:53,scY:.17})):35===this.counterAnim?(this.setPart(this.capePart1,{x:20,y:46,angle:0,scX:1,scY:1,skX:-21,skY:-21,alpha:1}),this.setPart(this.caprPart2,{x:26,y:51,angle:0,scX:1,scY:.75,skX:11,skY:8,alpha:1}),this.setPart(this.capePart3,{x:-24,y:49,angle:0,scX:1,scY:.75,skX:-15,skY:-7,alpha:1}),this.setPart(this.capePart4,{x:34,y:54,angle:0,scX:1,scY:.17,skX:16,skY:0,alpha:1}),this.setPart(this.capePart5,{x:-27,y:53,angle:0,scX:1,scY:.17,skX:3,skY:0,alpha:1})):60===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.capePart1,9,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.caprPart2,9,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.capePart3,9,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.capePart4,9,{alpha:0}),e.GameManager.instance.level.setSimpleTween(this.capePart5,9,{alpha:0})):69===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"out"===e&&(this.setPart(this.capePart1,{x:8,y:-16,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.caprPart2,{x:15,y:-12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.capePart3,{x:-16,y:-24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.capePart4,{x:26,y:8,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.capePart5,{x:-21,y:4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.capePart5=null,this.capePart4=null,this.capePart3=null,this.caprPart2=null,this.capePart1=null},i}(e.BasicSimpleAnim);e.Lvl6Cape=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.tryCount=0,s.group=i.make.group(),s.group.x=604,s.group.y=408,e.GameManager.instance.layerBackground.addChild(s.group),s.car1Part6=new e.SASprite(i,0,0,"level6","car1Part6 instance 10000"),s.car1Part6.anchor.set(.5),s.group.addChild(s.car1Part6),s.car1Part5=new e.SASprite(i,0,0,"level6","car1Part5 instance 10000"),s.car1Part5.anchor.set(.5),s.group.addChild(s.car1Part5),s.car1Part4=new e.SASprite(i,0,0,"level6","car1Part4 instance 10000"),s.car1Part4.anchor.set(.5),s.group.addChild(s.car1Part4),s.car1Part3=new e.SASprite(i,0,0,"level6","car1Part3 instance 10000"),s.car1Part3.anchor.set(.5),s.group.addChild(s.car1Part3),s.carPart2=new e.SASprite(i,0,0,"level6","car1Part2 instance 10000"),s.carPart2.anchor.set(.5),s.group.addChild(s.carPart2),s.carPart1=new e.SASprite(i,0,0,"level6","car1Part1 instance 10000"),s.carPart1.anchor.set(.5),s.group.addChild(s.carPart1),s.car1Eye=new e.SASprite(i,0,0,"level6","car1Eye instance 10000"),s.car1Eye.animations.add("try",Phaser.Animation.generateFrameNames("car1Eye instance 1",0,62,"",4),30,!1).onComplete.add(s.try,s),s.car1Eye.animations.add("sad",Phaser.Animation.generateFrameNames("car1Eye instance 1",63,83,"",4),30,!1),s.car1Eye.anchor.set(.5),s.group.addChild(s.car1Eye),s.try(),s.addPhysics(),s}return __extends(i,t),i.prototype.try=function(){2===this.tryCount?(this.car1Eye.play("sad"),this.move(),e.GameManager.instance.level.moveCars(),e.GameManager.instance.level.swordAnim.pause()):(this.car1Eye.play("try"),this.playAnim("try")),this.tryCount+=1},i.prototype.move=function(){this.jointBack.EnableMotor(!0),this.jointBack.SetMotorSpeed(5)},i.prototype.addPhysics=function(){this.physics=new Phaser.Physics.Box2D.Body(e.Main.instance,null,this.group.x,this.group.y),this.physics.setRectangle(133,40,0,0),this.physics.setCollisionCategory(e.FilterGroups.CAR1),this.physics.collideWorldBounds=!1,this.wheel1=e.GameManager.instance.layerBackground.create(this.group.x-28,this.group.y+39,"level6","firstWheel_mc instance 10000"),this.wheel1.anchor.set(.5),e.Main.instance.physics.box2d.enable(this.wheel1),this.wheel1.body.setCircle(16),this.wheel1.body.friction=3,this.wheel1.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel1.body.collideWorldBounds=!1,this.wheel2=e.GameManager.instance.layerBackground.create(this.group.x+40,this.group.y+39,"level6","firstWheel_mc instance 10000"),this.wheel2.anchor.set(.5),e.Main.instance.physics.box2d.enable(this.wheel2),this.wheel2.body.setCircle(16),this.wheel2.body.friction=3,this.wheel2.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel2.body.collideWorldBounds=!1;this.jointBack=e.Main.instance.physics.box2d.wheelJoint(this.physics,this.wheel1,-35,39,0,0,0,1,5,.3,0,4,!0),e.Main.instance.physics.box2d.revoluteJoint(this.physics,this.wheel2,32,39,0,0)},i.prototype.update=function(){t.prototype.update.call(this),this.group.x=this.physics.x,this.group.y=this.physics.y,this.group.angle=this.physics.angle},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"try"===this.currAnim&&(5===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car1Eye,10,{x:23,y:-22,skX:5,skY:3,scY:.96}),e.GameManager.instance.level.setSimpleTween(this.carPart1,10,{x:-30,y:-19,skX:1,skY:3}),e.GameManager.instance.level.setSimpleTween(this.carPart2,10,{x:-51,y:-21,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.car1Part3,10,{x:-40,y:-20,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.car1Part4,10,{x:24,y:1,skX:5,skY:3}),e.GameManager.instance.level.setSimpleTween(this.car1Part5,10,{x:-14,y:-3,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.car1Part6,10,{x:57,y:-17,skX:10,skY:10})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car1Eye,33,{x:29,y:-25,skX:-6,skY:-6,scY:1}),e.GameManager.instance.level.setSimpleTween(this.carPart1,33,{x:-25,y:-17,skY:-2,scY:1.01}),e.GameManager.instance.level.setSimpleTween(this.carPart2,33,{y:-16,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.car1Part3,33,{x:-36,y:-18,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.car1Part4,33,{x:32,y:-3,skX:-2,skY:-3}),e.GameManager.instance.level.setSimpleTween(this.car1Part5,33,{x:-8,y:-2,skX:-1,skY:-2,scX:1.03}),e.GameManager.instance.level.setSimpleTween(this.car1Part6,33,{x:60,y:-24,skX:-5,skY:-5})):48===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car1Eye,6,{x:36,y:-29,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.carPart1,6,{x:-22,y:-29,skX:7,skY:3,scY:.89}),e.GameManager.instance.level.setSimpleTween(this.carPart2,6,{x:-36,y:-36,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.car1Part3,6,{x:-32,y:-31,skX:-5,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.car1Part4,6,{x:34,y:-10,skX:1,skY:-2,scY:.98}),e.GameManager.instance.level.setSimpleTween(this.car1Part5,6,{x:-7,y:-9,skX:4,skY:2}),e.GameManager.instance.level.setSimpleTween(this.car1Part6,6,{x:64,y:-26,skX:0,skY:-1})):54===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car1Eye,6,{x:28,y:-24,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.carPart1,6,{x:-25,y:-18,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.carPart2,6,{x:-47,y:-19,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car1Part3,6,{x:-36,y:-18,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car1Part4,6,{x:29,y:-1,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.car1Part5,6,{x:-8,y:-2,skX:0,skY:0,scX:1}),e.GameManager.instance.level.setSimpleTween(this.car1Part6,6,{x:61,y:-21,skY:0})):60===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"try"===e&&(this.setPart(this.car1Eye,{x:28,y:-24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.carPart1,{x:-25,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.carPart2,{x:-47,y:-19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car1Part3,{x:-36,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car1Part4,{x:29,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car1Part5,{x:-8,y:-2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car1Part6,{x:61,y:-21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.car1Part6=null,this.car1Part5=null,this.car1Part4=null,this.car1Part3=null,this.carPart2=null,this.carPart1=null,this.car1Eye=null,this.physics=null,this.wheel1=null,this.wheel2=null,this.jointBack=null},i}(e.BasicSimpleAnim);e.Lvl6Car1=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.goOut=!1,s.stopNow=!1,s.group=i.make.group(),s.group.x=480,s.group.y=400,e.GameManager.instance.layerBackground.addChild(s.group),s.car2Part14=new e.SASprite(i,0,0,"level6","car2Part14 instance 10000"),s.car2Part14.anchor.set(.5),s.group.addChild(s.car2Part14),s.car2Part13=new e.SASprite(i,0,0,"level6","car2Part12 instance 10000"),s.car2Part13.anchor.set(.5),s.group.addChild(s.car2Part13),s.car2Part12=new e.SASprite(i,0,0,"level6","car2Part12 instance 10000"),s.car2Part12.anchor.set(.5),s.group.addChild(s.car2Part12),s.car2Part11=new e.SASprite(i,0,0,"level6","car2Part11 instance 10000"),s.car2Part11.pivot.set(14,13),s.group.addChild(s.car2Part11),s.car2Part10=new e.SASprite(i,0,0,"level6","car2Part10 instance 10000"),s.car2Part10.anchor.set(.5),s.group.addChild(s.car2Part10),s.car2Part9=new e.SASprite(i,0,0,"level6","car2Part9 instance 10000"),s.car2Part9.pivot.set(15,13),s.group.addChild(s.car2Part9),s.car2Part8=new e.SASprite(i,0,0,"level6","car2Part8 instance 10000"),s.car2Part8.anchor.set(.5),s.group.addChild(s.car2Part8),s.car2Part7=new e.SASprite(i,0,0,"level6","car2Part7 instance 10000"),s.car2Part7.anchor.set(.5),s.group.addChild(s.car2Part7),s.car2Part6=new e.SASprite(i,0,0,"level6","car2Part6 instance 10000"),s.car2Part6.anchor.set(.5),s.group.addChild(s.car2Part6),s.car2Part5=new e.SASprite(i,0,0,"level6","car2Part5 instance 10000"),s.car2Part5.anchor.set(.5),s.group.addChild(s.car2Part5),s.car2Part4=new e.SASprite(i,0,0,"level6","car2Part4 instance 10002"),s.car2Part4.events.onInputOver.add(s.over,s),s.car2Part4.events.onInputUp.add(s.up,s),s.car2Part4.events.onInputOut.add(s.out,s),s.car2Part4.anchor.set(.5),s.group.addChild(s.car2Part4),s.car2Part3=new e.SASprite(i,0,0,"level6","car2Part3 instance 10000"),s.car2Part3.anchor.set(.5),s.group.addChild(s.car2Part3),s.car2Part2=new e.SASprite(i,0,0,"level6","car2Part2 instance 10000"),s.car2Part2.anchor.set(.5),s.group.addChild(s.car2Part2),s.car2Part1=new e.SASprite(i,0,0,"level6","car2Part1 instance 10000"),s.car2Part1.anchor.set(.5),s.group.addChild(s.car2Part1),s.playAnim("wait",-1),s.addPhysics(),s}return __extends(i,t),i.prototype.over=function(){this.car2Part4.frameName="car2Part4 instance 10001"},i.prototype.out=function(){this.car2Part4.frameName="car2Part4 instance 10000"},i.prototype.up=function(){this.car2Part4.inputEnabled=!1,this.car2Part4.frameName="car2Part4 instance 10003",this.activeAnim=!1,this.car2Part1.visible=!1,this.car2Part2.visible=!1,this.car2Part3.visible=!1,this.car2Part4.visible=!1,this.car2Part5.visible=!1,this.car2Part6.visible=!1,this.car2Part7.visible=!1,this.car2Part8.visible=!1,this.car2Part11.visible=!1,this.car2Part12.visible=!1,this.car2Part13.visible=!1,this.car2Part14.visible=!1,this.goOut=!0,this.topCar=e.GameManager.instance.layerBackground.create(this.group.x,this.group.y-20,"level6","topCar instance 10000"),this.topCar.anchor.set(.5),e.Main.instance.add.tween(this.topCar).to({x:900,y:480,angle:19},1500,"Linear",!0);var t=new e.Lvl6Cape(e.Main.instance,this.group.x,this.group.y,this.group.angle);e.GameManager.instance.level.updateElements.push(t),e.GameManager.instance.level.moveCars(),e.GameManager.instance.level.swordAnim.stop()},i.prototype.addPhysics=function(){this.physics=new Phaser.Physics.Box2D.Body(e.Main.instance,null,this.group.x,this.group.y),this.physics.setRectangle(95,40,0,50),this.physics.setCollisionCategory(e.FilterGroups.CAR1),this.physics.collideWorldBounds=!1,this.wheel1=e.GameManager.instance.layerBackground.create(this.group.x-22,this.group.y+70,"level6","secondWheel2_mc instance 10000"),this.wheel1.anchor.set(.5),e.Main.instance.physics.box2d.enable(this.wheel1),this.wheel1.body.setCircle(11),this.wheel1.body.friction=3,this.wheel1.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel1.body.collideWorldBounds=!1,this.wheel2=e.GameManager.instance.layerBackground.create(this.group.x+33,this.group.y+70,"level6","secondWheel1_mc instance 10000"),this.wheel2.anchor.set(.5),e.Main.instance.physics.box2d.enable(this.wheel2),this.wheel2.body.setCircle(8),this.wheel2.body.friction=3,this.wheel2.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel2.body.collideWorldBounds=!1;this.jointBack=e.Main.instance.physics.box2d.wheelJoint(this.physics,this.wheel1,-22,70,0,0,0,1,5,.3,0,4,!0),e.Main.instance.physics.box2d.revoluteJoint(this.physics,this.wheel2,29,70,0,0)},i.prototype.move=function(){this.wheel1.body.dynamic=!0,this.wheel2.body.static=!1,this.physics.dynamic=!0,this.jointBack.EnableMotor(!0),this.jointBack.SetMotorSpeed(10)},i.prototype.stopMove=function(){!1===this.goOut&&(this.jointBack.EnableMotor(!1),this.jointBack.SetMotorSpeed(0),this.wheel1.body.static=!0,this.wheel2.body.static=!0,this.physics.static=!0)},i.prototype.update=function(){t.prototype.update.call(this),this.group.x=this.physics.x,this.group.y=this.physics.y,this.group.angle=this.physics.angle,!1===this.stopNow&&this.physics.x>590&&(this.stopNow=!0,this.car2Part4.inputEnabled=!0,this.car2Part4.input.useHandCursor=!0,this.car2Part4.frameName="car2Part4 instance 10000",this.stopMove(),this.playAnim("trying",-1),!1===this.goOut&&e.GameManager.instance.level.playAnim())},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"wait"===this.currAnim?5===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car2Part1,5,{x:29,y:5,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.car2Part2,5,{x:41,y:1,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.car2Part3,5,{y:-40,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.car2Part4,5,{y:10,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.car2Part5,5,{y:12,skX:-4,skY:-4,scX:1.1}),e.GameManager.instance.level.setSimpleTween(this.car2Part6,5,{x:-17,y:2,skX:-4,skY:-4}),e.GameManager.instance.level.setSimpleTween(this.car2Part7,5,{x:27,y:32,skX:-1,skY:-1,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.car2Part8,5,{y:29,skX:2,skY:2,scY:.9}),e.GameManager.instance.level.setSimpleTween(this.car2Part11,5,{x:13,y:-34}),e.GameManager.instance.level.setSimpleTween(this.car2Part12,5,{y:17}),e.GameManager.instance.level.setSimpleTween(this.car2Part13,5,{y:21}),e.GameManager.instance.level.setSimpleTween(this.car2Part14,5,{x:2,y:-5})):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car2Part1,4,{x:30,y:3,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.car2Part2,4,{x:40,y:0,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car2Part3,4,{y:-43,skX:-3,skY:-3}),e.GameManager.instance.level.setSimpleTween(this.car2Part4,4,{y:6,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car2Part5,4,{y:9,skX:0,skY:0,scX:1}),e.GameManager.instance.level.setSimpleTween(this.car2Part6,4,{x:-16,y:-3,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car2Part7,4,{x:26,y:29,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.car2Part8,4,{y:26,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.car2Part11,4,{x:12,y:-37}),e.GameManager.instance.level.setSimpleTween(this.car2Part12,4,{y:14}),e.GameManager.instance.level.setSimpleTween(this.car2Part13,4,{y:18}),e.GameManager.instance.level.setSimpleTween(this.car2Part14,4,{x:1,y:-8})):14===this.counterAnim?(this.setPart(this.car2Part1,{x:30,y:3,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}),this.setPart(this.car2Part2,{x:40,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part3,{x:13,y:-43,angle:0,scX:1,scY:1,skX:-3,skY:-3,alpha:1}),this.setPart(this.car2Part4,{x:8,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part5,{x:15,y:9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part6,{x:-16,y:-3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part7,{x:26,y:29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part8,{x:-21,y:26,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part9,{x:17,y:19,angle:0,scX:1.07,scY:1.07,skX:18,skY:18,alpha:1}),this.setPart(this.car2Part10,{x:1,y:45,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part11,{x:12,y:-37,angle:0,scX:1.07,scY:1.07,skX:14,skY:14,alpha:1}),this.setPart(this.car2Part12,{x:26,y:14,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.car2Part13,{x:-23,y:18,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.car2Part14,{x:1,y:-8,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1})):42===this.counterAnim&&this.animComplete():"trying"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car2Part1,22,{x:26,y:7,skX:30,skY:30}),e.GameManager.instance.level.setSimpleTween(this.car2Part2,22,{x:41,y:3,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.car2Part3,22,{x:14,y:-37,skX:-1,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.car2Part4,22,{y:12,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.car2Part5,22,{y:14,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.car2Part6,22,{y:2,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.car2Part7,22,{y:34,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.car2Part8,22,{y:31,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.car2Part10,22,{x:2,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.car2Part11,22,{y:-30}),e.GameManager.instance.level.setSimpleTween(this.car2Part14,22,{y:-1})):23===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car2Part1,8,{x:33,y:-1,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.car2Part2,8,{y:-6,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.car2Part3,10,{x:12,y:-61,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.car2Part4,8,{y:-1,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car2Part5,8,{y:1,skX:7,skY:7}),e.GameManager.instance.level.setSimpleTween(this.car2Part6,8,{y:-8,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.car2Part7,8,{x:27,y:27,skX:-3,skY:-3}),e.GameManager.instance.level.setSimpleTween(this.car2Part8,8,{y:23,skX:4,skY:4,scY:1.02}),e.GameManager.instance.level.setSimpleTween(this.car2Part10,8,{x:1,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car2Part11,8,{y:-42}),e.GameManager.instance.level.setSimpleTween(this.car2Part14,8,{x:2,y:-12})):31===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car2Part1,5,{x:30,y:3,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.car2Part2,5,{x:40,y:0,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car2Part4,5,{y:6}),e.GameManager.instance.level.setSimpleTween(this.car2Part5,5,{y:9,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car2Part6,5,{y:-3,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car2Part7,5,{x:26,y:29,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car2Part8,5,{y:26,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.car2Part11,5,{y:-37}),e.GameManager.instance.level.setSimpleTween(this.car2Part14,5,{x:1,y:-8})):33===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.car2Part3,7,{x:13,y:-43,skX:-3,skY:-3}):36===this.counterAnim?(this.setPart(this.car2Part1,{x:30,y:3,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}),this.setPart(this.car2Part2,{x:40,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part4,{x:8,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part5,{x:15,y:9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part6,{x:-16,y:-3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part7,{x:26,y:29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part8,{x:-21,y:26,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part9,{x:17,y:19,angle:0,scX:1.07,scY:1.07,skX:18,skY:18,alpha:1}),this.setPart(this.car2Part10,{x:1,y:45,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part11,{x:12,y:-37,angle:0,scX:1.07,scY:1.07,skX:14,skY:14,alpha:1}),this.setPart(this.car2Part12,{x:26,y:14,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.car2Part13,{x:-23,y:18,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.car2Part14,{x:1,y:-8,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1})):40===this.counterAnim?this.setPart(this.car2Part3,{x:13,y:-43,angle:0,scX:1,scY:1,skX:-3,skY:-3,alpha:1}):46===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"wait"===e?(this.setPart(this.car2Part1,{x:30,y:3,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}),this.setPart(this.car2Part2,{x:40,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part3,{x:13,y:-43,angle:0,scX:1,scY:1,skX:-3,skY:-3,alpha:1}),this.setPart(this.car2Part4,{x:8,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part5,{x:15,y:9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part6,{x:-16,y:-3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part7,{x:26,y:29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part8,{x:-21,y:26,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part9,{x:17,y:19,angle:0,scX:1.07,scY:1.07,skX:18,skY:18,alpha:1}),this.setPart(this.car2Part10,{x:1,y:45,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part11,{x:12,y:-37,angle:0,scX:1.07,scY:1.07,skX:14,skY:14,alpha:1}),this.setPart(this.car2Part12,{x:26,y:14,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.car2Part13,{x:-23,y:18,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.car2Part14,{x:1,y:-8,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1})):"trying"===e&&(this.setPart(this.car2Part1,{x:30,y:3,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}),this.setPart(this.car2Part2,{x:40,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part3,{x:13,y:-43,angle:0,scX:1,scY:1,skX:-3,skY:-3,alpha:1}),this.setPart(this.car2Part4,{x:8,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part5,{x:15,y:9,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part6,{x:-16,y:-3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part7,{x:26,y:29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part8,{x:-21,y:26,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part9,{x:17,y:19,angle:0,scX:1.07,scY:1.07,skX:18,skY:18,alpha:1}),this.setPart(this.car2Part10,{x:1,y:45,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car2Part11,{x:12,y:-37,angle:0,scX:1.07,scY:1.07,skX:14,skY:14,alpha:1}),this.setPart(this.car2Part12,{x:26,y:14,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.car2Part13,{x:-23,y:18,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.car2Part14,{x:1,y:-8,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}))},i.prototype.free=function(){this.group=null,this.car2Part14=null,this.car2Part14=null,this.car2Part13=null,this.car2Part12=null,this.car2Part11=null,this.car2Part10=null,this.car2Part9=null,this.car2Part8=null,this.car2Part7=null,this.car2Part6=null,this.car2Part5=null,this.car2Part4=null,this.car2Part2=null,this.car2Part3=null,this.physics=null,this.wheel1=null,this.wheel2=null,this.topCar=null,this.jointBack=null},i}(e.BasicSimpleAnim);e.Lvl6Car2=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.ligthningNow=!1,s.ligthningTimer=0,s.goOut=!1,s.stopNow=!1,s.group=i.make.group(),s.group.x=370,s.group.y=435,e.GameManager.instance.layerBackground.addChild(s.group),s.ligthning=s.group.create(0,0,"level6","car3Ligthning instance 10000"),s.ligthning.anchor.set(.5),s.ligthning.animations.add("anim",Phaser.Animation.generateFrameNames("car3Ligthning instance 1",0,7,"",4),30,!0),s.ligthning.visible=!1,s.car3Part7=new e.SASprite(i,0,0,"level6","car3Part7 instance 10000"),s.car3Part7.anchor.set(.5),s.car3Part7.animations.add("normal",Phaser.Animation.generateFrameNames("car3Part7 instance 1",0,0,"",4),30,!1),s.car3Part7.animations.add("ligthning",Phaser.Animation.generateFrameNames("car3Part7 instance 1",1,9,"",4),30,!0),s.group.addChild(s.car3Part7),s.car3Eye=new e.SASprite(i,0,0,"level6","car3Eye instance 10000"),s.car3Eye.animations.add("normal",Phaser.Animation.generateFrameNames("car3Eye instance 1",0,23,"",4),30,!0),s.car3Eye.animations.add("try",Phaser.Animation.generateFrameNames("car3Eye instance 1",24,55,"",4),30,!1),s.car3Eye.animations.add("ligthning",Phaser.Animation.generateFrameNames("car3Eye instance 1",56,63,"",4),30,!1),s.car3Eye.pivot.set(52,57),s.group.addChild(s.car3Eye),s.car3Part5=new e.SASprite(i,0,0,"level6","car3Part3 instance 10000"),s.car3Part5.anchor.set(.5),s.car3Part5.animations.add("normal",Phaser.Animation.generateFrameNames("car3Part3 instance 1",0,0,"",4),30,!1),s.car3Part5.animations.add("ligthning",Phaser.Animation.generateFrameNames("car3Part3 instance 1",1,9,"",4),30,!0),s.group.addChild(s.car3Part5),s.car3Part4=new e.SASprite(i,0,0,"level6","car3Part3 instance 10000"),s.car3Part4.anchor.set(.5),s.car3Part4.animations.add("normal",Phaser.Animation.generateFrameNames("car3Part3 instance 1",0,0,"",4),30,!1),s.car3Part4.animations.add("ligthning",Phaser.Animation.generateFrameNames("car3Part3 instance 1",1,9,"",4),30,!0),s.group.addChild(s.car3Part4),s.car3Part3=new e.SASprite(i,0,0,"level6","car3Part3 instance 10000"),s.car3Part3.anchor.set(.5),s.car3Part3.animations.add("normal",Phaser.Animation.generateFrameNames("car3Part3 instance 1",0,0,"",4),30,!1),s.car3Part3.animations.add("ligthning",Phaser.Animation.generateFrameNames("car3Part3 instance 1",1,9,"",4),30,!0),s.group.addChild(s.car3Part3),s.car3Part2=new e.SASprite(i,0,0,"level6","car3Part1 instance 10000"),s.car3Part2.anchor.set(.5),s.car3Part2.animations.add("normal",Phaser.Animation.generateFrameNames("car3Part1 instance 1",0,0,"",4),30,!1),s.car3Part2.animations.add("ligthning",Phaser.Animation.generateFrameNames("car3Part1 instance 1",1,9,"",4),30,!0),s.group.addChild(s.car3Part2),s.car3Part1=new e.SASprite(i,0,0,"level6","car3Part1 instance 10000"),s.car3Part1.anchor.set(.5),s.car3Part1.animations.add("normal",Phaser.Animation.generateFrameNames("car3Part1 instance 1",0,0,"",4),30,!1),s.car3Part1.animations.add("ligthning",Phaser.Animation.generateFrameNames("car3Part1 instance 1",1,9,"",4),30,!0),s.group.addChild(s.car3Part1),s.playAnim("normal",-1),s.car3Eye.play("normal"),s.addPhysics(),s}return __extends(i,t),i.prototype.addPhysics=function(){this.physics=new Phaser.Physics.Box2D.Body(e.Main.instance,null,this.group.x,this.group.y),this.physics.setRectangle(120,40,0,20),this.physics.setCollisionCategory(e.FilterGroups.CAR1),this.wheel1=e.GameManager.instance.layerBackground.create(this.group.x-31,this.group.y+47,"level6","thirdWheel2_mc instance 10000"),this.wheel1.anchor.set(.5),e.Main.instance.physics.box2d.enable(this.wheel1),this.wheel1.body.setCircle(16),this.wheel1.body.friction=3,this.wheel1.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel1.animations.add("normal",Phaser.Animation.generateFrameNames("thirdWheel2_mc instance 1",0,0,"",4),30,!1),this.wheel1.animations.add("ligthning",Phaser.Animation.generateFrameNames("thirdWheel2_mc instance 1",1,9,"",4),30,!0),this.wheel2=e.GameManager.instance.layerBackground.create(this.group.x+32,this.group.y+47,"level6","thirdWheel1_mc instance 10000"),this.wheel2.anchor.set(.5),e.Main.instance.physics.box2d.enable(this.wheel2),this.wheel2.body.setCircle(13),this.wheel2.body.friction=3,this.wheel2.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel2.animations.add("normal",Phaser.Animation.generateFrameNames("thirdWheel1_mc instance 1",0,0,"",4),30,!1),this.wheel2.animations.add("ligthning",Phaser.Animation.generateFrameNames("thirdWheel1_mc instance 1",1,9,"",4),30,!0);this.jointBack=e.Main.instance.physics.box2d.wheelJoint(this.physics,this.wheel1,-31,48,0,0,0,1,5,.3,0,4,!0),e.Main.instance.physics.box2d.revoluteJoint(this.physics,this.wheel2,32,48,0,0)},i.prototype.move=function(){this.wheel1.body.dynamic=!0,this.wheel2.body.static=!1,this.physics.dynamic=!0,this.jointBack.EnableMotor(!0),this.jointBack.SetMotorSpeed(7)},i.prototype.stopMove=function(){!1===this.goOut&&(this.jointBack.EnableMotor(!1),this.jointBack.SetMotorSpeed(0),this.wheel1.body.static=!0,this.wheel2.body.static=!0,this.physics.static=!0)},i.prototype.update=function(){t.prototype.update.call(this),this.group.x=this.physics.x,this.group.y=this.physics.y,this.group.angle=this.physics.angle,!0===this.ligthningNow&&(this.ligthningTimer+=1,this.ligthningTimer>=30&&(this.ligthningTimer=0,this.ligthningNow=!1,this.playNormal(),this.goOut=!0,this.move(),this.car3Eye.frameName="car3Eye instance 10055",this.physics.setRectangle(120,40,0,20),this.physics.setCollisionCategory(e.FilterGroups.CAR1),this.physics.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.wheel1.body.setCircle(16),this.wheel1.body.friction=3,this.wheel1.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel1.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.wheel2.body.setCircle(13),this.wheel2.body.friction=3,this.wheel2.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel2.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.move(),this.physics.collideWorldBounds=!1,this.wheel1.body.collideWorldBounds=!1,this.wheel2.body.collideWorldBounds=!1,e.GameManager.instance.level.car4.move(),e.GameManager.instance.level.swordAnim.stop())),!1===this.stopNow&&this.physics.x>590&&(this.stopNow=!0,this.stopMove(),this.playAnim("trying",-1),e.GameManager.instance.level.playAnim())},i.prototype.playLightning=function(){this.ligthningNow=!0,this.ligthning.visible=!0,this.ligthning.play("anim"),this.playAnim("lightning",-1),this.car3Eye.play("ligthning"),this.wheel1.play("ligthning"),this.wheel2.play("ligthning"),this.car3Part1.play("ligthning"),this.car3Part2.play("ligthning"),this.car3Part3.play("ligthning"),this.car3Part4.play("ligthning"),this.car3Part5.play("ligthning"),this.car3Part7.play("ligthning")},i.prototype.playNormal=function(){this.playAnim("normal",-1),this.ligthning.visible=!1,this.wheel1.play("normal"),this.wheel2.play("normal"),this.car3Part1.play("normal"),this.car3Part2.play("normal"),this.car3Part3.play("normal"),this.car3Part4.play("normal"),this.car3Part5.play("normal"),this.car3Part7.play("normal")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"lightning"===this.currAnim?11===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car3Part1,4,{x:-20,y:23,skX:25,skY:25}),e.GameManager.instance.level.setSimpleTween(this.car3Part2,4,{x:-38,y:20,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.car3Part3,4,{x:42,y:28,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.car3Part4,4,{x:30,y:24,skX:-45,skY:-45}),e.GameManager.instance.level.setSimpleTween(this.car3Part5,4,{x:17,y:30,skX:-86,skY:-86}),e.GameManager.instance.level.setSimpleTween(this.car3Eye,4,{y:-29,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.car3Part7,4,{x:-3,y:6,skX:0,skY:0})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car3Part1,2,{x:-19,y:21,skX:28,skY:28}),e.GameManager.instance.level.setSimpleTween(this.car3Part2,2,{y:18,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.car3Part3,2,{x:44,y:26,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.car3Part4,2,{y:22,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.car3Part5,2,{y:28,skX:-80,skY:-80}),e.GameManager.instance.level.setSimpleTween(this.car3Eye,2,{y:-30}),e.GameManager.instance.level.setSimpleTween(this.car3Part7,2,{y:5})):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car3Part1,2,{x:-20,y:23,skX:25,skY:25}),e.GameManager.instance.level.setSimpleTween(this.car3Part2,2,{y:20,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.car3Part3,2,{x:42,y:28,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.car3Part4,2,{y:24,skX:-45,skY:-45}),e.GameManager.instance.level.setSimpleTween(this.car3Part5,2,{y:30,skX:-86,skY:-86}),e.GameManager.instance.level.setSimpleTween(this.car3Eye,2,{y:-29}),e.GameManager.instance.level.setSimpleTween(this.car3Part7,2,{y:6})):19===this.counterAnim&&this.animComplete():"trying"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car3Part1,16,{x:-19,y:25,skX:36,skY:31,scX:1.02,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.car3Part2,16,{x:-39,y:22,skX:-5,skY:-4,scX:1.05,scY:.96}),e.GameManager.instance.level.setSimpleTween(this.car3Part3,16,{x:45,y:31,skX:3,skY:2,scX:1.05,scY:.96}),e.GameManager.instance.level.setSimpleTween(this.car3Part4,16,{x:32,y:26,skX:-39,skY:-34,scX:1.02,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.car3Part5,16,{y:32,skX:-78,skY:-76,scX:.96,scY:1.04}),e.GameManager.instance.level.setSimpleTween(this.car3Eye,16,{x:12,y:-21,scX:1.04,scY:.95}),e.GameManager.instance.level.setSimpleTween(this.car3Part7,16,{y:12,scX:1.05,scY:.92})):17===this.counterAnim?(this.setPart(this.car3Part1,{x:-19,y:25,angle:0,scX:1.02,scY:.99,skX:36,skY:31,alpha:1}),this.setPart(this.car3Part2,{x:-39,y:22,angle:0,scX:1.05,scY:.96,skX:-5,skY:-4,alpha:1}),this.setPart(this.car3Part3,{x:45,y:31,angle:0,scX:1.05,scY:.96,skX:3,skY:2,alpha:1}),this.setPart(this.car3Part4,{x:32,y:26,angle:0,scX:1.02,scY:.99,skX:-39,skY:-34,alpha:1}),this.setPart(this.car3Part5,{x:17,y:32,angle:0,scX:.96,scY:1.04,skX:-78,skY:-76,alpha:1}),this.setPart(this.car3Eye,{x:12,y:-21,angle:0,scX:1.04,scY:.95,skX:0,skY:0,alpha:1}),this.setPart(this.car3Part7,{x:-3,y:12,angle:0,scX:1.05,scY:.92,skX:0,skY:0,alpha:1})):27===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car3Part1,7,{x:-16,y:16,skX:43,skY:44,scX:1,scY:1.02}),e.GameManager.instance.level.setSimpleTween(this.car3Part2,7,{x:-36,y:12,skX:6,skY:6,scX:1,scY:1.02}),e.GameManager.instance.level.setSimpleTween(this.car3Part3,7,{x:44,y:23,skX:6,skY:6,scX:1,scY:1.02}),e.GameManager.instance.level.setSimpleTween(this.car3Part4,7,{x:31,y:18,skX:-32,skY:-33,scX:1.01,scY:1.01}),e.GameManager.instance.level.setSimpleTween(this.car3Part5,7,{x:16,y:22,skX:-66,skY:-66,scX:1.02,scY:1}),e.GameManager.instance.level.setSimpleTween(this.car3Eye,7,{y:-34,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.car3Part7,7,{y:2,scX:1,scY:1.02})):34===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car3Part1,4,{x:-20,y:23,skX:25,skY:25,scY:1}),e.GameManager.instance.level.setSimpleTween(this.car3Part2,4,{x:-38,y:20,skX:-11,skY:-11,scY:1}),e.GameManager.instance.level.setSimpleTween(this.car3Part3,4,{x:42,y:28,skX:-2,skY:-2,scY:1}),e.GameManager.instance.level.setSimpleTween(this.car3Part4,4,{x:30,y:24,skX:-45,skY:-45,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.car3Part5,4,{x:17,y:30,skX:-86,skY:-86,scX:1}),e.GameManager.instance.level.setSimpleTween(this.car3Eye,4,{x:11,y:-29}),e.GameManager.instance.level.setSimpleTween(this.car3Part7,4,{y:6,scY:1})):38===this.counterAnim?(this.setPart(this.car3Part1,{x:-20,y:23,angle:0,scX:1,scY:1,skX:25,skY:25,alpha:1}),this.setPart(this.car3Part2,{x:-38,y:20,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1}),this.setPart(this.car3Part3,{x:42,y:28,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.car3Part4,{x:30,y:24,angle:0,scX:1,scY:1,skX:-45,skY:-45,alpha:1}),this.setPart(this.car3Part5,{x:17,y:30,angle:0,scX:1,scY:1,skX:-86,skY:-86,alpha:1}),this.setPart(this.car3Eye,{x:11,y:-29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car3Part7,{x:-3,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):60===this.counterAnim&&this.animComplete():"normal"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car3Part1,9,{x:-18,y:19,skX:36,skY:36}),e.GameManager.instance.level.setSimpleTween(this.car3Part2,9,{x:-37,y:15,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.car3Part3,9,{x:44,y:25,skX:7,skY:7}),e.GameManager.instance.level.setSimpleTween(this.car3Part4,9,{x:31,y:20,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.car3Part5,9,{x:16,y:25,skX:-71,skY:-71}),e.GameManager.instance.level.setSimpleTween(this.car3Eye,9,{y:-32}),e.GameManager.instance.level.setSimpleTween(this.car3Part7,9,{y:4})):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car3Part1,5,{x:-20,y:23,skX:25,skY:25}),e.GameManager.instance.level.setSimpleTween(this.car3Part2,5,{x:-38,y:20,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.car3Part3,5,{x:42,y:28,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.car3Part4,5,{x:30,y:24,skX:-45,skY:-45}),e.GameManager.instance.level.setSimpleTween(this.car3Part5,5,{x:17,y:30,skX:-86,skY:-86}),e.GameManager.instance.level.setSimpleTween(this.car3Eye,5,{y:-29}),e.GameManager.instance.level.setSimpleTween(this.car3Part7,5,{y:6})):15===this.counterAnim?(this.setPart(this.car3Part1,{x:-20,y:23,angle:0,scX:1,scY:1,skX:25,skY:25,alpha:1}),this.setPart(this.car3Part2,{x:-38,y:20,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1}),this.setPart(this.car3Part3,{x:42,y:28,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.car3Part4,{x:30,y:24,angle:0,scX:1,scY:1,skX:-45,skY:-45,alpha:1}),this.setPart(this.car3Part5,{x:17,y:30,angle:0,scX:1,scY:1,skX:-86,skY:-86,alpha:1}),this.setPart(this.car3Eye,{x:11,y:-29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car3Part7,{x:-3,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):43===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"lightning"===e?(this.setPart(this.car3Part1,{x:-12,y:12,angle:0,scX:1,scY:1,skX:51,skY:51,alpha:1}),this.setPart(this.car3Part2,{x:-34,y:8,angle:0,scX:1,scY:1,skX:14,skY:14,alpha:1}),this.setPart(this.car3Part3,{x:51,y:18,angle:0,scX:1,scY:1,skX:31,skY:31,alpha:1}),this.setPart(this.car3Part4,{x:34,y:11,angle:0,scX:1,scY:1,skX:-17,skY:-17,alpha:1}),this.setPart(this.car3Part5,{x:16,y:18,angle:0,scX:1,scY:1,skX:-47,skY:-47,alpha:1}),this.setPart(this.car3Eye,{x:11,y:-36,angle:0,scX:1,scY:1,skX:1,skY:1,alpha:1}),this.setPart(this.car3Part7,{x:-2,y:-1,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1})):"trying"===e?(this.setPart(this.car3Part1,{x:-20,y:23,angle:0,scX:1,scY:1,skX:25,skY:25,alpha:1}),this.setPart(this.car3Part2,{x:-38,y:20,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1}),this.setPart(this.car3Part3,{x:42,y:28,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.car3Part4,{x:30,y:24,angle:0,scX:1,scY:1,skX:-45,skY:-45,alpha:1}),this.setPart(this.car3Part5,{x:17,y:30,angle:0,scX:1,scY:1,skX:-86,skY:-86,alpha:1}),this.setPart(this.car3Eye,{x:11,y:-29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car3Part7,{x:-3,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"normal"===e&&(this.setPart(this.car3Part1,{x:-20,y:23,angle:0,scX:1,scY:1,skX:25,skY:25,alpha:1}),this.setPart(this.car3Part2,{x:-38,y:20,angle:0,scX:1,scY:1,skX:-11,skY:-11,alpha:1}),this.setPart(this.car3Part3,{x:42,y:28,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.car3Part4,{x:30,y:24,angle:0,scX:1,scY:1,skX:-45,skY:-45,alpha:1}),this.setPart(this.car3Part5,{x:17,y:30,angle:0,scX:1,scY:1,skX:-86,skY:-86,alpha:1}),this.setPart(this.car3Eye,{x:11,y:-29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.car3Part7,{x:-3,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.car3Part7=null,this.car3Eye=null,this.car3Part5=null,this.car3Part4=null,this.car3Part3=null,this.car3Part2=null,this.car3Part1=null,this.physics=null,this.wheel1=null,this.wheel2=null,this.jointBack=null},i}(e.BasicSimpleAnim);e.Lvl6Car3=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.dreamCounter=0,s.haveSword=!1,s.goOut=!1,s.stopNow=!1,s.group=i.make.group(),s.group.x=226,s.group.y=473,e.GameManager.instance.layerBackground.addChild(s.group),s.car4Part6=new e.SASprite(i,0,0,"level6","car4Part6 instance 10000"),s.car4Part6.anchor.set(.5),s.group.addChild(s.car4Part6),s.car4Part5=new e.SASprite(i,0,0,"level6","car4Part5 instance 10000"),s.car4Part5.anchor.set(.5),s.group.addChild(s.car4Part5),s.car4Part4=new e.SASprite(i,0,0,"level6","car4Part4 instance 10000"),s.car4Part4.anchor.set(.5),s.group.addChild(s.car4Part4),s.car4Part3=new e.SASprite(i,0,0,"level6","car4Part3 instance 10000"),s.car4Part3.anchor.set(.5),s.group.addChild(s.car4Part3),s.car4Part2=new e.SASprite(i,0,0,"level6","car4Part2 instance 10000"),s.car4Part2.anchor.set(.5),s.group.addChild(s.car4Part2),s.car4Eye=new e.SASprite(i,0,0,"level6","car4Eye instance 10000"),s.car4Eye.animations.add("normal",Phaser.Animation.generateFrameNames("car4Eye instance 1",0,46,"",4),30,!0),s.car4Eye.animations.add("dream",Phaser.Animation.generateFrameNames("car4Eye instance 1",47,88,"",4),30,!1),s.car4Eye.animations.add("happy",Phaser.Animation.generateFrameNames("car4Eye instance 1",89,113,"",4),30,!1),s.car4Eye.anchor.set(.5),s.car4Eye.play("normal"),s.group.addChild(s.car4Eye),s.car4Part1=new e.SASprite(i,0,0,"level6","car4Part1 instance 10000"),s.car4Part1.anchor.set(.5),s.group.addChild(s.car4Part1),s.car4Sword=new e.SASprite(i,0,0,"level6","car4Sword instance 10002"),s.car4Sword.anchor.set(.5),s.group.addChild(s.car4Sword),s.playAnim("normal",-1),s.addPhysics(),s.addSword(),s}return __extends(i,t),i.prototype.addPhysics=function(){this.physics=new Phaser.Physics.Box2D.Body(e.Main.instance,null,this.group.x,this.group.y),this.physics.setRectangle(133,40,0,0),this.physics.setCollisionCategory(e.FilterGroups.CAR1),this.wheel1=e.GameManager.instance.layerBackground.create(this.group.x-28,this.group.y+39,"level6","fourWheel2_mc instance 10000"),this.wheel1.anchor.set(.5),e.Main.instance.physics.box2d.enable(this.wheel1),this.wheel1.body.setCircle(21),this.wheel1.body.friction=3,this.wheel1.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel2=e.GameManager.instance.layerBackground.create(this.group.x+40,this.group.y+39,"level6","fourWheel1_mc instance 10000"),this.wheel2.anchor.set(.5),e.Main.instance.physics.box2d.enable(this.wheel2),this.wheel2.body.setCircle(14),this.wheel2.body.friction=3,this.wheel2.body.setCollisionCategory(e.FilterGroups.CAR1);this.jointBack=e.Main.instance.physics.box2d.wheelJoint(this.physics,this.wheel1,-35,30,0,0,0,1,5,.3,0,4,!0),e.Main.instance.physics.box2d.revoluteJoint(this.physics,this.wheel2,32,30,0,0)},i.prototype.addSword=function(){this.sword=e.GameManager.instance.layerElements.create(58,311,"level6","car4Sword instance 10000"),this.sword.anchor.set(.5),this.sword.inputEnabled=!0,this.sword.input.useHandCursor=!0,this.sword.events.onInputOver.add(this.over,this),this.sword.events.onInputOut.add(this.out,this),this.sword.events.onInputDown.add(this.down,this),e.Main.instance.physics.box2d.enable(this.sword),this.sword.body.setRectangle(15,105,0,0),this.sword.body.addCircle(5,0,55),this.sword.body.static=!0,this.sword.body.data.SetUserData("DragBody"),this.sword.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR)},i.prototype.over=function(){this.sword.frameName="car4Sword instance 10001"},i.prototype.out=function(){this.sword.frameName="car4Sword instance 10000"},i.prototype.down=function(){this.sword.body.dynamic=!0,e.GameManager.instance.level.mouseDragStart()},i.prototype.move=function(){this.wheel1.body.dynamic=!0,this.wheel2.body.static=!1,this.physics.dynamic=!0,this.jointBack.EnableMotor(!0),this.jointBack.SetMotorSpeed(7)},i.prototype.stopMove=function(){!1===this.goOut&&(this.jointBack.EnableMotor(!1),this.jointBack.SetMotorSpeed(0),this.wheel1.body.static=!0,this.wheel2.body.static=!0,this.physics.static=!0)},i.prototype.update=function(){t.prototype.update.call(this),this.group.x=this.physics.x,this.group.y=this.physics.y,this.group.angle=this.physics.angle,!1===this.haveSword&&Phaser.Math.distance(this.group.x,this.group.y,this.sword.x,this.sword.y)<50&&(e.GameManager.instance.level.mouseDragEnd(),this.haveSword=!0,this.sword.body.data.SetActive(!1),this.sword.visible=!1,this.car4Sword.visible=!0,this.playAnim("happy",-1),this.car4Eye.play("happy"),e.SoundManager.playSFX("s_lvl6_rubeGladness"),this.goOut=!0,null!=this.dream&&(this.dream.visible=!1),this.physics.setRectangle(133,40,0,0),this.physics.setCollisionCategory(e.FilterGroups.CAR1),this.physics.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.wheel1.body.setCircle(21),this.wheel1.body.friction=3,this.wheel1.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel1.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.wheel2.body.setCircle(14),this.wheel2.body.friction=3,this.wheel2.body.setCollisionCategory(e.FilterGroups.CAR1),this.wheel2.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),this.move(),this.physics.collideWorldBounds=!1,this.wheel1.body.collideWorldBounds=!1,this.wheel2.body.collideWorldBounds=!1,e.GameManager.instance.level.swordAnim.stop()),!1===this.haveSword&&!1===this.stopNow&&this.physics.x>590&&(this.stopNow=!0,this.stopMove(),this.playAnim("trying",-1),e.GameManager.instance.level.playAnim()),this.dreamCounter+=1,150===this.dreamCounter&&(this.dreamCounter=0,this.dreamNow())},i.prototype.dreamNow=function(){!1===this.haveSword&&(this.car4Eye.play("dream"),null==this.dream&&(this.dream=this.group.create(30,-40,"level6","swordBubble instance 10000"),this.dream.anchor.set(0,1)),e.Main.instance.add.tween(this.dream.scale).to({x:1,y:1},400,"Linear",!0).onComplete.add(function(){e.Main.instance.add.tween(this.dream.scale).to({x:0,y:0},200,"Linear",!0,1500).onComplete.add(function(){this.car4Eye.play("normal")},this)},this))},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"normal"===this.currAnim?35===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,10,{x:44,y:-17,skX:3,skY:3},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,10,{x:19,y:-41,scY:1.07},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,10,{x:66,y:-3},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,10,{y:-33,scY:1.09},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,10,{y:-18,scY:1.04},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,10,{y:-27,scY:1.08},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,10,{y:22,scY:1.02},!0)):45===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,3,{x:43,y:-10,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,3,{x:18,y:-33,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,3,{x:65,y:2},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,3,{y:-24,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,3,{y:-10,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,3,{y:-19,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,3,{y:24,scY:1},!0)):48===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,2,{x:44,y:-12,skX:2,skY:2},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,2,{y:-35,scY:1.04},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,2,{x:66,y:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,2,{y:-27,scY:1.05},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,2,{y:-13,scY:1.02},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,2,{y:-21,scY:1.04},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,2,{y:23,scY:1.01},!0)):50===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,2,{x:43,y:-10,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,2,{y:-33,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,2,{x:65,y:2},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,2,{y:-24,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,2,{y:-10,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,2,{y:-19,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,2,{y:24,scY:1},!0)):52===this.counterAnim?(this.setPart(this.car4Part1,{x:43,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Eye,{x:18,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part2,{x:65,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part3,{x:-23,y:-24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part4,{x:-3,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part5,{x:0,y:-19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part6,{x:-1,y:24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0)):96===this.counterAnim&&this.animComplete():"trying"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,30,{x:45,y:-3,skX:10,skY:10},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,30,{y:-26,skX:-6,skY:-6},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,30,{x:67,y:12},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,30,{x:-25,y:-19,scX:1.07,scY:.95},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,30,{y:-5,scX:1.07,scY:.95},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,30,{y:-14,scX:1.07,scY:.96},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,30,{x:0,y:27,scX:1.07},!0)):31===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,5,{x:42,y:-16,skX:-9,skY:-9},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,5,{y:-36,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,5,{x:78,y:-16,skX:-62,skY:-62},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,5,{x:-23,y:-29,scX:1,scY:1.03},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,5,{y:-16,scX:1,scY:1.04},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,5,{y:-26,scX:1,scY:1.15},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,5,{x:-1,y:21,scX:1},!0)):36===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,8,{x:43,y:-10,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,8,{y:-33},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,4,{x:77,y:-10,skX:-46,skY:-46},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,8,{y:-24,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,8,{y:-10,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,8,{y:-19,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,8,{y:24},!0)):40===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.car4Part2,4,{x:60,y:2,skX:27,skY:27},!0):44===this.counterAnim?(this.setPart(this.car4Part1,{x:43,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Eye,{x:18,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,4,{x:65,skX:0,skY:0},!0),this.setPart(this.car4Part3,{x:-23,y:-24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part4,{x:-3,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part5,{x:0,y:-19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part6,{x:-1,y:24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0)):48===this.counterAnim?this.setPart(this.car4Part2,{x:65,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0):50===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,15,{x:44,y:-14,scY:1.05},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,15,{y:-39,scY:1.05},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,15,{x:66,y:-2,scY:1.05},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,15,{x:-22,y:-29,scY:1.05},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,15,{x:-2,y:-15,scY:1.05},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,15,{x:1,y:-23,scY:1.05},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,15,{x:0,y:21,scY:1.05},!0)):65===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,7,{x:43,y:-10,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,7,{y:-33,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,7,{x:65,y:2,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,7,{x:-23,y:-24,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,7,{x:-3,y:-10,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,7,{x:0,y:-19,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,7,{x:-1,y:24,scY:1},!0)):72===this.counterAnim&&this.animComplete():"happy"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Sword,12,{x:2,y:-38,skX:-172,skY:-172},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part1,6,{x:40,y:-8,skX:-11,skY:-8,scX:1.01,scY:.99},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,6,{x:15,y:-28,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,6,{x:62,y:1,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,6,{x:-27,y:-21,skX:-2,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,6,{x:-5,y:-6,skX:-2,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,6,{x:-3,y:-15,skX:-2,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,6,{x:-2,y:28,skX:-2},!0)):14===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,6,{x:43,y:-10,skX:0,skY:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,6,{x:18,y:-33,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,6,{x:65,y:2,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,6,{x:-23,y:-24,skX:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,6,{x:-3,y:-10,skX:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,6,{x:0,y:-19,skX:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,6,{x:-1,y:24,skX:0},!0)):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Sword,12,{x:-28,y:-27,skX:143,skY:143},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part1,6,{x:44,y:-8,skX:-7,skY:-8,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,6,{x:19,y:-29,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,6,{y:1,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,6,{y:-21,skX:2,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,6,{x:-2,y:-6,skX:2,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,6,{x:1,y:-15,skX:2,scX:1.02,scY:.98},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,6,{y:28,skX:2},!0)):38===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.car4Part1,6,{x:43,y:-10,skX:0,skY:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Eye,6,{x:18,y:-33,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part2,6,{y:2,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part3,6,{y:-24,skX:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part4,6,{x:-3,y:-10,skX:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part5,6,{x:0,y:-19,skX:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.car4Part6,6,{y:24,skX:0},!0)):50===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"normal"===e?(this.car4Sword.visible=!1,this.setPart(this.car4Part1,{x:43,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Eye,{x:18,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part2,{x:65,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part3,{x:-23,y:-24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part4,{x:-3,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part5,{x:0,y:-19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part6,{x:-1,y:24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0)):"trying"===e?(this.car4Sword.visible=!1,this.setPart(this.car4Part1,{x:43,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Eye,{x:18,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part2,{x:65,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part3,{x:-23,y:-24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part4,{x:-3,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part5,{x:0,y:-19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part6,{x:-1,y:24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0)):"happy"===e&&(this.car4Sword.visible=!0,this.setPart(this.car4Sword,{x:-28,y:-27,angle:0,scX:1,scY:1,skX:143,skY:143,alpha:1},!0),this.setPart(this.car4Part1,{x:43,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Eye,{x:18,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part2,{x:65,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part3,{x:-23,y:-24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part4,{x:-3,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part5,{x:0,y:-19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.car4Part6,{x:-1,y:24,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0))},i.prototype.free=function(){this.group=null,this.car4Part6=null,this.car4Part6=null,this.car4Part5=null,this.car4Part4=null,this.car4Part3=null,this.car4Part2=null,this.car4Eye=null,this.car4Part1=null,this.physics=null,this.wheel1=null,this.wheel2=null,this.jointBack=null},i}(e.BasicSimpleAnim);e.Lvl6Car4=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=e.GameManager.instance.hero.bodyBase.x,s.group.y=e.GameManager.instance.hero.bodyBase.y+18,e.GameManager.instance.layerBackground.addChild(s.group),s.chickPart8=new e.SASprite(i,0,0,"level6","chick7 instance 10000"),s.chickPart8.anchor.set(.5),s.group.addChild(s.chickPart8),s.chickPart7=new e.SASprite(i,0,0,"level6","chick7 instance 10000"),s.chickPart7.anchor.set(.5),s.group.addChild(s.chickPart7),s.chickPart6=new e.SASprite(i,0,0,"level6","chick6 instance 10000"),s.chickPart6.anchor.set(.5),s.group.addChild(s.chickPart6),s.chickPart5=new e.SASprite(i,0,0,"level6","chick5 instance 10000"),s.chickPart5.anchor.set(.5),s.group.addChild(s.chickPart5),s.chickPart4=new e.SASprite(i,0,0,"level6","chick4 instance 10000"),s.chickPart4.anchor.set(.5),s.group.addChild(s.chickPart4),s.chickPart3=new e.SASprite(i,0,0,"level6","chick3 instance 10000"),s.chickPart3.anchor.set(.5),s.group.addChild(s.chickPart3),s.chickPart2=new e.SASprite(i,0,0,"level6","chick2 instance 10000"),s.chickPart2.anchor.set(.5),s.group.addChild(s.chickPart2),s.chickPart1=new e.SASprite(i,0,0,"level6","chick1 instance 10000"),s.chickPart1.pivot.set(2,20),s.group.addChild(s.chickPart1),s.magic=e.GameManager.instance.layerUpper.create(s.group.x,s.group.y,"level6","magicAnim2 instance 10000"),s.magic.anchor.set(.5),s.magic.animations.add("anim",Phaser.Animation.generateFrameNames("magicAnim2 instance 1",0,21,"",4),30,!1),s.magic.play("anim"),s.playAnim("play"),e.GameManager.instance.level.gameOver=!0,e.SoundManager.playSFX("s_lvl6_wheelyHexed"),e.SoundManager.playSFX("s_lvl6_checken"),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"play"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.chickPart1,7,{x:9,y:-9,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.chickPart2,7,{x:15,y:3,skX:-19,skY:-19,scY:1.07}),e.GameManager.instance.level.setSimpleTween(this.chickPart3,7,{x:12,y:-12,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.chickPart4,7,{x:-6,y:4,skX:57,skY:57}),e.GameManager.instance.level.setSimpleTween(this.chickPart5,7,{y:2,scY:.88}),e.GameManager.instance.level.setSimpleTween(this.chickPart6,7,{y:9}),e.GameManager.instance.level.setSimpleTween(this.chickPart7,7,{x:1,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.chickPart8,7,{x:-8,skX:23,skY:23})):8===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.chickPart1,8,{x:5,y:-46,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.chickPart2,8,{x:10,y:-34,skX:16,skY:16,scX:.9,scY:1.22}),e.GameManager.instance.level.setSimpleTween(this.chickPart3,8,{x:8,y:-50,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.chickPart4,8,{x:-1,y:-24,skX:-16,skY:-25,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.chickPart5,8,{x:-19,y:-30,skX:-28,skY:-28,scY:.97}),e.GameManager.instance.level.setSimpleTween(this.chickPart6,8,{x:-3,y:-25,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.chickPart7,8,{x:2,y:-13,skX:9,skY:9}),e.GameManager.instance.level.setSimpleTween(this.chickPart8,8,{x:-4,y:-13,skX:14,skY:14})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.chickPart1,10,{x:6,y:-33,skX:6,skY:6}),e.GameManager.instance.level.setSimpleTween(this.chickPart2,10,{x:13,y:-23,skX:-16,skY:-16,scX:1.03,scY:1.06}),e.GameManager.instance.level.setSimpleTween(this.chickPart3,10,{x:9,y:-37,skX:6,skY:6}),e.GameManager.instance.level.setSimpleTween(this.chickPart4,10,{x:-7,y:-23,skX:87,skY:87,scX:.99}),e.GameManager.instance.level.setSimpleTween(this.chickPart5,10,{x:-16,y:-31,skX:29,skY:29}),e.GameManager.instance.level.setSimpleTween(this.chickPart6,10,{x:-6,y:-17,skX:19,skY:19}),e.GameManager.instance.level.setSimpleTween(this.chickPart7,10,{x:-3,y:-5,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.chickPart8,10,{x:-13,y:-7,skX:42,skY:42})):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.chickPart1,8,{y:-9}),e.GameManager.instance.level.setSimpleTween(this.chickPart2,8,{y:2}),e.GameManager.instance.level.setSimpleTween(this.chickPart3,8,{y:-13}),e.GameManager.instance.level.setSimpleTween(this.chickPart4,8,{y:1}),e.GameManager.instance.level.setSimpleTween(this.chickPart5,8,{y:-6}),e.GameManager.instance.level.setSimpleTween(this.chickPart6,8,{y:7}),e.GameManager.instance.level.setSimpleTween(this.chickPart7,8,{y:20}),e.GameManager.instance.level.setSimpleTween(this.chickPart8,8,{y:18})):34===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.chickPart1,3,{y:-3,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.chickPart2,3,{x:15,y:6,skX:-62,skY:-62}),e.GameManager.instance.level.setSimpleTween(this.chickPart3,3,{y:-7,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.chickPart4,3,{x:-5,y:6,skX:103,skY:103}),e.GameManager.instance.level.setSimpleTween(this.chickPart5,3,{x:-17,y:1,skX:31,skY:31}),e.GameManager.instance.level.setSimpleTween(this.chickPart6,3,{y:13,skX:16,skY:16,scY:.87}),e.GameManager.instance.level.setSimpleTween(this.chickPart7,3,{x:1,y:22,skX:-71,skY:-71}),e.GameManager.instance.level.setSimpleTween(this.chickPart8,3,{y:20,skX:89,skY:89})):37===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.chickPart1,5,{x:4,y:-12,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.chickPart2,5,{x:11,y:-2,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.chickPart3,5,{x:7,y:-17,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.chickPart4,5,{x:-3,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.chickPart5,5,{y:-1,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.chickPart6,5,{x:-4,y:6,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.chickPart7,5,{x:-1,y:19,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.chickPart8,5,{x:-5,y:19,skX:0,skY:0})):42===this.counterAnim?(this.setPart(this.chickPart1,{x:4,y:-12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart2,{x:11,y:-2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart3,{x:7,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart4,{x:-3,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart5,{x:-17,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart6,{x:-4,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart7,{x:-1,y:19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart8,{x:-5,y:19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):51===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.chickPart1,3,{x:10,y:-8,skX:29,skY:29}),e.GameManager.instance.level.setSimpleTween(this.chickPart2,3,{x:12,y:6,skX:9,skY:9}),e.GameManager.instance.level.setSimpleTween(this.chickPart3,3,{x:14,y:-10,skX:25,skY:29}),e.GameManager.instance.level.setSimpleTween(this.chickPart4,3,{x:-6,y:4,skX:41,skY:41}),e.GameManager.instance.level.setSimpleTween(this.chickPart5,3,{x:-13,y:-7,skX:29,skY:29}),e.GameManager.instance.level.setSimpleTween(this.chickPart6,3,{x:-5,y:5,skX:29,skY:29}),e.GameManager.instance.level.setSimpleTween(this.chickPart7,3,{x:2,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.chickPart8,3,{x:-7,y:18,skX:15,skY:15})):54===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.chickPart1,13,{y:-6,scY:.67}),e.GameManager.instance.level.setSimpleTween(this.chickPart2,13,{y:8}),e.GameManager.instance.level.setSimpleTween(this.chickPart3,13,{y:-8}),e.GameManager.instance.level.setSimpleTween(this.chickPart4,3,{x:-5,y:0,skX:85,skY:85}),e.GameManager.instance.level.setSimpleTween(this.chickPart5,13,{y:-5}),e.GameManager.instance.level.setSimpleTween(this.chickPart6,13,{y:7})):57===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.chickPart4,3,{x:-6,y:5,skX:41,skY:41}):60===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.chickPart4,3,{x:-5,y:1,skX:86,skY:86}):63===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.chickPart4,4,{x:-6,y:6,skX:41,skY:41}):67===this.counterAnim?(this.setPart(this.chickPart1,{x:10,y:-6,angle:0,scX:1,scY:.67,skX:29,skY:29,alpha:1}),this.setPart(this.chickPart2,{x:12,y:8,angle:0,scX:1,scY:1,skX:9,skY:9,alpha:1}),this.setPart(this.chickPart3,{x:14,y:-8,angle:0,scX:1,scY:1,skX:25,skY:29,alpha:1}),this.setPart(this.chickPart4,{x:-6,y:6,angle:0,scX:1,scY:1,skX:41,skY:41,alpha:1}),this.setPart(this.chickPart5,{x:-13,y:-5,angle:0,scX:1,scY:1,skX:29,skY:29,alpha:1}),this.setPart(this.chickPart6,{x:-5,y:7,angle:0,scX:1,scY:1,skX:29,skY:29,alpha:1}),this.setPart(this.chickPart7,{x:2,y:19,angle:0,scX:1,scY:1,skX:-21,skY:-21,alpha:1}),this.setPart(this.chickPart8,{x:-7,y:18,angle:0,scX:1,scY:1,skX:15,skY:15,alpha:1})):88===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.chickPart1,6,{x:4,y:-12,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.chickPart2,6,{x:11,y:-2,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.chickPart3,6,{x:7,y:-17,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.chickPart4,6,{x:-3,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.chickPart5,6,{x:-17,y:-1,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.chickPart6,6,{x:-4,y:6,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.chickPart7,6,{x:-1,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.chickPart8,6,{x:-5,y:19,skX:0,skY:0})):94===this.counterAnim?(this.setPart(this.chickPart1,{x:4,y:-12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart2,{x:11,y:-2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart3,{x:7,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart4,{x:-3,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart5,{x:-17,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart6,{x:-4,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart7,{x:-1,y:19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart8,{x:-5,y:19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):107===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"play"===e&&(this.setPart(this.chickPart1,{x:4,y:-12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart2,{x:11,y:-2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart3,{x:7,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart4,{x:-3,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart5,{x:-17,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart6,{x:-4,y:6,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart7,{x:-1,y:19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.chickPart8,{x:-5,y:19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.chickPart8=null,this.chickPart7=null,this.chickPart6=null,this.chickPart5=null,this.chickPart4=null,this.chickPart3=null,this.chickPart2=null,this.chickPart1=null,this.magic=null},i}(e.BasicSimpleAnim);e.Lvl6Chicken=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;s.downNow=!1,s.directionMove=0,s.timer=0,s.group=i.make.group(),s.group.x=575,s.group.y=221,e.GameManager.instance.layerBackground0.addChild(s.group),s.flags=new e.SASprite(i,0,0,"level6","flags instance 10000"),s.flags.pivot.set(179,127),s.group.addChild(s.flags),s.flags.inputEnabled=!0,s.flags.input.useHandCursor=!0,s.flags.events.onInputOver.add(s.over,s),s.flags.events.onInputOut.add(s.out,s),s.flags.events.onInputDown.add(s.down,s),s.flags.events.onInputUp.add(s.up,s),s.setParts("anim"),s.currAnim="anim",e.GameManager.instance.level.addQuestCar(355,110,s.flags,0,90);var a=new Phaser.Graphics(i,215,-20);return a.beginFill(0,0),a.drawRect(-50,-50,100,100),a.endFill(),a.inputEnabled=!0,s.group.addChild(a),s}return __extends(i,t),i.prototype.move=function(){!0===this.downNow&&(this.directionMove=1)},i.prototype.over=function(){this.flags.frameName="flags instance 10001"},i.prototype.out=function(){this.flags.frameName="flags instance 10000"},i.prototype.down=function(){this.point=new Phaser.Point(e.Main.instance.input.activePointer.x,e.Main.instance.input.activePointer.y),this.downNow=!0},i.prototype.up=function(){this.downNow=!1,this.directionMove=0,this.timer=0},i.prototype.update=function(){t.prototype.update.call(this),!0===this.downNow&&(this.point.x!==e.Main.instance.input.activePointer.x&&this.point.y!==e.Main.instance.input.activePointer.y&&(e.Main.instance.input.activePointer.x<this.point.x?this.directionMove=1:this.directionMove=-1,this.updateFlags(this.directionMove)),this.point=new Phaser.Point(e.Main.instance.input.activePointer.x,e.Main.instance.input.activePointer.y))},i.prototype.updateFlags=function(e){this.counterAnim+=e,this.counterAnim<1?this.counterAnim=1:this.counterAnim>33&&(this.counterAnim=33),"anim"===this.currAnim&&(1===this.counterAnim?this.setPart(this.flags,{x:31,y:5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):2===this.counterAnim?this.setPart(this.flags,{x:25,y:5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}):3===this.counterAnim?this.setPart(this.flags,{x:19,y:5,angle:0,scX:1,scY:1,skX:1,skY:1,alpha:1}):4===this.counterAnim?this.setPart(this.flags,{x:12,y:5,angle:0,scX:1,scY:1,skX:1,skY:1,alpha:1}):5===this.counterAnim?this.setPart(this.flags,{x:6,y:5,angle:0,scX:1,scY:1,skX:2,skY:2,alpha:1}):6===this.counterAnim?this.setPart(this.flags,{x:-1,y:5,angle:0,scX:1,scY:1,skX:2,skY:2,alpha:1}):7===this.counterAnim?this.setPart(this.flags,{x:-7,y:5,angle:0,scX:1,scY:1,skX:2,skY:2,alpha:1}):8===this.counterAnim?this.setPart(this.flags,{x:-14,y:4,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}):9===this.counterAnim?this.setPart(this.flags,{x:-20,y:4,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}):10===this.counterAnim?this.setPart(this.flags,{x:-27,y:4,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}):11===this.counterAnim?this.setPart(this.flags,{x:-33,y:4,angle:0,scX:1,scY:1,skX:4,skY:4,alpha:1}):12===this.counterAnim?this.setPart(this.flags,{x:-40,y:4,angle:0,scX:1,scY:1,skX:4,skY:4,alpha:1}):13===this.counterAnim?this.setPart(this.flags,{x:-46,y:4,angle:0,scX:1,scY:1,skX:5,skY:5,alpha:1}):14===this.counterAnim?this.setPart(this.flags,{x:-53,y:4,angle:0,scX:1,scY:1,skX:5,skY:5,alpha:1}):15===this.counterAnim?this.setPart(this.flags,{x:-59,y:4,angle:0,scX:1,scY:1,skX:5,skY:5,alpha:1}):16===this.counterAnim?this.setPart(this.flags,{x:-66,y:4,angle:0,scX:1,scY:1,skX:6,skY:6,alpha:1}):17===this.counterAnim?this.setPart(this.flags,{x:-72,y:3,angle:0,scX:1,scY:1,skX:6,skY:6,alpha:1}):18===this.counterAnim?this.setPart(this.flags,{x:-78,y:3,angle:0,scX:1,scY:1,skX:6,skY:6,alpha:1}):19===this.counterAnim?this.setPart(this.flags,{x:-85,y:3,angle:0,scX:1,scY:1,skX:7,skY:7,alpha:1}):20===this.counterAnim?this.setPart(this.flags,{x:-91,y:3,angle:0,scX:1,scY:1,skX:7,skY:7,alpha:1}):21===this.counterAnim?this.setPart(this.flags,{x:-98,y:3,angle:0,scX:1,scY:1,skX:8,skY:8,alpha:1}):22===this.counterAnim?this.setPart(this.flags,{x:-104,y:3,angle:0,scX:1,scY:1,skX:8,skY:8,alpha:1}):23===this.counterAnim?this.setPart(this.flags,{x:-111,y:3,angle:0,scX:1,scY:1,skX:8,skY:8,alpha:1}):24===this.counterAnim?this.setPart(this.flags,{x:-117,y:3,angle:0,scX:1,scY:1,skX:9,skY:9,alpha:1}):25===this.counterAnim?this.setPart(this.flags,{x:-124,y:3,angle:0,scX:1,scY:1,skX:9,skY:9,alpha:1}):26===this.counterAnim?this.setPart(this.flags,{x:-130,y:2,angle:0,scX:1,scY:1,skX:10,skY:10,alpha:1}):27===this.counterAnim?this.setPart(this.flags,{x:-137,y:2,angle:0,scX:1,scY:1,skX:10,skY:10,alpha:1}):28===this.counterAnim?this.setPart(this.flags,{x:-143,y:2,angle:0,scX:1,scY:1,skX:10,skY:10,alpha:1}):29===this.counterAnim?this.setPart(this.flags,{x:-150,y:2,angle:0,scX:1,scY:1,skX:11,skY:11,alpha:1}):30===this.counterAnim?this.setPart(this.flags,{x:-156,y:2,angle:0,scX:1,scY:1,skX:11,skY:11,alpha:1}):31===this.counterAnim?this.setPart(this.flags,{x:-163,y:2,angle:0,scX:1,scY:1,skX:11,skY:11,alpha:1}):32===this.counterAnim?this.setPart(this.flags,{x:-169,y:2,angle:0,scX:1,scY:1,skX:12,skY:12,alpha:1}):33===this.counterAnim&&this.animComplete())},i.prototype.setParts=function(e){"anim"===e&&this.setPart(this.flags,{x:31,y:5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})},i.prototype.free=function(){this.group=null,this.flags=null},i}(e.BasicSimpleAnim);e.Lvl6Flags=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=345,s.group.y=85,e.GameManager.instance.layerBackground0.addChild(s.group),s.fly2=new e.SASprite(i,0,0,"level6","fly2 instance 10000"),s.fly2.anchor.set(.5),s.group.addChild(s.fly2),s.fly1=new e.SASprite(i,0,0,"level6","fly1 instance 10000"),s.fly1.anchor.set(.5),s.group.addChild(s.fly1),s}return __extends(i,t),i.prototype.fly=function(){this.playAnim("fly")},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"fly"===this.currAnim&&(1===this.counterAnim?this.setPart(this.fly1,{x:-9,y:3,angle:0,scX:.55,scY:.55,skX:0,skY:0,alpha:1}):2===this.counterAnim?this.setPart(this.fly1,{x:-1,y:1,angle:0,scX:.61,scY:.61,skX:1,skY:1,alpha:1}):3===this.counterAnim?this.setPart(this.fly1,{x:6,y:-1,angle:0,scX:.66,scY:.66,skX:2,skY:2,alpha:1}):4===this.counterAnim?this.setPart(this.fly1,{x:14,y:-2,angle:0,scX:.72,scY:.72,skX:3,skY:3,alpha:1}):5===this.counterAnim?this.setPart(this.fly1,{x:22,y:-4,angle:0,scX:.78,scY:.78,skX:4,skY:4,alpha:1}):6===this.counterAnim?this.setPart(this.fly1,{x:30,y:-5,angle:0,scX:.83,scY:.83,skX:4,skY:4,alpha:1}):7===this.counterAnim?this.setPart(this.fly1,{x:37,y:-7,angle:0,scX:.89,scY:.89,skX:5,skY:5,alpha:1}):8===this.counterAnim?this.setPart(this.fly1,{x:45,y:-8,angle:0,scX:.94,scY:.94,skX:6,skY:6,alpha:1}):9===this.counterAnim?this.setPart(this.fly1,{x:53,y:-9,angle:0,scX:1,scY:1,skX:7,skY:7,alpha:1}):10===this.counterAnim?this.setPart(this.fly1,{x:61,y:-10,angle:0,scX:1,scY:1,skX:8,skY:8,alpha:1}):11===this.counterAnim?this.setPart(this.fly1,{x:69,y:-11,angle:0,scX:1,scY:1,skX:9,skY:9,alpha:1}):12===this.counterAnim?this.setPart(this.fly1,{x:77,y:-12,angle:0,scX:1,scY:1,skX:10,skY:10,alpha:1}):13===this.counterAnim?this.setPart(this.fly1,{x:85,y:-13,angle:0,scX:1,scY:1,skX:11,skY:11,alpha:1}):14===this.counterAnim?this.setPart(this.fly1,{x:93,y:-13,angle:0,scX:1,scY:1,skX:12,skY:12,alpha:1}):15===this.counterAnim?this.setPart(this.fly1,{x:101,y:-13,angle:0,scX:1,scY:1,skX:12,skY:12,alpha:1}):16===this.counterAnim?(this.setPart(this.fly1,{x:109,y:-14,angle:0,scX:1,scY:1,skX:13,skY:13,alpha:1}),this.fly2.visible=!0,this.setPart(this.fly2,{x:80,y:-12,angle:0,scX:.56,scY:1,skX:-4,skY:-4,alpha:0}),this.setPart(this.fly2,{x:80,y:-12,angle:0,scX:.56,scY:1,skX:-4,skY:-4,alpha:0})):17===this.counterAnim?(this.setPart(this.fly1,{x:117,y:-14,angle:0,scX:1,scY:1,skX:14,skY:14,alpha:1}),this.setPart(this.fly2,{x:88,y:-13,angle:0,scX:.57,scY:1,skX:-3,skY:-3,alpha:.03})):18===this.counterAnim?(this.setPart(this.fly1,{x:125,y:-14,angle:0,scX:1,scY:1,skX:15,skY:15,alpha:1}),this.setPart(this.fly2,{x:96,y:-13,angle:0,scX:.58,scY:1,skX:-1,skY:-1,alpha:.05})):19===this.counterAnim?(this.setPart(this.fly1,{x:133,y:-13,angle:0,scX:1,scY:1,skX:16,skY:16,alpha:1}),this.setPart(this.fly2,{x:104,y:-14,angle:0,scX:.59,scY:1,skX:0,skY:0,alpha:.08})):20===this.counterAnim?(this.setPart(this.fly1,{x:142,y:-13,angle:0,scX:1,scY:1,skX:17,skY:17,alpha:1}),this.setPart(this.fly2,{x:112,y:-14,angle:0,scX:.6,scY:1,skX:2,skY:2,alpha:.11})):21===this.counterAnim?(this.setPart(this.fly1,{x:150,y:-12,angle:0,scX:1,scY:1,skX:18,skY:18,alpha:1}),this.setPart(this.fly2,{x:120,y:-14,angle:0,scX:.62,scY:1,skX:3,skY:3,alpha:.14})):22===this.counterAnim?(this.setPart(this.fly1,{x:158,y:-11,angle:0,scX:1,scY:1,skX:19,skY:19,alpha:1}),this.setPart(this.fly2,{x:129,y:-13,angle:0,scX:.63,scY:1,skX:5,skY:5,alpha:.16})):23===this.counterAnim?(this.setPart(this.fly1,{x:166,y:-10,angle:0,scX:1,scY:1,skX:20,skY:20,alpha:1}),this.setPart(this.fly2,{x:137,y:-13,angle:0,scX:.64,scY:1,skX:6,skY:6,alpha:.19})):24===this.counterAnim?(this.setPart(this.fly1,{x:174,y:-9,angle:0,scX:1,scY:1,skX:21,skY:21,alpha:1}),this.setPart(this.fly2,{x:145,y:-13,angle:0,scX:.65,scY:1,skX:8,skY:8,alpha:.21})):25===this.counterAnim?(this.setPart(this.fly1,{x:182,y:-7,angle:0,scX:1,scY:1,skX:22,skY:22,alpha:1}),this.setPart(this.fly2,{x:153,y:-12,angle:0,scX:.66,scY:1,skX:9,skY:9,alpha:.24})):26===this.counterAnim?(this.setPart(this.fly1,{x:190,y:-6,angle:0,scX:1,scY:1,skX:22,skY:22,alpha:1}),this.setPart(this.fly2,{x:161,y:-11,angle:0,scX:.68,scY:1,skX:11,skY:11,alpha:.27})):27===this.counterAnim?(this.setPart(this.fly1,{x:198,y:-4,angle:0,scX:1,scY:1,skX:23,skY:23,alpha:1}),this.setPart(this.fly2,{x:169,y:-10,angle:0,scX:.69,scY:1,skX:13,skY:13,alpha:.3})):28===this.counterAnim?(this.setPart(this.fly1,{x:205,y:-2,angle:0,scX:1,scY:1,skX:24,skY:24,alpha:1}),this.setPart(this.fly2,{x:177,y:-8,angle:0,scX:.7,scY:1,skX:14,skY:14,alpha:.32})):29===this.counterAnim?(this.setPart(this.fly1,{x:213,y:0,angle:0,scX:1,scY:1,skX:25,skY:25,alpha:1}),this.setPart(this.fly2,{x:186,y:-7,angle:0,scX:.71,scY:1,skX:16,skY:16,alpha:.35})):30===this.counterAnim?(this.setPart(this.fly1,{x:221,y:3,angle:0,scX:1,scY:1,skX:26,skY:26,alpha:1}),this.setPart(this.fly2,{x:194,y:-5,angle:0,scX:.72,scY:1,skX:17,skY:17,alpha:.38})):31===this.counterAnim?(this.setPart(this.fly1,{x:229,y:6,angle:0,scX:1,scY:1,skX:27,skY:27,alpha:1}),this.setPart(this.fly2,{x:202,y:-3,angle:0,scX:.74,scY:1,skX:19,skY:19,alpha:.41})):32===this.counterAnim?(this.setPart(this.fly1,{x:237,y:9,angle:0,scX:1,scY:1,skX:28,skY:28,alpha:1}),this.setPart(this.fly2,{x:210,y:-1,angle:0,scX:.75,scY:1,skX:20,skY:20,alpha:.43})):33===this.counterAnim?(this.setPart(this.fly1,{x:244,y:12,angle:0,scX:1,scY:1,skX:29,skY:29,alpha:1}),this.setPart(this.fly2,{x:217,y:2,angle:0,scX:.76,scY:1,skX:22,skY:22,alpha:.46})):34===this.counterAnim?(this.setPart(this.fly1,{x:252,y:15,angle:0,scX:1,scY:1,skX:30,skY:30,alpha:1}),this.setPart(this.fly2,{x:225,y:4,angle:0,scX:.77,scY:1,skX:23,skY:23,alpha:.49})):35===this.counterAnim?(this.setPart(this.fly1,{x:259,y:19,angle:0,scX:1,scY:1,skX:31,skY:31,alpha:1}),this.setPart(this.fly2,{x:233,y:7,angle:0,scX:.78,scY:1,skX:25,skY:25,alpha:.51})):36===this.counterAnim?(this.setPart(this.fly1,{x:266,y:23,angle:0,scX:1,scY:1,skX:31,skY:31,alpha:1}),this.setPart(this.fly2,{x:241,y:10,angle:0,scX:.79,scY:1,skX:26,skY:26,alpha:.54})):37===this.counterAnim?(this.setPart(this.fly1,{x:274,y:27,angle:0,scX:1,scY:1,skX:32,skY:32,alpha:1}),this.setPart(this.fly2,{x:248,y:14,angle:0,scX:.81,scY:1,skX:28,skY:28,alpha:.57})):38===this.counterAnim?(this.setPart(this.fly1,{x:281,y:31,angle:0,scX:1,scY:1,skX:33,skY:33,alpha:1}),this.setPart(this.fly2,{x:256,y:17,angle:0,scX:.82,scY:1,skX:29,skY:29,alpha:.59})):39===this.counterAnim?(this.setPart(this.fly1,{x:288,y:36,angle:0,scX:1,scY:1,skX:34,skY:34,alpha:1}),this.setPart(this.fly2,{x:263,y:21,angle:0,scX:.83,scY:1,skX:31,skY:31,alpha:.62})):40===this.counterAnim?(this.setPart(this.fly1,{x:294,y:40,angle:0,scX:1,scY:1,skX:35,skY:35,alpha:1}),this.setPart(this.fly2,{x:270,y:25,angle:0,scX:.84,scY:1,skX:33,skY:33,alpha:.65})):41===this.counterAnim?(this.setPart(this.fly1,{x:301,y:45,angle:0,scX:1,scY:1,skX:36,skY:36,alpha:1}),this.setPart(this.fly2,{x:277,y:29,angle:0,scX:.85,scY:1,skX:34,skY:34,alpha:.68})):42===this.counterAnim?(this.setPart(this.fly1,{x:308,y:50,angle:0,scX:1,scY:1,skX:37,skY:37,alpha:1}),this.setPart(this.fly2,{x:285,y:34,angle:0,scX:.87,scY:1,skX:36,skY:36,alpha:.7})):43===this.counterAnim?(this.setPart(this.fly1,{x:314,y:56,angle:0,scX:1,scY:1,skX:38,skY:38,alpha:1}),this.setPart(this.fly2,{x:291,y:38,angle:0,scX:.88,scY:1,skX:37,skY:37,alpha:.73})):44===this.counterAnim?(this.setPart(this.fly1,{x:320,y:61,angle:0,scX:1,scY:1,skX:39,skY:39,alpha:1}),this.setPart(this.fly2,{x:298,y:43,angle:0,scX:.89,scY:1,skX:39,skY:39,alpha:.76})):45===this.counterAnim?(this.setPart(this.fly1,{x:326,y:67,angle:0,scX:1,scY:1,skX:40,skY:40,alpha:1}),this.setPart(this.fly2,{x:305,y:48,angle:0,scX:.9,scY:1,skX:40,skY:40,alpha:.79})):46===this.counterAnim?(this.setPart(this.fly1,{x:332,y:73,angle:0,scX:1,scY:1,skX:41,skY:41,alpha:1}),this.setPart(this.fly2,{x:311,y:53,angle:0,scX:.91,scY:1,skX:42,skY:42,alpha:.81})):47===this.counterAnim?(this.setPart(this.fly1,{x:338,y:79,angle:0,scX:1,scY:1,skX:41,skY:41,alpha:1}),this.setPart(this.fly2,{x:318,y:59,angle:0,scX:.93,scY:1,skX:43,skY:43,alpha:.84})):48===this.counterAnim?(this.setPart(this.fly1,{x:344,y:85,angle:0,scX:1,scY:1,skX:42,skY:42,alpha:1}),this.setPart(this.fly2,{x:324,y:64,angle:0,scX:.94,scY:1,skX:45,skY:45,alpha:.86})):49===this.counterAnim?(this.setPart(this.fly1,{x:349,y:91,angle:0,scX:1,scY:1,skX:43,skY:43,alpha:1}),this.setPart(this.fly2,{x:330,y:70,angle:0,scX:.95,scY:1,skX:46,skY:46,alpha:.89})):50===this.counterAnim?(this.setPart(this.fly1,{x:355,y:97,angle:0,scX:1,scY:1,skX:44,skY:44,alpha:1}),this.setPart(this.fly2,{x:336,y:76,angle:0,scX:.96,scY:1,skX:48,skY:48,alpha:.92})):51===this.counterAnim?(this.setPart(this.fly1,{x:360,y:104,angle:0,scX:1,scY:1,skX:45,skY:45,alpha:1}),this.setPart(this.fly2,{x:341,y:82,angle:0,scX:.97,scY:1,skX:50,skY:50,alpha:.95})):52===this.counterAnim?(this.setPart(this.fly1,{x:365,y:110,angle:0,scX:1,scY:1,skX:46,skY:46,alpha:1}),this.setPart(this.fly2,{x:347,y:88,angle:0,scX:.98,scY:1,skX:51,skY:51,alpha:.97})):53===this.counterAnim?(this.setPart(this.fly1,{x:370,y:117,angle:0,scX:1,scY:1,skX:47,skY:47,alpha:1}),this.setPart(this.fly2,{x:352,y:94,angle:0,scX:1,scY:1,skX:53,skY:53,alpha:1})):54===this.counterAnim?(this.setPart(this.fly1,{x:375,y:124,angle:0,scX:1,scY:1,skX:48,skY:48,alpha:1}),this.setPart(this.fly2,{x:358,y:101,angle:0,scX:1,scY:1,skX:53,skY:53,alpha:1})):55===this.counterAnim?(this.setPart(this.fly1,{x:379,y:131,angle:0,scX:1,scY:1,skX:49,skY:49,alpha:1}),this.setPart(this.fly2,{x:363,y:107,angle:0,scX:1,scY:1,skX:54,skY:54,alpha:1})):56===this.counterAnim?(this.setPart(this.fly1,{x:384,y:138,angle:0,scX:1,scY:1,skX:50,skY:50,alpha:1}),this.setPart(this.fly2,{x:368,y:114,angle:0,scX:1,scY:1,skX:55,skY:55,alpha:1})):57===this.counterAnim?(this.setPart(this.fly1,{x:388,y:145,angle:0,scX:1,scY:1,skX:50,skY:50,alpha:1}),this.setPart(this.fly2,{x:373,y:121,angle:0,scX:1,scY:1,skX:56,skY:56,alpha:1})):58===this.counterAnim?(this.setPart(this.fly1,{x:392,y:152,angle:0,scX:1,scY:1,skX:51,skY:51,alpha:1}),this.setPart(this.fly2,{x:377,y:128,angle:0,scX:1,scY:1,skX:57,skY:57,alpha:1})):59===this.counterAnim?(this.setPart(this.fly1,{x:397,y:159,angle:0,scX:1,scY:1,skX:52,skY:52,alpha:1}),this.setPart(this.fly2,{x:382,y:135,angle:0,scX:1,scY:1,skX:58,skY:58,alpha:1})):60===this.counterAnim?(this.setPart(this.fly1,{x:401,y:166,angle:0,scX:1,scY:1,skX:53,skY:53,alpha:1}),this.setPart(this.fly2,{x:386,y:142,angle:0,scX:1,scY:1,skX:58,skY:58,alpha:1})):61===this.counterAnim?(this.setPart(this.fly1,{x:404,y:174,angle:0,scX:1,scY:1,skX:54,skY:54,alpha:1}),this.setPart(this.fly2,{x:391,y:149,angle:0,scX:1,scY:1,skX:59,skY:59,alpha:1})):62===this.counterAnim?(this.setPart(this.fly1,{x:408,y:181,angle:0,scX:1,scY:1,skX:55,skY:55,alpha:1}),this.setPart(this.fly2,{x:395,y:156,angle:0,scX:1,scY:1,skX:60,skY:60,alpha:1})):63===this.counterAnim?(this.setPart(this.fly1,{x:412,y:188,angle:0,scX:1,scY:1,skX:56,skY:56,alpha:1}),this.setPart(this.fly2,{x:399,y:163,angle:0,scX:1,scY:1,skX:61,skY:61,alpha:1})):64===this.counterAnim?(this.setPart(this.fly1,{x:415,y:196,angle:0,scX:1,scY:1,skX:57,skY:57,alpha:1}),this.setPart(this.fly2,{x:403,y:171,angle:0,scX:1,scY:1,skX:62,skY:62,alpha:1})):65===this.counterAnim?(this.setPart(this.fly1,{x:419,y:203,angle:0,scX:1,scY:1,skX:58,skY:58,alpha:1}),this.setPart(this.fly2,{x:407,y:178,angle:0,scX:1,scY:1,skX:63,skY:63,alpha:1})):66===this.counterAnim?(this.setPart(this.fly1,{x:422,y:211,angle:0,scX:1,scY:1,skX:59,skY:59,alpha:1}),this.setPart(this.fly2,{x:410,y:185,angle:0,scX:1,scY:1,skX:64,skY:64,alpha:1})):67===this.counterAnim?(this.setPart(this.fly1,{x:425,y:218,angle:0,scX:1,scY:1,skX:59,skY:59,alpha:1}),this.setPart(this.fly2,{x:414,y:193,angle:0,scX:1,scY:1,skX:64,skY:64,alpha:1})):68===this.counterAnim?(this.setPart(this.fly1,{x:428,y:226,angle:0,scX:1,scY:1,skX:60,skY:60,alpha:1}),this.setPart(this.fly2,{x:417,y:200,angle:0,scX:1,scY:1,skX:65,skY:65,alpha:1})):69===this.counterAnim?(this.setPart(this.fly1,{x:431,y:234,angle:0,scX:1,scY:1,skX:61,skY:61,alpha:1}),this.setPart(this.fly2,{x:421,y:208,angle:0,scX:1,scY:1,skX:66,skY:66,alpha:1})):70===this.counterAnim?(this.setPart(this.fly1,{x:434,y:241,angle:0,scX:1,scY:1,skX:62,skY:62,alpha:1}),this.setPart(this.fly2,{x:424,y:216,angle:0,scX:1,scY:1,skX:67,skY:67,alpha:1})):71===this.counterAnim?(this.setPart(this.fly1,{x:437,y:249,angle:0,scX:1,scY:1,skX:63,skY:63,alpha:1}),this.setPart(this.fly2,{x:427,y:223,angle:0,scX:1,scY:1,skX:68,skY:68,alpha:1})):72===this.counterAnim?(this.setPart(this.fly1,{x:439,y:257,angle:0,scX:1,scY:1,skX:64,skY:64,alpha:1}),this.setPart(this.fly2,{x:430,y:231,angle:0,scX:1,scY:1,skX:69,skY:69,alpha:1})):73===this.counterAnim?(this.setPart(this.fly1,{x:442,y:265,angle:0,scX:1,scY:1,skX:65,skY:65,alpha:1}),this.setPart(this.fly2,{x:433,y:239,angle:0,scX:1,scY:1,skX:69,skY:69,alpha:1})):74===this.counterAnim?(this.setPart(this.fly1,{x:445,y:272,angle:0,scX:1,scY:1,skX:66,skY:66,alpha:1}),this.setPart(this.fly2,{x:436,y:246,angle:0,scX:1,scY:1,skX:70,skY:70,alpha:1})):75===this.counterAnim?(this.setPart(this.fly1,{x:447,y:280,angle:0,scX:1,scY:1,skX:67,skY:67,alpha:1}),this.setPart(this.fly2,{x:439,y:254,angle:0,scX:1,scY:1,skX:71,skY:71,alpha:1})):76===this.counterAnim?(this.setPart(this.fly1,{x:449,y:288,angle:0,scX:1,scY:1,skX:68,skY:68,alpha:1}),this.setPart(this.fly2,{x:441,y:262,angle:0,scX:1,scY:1,skX:72,skY:72,alpha:1})):77===this.counterAnim?(this.setPart(this.fly1,{x:452,y:296,angle:0,scX:1,scY:1,skX:69,skY:69,alpha:1}),this.setPart(this.fly2,{x:444,y:270,angle:0,scX:1,scY:1,skX:73,skY:73,alpha:1})):78===this.counterAnim?(this.setPart(this.fly1,{x:454,y:304,angle:0,scX:1,scY:1,skX:69,skY:69,alpha:1}),this.setPart(this.fly2,{x:446,y:278,angle:0,scX:1,scY:1,skX:74,skY:74,alpha:1})):79===this.counterAnim?(this.setPart(this.fly1,{x:456,y:312,angle:0,scX:1,scY:1,skX:70,skY:70,alpha:1}),this.setPart(this.fly2,{x:449,y:285,angle:0,scX:1,scY:1,skX:74,skY:74,alpha:1})):80===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"fly"===e&&(this.setPart(this.fly1,{x:-9,y:3,angle:0,scX:.55,scY:.55,skX:0,skY:0,alpha:1}),this.fly2.visible=!1)},i.prototype.free=function(){this.group=null,this.fly2=null,this.fly1=null},i}(e.BasicSimpleAnim);e.Lvl6FlyChicken=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.addRoof(),e.GameManager.instance.layerElements.create(322,188,"level6","roofPart instance 10000").anchor.set(.5),i.addWindows(),i.redButton=e.GameManager.instance.layerElements.create(321,218,"level6","redButton instance 10000"),i.redButton.anchor.set(.5),i.redButton.inputEnabled=!0,i.redButton.input.useHandCursor=!0,i.redButton.events.onInputOut.add(i.out,i),i.redButton.events.onInputOver.add(i.over,i),i.redButton.events.onInputDown.add(i.down,i),i}return __extends(i,t),i.prototype.over=function(){this.redButton.frameName="redButton instance 10001"},i.prototype.out=function(){!0===this.redButton.input.enabled&&(this.redButton.frameName="redButton instance 10000")},i.prototype.down=function(){this.redButton.input.enabled=!1,this.redButton.frameName="redButton instance 10003",this.roof.use(),this.window1.playAnim(),this.window2.playAnim()},i.prototype.enableButton=function(){this.redButton.input.enabled=!0,this.redButton.input.useHandCursor=!0,this.redButton.frameName="redButton instance 10000"},i.prototype.addLightningEffect=function(){1===this.window1.currentSymbol&&0===this.window2.currentSymbol?(this.addLigthning(e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y),e.GameManager.instance.hero.addShock(),e.GameManager.instance.level.gameOver=!0):1===this.window1.currentSymbol&&1===this.window2.currentSymbol?(this.addLigthning(e.GameManager.instance.level.car3.group.x+15,e.GameManager.instance.level.car3.group.y+30),e.GameManager.instance.level.car3.playLightning()):0===this.window1.currentSymbol&&0===this.window2.currentSymbol?this.chickenMagic():0===this.window1.currentSymbol&&1===this.window2.currentSymbol&&(null==this.flyChicken&&(this.flyChicken=new e.Lvl6FlyChicken(e.Main.instance),e.GameManager.instance.level.updateElements.push(this.flyChicken)),this.flyChicken.fly())},i.prototype.chickenMagic=function(){var t=e.GameManager.instance.layerUpper.create(335,100,"level6","chickenMagic instance 10000",!0,1);t.anchor.set(.5,1),t.scale.set(2,-2);var i=Phaser.Math.angleBetween(t.x,t.y,e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y);t.rotation=i-Phaser.Math.degToRad(90),t.animations.add("boom",Phaser.Animation.generateFrameNames("chickenMagic instance 1",0,14,"",4),30,!1).onComplete.add(function(){e.GameManager.instance.hero.setVisibility(!1),e.GameManager.instance.level.addChicken()},this),t.play("boom")},i.prototype.addLigthning=function(t,i){null==this.ligthningTop&&(this.ligthningTop=e.GameManager.instance.layerBackground.create(322,120,"level6","lightningAnim instance 10000",!0,1),this.ligthningTop.anchor.set(.5,0),this.ligthningTop.scale.set(2,-2),this.ligthningTop.animations.add("boom",Phaser.Animation.generateFrameNames("lightningAnim instance 1",0,14,"",4),30,!1)),this.ligthningTop.play("boom"),null==this.ligthningMain&&(this.ligthningMain=e.GameManager.instance.layerUpper.create(0,0,"level6","lightningAnim instance 10000",!0,1),this.ligthningMain.anchor.set(.5,1),this.ligthningMain.scale.set(2,2),this.ligthningMain.animations.add("boom",Phaser.Animation.generateFrameNames("lightningAnim instance 1",0,14,"",4),30,!1)),this.ligthningMain.x=t,this.ligthningMain.y=i,this.ligthningMain.play("boom"),e.SoundManager.playSFX("s_lightning")},i.prototype.addWindows=function(){this.window1=new e.Lvl6Window(e.Main.instance,278,270,-1,4,3,1),e.GameManager.instance.level.updateElements.push(this.window1),this.window2=new e.Lvl6Window(e.Main.instance,370,270,1,2,1,0),e.GameManager.instance.level.updateElements.push(this.window2)},i.prototype.addRoof=function(){this.roof=new e.Lvl6Roof(e.Main.instance),e.GameManager.instance.level.updateElements.push(this.roof)},i.prototype.free=function(){this.window1=null,this.window2=null,this.roof=null,this.redButton=null,this.ligthningTop=null,this.ligthningMain=null,this.flyChicken=null},i}(e.BasicElement);e.Lvl6House=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.group.x=322,s.group.y=141,e.GameManager.instance.layerBackground.addChild(s.group),s.white13=new e.SASprite(i,0,0,"level6","blueLine instance 10000"),s.white13.anchor.set(.5),s.group.addChild(s.white13),s.white12=new e.SASprite(i,0,0,"level6","blueLine instance 10000"),s.white12.anchor.set(.5),s.group.addChild(s.white12),s.white11=new e.SASprite(i,0,0,"level6","blueLine instance 10000"),s.white11.anchor.set(.5),s.group.addChild(s.white11),s.white10=new e.SASprite(i,0,0,"level6","blueLine instance 10000"),s.white10.anchor.set(.5),s.group.addChild(s.white10),s.white9=new e.SASprite(i,0,0,"level6","blueLine instance 10000"),s.white9.anchor.set(.5),s.group.addChild(s.white9),s.white8=new e.SASprite(i,0,0,"level6","blueCircle instance 10000"),s.white8.anchor.set(.5),s.group.addChild(s.white8),s.white7=new e.SASprite(i,0,0,"level6","blueCircle instance 10000"),s.white7.anchor.set(.5),s.group.addChild(s.white7),s.white6=new e.SASprite(i,0,0,"level6","blueCircle instance 10000"),s.white6.anchor.set(.5),s.group.addChild(s.white6),s.white5=new e.SASprite(i,0,0,"level6","blueCircle instance 10000"),s.white5.anchor.set(.5),s.group.addChild(s.white5),s.white4=new e.SASprite(i,0,0,"level6","whiteCircle instance 10000"),s.white4.anchor.set(.5),s.group.addChild(s.white4),s.white3=new e.SASprite(i,0,0,"level6","whiteCircle instance 10000"),s.white3.anchor.set(.5),s.group.addChild(s.white3),s.white2=new e.SASprite(i,0,0,"level6","whiteCircle instance 10000"),s.white2.anchor.set(.5),s.group.addChild(s.white2),s.white1=new e.SASprite(i,0,0,"level6","whiteCircle instance 10000"),s.white1.anchor.set(.5),s.group.addChild(s.white1),s.playAnim("anim",-1),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.white1,19,{x:8,y:-29,skX:9,skY:9,scX:.44,scY:.44},!0),e.GameManager.instance.level.setSimpleTween(this.white2,19,{x:12,y:-56,scX:.47,scY:.47},!0),e.GameManager.instance.level.setSimpleTween(this.white3,19,{x:-20,y:-49,skX:-4,skY:-4,scX:.5,scY:.5},!0),e.GameManager.instance.level.setSimpleTween(this.white4,19,{y:-41,scX:1.07,scY:1.08},!0),e.GameManager.instance.level.setSimpleTween(this.white5,19,{y:-38,scX:1.64,scY:1.65},!0),e.GameManager.instance.level.setSimpleTween(this.white6,19,{y:-28,skX:9,skY:9,scX:.73,scY:.73},!0),e.GameManager.instance.level.setSimpleTween(this.white7,19,{x:13,y:-57,scX:.83,scY:.83},!0),e.GameManager.instance.level.setSimpleTween(this.white8,19,{x:-22,y:-50,skX:-4,skY:-4,scX:.84,scY:.84},!0),e.GameManager.instance.level.setSimpleTween(this.white10,19,{x:-15,skX:-149,skY:-149},!0),e.GameManager.instance.level.setSimpleTween(this.white11,19,{y:-33,skX:-146,skY:-146,scY:1.1},!0),e.GameManager.instance.level.setSimpleTween(this.white12,19,{x:11,y:-42,skX:100,skY:100,scY:1.25},!0),e.GameManager.instance.level.setSimpleTween(this.white13,19,{x:5,scY:1.5},!0)):20===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.white1,20,{x:9,y:-26,skX:0,skY:0,scX:.31,scY:.31},!0),e.GameManager.instance.level.setSimpleTween(this.white2,20,{x:16,y:-60,scX:.57,scY:.57},!0),e.GameManager.instance.level.setSimpleTween(this.white3,20,{x:-19,y:-51,skX:0,skY:0,scX:.57,scY:.57},!0),e.GameManager.instance.level.setSimpleTween(this.white4,20,{y:-37,scX:.99,scY:.99},!0),e.GameManager.instance.level.setSimpleTween(this.white5,20,{y:-37,scX:1.57,scY:1.57},!0),e.GameManager.instance.level.setSimpleTween(this.white6,20,{y:-26,skX:0,skY:0,scX:.52,scY:.52},!0),e.GameManager.instance.level.setSimpleTween(this.white7,20,{x:18,y:-61,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.white8,20,{x:-20,y:-52,skX:0,skY:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.white10,20,{x:-14,skX:-133,skY:-133},!0),e.GameManager.instance.level.setSimpleTween(this.white11,20,{y:-32,skX:-149,skY:-149,scY:.86},!0),e.GameManager.instance.level.setSimpleTween(this.white12,20,{x:13,y:-43,skX:102,skY:102,scY:.86},!0),e.GameManager.instance.level.setSimpleTween(this.white13,20,{x:6,scY:1},!0)):40===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.white1,15,{x:12,y:-30,skX:2,skY:2,scX:.73,scY:.73},!0),e.GameManager.instance.level.setSimpleTween(this.white2,15,{x:15,y:-59,scX:.48,scY:.48},!0),e.GameManager.instance.level.setSimpleTween(this.white3,15,{x:-25,y:-48,skX:-12,skY:-12,scX:.75,scY:.75},!0),e.GameManager.instance.level.setSimpleTween(this.white4,15,{x:-6,y:-40,scX:1.27,scY:1.3},!0),e.GameManager.instance.level.setSimpleTween(this.white5,15,{x:-6,y:-40,scX:1.79,scY:1.82},!0),e.GameManager.instance.level.setSimpleTween(this.white6,15,{x:13,y:-28,skX:2,skY:2,scX:1.21,scY:1.21},!0),e.GameManager.instance.level.setSimpleTween(this.white7,15,{x:16,y:-60,scX:.85,scY:.85},!0),e.GameManager.instance.level.setSimpleTween(this.white8,15,{x:-26,y:-48,skX:-12,skY:-12,scX:1.15,scY:1.15},!0),e.GameManager.instance.level.setSimpleTween(this.white10,15,{x:-16,y:-45,skX:-167,skY:-167,scY:1.92},!0),e.GameManager.instance.level.setSimpleTween(this.white11,15,{x:3,y:-35,scX:.61,scY:1.55},!0),e.GameManager.instance.level.setSimpleTween(this.white12,15,{x:15,y:-44,skX:95,skY:95,scY:1.12},!0),e.GameManager.instance.level.setSimpleTween(this.white13,15,{y:-52,skX:-38,skY:-38,scY:1.25},!0)):55===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.white1,17,{x:1,skX:1,skY:1,scX:.53,scY:.53},!0),e.GameManager.instance.level.setSimpleTween(this.white2,17,{x:17,y:-40,scX:.25,scY:.25},!0),e.GameManager.instance.level.setSimpleTween(this.white3,17,{x:-22,y:-49,skX:-6,skY:-6,scX:.66,scY:.66},!0),e.GameManager.instance.level.setSimpleTween(this.white4,17,{x:0,y:-54,scX:.29,scY:.29},!0),e.GameManager.instance.level.setSimpleTween(this.white5,17,{x:1,y:-54,scX:.92,scY:.93},!0),e.GameManager.instance.level.setSimpleTween(this.white6,17,{x:1,y:-30,skX:1,skY:1,scX:.83,scY:.83},!0),e.GameManager.instance.level.setSimpleTween(this.white7,17,{x:17,y:-41,scX:.48,scY:.48},!0),e.GameManager.instance.level.setSimpleTween(this.white8,17,{x:-23,y:-50,skX:-6,skY:-6,scX:1.08,scY:1.08},!0),e.GameManager.instance.level.setSimpleTween(this.white10,17,{x:-12,y:-53,skX:171,skY:171,scX:.82,scY:.95},!0),e.GameManager.instance.level.setSimpleTween(this.white11,17,{x:0,y:-42,skX:-92,skY:-92,scX:.86,scY:1.04},!0),e.GameManager.instance.level.setSimpleTween(this.white12,17,{x:9,y:-36,skX:151,skY:151,scX:1,scY:.62},!0),e.GameManager.instance.level.setSimpleTween(this.white13,17,{x:8,y:-48,skX:41,skY:41,scY:.69},!0)):72===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.white1,18,{x:-7,y:-37,skX:0,skY:0,scX:.99,scY:.99},!0),e.GameManager.instance.level.setSimpleTween(this.white2,18,{x:9,y:-26,scX:.31,scY:.31},!0),e.GameManager.instance.level.setSimpleTween(this.white3,18,{x:-19,y:-51,skX:0,skY:0,scX:.57,scY:.57},!0),e.GameManager.instance.level.setSimpleTween(this.white4,18,{x:16,y:-60,scX:.57,scY:.57},!0),e.GameManager.instance.level.setSimpleTween(this.white5,18,{x:18,y:-61,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.white6,18,{x:-7,y:-37,skX:0,skY:0,scX:1.57,scY:1.57},!0),e.GameManager.instance.level.setSimpleTween(this.white7,18,{x:9,y:-26,scX:.52,scY:.52},!0),e.GameManager.instance.level.setSimpleTween(this.white8,18,{x:-20,y:-52,skX:0,skY:0,scX:1,scY:1},!0),this.setPart(this.white10,{x:-12,y:-53,angle:0,scX:.82,scY:.95,skX:171,skY:171,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.white11,18,{x:6,y:-51,skX:-44,skY:-44,scX:1.13,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.white12,18,{x:1,y:-32,skX:-149,skY:-149,scX:1.03,scY:.86},!0),e.GameManager.instance.level.setSimpleTween(this.white13,10,{x:11,y:-45,skX:84,skY:84,scX:1.33,scY:.86},!0)):73===this.counterAnim?this.white10.visible=!1:76===this.counterAnim?(this.white9.visible=!0,this.setPart(this.white9,{x:-11,y:-42,angle:0,scX:1.17,scY:.42,skX:-140,skY:-140,alpha:0},!0),e.GameManager.instance.level.setSimpleTween(this.white9,14,{x:-14,y:-46,skX:-133,skY:-133,scX:.54,scY:1.39,alpha:1},!0)):82===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.white13,8,{x:13,y:-43,skX:102,skY:102,scX:1.54},!0):90===this.counterAnim?(this.setPart(this.white1,{x:-7,y:-37,angle:0,scX:.99,scY:.99,skX:0,skY:0,alpha:1},!0),this.setPart(this.white2,{x:9,y:-26,angle:0,scX:.31,scY:.31,skX:0,skY:0,alpha:1},!0),this.setPart(this.white3,{x:-19,y:-51,angle:0,scX:.57,scY:.57,skX:0,skY:0,alpha:1},!0),this.setPart(this.white4,{x:16,y:-60,angle:0,scX:.57,scY:.57,skX:0,skY:0,alpha:1},!0),this.setPart(this.white5,{x:18,y:-61,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.white6,{x:-7,y:-37,angle:0,scX:1.57,scY:1.57,skX:0,skY:0,alpha:1},!0),this.setPart(this.white7,{x:9,y:-26,angle:0,scX:.52,scY:.52,skX:0,skY:0,alpha:1},!0),this.setPart(this.white8,{x:-20,y:-52,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.white9,{x:-14,y:-46,angle:0,scX:.54,scY:1.39,skX:-133,skY:-133,alpha:1},!0),this.setPart(this.white11,{x:6,y:-51,angle:0,scX:1.13,scY:1,skX:-44,skY:-44,alpha:1},!0),this.setPart(this.white12,{x:1,y:-32,angle:0,scX:1.03,scY:.86,skX:-149,skY:-149,alpha:1},!0),this.setPart(this.white13,{x:13,y:-43,angle:0,scX:1.54,scY:.86,skX:102,skY:102,alpha:1},!0)):94===this.counterAnim&&this.animComplete():"magic"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.white1,14,{x:-4,y:-47,skX:-2,skY:-2,scX:1.81,scY:1.81},!0),e.GameManager.instance.level.setSimpleTween(this.white2,14,{x:19,y:-36,skX:-2,skY:-2},!0),e.GameManager.instance.level.setSimpleTween(this.white3,14,{x:-28,y:-62,skX:-2,skY:-2,scX:.5,scY:.5},!0),e.GameManager.instance.level.setSimpleTween(this.white4,14,{x:22,y:-64,skX:29,skY:29,scX:.44,scY:.44},!0),e.GameManager.instance.level.setSimpleTween(this.white5,14,{x:24,y:-64,skX:29,skY:29,scX:.78,scY:.78},!0),e.GameManager.instance.level.setSimpleTween(this.white6,14,{x:-5,y:-47,skX:-2,skY:-2,scX:2.71,scY:2.71},!0),e.GameManager.instance.level.setSimpleTween(this.white7,14,{x:20,y:-36,skX:-2,skY:-2},!0),e.GameManager.instance.level.setSimpleTween(this.white8,14,{x:-29,y:-62,skX:-2,skY:-2,scX:.88,scY:.88},!0),e.GameManager.instance.level.setSimpleTween(this.white9,14,{x:-19,y:-57,skX:-147,skY:-147,scX:.73},!0),e.GameManager.instance.level.setSimpleTween(this.white11,14,{x:12,y:-59,skX:-29,skY:-29},!0),e.GameManager.instance.level.setSimpleTween(this.white12,14,{x:8,y:-40,skX:-160,skY:-160,scX:1.27},!0),e.GameManager.instance.level.setSimpleTween(this.white13,14,{x:21,y:-50,skX:97,skY:97},!0)):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.white1,16,{x:6,y:-52,skX:-8,skY:-8,scX:2.32,scY:2.32},!0),e.GameManager.instance.level.setSimpleTween(this.white2,16,{x:25,y:-43,skX:-8,skY:-8},!0),e.GameManager.instance.level.setSimpleTween(this.white3,16,{x:-23,y:-63,skX:-8,skY:-8,scX:.81,scY:.81},!0),e.GameManager.instance.level.setSimpleTween(this.white4,16,{x:26,y:-71,skX:23,skY:23},!0),e.GameManager.instance.level.setSimpleTween(this.white5,16,{x:27,y:-71,skX:23,skY:23},!0),e.GameManager.instance.level.setSimpleTween(this.white6,16,{x:3,y:-52,skX:-8,skY:-8,scX:3.04,scY:3.04},!0),e.GameManager.instance.level.setSimpleTween(this.white7,16,{x:26,y:-43,skX:-8,skY:-8},!0),e.GameManager.instance.level.setSimpleTween(this.white8,16,{x:-25,y:-64,skX:-8,skY:-8,scX:1.42,scY:1.42},!0),e.GameManager.instance.level.setSimpleTween(this.white9,16,{x:-15,y:-60,skX:-153,skY:-153},!0),e.GameManager.instance.level.setSimpleTween(this.white11,16,{x:16,y:-65,skX:-35,skY:-35},!0),e.GameManager.instance.level.setSimpleTween(this.white12,16,{x:14,y:-46,skX:-166,skY:-166},!0),e.GameManager.instance.level.setSimpleTween(this.white13,16,{x:26,y:-57,skX:91,skY:91},!0)):31===this.counterAnim?(e.GameManager.instance.level.house.addLightningEffect(),this.setPart(this.white1,{x:6,y:-52,angle:0,scX:2.32,scY:2.32,skX:-8,skY:-8,alpha:1},!0),this.setPart(this.white2,{x:25,y:-43,angle:0,scX:.31,scY:.31,skX:-8,skY:-8,alpha:1},!0),this.setPart(this.white3,{x:-23,y:-63,angle:0,scX:.81,scY:.81,skX:-8,skY:-8,alpha:1},!0),this.setPart(this.white4,{x:26,y:-71,angle:0,scX:.44,scY:.44,skX:23,skY:23,alpha:1},!0),this.setPart(this.white5,{x:27,y:-71,angle:0,scX:.78,scY:.78,skX:23,skY:23,alpha:1},!0),this.setPart(this.white6,{x:3,y:-52,angle:0,scX:3.04,scY:3.04,skX:-8,skY:-8,alpha:1},!0),this.setPart(this.white7,{x:26,y:-43,angle:0,scX:.52,scY:.52,skX:-8,skY:-8,alpha:1},!0),this.setPart(this.white8,{x:-25,y:-64,angle:0,scX:1.42,scY:1.42,skX:-8,skY:-8,alpha:1},!0),this.setPart(this.white9,{x:-15,y:-60,angle:0,scX:.73,scY:1.39,skX:-153,skY:-153,alpha:1},!0),this.setPart(this.white11,{x:16,y:-65,angle:0,scX:1.13,scY:1,skX:-35,skY:-35,alpha:1},!0),this.setPart(this.white12,{x:14,y:-46,angle:0,scX:1.27,scY:.86,skX:-166,skY:-166,alpha:1},!0),this.setPart(this.white13,{x:26,y:-57,angle:0,scX:1.54,scY:.86,skX:91,skY:91,alpha:1},!0)):46===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.white1,15,{x:-7,y:-37,skX:0,skY:0,scX:.99,scY:.99},!0),e.GameManager.instance.level.setSimpleTween(this.white2,15,{x:9,y:-26,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.white3,15,{x:-19,y:-51,skX:0,skY:0,scX:.57,scY:.57},!0),e.GameManager.instance.level.setSimpleTween(this.white4,15,{x:16,y:-60,skX:0,skY:0,scX:.57,scY:.57},!0),e.GameManager.instance.level.setSimpleTween(this.white5,15,{x:18,y:-61,skX:0,skY:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.white6,15,{x:-7,y:-37,skX:0,skY:0,scX:1.57,scY:1.57},!0),e.GameManager.instance.level.setSimpleTween(this.white7,15,{x:9,y:-26,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.white8,15,{x:-20,y:-52,skX:0,skY:0,scX:1,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.white9,15,{x:-14,y:-46,skX:-133,skY:-133,scX:.54},!0),e.GameManager.instance.level.setSimpleTween(this.white11,15,{x:6,y:-51,skX:-44,skY:-44},!0),e.GameManager.instance.level.setSimpleTween(this.white12,15,{x:1,y:-32,skX:-149,skY:-149,scX:1.03},!0),e.GameManager.instance.level.setSimpleTween(this.white13,15,{x:13,y:-43,skX:102,skY:102},!0)):61===this.counterAnim&&(this.animComplete(),this.playAnim("anim",-1))))},i.prototype.setParts=function(e){"anim"===e?(this.setPart(this.white1,{x:9,y:-26,angle:0,scX:.31,scY:.31,skX:0,skY:0,alpha:1},!0),this.setPart(this.white2,{x:16,y:-60,angle:0,scX:.57,scY:.57,skX:0,skY:0,alpha:1},!0),this.setPart(this.white3,{x:-19,y:-51,angle:0,scX:.57,scY:.57,skX:0,skY:0,alpha:1},!0),this.setPart(this.white4,{x:-7,y:-37,angle:0,scX:.99,scY:.99,skX:0,skY:0,alpha:1},!0),this.setPart(this.white5,{x:-7,y:-37,angle:0,scX:1.57,scY:1.57,skX:0,skY:0,alpha:1},!0),this.setPart(this.white6,{x:9,y:-26,angle:0,scX:.52,scY:.52,skX:0,skY:0,alpha:1},!0),this.setPart(this.white7,{x:18,y:-61,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.white8,{x:-20,y:-52,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.white9.visible=!1,this.setPart(this.white10,{x:-14,y:-46,angle:0,scX:.54,scY:1.39,skX:-133,skY:-133,alpha:1},!0),this.setPart(this.white11,{x:1,y:-32,angle:0,scX:1.03,scY:.86,skX:-149,skY:-149,alpha:1},!0),this.setPart(this.white12,{x:13,y:-43,angle:0,scX:1.54,scY:.86,skX:102,skY:102,alpha:1},!0),this.setPart(this.white13,{x:6,y:-51,angle:0,scX:1.13,scY:1,skX:-44,skY:-44,alpha:1},!0)):"magic"===e&&(this.setPart(this.white1,{x:-7,y:-37,angle:0,scX:.99,scY:.99,skX:0,skY:0,alpha:1},!0),this.setPart(this.white2,{x:9,y:-26,angle:0,scX:.31,scY:.31,skX:0,skY:0,alpha:1},!0),this.setPart(this.white3,{x:-19,y:-51,angle:0,scX:.57,scY:.57,skX:0,skY:0,alpha:1},!0),this.setPart(this.white4,{x:16,y:-60,angle:0,scX:.57,scY:.57,skX:0,skY:0,alpha:1},!0),this.setPart(this.white5,{x:18,y:-61,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.white6,{x:-7,y:-37,angle:0,scX:1.57,scY:1.57,skX:0,skY:0,alpha:1},!0),this.setPart(this.white7,{x:9,y:-26,angle:0,scX:.52,scY:.52,skX:0,skY:0,alpha:1},!0),this.setPart(this.white8,{x:-20,y:-52,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.white9,{x:-14,y:-46,angle:0,scX:.54,scY:1.39,skX:-133,skY:-133,alpha:1},!0),this.white10.visible=!1,this.setPart(this.white11,{x:6,y:-51,angle:0,scX:1.13,scY:1,skX:-44,skY:-44,alpha:1},!0),this.setPart(this.white12,{x:1,y:-32,angle:0,scX:1.03,scY:.86,skX:-149,skY:-149,alpha:1},!0),this.setPart(this.white13,{x:13,y:-43,angle:0,scX:1.54,scY:.86,skX:102,skY:102,alpha:1},!0))},i.prototype.free=function(){this.group=null,this.white13=null,this.white13=null,this.white12=null,this.white11=null,this.white9=null,this.white8=null,this.white7=null,this.white6=null,this.white5=null,this.white4=null,this.white3=null,this.white2=null,this.white1=null},i}(e.BasicSimpleAnim);e.Lvl6Magic=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.addTopMagic(),s.group=i.make.group(),s.group.x=322,s.group.y=141,e.GameManager.instance.layerBackground.addChild(s.group),s.part14=new e.SASprite(i,0,0,"level6","roofPart14 instance 10000"),s.part14.anchor.set(.5),s.group.addChild(s.part14),s.part13=new e.SASprite(i,0,0,"level6","roofPart11 instance 10000"),s.part13.anchor.set(.5),s.group.addChild(s.part13),s.part12=new e.SASprite(i,0,0,"level6","roofPart11 instance 10000"),s.part12.anchor.set(.5),s.group.addChild(s.part12),s.part11=new e.SASprite(i,0,0,"level6","roofPart11 instance 10000"),s.part11.anchor.set(.5),s.group.addChild(s.part11),s.part10=new e.SASprite(i,0,0,"level6","roofPart7 instance 10000"),s.part10.anchor.set(.5),s.group.addChild(s.part10),s.part9=new e.SASprite(i,0,0,"level6","roofPart6 instance 10000"),s.part9.anchor.set(.5),s.group.addChild(s.part9),s.part8=new e.SASprite(i,0,0,"level6","roofPart5 instance 10000"),s.part8.anchor.set(.5),s.group.addChild(s.part8),s.part7=new e.SASprite(i,0,0,"level6","roofPart7 instance 10000"),s.part7.anchor.set(.5),s.group.addChild(s.part7),s.part6=new e.SASprite(i,0,0,"level6","roofPart6 instance 10000"),s.part6.anchor.set(.5),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level6","roofPart5 instance 10000"),s.part5.anchor.set(.5),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level6","roofPart4 instance 10000"),s.part4.anchor.set(.5),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level6","roofPart3 instance 10000"),s.part3.anchor.set(.5),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level6","roofPart2 instance 10000"),s.part2.anchor.set(.5),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level6","roofPart1 instance 10000"),s.part1.anchor.set(.5),s.group.addChild(s.part1),s.setParts("magic"),s}return __extends(i,t),i.prototype.use=function(){this.playAnim("magic"),this.magic.playAnim("magic")},i.prototype.addTopMagic=function(){this.magic=new e.Lvl6Magic(e.Main.instance),e.GameManager.instance.level.updateElements.push(this.magic)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"magic"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,14,{x:-17,y:-31,skX:53,skY:53,scY:1.01},!0),e.GameManager.instance.level.setSimpleTween(this.part3,14,{x:-19,y:-9,skX:19,skY:19,scY:1.03},!0),e.GameManager.instance.level.setSimpleTween(this.part5,14,{x:-40,y:-36,skX:15,skY:-165},!0),e.GameManager.instance.level.setSimpleTween(this.part6,14,{x:-55,y:-13,skX:38,skY:-142},!0),e.GameManager.instance.level.setSimpleTween(this.part8,14,{x:40,y:-37,skX:-15,skY:-15},!0),e.GameManager.instance.level.setSimpleTween(this.part9,14,{x:55,y:-14,skX:-43,skY:-43},!0),e.GameManager.instance.level.setSimpleTween(this.part11,14,{x:-18,y:-21,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.part12,14,{x:49,y:-26,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.part13,14,{x:-51,y:-27,alpha:1},!0)):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,16,{x:-16,y:-37,skX:43,skY:43,scY:1.26},!0),e.GameManager.instance.level.setSimpleTween(this.part3,16,{scY:1.06},!0),e.GameManager.instance.level.setSimpleTween(this.part5,16,{x:-39,y:-41,skX:1,skY:-179},!0),e.GameManager.instance.level.setSimpleTween(this.part6,16,{x:-54,y:-14,skX:42,skY:-138},!0),e.GameManager.instance.level.setSimpleTween(this.part8,16,{x:39,y:-42,skX:-3,skY:-3},!0),e.GameManager.instance.level.setSimpleTween(this.part9,16,{x:54,skX:-48,skY:-48},!0),e.GameManager.instance.level.setSimpleTween(this.part11,16,{y:-23},!0),e.GameManager.instance.level.setSimpleTween(this.part12,16,{x:46,y:-27},!0),e.GameManager.instance.level.setSimpleTween(this.part13,16,{x:-49,y:-29},!0)):31===this.counterAnim?(this.setPart(this.part1,{x:0,y:17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part2,{x:-16,y:-37,angle:0,scX:1,scY:1.26,skX:43,skY:43,alpha:1},!0),this.setPart(this.part3,{x:-19,y:-9,angle:0,scX:1,scY:1.06,skX:19,skY:19,alpha:1},!0),this.setPart(this.part4,{x:-17,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part5,{x:-39,y:-41,angle:0,scX:1,scY:1,skX:1,skY:-179,alpha:1},!0),this.setPart(this.part6,{x:-54,y:-14,angle:0,scX:1,scY:1,skX:42,skY:-138,alpha:1},!0),this.setPart(this.part7,{x:-49,y:-3,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.part8,{x:39,y:-42,angle:0,scX:1,scY:1,skX:-3,skY:-3,alpha:1},!0),this.setPart(this.part9,{x:54,y:-14,angle:0,scX:1,scY:1,skX:-48,skY:-48,alpha:1},!0),this.setPart(this.part10,{x:50,y:-3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part11,{x:-18,y:-23,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part12,{x:46,y:-27,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part13,{x:-49,y:-29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part14,{x:0,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0)):46===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:-22,y:-23,skX:62,skY:62,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:-21,y:-8,skX:0,skY:0,scY:1},!0),e.GameManager.instance.level.setSimpleTween(this.part5,15,{x:-58,y:-27,skX:0,skY:180},!0),e.GameManager.instance.level.setSimpleTween(this.part6,15,{x:-59,y:-7,skX:0,skY:180},!0),e.GameManager.instance.level.setSimpleTween(this.part8,15,{x:59,y:-27,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.part9,15,{x:60,y:-7,skX:0,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.part11,15,{x:-22,y:-17,alpha:0},!0),e.GameManager.instance.level.setSimpleTween(this.part12,15,{x:62,y:-18,alpha:0},!0),e.GameManager.instance.level.setSimpleTween(this.part13,15,{x:-63,y:-18,alpha:0},!0)):61===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"magic"===e&&(this.setPart(this.part1,{x:0,y:17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part2,{x:-22,y:-23,angle:0,scX:1,scY:1,skX:62,skY:62,alpha:1},!0),this.setPart(this.part3,{x:-21,y:-8,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part4,{x:-17,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part5,{x:-58,y:-27,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.part6,{x:-59,y:-7,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.part7,{x:-49,y:-3,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1},!0),this.setPart(this.part8,{x:59,y:-27,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part9,{x:60,y:-7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part10,{x:50,y:-3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part11,{x:-22,y:-17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0},!0),this.setPart(this.part12,{x:62,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0},!0),this.setPart(this.part13,{x:-63,y:-18,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0},!0),this.setPart(this.part14,{x:0,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0))},i.prototype.free=function(){this.group=null,this.part14=null,this.part13=null,this.part12=null,this.part11=null,this.part10=null,this.part9=null,this.part8=null,this.part7=null,this.part6=null,this.part5=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl6Roof=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var i=t.call(this)||this;return i.full=!1,i.musicPlay=!1,i.back=e.GameManager.instance.layerElements.create(592,300,"level6","barBack instance 10000"),i.back.anchor.set(.5),i.bar=e.Main.instance.make.sprite(-101,0,"level6","barProgress instance 10000"),i.bar.anchor.set(.5),i.back.addChild(i.bar),i.mask=new Phaser.Graphics(e.Main.instance,0,0),i.mask.beginFill(0,1),i.mask.drawRoundedRect(-51,-11,101,22,11),i.mask.endFill(),i.back.addChild(i.mask),i.bar.mask=i.mask,i.border=e.Main.instance.make.sprite(0,0,"level6","border instance 10000"),i.border.anchor.set(.5),i.back.addChild(i.border),i.help=e.GameManager.instance.layerElements.create(592,333,"level6","swordUI instance 10000"),i.help.anchor.set(.5),i.setProgress(0),i.hide(),i}return __extends(i,t),i.prototype.hide=function(){this.back.visible=!1,this.help.visible=!1,e.SoundManager.stopSFXLoop("s_lvl6_swordDrag")},i.prototype.show=function(){this.back.visible=!0,this.help.visible=!0},i.prototype.up=function(){!1===this.full&&e.Main.instance.add.tween(this.bar).to({x:-101},150,"Linear",!0),this.musicPlay=!1,e.SoundManager.stopSFXLoop("s_lvl6_swordDrag")},i.prototype.setProgress=function(t){this.bar.x+=t,this.bar.x>=0&&(this.bar.x=0,this.hide(),this.full=!0),0!==t&&!1===this.musicPlay&&(this.musicPlay=!0,e.SoundManager.playSFX("s_lvl6_swordDrag",!0))},i.prototype.free=function(){this.back=null,this.bar=null,this.mask=null,this.border=null,this.help=null},i}(e.BasicElement);e.Lvl6SwordUI=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a,n,o,r,l){var h=t.call(this)||this;h.currentSymbol=0,h.currentSymbol=l,h.group=new Phaser.Group(i),h.group.x=s,h.group.y=a,h.group.scale.x=n,e.GameManager.instance.layerElements.addChild(h.group),h.back=h.group.create(0,0,"level6","back instance 10000"),h.back.anchor.set(.5);var c=new Phaser.Graphics(i,0,0);return c.beginFill(0,1),c.drawRect(-20,-35,40,70),c.endFill(),h.group.addChild(c),h.symbol1=h.group.create(0,-105,"level6","symbol"+o+" instance 10000"),h.symbol1.animations.add("zero",Phaser.Animation.generateFrameNames("symbol"+o+" instance 1",0,0,"",4),30,!1),h.symbol1.animations.add("anim",Phaser.Animation.generateFrameNames("symbol"+o+" instance 1",0,39,"",4),30,!1).onComplete.add(function(){this.symbol1.play("zero"),this.handler.inputEnabled=!0,this.handler.frameName="handlerBody instance 10000",e.GameManager.instance.level.house.enableButton()},h),h.symbol1.anchor.set(.5),h.symbol1.mask=c,h.symbol2=h.group.create(0,5,"level6","symbol"+r+" instance 10000"),h.symbol2.animations.add("zero",Phaser.Animation.generateFrameNames("symbol"+r+" instance 1",0,0,"",4),30,!1),h.symbol2.animations.add("anim",Phaser.Animation.generateFrameNames("symbol"+r+" instance 1",0,39,"",4),30,!1).onComplete.add(function(){this.symbol2.play("zero"),this.handler.inputEnabled=!0,this.handler.frameName="handlerBody instance 10000",e.GameManager.instance.level.house.enableButton()},h),h.symbol2.anchor.set(.5),h.symbol2.mask=c,1===h.currentSymbol&&(h.symbol1.y=5,h.symbol2.y=105),h.window=h.group.create(0,0,"level6","window instance 10000"),h.window.anchor.set(.5),h.handler=i.make.button(25,-22,"level6",h.use,h,"handlerBody instance 10001","handlerBody instance 10000","handlerBody instance 10000","handlerBody instance 10000"),h.handler.anchor.set(0,.5),h.handler.angle=-45,h.group.addChild(h.handler),h.arm=h.group.create(25,-22,"level6","arm instance 10000"),h.arm.anchor.set(.5),h}return __extends(i,t),i.prototype.use=function(){this.changeSymbols(),this.handler.inputEnabled=!1,e.Main.instance.add.tween(this.handler).to({angle:45},100,"Linear",!0).onComplete.add(function(){e.Main.instance.add.tween(this.handler).to({angle:-45},300,"Linear",!0).onComplete.add(function(){this.handler.inputEnabled=!0},this)},this)},i.prototype.changeSymbols=function(){0===this.currentSymbol?(this.currentSymbol=1,e.Main.instance.add.tween(this.symbol1).to({y:5},400,"Linear",!0),e.Main.instance.add.tween(this.symbol2).to({y:105},400,"Linear",!0)):(this.currentSymbol=0,e.Main.instance.add.tween(this.symbol1).to({y:-105},400,"Linear",!0),e.Main.instance.add.tween(this.symbol2).to({y:5},400,"Linear",!0))},i.prototype.playAnim=function(){this.handler.inputEnabled=!1,this.handler.frameName="handlerBody instance 10002",1===this.currentSymbol?this.symbol1.play("anim"):this.symbol2.play("anim")},i.prototype.free=function(){this.group=null,this.window=null,this.back=null,this.symbol1=null,this.symbol2=null,this.arm=null,this.handler=null},i}(e.BasicElement);e.Lvl6Window=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.game=i,s.joints=new Array;var a=new Phaser.Physics.Box2D.Body(i,null,132,477,0);a.setRectangle(10,74),a.sensor=!0;var n=new Phaser.Physics.Box2D.Body(i,null,689,477,0);n.setRectangle(10,74),n.sensor=!0;var o=e.GameManager.instance.layerUpper.create(191,514,"level7","bridgePart instance 10000");i.physics.box2d.enable(o),o.body.setRectangle(120,10),o.body.angle=8.7,o.body.setCollisionCategory(e.FilterGroups.WALL);var r=e.GameManager.instance.layerUpper.create(300,527,"level7","bridgePart instance 10000");i.physics.box2d.enable(r),r.body.setRectangle(120,10),r.body.angle=5,r.body.setCollisionCategory(e.FilterGroups.WALL);var l=e.GameManager.instance.layerUpper.create(410,532,"level7","bridgePart instance 10000");i.physics.box2d.enable(l),l.body.setRectangle(120,10),l.body.setCollisionCategory(e.FilterGroups.WALL);var h=e.GameManager.instance.layerUpper.create(520,527,"level7","bridgePart instance 10000");i.physics.box2d.enable(h),h.body.setRectangle(120,10),h.body.angle=-5,h.body.setCollisionCategory(e.FilterGroups.WALL);var c=e.GameManager.instance.layerUpper.create(629,514,"level7","bridgePart instance 10000");i.physics.box2d.enable(c),c.body.setRectangle(120,10),c.body.angle=-8.5,c.body.setCollisionCategory(e.FilterGroups.WALL),s.joints.push(i.physics.box2d.revoluteJoint(a,o,0,28,-60,0)),s.joints.push(i.physics.box2d.revoluteJoint(o,r,55,0,-55,0)),s.joints.push(i.physics.box2d.revoluteJoint(r,l,55,0,-55,0)),s.joints.push(i.physics.box2d.revoluteJoint(l,h,55,0,-55,0)),s.joints.push(i.physics.box2d.revoluteJoint(h,c,55,0,-55,0)),s.joints.push(i.physics.box2d.revoluteJoint(c,n,60,0,0,28));var p=e.GameManager.instance.layerUpper.create(230,461,"level7","bridgePart1 instance 10000");i.physics.box2d.enable(p),p.body.setRectangle(204,10),p.body.angle=8.5,p.body.setCollisionCategory(e.FilterGroups.WALL),p.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR);var d=e.GameManager.instance.layerUpper.create(421,490,"level7","bridgePart2 instance 10000");d.pivot.set(3,-2),i.physics.box2d.enable(d),d.body.setRectangle(160,10),d.angle=2.7,d.body.setCollisionCategory(e.FilterGroups.WALL),d.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR);var u=e.GameManager.instance.layerUpper.create(328,498,"level7","bridgePart4 instance 10000");i.physics.box2d.enable(u),u.body.setRectangle(64,10),u.body.angle=-75.6,u.body.setCollisionCategory(e.FilterGroups.WALL),u.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR);var m=e.GameManager.instance.layerUpper.create(590,473,"level7","bridgePart3 instance 10000");m.pivot.y=4,i.physics.box2d.enable(m),m.body.setRectangle(180,10),m.body.angle=-8.9,m.body.setCollisionCategory(e.FilterGroups.WALL),m.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR);var g=e.GameManager.instance.layerUpper.create(499,504,"level7","bridgePart5 instance 10000");return i.physics.box2d.enable(g),g.body.setRectangle(50,10),g.body.angle=-84.8,g.body.setCollisionCategory(e.FilterGroups.WALL),g.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),s.joints.push(i.physics.box2d.revoluteJoint(a,p,4,-30,-95,0)),s.joints.push(i.physics.box2d.revoluteJoint(p,u,102,0,22,-3)),s.joints.push(i.physics.box2d.revoluteJoint(u,d,12,0,-90,0)),s.joints.push(i.physics.box2d.revoluteJoint(d,g,80,0,10,0)),s.joints.push(i.physics.box2d.revoluteJoint(g,m,17,0,-90,0)),s.joints.push(i.physics.box2d.revoluteJoint(m,n,95,0,-5,-18)),s.joints.push(i.physics.box2d.revoluteJoint(u,r,-32,0,20,0)),s.joints.push(i.physics.box2d.revoluteJoint(g,h,-25,0,-23,0)),a=null,n=null,o=null,r=null,l=null,h=null,c=null,p=null,u=null,d=null,g=null,m=null,s}return __extends(i,t),i.prototype.crash=function(){e.SoundManager.stopSFXLoop("s_lvl10_bridgeCreak"),e.SoundManager.playSFX("s_lvl10_bridgeFall");for(var t=0;t<this.joints.length;t++)this.game.physics.box2d.world.DestroyJoint(this.joints[t])},i.prototype.free=function(){this.game=null,this.joints=[],this.joints=null},i}(e.BasicElement);e.Lvl7Bridge=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this)||this;return a.active1=!1,a.active2=!1,a.active3=!1,a.level=s,a.btn1_1=e.GameManager.instance.layerUpper.create(743,570,"level7","btnRune1_1 instance 10000"),a.btn1_1.anchor.setTo(.5),a.btn1_1.name="btnRune1",a.btn1_1.inputEnabled=!0,a.btn1_1.input.useHandCursor=!0,a.btn1_1.events.onInputOut.add(a.out,a),a.btn1_1.events.onInputOver.add(a.over,a),a.btn1_1.events.onInputDown.add(a.down,a),a.btn1_2=i.make.sprite(-2,-2,"level7","btnRune1_2 instance 10000"),a.btn1_2.anchor.setTo(.5),a.btn1_1.addChild(a.btn1_2),a.btn2_1=e.GameManager.instance.layerUpper.create(757,641,"level7","btnRune2_1 instance 10000"),a.btn2_1.anchor.setTo(.5),a.btn2_1.name="btnRune2",a.btn2_1.inputEnabled=!0,a.btn2_1.input.useHandCursor=!0,a.btn2_1.events.onInputOut.add(a.out,a),a.btn2_1.events.onInputOver.add(a.over,a),a.btn2_1.events.onInputDown.add(a.down,a),a.btn2_2=i.make.sprite(-1,-1,"level7","btnRune2_2 instance 10000"),a.btn2_2.anchor.setTo(.5),a.btn2_1.addChild(a.btn2_2),a.btn3_1=e.GameManager.instance.layerUpper.create(766,727,"level7","btnRune3_1 instance 10000"),a.btn3_1.anchor.setTo(.5),a.btn3_1.name="btnRune3",a.btn3_1.inputEnabled=!0,a.btn3_1.input.useHandCursor=!0,a.btn3_1.events.onInputOut.add(a.out,a),a.btn3_1.events.onInputOver.add(a.over,a),a.btn3_1.events.onInputDown.add(a.down,a),a.btn3_2=i.make.sprite(-3,-5,"level7","btnRune3_2 instance 10000"),a.btn3_2.anchor.setTo(.5),a.btn3_1.addChild(a.btn3_2),a}return __extends(i,t),i.prototype.out=function(e,t){e.frameName=e.name+"_1 instance 10000","btnRune1"===e.name?this.btn1_2.scale.setTo(1):"btnRune2"===e.name?this.btn2_2.scale.setTo(1):"btnRune3"===e.name&&this.btn3_2.scale.setTo(1)},i.prototype.over=function(e,t){e.frameName=e.name+"_1 instance 10001","btnRune1"===e.name?this.btn1_2.scale.setTo(1.06):"btnRune2"===e.name?this.btn2_2.scale.setTo(1.06):"btnRune3"===e.name&&this.btn3_2.scale.setTo(1.06)},i.prototype.down=function(t,i){if(!0!==this.level.heroInWater)if(e.SoundManager.playSFX("s_lvl10_runeClick"),"btnRune1"===t.name){if(this.level.stoneVisible!==this.active1)return;!1===this.active1?this.btn1_2.frameName="btnRune1_2 instance 10001":this.btn1_2.frameName="btnRune1_2 instance 10000",this.active1=!this.active1,e.GameManager.instance.level.customAction(1)}else if("btnRune2"===t.name)!1===this.active2?this.btn2_2.frameName="btnRune2_2 instance 10001":this.btn2_2.frameName="btnRune2_2 instance 10000",this.active2=!this.active2,e.GameManager.instance.level.customAction(2);else if("btnRune3"===t.name){if(!0===this.level.magicBullet.active)return;!1===this.active3?this.btn3_2.frameName="btnRune3_2 instance 10001":this.btn3_2.frameName="btnRune3_2 instance 10000",this.active3=!this.active3,e.GameManager.instance.level.customAction(3)}},i.prototype.activateButton1=function(){this.active1=!0,this.btn1_2.frameName="btnRune1_2 instance 10001"},i.prototype.deactivateButton3=function(){this.active3=!1,this.btn3_2.frameName="btnRune3_2 instance 10000"},i.prototype.free=function(){this.btn1_1=null,this.btn1_2=null,this.btn2_1=null,this.btn2_2=null,this.btn3_1=null,this.btn3_2=null,this.level=null},i}(e.BasicElement);e.Lvl7Buttons=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.active=!1,s.counter=0,s.magicBridgeBodyActive=!1,s.stars=new Array,s.body=new Phaser.Physics.Box2D.Body(i,null,403,1e3,1),s.body.setRectangle(100,50,-2,-25),s.body.setCollisionMask(~e.FilterGroups.WALL),s.body.friction=2,s.group=i.make.group(),s.group.x=s.body.x,s.group.y=s.body.y,s.group.visible=!1,e.GameManager.instance.layerElements.addChild(s.group),s.flame=s.group.create(0,-14,"level7"),s.flame.anchor.x=.5,s.flame.animations.add("anim",Phaser.Animation.generateFrameNames("cloudPlatform3 instance 1",0,21,"",4),30,!0),s.flame.animations.play("anim"),s.cloud=s.group.create(-3,-40,"level7","cloudPlatform2 instance 10000"),s.cloud.anchor.setTo(.5),i.add.tween(s.cloud).to({y:[-36,-40]},400,Phaser.Easing.Linear.None,!0,0,-1),i.add.tween(s.cloud.scale).to({x:[1.06,1],y:[1.06,1]},1100,Phaser.Easing.Linear.None,!0,0,-1);var a=s.group.create(0,0,"level7","cloudPlatform1 instance 10000");a.anchor.setTo(.5);for(var n=0;n<6;n++)(a=s.group.create(0,0,"level7")).animations.add("anim",Phaser.Animation.generateFrameNames("starAnim instance 1",0,14,"",4),30,!0),a.animations.play("anim"),s.stars.push(a);return a=null,s.changeStarPos(),s}return __extends(i,t),i.prototype.setActivity=function(){!1===this.active?(this.group.visible=!0,this.body.y=e.GameManager.instance.hero.bodyBase.y+120,this.body.velocity.y=-50,this.counter=0,this.magicBridgeBodyActive=!1,e.SoundManager.playSFX("s_lvl10_cloudSpell",!0)):(this.group.visible=!1,this.body.y=1e3,this.body.velocity.y=0,e.GameManager.instance.hero.bodyBase.data.SetAwake(!0),e.SoundManager.stopSFXLoop("s_lvl10_cloudSpell")),this.active=!this.active},i.prototype.update=function(){!1!==this.active&&(this.group.y=this.body.y,this.body.y<=500&&(this.body.velocity.y=0),e.GameManager.instance.hero.bodyBase.y<=480&&!1===this.magicBridgeBodyActive&&(e.GameManager.instance.level.customAction(12),this.magicBridgeBodyActive=!0),this.counter+=1,20===this.counter&&(this.counter=0,this.changeStarPos()))},i.prototype.changeStarPos=function(){for(var t=0;t<this.stars.length;t++){var i=e.Tools.random(0,100);this.stars[t].y=-50+i,this.stars[t].x=(-60+e.Tools.random(0,80))*((100-i)/100)}},i.prototype.free=function(){this.group=null,this.flame=null,this.cloud=null,this.body=null,this.stars=[],this.stars=null},i}(e.BasicElement);e.Lvl7CloudPlatform=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function s(s){var a=t.call(this,s)||this;return a.group=new e.SAGroup(s,814,-106),e.GameManager.instance.layerUpper.addChild(a.group),a.dragonWing2=new e.Lvl3DragonWing(s,"_1"),a.group.addChild(a.dragonWing2.group),a.dragonLeg1_1=new e.SASprite(s,0,0,"dragon","dragonLeg1_1 instance 10000"),a.dragonLeg1_1.pivot.set(56,42),a.group.addChild(a.dragonLeg1_1),a.dragonLeg2_1=new e.SASprite(s,0,0,"dragon","dragonLeg2_1 instance 10000"),a.dragonLeg2_1.pivot.set(46,47),a.group.addChild(a.dragonLeg2_1),a.dragonBase=new e.SASprite(s,0,0,"dragon","dragonBase instance 10000"),a.dragonBase.pivot.set(61,39),a.group.addChild(a.dragonBase),a.dragonTail1=new e.SASprite(s,0,0,"dragon","dragonTail1 instance 10000"),a.dragonTail1.pivot.set(27,28),a.group.addChild(a.dragonTail1),a.dragonTail2=new e.SASprite(s,0,0,"dragon","dragonTail2 instance 10000"),a.dragonTail2.pivot.set(20,21),a.group.addChild(a.dragonTail2),a.dragonTail3=new e.SASprite(s,0,0,"dragon","dragonTail3 instance 10000"),a.dragonTail3.pivot.set(19,12),a.group.addChild(a.dragonTail3),a.dragonTail4=new e.SASprite(s,0,0,"dragon","dragonTail4 instance 10000"),a.dragonTail4.pivot.set(18,14),a.group.addChild(a.dragonTail4),a.dragonTail5=new e.SASprite(s,0,0,"dragon","dragonTail5 instance 10000"),a.dragonTail5.pivot.set(16,12),a.group.addChild(a.dragonTail5),a.dragonTail6=new e.SASprite(s,0,0,"dragon","dragonTail6 instance 10000"),a.dragonTail6.pivot.set(14,43),a.group.addChild(a.dragonTail6),a.dragonNeck3=new e.SASprite(s,0,0,"dragon","dragonNeck3 instance 10000"),a.dragonNeck3.pivot.set(23,36),a.group.addChild(a.dragonNeck3),a.dragonNeck2=new e.SASprite(s,0,0,"dragon","dragonNeck2 instance 10000"),a.dragonNeck2.pivot.set(23,38),a.group.addChild(a.dragonNeck2),a.dragonNeck1=new e.SASprite(s,0,0,"dragon","dragonNeck1 instance 10000"),a.dragonNeck1.pivot.set(19,29),a.group.addChild(a.dragonNeck1),a.dragonHead=new e.SASprite(s,0,0,"dragon","dragonHead instance 10000"),a.dragonHead.pivot.set(49,27),a.group.addChild(a.dragonHead),a.dragonEye=s.make.sprite(36,6,"dragon"),a.dragonEye.animations.add("anim",Phaser.Animation.generateFrameNames("dragonEye instance 1",0,0,"",4),30,!1),a.dragonEye.animations.add("anim2",Phaser.Animation.generateFrameNames("dragonEye instance 1",1,84,"",4),30,!0),a.dragonEye.animations.play("anim2"),a.dragonHead.addChild(a.dragonEye),a.dragonLeg1_2=new e.SASprite(s,0,0,"dragon","dragonLeg1_2 instance 10000"),a.dragonLeg1_2.pivot.set(56,42),a.group.addChild(a.dragonLeg1_2),a.dragonLeg2_2=new e.SASprite(s,0,0,"dragon","dragonLeg2_2 instance 10000"),a.dragonLeg2_2.pivot.set(46,47),a.group.addChild(a.dragonLeg2_2),a.dragonSeddle=new e.SASprite(s,0,0,"dragon","dragonSeddle instance 10000"),a.dragonSeddle.pivot.set(57,24),a.group.addChild(a.dragonSeddle),a.dragonMage=new i(s),a.group.addChild(a.dragonMage.group),a.dragonWing1=new e.Lvl3DragonWing(s),a.group.addChild(a.dragonWing1.group),a.setParts("appear"),a}return __extends(s,t),s.prototype.playAppear=function(){this.playAnim("appear"),this.dragonMage.play()},s.prototype.update=function(){t.prototype.update.call(this),this.dragonWing1.update(),this.dragonWing2.update(),this.dragonMage.update()},s.prototype.onAnimComplete=function(){"appear"===this.currAnim?(this.playAnim("dragon_cycle"),this.dragonWing1.playAnim("anim",3),this.dragonWing2.playAnim("anim",3),e.GameManager.instance.level.customAction(13)):"dragon_cycle"===this.currAnim?(this.playAnim("attack2"),this.dragonMage.playCast()):"attack2"===this.currAnim?this.playAnim("princess"):"princess"===this.currAnim&&(this.group.visible=!1)},s.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"appear"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,14,{x:-31,y:377,skX:44,skY:44}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,14,{x:-50,y:296,skX:-33,skY:-33}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,14,{x:-25,y:360,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,14,{x:44,y:406,skX:-40,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,14,{x:-12,y:431,skX:-48,skY:-47}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,14,{x:-148,y:381,skX:-30,skY:-30}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,14,{x:-117,y:386,skX:-113,skY:-113}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,14,{x:-87,y:380,skX:-114,skY:-114}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,14,{x:-67,y:390,skX:-47,skY:-47}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,14,{x:155,y:308,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,14,{x:131,y:349,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,14,{x:109,y:357,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,14,{x:85,y:366,skX:-23,skY:-23}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,14,{x:60,y:367,skX:-49,skY:-49}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,14,{x:31,y:368,skX:-46,skY:-46}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,14,{x:-14,y:393,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,14,{x:26,y:411,skX:-39,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,14,{x:-23,y:437,skX:-49,skY:-49}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,14,{x:-56,y:382,skX:25,skY:25})):15===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,15,{x:-90,y:425,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,15,{x:-77,y:342,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,15,{x:-78,y:412,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,15,{x:-30,y:479,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,15,{x:-102,y:479,skX:-9,skY:-8,scY:.75}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,15,{x:-189,y:374,skX:-33,skY:-33}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,15,{x:-168,y:393,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,15,{x:-141,y:412,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,15,{x:-129,y:424,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,15,{x:113,y:430,skX:34,skY:34}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,15,{x:75,y:459,skX:22,skY:22}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,15,{x:52,y:458,skX:11,skY:11}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,15,{x:27,y:457,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,15,{x:-2,y:451,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,15,{x:-29,y:440,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,15,{x:-80,y:446,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,15,{x:-50,y:478,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,15,{x:-105,y:476,skX:8,skY:8,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,15,{x:-116,y:420,skX:-1,skY:-1})):30===this.counterAnim&&this.animComplete():"dragon_cycle"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,22,{y:444}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,22,{y:361}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,22,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,22,{x:-32,y:499,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,22,{x:-93,y:501,skX:-26,skY:-25,scY:.88}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,22,{y:393}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,22,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,22,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,22,{y:443}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,22,{y:449}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,22,{y:478}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,22,{y:477}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,22,{y:476}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,22,{y:470}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,22,{y:459}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,22,{y:465}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,22,{y:497,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,22,{x:-106,y:502,skX:-27,skY:-27,scY:.89}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,22,{y:439})):23===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,22,{y:425}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,22,{y:342}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,22,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,22,{x:-30,y:479,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,22,{x:-90,y:480,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,22,{y:374}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,22,{y:393}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,22,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,22,{y:424}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,22,{y:430}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,22,{y:459}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,22,{y:458}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,22,{y:457}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,22,{y:451}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,22,{y:440}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,22,{y:446}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,22,{y:478}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,22,{y:483,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,22,{y:420})):45===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,19,{y:444}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,19,{y:360}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,19,{y:430}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,19,{x:-32,y:499,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,19,{x:-93,y:500,skX:-26,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,19,{y:392}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,19,{y:411}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,19,{y:430}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,19,{y:442}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,19,{y:448}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,19,{y:477}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,19,{y:476}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,19,{y:475}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,19,{y:469,scX:.93,scY:.93}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,19,{y:459}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,19,{y:465}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,19,{y:496}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,19,{y:501,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,19,{y:438})):64===this.counterAnim&&this.animComplete():"attack2"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,20,{x:-83,y:361,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,20,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,20,{y:501}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,20,{y:393}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,20,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,20,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,20,{y:443}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,20,{y:449}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,20,{y:478}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,20,{y:477}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,20,{y:476}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,20,{y:470,scX:.94,scY:.94}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,20,{y:497}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,20,{y:502}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,20,{y:439})):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,27,{y:425}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,27,{y:343}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,27,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,27,{x:-30,y:479,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,27,{x:-90,y:480,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,27,{y:374}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,27,{y:393}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,27,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,27,{y:424}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,27,{y:430}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,27,{y:459}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,27,{y:458}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,27,{y:457}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,27,{y:451}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,27,{y:440}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,27,{y:446}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,27,{y:478}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,27,{y:483,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,27,{y:420})):48===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,19,{y:444}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,19,{x:-76,y:366,skX:-9,skY:-9}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,19,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,19,{x:-32,y:499,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,19,{x:-93,y:501,skX:-26,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,19,{y:393}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,19,{y:412}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,19,{y:431}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,19,{y:443}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,19,{y:449}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,19,{y:478}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,19,{y:477}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,19,{y:476}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,19,{y:470}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,19,{y:459}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,19,{y:465}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,19,{y:497}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,19,{y:502,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,19,{y:439})):100===this.counterAnim&&this.animComplete():"princess"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,22,{x:-206,y:415,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,22,{x:-213,y:336,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,22,{x:-199,y:399,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,22,{x:-134,y:451,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,22,{x:-192,y:470,skX:-43,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,22,{x:-316,y:395,skX:-50,skY:-50}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,22,{x:-290,y:407,skX:-75,skY:-75}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,22,{x:-259,y:417,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,22,{x:-244,y:425,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,22,{x:-11,y:360,skX:17,skY:17}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,22,{x:-39,y:399,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,22,{x:-61,y:405,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,22,{x:-85,y:411,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,22,{x:-115,y:414,skX:-43,skY:-43}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,22,{x:-144,y:412,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,22,{x:-191,y:432,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,22,{x:-153,y:454,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,22,{x:-230,y:463,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,22,{x:-232,y:418,skX:-28,skY:-28})):23===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,14,{x:-209,y:403,skX:44,skY:44}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,14,{x:-206,y:323,skX:-15,skY:-15}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,14,{x:-200,y:388,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,14,{x:-142,y:447,skX:-28,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,14,{x:-201,y:459,skX:-36,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,14,{x:-315,y:370,skX:-43,skY:-43}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,14,{x:-291,y:385,skX:-68,skY:-68}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,14,{x:-261,y:399,skX:-51,skY:-51}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,14,{x:-247,y:408,skX:-35,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,14,{x:-8,y:371,skX:24,skY:24}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,14,{x:-41,y:406,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,14,{x:-63,y:409,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,14,{x:-88,y:413,skX:-11,skY:-11}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,14,{x:-118,y:412,skX:-37,skY:-37}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,14,{x:-146,y:407,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,14,{x:-196,y:422,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,14,{x:-160,y:448,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,14,{x:-262,y:447,skX:25,skY:25}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,14,{x:-235,y:403,skX:14,skY:14})):37===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,5,{x:-264,y:406,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,5,{x:-270,y:327,skX:-21,skY:-21}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,5,{x:-256,y:390,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,5,{x:-191,y:442,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,5,{x:-269,y:471,skX:-2,skY:-1}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,5,{x:-373,y:386,skX:-50,skY:-50}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,5,{x:-347,y:398,skX:-75,skY:-75}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,5,{x:-316,y:408,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,5,{x:-301,y:416,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,5,{x:-68,y:351,skX:17,skY:17}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,5,{x:-96,y:390,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,5,{x:-118,y:396,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,5,{x:-142,y:402,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,5,{x:-172,y:405,skX:-43,skY:-43}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,5,{x:-201,y:403,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,5,{x:-248,y:423,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,5,{x:-210,y:445,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,5,{x:-298,y:453,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,5,{x:-289,y:409,skX:-18,skY:-18})):42===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,14,{x:-306,y:281,skX:117,skY:117}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,14,{x:-280,y:206,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,14,{x:-292,y:270,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,14,{x:-258,y:346,skX:-7,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,14,{x:-312,y:329,skX:-14,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,14,{x:-394,y:213,skX:-23,skY:-23}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,14,{x:-377,y:236,skX:-48,skY:-48}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,14,{x:-353,y:259,skX:-31,skY:-31}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,14,{x:-344,y:273,skX:-14,skY:-14}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,14,{x:-106,y:322,skX:45,skY:45}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,14,{x:-149,y:343,skX:32,skY:32}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,14,{x:-171,y:339,skX:21,skY:21}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,14,{x:-196,y:333,skX:10,skY:10}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,14,{x:-224,y:322,skX:-16,skY:-16}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,14,{x:-248,y:307,skX:-13,skY:-13}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,14,{x:-300,y:304,skX:8,skY:8}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,14,{x:-276,y:341,skX:-7,skY:-7}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,14,{x:-344,y:317,skX:-22,skY:-22}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,14,{x:-330,y:272,skX:90,skY:90})):56===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,14,{x:-305,y:276,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,14,{x:-279,y:201}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,14,{x:-291,y:265}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,14,{x:-257,y:341}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,14,{x:-311,y:324}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,14,{x:-393,y:208}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,14,{x:-376,y:231}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,14,{x:-352,y:254}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,14,{x:-343,y:268}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,14,{x:-105,y:317}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,14,{x:-148,y:338}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,14,{x:-170,y:334}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,14,{x:-195,y:328}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,14,{x:-223,y:317}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,14,{x:-247,y:302}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,14,{x:-299,y:299}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,14,{x:-275,y:336}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,14,{x:-343,y:312}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,14,{x:-329,y:267,skX:9,skY:9})):70===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,15,{x:-322,y:192,skX:87,skY:87}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,15,{x:-310,y:113,skX:-12,skY:-12}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,15,{x:-309,y:179,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,15,{x:-263,y:247,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,15,{x:-319,y:240,skX:-24,skY:-23}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,15,{x:-420,y:140,skX:-33,skY:-33}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,15,{x:-399,y:160,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,15,{x:-372,y:178,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,15,{x:-360,y:190,skX:-25,skY:-25}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,15,{x:-118,y:196,skX:34,skY:34}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,15,{x:-156,y:225,skX:22,skY:22}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,15,{x:-179,y:224,skX:11,skY:11}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,15,{x:-204,y:224,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,15,{x:-233,y:217,skX:-26,skY:-26}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,15,{x:-260,y:207,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,15,{x:-312,y:213,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,15,{x:-281,y:245,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,15,{x:-353,y:234,skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,15,{x:-347,y:187,skX:72,skY:72})):85===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,10,{x:-319,y:221,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,10,{x:-307,y:142}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,10,{x:-306,y:208}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,10,{x:-260,y:276}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,10,{x:-316,y:269}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,10,{x:-417,y:169}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,10,{x:-396,y:189}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,10,{x:-369,y:207}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,10,{x:-357,y:219}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,10,{x:-115,y:225}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,10,{x:-153,y:254}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,10,{x:-176,y:253}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,10,{x:-201,y:253}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,10,{x:-230,y:246}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,10,{x:-257,y:236}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,10,{x:-309,y:242}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,10,{x:-278,y:274}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,10,{x:-350,y:263}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,10,{x:-344,y:216,skX:-1,skY:-1})):95===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.dragonWing1.group,14,{x:-376,y:35,skX:85,skY:85}),e.GameManager.instance.level.setSimpleTween(this.dragonMage.group,14,{x:-388,y:-43,skX:-29,skY:-29}),e.GameManager.instance.level.setSimpleTween(this.dragonSeddle,14,{x:-368,y:20,skX:-28,skY:-28}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_2,14,{x:-303,y:71,skX:-35,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_2,14,{x:-359,y:81,skX:-41,skY:-40}),e.GameManager.instance.level.setSimpleTween(this.dragonHead,14,{x:-485,y:16,skX:-50,skY:-50}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck1,14,{x:-459,y:28,skX:-75,skY:-75}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck2,14,{x:-428,y:38,skX:-58,skY:-58}),e.GameManager.instance.level.setSimpleTween(this.dragonNeck3,14,{x:-413,y:46,skX:-42,skY:-42}),e.GameManager.instance.level.setSimpleTween(this.dragonTail6,14,{x:-180,y:-20,skX:17,skY:17}),e.GameManager.instance.level.setSimpleTween(this.dragonTail5,14,{x:-208,y:19,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.dragonTail4,14,{x:-230,y:25,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.dragonTail3,14,{x:-254,y:31,skX:-18,skY:-18}),e.GameManager.instance.level.setSimpleTween(this.dragonTail2,14,{x:-284,y:34,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.dragonTail1,14,{x:-313,y:32,skX:-41,skY:-41}),e.GameManager.instance.level.setSimpleTween(this.dragonBase,14,{x:-360,y:53,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg2_1,14,{x:-321,y:74,skX:-34,skY:-34}),e.GameManager.instance.level.setSimpleTween(this.dragonLeg1_1,14,{x:-393,y:85,skX:-49,skY:-49}),e.GameManager.instance.level.setSimpleTween(this.dragonWing2.group,14,{x:-401,y:39,skX:67,skY:67})):109===this.counterAnim&&this.animComplete()))},s.prototype.setParts=function(e){"appear"===e?(this.setPart(this.dragonWing1.group,{x:150,y:300,angle:0,scX:.94,scY:.94,skX:-13,skY:-13}),this.setPart(this.dragonMage.group,{x:163,y:217,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonSeddle,{x:162,y:287,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonLeg2_2,{x:208,y:355,angle:0,scX:.94,scY:.88,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_2,{x:147,y:357,angle:0,scX:.94,scY:.88,skX:-26,skY:-25}),this.setPart(this.dragonHead,{x:49,y:245,angle:0,scX:.93,scY:.93,skX:-8,skY:-8}),this.setPart(this.dragonNeck1,{x:72,y:268,angle:0,scX:.93,scY:.93,skX:-58,skY:-58}),this.setPart(this.dragonNeck2,{x:99,y:287,angle:0,scX:.93,scY:.93,skX:-41,skY:-41}),this.setPart(this.dragonNeck3,{x:111,y:299,angle:0,scX:.94,scY:.94,skX:-25,skY:-25}),this.setPart(this.dragonTail6,{x:354,y:307,angle:0,scX:.93,scY:.93,skX:34,skY:34}),this.setPart(this.dragonTail5,{x:316,y:336,angle:0,scX:.93,scY:.93,skX:22,skY:22}),this.setPart(this.dragonTail4,{x:293,y:335,angle:0,scX:.93,scY:.93,skX:11,skY:11}),this.setPart(this.dragonTail3,{x:267,y:334,angle:0,scX:.93,scY:.93,skX:0,skY:0}),this.setPart(this.dragonTail2,{x:238,y:326,angle:0,scX:.94,scY:.94,skX:-26,skY:-26}),this.setPart(this.dragonTail1,{x:211,y:315,angle:0,scX:.94,scY:.94,skX:-24,skY:-24}),this.setPart(this.dragonBase,{x:160,y:321,angle:0,scX:.93,scY:.93,skX:-2,skY:-2}),this.setPart(this.dragonLeg2_1,{x:190,y:353,angle:0,scX:.84,scY:.96,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_1,{x:134,y:358,angle:0,scX:.89,scY:.89,skX:-27,skY:-27}),this.setPart(this.dragonWing2.group,{x:124,y:295,angle:0,scX:.94,scY:.94,skX:-1,skY:-1})):"dragon_cycle"===e?(this.setPart(this.dragonWing1.group,{x:-90,y:425,angle:0,scX:.94,scY:.94,skX:-13,skY:-13}),this.setPart(this.dragonMage.group,{x:-77,y:342,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonSeddle,{x:-78,y:412,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonLeg2_2,{x:-30,y:479,angle:0,scX:.94,scY:.88,skX:-21,skY:-21}),this.setPart(this.dragonLeg1_2,{x:-102,y:479,angle:0,scX:.94,scY:.75,skX:-9,skY:-8}),this.setPart(this.dragonHead,{x:-189,y:374,angle:0,scX:.93,scY:.93,skX:-33,skY:-33}),this.setPart(this.dragonNeck1,{x:-168,y:393,angle:0,scX:.93,scY:.93,skX:-58,skY:-58}),this.setPart(this.dragonNeck2,{x:-141,y:412,angle:0,scX:.93,scY:.93,skX:-41,skY:-41}),this.setPart(this.dragonNeck3,{x:-129,y:424,angle:0,scX:.94,scY:.94,skX:-25,skY:-25}),this.setPart(this.dragonTail6,{x:113,y:430,angle:0,scX:.93,scY:.93,skX:34,skY:34}),this.setPart(this.dragonTail5,{x:75,y:459,angle:0,scX:.93,scY:.93,skX:22,skY:22}),this.setPart(this.dragonTail4,{x:52,y:458,angle:0,scX:.93,scY:.93,skX:11,skY:11}),this.setPart(this.dragonTail3,{x:27,y:457,angle:0,scX:.93,scY:.93,skX:0,skY:0}),this.setPart(this.dragonTail2,{x:-2,y:451,angle:0,scX:.94,scY:.94,skX:-26,skY:-26}),this.setPart(this.dragonTail1,{x:-29,y:440,angle:0,scX:.94,scY:.94,skX:-24,skY:-24}),this.setPart(this.dragonBase,{x:-80,y:446,angle:0,scX:.93,scY:.93,skX:-2,skY:-2}),this.setPart(this.dragonLeg2_1,{x:-50,y:478,angle:0,scX:.84,scY:.96,skX:-9,skY:-9}),this.setPart(this.dragonLeg1_1,{x:-105,y:476,angle:0,scX:.89,scY:.74,skX:8,skY:8}),this.setPart(this.dragonWing2.group,{x:-116,y:420,angle:0,scX:.94,scY:.94,skX:-1,skY:-1})):"attack2"===e?(this.setPart(this.dragonWing1.group,{x:-90,y:444,angle:0,scX:.94,scY:.94,skX:-13,skY:-13}),this.setPart(this.dragonMage.group,{x:-77,y:360,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonSeddle,{x:-78,y:430,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonLeg2_2,{x:-32,y:499,angle:0,scX:.94,scY:.88,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_2,{x:-93,y:500,angle:0,scX:.94,scY:.88,skX:-26,skY:-25}),this.setPart(this.dragonHead,{x:-189,y:392,angle:0,scX:.93,scY:.93,skX:-33,skY:-33}),this.setPart(this.dragonNeck1,{x:-168,y:411,angle:0,scX:.93,scY:.93,skX:-58,skY:-58}),this.setPart(this.dragonNeck2,{x:-141,y:430,angle:0,scX:.93,scY:.93,skX:-41,skY:-41}),this.setPart(this.dragonNeck3,{x:-129,y:442,angle:0,scX:.94,scY:.94,skX:-25,skY:-25}),this.setPart(this.dragonTail6,{x:113,y:448,angle:0,scX:.93,scY:.93,skX:34,skY:34}),this.setPart(this.dragonTail5,{x:75,y:477,angle:0,scX:.93,scY:.93,skX:22,skY:22}),this.setPart(this.dragonTail4,{x:52,y:476,angle:0,scX:.93,scY:.93,skX:11,skY:11}),this.setPart(this.dragonTail3,{x:27,y:475,angle:0,scX:.93,scY:.93,skX:0,skY:0}),this.setPart(this.dragonTail2,{x:-2,y:469,angle:0,scX:.93,scY:.93,skX:-26,skY:-26}),this.setPart(this.dragonTail1,{x:-29,y:459,angle:0,scX:.94,scY:.94,skX:-24,skY:-24}),this.setPart(this.dragonBase,{x:-80,y:465,angle:0,scX:.93,scY:.93,skX:-2,skY:-2}),this.setPart(this.dragonLeg2_1,{x:-50,y:496,angle:0,scX:.84,scY:.96,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_1,{x:-106,y:501,angle:0,scX:.89,scY:.89,skX:-27,skY:-27}),this.setPart(this.dragonWing2.group,{x:-116,y:438,angle:0,scX:.94,scY:.94,skX:-1,skY:-1})):"princess"===e&&(this.setPart(this.dragonWing1.group,{x:-90,y:444,angle:0,scX:.94,scY:.94,skX:-13,skY:-13}),this.setPart(this.dragonMage.group,{x:-76,y:366,angle:0,scX:.94,scY:.94,skX:-9,skY:-9}),this.setPart(this.dragonSeddle,{x:-78,y:431,angle:0,scX:.94,scY:.94,skX:-10,skY:-10}),this.setPart(this.dragonLeg2_2,{x:-32,y:499,angle:0,scX:.94,scY:.88,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_2,{x:-93,y:501,angle:0,scX:.94,scY:.88,skX:-26,skY:-25}),this.setPart(this.dragonHead,{x:-189,y:393,angle:0,scX:.93,scY:.93,skX:-33,skY:-33}),this.setPart(this.dragonNeck1,{x:-168,y:412,angle:0,scX:.93,scY:.93,skX:-58,skY:-58}),this.setPart(this.dragonNeck2,{x:-141,y:431,angle:0,scX:.93,scY:.93,skX:-41,skY:-41}),this.setPart(this.dragonNeck3,{x:-129,y:443,angle:0,scX:.94,scY:.94,skX:-25,skY:-25}),this.setPart(this.dragonTail6,{x:113,y:449,angle:0,scX:.93,scY:.93,skX:34,skY:34}),this.setPart(this.dragonTail5,{x:75,y:478,angle:0,scX:.93,scY:.93,skX:22,skY:22}),this.setPart(this.dragonTail4,{x:52,y:477,angle:0,scX:.93,scY:.93,skX:11,skY:11}),this.setPart(this.dragonTail3,{x:27,y:476,angle:0,scX:.93,scY:.93,skX:0,skY:0}),this.setPart(this.dragonTail2,{x:-2,y:470,angle:0,scX:.94,scY:.94,skX:-26,skY:-26}),this.setPart(this.dragonTail1,{x:-29,y:459,angle:0,scX:.94,scY:.94,skX:-24,skY:-24}),this.setPart(this.dragonBase,{x:-80,y:465,angle:0,scX:.93,scY:.93,skX:-2,skY:-2}),this.setPart(this.dragonLeg2_1,{x:-50,y:497,angle:0,scX:.84,scY:.96,skX:-17,skY:-17}),this.setPart(this.dragonLeg1_1,{x:-106,y:502,angle:0,scX:.89,scY:.89,skX:-27,skY:-27}),this.setPart(this.dragonWing2.group,{x:-116,y:439,angle:0,scX:.94,scY:.94,skX:-1,skY:-1}))},s.prototype.free=function(){this.group=null,this.dragonSeddle=null,this.dragonLeg2_2=null,this.dragonLeg1_2=null,this.dragonHead=null,this.dragonEye=null,this.dragonNeck1=null,this.dragonNeck2=null,this.dragonNeck3=null,this.dragonTail6=null,this.dragonTail5=null,this.dragonTail4=null,this.dragonTail3=null,this.dragonTail2=null,this.dragonTail1=null,this.dragonBase=null,this.dragonLeg2_1=null,this.dragonLeg1_1=null,this.dragonWing1.free(),this.dragonWing1=null,this.dragonWing2.free(),this.dragonWing2=null,this.dragonMage.free(),this.dragonMage=null},s}(e.BasicSimpleAnim);e.Lvl7Dragon=t;var i=function(t){function i(i){var s=t.call(this,i)||this;return s.group=new e.SAGroup(i,0,0),s.base=new e.SASprite(i,0,0,"dragon","dragonMageBase instance 10000"),s.base.pivot.set(55,33),s.group.addChild(s.base),s.eyes=new e.SASprite(i,0,0,"dragon","dragonMageEyes instance 10000"),s.eyes.pivot.set(14,16),s.eyes.animations.add("anim",Phaser.Animation.generateFrameNames("dragonMageEyes instance 1",0,107,"",4),30,!1),s.group.addChild(s.eyes),s.hat=new e.SASprite(i,0,0,"dragon","dragonMageHat instance 10000"),s.hat.pivot.set(23,87),s.group.addChild(s.hat),s.brown=new e.SASprite(i,0,0,"dragon","dragonMageBrown instance 10000"),s.brown.pivot.set(12,24),s.brown.animations.add("anim",Phaser.Animation.generateFrameNames("dragonMageBrown instance 1",0,107,"",4),30,!1),s.group.addChild(s.brown),s.scepter=new e.SASprite(i,0,0,"dragon","dragonMageScepter instance 10000"),s.scepter.pivot.set(22,59),s.group.addChild(s.scepter),s.castAnim=i.make.sprite(-430,145,"level3","magicBad1 instance 10000"),s.castAnim.animations.add("anim",Phaser.Animation.generateFrameNames("magicBad1 instance 1",0,24,"",4),30,!1).killOnComplete=!0,s.castAnim.angle=-30,s.castAnim.scale.x=1.4,s.group.addChild(s.castAnim),s.castAnim.visible=!1,s.setParts("cast"),s}return __extends(i,t),i.prototype.play=function(){this.setParts("cast"),this.eyes.animations.play("anim"),this.brown.animations.play("anim")},i.prototype.playCast=function(){this.playAnim("cast")},i.prototype.update=function(){t.prototype.update.call(this)},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"cast"===this.currAnim&&(1===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,20,{x:-92,y:34,skX:-102,skY:-102}):21===this.counterAnim?(this.castAnim.visible=!0,this.castAnim.animations.play("anim"),e.GameManager.instance.level.setSimpleTween(this.scepter,4,{x:-89,y:30,skX:-87,skY:-87})):25===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,4,{x:-92,y:34,skX:-102,skY:-102}):29===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,4,{x:-89,y:30,skX:-87,skY:-87}):33===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,4,{x:-92,y:34,skX:-102,skY:-102}):37===this.counterAnim?(e.GameManager.instance.level.customAction(14),e.GameManager.instance.level.setSimpleTween(this.scepter,4,{x:-89,y:30,skX:-87,skY:-87})):41===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,7,{x:-4,y:12,skX:25,skY:25}):48===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.scepter,19,{x:22,y:11}):67===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"cast"===e&&(this.setPart(this.scepter,{x:9,y:16,angle:0,scX:.94,scY:.94,skX:16,skY:16}),this.setPart(this.brown,{x:-48,y:19,angle:0,scX:.94,scY:.94,skX:-12,skY:-12}),this.setPart(this.hat,{x:-48,y:19,angle:0,scX:.94,scY:.94,skX:-12,skY:-12}),this.setPart(this.eyes,{x:-48,y:19,angle:0,scX:.94,scY:.94,skX:-12,skY:-12}),this.setPart(this.base,{x:-22,y:28,angle:0,scX:.94,scY:.94,skX:-5,skY:-5}))},i.prototype.free=function(){this.group=null,this.scepter=null,this.brown=null,this.hat=null,this.eyes=null,this.base=null,this.castAnim=null},i}(e.BasicSimpleAnim);e.Lvl7DragonMage=i}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.counterAnim1=0,s.counterAnim2=0,s.flower1_1=new e.SASprite(i,0,0,"level7","flower1_1 instance 10000"),s.flower1_1.anchor.setTo(.5),e.GameManager.instance.layerUpper.addChild(s.flower1_1),s.flower1_2=new e.SASprite(i,0,0,"level7","flower1_2 instance 10000"),s.flower1_2.anchor.setTo(.5),e.GameManager.instance.layerUpper.addChild(s.flower1_2),s.flower2_1=new e.SASprite(i,0,0,"level7","flower2_1 instance 10000"),s.flower2_1.anchor.setTo(.5),e.GameManager.instance.layerUpper.addChild(s.flower2_1),s.flower2_2=new e.SASprite(i,0,0,"level7","flower2_2 instance 10000"),s.flower2_2.anchor.setTo(.5),e.GameManager.instance.layerUpper.addChild(s.flower2_2),s.setParts(),s}return __extends(i,t),i.prototype.update=function(){this.updateAnimation1(),this.updateAnimation2()},i.prototype.updateAnimation1=function(){this.counterAnim1+=1,1===this.counterAnim1?(e.GameManager.instance.level.setSimpleTween(this.flower1_1,26,{x:230,y:856,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.flower1_2,26,{x:259,y:811,skX:-3,skY:-3})):27===this.counterAnim1?(e.GameManager.instance.level.setSimpleTween(this.flower1_1,25,{x:229,y:855,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.flower1_2,25,{x:258,y:810,skX:0,skY:0})):53===this.counterAnim1&&(this.counterAnim1=0)},i.prototype.updateAnimation2=function(){this.counterAnim2+=1,1===this.counterAnim2?(e.GameManager.instance.level.setSimpleTween(this.flower2_1,29,{x:122,y:815,skX:9,skY:9}),e.GameManager.instance.level.setSimpleTween(this.flower2_2,29,{x:142,y:854,skX:-3,skY:-3})):30===this.counterAnim2?(e.GameManager.instance.level.setSimpleTween(this.flower2_1,30,{x:124,y:814,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.flower2_2,30,{x:144,y:853,skX:0,skY:0})):60===this.counterAnim2&&(this.counterAnim2=0)},i.prototype.setParts=function(){this.setPart(this.flower1_1,{x:229,y:855,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.flower1_2,{x:258,y:810,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.flower2_1,{x:124,y:814,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.flower2_2,{x:144,y:853,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})},i.prototype.setPart=function(e,t){if(e)for(var i=0,s=Object.keys(t);i<s.length;i++){var a=s[i];e[a]=t[a]}},i.prototype.free=function(){this.flower1_1=null,this.flower1_2=null,this.flower2_1=null,this.flower2_2=null},i}(e.BasicElement);e.Lvl7Flowers=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.body=new Phaser.Physics.Box2D.Body(i,null,185,773,2),s.body.setRectangle(80,46).SetRestitution(.2),s.body.fixedRotation=!0,s.body.setCollisionMask(~e.FilterGroups.WALL),s.group=i.make.group(),s.group.x=s.body.x,s.group.y=s.body.y,e.GameManager.instance.layerUpper.addChild(s.group),s.lLeg3=new e.SASprite(i,0,0,"level7","frogLLeg2 instance 10000"),s.lLeg3.pivot.set(0,3),s.group.addChild(s.lLeg3),s.rLeg3=new e.SASprite(i,0,0,"level7","frogRLeg2 instance 10000"),s.rLeg3.pivot.set(0,2),s.group.addChild(s.rLeg3),s.legs=new e.SASprite(i,0,0,"level7","frogLegs instance 10000"),s.legs.pivot.set(39,12),s.group.addChild(s.legs),s.rLeg2=new e.SASprite(i,0,0,"level7","frogLeg2 instance 10000"),s.rLeg2.pivot.set(5,6),s.group.addChild(s.rLeg2),s.tors=new e.SASprite(i,0,0,"level7","frogTors instance 10000"),s.tors.pivot.set(23,23),s.group.addChild(s.tors),s.lLeg2=new e.SASprite(i,0,0,"level7","frogLeg2 instance 10000"),s.lLeg2.pivot.set(5,6),s.group.addChild(s.lLeg2),s.rEye1=new e.SASprite(i,0,0,"level7","frogEye1 instance 10000"),s.rEye1.pivot.set(9,10),s.group.addChild(s.rEye1),s.rEye2=new e.SASprite(i,0,0,"level7","frogEye2 instance 10000"),s.rEye2.pivot.set(3,3),s.group.addChild(s.rEye2),s.lLeg1=new e.SASprite(i,0,0,"level7","frogLLeg instance 10000"),s.group.addChild(s.lLeg1),s.rLeg1=new e.SASprite(i,0,0,"level7","frogRleg instance 10000"),s.group.addChild(s.rLeg1),s.lEye1=new e.SASprite(i,0,0,"level7","frogEye1 instance 10000"),s.lEye1.pivot.set(9,10),s.group.addChild(s.lEye1),s.lEye2=new e.SASprite(i,0,0,"level7","frogEye2 instance 10000"),s.lEye2.pivot.set(3,3),s.group.addChild(s.lEye2),s.mouth=new e.SASprite(i,0,0,"level7","frogMouth instance 10000"),s.mouth.pivot.set(13,17),s.group.addChild(s.mouth),s.crown=new e.SASprite(i,0,0,"level7","frogCrown instance 10000"),s.crown.pivot.set(22,14),s.group.addChild(s.crown),s.tongue=new e.SASprite(i,0,0,"level7","frogTongue instance 10000"),s.tongue.pivot.set(114,8),s.group.addChild(s.tongue),s.playAnim("idle",-1),s}return __extends(i,t),i.prototype.playAnim=function(i,s){void 0===s&&(s=0),t.prototype.playAnim.call(this,i,s),"jump"===i?(e.SoundManager.playSFX("s_lvl10_frogJump"),e.GameManager.instance.level.customAction(4),this.body.data.ApplyLinearImpulse(new box2d.b2Vec2(0,9.8),this.body.data.GetPosition())):"eat"===i&&e.SoundManager.playSFX("s_lvl10_frogEating")},i.prototype.onAnimComplete=function(){"eat"!==this.currAnim&&"jump"!==this.currAnim||this.playAnim("idle",-1)},i.prototype.update=function(){t.prototype.update.call(this),this.group.x=this.body.x,this.group.y=this.body.y},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"idle"===this.currAnim?49===this.counterAnim?(e.SoundManager.playSFX("s_lvl10_frogroaks"),e.GameManager.instance.level.setSimpleTween(this.crown,16,{y:-23,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.mouth,16,{scX:.32,scY:.32}),e.GameManager.instance.level.setSimpleTween(this.lEye2,16,{x:4,y:-1}),e.GameManager.instance.level.setSimpleTween(this.lEye1,16,{x:0,y:-3,skX:-11,skY:-11,scY:.71}),e.GameManager.instance.level.setSimpleTween(this.rLeg1,16,{skX:33,skY:33}),e.GameManager.instance.level.setSimpleTween(this.lLeg1,16,{x:-11,skX:-48,skY:-48}),e.GameManager.instance.level.setSimpleTween(this.rEye2,16,{x:18,y:-8}),e.GameManager.instance.level.setSimpleTween(this.rEye1,16,{x:15,y:-8,skX:-13,skY:-13,scY:.56}),e.GameManager.instance.level.setSimpleTween(this.lLeg2,16,{x:-10,y:27,skX:21,skY:21}),e.GameManager.instance.level.setSimpleTween(this.tors,16,{scX:1.13,scY:1.13}),e.GameManager.instance.level.setSimpleTween(this.rLeg2,16,{skX:-54,skY:143})):65===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.crown,6,{x:-3,y:-22,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.mouth,6,{scX:.25,scY:.25}),e.GameManager.instance.level.setSimpleTween(this.lEye2,6,{x:5}),e.GameManager.instance.level.setSimpleTween(this.lEye1,6,{x:1,y:-2,skX:-6,skY:-6,scY:.84}),e.GameManager.instance.level.setSimpleTween(this.rLeg1,6,{y:29,skX:52,skY:52}),e.GameManager.instance.level.setSimpleTween(this.lLeg1,6,{x:-7,skX:-65,skY:-65}),e.GameManager.instance.level.setSimpleTween(this.rEye2,6,{x:19,y:-7}),e.GameManager.instance.level.setSimpleTween(this.rEye1,6,{x:16,y:-7,skX:-7,skY:-7,scY:.64}),e.GameManager.instance.level.setSimpleTween(this.lLeg2,6,{x:-7,y:26,skX:11,skY:11}),e.GameManager.instance.level.setSimpleTween(this.tors,6,{scX:1.07,scY:1.07}),e.GameManager.instance.level.setSimpleTween(this.rLeg2,6,{skX:-49,skY:149})):71===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.crown,9,{x:-4,y:-23,skX:-6,skY:-6}),e.GameManager.instance.level.setSimpleTween(this.mouth,9,{scX:.32,scY:.32}),e.GameManager.instance.level.setSimpleTween(this.lEye2,9,{x:4}),e.GameManager.instance.level.setSimpleTween(this.lEye1,9,{x:0,y:-3,skX:-11,skY:-11,scY:.71}),e.GameManager.instance.level.setSimpleTween(this.rLeg1,9,{x:20,y:28,skX:21,skY:21}),e.GameManager.instance.level.setSimpleTween(this.lLeg1,9,{x:-11,y:36,skX:-39,skY:-39}),e.GameManager.instance.level.setSimpleTween(this.rEye2,9,{x:18,y:-8}),e.GameManager.instance.level.setSimpleTween(this.rEye1,9,{x:15,y:-8,skX:-13,skY:-13,scY:.56}),e.GameManager.instance.level.setSimpleTween(this.lLeg2,9,{x:-10,y:27,skX:21,skY:21}),e.GameManager.instance.level.setSimpleTween(this.tors,9,{scX:1.13,scY:1.13}),e.GameManager.instance.level.setSimpleTween(this.rLeg2,9,{skX:-54,skY:143})):80===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.crown,8,{x:-2,y:-20,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.mouth,8,{scX:.16,scY:.16}),e.GameManager.instance.level.setSimpleTween(this.lEye2,8,{x:6,y:0}),e.GameManager.instance.level.setSimpleTween(this.lEye1,8,{x:2,y:-1,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.rLeg1,8,{x:18,y:29}),e.GameManager.instance.level.setSimpleTween(this.lLeg1,8,{x:-3,y:35,skX:-44,skY:-44}),e.GameManager.instance.level.setSimpleTween(this.rEye2,8,{x:19,y:-6}),e.GameManager.instance.level.setSimpleTween(this.rEye1,8,{x:17,y:-6,skX:0,skY:0,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.lLeg2,8,{x:-5,y:25,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.tors,8,{scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.rLeg2,8,{x:19,skX:-42,skY:156})):88===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.mouth,5,{y:10}),e.GameManager.instance.level.setSimpleTween(this.lEye2,5,{x:4,y:2,skX:0,skY:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.rLeg1,5,{x:19,skX:45,skY:45}),e.GameManager.instance.level.setSimpleTween(this.lLeg1,5,{skX:-54,skY:-54}),e.GameManager.instance.level.setSimpleTween(this.rEye2,5,{y:-4,skX:0,skY:0,scY:.74})):93===this.counterAnim?(this.setPart(this.crown,{x:-2,y:-20,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.mouth,{x:17,y:10,angle:0,scX:.16,scY:.16,skX:11,skY:11,alpha:1}),this.setPart(this.lEye2,{x:4,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.lEye1,{x:2,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg1,{x:19,y:29,angle:0,scX:1,scY:1,skX:45,skY:45,alpha:1}),this.setPart(this.lLeg1,{x:-3,y:35,angle:0,scX:1,scY:1,skX:-54,skY:-54,alpha:1}),this.setPart(this.rEye2,{x:19,y:-4,angle:0,scX:.74,scY:.74,skX:0,skY:0,alpha:1}),this.setPart(this.rEye1,{x:17,y:-6,angle:0,scX:.74,scY:.74,skX:0,skY:0,alpha:1}),this.setPart(this.lLeg2,{x:-5,y:25,angle:0,scX:1.21,scY:1.21,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:3,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg2,{x:19,y:26,angle:0,scX:1,scY:1.05,skX:-42,skY:156,alpha:1}),this.setPart(this.legs,{x:-1,y:21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):105===this.counterAnim&&this.animComplete():"eat"===this.currAnim?1===this.counterAnim?(this.setPart(this.tongue,{x:30,y:0,angle:0,scX:.19,scY:.77,skX:-28,skY:-28,alpha:0}),e.GameManager.instance.level.setSimpleTween(this.crown,10,{x:-5,y:-25,skX:-8,skY:-8}),e.GameManager.instance.level.setSimpleTween(this.mouth,10,{skX:13,skY:52,scX:.96,scY:1.09}),e.GameManager.instance.level.setSimpleTween(this.lEye2,10,{x:6,y:-7,skX:-3,skY:-3,scX:.9,scY:1.43}),e.GameManager.instance.level.setSimpleTween(this.lEye1,10,{x:1,y:-7,scX:1.06,scY:1.06}),this.setPart(this.rLeg1,{x:19,y:29,angle:0,scX:1,scY:1,skX:45,skY:45,alpha:1}),this.setPart(this.lLeg1,{x:-3,y:35,angle:0,scX:1,scY:1,skX:-54,skY:-54,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.rEye2,10,{x:20,y:-13,skX:-3,skY:-3,scX:.79,scY:1.02}),e.GameManager.instance.level.setSimpleTween(this.rEye1,10,{y:-12,scX:.79,scY:.79}),e.GameManager.instance.level.setSimpleTween(this.tors,10,{y:6,scX:1.13,scY:1.13}),this.setPart(this.rLeg3,{x:18,y:39,angle:0,scX:1,scY:1,skX:-73,skY:-73,alpha:1}),this.setPart(this.lLeg3,{x:-16,y:28,angle:0,scX:1,scY:1,skX:57,skY:57,alpha:1})):5===this.counterAnim?(this.tongue.alpha=1,e.GameManager.instance.level.customAction(9),e.GameManager.instance.level.setSimpleTween(this.tongue,6,{x:109,y:-39,skX:-27,skY:-27,scX:1,scY:1})):11===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tongue,10,{x:27,y:2,scX:.18}),this.setPart(this.crown,{x:-5,y:-25,angle:0,scX:1,scY:1,skX:-8,skY:-8,alpha:1}),this.setPart(this.mouth,{x:17,y:10,angle:0,scX:.96,scY:1.09,skX:13,skY:52,alpha:1}),this.setPart(this.lEye2,{x:6,y:-7,angle:0,scX:.9,scY:1.43,skX:-3,skY:-3,alpha:1}),this.setPart(this.lEye1,{x:1,y:-7,angle:0,scX:1.06,scY:1.06,skX:0,skY:0,alpha:1}),this.setPart(this.rEye2,{x:20,y:-13,angle:0,scX:.79,scY:1.02,skX:-3,skY:-3,alpha:1}),this.setPart(this.rEye1,{x:17,y:-12,angle:0,scX:.79,scY:.79,skX:0,skY:0,alpha:1}),this.setPart(this.lLeg2,{x:-5,y:25,angle:0,scX:1.21,scY:1.21,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:3,y:6,angle:0,scX:1.13,scY:1.13,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg2,{x:19,y:26,angle:0,scX:1,scY:1.05,skX:-42,skY:156,alpha:1}),this.setPart(this.legs,{x:-1,y:21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):21===this.counterAnim?this.setPart(this.tongue,{x:27,y:2,angle:0,scX:.18,scY:1,skX:-27,skY:-27,alpha:1}):22===this.counterAnim?this.setPart(this.tongue,{x:8,y:15,angle:0,scX:.04,scY:1,skX:-27,skY:-27,alpha:0}):26===this.counterAnim?(e.GameManager.instance.level.customAction(11),this.tongue.visible=!1):29===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.crown,7,{x:-2,y:-20,skX:-2,skY:-2}),e.GameManager.instance.level.setSimpleTween(this.mouth,7,{skX:11,skY:11,scX:.16,scY:.16}),e.GameManager.instance.level.setSimpleTween(this.lEye2,7,{x:4,y:2,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.lEye1,7,{x:2,y:-1,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.rEye2,7,{x:19,y:-4,skX:0,skY:0,scX:.74,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.rEye1,7,{y:-6,scX:.74,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.tors,7,{y:7,scX:1.07,scY:1.07})):36===this.counterAnim?(this.setPart(this.crown,{x:-2,y:-20,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.mouth,{x:17,y:10,angle:0,scX:.16,scY:.16,skX:11,skY:11,alpha:1}),this.setPart(this.lEye2,{x:4,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.lEye1,{x:2,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rEye2,{x:19,y:-4,angle:0,scX:.74,scY:.74,skX:0,skY:0,alpha:1}),this.setPart(this.rEye1,{x:17,y:-6,angle:0,scX:.74,scY:.74,skX:0,skY:0,alpha:1}),this.setPart(this.lLeg2,{x:-5,y:25,angle:0,scX:1.21,scY:1.21,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:3,y:7,angle:0,scX:1.07,scY:1.07,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg2,{x:19,y:26,angle:0,scX:1,scY:1.05,skX:-42,skY:156,alpha:1}),this.setPart(this.legs,{x:-1,y:21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):43===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.mouth,7,{scX:.35,scY:.35}),e.GameManager.instance.level.setSimpleTween(this.lEye2,4,{x:2,y:-1,scX:1.16,scY:1.16}),e.GameManager.instance.level.setSimpleTween(this.rEye2,4,{x:17,y:-6,scX:.97,scY:.97})):47===this.counterAnim?(this.setPart(this.lEye2,{x:2,y:-1,angle:0,scX:1.16,scY:1.16,skX:0,skY:0,alpha:1}),this.setPart(this.rEye2,{x:17,y:-6,angle:0,scX:.97,scY:.97,skX:0,skY:0,alpha:1})):50===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.mouth,8,{scX:.16,scY:.16}):58===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.mouth,8,{scX:.29,scY:.29}):66===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.mouth,7,{scX:.16,scY:.16}):73===this.counterAnim?this.setPart(this.mouth,{x:17,y:10,angle:0,scX:.16,scY:.16,skX:11,skY:11,alpha:1}):74===this.counterAnim&&this.animComplete():"jump"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.crown,6,{x:-1,y:-14}),e.GameManager.instance.level.setSimpleTween(this.lEye2,6,{x:3,y:3}),e.GameManager.instance.level.setSimpleTween(this.lEye1,6,{y:3}),e.GameManager.instance.level.setSimpleTween(this.rLeg1,6,{x:25,y:28,skX:56,skY:56}),e.GameManager.instance.level.setSimpleTween(this.lLeg1,6,{x:-16,y:37,skX:-64,skY:-64}),e.GameManager.instance.level.setSimpleTween(this.rEye2,6,{y:-2}),e.GameManager.instance.level.setSimpleTween(this.rEye1,6,{y:-2}),e.GameManager.instance.level.setSimpleTween(this.lLeg2,6,{x:-10,y:26,skX:54,skY:54}),e.GameManager.instance.level.setSimpleTween(this.tors,6,{y:11,scY:.87}),e.GameManager.instance.level.setSimpleTween(this.rLeg2,6,{x:21,y:25,skX:-67,skY:130}),e.GameManager.instance.level.setSimpleTween(this.legs,6,{y:25,scX:1.19,scY:.73}),e.GameManager.instance.level.setSimpleTween(this.rLeg3,6,{skX:-63,skY:-63}),e.GameManager.instance.level.setSimpleTween(this.lLeg3,6,{x:-19,y:27,skX:49,skY:49})):7===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.crown,3,{x:0,y:-39}),e.GameManager.instance.level.setSimpleTween(this.mouth,3,{y:8}),e.GameManager.instance.level.setSimpleTween(this.lEye2,3,{x:1,y:-20,skX:-1,skY:-1,scX:.84,scY:1.8}),e.GameManager.instance.level.setSimpleTween(this.lEye1,3,{x:0,y:-12,scY:1.52}),e.GameManager.instance.level.setSimpleTween(this.rLeg1,3,{x:5,y:35,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.lLeg1,3,{x:-3,y:36,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.rEye2,3,{x:15,y:-25,skX:-1,skY:-1,scX:.7,scY:1.51}),e.GameManager.instance.level.setSimpleTween(this.rEye1,3,{x:15,y:-20,scY:1.13}),e.GameManager.instance.level.setSimpleTween(this.lLeg2,3,{x:-2,y:30,skX:16,skY:16}),e.GameManager.instance.level.setSimpleTween(this.tors,3,{y:-2,scX:.95,scY:1.46}),e.GameManager.instance.level.setSimpleTween(this.rLeg2,3,{x:11,y:30,skX:-7,skY:180,scY:1.21}),e.GameManager.instance.level.setSimpleTween(this.legs,3,{x:2,y:15,scX:.79,scY:1.32}),e.GameManager.instance.level.setSimpleTween(this.rLeg3,3,{x:13,y:29,skX:19,skY:19}),e.GameManager.instance.level.setSimpleTween(this.lLeg3,3,{x:-18,y:35,skX:-27,skY:-27})):10===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.crown,14,{y:-31}),e.GameManager.instance.level.setSimpleTween(this.lEye2,14,{y:-13,scY:1.45}),e.GameManager.instance.level.setSimpleTween(this.lEye1,14,{y:-9,scY:1.22}),e.GameManager.instance.level.setSimpleTween(this.rLeg1,14,{x:6,y:31}),e.GameManager.instance.level.setSimpleTween(this.lLeg1,14,{x:-4,y:32}),e.GameManager.instance.level.setSimpleTween(this.rEye2,14,{y:-17,skY:0,scY:1.22}),e.GameManager.instance.level.setSimpleTween(this.rEye1,14,{y:-16,scY:.91}),e.GameManager.instance.level.setSimpleTween(this.lLeg2,14,{x:-4,y:25}),e.GameManager.instance.level.setSimpleTween(this.tors,14,{y:1,scY:1.24}),e.GameManager.instance.level.setSimpleTween(this.rLeg2,14,{x:13,y:26}),e.GameManager.instance.level.setSimpleTween(this.legs,14,{y:20,scX:.89,scY:.96}),e.GameManager.instance.level.setSimpleTween(this.rLeg3,14,{y:32,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.lLeg3,14,{y:32,skX:-1,skY:-1})):24===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.crown,5,{x:-1,y:-14}),e.GameManager.instance.level.setSimpleTween(this.mouth,5,{y:10}),e.GameManager.instance.level.setSimpleTween(this.lEye2,5,{x:3,y:3,skX:0,skY:0,scX:1.16,scY:1.16}),e.GameManager.instance.level.setSimpleTween(this.lEye1,5,{x:2,y:3,scY:1}),e.GameManager.instance.level.setSimpleTween(this.rLeg1,5,{x:20,y:30,skX:56,skY:56}),e.GameManager.instance.level.setSimpleTween(this.lLeg1,5,{x:-16,y:37,skX:-64,skY:-64}),e.GameManager.instance.level.setSimpleTween(this.rEye2,5,{x:17,y:-2,skX:0,scX:.97,scY:.97}),e.GameManager.instance.level.setSimpleTween(this.rEye1,5,{x:17,y:-2,scY:.74}),e.GameManager.instance.level.setSimpleTween(this.lLeg2,5,{x:-10,y:26,skX:54,skY:54}),e.GameManager.instance.level.setSimpleTween(this.tors,5,{y:11,scX:1.07,scY:.87}),e.GameManager.instance.level.setSimpleTween(this.rLeg2,5,{x:19,skX:-42,skY:156,scY:1.05}),e.GameManager.instance.level.setSimpleTween(this.legs,5,{x:-1,y:25,scX:1.19,scY:.73}),e.GameManager.instance.level.setSimpleTween(this.rLeg3,5,{x:20,y:39,skX:-89,skY:-89}),e.GameManager.instance.level.setSimpleTween(this.lLeg3,5,{x:-11,y:26,skX:84,skY:84})):29===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.crown,11,{x:-2,y:-20}),e.GameManager.instance.level.setSimpleTween(this.lEye2,11,{x:2,y:-1}),e.GameManager.instance.level.setSimpleTween(this.lEye1,11,{y:-1}),e.GameManager.instance.level.setSimpleTween(this.rLeg1,11,{x:19,y:29,skX:45,skY:45}),e.GameManager.instance.level.setSimpleTween(this.lLeg1,11,{x:-3,y:35,skX:-54,skY:-54}),e.GameManager.instance.level.setSimpleTween(this.rEye2,11,{y:-6}),e.GameManager.instance.level.setSimpleTween(this.rEye1,11,{y:-6}),e.GameManager.instance.level.setSimpleTween(this.lLeg2,11,{x:-5,y:25,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.tors,11,{y:7,scY:1.07}),e.GameManager.instance.level.setSimpleTween(this.legs,11,{y:21,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.rLeg3,11,{x:18,skX:-73,skY:-73}),e.GameManager.instance.level.setSimpleTween(this.lLeg3,11,{x:-16,y:28,skX:57,skY:57})):40===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"idle"===e?(this.tongue.visible=!1,this.setPart(this.crown,{x:-2,y:-20,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.mouth,{x:17,y:10,angle:0,scX:.16,scY:.16,skX:11,skY:11,alpha:1}),this.setPart(this.lEye2,{x:4,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.lEye1,{x:2,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg1,{x:19,y:28,angle:0,scX:1,scY:1,skX:56,skY:56,alpha:1}),this.setPart(this.lLeg1,{x:-3,y:36,angle:0,scX:1,scY:1,skX:-64,skY:-64,alpha:1}),this.setPart(this.rEye2,{x:19,y:-4,angle:0,scX:.74,scY:.74,skX:0,skY:0,alpha:1}),this.setPart(this.rEye1,{x:17,y:-6,angle:0,scX:.74,scY:.74,skX:0,skY:0,alpha:1}),this.setPart(this.lLeg2,{x:-5,y:25,angle:0,scX:1.21,scY:1.21,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:3,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg2,{x:19,y:26,angle:0,scX:1,scY:1.05,skX:-42,skY:156,alpha:1}),this.setPart(this.legs,{x:-1,y:21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg3,{x:18,y:39,angle:0,scX:1,scY:1,skX:-73,skY:-73,alpha:1}),this.setPart(this.lLeg3,{x:-16,y:28,angle:0,scX:1,scY:1,skX:57,skY:57,alpha:1})):"eat"===e?(this.tongue.visible=!0,this.setPart(this.tongue,{x:30,y:0,angle:0,scX:.19,scY:.77,skX:-28,skY:-28,alpha:0}),this.setPart(this.crown,{x:-2,y:-20,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.mouth,{x:17,y:10,angle:0,scX:.16,scY:.16,skX:11,skY:11,alpha:1}),this.setPart(this.lEye2,{x:4,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.lEye1,{x:2,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg1,{x:19,y:29,angle:0,scX:1,scY:1,skX:45,skY:45,alpha:1}),this.setPart(this.lLeg1,{x:-3,y:35,angle:0,scX:1,scY:1,skX:-54,skY:-54,alpha:1}),this.setPart(this.rEye2,{x:19,y:-4,angle:0,scX:.74,scY:.74,skX:0,skY:0,alpha:1}),this.setPart(this.rEye1,{x:17,y:-6,angle:0,scX:.74,scY:.74,skX:0,skY:0,alpha:1}),this.setPart(this.lLeg2,{x:-5,y:25,angle:0,scX:1.21,scY:1.21,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:3,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg2,{x:19,y:26,angle:0,scX:1,scY:1.05,skX:-42,skY:156,alpha:1}),this.setPart(this.legs,{x:-1,y:21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg3,{x:18,y:39,angle:0,scX:1,scY:1,skX:-73,skY:-73,alpha:1}),this.setPart(this.lLeg3,{x:-16,y:28,angle:0,scX:1,scY:1,skX:57,skY:57,alpha:1})):"jump"===e&&(this.tongue.visible=!1,this.setPart(this.crown,{x:-2,y:-20,angle:0,scX:1,scY:1,skX:-2,skY:-2,alpha:1}),this.setPart(this.mouth,{x:17,y:10,angle:0,scX:.16,scY:.16,skX:11,skY:11,alpha:1}),this.setPart(this.lEye2,{x:2,y:-1,angle:0,scX:1.16,scY:1.16,skX:0,skY:0,alpha:1}),this.setPart(this.lEye1,{x:2,y:-1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg1,{x:19,y:29,angle:0,scX:1,scY:1,skX:45,skY:45,alpha:1}),this.setPart(this.lLeg1,{x:-3,y:35,angle:0,scX:1,scY:1,skX:-54,skY:-54,alpha:1}),this.setPart(this.rEye2,{x:17,y:-6,angle:0,scX:.97,scY:.97,skX:0,skY:0,alpha:1}),this.setPart(this.rEye1,{x:17,y:-6,angle:0,scX:.74,scY:.74,skX:0,skY:0,alpha:1}),this.setPart(this.lLeg2,{x:-5,y:25,angle:0,scX:1.21,scY:1.21,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:3,y:7,angle:0,scX:1.07,scY:1.07,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg2,{x:19,y:26,angle:0,scX:1,scY:1.05,skX:-42,skY:156,alpha:1}),this.setPart(this.legs,{x:-1,y:21,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rLeg3,{x:18,y:39,angle:0,scX:1,scY:1,skX:-73,skY:-73,alpha:1}),this.setPart(this.lLeg3,{x:-16,y:28,angle:0,scX:1,scY:1,skX:57,skY:57,alpha:1}))},i.prototype.free=function(){this.group=null,this.tongue=null,this.crown=null,this.mouth=null,this.lEye2=null,this.lEye1=null,this.rLeg1=null,this.lLeg1=null,this.rEye2=null,this.rEye1=null,this.lLeg2=null,this.tors=null,this.rLeg2=null,this.legs=null,this.rLeg3=null,this.lLeg3=null,this.body=null},i}(e.BasicSimpleAnim);e.Lvl7Frog=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.stars=new Array,s.graphic=e.GameManager.instance.layerUpper.create(415,480,"level7"),s.graphic.anchor.x=.5,s.graphic.animations.add("show",Phaser.Animation.generateFrameNames("magicBridge instance 1",0,9,"",4),30,!1),s.graphic.visible=!1,s.body=new Phaser.Physics.Box2D.Body(i,null,405,540,0),s.body.setRectangle(110,10),s.body.addRectangle(110,10,-110,-6,e.Tools.toRad(7)),s.body.addRectangle(110,10,-220,-21,e.Tools.toRad(9)),s.body.addRectangle(110,10,110,-6,e.Tools.toRad(-7)),s.body.addRectangle(110,10,220,-21,e.Tools.toRad(-9)),s.body.data.SetActive(!1);for(var a=7,n=2*Math.abs(a)/16,o=-260,r=2*Math.abs(o)/16,l=0;l<17;l++){var h=e.Tools.toRad(a);s.stars.push(new e.Lvl7Star(i,s.graphic,s.body.x+Math.cos(h)*o-s.graphic.x,s.body.y+Math.sin(h)*o-s.graphic.y)),a-=n,o+=r}return s}return __extends(i,t),i.prototype.show=function(){this.graphic.visible=!0,this.graphic.animations.play("show"),e.SoundManager.playSFX("s_lvl10_createBridge");for(var t=0;t<this.stars.length;t++)this.stars[t].start();e.GameManager.instance.hero.bodyBase.y<=480&&this.activeteBody()},i.prototype.activeteBody=function(){!0===this.graphic.visible&&this.body.data.SetActive(!0)},i.prototype.hide=function(){this.body.data.SetActive(!1),this.graphic.visible=!1;for(var e=0;e<this.stars.length;e++)this.stars[e].stop()},i.prototype.update=function(){for(var e=0;e<this.stars.length;e++)this.stars[e].update()},i.prototype.free=function(){this.graphic=null,this.body=null;for(var e=0;e<this.stars.length;e++)this.stars[e].free();this.stars=[],this.stars=null},i}(e.BasicElement);e.Lvl7MagicBridge=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.active=!1,s.checkPointFrogJump=!1,s.graphic=e.GameManager.instance.layerElements.create(0,0,"level7"),s.graphic.anchor.setTo(.5),s.graphic.animations.add("anim",Phaser.Animation.generateFrameNames("magicBullet instance 1",0,56,"",4),30,!0),s.graphic.visible=!1,s.body=new Phaser.Physics.Box2D.Body(i,null,-100,-100),s.body.setCircle(19),s.body.kinematic=!0,s.body.sensor=!0,s}return __extends(i,t),i.prototype.blow=function(){e.SoundManager.playSFX("s_lvl10_createBridge"),this.active=!0,this.checkPointFrogJump=!1,this.graphic.visible=!0,this.graphic.animations.play("anim"),this.body.dynamic=!0,this.body.x=730,this.body.y=810,this.body.velocity.x=this.body.velocity.y=0,this.body.data.ApplyLinearImpulse(new box2d.b2Vec2(3.5,3.3),this.body.data.GetPosition())},i.prototype.update=function(){!1!==this.active&&(this.graphic.x=this.body.x,this.graphic.y=this.body.y,this.body.y>900&&this.deactive(),!1===this.checkPointFrogJump&&this.body.x<420&&(this.checkPointFrogJump=!0,e.GameManager.instance.level.customAction(7)))},i.prototype.deactive=function(){this.active=!1,this.body.kinematic=!0,this.graphic.visible=!1,this.graphic.animations.stop(),this.body.x=-100,this.body.y=-100,e.GameManager.instance.level.customAction(10)},i.prototype.free=function(){this.graphic=null,this.body=null},i}(e.BasicElement);e.Lvl7MagicBullet=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this,i)||this;return a.active=!0,a.counter=0,a.group=i.make.group(),a.group.x=380,a.group.y=700,e.GameManager.instance.layerUpper.addChildAt(a.group,e.GameManager.instance.layerUpper.getChildIndex(s.group)+1),a.wing2=new e.SASprite(i,0,0,"level7"),a.wing2.pivot.set(30,36),a.wing2.animations.add("anim",Phaser.Animation.generateFrameNames("mosquitoWing instance 1",0,7,"",4),30,!0),a.wing2.animations.add("anim2",Phaser.Animation.generateFrameNames("mosquitoWing instance 1",8,8,"",4),30,!1),a.wing2.animations.play("anim"),a.group.addChild(a.wing2),a.ass=new e.SASprite(i,0,0,"level7","mosquitoAss instance 10000"),a.ass.pivot.set(15,10),a.group.addChild(a.ass),a.tors=new e.SASprite(i,0,0,"level7","mosquitoTors instance 10000"),a.tors.pivot.set(11,12),a.group.addChild(a.tors),a.leg4=new e.SASprite(i,0,0,"level7","mosquitoLeg2 instance 10000"),a.leg4.pivot.set(4,16),a.group.addChild(a.leg4),a.leg3=new e.SASprite(i,0,0,"level7","mosquitoLeg2 instance 10000"),a.leg3.pivot.set(4,16),a.group.addChild(a.leg3),a.leg2=new e.SASprite(i,0,0,"level7","mosquitoLeg1 instance 10000"),a.leg2.pivot.set(3,14),a.group.addChild(a.leg2),a.leg1=new e.SASprite(i,0,0,"level7","mosquitoLeg1 instance 10000"),a.leg1.pivot.set(3,14),a.group.addChild(a.leg1),a.nose=new e.SASprite(i,0,0,"level7","mosquitoNose instance 10000"),a.nose.pivot.set(4,15),a.group.addChild(a.nose),a.eyes=new e.SASprite(i,0,0,"level7"),a.eyes.pivot.set(1,8),a.eyes.animations.add("anim",Phaser.Animation.generateFrameNames("mosquitoEyes instance 1",0,198,"",4),30,!0),a.eyes.animations.play("anim"),a.group.addChild(a.eyes),a.wing1=new e.SASprite(i,0,0,"level7"),a.wing1.pivot.set(30,36),a.wing1.animations.add("anim",Phaser.Animation.generateFrameNames("mosquitoWing instance 1",0,7,"",4),30,!0),a.wing1.animations.add("anim2",Phaser.Animation.generateFrameNames("mosquitoWing instance 1",8,8,"",4),30,!1),a.wing1.animations.play("anim"),a.group.addChild(a.wing1),a.setParts("anim"),a}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this),!0===this.active&&(this.counter+=1,70===this.counter?(this.active=!1,e.GameManager.instance.level.customAction(8)):150===this.counter&&(this.active=!1,e.LevelBuilder.instance.levelFailed()))},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing1,9,{x:-1,y:11,skX:-65,skY:-65}),e.GameManager.instance.level.setSimpleTween(this.eyes,9,{x:6,skX:-23,skY:-25,scX:1.09,scY:.76}),e.GameManager.instance.level.setSimpleTween(this.nose,9,{x:36,y:-18,skX:-83,skY:-83}),e.GameManager.instance.level.setSimpleTween(this.leg1,9,{x:30,y:0,skX:-89,skY:-89}),e.GameManager.instance.level.setSimpleTween(this.leg2,9,{x:29,y:-6,skX:-103,skY:-103}),e.GameManager.instance.level.setSimpleTween(this.leg3,9,{x:29,y:5,skX:-93,skY:-93}),e.GameManager.instance.level.setSimpleTween(this.leg4,9,{x:26,y:9,skX:-81,skY:-81}),e.GameManager.instance.level.setSimpleTween(this.tors,9,{x:12,y:-8,skX:-37,skY:-37,scX:1.13,scY:.8}),e.GameManager.instance.level.setSimpleTween(this.ass,9,{x:10,y:13,skX:-67,skY:-72,scX:1.06,scY:1.14}),e.GameManager.instance.level.setSimpleTween(this.wing2,9,{x:-4,y:8,skX:-51,skY:-51})):7===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.group,10,{x:190,y:780}):10===this.counterAnim?(this.wing1.animations.play("anim2"),this.wing2.animations.play("anim2"),e.GameManager.instance.level.setSimpleTween(this.wing1,10,{x:16,y:7,skX:-111,skY:-111,scX:.75,scY:.75}),e.GameManager.instance.level.setSimpleTween(this.eyes,10,{x:8,y:-16,scX:.82,scY:.58}),e.GameManager.instance.level.setSimpleTween(this.nose,10,{x:29,y:-14,skX:-95,skY:-95,scX:.75,scY:.75}),e.GameManager.instance.level.setSimpleTween(this.leg1,10,{x:25,y:-2,skX:-106,skY:-106,scX:.75,scY:.75}),e.GameManager.instance.level.setSimpleTween(this.leg2,10,{x:25,y:-5,skX:-111,skY:-111,scX:.75,scY:.75}),e.GameManager.instance.level.setSimpleTween(this.leg3,10,{x:25,y:1,skX:-112,skY:-112,scX:.75,scY:.75}),e.GameManager.instance.level.setSimpleTween(this.leg4,10,{x:23,y:4,skX:-102,skY:-102,scX:.75,scY:.75}),e.GameManager.instance.level.setSimpleTween(this.tors,10,{y:-5,scX:.85,scY:.61}),e.GameManager.instance.level.setSimpleTween(this.ass,10,{x:17,y:8,skX:-97,skY:-102,scX:.8,scY:.86}),e.GameManager.instance.level.setSimpleTween(this.wing2,10,{x:12,y:9,skX:-91,skY:-91,scX:.75,scY:.75})):20===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.wing1,10,{x:20,y:-5,skX:-172,skY:-172,scX:.6,scY:.6}),e.GameManager.instance.level.setSimpleTween(this.eyes,10,{x:6,y:-11,skX:-34,skY:-36,scX:.66,scY:.46}),e.GameManager.instance.level.setSimpleTween(this.nose,10,{x:23,y:-13,skX:-107,skY:-107,scX:.6,scY:.6}),e.GameManager.instance.level.setSimpleTween(this.leg1,10,{x:20,y:-4,skX:-131,skY:-131,scX:.6,scY:.6}),e.GameManager.instance.level.setSimpleTween(this.leg2,10,{x:20,skX:-128,skY:-128,scX:.6,scY:.6}),e.GameManager.instance.level.setSimpleTween(this.leg3,10,{x:21,y:-2,skX:-135,skY:-135,scX:.6,scY:.6}),e.GameManager.instance.level.setSimpleTween(this.leg4,10,{x:21,y:0,skX:-125,skY:-125,scX:.6,scY:.6}),e.GameManager.instance.level.setSimpleTween(this.tors,10,{x:11,y:-3,skX:-48,skY:-48,scX:.68,scY:.49}),e.GameManager.instance.level.setSimpleTween(this.ass,10,{x:19,y:1,skX:-139,skY:-145,scX:.64,scY:.69}),e.GameManager.instance.level.setSimpleTween(this.wing2,10,{x:21,y:-9,skX:174,skY:174,scX:.6,scY:.6})):30===this.counterAnim&&this.animComplete()))},i.prototype.eated=function(){this.activeAnim=!1,this.group.visible=!1,this.active=!0},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.wing1,{x:-12,y:-9,angle:0,scX:1,scY:1,skX:6,skY:6,alpha:1}),this.setPart(this.eyes,{x:16,y:-23,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.nose,{x:32,y:5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.leg1,{x:19,y:20,angle:0,scX:1,scY:1,skX:9,skY:9,alpha:1}),this.setPart(this.leg2,{x:23,y:19,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.leg3,{x:13,y:20,angle:0,scX:1,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.leg4,{x:9,y:20,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tors,{x:17,y:-5,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.ass,{x:-3,y:4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.wing2,{x:-10,y:-15,angle:0,scX:1,scY:1,skX:20,skY:20,alpha:1}))},i.prototype.free=function(){this.group=null,this.wing1=null,this.eyes=null,this.nose=null,this.leg1=null,this.leg2=null,this.leg3=null,this.leg4=null,this.tors=null,this.ass=null,this.wing2=null},i}(e.BasicSimpleAnim);e.Lvl7Mosquito=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.pressed=!1,s.treeStY=306,s.game=i,s.tree=e.GameManager.instance.layerBackground.create(0,s.treeStY,"level7","questTree instance 10000");var a=i.make.group();a.x=75,a.y=723,e.GameManager.instance.layerUpper.addChild(a),s.treeRoot=i.make.button(0,0,"level7",s.rootUp,s,"questTreeRoot instance 10001","questTreeRoot instance 10000"),s.treeRoot.onInputDown.add(s.rootDown,s),s.treeRoot.anchor.setTo(.5),a.addChild(s.treeRoot);var n=i.make.graphics(0,0);return n.beginFill(16711680,.4),n.drawRect(-18,-50,200,100),n.endFill(),a.addChild(n),a.mask=n,a=null,n=null,s.body=new Phaser.Physics.Box2D.Body(i,null,75,723,1),s.body.setRectangle(60,20),s.setBody(),s}return __extends(i,t),i.prototype.setBody=function(){this.body.x=this.treeRoot.x+75},i.prototype.rootDown=function(){this.pressed=!0,this.rootOffX=this.game.input.worldX-75-this.treeRoot.x},i.prototype.rootUp=function(){this.pressed=!1},i.prototype.update=function(){!1!==this.pressed&&(this.treeRoot.x=this.game.input.worldX-75-this.rootOffX,this.treeRoot.x<0?this.treeRoot.x=0:this.treeRoot.x>47&&(this.treeRoot.x=47),this.tree.y=this.treeStY+this.treeRoot.x)},i.prototype.free=function(){this.game=null,this.tree=null,this.treeRoot=null,this.body=null},i}(e.BasicElement);e.Lvl7QuestTree=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function t(t,s,a,n,o,r,l){this.stars=new Array;for(var h,c=2*o/l,p=a,d=0;d<l;d++)(h=new i(t,s,p,n+e.Tools.random(0,r))).start(),this.stars.push(h),p+=c;h=null}return t.prototype.show=function(){for(var e=0;e<this.stars.length;e++)this.stars[e].start()},t.prototype.hide=function(){for(var e=0;e<this.stars.length;e++)this.stars[e].stop()},t.prototype.update=function(){for(var e=0;e<this.stars.length;e++)this.stars[e].update()},t.prototype.free=function(){for(var e=0;e<this.stars.length;e++)this.stars[e].free();this.stars=[],this.stars=null},t}();e.Lvl7StarAnim=t;var i=function(){function t(e,t,i,s){this.counter=0,this.endDis=30,this.active=0,this.startY=s,this.graphic=e.make.sprite(i,s,"level7"),this.graphic.anchor.setTo(.5),this.graphic.animations.add("anim",Phaser.Animation.generateFrameNames("starAnim instance 1",0,14,"",4),30,!1).onComplete.add(this.animComplete,this),this.graphic.visible=!1,t.addChild(this.graphic)}return t.prototype.start=function(){this.active=1,this.counter=e.Tools.random(0,60),this.endCounter=e.Tools.random(60,80)},t.prototype.stop=function(){this.active=2},t.prototype.animComplete=function(){this.graphic.visible=!1},t.prototype.update=function(){0!==this.active&&(this.counter+=1,1===this.counter?(this.graphic.visible=!0,this.graphic.animations.play("anim"),this.graphic.y=this.startY):this.counter>=2&&this.counter<=30?this.graphic.y=this.startY+this.endDis*((this.counter-2)/30):this.counter>=this.endCounter&&(this.counter=0,this.endCounter=e.Tools.random(60,80),2===this.active&&(this.active=0)))},t.prototype.free=function(){this.graphic=null},t}();e.Lvl7Star=i}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.active=!0,s.counter=0,s.startAnim=!1,s.animShow=!1,s.graphic=e.GameManager.instance.layerUpper.create(405,882,"level7","stonePlatform instance 10000"),s.graphic.anchor.setTo(.5,1),s.starAnim=new e.Lvl7StarAnim(i,s.graphic,-70,-120,70,30,10),s.body=new Phaser.Physics.Box2D.Body(i,null,400,815,1),s.body.setRectangle(124,100),s.body.setCollisionMask(~e.FilterGroups.WALL),s.body.friction=2,s}return __extends(i,t),i.prototype.show=function(){this.starAnim.show(),this.counter=0,this.animShow=!0,this.startAnim=!0,this.graphic.visible=!0,e.GameManager.instance.level.setSimpleTween(this.graphic,16,{alpha:1})},i.prototype.hide=function(){this.starAnim.hide(),this.counter=0,this.animShow=!1,this.startAnim=!0,e.GameManager.instance.level.setSimpleTween(this.graphic,16,{alpha:0}),this.body.data.SetActive(!1)},i.prototype.update=function(){this.starAnim.update(),!0===this.startAnim&&(this.counter+=1,17===this.counter&&(!0===this.animShow?(e.GameManager.instance.level.customAction(5),this.body.data.SetActive(!0)):(e.GameManager.instance.level.customAction(6),this.graphic.visible=!1),this.startAnim=!1))},i.prototype.free=function(){this.graphic=null,this.body=null,this.starAnim.free(),this.starAnim=null},i}(e.BasicElement);e.Lvl7StonePlatform=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;s.speed=50,s.move=!1,s.floor=472,s.top=190,s.direction=0;var a=new Phaser.Graphics(i,570,100);return a.beginFill(0,1),a.drawRect(-10,0,20,360),a.endFill(),e.GameManager.instance.layerElements.addChild(a),s.rope=e.GameManager.instance.layerElements.create(570,165,"level8","rope instance 10000"),s.rope.anchor.set(.5,1),s.rope.mask=a,s.platform=e.GameManager.instance.layerElements.create(570,190,"level8","elevator instance 10000"),i.physics.box2d.enable(s.platform),s.platform.body.setRectangle(120,20,0,15),s.platform.body.kinematic=!0,s.wheel=e.GameManager.instance.layerUpper.create(570,70,"level8","wheel instance 10000"),s.wheel.anchor.set(.5),s}return __extends(i,t),i.prototype.moveTo=function(e){this.direction=e,0!==e?(this.move=!0,this.platform.body.velocity.y=this.speed*e):(this.move=!1,this.platform.body.setZeroVelocity())},i.prototype.update=function(){!0===this.move&&(this.platform.body.y>this.floor?(this.platform.body.y=this.floor,this.platform.body.setZeroVelocity(),this.move=!1):this.platform.body.y<this.top&&(this.platform.body.y=this.top,this.platform.body.setZeroVelocity(),this.move=!1),this.wheel.angle+=-2*this.direction),this.rope.y=this.platform.body.y-25},i.prototype.free=function(){this.rope=null,this.platform=null,this.wheel=null},i}(e.BasicElement);e.Lvl8Elevator=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this)||this;return s.level=0,s.direction=1,s.levelAngle=new Array,s.rotateSpeed=-1,s.startRotate=!1,s.levelAngle=[2,-31,-74],s.bigWheel=e.GameManager.instance.layerBackground.create(408,369,"level8","bigWheel instance 10000"),s.bigWheel.anchor.set(.5),s.bigWheel.angle=22,s.platform=i.make.sprite(438,305,"level8","platform instance 10000"),s.platform.pivot.set(115,0),i.physics.box2d.enable(s.platform),s.platform.body.setRectangle(280,40,-140,0,e.Tools.toRad(2)),s.platform.body.kinematic=!0,s.platform.body.angle=2,s.platform.body.friction=10,e.GameManager.instance.layerBackground.addChild(s.platform),s.rotateLevel=e.GameManager.instance.layerUpper.create(417,292,"level8","platformLevel instance 10000"),s.rotator=new Phaser.Group(i),s.rotator.x=474,s.rotator.y=305,e.GameManager.instance.layerUpper.addChild(s.rotator),s.lever=i.make.button(0,-15,"level8",s.rotatePlatform,s,"lever instance 10001","lever instance 10000","lever instance 10000","lever instance 10000"),s.lever.anchor.set(.5,1),s.rotator.addChild(s.lever),s.rotator.create(0,0,"level8","rotator instance 10000").pivot.set(39,26),s}return __extends(i,t),i.prototype.rotatePlatform=function(){(1===this.direction&&2===this.level||-1===this.direction&&0===this.level)&&(this.direction*=-1),e.SoundManager.playSFX("s_lvl7_armMove"),this.level+=this.direction,this.startRotate=!0,this.rotateLevel.frameName="platformLevel instance 10003",e.GameManager.instance.level.setWheelRotate(!1)},i.prototype.update=function(){!0===this.startRotate&&(this.rotator.angle+=this.direction*this.rotateSpeed,this.platform.body.angle=this.rotator.angle,this.bigWheel.angle-=this.direction*this.rotateSpeed,1===this.direction&&this.rotator.angle<this.levelAngle[this.level]?this.stopRotate():-1===this.direction&&this.rotator.angle>this.levelAngle[this.level]&&this.stopRotate())},i.prototype.stopRotate=function(){this.rotateLevel.frameName="platformLevel instance 1000"+this.level,this.rotator.angle=this.levelAngle[this.level],this.startRotate=!1,2===this.level&&e.GameManager.instance.level.setWheelRotate(!0)},i.prototype.free=function(){t.prototype.free.call(this),this.platform=null,this.rotator=null,this.lever=null,this.rotateLevel=null,this.levelAngle=[],this.levelAngle=null},i}(e.BasicElement);e.Lvl8Platform=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this)||this;n.direction=0,n.oldAngle=0,n.active=!0,n.game=i,n.group=new Phaser.Group(i),n.group.x=s,n.group.y=720,e.GameManager.instance.layerUpper.addChild(n.group),n.anim=n.group.create(-13,-5,"level8","ropeAnim instance 10000"),n.anim.animations.add("work1",Phaser.Animation.generateFrameNames("ropeAnim instance 1",0,4,"",4),30,!0),n.anim.animations.add("work2",Phaser.Animation.generateFrameNames("ropeAnim instance 1",4,0,"",4),30,!0),n.arm=n.game.make.sprite(0,0),n.arm.anchor.set(.5,.5),n.group.addChild(n.arm),n.button=n.game.make.sprite(30,0,"level8","lever instance 10000"),n.button.angle=90,n.button.anchor.set(.5),n.button.inputEnabled=!0,n.button.input.useHandCursor=!0,n.arm.addChild(n.button),n.button.events.onInputDown.add(n.down,n),n.button.events.onInputUp.add(n.up,n),n.button.events.onInputOver.add(n.over,n),n.button.events.onInputOut.add(n.out,n);var o=n.game.make.sprite(0,0,"level8","rotator2 instance 10000");return o.anchor.set(.5),n.arm.addChild(o),n}return __extends(i,t),i.prototype.show=function(){this.game.add.tween(this.group).to({y:490},1e3,Phaser.Easing.Linear.None,!0)},i.prototype.down=function(){this.buttonDown=!0},i.prototype.up=function(){this.buttonDown=!1,this.direction=0,this.anim.animations.stop()},i.prototype.over=function(){!0===this.active&&(this.button.frameName="lever instance 10001")},i.prototype.out=function(){!0===this.active&&(this.button.frameName="lever instance 10000")},i.prototype.getDirection=function(){return this.direction},i.prototype.update=function(){if(!0===this.buttonDown){var t=Phaser.Math.angleBetween(this.game.input.activePointer.x,this.game.input.activePointer.y,this.arm.world.x,this.arm.world.y);if(this.oldAngle===t)return this.anim.animations.stop(),void(this.direction=0);t>this.oldAngle?(this.anim.play("work1"),this.direction=-1):(this.anim.play("work2"),this.direction=1),this.arm.rotation=t-e.Tools.toRad(180),this.oldAngle=t}},i.prototype.free=function(){this.game=null,this.arm=null,this.button=null,this.group=null},i}(e.BasicElement);e.Lvl8RopeArm=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function t(t,i,s){this.parts=new Array;for(var a,n=i,o=s,r=0;r<4;r++){this.parts.push(new Array);for(var l=0;l<4;l++)(a=e.GameManager.instance.layerBackground0.create(n,o,"level9","bgMove instance 10000")).cacheAsBitmap=!0,this.parts[r].push(a),o+=210;n+=309,o=s}a=null,this.checkX(),this.checkY()}return t.prototype.move=function(e,t){0!==e&&this.checkX(),0!==t&&this.checkY();for(var i=0;i<this.parts.length;i++)for(var s=0;s<this.parts[i].length;s++)this.parts[i][s].x+=e,this.parts[i][s].y+=t},t.prototype.checkX=function(){for(var e=0;e<this.parts.length;e++)if(this.parts[e][0].x<=-309)for(t=0;t<this.parts[e].length;t++)this.parts[e][t].x+=1236;else if(this.parts[e][0].x>=927)for(var t=0;t<this.parts[e].length;t++)this.parts[e][t].x-=1236},t.prototype.checkY=function(){for(var e=0;e<this.parts[0].length;e++)if(this.parts[0][e].y<=-210)for(t=0;t<this.parts.length;t++)this.parts[t][e].y+=840;else if(this.parts[0][e].y>=630)for(var t=0;t<this.parts.length;t++)this.parts[t][e].y-=840},t.prototype.free=function(){this.parts=[],this.parts=null},t}();e.Lvl9Background=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this)||this;return a._x=0,a._y=0,a.game=i,a.id=s,a.groupBack=i.make.group(),e.GameManager.instance.layerBackground.addChild(a.groupBack),a.groupFront=i.make.group(),e.GameManager.instance.layerUpper.addChild(a.groupFront),a}return __extends(i,t),Object.defineProperty(i.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e,this.groupBack.x=this._x,this.groupFront.x=this._x,this.front.x=this._x},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e,this.groupBack.y=this._y,this.groupFront.y=this._y,this.front.y=this._y},enumerable:!0,configurable:!0}),i.prototype.createBg=function(){var e=this.groupBack.create(0,0,"level9_2","room"+this.id+" instance 10000");e.anchor.setTo(.5),e.cacheAsBitmap=!0,e=null},i.prototype.createDoors=function(){this.doors=new Array;var t=new e.Lvl9RoomDoor(this.game,1);t.group.y=-170,this.groupFront.addChild(t.group),this.doors.push(t),(t=new e.Lvl9RoomDoor(this.game,2)).group.angle=90,t.group.x=257,this.groupFront.addChild(t.group),this.doors.push(t),(t=new e.Lvl9RoomDoor(this.game,3)).group.angle=180,t.group.y=170,this.groupFront.addChild(t.group),this.doors.push(t),(t=new e.Lvl9RoomDoor(this.game,4)).group.angle=270,t.group.x=-257,this.groupFront.addChild(t.group),this.doors.push(t),t=null},i.prototype.createFront=function(){this.front=e.GameManager.instance.layerUpper.create(0,0,"level9_2","room"+this.id+"Front instance 10000"),this.front.anchor.setTo(.5),this.front.angle=-90,this.front.cacheAsBitmap=!0,this.front.inputEnabled=!0},i.prototype.createWalls=function(e){var t=this.groupFront.create(-264,-178,"level9_2","room"+e+"wall1 instance 10000");t.cacheAsBitmap=!0,(t=this.groupFront.create(264,-178,"level9_2","room"+e+"wall2 instance 10000")).anchor.x=1,t.cacheAsBitmap=!0,(t=this.groupFront.create(-264,177,"level9_2","room"+e+"wall3 instance 10000")).anchor.y=1,t.cacheAsBitmap=!0,(t=this.groupFront.create(264,177,"level9_2","room"+e+"wall4 instance 10000")).anchor.setTo(1),t.cacheAsBitmap=!0,t=null},i.prototype.activateDoors=function(){},i.prototype.activate=function(e){void 0===e&&(e=!0),!0===e&&this.closeDoor()},i.prototype.show=function(e){this.groupBack.visible=!0,this.groupFront.visible=!0,this.front.visible=!1,e>=0?this.openDoor(e):this.activate(!1)},i.prototype.openDoor=function(e){this.doors[e].open()},i.prototype.closeDoor=function(){for(var e=0;e<this.doors.length;e++)if(!0===this.doors[e].opened)return void this.doors[e].close()},i.prototype.hide=function(e){void 0===e&&(e=!1),this.groupBack.visible=!1,this.groupFront.visible=!1,this.front.visible=!0,!0===e&&this.closeDoor()},i.prototype.deactivateDoors=function(){for(var e=0;e<this.doors.length;e++)this.doors[e].deactivate()},i.prototype.update=function(){for(var e=0;e<this.doors.length;e++)this.doors[e].update()},i.prototype.addMask=function(e){var t=this.game.make.graphics(0,0);t.beginFill(16711680,.5),t.drawRect(-263,-176,526,352),t.endFill(),e.addChild(t),e.mask=t,t=null},i.prototype.free=function(){this.game=null,this.groupBack=null,this.groupFront=null,this.front=null;for(var e=0;e<this.doors.length;e++)this.doors[e].free();this.doors=[],this.doors=null},i}(e.BasicElement);e.Lvl9BasicRoom=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s,a){var n=t.call(this)||this;n.moving=!1,n.body=new Phaser.Physics.Box2D.Body(i,null,s,a,1),n.body.setRectangle(130,14),n.graphic=e.GameManager.instance.layerElements.create(n.body.x,n.body.y,"level9","platformHero instance 10000"),n.graphic.anchor.setTo(.5),n.graphic.pivot.y=17,n.gear1=i.make.sprite(-12,24,"level9","platformHeroGear instance 10000"),n.gear1.anchor.setTo(.5),n.gear1.angle=47,n.graphic.addChild(n.gear1),n.gear2=i.make.sprite(12,24,"level9","platformHeroGear instance 10000"),n.gear2.anchor.setTo(.5),n.gear2.angle=20,n.graphic.addChild(n.gear2);var o=i.make.sprite(0,16,"level9","platformHeroFloor instance 10000");return o.anchor.setTo(.5),o.cacheAsBitmap=!0,n.graphic.addChild(o),o=null,n}return __extends(i,t),i.prototype.move=function(t,i){this.body.velocity.x=t,this.body.velocity.y=i,this.moving=!0,e.SoundManager.playSFX("s_lvl8_platformStart"),e.SoundManager.playSFX("s_lvl8_platformMove",!0)},i.prototype.stop=function(){this.body.velocity.x=0,this.body.velocity.y=0,this.moving=!1,e.SoundManager.playSFX("s_lvl8_platformStop"),e.SoundManager.stopSFXLoop("s_lvl8_platformMove")},i.prototype.update=function(){!0===this.moving&&(this.graphic.x=this.body.x,this.graphic.y=this.body.y,this.gear1.angle+=1,this.gear2.angle-=1)},i.prototype.free=function(){this.body=null,this.graphic=null,this.gear1=null,this.gear2=null},i}(e.BasicElement);e.Lvl9PlatformHero=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t){var i=e.call(this,t,1)||this;return i.createBg(),i.createDoors(),i.createWalls(i.id),i.createFront(),i.hide(),i.x=585,i.y=265,i}return __extends(t,e),t.prototype.activateDoors=function(){this.doors[1].activate(),this.doors[2].activate()},t.prototype.activate=function(t){void 0===t&&(t=!0),e.prototype.activate.call(this,t),this.activateDoors()},t}(e.Lvl9BasicRoom);e.Lvl9Room1=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i,2)||this;return s.lives=10,s.addMask(s.groupBack),s.moves=new e.Lvl9Room2Moves(i),s.moves.group.x=201,s.moves.group.y=-87,s.groupBack.addChild(s.moves.group),s.createBg(),s.createBtns(),s.createDoors(),s.createWalls(5),s.tube=new e.Lvl9Room2Tube(i),s.tube.group.x=-257,s.tube.group.y=-148,s.groupFront.addChild(s.tube.group),s.createFront(),s.hide(),s.x=1430,s.y=265,s}return __extends(i,t),i.prototype.createBtns=function(){this.btn1=this.groupBack.create(-120,-86,"level9","room2BtnSquare instance 10000"),this.btn1.anchor.setTo(.5),this.btn1.events.onInputDown.add(this.btnDown,this),this.btn1.events.onInputOut.add(this.btnOut,this),this.btn1.events.onInputOver.add(this.btnOver,this),this.btn1.angle=90;var e=this.game.make.sprite(-3,-3,"level9","room2BtnSquareBlue instance 10000");e.visible=!1,this.btn1.addChild(e),this.btn2=this.groupBack.create(120,-86,"level9","room2BtnSquare instance 10000"),this.btn2.anchor.setTo(.5),this.btn2.events.onInputDown.add(this.btnDown,this),this.btn2.events.onInputOut.add(this.btnOut,this),this.btn2.events.onInputOver.add(this.btnOver,this),(e=this.game.make.sprite(-3,-3,"level9","room2BtnSquareBlue instance 10000")).visible=!1,this.btn2.addChild(e),this.btn3=this.groupBack.create(-120,94,"level9","room2BtnSquare instance 10000"),this.btn3.anchor.setTo(.5),this.btn3.events.onInputDown.add(this.btnDown,this),this.btn3.events.onInputOut.add(this.btnOut,this),this.btn3.events.onInputOver.add(this.btnOver,this),this.btn3.angle=90,(e=this.game.make.sprite(-3,-3,"level9","room2BtnSquareBlue instance 10000")).visible=!1,this.btn3.addChild(e),this.btn4=this.groupBack.create(120,94,"level9","room2BtnSquare instance 10000"),this.btn4.anchor.setTo(.5),this.btn4.events.onInputDown.add(this.btnDown,this),this.btn4.events.onInputOut.add(this.btnOut,this),this.btn4.events.onInputOver.add(this.btnOver,this),this.btn4.angle=-90,(e=this.game.make.sprite(-3,-3,"level9","room2BtnSquareBlue instance 10000")).visible=!1,this.btn4.addChild(e),e=null},i.prototype.btnDown=function(t){"used"!==t.name&&(t===this.btn1&&0===this.btn1.angle&&(this.btn1.getChildAt(0).visible=!1),t===this.btn2&&90===this.btn2.angle&&(this.btn2.getChildAt(0).visible=!1),t===this.btn3&&-90===this.btn3.angle&&(this.btn3.getChildAt(0).visible=!1),t===this.btn4&&180===Math.abs(this.btn4.angle)&&(this.btn4.getChildAt(0).visible=!1),e.SoundManager.playSFX("s_lvl8_squareRotate"),t.name="used",this.game.add.tween(t).to({angle:t.angle+90},500,Phaser.Easing.Linear.None,!0).onComplete.addOnce(this.completeRotation,this,0,t),this.lives-=1,0===this.lives&&this.tube.playAnim("appear"),this.moves.minus())},i.prototype.completeRotation=function(e){e.name="";var t=0;0===this.btn1.angle&&(this.btn1.getChildAt(0).visible=!0,t+=1),90===this.btn2.angle&&(this.btn2.getChildAt(0).visible=!0,t+=1),-90===this.btn3.angle&&(this.btn3.getChildAt(0).visible=!0,t+=1),180===Math.abs(this.btn4.angle)&&(this.btn4.getChildAt(0).visible=!0,t+=1),4===t&&this.activateDoors()},i.prototype.btnOut=function(e){!0===e.inputEnabled&&(e.frameName="room2BtnSquare instance 10001")},i.prototype.btnOver=function(e){!0===e.inputEnabled&&(e.frameName="room2BtnSquare instance 10002")},i.prototype.activateDoors=function(){this.lives>0&&(this.doors[1].activate(),this.doors[2].activate(),this.moves.playAnim("close"),e.SoundManager.playSFX("s_lvl8_cube2Complite"),e.SoundManager.playSFX("s_lvl8_closeStep")),this.btn1.inputEnabled=!1,this.btn1.frameName="room2BtnSquare instance 10000",this.btn2.inputEnabled=!1,this.btn2.frameName="room2BtnSquare instance 10000",this.btn3.inputEnabled=!1,this.btn3.frameName="room2BtnSquare instance 10000",this.btn4.inputEnabled=!1,this.btn4.frameName="room2BtnSquare instance 10000"},i.prototype.activate=function(i){void 0===i&&(i=!0),t.prototype.activate.call(this,i),this.btn1.inputEnabled=!0,this.btn1.input.useHandCursor=!0,this.btnOut(this.btn1),this.btn2.inputEnabled=!0,this.btn2.input.useHandCursor=!0,this.btnOut(this.btn2),this.btn3.inputEnabled=!0,this.btn3.input.useHandCursor=!0,this.btnOut(this.btn3),this.btn4.inputEnabled=!0,this.btn4.input.useHandCursor=!0,this.btnOut(this.btn4),this.moves.playAnim("open"),e.SoundManager.playSFX("s_lvl8_openStep")},i.prototype.update=function(){t.prototype.update.call(this),this.tube.update(),this.moves.update()},i.prototype.free=function(){t.prototype.free.call(this),this.btn1=null,this.btn2=null,this.btn3=null,this.btn4=null,this.tube.free(),this.tube=null,this.moves.free(),this.moves=null},i}(e.Lvl9BasicRoom);e.Lvl9Room2=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.count=0,s.group=i.make.group(),s.bg=new e.SASprite(i,0,0,"level9","doorBg instance 10000"),s.group.addChild(s.bg),s.progress=new e.SASprite(i,0,0,"level9","doorProgress instance 10000"),s.progress.pivot.set(26,29),s.group.addChild(s.progress),s.top=new e.SASprite(i,0,0,"level9","doorTop instance 10000"),s.top.pivot.set(43,42),s.group.addChild(s.top),s.bot=new e.SASprite(i,0,0,"level9","doorBot instance 10000"),s.bot.pivot.set(39,39),s.group.addChild(s.bot),s.setParts("open"),s}return __extends(i,t),i.prototype.minus=function(){10!==this.count&&(this.count+=1,this.progress.frameName="doorProgress instance "+(1e4+this.count))},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"open"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bot,50,{y:48}),e.GameManager.instance.level.setSimpleTween(this.top,50,{y:-75}),this.setPart(this.progress,{x:17,y:-22,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bg,{x:-33,y:-66,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):51===this.counterAnim&&this.animComplete():"close"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bot,15,{y:26}),e.GameManager.instance.level.setSimpleTween(this.top,15,{y:-29}),this.setPart(this.progress,{x:17,y:-22,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bg,{x:-33,y:-66,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):16===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bot,5,{y:29}),e.GameManager.instance.level.setSimpleTween(this.top,5,{y:-35})):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.bot,14,{y:26}),e.GameManager.instance.level.setSimpleTween(this.top,14,{y:-29})):35===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"open"===e?(this.setPart(this.bot,{x:6,y:26,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.top,{x:10,y:-29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.progress,{x:17,y:-22,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bg,{x:-33,y:-66,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"close"===e&&(this.setPart(this.bot,{x:6,y:48,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.top,{x:10,y:-75,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.progress,{x:17,y:-22,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.bg,{x:-33,y:-66,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.bg=null,this.progress=null,this.top=null,this.bot=null},i}(e.BasicSimpleAnim);e.Lvl9Room2Moves=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.activeAsid=!1,s.counterAsid=0,s.startDefeat=!1,s.counterDefeat=0,s.game=i,s.asids=new Array,s.group=i.make.group(),s.tube1=new e.SASprite(i,0,0,"level9","Tube_1 instance 10000"),s.group.addChild(s.tube1),s.tube2=new e.SASprite(i,0,0,"level9","Tube_2 instance 10000"),s.group.addChild(s.tube2),s.tube3=new e.SASprite(i,0,0,"level9","Tube_3 instance 10000"),s.group.addChild(s.tube3),s.tube4=new e.SASprite(i,0,0,"level9","Tube_4 instance 10000"),s.group.addChild(s.tube4),s.setParts("appear"),s}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this),this.updateAsidParticle(),!0===this.startDefeat&&(this.counterDefeat+=1,70===this.counterDefeat&&(this.startDefeat=!1,e.LevelBuilder.instance.levelFailed()))},i.prototype.updateAsidParticle=function(){if(!1!==this.activeAsid){if(this.counterAsid+=1,this.counterAsid%2==0){var t=20*Math.random()-10;this.setAsid(30,20+2*t,t+30,1.2+.8*Math.random())}50===this.counterAsid&&(this.startDefeat=!0,e.GameManager.instance.hero.addAsid())}},i.prototype.setAsid=function(e,t,i,s){for(var a=0;a<this.asids.length;a++)if(!1===this.asids[a].visible)return this.asids[a].x=e,this.asids[a].y=t,this.asids[a].angle=i,this.asids[a].scale.setTo(s),this.asids[a].animations.play("anim"),void(this.asids[a].visible=!0);var n=this.game.make.sprite(e,t,"level9");n.animations.add("anim",Phaser.Animation.generateFrameNames("asidAnim instance 1",0,24,"",4),30,!1).onComplete.add(this.asidPartComp,this),n.animations.play("anim"),n.angle=i,n.scale.setTo(s),this.group.addChildAt(n,0),this.asids.push(n),n=null},i.prototype.asidPartComp=function(e,t){e.visible=!1},i.prototype.onAnimComplete=function(){"appear"===this.currAnim?(this.activeAsid=!0,e.SoundManager.playSFX("s_8_acid",!0),this.playAnim("cycle",3)):"cycle"===this.currAnim&&0===this.loopAnim&&(this.activeAsid=!1,e.SoundManager.stopSFXLoop("s_8_acid"),this.playAnim("hide"))},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"appear"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tube4,19,{x:32,skX:0,skY:0,scX:1}),e.GameManager.instance.level.setSimpleTween(this.tube3,19,{x:20,y:1,skX:0,skY:0,scX:1}),e.GameManager.instance.level.setSimpleTween(this.tube2,19,{x:11,y:1,skX:0,skY:0,scX:1}),e.GameManager.instance.level.setSimpleTween(this.tube1,19,{x:0,y:2,scX:1})):20===this.counterAnim&&this.animComplete():"cycle"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tube4,4,{x:40,y:1,skX:8,skY:8}),e.GameManager.instance.level.setSimpleTween(this.tube3,4,{x:24,skX:4,skY:4}),e.GameManager.instance.level.setSimpleTween(this.tube2,4,{x:14,skX:2,skY:2})):5===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tube4,9,{x:32,y:0,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.tube3,9,{x:20,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.tube2,9,{x:11,skX:0,skY:0})):14===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tube4,7,{x:40,y:1,skX:8,skY:8}),e.GameManager.instance.level.setSimpleTween(this.tube3,7,{x:24,skX:4,skY:4}),e.GameManager.instance.level.setSimpleTween(this.tube2,7,{x:14,skX:2,skY:2})):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.tube4,13,{x:32,y:0,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.tube3,13,{x:20,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.tube2,13,{x:11,skX:0,skY:0})):34===this.counterAnim&&this.animComplete():"hide"===this.currAnim&&(1===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tube4,11,{x:25,skX:-3,scX:1.12}):5===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tube1,20,{x:-4,y:4,scX:.67}):7===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tube2,18,{x:-5,y:3,skX:-4,skY:-4,scX:.53}):9===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tube3,16,{x:-12,y:3,skX:-8,skY:-12,scX:.75}):12===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.tube4,13,{x:-17,skX:-11,skY:-11,scX:.85}):25===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"appear"===e?(this.setPart(this.tube4,{x:-12,y:0,angle:0,scX:.76,scY:1,skX:-10,skY:-11,alpha:1}),this.setPart(this.tube3,{x:-12,y:3,angle:0,scX:.75,scY:1,skX:-8,skY:-12,alpha:1}),this.setPart(this.tube2,{x:-5,y:3,angle:0,scX:.53,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.tube1,{x:-4,y:4,angle:0,scX:.67,scY:1,skX:0,skY:0,alpha:1})):"cycle"===e?(this.setPart(this.tube4,{x:32,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tube3,{x:20,y:1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tube2,{x:11,y:1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tube1,{x:0,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"hide"===e&&(this.setPart(this.tube4,{x:32,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tube3,{x:20,y:1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tube2,{x:11,y:1,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.tube1,{x:0,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.game=null,this.group=null,this.tube1=null,this.tube2=null,this.tube3=null,this.tube4=null,this.asids=[],this.asids=null},i}(e.BasicSimpleAnim);e.Lvl9Room2Tube=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e){var i=t.call(this,e,3)||this;return i.active=!1,i.counter=0,i.step=0,i.startDefeat=!1,i.counterDefeat=0,i.createBg(),i.wallBot=i.groupFront.create(0,166,"level9","wallBot instance 10000"),i.wallBot.anchor.x=.5,i.wallTop=i.groupFront.create(0,-166,"level9","wallTop instance 10000"),i.wallTop.anchor.setTo(.5,1),i.createDoors(),i.createWalls(5),i.createFront(),i.hide(),i.addMask(i.groupFront),i.x=1970,i.y=265,i}return __extends(i,t),i.prototype.activate=function(e){void 0===e&&(e=!0),t.prototype.activate.call(this,e),this.active=!0},i.prototype.update=function(){t.prototype.update.call(this),!0===this.active&&(this.counter+=1,10===this.counter&&e.SoundManager.playSFX("s_lvl8_cube3FloorMove"),this.wallBot.y-=1.5,this.wallTop.y+=1.5,this.wallTop.y>=-120&&0===this.step?(this.step=1,e.GameManager.instance.hero.currEyesState=e.EyesState.afraid):this.wallTop.y>=1&&(this.active=!1,this.startDefeat=!0)),!0===this.startDefeat&&(this.counterDefeat+=1,40===this.counterDefeat&&(this.startDefeat=!1,e.LevelBuilder.instance.levelFailed()))},i.prototype.free=function(){t.prototype.free.call(this),this.wallBot=null,this.wallTop=null},i}(e.Lvl9BasicRoom);e.Lvl9Room3=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e){var i=t.call(this,e,4)||this;return i.activeArrows=!1,i.arrowStep=0,i.createBg(),i.createDoors(),i.createWalls(i.id),i.createArrows(),i.createFront(),i.hide(),i.x=890,i.y=630,i}return __extends(i,t),i.prototype.createArrows=function(){this.arrows=new Array,this.addArrow(-213,-144,115),this.addArrow(-224,-121,115),this.addArrow(-236,-98,115),this.addArrow(213,-144,-115),this.addArrow(224,-121,-115),this.addArrow(236,-98,-115),this.addArrow(-213,144,63),this.addArrow(-224,121,63),this.addArrow(-236,98,63),this.addArrow(213,144,-63),this.addArrow(224,121,-63),this.addArrow(236,98,-63,!0)},i.prototype.addArrow=function(e,t,i,s){void 0===s&&(s=!1);var a=this.groupFront.create(e,t,"level9","room4ArrowBlow instance 10000");!1===s?a.animations.add("anim",Phaser.Animation.generateFrameNames("room4ArrowBlow instance 1",0,42,"",4),30,!1):a.animations.add("anim",Phaser.Animation.generateFrameNames("room4ArrowBlow instance 1",0,42,"",4),30,!1).onComplete.addOnce(this.oneArrowComplete,this),a.angle=i,a.anchor.setTo(.5,.97),this.arrows.push(a),a=null},i.prototype.oneArrowComplete=function(){e.GameManager.instance.hero.currState=e.HeroState.bumpStars;var t=this.game.make.sprite(0,0,"level9","arrowsHited instance 10000");t.anchor.setTo(.5),e.GameManager.instance.hero.baseGroup.addChild(t),t=null},i.prototype.activate=function(e){void 0===e&&(e=!0),t.prototype.activate.call(this,e),this.activeArrows=!0;for(var i=0;i<this.arrows.length;i++)this.arrows[i].animations.play("anim")},i.prototype.update=function(){t.prototype.update.call(this),!0===this.activeArrows&&(this.arrowStep+=1,20===this.arrowStep?e.GameManager.instance.hero.currEyesState=e.EyesState.afraid:35===this.arrowStep||45===this.arrowStep||120===this.arrowStep&&(e.LevelBuilder.instance.levelFailed(),this.activeArrows=!1))},i.prototype.free=function(){t.prototype.free.call(this),this.arrows=[],this.arrows=null},i}(e.Lvl9BasicRoom);e.Lvl9Room4=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e){var i=t.call(this,e,5)||this;return i.startDefeat=!1,i.counterDefeat=0,i.updateWater=!1,i.afraid=0,i.startSpawningBubbles=!1,i.spawningBubblesCounter=0,i.createBg(),i.createMachines(),i.createElements(),i.createDoors(),i.createWalls(i.id),i.createFront(),i.hide(),i.addMask(i.groupFront),i.x=1430,i.y=630,i}return __extends(i,t),i.prototype.createMachines=function(){this.machine1=new e.Lvl9Room5Machine(this.game,1),this.machine1.group.x=-140,this.machine1.group.y=100,this.machine1.onComplete.add(this.machineComplete,this),this.groupFront.addChild(this.machine1.group),this.machine2=new e.Lvl9Room5Machine(this.game,3),this.machine2.group.x=0,this.machine2.group.y=100,this.machine2.onComplete.add(this.machineComplete,this),this.groupFront.addChild(this.machine2.group),this.machine3=new e.Lvl9Room5Machine(this.game,2),this.machine3.group.x=140,this.machine3.group.y=100,this.machine3.onComplete.add(this.machineComplete,this),this.groupFront.addChild(this.machine3.group)},i.prototype.createElements=function(){this.saws=new Array,this.addSaw(-237,-22,-15,1,1),this.addSaw(-204,20,-15),this.addSaw(-168,60,-15),this.addSaw(237,-22,15,-1),this.addSaw(204,20,15,-1),this.addSaw(168,60,15,-1),this.bodyBrorder=new Phaser.Physics.Box2D.Body(this.game,null,1430,630,0),this.bodyBrorder.setRectangle(550,24,0,-163),this.bodyBrorder.addRectangle(550,24,0,172),this.bodyBrorder.addRectangle(24,338,-258,0),this.bodyBrorder.addRectangle(24,338,258,0),this.bodyBrorder.sensor=!0,this.questCarPlatform=this.groupFront.create(290,-95,"level9","questCarPlatform instance 10000"),this.questCarPlatform.anchor.setTo(.5),this.questCarPlatform.visible=!1,!1===e.GameManager.instance.level.questCarFounded&&(e.GameManager.instance.level.addQuestCar(-4,-26,this.questCarPlatform),e.GameManager.instance.level.questCar.scale.x=-1,e.GameManager.instance.level.questCar.inputEnabled=!1)},i.prototype.addSaw=function(e,t,i,s,a){void 0===s&&(s=1),void 0===a&&(a=0);var n=this.groupBack.create(e,t,"level9");0===a?n.animations.add("anim",Phaser.Animation.generateFrameNames("saw1fatality instance 1",0,49,"",4),30,!1):1===a&&(n.animations.add("anim",Phaser.Animation.generateFrameNames("saw1fatality instance 1",0,9,"",4),30,!1).onComplete.addOnce(this.sawComp,this),n.animations.add("anim2",Phaser.Animation.generateFrameNames("saw1fatality instance 1",10,49,"",4),30,!1)),n.scale.x=s,n.angle=i,n.visible=!1,this.saws.push(n),n=null},i.prototype.sawComp=function(t,i){t.animations.play("anim2"),this.saws[3].visible=!0,this.saws[3].animations.play("anim"),this.saws[4].visible=!0,this.saws[4].animations.play("anim"),this.saws[5].visible=!0,this.saws[5].animations.play("anim"),e.GameManager.instance.hero.setVisibility(!1),e.SoundManager.playSFX("s_lvl8_wheelyCrushed"),this.brokenHero=new e.BrokeHero(this.game,e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y),this.startDefeat=!0,this.totalDefeat=90},i.prototype.activateDoors=function(){this.doors[1].activate(),this.doors[2].activate(),this.doors[3].activate(),this.bodyBrorder.sensor=!0,e.SoundManager.playSFX("s_lvl8_cube5Complite")},i.prototype.activate=function(e){void 0===e&&(e=!0),t.prototype.activate.call(this,e),!0===e?(this.machine1.playAnim("show"),this.machine1.counterAnim=50,this.machine2.playAnim("show"),this.machine2.counterAnim=50,this.machine3.playAnim("show"),this.machine3.counterAnim=50):(this.machine1.setParts("hide"),this.machine2.setParts("hide"),this.machine3.setParts("hide")),this.bodyBrorder.sensor=!1},i.prototype.machineComplete=function(){0===this.machine1.currStep&&0===this.machine2.currStep&&0===this.machine3.currStep?(this.questCarPlatform.visible=!0,!1===e.GameManager.instance.level.questCarFounded&&(e.GameManager.instance.level.questCar.inputEnabled=!0,e.GameManager.instance.level.questCar.input.useHandCursor=!0),e.GameManager.instance.level.setSimpleTween(this.questCarPlatform,18,{x:214}),e.SoundManager.playSFX("s_lvl8_secretShelf")):1===this.machine1.currStep&&1===this.machine2.currStep&&1===this.machine3.currStep?(this.startSaw(),this.machine1.disable(),this.machine2.disable(),this.machine3.disable()):2===this.machine1.currStep&&2===this.machine2.currStep&&2===this.machine3.currStep?(this.startDrop(),this.machine1.disable(),this.machine2.disable(),this.machine3.disable()):3===this.machine1.currStep&&3===this.machine2.currStep&&3===this.machine3.currStep&&(this.machine1.disable(),this.machine2.disable(),this.machine3.disable(),this.activateDoors())},i.prototype.startSaw=function(){this.saws[0].visible=!0,this.saws[0].animations.play("anim"),this.saws[1].visible=!0,this.saws[1].animations.play("anim"),this.saws[2].visible=!0,this.saws[2].animations.play("anim"),e.SoundManager.playSFX("s_lvl8_saws")},i.prototype.startDrop=function(){this.updateWater=!0,e.SoundManager.playSFX("s_lvl8_water",!0),e.GameManager.instance.level.customAction(5),e.GameManager.instance.hero.bodyBase.data.SetUserData("canWater"),e.GameManager.instance.hero.bodyBase.mass=2,this.bubbles=new Array,this.water=this.game.make.sprite(0,340,"level9","room5Water instance 10000"),this.water.anchor.setTo(.5),this.water.inputEnabled=!0,this.groupFront.addChildAt(this.water,this.groupFront.getChildIndex(this.doors[0].group)),this.waterBody=new Phaser.Physics.Box2D.Body(this.game,null,1430,970,1);var t=this.waterBody.setRectangle(512,322);t.SetDensity(2),t.SetFriction(.3),t.SetRestitution(0),t=null,this.waterBody.sensor=!0,this.waterBody.setCategoryContactCallback(1,this.onContactWithWater,this),this.waterBody.velocity.y=-50,this.m_controller=new box2d.b2BuoyancyController,this.m_controller.normal.SetXY(0,1),this.m_controller.offset=0,this.m_controller.useDensity=!0,this.m_controller.density=2,this.m_controller.linearDrag=3,this.m_controller.angularDrag=2,this.game.physics.box2d.world.AddController(this.m_controller)},i.prototype.onContactWithWater=function(e,t,i,s,a){e===t||!0===t.sensor||!1===t.dynamic||"canWater"!==t.data.GetUserData()&&"DragBody"!==t.data.GetUserData()||(!0===a?null===t.data.GetControllerList()&&(t.data.SetAwake(!0),this.m_controller.AddBody(t.data)):null!==t.data.GetControllerList()&&this.m_controller.RemoveBody(t.data))},i.prototype.update=function(){t.prototype.update.call(this),this.machine1.update(),this.machine2.update(),this.machine3.update(),!0===this.updateWater&&(this.water.y=this.waterBody.y-640,this.m_controller.offset=-(this.waterBody.y-161)/50,this.waterBody.y<=650&&(this.updateWater=!1,e.SoundManager.stopSFXLoop("s_lvl8_water"),this.waterBody.velocity.y=0),e.GameManager.instance.hero.bodyBase.y-10>this.waterBody.y-161&&(this.startSpawningBubbles=!0,e.SoundManager.playSFX("sfx_bubles",!0),this.startDefeat=!0,this.totalDefeat=180),0===this.afraid&&e.GameManager.instance.hero.bodyBase.y+70>this.waterBody.y-161?(this.afraid=1,e.GameManager.instance.hero.currEyesState=e.EyesState.afraid):1===this.afraid&&e.GameManager.instance.hero.bodyBase.y+20>this.waterBody.y-161&&(this.afraid=2,e.GameManager.instance.hero.currEyesState=e.EyesState.bumpForEver)),!0===this.startDefeat&&(this.counterDefeat+=1,this.counterDefeat===this.totalDefeat&&(this.startDefeat=!1,e.LevelBuilder.instance.levelFailed())),!0===this.startSpawningBubbles&&(this.spawningBubblesCounter+=1,2===this.spawningBubblesCounter&&(this.spawningBubblesCounter=0,this.spawnBubble(e.GameManager.instance.hero.bodyBase.x+e.Tools.random(-40,40),e.GameManager.instance.hero.bodyBase.y+e.Tools.random(-30,10),.7+.5*Math.random())))},i.prototype.spawnBubble=function(t,i,s){for(var a=0;a<this.bubbles.length;a++)if(!1===this.bubbles[a].visible)return this.bubbles[a].visible=!0,this.bubbles[a].x=t,this.bubbles[a].y=i,this.bubbles[a].scale.setTo(s),void this.bubbles[a].animations.play("anim");var n=e.GameManager.instance.layerUpper.create(t,i,"level9");n.animations.add("anim",Phaser.Animation.generateFrameNames("bubbleWaterPart instance 1",0,9,"",4),30,!1).onComplete.add(this.bubbleComplete,this),n.animations.play("anim"),n.scale.setTo(s),this.bubbles.push(n),n=null},i.prototype.bubbleComplete=function(e,t){e.visible=!1},i.prototype.free=function(){t.prototype.free.call(this),this.machine1.free(),this.machine1=null,this.machine2.free(),this.machine2=null,this.machine3.free(),this.machine3=null,this.questCarPlatform=null,this.saws=[],this.saws=null,this.brokenHero&&this.brokenHero.free(),this.brokenHero=null,this.bodyBrorder=null,this.water=null,this.waterBody=null,this.bubbles=[],this.bubbles=null,this.m_controller=null},i}(e.Lvl9BasicRoom);e.Lvl9Room5=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this,i)||this;a.currStep=1,a.startWheel=!1,a.counterWheel=0,a.currStep=s,a.group=i.make.group(),a.onComplete=new Phaser.Signal,a.lpart=new e.SASprite(i,0,0,"level9","room5Machine1 instance 10000"),a.lpart.pivot.set(23,43),a.group.addChild(a.lpart),a.rpart=new e.SASprite(i,0,0,"level9","room5Machine1 instance 10000"),a.rpart.pivot.set(23,43),a.group.addChild(a.rpart),a.wheel=new e.SASprite(i,0,0,"level9","room5MachineBg instance 10000"),a.wheel.anchor.setTo(.5),a.group.addChild(a.wheel),a.wheel.inputEnabled=!0,a.wheel.hitArea=new Phaser.Rectangle(-19,-35,38,70),a.wheel.input.useHandCursor=!0,a.wheel.events.onInputDown.add(a.wheelDown,a);var n=i.make.group();a.wheel.addChild(n),a.choKey=new e.SASprite(i,0,-58,"level9","cho_key instance 10000"),a.choKey.animations.add("show",Phaser.Animation.generateFrameNames("cho_key instance 1",0,13,"",4),30,!1),a.choKey.animations.add("hide",Phaser.Animation.generateFrameNames("cho_key instance 1",0,0,"",4),30,!1),a.choKey.anchor.setTo(.5),a.choKey.scale.y=.62,n.addChild(a.choKey),a.choDrop=new e.SASprite(i,-.5,-32,"level9","cho_drop instance 10000"),a.choDrop.animations.add("show",Phaser.Animation.generateFrameNames("cho_drop instance 1",0,13,"",4),30,!1),a.choDrop.animations.add("hide",Phaser.Animation.generateFrameNames("cho_drop instance 1",0,0,"",4),30,!1),a.choDrop.anchor.setTo(.5),a.choDrop.scale.y=.62,n.addChild(a.choDrop),a.choSaw=new e.SASprite(i,0,0,"level9","cho_saw instance 10000"),a.choSaw.animations.add("show",Phaser.Animation.generateFrameNames("cho_saw instance 1",0,13,"",4),30,!1),a.choSaw.animations.add("hide",Phaser.Animation.generateFrameNames("cho_saw instance 1",0,0,"",4),30,!1),a.choSaw.anchor.setTo(.5),n.addChild(a.choSaw),a.choCar=new e.SASprite(i,0,32,"level9","cho_quest instance 10000"),a.choCar.animations.add("show",Phaser.Animation.generateFrameNames("cho_quest instance 1",0,13,"",4),30,!1),a.choCar.animations.add("hide",Phaser.Animation.generateFrameNames("cho_quest instance 1",0,0,"",4),30,!1),a.choCar.anchor.setTo(.5),a.choCar.scale.y=.62,n.addChild(a.choCar);var o=i.make.sprite(0,0,"level9","room5MachineFront instance 10000");o.anchor.setTo(.5),a.wheel.addChild(o),o=null;var r=i.make.graphics(0,0);return r.beginFill(65280),r.drawRect(-19,-35,38,70),r.beginFill(255),r.drawEllipse(0,-33,17,5),r.drawEllipse(0,33,17,5),r.endFill(),n.addChild(r),n.mask=r,n=null,a.arrow=new e.SASprite(i,0,0,"level9","room5MachineArrow instance 10000"),a.arrow.pivot.set(17,13),a.arrow.animations.add("anim",Phaser.Animation.generateFrameNames("room5MachineArrow instance 1",0,10,"",4),30,!1),a.group.addChild(a.arrow),a.setParts("show"),a.setWheel(),a}return __extends(i,t),i.prototype.setWheel=function(){0===this.currStep?(this.setPart(this.choCar,{y:0,scY:1}),this.setPart(this.choSaw,{y:-32,scY:.62}),this.setPart(this.choDrop,{y:58,scY:.62}),this.setPart(this.choKey,{y:32,scY:.62}),this.choCar.frameName="cho_quest instance 10013"):1===this.currStep?(this.setPart(this.choCar,{y:32,scY:.62}),this.setPart(this.choSaw,{y:0,scY:1}),this.setPart(this.choDrop,{y:-32,scY:.62}),this.setPart(this.choKey,{y:58,scY:.62}),this.choSaw.frameName="cho_saw instance 10013"):2===this.currStep?(this.setPart(this.choCar,{y:58,scY:.62}),this.setPart(this.choSaw,{y:32,scY:.62}),this.setPart(this.choDrop,{y:0,scY:1}),this.setPart(this.choKey,{y:-32,scY:.62}),this.choDrop.frameName="cho_drop instance 10013"):3===this.currStep&&(this.setPart(this.choCar,{y:-32,scY:.62}),this.setPart(this.choSaw,{y:58,scY:.62}),this.setPart(this.choDrop,{y:32,scY:.62}),this.setPart(this.choKey,{y:0,scY:1}),this.choKey.frameName="cho_key instance 10013")},i.prototype.disable=function(){this.wheel.inputEnabled=!1,this.playAnim("hide")},i.prototype.wheelDown=function(){!0!==this.startWheel&&(e.SoundManager.playSFX("s_lvl8_drumRotate"),this.startWheel=!0,this.counterWheel=0,this.arrow.animations.play("anim"),0===this.currStep?(this.choDrop.y=-58,e.GameManager.instance.level.setSimpleTween(this.choCar,10,{y:32,scY:.62}),e.GameManager.instance.level.setSimpleTween(this.choSaw,10,{y:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.choDrop,10,{y:-32}),e.GameManager.instance.level.setSimpleTween(this.choKey,10,{y:58}),this.choCar.animations.play("hide")):1===this.currStep?(this.choKey.y=-58,e.GameManager.instance.level.setSimpleTween(this.choCar,10,{y:58}),e.GameManager.instance.level.setSimpleTween(this.choSaw,10,{y:32,scY:.62}),e.GameManager.instance.level.setSimpleTween(this.choDrop,10,{y:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.choKey,10,{y:-32}),this.choSaw.animations.play("hide")):2===this.currStep?(this.choCar.y=-58,e.GameManager.instance.level.setSimpleTween(this.choCar,10,{y:-32}),e.GameManager.instance.level.setSimpleTween(this.choSaw,10,{y:58}),e.GameManager.instance.level.setSimpleTween(this.choDrop,10,{y:32,scY:.62}),e.GameManager.instance.level.setSimpleTween(this.choKey,10,{y:0,scY:1}),this.choDrop.animations.play("hide")):3===this.currStep&&(this.choSaw.y=-58,e.GameManager.instance.level.setSimpleTween(this.choCar,10,{y:0,scY:1}),e.GameManager.instance.level.setSimpleTween(this.choSaw,10,{y:-32}),e.GameManager.instance.level.setSimpleTween(this.choDrop,10,{y:58}),e.GameManager.instance.level.setSimpleTween(this.choKey,10,{y:32,scY:.62}),this.choKey.animations.play("hide")))},i.prototype.update=function(){t.prototype.update.call(this),!0===this.startWheel&&(this.counterWheel+=1,10===this.counterWheel&&(this.startWheel=!1,this.currStep+=1,this.currStep>3&&(this.currStep=0),0===this.currStep?this.choCar.animations.play("show"):1===this.currStep?this.choSaw.animations.play("show"):2===this.currStep?this.choDrop.animations.play("show"):3===this.currStep&&this.choKey.animations.play("show"),this.onComplete.dispatch()))},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"show"===this.currAnim?59===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.arrow,10,{y:-17,scX:1.03}),e.GameManager.instance.level.setSimpleTween(this.wheel,10,{y:0,scY:1.03}),e.GameManager.instance.level.setSimpleTween(this.rpart,10,{y:24,scY:1.03}),e.GameManager.instance.level.setSimpleTween(this.lpart,10,{y:24,scY:1.03})):69===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.arrow,8,{y:-9,scX:1}),e.GameManager.instance.level.setSimpleTween(this.wheel,8,{y:2,scY:1}),e.GameManager.instance.level.setSimpleTween(this.rpart,8,{y:25,scY:1}),e.GameManager.instance.level.setSimpleTween(this.lpart,8,{y:25,scY:1})):77===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.arrow,5,{x:32,y:-4,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.rpart,5,{x:37}),e.GameManager.instance.level.setSimpleTween(this.lpart,5,{x:-35})):82===this.counterAnim&&this.animComplete():"hide"===this.currAnim&&(12===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.arrow,10,{x:25,y:-9,skX:90,skY:90}),e.GameManager.instance.level.setSimpleTween(this.rpart,10,{x:20}),e.GameManager.instance.level.setSimpleTween(this.lpart,10,{x:-17})):22===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.arrow,10,{y:98}),e.GameManager.instance.level.setSimpleTween(this.wheel,10,{y:109}),e.GameManager.instance.level.setSimpleTween(this.rpart,10,{y:132}),e.GameManager.instance.level.setSimpleTween(this.lpart,10,{y:132})):32===this.counterAnim&&(this.animComplete(),this.group.visible=!1)))},i.prototype.setParts=function(e){"show"===e?(this.setPart(this.arrow,{x:25,y:100,angle:0,scX:.93,scY:1,skX:90,skY:90,alpha:1}),this.setPart(this.wheel,{x:1,y:120,angle:0,scX:1,scY:.93,skX:0,skY:0,alpha:1}),this.setPart(this.rpart,{x:20,y:132,angle:0,scX:1,scY:.93,skX:0,skY:180,alpha:1}),this.setPart(this.lpart,{x:-17,y:132,angle:0,scX:1,scY:.93,skX:0,skY:0,alpha:1})):"hide"===e&&(this.setPart(this.arrow,{x:32,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.wheel,{x:1,y:2,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.rpart,{x:37,y:25,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),this.setPart(this.lpart,{x:-35,y:25,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.lpart=null,this.rpart=null,this.wheel=null,this.arrow=null,this.choCar=null,this.choDrop=null,this.choKey=null,this.choSaw=null,this.onComplete=null},i}(e.BasicSimpleAnim);e.Lvl9Room5Machine=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e){var i=t.call(this,e,6)||this;return i.activeSpray=!1,i.counterSpray=0,i.createBg(),i.createElements(),i.createDoors(),i.createWalls(i.id),i.createFront(),i.hide(),i.addMask(i.groupFront),i.x=1970,i.y=630,i}return __extends(i,t),i.prototype.createElements=function(){this.spray=new e.Lvl9Room6Spray(this.game),this.spray.group.x=198,this.spray.group.y=-112,this.groupFront.addChild(this.spray.group),this.hammer=new e.Lvl9Room6Hammer(this.game),this.hammer.group.x=-114,this.hammer.group.y=-150,this.groupFront.addChild(this.hammer.group)},i.prototype.activate=function(i){void 0===i&&(i=!0),t.prototype.activate.call(this,i),this.spray.playAnim("anim"),e.SoundManager.playSFX("s_lvl8_frostMashine"),this.activeSpray=!0},i.prototype.update=function(){t.prototype.update.call(this),this.spray.update(),this.hammer.update(),this.freezeWheely&&this.freezeWheely.update(),!0===this.activeSpray&&(this.counterSpray+=1,80===this.counterSpray?this.freezeWheely=new e.Lvl9Room6FrostWheely(this.game):130===this.counterSpray?(this.hammer.playAnim("anim"),e.SoundManager.playSFX("s_lvl8_frostHammer")):217===this.counterSpray?(this.freezeWheely.playBroke(),e.SoundManager.playSFX("s_lvl8_hammerHit")):300===this.counterSpray&&(this.activeSpray=!1,e.LevelBuilder.instance.levelFailed()))},i.prototype.free=function(){t.prototype.free.call(this),this.spray.free(),this.spray=null,this.hammer.free(),this.hammer=null,this.freezeWheely&&this.freezeWheely.free(),this.freezeWheely=null},i}(e.Lvl9BasicRoom);e.Lvl9Room6=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.part11=new e.SASprite(i,0,0,"level9","brokePart11 instance 10000"),s.part11.pivot.set(0,1),s.group.addChild(s.part11),s.part10=new e.SASprite(i,0,0,"level9","brokePart10 instance 10000"),s.part10.pivot.set(1,1),s.group.addChild(s.part10),s.part9=new e.SASprite(i,0,0,"level9","brokePart9 instance 10000"),s.group.addChild(s.part9),s.part8=new e.SASprite(i,0,0,"level9","brokePart8 instance 10000"),s.part8.pivot.set(1,1),s.group.addChild(s.part8),s.part7=new e.SASprite(i,0,0,"level9","brokePart7 instance 10000"),s.part7.pivot.set(1,1),s.group.addChild(s.part7),s.part6=new e.SASprite(i,0,0,"level9","brokePart6 instance 10000"),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level9","brokePart5 instance 10000"),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level9","brokePart4 instance 10000"),s.part4.pivot.set(0,1),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level9","brokePart3 instance 10000"),s.part3.pivot.set(1,0),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level9","brokePart2 instance 10000"),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level9","brokePart1 instance 10000"),s.part1.pivot.set(1,1),s.group.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,5,{x:27,y:22,skX:44,skY:44},!0),e.GameManager.instance.level.setSimpleTween(this.part2,17,{x:87,y:86,skX:180,skY:180},!0),this.setPart(this.part3,{x:34,y:3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part4,{x:95,y:29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.part5,12,{x:60,y:81,skX:-75,skY:-75},!0),this.setPart(this.part6,{x:52,y:20,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part7,{x:17,y:35,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.part8,11,{x:55,y:94,skX:-135,skY:-135},!0),this.setPart(this.part9,{x:15,y:50,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part10,{x:0,y:31,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.part11,13,{x:59,y:53},!0)):6===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,7,{x:48,y:56,skX:105,skY:105},!0),e.GameManager.instance.level.setSimpleTween(this.part3,13,{x:33,y:49},!0),e.GameManager.instance.level.setSimpleTween(this.part7,11,{x:41,y:53,skX:41,skY:41},!0),e.GameManager.instance.level.setSimpleTween(this.part9,11,{x:49,y:51,skX:90,skY:90},!0)):9===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part4,13,{x:104,y:38,skX:22,skY:22},!0),e.GameManager.instance.level.setSimpleTween(this.part6,15,{x:84,y:35,skX:53,skY:53},!0),e.GameManager.instance.level.setSimpleTween(this.part10,12,{x:42,y:57,skX:75,skY:75},!0)):12===this.counterAnim?this.setPart(this.part8,{x:55,y:94,angle:0,scX:1,scY:1,skX:-135,skY:-135,alpha:1},!0):13===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,8,{x:49,y:95,skX:-150,skY:-150},!0),e.GameManager.instance.level.setSimpleTween(this.part5,4,{x:57,y:66,skX:-51,skY:-51},!0)):14===this.counterAnim?this.setPart(this.part11,{x:59,y:53,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0):17===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part5,7,{x:60,y:81,skX:-75,skY:-75},!0),e.GameManager.instance.level.setSimpleTween(this.part7,9,{x:31,skX:11,skY:11},!0),this.setPart(this.part9,{x:49,y:51,angle:0,scX:1,scY:1,skX:90,skY:90,alpha:1},!0)):18===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2,6,{x:91,y:69,skX:135,skY:135},!0):19===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part3,7,{x:87,y:50,skX:90,skY:90},!0):21===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,7,{x:56,skX:-120,skY:-120},!0),e.GameManager.instance.level.setSimpleTween(this.part10,6,{x:37,y:49,skX:60,skY:60},!0)):22===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,8,{x:67,y:78,skX:-57,skY:-57},!0):24===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,8,{x:64,skX:15,skY:15},!0),this.setPart(this.part5,{x:60,y:81,angle:0,scX:1,scY:1,skX:-75,skY:-75,alpha:1},!0),this.setPart(this.part6,{x:84,y:35,angle:0,scX:1,scY:1,skX:53,skY:53,alpha:1},!0)):26===this.counterAnim?(this.setPart(this.part3,{x:87,y:50,angle:0,scX:1,scY:1,skX:90,skY:90,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.part7,5,{x:37,y:49,skX:26,skY:26},!0)):27===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part10,7,{x:42,y:57,skX:75,skY:75},!0):28===this.counterAnim?this.setPart(this.part1,{x:56,y:95,angle:0,scX:1,scY:1,skX:-120,skY:-120,alpha:1},!0):30===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part4,4,{y:68,skX:-42,skY:-42},!0):31===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part7,7,{y:53},!0):32===this.counterAnim?this.setPart(this.part2,{x:64,y:69,angle:0,scX:1,scY:1,skX:15,skY:15,alpha:1},!0):34===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part4,4,{y:78,skX:-57,skY:-57},!0),this.setPart(this.part10,{x:42,y:57,angle:0,scX:1,scY:1,skX:75,skY:75,alpha:1},!0)):38===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:12,y:12,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part2,{x:64,y:3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part3,{x:34,y:3,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part4,{x:95,y:29,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part5,{x:76,y:40,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part6,{x:52,y:20,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part7,{x:17,y:35,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part8,{x:33,y:47,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part9,{x:15,y:50,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part10,{x:0,y:31,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part11,{x:76,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0))},i.prototype.free=function(){this.group=null,this.part11=null,this.part10=null,this.part9=null,this.part8=null,this.part7=null,this.part6=null,this.part5=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl9Room6BrokeFreeze=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this,a=e.GameManager.instance.hero.bodyBase.x,n=e.GameManager.instance.hero.bodyBase.y;return e.GameManager.instance.hero.setVisibility(!1),s.startFreeze=e.GameManager.instance.layerElements.create(a-65,n-46,"level9"),s.startFreeze.animations.add("anim",Phaser.Animation.generateFrameNames("FrozenWheely instance 1",0,39,"",4),40,!1),s.startFreeze.animations.play("anim"),s.brokeFreeze=new e.Lvl9Room6BrokeFreeze(i),s.brokeFreeze.group.x=a-63,s.brokeFreeze.group.y=n-38,e.GameManager.instance.layerElements.addChild(s.brokeFreeze.group),s.brokeFreeze.group.visible=!1,s.freezeBuble=new e.Lvl9Room6WheelyFreeze(i),s.freezeBuble.group.x=a,s.freezeBuble.group.y=n,e.GameManager.instance.layerElements.addChild(s.freezeBuble.group),s.freezeBuble.playAnim("anim"),s}return __extends(i,t),i.prototype.playBroke=function(){this.startFreeze.destroy(),this.brokeFreeze.group.visible=!0,this.brokeFreeze.playAnim("anim")},i.prototype.update=function(){t.prototype.update.call(this),this.freezeBuble.update(),this.brokeFreeze.update()},i.prototype.free=function(){this.startFreeze=null,this.freezeBuble.free(),this.freezeBuble=null,this.brokeFreeze.free(),this.brokeFreeze=null},i}(e.BasicSimpleAnim);e.Lvl9Room6FrostWheely=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.part4=new e.SASprite(i,0,0,"level9","room6HammerPart4 instance 10000"),s.part4.pivot.set(15,46),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level9","room6HammerPart3 instance 10000"),s.part3.pivot.set(19,22),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level9","room6HammerPart2 instance 10000"),s.part2.pivot.set(34,11),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level9","room6HammerPart1 instance 10000"),s.group.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(this.setPart(this.part1,{x:-33,y:-11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part2,18,{y:45}),e.GameManager.instance.level.setSimpleTween(this.part3,18,{y:-4}),e.GameManager.instance.level.setSimpleTween(this.part4,18,{y:40})):19===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,7,{x:-22,y:40,skX:-36,skY:-36}),e.GameManager.instance.level.setSimpleTween(this.part3,7,{x:3,y:5,skX:-96,skY:-96}),e.GameManager.instance.level.setSimpleTween(this.part4,7,{x:-26,y:29,skX:41,skY:41})):26===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,3,{y:43,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.part3,3,{x:4,y:13,skX:-108,skY:-108}),e.GameManager.instance.level.setSimpleTween(this.part4,3,{x:-27,y:28,skX:43,skY:43})):29===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,2,{x:-20,y:48,skX:-17,skY:-17,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.part3,2,{x:7,y:24,skX:-112,skY:-112})):31===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,12,{x:-1,y:69,skX:1,skY:1}),e.GameManager.instance.level.setSimpleTween(this.part3,12,{x:27,y:56,skX:-117,skY:-117}),e.GameManager.instance.level.setSimpleTween(this.part4,12,{x:-16,y:36,skX:24,skY:24,scX:.99,scY:.99})):43===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,19,{x:3,y:71,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.part3,19,{x:50,y:66,skX:-28,skY:-28,scX:.99,scY:.99}),e.GameManager.instance.level.setSimpleTween(this.part4,19,{x:-14,y:37,skX:20,skY:20})):62===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:23,y:84,skX:21,skY:21}),e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:68,y:89,skX:-27,skY:-27}),e.GameManager.instance.level.setSimpleTween(this.part4,15,{x:-2,y:40,skX:2,skY:2})):77===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,10,{x:21,y:85,skX:24,skY:24}),e.GameManager.instance.level.setSimpleTween(this.part3,10,{x:67,y:99,skX:5,skY:5}),e.GameManager.instance.level.setSimpleTween(this.part4,10,{x:-3,skX:3,skY:3})):87===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,7,{x:22,y:83,skX:19,skY:19}),e.GameManager.instance.level.setSimpleTween(this.part3,7,{x:68,y:88,skX:-20,skY:-20})):94===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,23,{x:-21,y:44,skX:-24,skY:-24}),e.GameManager.instance.level.setSimpleTween(this.part3,23,{x:21,y:40,skX:39,skY:39}),e.GameManager.instance.level.setSimpleTween(this.part4,23,{x:-26,y:29,skX:42,skY:42})):117===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:-18,y:49,skX:-19,skY:-19}),e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:28,y:44,skX:26,skY:26}),e.GameManager.instance.level.setSimpleTween(this.part4,15,{x:-25,y:30,skX:40,skY:40})):132===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:-33,y:-11,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:2,y:-32,angle:0,scX:1,scY:1,skX:-93,skY:-93,alpha:1}),this.setPart(this.part3,{x:1,y:-81,angle:0,scX:1,scY:1,skX:-91,skY:-91,alpha:1}),this.setPart(this.part4,{x:0,y:-37,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl9Room6Hammer=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.part7=new e.SASprite(i,0,0,"level9","room6SprayPart3 instance 10000"),s.part7.pivot.set(6,31),s.group.addChild(s.part7),s.part6=new e.SASprite(i,0,0,"level9","room6SprayPart3 instance 10000"),s.part6.pivot.set(6,31),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level9","room6SprayPart3 instance 10000"),s.part5.pivot.set(6,31),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level9","room6SprayPart3 instance 10000"),s.part4.pivot.set(6,31),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level9","room6SprayPart3 instance 10000"),s.part3.pivot.set(6,31),s.group.addChild(s.part3),s.head=new e.Lvl9Room6SprayHead(i),s.group.addChild(s.head.group),s.part2=new e.SASprite(i,0,0,"level9","room6SprayPart2 instance 10000"),s.part2.pivot.set(11,37),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level9","room6SprayPart1 instance 10000"),s.part1.pivot.set(7,38),s.group.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this),this.head.update()},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(10===this.counterAnim?(this.setPart(this.part2,{x:37,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.head.group,15,{x:-3,y:-6,skX:14,skY:14}),e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:9,skX:12,skY:12}),e.GameManager.instance.level.setSimpleTween(this.part4,15,{x:16,y:1,skX:8,skY:8,scX:.96}),e.GameManager.instance.level.setSimpleTween(this.part5,15,{x:23,y:2,skX:3,skY:3,scX:1.01}),this.setPart(this.part6,{x:42,y:-1,angle:0,scX:.85,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part7,{x:46,y:-1,angle:0,scX:.85,scY:1,skX:0,skY:0,alpha:1})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,15,{x:8,y:-1,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.head.group,15,{x:-36,y:7,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.part3,15,{x:-24,y:2,skX:-15,skY:-15,scX:1.11}),e.GameManager.instance.level.setSimpleTween(this.part4,15,{x:-15,y:0,skX:-10,skY:-10,scX:1.17}),e.GameManager.instance.level.setSimpleTween(this.part5,15,{x:-6,y:0,skX:-7,skY:-7,scX:1.22}),e.GameManager.instance.level.setSimpleTween(this.part6,15,{x:23,y:-2,skX:-4,skY:-4,scX:1.22}),e.GameManager.instance.level.setSimpleTween(this.part7,15,{x:33,y:-2,scX:1.22})):40===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,10,{x:13,y:-2,skX:-3,skY:-3}),e.GameManager.instance.level.setSimpleTween(this.head.group,10,{x:-31,y:2,skX:-10,skY:-10}),e.GameManager.instance.level.setSimpleTween(this.part3,10,{x:-18,y:-1,skX:-8,skY:-8,scX:1.07}),e.GameManager.instance.level.setSimpleTween(this.part4,10,{x:-10,y:-1,skX:-6,skY:-6,scX:1.14}),e.GameManager.instance.level.setSimpleTween(this.part5,10,{x:-2,y:-1,skX:-5,skY:-5,scX:1.18}),e.GameManager.instance.level.setSimpleTween(this.part6,10,{x:26,y:-3,skX:-2,skY:-2,scX:1.16}),e.GameManager.instance.level.setSimpleTween(this.part7,10,{x:35,scX:1.16})):50===this.counterAnim?(this.head.start(),e.GameManager.instance.level.setSimpleTween(this.part2,10,{x:8,y:-1,skX:-5,skY:-5}),e.GameManager.instance.level.setSimpleTween(this.head.group,10,{x:-36,y:7,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.part3,10,{x:-24,y:2,skX:-15,skY:-15,scX:1.11}),e.GameManager.instance.level.setSimpleTween(this.part4,10,{x:-15,y:0,skX:-10,skY:-10,scX:1.17}),e.GameManager.instance.level.setSimpleTween(this.part5,10,{x:-6,y:0,skX:-7,skY:-7,scX:1.22}),e.GameManager.instance.level.setSimpleTween(this.part6,10,{x:23,y:-2,skX:-4,skY:-4,scX:1.22}),e.GameManager.instance.level.setSimpleTween(this.part7,10,{x:33,scX:1.22})):60===this.counterAnim?(this.setPart(this.part2,{x:8,y:-1,angle:0,scX:1,scY:1,skX:-5,skY:-5,alpha:1}),this.setPart(this.head.group,{x:-36,y:7,angle:0,scX:1,scY:1,skX:-17,skY:-17,alpha:1}),this.setPart(this.part3,{x:-24,y:2,angle:0,scX:1.11,scY:.93,skX:-15,skY:-15,alpha:1}),this.setPart(this.part4,{x:-15,y:0,angle:0,scX:1.17,scY:.92,skX:-10,skY:-10,alpha:1}),this.setPart(this.part5,{x:-6,y:0,angle:0,scX:1.22,scY:.93,skX:-7,skY:-7,alpha:1}),this.setPart(this.part6,{x:23,y:-2,angle:0,scX:1.22,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.part7,{x:33,y:-2,angle:0,scX:1.22,scY:1,skX:0,skY:0,alpha:1})):65===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,10,{x:7,y:-4}),e.GameManager.instance.level.setSimpleTween(this.head.group,10,{skX:-32,skY:-32}),e.GameManager.instance.level.setSimpleTween(this.part3,10,{y:0,skX:-27,skY:-27,scX:1.28}),e.GameManager.instance.level.setSimpleTween(this.part4,10,{x:-16,y:-2,skX:-16,skY:-16,scX:1.36}),e.GameManager.instance.level.setSimpleTween(this.part5,10,{x:-7,y:-4,scX:1.34}),e.GameManager.instance.level.setSimpleTween(this.part6,10,{x:22,y:-4,scX:1.33}),e.GameManager.instance.level.setSimpleTween(this.part7,10,{x:31,y:-3,scX:1.38})):75===this.counterAnim?(this.setPart(this.part2,{x:7,y:-4,angle:0,scX:1,scY:1,skX:-5,skY:-5,alpha:1}),this.setPart(this.head.group,{x:-36,y:7,angle:0,scX:1,scY:1,skX:-32,skY:-32,alpha:1}),this.setPart(this.part3,{x:-24,y:0,angle:0,scX:1.28,scY:.93,skX:-27,skY:-27,alpha:1}),this.setPart(this.part4,{x:-16,y:-2,angle:0,scX:1.36,scY:.92,skX:-16,skY:-16,alpha:1}),this.setPart(this.part5,{x:-7,y:-4,angle:0,scX:1.34,scY:.93,skX:-7,skY:-7,alpha:1}),this.setPart(this.part6,{x:22,y:-4,angle:0,scX:1.33,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.part7,{x:31,y:-3,angle:0,scX:1.38,scY:1,skX:0,skY:0,alpha:1})):84===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2,10,{x:8,y:-1}),e.GameManager.instance.level.setSimpleTween(this.head.group,10,{skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.part3,10,{y:2,skX:-15,skY:-15,scX:1.11}),e.GameManager.instance.level.setSimpleTween(this.part4,10,{x:-15,y:0,skX:-10,skY:-10,scX:1.17}),e.GameManager.instance.level.setSimpleTween(this.part5,10,{x:-6,y:0,scX:1.22}),e.GameManager.instance.level.setSimpleTween(this.part6,10,{x:23,y:-2,scX:1.22}),e.GameManager.instance.level.setSimpleTween(this.part7,10,{x:33,y:-2,scX:1.22})):94===this.counterAnim?(this.setPart(this.part2,{x:8,y:-1,angle:0,scX:1,scY:1,skX:-5,skY:-5,alpha:1}),this.setPart(this.head.group,{x:-36,y:7,angle:0,scX:1,scY:1,skX:-17,skY:-17,alpha:1}),this.setPart(this.part3,{x:-24,y:2,angle:0,scX:1.11,scY:.93,skX:-15,skY:-15,alpha:1}),this.setPart(this.part4,{x:-15,y:0,angle:0,scX:1.17,scY:.92,skX:-10,skY:-10,alpha:1}),this.setPart(this.part5,{x:-6,y:0,angle:0,scX:1.22,scY:.93,skX:-7,skY:-7,alpha:1}),this.setPart(this.part6,{x:23,y:-2,angle:0,scX:1.22,scY:1,skX:-4,skY:-4,alpha:1}),this.setPart(this.part7,{x:33,y:-2,angle:0,scX:1.22,scY:1,skX:0,skY:0,alpha:1})):100===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:43,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2,{x:37,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.head.group,{x:24,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:35,y:-1,angle:0,scX:.85,scY:.93,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:40,y:-1,angle:0,scX:.85,scY:.92,skX:0,skY:0,alpha:1}),this.setPart(this.part5,{x:45,y:-1,angle:0,scX:.85,scY:.93,skX:0,skY:0,alpha:1}),this.setPart(this.part6,{x:42,y:-1,angle:0,scX:.85,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part7,{x:46,y:-1,angle:0,scX:.85,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part7=null,this.part7=null,this.part6=null,this.part5=null,this.part4=null,this.part3=null,this.head.free(),this.head=null,this.part2=null},i}(e.BasicSimpleAnim);e.Lvl9Room6Spray=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.activeAsid=!1,s.counterAsid=0,s.startDefeat=!1,s.counterDefeat=0,s.asids=new Array,s.group=new e.SAGroup(i,0,0),s.part6=new e.SASprite(i,0,0,"level9","room6SprayHeadPart6 instance 10000"),s.part6.pivot.set(9,13),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level9","room6SprayHeadPart5 instance 10000"),s.part5.pivot.set(9,13),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level9","room6SprayHeadPart3 instance 10000"),s.part4.pivot.set(12,7),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level9","room6SprayHeadPart3 instance 10000"),s.part3.pivot.set(12,7),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level9","room6SprayHeadPart2 instance 10000"),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level9","room6SprayHeadPart1 instance 10000"),s.part1.pivot.set(16,16),s.group.addChild(s.part1),s.setParts("play"),s}return __extends(i,t),i.prototype.start=function(){this.playAnim("play")},i.prototype.update=function(){t.prototype.update.call(this),this.updateAsidParticle()},i.prototype.updateAsidParticle=function(){!1!==this.activeAsid&&(this.counterAsid+=1,this.counterAsid%2==0&&this.setAsid(6*Math.random()-15,8+6*Math.random(),160+20*Math.random(),1.2+1.2*Math.random()))},i.prototype.setAsid=function(e,t,i,s){for(var a=0;a<this.asids.length;a++)if(!1===this.asids[a].visible)return this.asids[a].x=e,this.asids[a].y=t,this.asids[a].angle=i,this.asids[a].scale.setTo(s),this.asids[a].animations.play("anim"),void(this.asids[a].visible=!0);var n=this.group.create(e,t,"level9");n.animations.add("anim",Phaser.Animation.generateFrameNames("frostParticle instance 1",0,14,"",4),30,!1).onComplete.add(this.asidPartComp,this),n.animations.play("anim"),n.angle=i,n.scale.setTo(s),this.asids.push(n),n=null},i.prototype.asidPartComp=function(e,t){e.visible=!1},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"play"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,15,{alpha:1},!0),this.setPart(this.part2,{x:-10,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),e.GameManager.instance.level.setSimpleTween(this.part3,10,{x:-24,y:-20,skX:-171,skY:9},!0),e.GameManager.instance.level.setSimpleTween(this.part4,10,{x:-24,y:20,skX:-10,skY:-10},!0),e.GameManager.instance.level.setSimpleTween(this.part5,15,{alpha:1},!0),this.setPart(this.part6,{x:-8,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0)):5===this.counterAnim?(this.activeAsid=!0,e.SoundManager.playSFX("s_lvl8_frostBeam",!0)):11===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part3,5,{y:-18,skX:180,skY:0},!0),e.GameManager.instance.level.setSimpleTween(this.part4,5,{y:17,skX:0,skY:0},!0)):16===this.counterAnim?(this.setPart(this.part1,{x:-12,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part3,{x:-24,y:-18,angle:0,scX:1,scY:1,skX:180,skY:0,alpha:1},!0),this.setPart(this.part4,{x:-24,y:17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part5,{x:-8,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0)):55===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,10,{alpha:0},!0),e.GameManager.instance.level.setSimpleTween(this.part3,10,{x:-6},!0),e.GameManager.instance.level.setSimpleTween(this.part4,10,{x:-6},!0),e.GameManager.instance.level.setSimpleTween(this.part5,10,{alpha:0},!0)):65===this.counterAnim?(this.setPart(this.part1,{x:-12,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0},!0),this.setPart(this.part3,{x:-6,y:-18,angle:0,scX:1,scY:1,skX:180,skY:0,alpha:1},!0),this.setPart(this.part4,{x:-6,y:17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part5,{x:-8,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0},!0)):66===this.counterAnim&&(this.animComplete(),this.activeAsid=!1,e.SoundManager.stopSFXLoop("s_lvl8_frostBeam"))))},i.prototype.setParts=function(e){"play"===e&&(this.setPart(this.part1,{x:-12,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0},!0),this.setPart(this.part2,{x:-10,y:-33,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part3,{x:-6,y:-18,angle:0,scX:1,scY:1,skX:180,skY:0,alpha:1},!0),this.setPart(this.part4,{x:-6,y:17,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0),this.setPart(this.part5,{x:-8,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:0},!0),this.setPart(this.part6,{x:-8,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1},!0))},i.prototype.free=function(){this.group=null,this.part6=null,this.part5=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null,this.asids=[],this.asids=null},i}(e.BasicSimpleAnim);e.Lvl9Room6SprayHead=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.group=i.make.group(),s.part12=new e.SASprite(i,0,0,"level9","fr1Part4 instance 10000"),s.part12.pivot.set(25,12),s.group.addChild(s.part12),s.part11=new e.SASprite(i,0,0,"level9","fr1Part6 instance 10000"),s.part11.pivot.set(18,10),s.group.addChild(s.part11),s.part10=new e.SASprite(i,0,0,"level9","fr1Part5 instance 10000"),s.part10.pivot.set(16,11),s.group.addChild(s.part10),s.part9=new e.SASprite(i,0,0,"level9","fr1Part4 instance 10000"),s.part9.pivot.set(25,12),s.group.addChild(s.part9),s.part8=new e.SASprite(i,0,0,"level9","fr1Part3 instance 10000"),s.part8.pivot.set(5,5),s.group.addChild(s.part8),s.part7=new e.SASprite(i,0,0,"level9","fr1Part3 instance 10000"),s.part7.pivot.set(5,5),s.group.addChild(s.part7),s.part6=new e.SASprite(i,0,0,"level9","fr1Part3 instance 10000"),s.part6.pivot.set(5,5),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level9","fr1Part3 instance 10000"),s.part5.pivot.set(5,5),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level9","fr1Part2 instance 10000"),s.part4.pivot.set(4,18),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level9","fr1Part1 instance 10000"),s.part3.pivot.set(8,14),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level9","fr1Part1 instance 10000"),s.part2.pivot.set(8,14),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level9","fr1Part1 instance 10000"),s.part1.pivot.set(8,14),s.group.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,47,{y:-52,skX:-3,skY:-5,scX:2.14,scY:.94,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part2,47,{x:-65,y:-6,skX:-35,skY:-44,scX:2.26,scY:1.02,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part3,29,{x:33,y:21,skX:13,skY:11,scX:1.6,scY:1.4,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part4,29,{x:-48,y:20,skX:3,scX:1.59,scY:1.4,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part9,24,{scX:1,scY:1,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part10,24,{scX:1,scY:1,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part11,24,{y:36,scX:1,scY:1,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part12,24,{scX:1,scY:1,alpha:1})):10===this.counterAnim?(this.part6.visible=!0,this.setPart(this.part6,{x:2,y:37,angle:0,scX:.3,scY:.3,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part6,15,{x:11,y:17,scX:1,scY:1}),this.part7.visible=!0,this.setPart(this.part7,{x:-21,y:36,angle:0,scX:.3,scY:.3,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part7,15,{x:-37,y:14,scX:1,scY:1}),this.part8.visible=!0,this.setPart(this.part8,{x:10,y:34,angle:0,scX:.39,scY:.39,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part8,15,{x:26,y:4,scX:1,scY:1})):13===this.counterAnim?(this.part5.visible=!0,this.setPart(this.part5,{x:-8,y:35,angle:0,scX:.36,scY:.36,skX:0,skY:0,alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part5,15,{x:-9,y:-1,scX:1.39,scY:1.39})):25===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part6,10,{y:28}),e.GameManager.instance.level.setSimpleTween(this.part7,10,{y:25}),e.GameManager.instance.level.setSimpleTween(this.part8,10,{y:25}),this.setPart(this.part9,{x:40,y:37,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),this.setPart(this.part10,{x:23,y:37,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part11,{x:-10,y:36,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part12,{x:-46,y:37,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):28===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part5,10,{y:22}):30===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part3,30,{x:30,y:34,skX:18,skY:10,scX:.36,scY:.13,alpha:.42}),e.GameManager.instance.level.setSimpleTween(this.part4,30,{x:-49,y:34,skX:7,scX:.36,scY:.13,alpha:.42})):35===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part6,3,{x:8,y:31,skX:-17,skY:-17}),e.GameManager.instance.level.setSimpleTween(this.part7,3,{x:-44,y:28,skX:-35,skY:-35}),e.GameManager.instance.level.setSimpleTween(this.part8,3,{x:29,y:28,skX:20,skY:20})):38===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part5,5,{x:-3,y:30,skX:31,skY:31}),this.setPart(this.part6,{x:8,y:31,angle:0,scX:1,scY:1,skX:-17,skY:-17,alpha:1}),this.setPart(this.part7,{x:-44,y:28,angle:0,scX:1,scY:1,skX:-35,skY:-35,alpha:1}),this.setPart(this.part8,{x:29,y:28,angle:0,scX:1,scY:1,skX:20,skY:20,alpha:1})):43===this.counterAnim?this.setPart(this.part5,{x:-3,y:30,angle:0,scX:1.39,scY:1.39,skX:31,skY:31,alpha:1}):48===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part1,30,{y:-39,skX:5,skY:-3,scX:.36,scY:.13,alpha:.42}),e.GameManager.instance.level.setSimpleTween(this.part2,30,{x:-58,y:6,skX:-28,skY:-42,scX:.37,scY:.14,alpha:.42})):61===this.counterAnim?(this.part3.visible=!1,this.part4.visible=!1):78===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:-9,y:-39,angle:0,scX:.36,scY:.13,skX:5,skY:-3,alpha:.42}),this.setPart(this.part2,{x:-58,y:6,angle:0,scX:.37,scY:.14,skX:-28,skY:-42,alpha:.42}),this.setPart(this.part3,{x:30,y:34,angle:0,scX:.36,scY:.13,skX:18,skY:10,alpha:.42}),this.setPart(this.part4,{x:-49,y:34,angle:0,scX:.36,scY:.13,skX:7,skY:0,alpha:.42}),this.part5.visible=!1,this.part6.visible=!1,this.part7.visible=!1,this.part8.visible=!1,this.setPart(this.part9,{x:40,y:37,angle:0,scX:.36,scY:.19,skX:0,skY:180,alpha:0}),this.setPart(this.part10,{x:23,y:37,angle:0,scX:.33,scY:.14,skX:0,skY:0,alpha:0}),this.setPart(this.part11,{x:-10,y:37,angle:0,scX:.25,scY:.12,skX:0,skY:0,alpha:0}),this.setPart(this.part12,{x:-46,y:37,angle:0,scX:.36,scY:.19,skX:0,skY:0,alpha:0}))},i.prototype.free=function(){this.group=null,this.part12=null,this.part11=null,this.part10=null,this.part9=null,this.part8=null,this.part7=null,this.part6=null,this.part5=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl9Room6WheelyFreeze=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e){var i=t.call(this,e,7)||this;return i.startFire=!1,i.fireCounter=0,i.startDefeat=!1,i.counterDefeat=0,i.createBg(),i.createElements(),i.createDoors(),i.createWalls(5),i.createFront(),i.hide(),i.addMask(i.groupFront),i.x=890,i.y=995,i}return __extends(i,t),i.prototype.createElements=function(){this.fireCannon1=new e.Lvl9Room7FireCannon(this.game,-1),this.fireCannon1.group.x=-164,this.fireCannon1.group.y=157,this.groupFront.addChild(this.fireCannon1.group),this.fireCannon2=new e.Lvl9Room7FireCannon(this.game,1),this.fireCannon2.group.x=164,this.fireCannon2.group.y=157,this.groupFront.addChild(this.fireCannon2.group)},i.prototype.activate=function(e){void 0===e&&(e=!0),t.prototype.activate.call(this,e),this.fireCannon1.start(),this.fireCannon2.start(),this.startFire=!0},i.prototype.update=function(){t.prototype.update.call(this),this.fireCannon1.update(),this.fireCannon2.update(),!0===this.startFire&&(this.fireCounter+=1,60===this.fireCounter?e.GameManager.instance.hero.currEyesState=e.EyesState.afraid:85===this.fireCounter?e.GameManager.instance.hero.addBurn():100===this.fireCounter&&(this.startDefeat=!0)),!0===this.startFire&&(this.counterDefeat+=1,160===this.counterDefeat&&(this.startDefeat=!1,e.LevelBuilder.instance.levelFailed()))},i.prototype.free=function(){t.prototype.free.call(this),this.fireCannon1.free(),this.fireCannon1=null,this.fireCannon2.free(),this.fireCannon2=null},i}(e.Lvl9BasicRoom);e.Lvl9Room7=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i){var s=t.call(this,i)||this;return s.activeAsid=!1,s.counterAsid=0,s.asids=new Array,s.group=new e.SAGroup(i,0,0),s.part12=new e.SASprite(i,0,0,"level9","room8firePart12 instance 10000"),s.part12.pivot.set(8,11),s.part12.animations.add("activate",Phaser.Animation.generateFrameNames("room8firePart12 instance 1",0,15,"",4),30,!1),s.part12.animations.add("deactivate",Phaser.Animation.generateFrameNames("room8firePart12 instance 1",15,0,"",4),30,!1),s.group.addChild(s.part12),s.part11=new e.SASprite(i,0,0,"level9","room8firePart11 instance 10000"),s.part11.pivot.set(14,18),s.group.addChild(s.part11),s.part10=new e.SASprite(i,0,0,"level9","room8firePart10 instance 10000"),s.part10.pivot.set(8,10),s.group.addChild(s.part10),s.part9=new e.SASprite(i,0,0,"level9","room8firePart9 instance 10000"),s.part9.pivot.set(7,10),s.group.addChild(s.part9),s.part8=new e.SASprite(i,0,0,"level9","room8firePart8 instance 10000"),s.part8.pivot.set(10,9),s.group.addChild(s.part8),s.part7=new e.SASprite(i,0,0,"level9","room8firePart7 instance 10000"),s.part7.pivot.set(7,6),s.group.addChild(s.part7),s.part6=new e.SASprite(i,0,0,"level9","room8firePart6 instance 10000"),s.part6.pivot.set(4,5),s.group.addChild(s.part6),s.part5=new e.SASprite(i,0,0,"level9","room8firePart5 instance 10000"),s.part5.pivot.set(3,2),s.group.addChild(s.part5),s.part4=new e.SASprite(i,0,0,"level9","room8firePart4 instance 10000"),s.part4.pivot.set(16,6),s.group.addChild(s.part4),s.part3=new e.SASprite(i,0,0,"level9","room8firePart3 instance 10000"),s.part3.pivot.set(18,19),s.group.addChild(s.part3),s.part2=new e.SASprite(i,0,0,"level9","room8firePart2 instance 10000"),s.part2.pivot.set(42,42),s.group.addChild(s.part2),s.part1=new e.SASprite(i,0,0,"level9","room8firePart1 instance 10000"),s.part1.pivot.set(4,13),s.group.addChild(s.part1),s.setParts("anim"),s}return __extends(i,t),i.prototype.update=function(){t.prototype.update.call(this),this.updateAsidParticle()},i.prototype.updateAsidParticle=function(){!1!==this.activeAsid&&(this.counterAsid+=1,this.counterAsid%2==0&&this.setAsid(6*Math.random()-3,6*Math.random()-78,20*Math.random()-100,1.5+1.5*Math.random()))},i.prototype.setAsid=function(e,t,i,s){for(var a=0;a<this.asids.length;a++)if(!1===this.asids[a].visible)return this.asids[a].x=e,this.asids[a].y=t,this.asids[a].angle=i,this.asids[a].scale.setTo(s),this.asids[a].animations.play("anim"),void(this.asids[a].visible=!0);var n=this.group.create(e,t,"level9");n.animations.add("anim",Phaser.Animation.generateFrameNames("fireEmitter instance 1",0,17,"",4),30,!1).onComplete.add(this.asidPartComp,this),n.animations.play("anim"),n.anchor.y=.5,n.angle=i,n.scale.setTo(s),this.asids.push(n),n=null},i.prototype.asidPartComp=function(e,t){e.visible=!1},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(7===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,3,{x:-10,y:-75,skX:-5,skY:-5,scY:1.03}):10===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part1,4,{x:-9,y:-74,skX:3,skY:3,scY:1}):15===this.counterAnim?(this.part12.animations.play("activate"),e.GameManager.instance.level.setSimpleTween(this.part1,10,{y:-77,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part2,10,{alpha:1}),e.GameManager.instance.level.setSimpleTween(this.part4,10,{y:-59}),e.GameManager.instance.level.setSimpleTween(this.part5,10,{x:-14,y:-41,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part6,10,{x:13,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.part7,10,{x:9,y:-28,skX:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part8,10,{x:-7,y:-35,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part9,10,{x:8,y:-52,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part10,10,{x:-10,y:-53,skX:0,skY:0,scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part11,10,{scX:1,scY:1}),e.GameManager.instance.level.setSimpleTween(this.part12,10,{y:-73})):60===this.counterAnim?(this.part12.animations.play("deactivate"),this.activeAsid=!0,e.GameManager.instance.level.setSimpleTween(this.part1,10,{y:-74,skX:3,skY:3}),e.GameManager.instance.level.setSimpleTween(this.part2,10,{alpha:.3}),e.GameManager.instance.level.setSimpleTween(this.part4,10,{y:-57}),e.GameManager.instance.level.setSimpleTween(this.part5,10,{x:-12,y:-38,skX:9,skY:17,scX:1.28,scY:1.47}),e.GameManager.instance.level.setSimpleTween(this.part6,10,{x:10,skX:22,skY:22}),e.GameManager.instance.level.setSimpleTween(this.part7,10,{x:5,y:-30,skX:-8,scX:1.05,scY:1.18}),e.GameManager.instance.level.setSimpleTween(this.part8,10,{x:-5,y:-32,skX:6,skY:12,scX:.97,scY:1.09}),e.GameManager.instance.level.setSimpleTween(this.part9,10,{x:6,y:-50,scX:1.04,scY:1.04}),e.GameManager.instance.level.setSimpleTween(this.part10,10,{x:-8,y:-51,skX:-4,skY:-4,scX:1.04,scY:1.04}),e.GameManager.instance.level.setSimpleTween(this.part11,10,{scX:.89,scY:.89}),e.GameManager.instance.level.setSimpleTween(this.part12,10,{y:-71})):110===this.counterAnim&&(this.animComplete(),this.activeAsid=!1)))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:-9,y:-74,angle:0,scX:1,scY:1,skX:3,skY:3,alpha:1}),this.setPart(this.part2,{x:0,y:-39,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:.3}),this.setPart(this.part3,{x:0,y:-10,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part4,{x:0,y:-57,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part5,{x:-12,y:-38,angle:0,scX:1.28,scY:1.47,skX:9,skY:17,alpha:1}),this.setPart(this.part6,{x:10,y:-40,angle:0,scX:1,scY:1,skX:22,skY:22,alpha:1}),this.setPart(this.part7,{x:5,y:-30,angle:0,scX:1.05,scY:1.18,skX:-8,skY:0,alpha:1}),this.setPart(this.part8,{x:-5,y:-32,angle:0,scX:.97,scY:1.09,skX:6,skY:12,alpha:1}),this.setPart(this.part9,{x:6,y:-50,angle:0,scX:1.04,scY:1.04,skX:0,skY:0,alpha:1}),this.setPart(this.part10,{x:-8,y:-51,angle:0,scX:1.04,scY:1.04,skX:-4,skY:-4,alpha:1}),this.setPart(this.part11,{x:-1,y:-38,angle:0,scX:.89,scY:.89,skX:0,skY:0,alpha:1}),this.setPart(this.part12,{x:0,y:-71,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part12=null,this.part11=null,this.part10=null,this.part9=null,this.part8=null,this.part7=null,this.part6=null,this.part5=null,this.part4=null,this.part3=null,this.part2=null,this.part1=null,this.asids=[],this.asids=null},i}(e.BasicSimpleAnim);e.Lvl9Room7Fire=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){void 0===s&&(s=1);var a=t.call(this,i)||this;return a.group=i.make.group(),a.group.scale.x=s,a.part3=new e.SASprite(i,0,0,"level9","room8fcpart3 instance 10000"),a.part3.pivot.set(17,14),a.group.addChild(a.part3),a.part2=new e.Lvl9Room7Fire(i),a.group.addChild(a.part2.group),a.part1=new e.SASprite(i,0,0,"level9","room8fcpart1 instance 10000"),a.part1.pivot.set(39,6),a.group.addChild(a.part1),a.setParts("anim"),a}return __extends(i,t),i.prototype.start=function(){this.playAnim("anim"),e.SoundManager.playSFX("s_lvl8_flamethrower")},i.prototype.update=function(){t.prototype.update.call(this),this.part2.update()},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"anim"===this.currAnim&&(15===this.counterAnim?(this.part2.playAnim("anim"),e.GameManager.instance.level.setSimpleTween(this.part2.group,19,{y:-20}),e.GameManager.instance.level.setSimpleTween(this.part3,19,{y:-22})):34===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.part2.group,5,{y:-16}),e.GameManager.instance.level.setSimpleTween(this.part3,5,{y:-18})):45===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2.group,11,{skX:-23,skY:-23}):56===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2.group,4,{skX:-42,skY:-42}):60===this.counterAnim?this.setPart(this.part2.group,{x:2,y:-16,angle:0,scX:1,scY:1,skX:-42,skY:-42,alpha:1}):61===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2.group,2,{skX:-39,skY:-39}):63===this.counterAnim?e.GameManager.instance.level.setSimpleTween(this.part2.group,3,{skX:-42,skY:-42}):90===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"anim"===e&&(this.setPart(this.part1,{x:2,y:-4,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part2.group,{x:2,y:87,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.part3,{x:4,y:86,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}))},i.prototype.free=function(){this.group=null,this.part3=null,this.part2.free(),this.part2=null,this.part1=null},i}(e.BasicSimpleAnim);e.Lvl9Room7FireCannon=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e){var i=t.call(this,e,8)||this;return i.leverActive=!1,i.startDefeat=!1,i.counterDefeat=0,i.trianglesDeactived=!1,i.contactHeroCount=0,i.createBg(),i.createElements(),i.createDoors(),i.createWalls(i.id),i.createFront(),i.hide(),i.addMask(i.groupBack),i.x=1430,i.y=995,i}return __extends(i,t),i.prototype.createElements=function(){this.bodylaser=new Phaser.Physics.Box2D.Body(this.game,null,1430,995,0),this.bodylaser.setRectangle(10,160,-155),this.bodylaser.addRectangle(10,160,160),this.bodylaser.sensor=!0,this.laser1=this.createLaser(-152,-93),this.laser2=this.createLaser(-152,-72,90),this.laser3=this.createLaser(171,-72,90,.9),this.laser4=this.createLaser(-152,-82,-45),this.laser5=this.createLaser(157,-70,140),this.laser6=this.createLaser(157,-70,58),this.laser7=this.createLaser(157,-70,-30),this.laser8=this.createLaser(159,-70,0),this.lever=this.groupBack.create(-130,135,"level9","room8Lever instance 10000"),this.lever.anchor.setTo(.5,1),this.lever.angle=32,this.lever.events.onInputDown.add(this.leverDown,this),this.lever.events.onInputOut.add(this.leverOut,this),this.lever.events.onInputOver.add(this.leverOver,this);var e=this.groupBack.create(-149,121,"level9","room8Bg1 instance 10000");e.anchor.setTo(.5),e.cacheAsBitmap=!0,(e=this.groupBack.create(182,129,"level9","room8Bg2 instance 10000")).anchor.setTo(.5),e.cacheAsBitmap=!0,this.trap1=this.groupBack.create(113,102,"level9","room8Traps instance 10000"),this.trap1.animations.add("anim",Phaser.Animation.generateFrameNames("room8Traps instance 1",0,14,"",4),30,!1),this.trap2=this.groupBack.create(208,102,"level9","room8Traps instance 10000"),this.trap2.animations.add("anim",Phaser.Animation.generateFrameNames("room8Traps instance 1",0,14,"",4),30,!1),this.trap2.scale.x=-1,this.blue=this.groupBack.create(160,124,"level9","room8Blue instance 10000"),this.blue.anchor.setTo(.5),this.blue.alpha=0,this.triangle1=this.groupBack.create(-157,-93,"level9","room8Triangle instance 10000"),this.triangle1.pivot.set(30,28),this.triangle1.events.onInputDown.add(this.triangleDown,this),this.triangle1.events.onInputOut.add(this.triangleOut,this),this.triangle1.events.onInputOver.add(this.triangleOver,this),this.triangle2=this.groupBack.create(171,-83,"level9","room8Triangle instance 10000"),this.triangle2.pivot.set(30,28),this.triangle2.scale.y=-1,this.triangle2.angle=-65,this.triangle2.events.onInputDown.add(this.triangleDown,this),this.triangle2.events.onInputOut.add(this.triangleOut,this),this.triangle2.events.onInputOver.add(this.triangleOver,this),e=null},i.prototype.createLaser=function(e,t,i,s){void 0===i&&(i=0),void 0===s&&(s=1);var a=this.groupBack.create(e,t,"level9","room8Laser instance 10000");return a.anchor.x=.5,a.angle=i,a.scale.y=s,a.animations.add("anim",Phaser.Animation.generateFrameNames("room8Laser instance 1",0,11,"",4),30,!0),a.visible=!1,a},i.prototype.triangleOut=function(e){!0===e.inputEnabled&&(e.frameName="room8Triangle instance 10001")},i.prototype.triangleOver=function(e){!0===e.inputEnabled&&(e.frameName="room8Triangle instance 10002")},i.prototype.triangleDown=function(t){t.angle-=30,e.SoundManager.playSFX("s_lvl8_trianglesRotate"),!0===this.leverActive&&this.activateLasers()},i.prototype.leverOut=function(){!0===this.lever.inputEnabled&&(this.lever.frameName="room8Lever instance 10002")},i.prototype.leverOver=function(){!0===this.lever.inputEnabled&&(this.lever.frameName="room8Lever instance 10001")},i.prototype.leverDown=function(){"used"!==this.lever.name&&(this.lever.name="used",32===this.lever.angle?(this.leverActive=!0,this.activateLasers(),this.game.add.tween(this.lever).to({angle:70},500,Phaser.Easing.Linear.None,!0).onComplete.addOnce(this.completeRotation,this)):(this.leverActive=!1,this.blue.alpha=0,this.deactivateLasers(),!0===this.trianglesDeactived&&(this.lever.inputEnabled=!1,this.lever.frameName="room8Lever instance 10000"),this.game.add.tween(this.lever).to({angle:32},500,Phaser.Easing.Linear.None,!0).onComplete.addOnce(this.completeRotation,this)))},i.prototype.completeRotation=function(e){this.lever.name=""},i.prototype.activateLasers=function(){this.deactivateLasers(),this.laser1.visible=!0,this.laser1.animations.play("anim");var t=Math.round(this.triangle1.angle),i=Math.round(this.triangle2.angle);30===t?(this.laser2.visible=!0,this.laser2.animations.play("anim")):-30===t?(this.laser4.visible=!0,this.laser4.animations.play("anim"),this.startDefeat=!0,this.deactivateTriangles(),e.GameManager.instance.hero.addShock()):-60===t&&(this.laser3.visible=!0,this.laser3.animations.play("anim"),-65===i?(this.laser5.visible=!0,this.laser5.animations.play("anim")):-95===i?(this.laser6.visible=!0,this.laser6.animations.play("anim"),this.startDefeat=!0,this.deactivateTriangles(),e.GameManager.instance.hero.addShock()):-125===i?(this.laser8.visible=!0,this.laser8.animations.play("anim"),this.activateDoors()):-155===i&&(this.laser7.visible=!0,this.laser7.animations.play("anim")))},i.prototype.deactivateLasers=function(){this.laser1.visible=!1,this.laser1.animations.stop("anim",!0),this.laser2.visible=!1,this.laser2.animations.stop("anim",!0),this.laser3.visible=!1,this.laser3.animations.stop("anim",!0),this.laser4.visible=!1,this.laser4.animations.stop("anim",!0),this.laser5.visible=!1,this.laser5.animations.stop("anim",!0),this.laser6.visible=!1,this.laser6.animations.stop("anim",!0),this.laser7.visible=!1,this.laser7.animations.stop("anim",!0),this.laser8.visible=!1,this.laser8.animations.stop("anim",!0)},i.prototype.activateDoors=function(){this.doors[1].activate(),this.doors[3].activate(),this.game.add.tween(this.blue).to({alpha:1},500,Phaser.Easing.Linear.None,!0),this.deactivateTriangles(),this.trap1.animations.play("anim"),this.trap2.animations.play("anim"),e.SoundManager.playSFX("s_lvl8_platformMove"),this.bodylaser.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.contactHero,this)},i.prototype.deactivateTriangles=function(){this.trianglesDeactived=!0,this.triangle1.inputEnabled=!1,this.triangle1.frameName="room8Triangle instance 10000",this.triangle2.inputEnabled=!1,this.triangle2.frameName="room8Triangle instance 10000"},i.prototype.activate=function(e){void 0===e&&(e=!0),t.prototype.activate.call(this,e),this.triangle1.inputEnabled=!0,this.triangle1.input.useHandCursor=!0,this.triangleOut(this.triangle1),this.triangle2.inputEnabled=!0,this.triangle2.input.useHandCursor=!0,this.triangleOut(this.triangle2),this.lever.inputEnabled=!0,this.lever.input.useHandCursor=!0,this.leverOut()},i.prototype.update=function(){t.prototype.update.call(this),!0===this.startDefeat&&(this.counterDefeat+=1,70===this.counterDefeat&&(this.startDefeat=!1,e.LevelBuilder.instance.levelFailed()))},i.prototype.contactHero=function(){!0===this.leverActive&&0===this.contactHeroCount&&(this.contactHeroCount=1,this.startDefeat=!0,this.deactivateTriangles(),e.GameManager.instance.hero.addShock(),e.GameManager.instance.level.customAction(6))},i.prototype.free=function(){t.prototype.free.call(this),this.blue=null,this.trap1=null,this.trap2=null,this.triangle1=null,this.triangle2=null,this.lever=null,this.laser1=null,this.laser2=null,this.laser3=null,this.laser4=null,this.laser5=null,this.laser6=null,this.laser7=null,this.laser8=null,this.bodylaser=null},i}(e.Lvl9BasicRoom);e.Lvl9Room8=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t){var i=e.call(this,t,9)||this;return i.createBg(),i.createDoors(),i.createWalls(5),i.createFront(),i.hide(),i.x=1970,i.y=995,i}return __extends(t,e),t.prototype.activateDoors=function(){this.doors[0].activate(),this.doors[1].activate()},t.prototype.activate=function(t){void 0===t&&(t=!0),e.prototype.activate.call(this,t),this.activateDoors()},t}(e.Lvl9BasicRoom);e.Lvl9Room9=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this,i)||this;return a.opened=!1,a.id=s,a.group=i.make.group(),a.gear2=new e.SASprite(i,0,0,"level9","roomDoorGear instance 10000"),a.gear2.anchor.setTo(.5),a.group.addChild(a.gear2),a.gear1=new e.SASprite(i,0,0,"level9","roomDoorGear instance 10000"),a.gear1.anchor.setTo(.5),a.group.addChild(a.gear1),a.door2=new e.SASprite(i,0,0,"level9","roomDoor instance 10000"),a.door2.pivot.set(1,7),a.group.addChild(a.door2),a.door1=new e.SASprite(i,0,0,"level9","roomDoor instance 10000"),a.door1.pivot.set(1,7),a.group.addChild(a.door1),a.btn=a.group.create(0,0,"level9","roomDoorActive instance 10000"),a.btn.anchor.setTo(.5),a.btn.events.onInputOut.add(a.out,a),a.btn.events.onInputOver.add(a.over,a),a.btn.events.onInputDown.add(a.down,a),a.deactivate(),a.setParts("open"),a}return __extends(i,t),i.prototype.out=function(){!0===this.btn.inputEnabled&&(this.btn.frameName="roomDoorActive instance 10000")},i.prototype.over=function(){!0===this.btn.inputEnabled&&(this.btn.frameName="roomDoorActive instance 10001")},i.prototype.down=function(){e.GameManager.instance.level.customAction(this.id)},i.prototype.activate=function(){this.btn.inputEnabled=!0,this.btn.input.useHandCursor=!0,this.btn.visible=!0,this.out()},i.prototype.deactivate=function(){this.btn.inputEnabled=!1,this.btn.visible=!1},i.prototype.open=function(){this.deactivate(),this.playAnim("open"),this.opened=!0},i.prototype.close=function(){this.playAnim("close"),this.opened=!1},i.prototype.updateAnimation=function(){!1!==this.activeAnim&&(this.counterAnim+=1,"open"===this.currAnim?1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.door1,20,{x:67}),e.GameManager.instance.level.setSimpleTween(this.door2,20,{x:-67}),e.GameManager.instance.level.setSimpleTween(this.gear1,20,{x:-137,skX:179,skY:179}),e.GameManager.instance.level.setSimpleTween(this.gear2,20,{x:137,skX:-179,skY:-179})):21===this.counterAnim&&this.animComplete():"close"===this.currAnim&&(1===this.counterAnim?(e.GameManager.instance.level.setSimpleTween(this.door1,20,{x:0}),e.GameManager.instance.level.setSimpleTween(this.door2,20,{x:0}),e.GameManager.instance.level.setSimpleTween(this.gear1,20,{x:-70,skX:0,skY:0}),e.GameManager.instance.level.setSimpleTween(this.gear2,20,{x:70,skX:0,skY:0})):21===this.counterAnim&&this.animComplete()))},i.prototype.setParts=function(e){"open"===e?(this.setPart(this.door1,{x:0,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.door2,{x:0,y:0,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),this.setPart(this.gear1,{x:-70,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.gear2,{x:70,y:7,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1})):"close"===e&&(this.setPart(this.door1,{x:67,y:0,angle:0,scX:1,scY:1,skX:0,skY:0,alpha:1}),this.setPart(this.door2,{x:-67,y:0,angle:0,scX:1,scY:1,skX:0,skY:180,alpha:1}),this.setPart(this.gear1,{x:-137,y:7,angle:0,scX:1,scY:1,skX:179,skY:179,alpha:1}),this.setPart(this.gear2,{x:137,y:7,angle:0,scX:1,scY:1,skX:-179,skY:-179,alpha:1}))},i.prototype.free=function(){this.group=null,this.gear2=null,this.gear1=null,this.door2=null,this.door1=null},i}(e.BasicSimpleAnim);e.Lvl9RoomDoor=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(e){function t(t,i,s,a,n){void 0===a&&(a=null),void 0===n&&(n=null);var o=e.call(this,t,i,s,a,n)||this;return o.anchor.setTo(.5),o}return __extends(t,e),t.prototype.update=function(){this.rotation+=.02},t}(Phaser.Image);e.PunktirCircle=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(e,t,i){this.lifeTime=0,this.randDirection=0,this.counter=0,this.speed=0,this.rot=0,this.star=e.add.sprite(t,i,"ui","questStar instance 10000"),this.star.anchor.set(.5),this.star.scale.set(e.rnd.integerInRange(30,100)/100),this.lifeTime=e.rnd.integerInRange(20,35),this.speed=e.rnd.integerInRange(5,10)/10,this.rot=e.rnd.integerInRange(-1,1),this.randDirection=Phaser.Math.degToRad(e.rnd.integerInRange(0,360))}return e.prototype.update=function(){if(null!==this.star){if(this.star.alpha<=0)return this.star.destroy(),void(this.star=null);this.counter+=1,this.counter>=this.lifeTime&&(this.star.alpha-=.03,this.star.scale.x-=.01,this.star.scale.y-=.01),this.star.x-=Math.cos(this.randDirection)*this.speed,this.star.y-=Math.sin(this.randDirection)*this.speed,this.star.angle+=this.speed*this.rot*3}},e}();e.Star=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(e,t,i,s,a){void 0===t&&(t=3),void 0===i&&(i=5),void 0===s&&(s=0),void 0===a&&(a=-8.75),this.game=e,this.onContactWater=new Phaser.Signal,this.m_controller=new box2d.b2BuoyancyController,this.m_controller.normal.SetXY(0,1),this.m_controller.offset=a,this.m_controller.useDensity=!0,this.m_controller.density=t,this.m_controller.linearDrag=i,this.m_controller.angularDrag=s,this.game.physics.box2d.world.AddController(this.m_controller)}return e.prototype.addRectangle=function(e,t,i,s){var a=new Phaser.Physics.Box2D.Body(this.game,null,e,t,0),n=a.setRectangle(i,s);n.SetDensity(2),n.SetFriction(.3),n.SetRestitution(0),n=null,a.sensor=!0,a.setCategoryContactCallback(1,this.onContact,this),a=null},e.prototype.onContact=function(e,t,i,s,a){e!==t&&!0!==t.sensor&&!1!==t.dynamic&&(!0===a?null===t.data.GetControllerList()&&(this.m_controller.AddBody(t.data),this.onContactWater.dispatch(t,!0)):null!==t.data.GetControllerList()&&(this.m_controller.RemoveBody(t.data),this.onContactWater.dispatch(t,!1)))},e.prototype.free=function(){this.game=null,this.m_controller=null},e}();e.WaterRect=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Fabrique;!function(e){var t=function(){function e(){}return e.show=function(){var e=document.getElementById("loader");e&&(e.style.display="block")},e.hide=function(){var e=document.getElementById("loader");e&&(e.style.display="none")},e}();e.LoaderHelper=t}(Fabrique||(Fabrique={}));var Wheely;!function(e){!function(e){var t=function(){function t(t){this.questCarFounded=!1,this.questWheelFounded=!1,this.questWheel=null,this.questCar=null,this.game=t,this.updateElements=new Array,this.tweens=new Array,1===e.DataManager.getInstance().saveObj["questCar"+e.LevelManager.getInstance().currentLevel]&&(this.questCarFounded=!0),1===e.DataManager.getInstance().saveObj["questWheel"+e.LevelManager.getInstance().currentLevel]&&(this.questWheelFounded=!0)}return t.prototype.init=function(){},t.prototype.customAction=function(e){void 0===e&&(e=0)},t.prototype.addQuestWheel=function(e,t,i,s,a){void 0===a&&(a=-1),!0!==this.questWheelFounded&&(this.questWheel=this.game.make.button(t,i,"ui",this.clickQuestWheel,this,"questWheel"+e+" instance 10001","questWheel"+e+" instance 10000","questWheel"+e+" instance 10000"),this.questWheel.anchor.setTo(.5),-1===a?s.addChild(this.questWheel):s.addChildAt(this.questWheel,a))},t.prototype.clickQuestWheel=function(){this.questWheelFounded=!0,this.questWheel.visible=!1,this.addStars(this.questWheel.world.x,this.questWheel.world.y),e.LevelBuilder.instance.panelQuest.foundWheel()},t.prototype.addQuestCar=function(e,t,i,s,a,n){if(void 0===s&&(s=-1),void 0===a&&(a=0),void 0===n&&(n=1),!0!==this.questCarFounded){this.questCar=this.game.make.button(e,t,"ui",this.clickQuestCar,this,"carBody instance 10001","carBody instance 10000","carBody instance 10000"),this.questCar.anchor.setTo(.5),this.questCar.angle=a,this.questCar.scale.set(n);var o=this.game.make.sprite(-4,-27,"ui","carEye instance 10000");o.animations.add("idle",Phaser.Animation.generateFrameNames("carEye instance 1",0,89,"",4),35,!0),o.play("idle"),this.questCar.addChild(o),-1===s?i.addChild(this.questCar):i.addChildAt(this.questCar,s)}},t.prototype.clickQuestCar=function(){this.questCarFounded=!0,this.questCar.visible=!1,this.addStars(this.questCar.world.x,this.questCar.world.y),e.LevelBuilder.instance.panelQuest.foundCar()},t.prototype.clickQuestCar2=function(t,i){this.questCarFounded=!0,this.addStars(t,i),e.LevelBuilder.instance.panelQuest.foundCar()},t.prototype.addStars=function(t,i){this.updateElements.push(new e.ClickStars(this.game,t,i))},t.prototype.update=function(){for(e=0;e<this.tweens.length;e++)this.tweens[e].update();for(var e=0;e<this.updateElements.length;e++)this.updateElements[e].update()},t.prototype.setSimpleTween=function(t,i,s,a){void 0===a&&(a=!1);for(n=0;n<this.tweens.length;n++)if(this.tweens[n].target===t)return void this.tweens[n].start(t,i,s,a);for(var n=0;n<this.tweens.length;n++)if(!1===this.tweens[n].working)return void this.tweens[n].start(t,i,s,a);var o=new e.SimpleTween;o.start(t,i,s,a),this.tweens.push(o),o=null},t.prototype.stopSimpleTween=function(e){for(var t=0;t<this.tweens.length;t++)if(this.tweens[t].target===e){this.tweens[t].stop();break}},t.prototype.free=function(){this.game=null;for(e=0;e<this.updateElements.length;e++)this.updateElements[e].free();this.updateElements=[],this.updateElements=null;for(var e=0;e<this.tweens.length;e++)this.tweens[e].free();this.tweens=[],this.tweens=null,this.questCar=null,this.questWheel=null},t}();e.BasicLevel=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(){}return e.DEFAULT=1,e.WALL=2,e.TRUCK=4,e.CAR1=1024,e.CAR2=2048,e.PARTICLE=4096,e.IGNORE_CAR=e.CAR1+e.CAR2,e}();e.FilterGroups=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function t(){if(this.finishPassed=!1,this.hero=null,null!==t.instance)throw new Error("Error: LevelBuilder already created");t.instance=this,this.layerBackground0=e.LevelBuilder.instance.add.group(),this.layerBackground=e.LevelBuilder.instance.add.group(),this.layerElements=e.LevelBuilder.instance.add.group(),this.layerUpper=e.LevelBuilder.instance.add.group(),this.level=e.Tools.getInstance("Level"+e.LevelManager.getInstance().currentLevel,e.Main.instance),this.level.init()}return t.prototype.update=function(){this.level.update(),null!==this.hero&&this.hero.update()},t.prototype.free=function(){t.instance=null,null!==this.hero&&this.hero.free(),this.hero=null,this.level.free(),this.level=null,this.layerBackground0=null,this.layerBackground=null,this.layerElements=null,this.layerUpper=null},t.instance=null,t}();e.GameManager=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.canClickHero=0,e.showCircleArrowAfterWheel=!1,e.clickOnWheelQuest=!1,e}return __extends(i,t),i.prototype.init=function(){e.SoundManager.playSFX("sfx_ambient",!0);var t=e.GameManager.instance.layerBackground.create(0,0,"bgLevel1_1");t.cacheAsBitmap=!0,(t=e.GameManager.instance.layerBackground.create(56,430,"level1")).animations.add("anim",Phaser.Animation.generateFrameNames("eyesBlue instance 1",0,109,"",4),30,!0),t.animations.play("anim"),(t=e.GameManager.instance.layerBackground.create(368,450,"level1")).animations.add("anim",Phaser.Animation.generateFrameNames("eyesGreen instance 1",0,65,"",4),30,!0),t.animations.play("anim"),this.chooseFilm=new e.Lvl1ChooseFilm(this.game),this.updateElements.push(this.chooseFilm),this.createPicture(),(t=e.GameManager.instance.layerBackground.create(442,0,"level1","front instance 10000")).cacheAsBitmap=!0,!1===this.questWheelFounded?(this.curtain=e.GameManager.instance.layerUpper.create(567,358,"level1","curtain instance 10000"),this.curtain.animations.add("anim",Phaser.Animation.generateFrameNames("curtain instance 1",0,32,"",4),30,!1),this.addQuestWheel(1,573,470,e.GameManager.instance.layerUpper)):this.curtain=e.GameManager.instance.layerUpper.create(567,358,"level1","curtain instance 10032"),(t=e.GameManager.instance.layerUpper.create(665,489,"level1","poruch instance 10000")).cacheAsBitmap=!0,this.girl=new e.Lvl1Girl(this.game,-60,497),this.updateElements.push(this.girl),e.GameManager.instance.hero=new e.Hero(this.game,-170,490),e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!0),this.circleArrow=new e.Lvl1CircleArrow(this.game),this.updateElements.push(this.circleArrow),this.addGround(),this.car1=new e.Lvl1Car1(this.game,455,474),this.updateElements.push(this.car1),this.car2=new e.Lvl1Car2(this.game,270,495),this.updateElements.push(this.car2),this.game.input.onDown.add(this.mouseDragStart,this),this.game.input.addMoveCallback(this.mouseDragMove,this),this.game.input.onUp.add(this.mouseDragEnd,this),t=null;var i=this.game.make.graphics(0,0);i.beginFill(16711680,.4),i.drawRect(0,0,702,600),i.endFill(),e.GameManager.instance.layerElements.add(i),e.GameManager.instance.layerElements.mask=i,i=null,this.updateElements.push(new e.Finish(this.game,635,490))},i.prototype.clickQuestWheel=function(){t.prototype.clickQuestWheel.call(this),this.curtain.animations.play("anim"),!0===this.clickOnWheelQuest&&this.circleArrow.hide(),!0===this.showCircleArrowAfterWheel&&(this.circleArrow.show(e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y),e.GameManager.instance.hero.setClickable(!0),this.canClickHero=1)},i.prototype.mouseDragStart=function(){this.game.physics.box2d.mouseDragStart(this.game.input.activePointer.position),this.game.physics.box2d.mouseJoint&&"DragBody"!==this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.mouseDragEnd()},i.prototype.mouseDragMove=function(){this.game.physics.box2d.mouseJoint&&"DragBody"===this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.game.physics.box2d.mouseDragMove(this.game.input.activePointer.position)},i.prototype.mouseDragEnd=function(){this.game.physics.box2d.mouseDragEnd()},i.prototype.createPicture=function(){this.addQuestCar(605,222,e.GameManager.instance.layerBackground),this.picture=e.GameManager.instance.layerBackground.create(605,180,"level1","picture instance 10000"),this.game.physics.box2d.enable(this.picture),this.picture.body.setRectangle(94,136),this.picture.body.data.SetUserData("DragBody"),this.picture.inputEnabled=!0,this.picture.input.useHandCursor=!0,this.picture.events.onInputOut.add(function(){this.picture.frameName="picture instance 10000"},this),this.picture.events.onInputOver.add(function(){this.picture.frameName="picture instance 10001"},this)},i.prototype.customAction=function(t){if(void 0===t&&(t=0),0===t)1===this.canClickHero&&(this.circleArrow.hide(),this.canClickHero=2,this.girl.setState(3));else if(1===t)this.car1.addTicketsAndGlasses(),this.car2.addTicketsAndGlasses();else if(2===t){!1===this.questWheelFounded?(this.circleArrow.show(573,470),this.showCircleArrowAfterWheel=!0):(this.circleArrow.show(e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y),e.GameManager.instance.hero.setClickable(!0),this.canClickHero=1),this.girl.addGlasses();var i=this.game.make.sprite(45,20,"level1");i.animations.add("anim",Phaser.Animation.generateFrameNames("tickets instance 1",0,13,"",4),30,!1),i.animations.play("anim"),i.scale.setTo(.8),e.GameManager.instance.hero.graphicCar.addChild(i),(i=this.game.make.sprite(70,-11,"level1")).animations.add("anim",Phaser.Animation.generateFrameNames("glasses instance 1",0,12,"",4),30,!1),i.animations.play("anim"),e.GameManager.instance.hero.graphicCar.addChild(i),(i=e.GameManager.instance.layerBackground.create(280,424,"level1")).animations.add("anim",Phaser.Animation.generateFrameNames("moneyAnim instance 1",0,18,"",4),30,!1).killOnComplete=!0,i.animations.play("anim"),i=null}else 3===t?(this.girl.setState(2),e.SoundManager.playSFX("s_engineStart"),e.GameManager.instance.hero.setEnableMotor(!0)):4===t?(this.chooseFilm.activate(),this.circleArrow.show(517,308)):5===t?(this.circleArrow.hide(),this.clickOnWheelQuest=!0):6===t&&(this.girl.setAngry(),this.thinkAngry||(this.thinkAngry=e.GameManager.instance.layerUpper.create(513,406,"level1"),this.thinkAngry.animations.add("anim",Phaser.Animation.generateFrameNames("thinkAngry instance 1",0,49,"",4),30,!1).onComplete.add(function(){this.thinkAngry.visible=!1},this)),this.thinkAngry.visible=!0,this.thinkAngry.animations.stop("anim",!0),this.thinkAngry.animations.play("anim"))},i.prototype.addGround=function(){var e=new Phaser.Physics.Box2D.Body(this.game,null,500,561,0);e.setRectangle(1400,50),(e=new Phaser.Physics.Box2D.Body(this.game,null,1e3,490,0)).setRectangle(10,100),(e=new Phaser.Physics.Box2D.Body(this.game,null,605,127,0)).setRectangle(10,10),e.sensor=!0,this.game.physics.box2d.revoluteJoint(e,this.picture,0,0,0,-53),(e=new Phaser.Physics.Box2D.Body(this.game,null,605,248,0)).setRectangle(10,10),e.sensor=!0,this.game.physics.box2d.distanceJoint(e,this.picture,0,0,0,0,68,.7,.1),e=null},i.prototype.free=function(){t.prototype.free.call(this),this.chooseFilm=null,this.picture=null,this.car1=null,this.car2=null,this.circleArrow=null,this.girl=null,this.curtain=null,this.thinkAngry=null},i}(e.BasicLevel);e.Level1=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameOver=!1,e.gameOverDelay=0,e.doorUsed=!1,e}return __extends(i,t),i.prototype.init=function(){this.game.world.resize(800,600),this.game.world.setBounds(0,0,800,600),e.GameManager.instance.layerBackground.create(0,0,"bgLevel10_1").cacheAsBitmap=!0,e.GameManager.instance.layerUpper.create(0,0,"bgLevel10_2").cacheAsBitmap=!0,e.GameManager.instance.hero=new e.Hero(this.game,65,190),e.GameManager.instance.hero.bodyWheelFront.mass=2,e.GameManager.instance.hero.addHelmetLvl10(),this.addGround(),this.addDrake(),this.addSpring(),this.addRedStone(),this.addPress(),this.addDoor(),this.addFireCar(),this.addQuestWheel(10,505,408,e.GameManager.instance.layerBackground),this.addQuestCar(67,222,e.GameManager.instance.layerBackground);new e.Finish(this.game,25,510,!0,e.GameManager.instance.layerBackground);this.game.input.onDown.add(this.mouseDragStart,this),this.game.input.addMoveCallback(this.mouseDragMove,this),this.game.input.onUp.add(this.mouseDragEnd,this)},i.prototype.mouseDragStart=function(){this.game.physics.box2d.mouseDragStart(this.game.input.activePointer.position),this.game.physics.box2d.mouseJoint&&"DragBody"!==this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.mouseDragEnd()},i.prototype.mouseDragMove=function(){this.game.physics.box2d.mouseJoint&&"DragBody"===this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.game.physics.box2d.mouseDragMove(this.game.input.activePointer.position)},i.prototype.mouseDragEnd=function(){this.game.physics.box2d.mouseDragEnd()},i.prototype.update=function(){t.prototype.update.call(this),!0===this.gameOver&&(this.gameOverDelay+=1,90===this.gameOverDelay&&e.LevelBuilder.instance.levelFailed())},i.prototype.addDrake=function(){this.topActions=new e.Lvl10TopAction(this.game),this.updateElements.push(this.topActions)},i.prototype.addSpring=function(){var t=new e.Lvl10Spring(this.game);this.updateElements.push(t)},i.prototype.addWater=function(){this.iceWater=e.GameManager.instance.layerUpper.create(385,233,"level10","iceWater instance 10000",!0,0),this.iceWater.alpha=0,this.game.add.tween(this.iceWater).to({alpha:1},800,"Linear",!0).onComplete.addOnce(this.addWaterAnim,this)},i.prototype.addWaterAnim=function(){this.water=e.GameManager.instance.layerUpper.create(363,232,"level10","waterAnim instance 10000"),this.water.animations.add("anim",Phaser.Animation.generateFrameNames("waterAnim instance 1",0,86,"",4),30,!1).onComplete.addOnce(function(){this.game.add.tween(this.water).to({alpha:0},600,"Linear",!0)},this),this.water.scale.set(2),this.water.play("anim"),this.game.add.tween(this.iceWater).to({alpha:0},800,"Linear",!0,1500)},i.prototype.addPress=function(){var t=new e.Lvl10Press(this.game);this.updateElements.push(t)},i.prototype.addRedStone=function(){this.redStone=e.GameManager.instance.layerElements.create(300,530,"level10","rockBody instance 10000"),this.game.physics.box2d.enable(this.redStone),this.redStone.body.setRectangle(27,26),this.redStone.body.data.SetUserData("DragBody"),this.redStone.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR)},i.prototype.addDoor=function(){this.door=new e.Lvl10Door(this.game)},i.prototype.closeDoor=function(){!1===this.doorUsed&&(this.doorUsed=!0,this.topActions.activateWheel(),this.door.close(),e.GameManager.instance.hero.setEnableMotor(!1),e.GameManager.instance.hero.currEyesState=e.EyesState.afraid,this.fireCar.alive())},i.prototype.addFireCar=function(){this.fireCar=new e.Lvl10FireCar(this.game),this.updateElements.push(this.fireCar)},i.prototype.freeze=function(){this.gameOver=!0,e.GameManager.instance.hero.setEnableMotor(!1);var t=e.GameManager.instance.layerElements.create(e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y-30,"level10","spike1 instance 10000");t.scale.set(.35,.13),t.anchor.set(.5,1),this.game.add.tween(t.scale).to({x:.8,y:1},1e3,"Linear",!0,500,0,!0);var i=e.GameManager.instance.hero.baseGroup.create(0,0,"level10","Frozen_Wheely instance 10000");i.anchor.set(.5),i.animations.add("anim",Phaser.Animation.generateFrameNames("Frozen_Wheely instance 1",0,31,"",4),30,!1),i.play("anim");var s=e.GameManager.instance.layerElements.create(e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y+25,"level10","wheelyFrize instance 10000");s.anchor.set(.5),s.animations.add("anim",Phaser.Animation.generateFrameNames("wheelyFrize instance 1",0,49,"",4),30,!1),s.play("anim");var a=e.GameManager.instance.layerElements.create(e.GameManager.instance.hero.bodyBase.x+30,e.GameManager.instance.hero.bodyBase.y+50,"level10","spike1 instance 10000");a.scale.set(.35,.13),a.anchor.set(.5,1),a.angle=15,this.game.add.tween(a.scale).to({x:.8,y:1},1500,"Linear",!0,0,0,!0);var n=e.GameManager.instance.layerElements.create(e.GameManager.instance.hero.bodyBase.x-40,e.GameManager.instance.hero.bodyBase.y+50,"level10","spike1 instance 10000");n.scale.set(-.35,.13),n.anchor.set(.5,1),n.angle=-10,this.game.add.tween(n.scale).to({x:-.8,y:1.5},1500,"Linear",!0,200,0,!0)},i.prototype.addGround=function(){var t=new Phaser.Physics.Box2D.Body(this.game,null,77,290,0);t.setRectangle(185,106),(t=new Phaser.Physics.Box2D.Body(this.game,null,505,270,0)).setRectangle(262,65),(t=new Phaser.Physics.Box2D.Body(this.game,null,148,553,0)).setRectangle(615,20),(t=new Phaser.Physics.Box2D.Body(this.game,null,735,512,0)).setRectangle(150,20),(t=new Phaser.Physics.Box2D.Body(this.game,null,620,532,0)).setRectangle(98,20),t.angle=-26,(t=new Phaser.Physics.Box2D.Body(this.game,null,172,286,0)).setRectangle(97,20),t.angle=78,(t=new Phaser.Physics.Box2D.Body(this.game,null,372,286,0)).setRectangle(97,20),t.angle=-78,(t=new Phaser.Physics.Box2D.Body(this.game,null,272,330,0)).setRectangle(204,20),(t=new Phaser.Physics.Box2D.Body(this.game,null,378,365,0)).setRectangle(46,130),(t=new Phaser.Physics.Box2D.Body(this.game,null,721,30,0)).setRectangle(157,60),(t=new Phaser.Physics.Box2D.Body(this.game,null,250,511,0)).setRectangle(20,42),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyWheelBack,this.closeDoor,this),t=null},i.prototype.free=function(){t.prototype.free.call(this),this.redStone=null,this.topActions=null,this.water=null,this.iceWater=null,this.door=null,this.fireCar=null},i}(e.BasicLevel);e.Level10=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.gameOver=!1,e.gameOverTimer=0,e}return __extends(i,t),i.prototype.init=function(){e.GameManager.instance.layerBackground.create(0,0,"bgLevel11_1").cacheAsBitmap=!0,e.GameManager.instance.hero=new e.Hero(this.game,85,175);new e.Finish(this.game,750,175);this.addGround(),this.addRopeWheel(),this.addMill(),this.addRedWheel(),this.addRotateWheel(),this.addRotateLever(),this.addDoor(),this.addRock(),this.addCar(),this.addQuestCar(140,548,e.GameManager.instance.layerBackground),this.addQuestWheel(11,725,117,e.GameManager.instance.layerBackground),this.game.input.onDown.add(this.mouseDragStart,this),this.game.input.addMoveCallback(this.mouseDragMove,this),this.game.input.onUp.add(this.mouseDragEnd,this),e.GameManager.instance.layerElements.create(0,179,"bgLevel11_2").cacheAsBitmap=!0,e.SoundManager.playSFX("s_lvl12_water1",!0)},i.prototype.mouseDragStart=function(){this.game.physics.box2d.mouseDragStart(this.game.input.activePointer.position),this.game.physics.box2d.mouseJoint&&"DragBody"!==this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.mouseDragEnd()},i.prototype.mouseDragMove=function(){this.game.physics.box2d.mouseJoint&&"DragBody"===this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.game.physics.box2d.mouseDragMove(this.game.input.activePointer.position)},i.prototype.mouseDragEnd=function(){this.game.physics.box2d.mouseDragEnd()},i.prototype.addRotateWheel=function(){this.rotateWheel=new e.Lvl11RotateWheel(466,506),this.updateElements.push(this.rotateWheel)},i.prototype.addRopeWheel=function(){this.ropeWheel=new e.Lvl11RopeWheel(466,506),this.updateElements.push(this.ropeWheel)},i.prototype.addRotateLever=function(){this.lever=new e.Lvl11Lever(this.game,148,354),this.updateElements.push(this.lever)},i.prototype.addRedWheel=function(){this.redWheel=new e.Lvl11RedWheel(this.game,272,288),this.updateElements.push(this.redWheel)},i.prototype.addDoor=function(){var t=new e.Lvl11Door;this.updateElements.push(t)},i.prototype.addMill=function(){var t=new e.Lvl11Mill(256,486);this.updateElements.push(t)},i.prototype.addRock=function(){var t=new e.Lvl11Rock(524,263);this.updateElements.push(t)},i.prototype.addCar=function(){this.car=new e.Lvl11Car(100,552),this.updateElements.push(this.car)},i.prototype.update=function(){t.prototype.update.call(this),e.GameManager.instance.hero.bodyBase.y>600&&!1===this.gameOver&&(this.gameOver=!0),!0===this.gameOver&&(this.gameOverTimer+=1,60===this.gameOverTimer&&e.LevelBuilder.instance.levelFailed())},i.prototype.addGround=function(){var e=new Phaser.Physics.Box2D.Body(this.game,null,225,230,0);e.setRectangle(450,20),(e=new Phaser.Physics.Box2D.Body(this.game,null,792,230,0)).setRectangle(335,20),(e=new Phaser.Physics.Box2D.Body(this.game,null,476,289,0)).setRectangle(100,20),e.angle=63,(e=new Phaser.Physics.Box2D.Body(this.game,null,660,472,0)).setRectangle(266,20),e.angle=85,(e=new Phaser.Physics.Box2D.Body(this.game,null,706,297,0)).setRectangle(160,20),e.angle=138,e=null},i.prototype.free=function(){t.prototype.free.call(this),this.lever=null,this.rotateWheel=null,this.ropeWheel=null,this.redWheel=null,this.car=null},i}(e.BasicLevel);e.Level11=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.dragNow=!1,e.haveShield=!1,e.gameOver=!1,e.gameOverCounter=0,e.ground=[[526.9,245.5,0,20,103],[544.05,326.7,-30,19,74],[503.5,486.7,113,19,112],[401.9,441.35,115,19,112],[308.2,403.4,108,19,94],[218.35,378.1,102,19,94],[134.6,365.05,94,19,79],[47.55,363.15,89,19,94],[847.2,551.3,91,19,301],[604.75,525.2,109,17,112],[677.4,543.2,100,19,112],[631.2,203.6,90,20,261],[741.85,270.9,0,20,137],[767.05,336.9,90,20,64],[652.95,352.4,90,20,217]],e}return __extends(i,t),i.prototype.init=function(){var t=e.GameManager.instance.layerBackground.create(0,0,"bgLevel12_1");t.cacheAsBitmap=!0,(t=e.GameManager.instance.layerUpper.create(0,600,"bgLevel12_2")).anchor.y=1,t.cacheAsBitmap=!0,t=null,e.GameManager.instance.hero=new e.Hero(this.game,45,310),e.GameManager.instance.hero.maxMotorSpeed=3.5,e.GameManager.instance.hero.bodyWheelBack.friction=1,e.GameManager.instance.hero.bodyWheelFront.friction=1,e.GameManager.instance.hero.setCollideWorldBounds(!1);new e.Finish(this.game,780,500);this.addGround(),this.addStones(),this.addBgEye(),this.addDoor(),this.addMassiveDoor(),this.addRock(),this.addEnemy(),this.addTaran(),this.addShield(),this.game.input.onDown.add(this.mouseDragStart,this),this.game.input.addMoveCallback(this.mouseDragMove,this),this.game.input.onUp.add(this.mouseDragEnd,this),this.addQuestWheel(12,538,243,e.GameManager.instance.layerUpper),this.addQuestCar(329,477,e.GameManager.instance.layerUpper,1,0,.9)},i.prototype.addRock=function(){this.rock=new e.Lvl12Stones,this.updateElements.push(this.rock)},i.prototype.addHeroShield=function(){this.heroShield=new e.HeroShield(this.game),this.updateElements.push(this.heroShield)},i.prototype.addShield=function(){this.shield=new e.Lvl12Shield(this.game),this.updateElements.push(this.shield)},i.prototype.addTaran=function(){this.taran=new e.Lvl12Taran(this.game,250,313),this.updateElements.push(this.taran)},i.prototype.addMassiveDoor=function(){this.massiveDoor=new e.Lvl12MassiveDoor,this.updateElements.push(this.massiveDoor)},i.prototype.addEnemy=function(){var t=new e.Lvl12Enemy(560,155,1,150);this.updateElements.push(t),t=new e.Lvl12Enemy(620,300,-1,650),this.updateElements.push(t)},i.prototype.addDoor=function(){this.door=new e.Lvl12Door(this.game),this.updateElements.push(this.door)},i.prototype.addBgEye=function(){var t=new e.Lvl12BgEye(this.game);this.updateElements.push(t)},i.prototype.addStones=function(){var t=new e.Lvl12SecretStone(this.game,131,425,1);this.updateElements.push(t),t=new e.Lvl12SecretStone(this.game,327,475,2),this.updateElements.push(t),t=new e.Lvl12SecretStone(this.game,100,552,3),this.updateElements.push(t),t=null},i.prototype.mouseDragStart=function(){this.game.physics.box2d.mouseDragStart(this.game.input.activePointer.position),this.game.physics.box2d.mouseJoint&&"DragBody"!==this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.mouseDragEnd()},i.prototype.mouseDragMove=function(){this.game.physics.box2d.mouseJoint&&"DragBody"===this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&(this.dragNow=!0,this.game.physics.box2d.mouseDragMove(this.game.input.activePointer.position))},i.prototype.mouseDragEnd=function(){this.dragNow=!1,this.taran.dragEnd(),this.game.physics.box2d.mouseDragEnd()},i.prototype.customAction=function(e){void 0===e&&(e=0)},i.prototype.update=function(){t.prototype.update.call(this),e.GameManager.instance.hero.bodyBase.x>=495&&!1===this.haveShield&&(e.GameManager.instance.hero.setEnableMotor(!1),e.GameManager.instance.hero.setClickable(!1),this.haveShield=!0,this.shield.pickUp()),!0===this.gameOver&&(this.gameOverCounter+=1,60===this.gameOverCounter&&e.LevelBuilder.instance.levelFailed())},i.prototype.addGround=function(){for(var e=0;e<this.ground.length;e++){var t=new Phaser.Physics.Box2D.Body(this.game,null,this.ground[e][0],this.ground[e][1],0);t.setRectangle(this.ground[e][3],this.ground[e][4]),t.angle=this.ground[e][2],t.friction=1,t=null}},i.prototype.free=function(){t.prototype.free.call(this)},i}(e.BasicLevel);e.Level12=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.currKilling=0,e.shootCounter=0,e.magDied=!1,e.magShoot=80,e.dragShoot=230,e.startDefeat=!1,e.counterDefeat=0,e.heroDieMagBall=!1,e.startSpawningFires=!1,e.spawningFiresCounter=0,e.wheelyCount=0,e.lighttingOnBtnLiftCount=0,e.stopLiftHorCount=0,e.activateSwordCount=0,e.activateSkeletonCount=0,e.hideSwordCount=0,e.heroDefeatCounter=0,e.changeHeroDirCount=0,e.changeCounter=0,e.percentLift=1,e}return __extends(i,t),i.prototype.init=function(){this.fires=new Array,this.game.world.resize(800,800);var t=e.GameManager.instance.layerBackground.create(0,0,"bgLevel13_1");t.cacheAsBitmap=!0,this.updateElements.push(new e.Lvl13Cage(this.game)),this.skeleton=new e.Lvl13Skeleton(this.game),this.updateElements.push(this.skeleton),this.addQuestWheel(13,714,92,e.GameManager.instance.layerBackground),this.carQuest=new e.Lvl13QuestCar(this.game),this.updateElements.push(this.carQuest),this.ghosts=new e.Lvl13Ghosts(this.game),this.updateElements.push(this.ghosts),(t=e.GameManager.instance.layerUpper.create(0,181,"level13","bgPart2 instance 10000")).cacheAsBitmap=!0,e.GameManager.instance.hero=new e.Hero(this.game,70,140),this.lift=new e.Lvl13Lift(this.game),this.updateElements.push(this.lift),this.dragon=new e.Lvl13Dragon(this.game),this.updateElements.push(this.dragon),(t=e.GameManager.instance.layerUpper.create(0,600,"level13","bgPart instance 10000")).anchor.y=1,t.cacheAsBitmap=!0,t=null,this.btnSword=e.GameManager.instance.layerUpper.create(240,235,"level13","btnSword instance 10000"),this.btnSword.anchor.setTo(.5),this.btnSword.events.onInputOut.add(this.btnSwordOut,this),this.btnSword.events.onInputOver.add(this.btnSwordOver,this),this.btnSword.events.onInputDown.add(this.btnSwordDown,this),this.btnSword.events.onInputUp.add(this.btnSwordUp,this),this.btnSword.visible=!1,this.btnSwordAnim=e.GameManager.instance.layerBackground.create(242,238,"level13"),this.btnSwordAnim.anchor.setTo(.5),this.btnSwordAnim.animations.add("anim",Phaser.Animation.generateFrameNames("showBtnSword instance 1",0,15,"",4),30,!1).killOnComplete=!0,this.btnSwordAnim.visible=!1,this.lighting=e.GameManager.instance.layerUpper.create(571,271,"level13"),this.lighting.scale.x=2,this.lighting.anchor.x=.1,this.lighting.animations.add("anim",Phaser.Animation.generateFrameNames("magicLightning1 instance 1",0,13,"",4),30,!1).onComplete.addOnce(this.lightingComp,this),this.lighting.animations.add("anim2",Phaser.Animation.generateFrameNames("magicLightning1 instance 1",14,20,"",4),30,!1),this.lighting.angle=e.Tools.toDeg(e.Tools.angleOfPoints(571,217,90,295))-20,this.lighting.visible=!1,this.crystalBall=new e.Lvl13CrystalBall(this.game),this.updateElements.push(this.crystalBall),this.bat=new e.Lvl13Bat(this.game),this.updateElements.push(this.bat),this.addGround()},i.prototype.customAction=function(t){void 0===t&&(t=0),1===t?(this.skeleton.heroAlreadyDie=!0,this.deactivateBtnSword(!1)):2===t?this.deactivateBtnSword(!1):3===t?this.dragon.dieMage():4===t?(this.lift.stopHor(),this.lift.destroyJoint(!1),this.lift.graphic.body.sensor=!0,e.GameManager.instance.hero.setKeepAngle(!1),e.GameManager.instance.hero.bodyBase.angularVelocity=8,this.heroDieMagBall=!0,e.GameManager.instance.hero.bodyBase.data.ApplyLinearImpulse(new box2d.b2Vec2(0,13),e.GameManager.instance.hero.bodyBase.data.GetPosition())):5===t?this.carQuest.activate():6===t?(this.startDefeat=!0,e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.addBurn(),this.startSpawningFires=!0,e.SoundManager.playSFX("s_wheelyFlame",!0)):7===t&&(this.shootCounter=this.magShoot-1)},i.prototype.lightingComp=function(){this.lighting.animations.play("anim2"),this.lift.crashBtnUp()},i.prototype.activateBtnSword=function(t){void 0===t&&(t=!1),this.btnSword.visible=!0,this.btnSword.inputEnabled=!0,this.btnSword.input.useHandCursor=!0,this.btnSwordOut(),!0===t&&(this.btnSwordAnim.visible=!0,this.btnSwordAnim.animations.play("anim")),e.GameManager.instance.hero.sword.animations.play("appear"),e.SoundManager.playSFX("s_sword1")},i.prototype.deactivateBtnSword=function(t,i){void 0===t&&(t=!0),void 0===i&&(i=!0),!0===t?(this.btnSword.visible=!1,this.btnSword.inputEnabled=!1,!0===i&&(e.GameManager.instance.hero.sword.animations.play("hide"),e.SoundManager.playSFX("s_sword1"))):(this.btnSword.inputEnabled=!1,this.btnSword.frameName="btnSword instance 10000")},i.prototype.btnSwordOut=function(){!1!==this.btnSword.inputEnabled&&(this.btnSword.frameName="btnSword instance 10001")},i.prototype.btnSwordOver=function(){!1!==this.btnSword.inputEnabled&&(this.btnSword.frameName="btnSword instance 10002")},i.prototype.btnSwordDown=function(){!1!==this.btnSword.inputEnabled&&(this.btnSword.frameName="btnSword instance 10003",e.GameManager.instance.hero.sword.animations.play("hit"),0===this.currKilling?e.GameManager.instance.hero.bodyBase.x+120>=this.bat.graphic.x&&e.GameManager.instance.hero.bodyBase.x+45<=this.bat.graphic.x&&(this.bat.hit(),this.currKilling=1):1===this.currKilling?e.GameManager.instance.hero.bodyBase.x+190>=this.skeleton.body.x&&(this.currKilling=2,this.skeleton.die()):2===this.currKilling&&e.GameManager.instance.hero.bodyBase.y>400&&(this.currKilling=3,this.crystalBall.crash(),this.magDied=!0,this.deactivateBtnSword(!0,!1),this.lift.destroyJoint(),e.SoundManager.playSFX("s_lvl13_ballCrush"),e.SoundManager.playSFX("s_l13_electricSparks")))},i.prototype.btnSwordUp=function(e,t,i){!1!==this.btnSword.inputEnabled&&(!0===i?this.btnSwordOver():this.btnSwordOut())},i.prototype.update=function(){t.prototype.update.call(this),!0===this.startDefeat&&(this.counterDefeat+=1,140===this.counterDefeat&&(this.startDefeat=!1,e.LevelBuilder.instance.levelFailed())),1===this.changeHeroDirCount?(this.changeHeroDirCount=2,this.percentLift=e.Tools.roundDec(e.Tools.percentToF(Math.round(this.lift.graphic.body.y)-this.lift.startTop,this.lift.endBot-this.lift.startTop),3),e.GameManager.instance.hero.setKeepAngle(!1),e.GameManager.instance.hero.bodyBase.angularVelocity=12-4*this.percentLift):2===this.changeHeroDirCount&&(this.changeCounter+=1,20===this.changeCounter?(e.GameManager.instance.hero.bodyBase.velocity.x=-10,e.GameManager.instance.hero.changeDirection(),e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!1,!1)):50===this.changeCounter&&(e.GameManager.instance.hero.setKeepAngle(!0),this.changeHeroDirCount=3)),1===this.stopLiftHorCount&&(this.stopLiftHorCount=2,!1===this.heroDieMagBall&&(this.lift.stopHor(),this.activateBtnSword(),this.btnSword.x=345,this.btnSword.y=557)),this.updateShoots(),2===this.wheelyCount&&(this.wheelyCount=3,this.dragon.flyAway(),e.GameManager.instance.hero.setEnableMotor(!1)),!0===this.startSpawningFires&&(this.spawningFiresCounter+=1,2===this.spawningFiresCounter&&(this.spawningFiresCounter=0,this.spawnFire(e.GameManager.instance.hero.bodyBase.x+e.Tools.random(-40,40),e.GameManager.instance.hero.bodyBase.y+e.Tools.random(-20,20),.7+.5*Math.random())))},i.prototype.spawnFire=function(t,i,s){for(var a=0;a<this.fires.length;a++)if(!1===this.fires[a].visible)return this.fires[a].visible=!0,this.fires[a].x=t,this.fires[a].y=i,this.fires[a].scale.setTo(s),void this.fires[a].animations.play("anim");var n=e.GameManager.instance.layerUpper.create(t,i,"level13");n.animations.add("anim",Phaser.Animation.generateFrameNames("fireEmitter instance 1",0,17,"",4),30,!1).onComplete.add(this.fireComplete,this),n.animations.play("anim"),n.scale.setTo(s),n.angle=-90,this.fires.push(n),n=null},i.prototype.fireComplete=function(e,t){e.visible=!1},i.prototype.updateShoots=function(){!0!==this.magDied&&this.shootCounter>0&&(this.shootCounter+=1,this.shootCounter===this.magShoot?this.dragon.shootMage():this.shootCounter===this.dragShoot&&(this.shootCounter=1,this.dragon.shootDragon()))},i.prototype.addGround=function(){var t=new Phaser.Physics.Box2D.Body(this.game,null,295,203,0);t.setRectangle(610,40),(t=new Phaser.Physics.Box2D.Body(this.game,null,163,530,0)).setRectangle(400,28),(t=new Phaser.Physics.Box2D.Body(this.game,null,162,135,0)).setRectangle(10,100),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.activateSword,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,213,135,0)).setRectangle(10,100),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.activateSkeleton,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,629,147,0)).setRectangle(10,100),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.hideSword,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,604,605,0)).setRectangle(532,12),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.heroDefeat,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,688,230,0)).setRectangle(100,20),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.changeHeroDir,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,363,430,0)).setRectangle(20,206),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.stopLiftHor,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,400,430,0)).setRectangle(10,206),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.lighttingOnBtnLift,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,250,463,0)).setRectangle(10,100),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.hideSword2,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,87,463,0)).setRectangle(10,100),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.goOnDragon,this),t=null},i.prototype.hideSword2=function(){0===this.wheelyCount&&(this.wheelyCount=1,e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!0,!1),e.GameManager.instance.hero.sword.animations.play("hide"),e.SoundManager.playSFX("s_sword1"))},i.prototype.goOnDragon=function(){1===this.wheelyCount&&(this.wheelyCount=2)},i.prototype.lighttingOnBtnLift=function(){0===this.lighttingOnBtnLiftCount&&(this.lighttingOnBtnLiftCount=1,this.lighting.visible=!0,this.lighting.animations.play("anim"),this.shootCounter=this.magShoot)},i.prototype.stopLiftHor=function(){0===this.stopLiftHorCount&&(this.stopLiftHorCount=1,this.shootCounter=this.magShoot)},i.prototype.activateSword=function(){0===this.activateSwordCount&&(this.activateSwordCount=1,this.activateBtnSword(!0),this.bat.fly(),e.SoundManager.playSFX("s_lvl13_batEmergency"),e.GameManager.instance.hero.setEnableMotor(!1),e.GameManager.instance.hero.currEyesState=e.EyesState.afraidTime)},i.prototype.activateSkeleton=function(){0===this.activateSkeletonCount&&(this.activateSkeletonCount=1,this.skeleton.appear())},i.prototype.hideSword=function(){0===this.hideSwordCount&&(this.hideSwordCount=1,this.deactivateBtnSword())},i.prototype.heroDefeat=function(){0===this.heroDefeatCounter&&(this.heroDefeatCounter=1,this.ghosts.showWheely(),e.SoundManager.playSFX("s_lvl13_ghostDeath"))},i.prototype.changeHeroDir=function(){0===this.changeHeroDirCount&&(this.changeHeroDirCount=1)},i.prototype.free=function(){t.prototype.free.call(this),this.ghosts=null,this.btnSword=null,this.btnSwordAnim=null,this.lift=null,this.carQuest=null,this.crystalBall=null,this.skeleton=null,this.bat=null,this.dragon=null,this.lighting=null,this.fires=[],this.fires=null},i}(e.BasicLevel);e.Level13=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.updatePressGears=!1,e.startDefeat=!1,e.counterDefeat=0,e.dragonMove=1,e.showBlackScreen=!1,e.radius=600,e.startWin=!1,e.startWinCounter=0,e}return __extends(i,t),i.prototype.init=function(){var t=e.GameManager.instance.layerBackground.create(0,0,"bgLevel14_1");t.cacheAsBitmap=!0,this.pressGear1=e.GameManager.instance.layerBackground.create(605,332,"level14","pressGear instance 10000"),this.pressGear1.anchor.setTo(.5),this.pressGear2=e.GameManager.instance.layerBackground.create(639,320,"level14","pressGear instance 10000"),this.pressGear2.anchor.setTo(.5),this.pressGear2.angle=15,(t=e.GameManager.instance.layerBackground.create(615,183,"level14","girlBed instance 10000")).cacheAsBitmap=!0,this.addQuestWheel(14,771,451,e.GameManager.instance.layerBackground),this.addQuestCar(237,550,e.GameManager.instance.layerBackground),this.updateElements.push(new e.Lvl14Tree(this.game,247,604,2)),this.updateElements.push(new e.Lvl14Tree(this.game,208,593,1)),this.updateElements.push(new e.Lvl14Tree(this.game,285,587,3)),this.door=new e.Lvl14Door(this.game),this.updateElements.push(this.door),this.girl=new e.Lvl14Girl(this.game),this.updateElements.push(this.girl),this.press=new e.Lvl14Press(this.game),this.updateElements.push(this.press),this.lever1=new e.Lvl14Lever1(this.game),this.updateElements.push(this.lever1),(t=e.GameManager.instance.layerBackground.create(800,600,"bgLevel14_2")).anchor.setTo(1),t.cacheAsBitmap=!0,this.blackScreen=this.game.make.bitmapData(800,600),(t=new Phaser.Sprite(this.game,0,0,this.blackScreen)).alpha=.8,e.GameManager.instance.layerUpper.addChild(t),t=null,this.lever2=new e.Lvl14Lever2(this.game,606,469,2),this.updateElements.push(this.lever2),this.lever3=new e.Lvl14Lever2(this.game,674,469,3),this.updateElements.push(this.lever3),this.pipe=new e.Lvl14Pipe(this.game),this.updateElements.push(this.pipe),this.lamp=new e.Lvl14Lamp(this.game),this.updateElements.push(this.lamp),this.dragon=new e.Lvl14Dragon(this.game),this.updateElements.push(this.dragon),e.GameManager.instance.hero=new e.Hero(this.game,100,100),e.GameManager.instance.hero.setKeepAngle(!1),e.GameManager.instance.hero.setVisibility(!1),e.GameManager.instance.hero.bodyWheelBack.fixedRotation=!0,e.GameManager.instance.hero.bodyWheelFront.fixedRotation=!0,this.game.input.onDown.add(this.mouseDragStart,this),this.game.input.addMoveCallback(this.mouseDragMove,this),this.game.input.onUp.add(this.mouseDragEnd,this),this.addGround()},i.prototype.mouseDragStart=function(){this.game.physics.box2d.mouseDragStart(this.game.input.activePointer.position),this.game.physics.box2d.mouseJoint&&"DragBody"!==this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.mouseDragEnd()},i.prototype.mouseDragMove=function(){this.game.physics.box2d.mouseJoint&&"DragBody"===this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.game.physics.box2d.mouseDragMove(this.game.input.activePointer.position)},i.prototype.mouseDragEnd=function(){this.game.physics.box2d.mouseDragEnd()},i.prototype.customAction=function(t){void 0===t&&(t=0),1===t?this.mouseDragStart():2===t?(this.girl.surprise(),this.dragonMove=2):3===t?(this.girl.brokeCar(),this.startDefeat=!0,this.dragon.playStart(),this.dragonMove=3):4===t?this.dragon.playSmoke(!0):5===t?(this.lever1.deactivate(),this.lever2.deactivate(),this.lever3.deactivate(),this.pipe.playAnim("anim")):6===t?(this.lever1.deactivate(),this.lever2.deactivate(),this.lever3.deactivate(),this.press.start(),this.updatePressGears=!0):7===t?(this.lever1.deactivate(),this.lever2.deactivate(),this.lever3.deactivate(),this.door.open()):8===t?(this.girl.stopVelocityY(),this.updatePressGears=!1):9===t?this.lamp.activate():10===t&&(e.GameManager.instance.hero.setEnableMotor(!1,!1),e.GameManager.instance.hero.currEyesState=e.EyesState.finish,this.showBlackScreen=!0,e.SoundManager.playSFX("s_romanticMelody"))},i.prototype.blowHero=function(t,i,s,a){e.GameManager.instance.hero.setVisibility(!0),e.GameManager.instance.hero.currEyesState=e.EyesState.afraidTime,e.GameManager.instance.hero.setPosition(t,i),e.GameManager.instance.hero.bodyBase.angle=s,e.GameManager.instance.hero.bodyBase.angularVelocity=9,!0===a?(this.startDefeat=!0,e.GameManager.instance.hero.bodyBase.data.ApplyLinearImpulse(new box2d.b2Vec2(-8,6),e.GameManager.instance.hero.bodyBase.data.GetPosition())):e.GameManager.instance.hero.bodyBase.data.ApplyLinearImpulse(new box2d.b2Vec2(-10,6),e.GameManager.instance.hero.bodyBase.data.GetPosition())},i.prototype.drawBlackScreen=function(){if(this.radius-=5,this.radius<=100)return this.showBlackScreen=!1,void(this.startWin=!0);this.blackScreen.clear(),this.blackScreen.ctx.fillStyle="#000000",this.blackScreen.ctx.beginPath(),this.blackScreen.ctx.rect(0,0,800,600),this.blackScreen.ctx.arc(550,290,this.radius,0,2*Math.PI,!0),this.blackScreen.ctx.closePath(),this.blackScreen.ctx.fill()},i.prototype.update=function(){t.prototype.update.call(this),!0===this.showBlackScreen&&this.drawBlackScreen(),!0===this.startWin&&(this.startWinCounter+=1,120===this.startWinCounter&&(e.DataManager.getInstance().saveData("questFlag"+e.LevelManager.getInstance().currentLevel,1),this.game.state.start(SceneList.Comix2,!0,!1),this.startWin=!1)),1===this.dragonMove?(this.dragon.group.x+=2,this.dragon.group.x>=150&&(this.lever1.activate(),this.lever2.activate(),this.lever3.activate(),this.dragonMove=0)):2===this.dragonMove?(this.dragon.group.x+=2,this.dragon.group.x>=225&&(this.dragonMove=0,this.dragon.playSmoke(!1))):3===this.dragonMove&&(this.dragon.group.x-=1,this.dragon.group.x<=-400&&(this.dragonMove=0)),!0===this.updatePressGears&&(this.pressGear1.angle-=3,this.pressGear2.angle+=3),!0===this.startDefeat&&(this.counterDefeat+=1,120===this.counterDefeat&&(this.startDefeat=!1,e.LevelBuilder.instance.levelFailed()))},i.prototype.addGround=function(){var e=new Phaser.Physics.Box2D.Body(this.game,null,573,348,0);e.setRectangle(370,26),e.friction=3,e=null},i.prototype.free=function(){t.prototype.free.call(this),this.lamp=null,this.door=null,this.press=null,this.pipe=null,this.lever1=null,this.lever2=null,this.lever3=null,this.girl=null,this.pressGear1=null,this.pressGear2=null,this.dragon=null,this.blackScreen=null},i}(e.BasicLevel);e.Level14=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.activeMagicParts=!0,e.counterMagicParts=0,e.startDefeat=!1,e.counterDefeat=0,e.startSpawningBubbles=!1,e.spawningBubblesCounter=0,e.counterDragon=0,e.counterWater=0,e.counterTurtle=0,e}return __extends(i,t),i.prototype.init=function(){e.SoundManager.playSFX("sfx_villageAmbience",!0),e.SoundManager.playSFX("s_wheelyMagic"),this.bubbles=new Array,this.magicParts=new Array,this.game.world.resize(800,600),this.game.physics.box2d.world.SetGravity(new box2d.b2Vec2(0,-100/this.game.physics.box2d.ptmRatio));var t=e.GameManager.instance.layerBackground.create(0,0,"bgLevel2_1");t.cacheAsBitmap=!0,this.addQuestWheel(2,697,167,e.GameManager.instance.layerBackground),this.dragon=e.GameManager.instance.layerBackground.create(-50,-30,"level2"),this.dragon.animations.add("anim",Phaser.Animation.generateFrameNames("dragon instance 1",0,16,"",4),30,!0),this.dragon.angle=5,this.dragon.visible=!1,this.dragonSpeedX=3*Math.cos(this.dragon.rotation),this.dragonSpeedY=3*Math.sin(this.dragon.rotation),this.lighting=e.GameManager.instance.layerBackground.create(28,-10,"level2"),this.lighting.animations.add("anim1",Phaser.Animation.generateFrameNames("lighting instance 1",0,12,"",4),30,!1).onComplete.addOnce(this.showLighting2,this),this.lighting.animations.add("anim2",Phaser.Animation.generateFrameNames("lighting instance 1",13,37,"",4),30,!1).killOnComplete=!0,this.lighting.visible=!1,this.houseLighting=e.GameManager.instance.layerBackground.create(19,206,"level2","houseLighting instance 10000"),this.houseLighting.animations.add("anim",Phaser.Animation.generateFrameNames("houseLighting instance 1",1,38,"",4),30,!1),this.addQuestCarLever(),(t=e.GameManager.instance.layerBackground.create(97,327,"level2","questCarLeverBase instance 10000")).anchor.y=.5,t.cacheAsBitmap=!0,(t=e.GameManager.instance.layerBackground.create(110,335,"level2","fonar instance 10000")).cacheAsBitmap=!0,this.lighting2=e.GameManager.instance.layerBackground.create(60,-30,"level2"),this.lighting2.scale.setTo(2),this.lighting2.animations.add("anim",Phaser.Animation.generateFrameNames("lighting2 instance 1",0,20,"",4),30,!1).killOnComplete=!0,this.lighting2.visible=!1,e.GameManager.instance.hero=new e.Hero(this.game,70,300),e.GameManager.instance.hero.setCollideWorldBounds(!1),this.jelly=e.GameManager.instance.layerElements.create(70,300,"level2","jelly instance 10000"),this.jelly.anchor.setTo(.5),this.peasant=new e.Lvl2Peasant(this.game),this.updateElements.push(this.peasant),this.bridge=new e.Lvl2Bridge(this.game),this.updateElements.push(this.bridge),(t=e.GameManager.instance.layerUpper.create(0,600,"bgLevel2_2")).anchor.setTo(0,1),t.cacheAsBitmap=!0,this.turtle=e.GameManager.instance.layerUpper.create(362,557,"level2","turtle instance 10000"),this.turtle.animations.add("anim",Phaser.Animation.generateFrameNames("turtle instance 1",1,22,"",4),30,!1),t=null,this.addGround(),this.updateElements.push(new e.Finish(this.game,703,417)),this.game.input.onDown.add(this.mouseDragStart,this),this.game.input.addMoveCallback(this.mouseDragMove,this),this.game.input.onUp.add(this.mouseDragEnd,this)},i.prototype.mouseDragStart=function(){this.game.physics.box2d.mouseDragStart(this.game.input.activePointer.position),this.game.physics.box2d.mouseJoint&&"DragBody"!==this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.mouseDragEnd()},i.prototype.mouseDragMove=function(){this.game.physics.box2d.mouseJoint&&"DragBody"===this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.game.physics.box2d.mouseDragMove(this.game.input.activePointer.position)},i.prototype.mouseDragEnd=function(){this.game.physics.box2d.mouseDragEnd()},i.prototype.customAction=function(e){void 0===e&&(e=0),1===e&&this.mouseDragEnd()},i.prototype.addQuestCarLever=function(){this.questCarLever=e.GameManager.instance.layerBackground.create(101,325,"level2","questCarLever instance 10000"),this.questCarLever.anchor.y=.5,this.questCarLever.pivot.x=-8,this.questCarLever.angle=-52,this.questCarLever.inputEnabled=!0,this.questCarLever.input.useHandCursor=!0,this.questCarLever.events.onInputOut.add(function(){!0===this.questCarLever.inputEnabled&&(this.questCarLever.frameName="questCarLever instance 10000")},this),this.questCarLever.events.onInputOver.add(function(){!0===this.questCarLever.inputEnabled&&(this.questCarLever.frameName="questCarLever instance 10001")},this),this.questCarLever.events.onInputDown.addOnce(function(){e.SoundManager.playSFX("sfx_lever"),this.questCarLever.inputEnabled=!1,this.questCarLever.frameName="questCarLever instance 10002",this.game.add.tween(this.questCarLever).to({angle:52},600,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){this.showLighting()},this)},this)},i.prototype.showLighting=function(){this.houseLighting.animations.play("anim"),this.lighting.animations.play("anim1"),this.lighting.visible=!0},i.prototype.showLighting2=function(){this.lighting.animations.play("anim2"),this.lighting2.animations.play("anim"),this.lighting2.visible=!0,e.SoundManager.playSFX("s_lightning");var t=170;e.GameManager.instance.hero.bodyBase.x>100&&e.GameManager.instance.hero.bodyBase.x<260&&(this.lighting2.x=-85,t=25),this.addQuestCar(t,447,e.GameManager.instance.layerBackground,e.GameManager.instance.layerBackground.getChildIndex(this.lighting2))},i.prototype.update=function(){t.prototype.update.call(this),1===this.counterDragon&&(this.dragon.x+=this.dragonSpeedX,this.dragon.y+=this.dragonSpeedY,this.dragon.x>850&&(this.counterDragon=2,this.dragon.destroy())),!0===this.startSpawningBubbles&&(this.spawningBubblesCounter+=1,2===this.spawningBubblesCounter&&(this.spawningBubblesCounter=0,this.spawnBubble(e.GameManager.instance.hero.bodyBase.x+e.Tools.random(-40,40),e.GameManager.instance.hero.bodyBase.y+e.Tools.random(-30,10),.7+.5*Math.random()))),!0===this.startDefeat&&(this.counterDefeat+=1,this.counterDefeat>=80&&(this.startDefeat=!1,e.LevelBuilder.instance.levelFailed())),this.updateMagicParts()},i.prototype.updateMagicParts=function(){if(!1!==this.activeMagicParts){this.counterMagicParts+=1,this.jelly.x=e.GameManager.instance.hero.bodyBase.x,this.jelly.y=e.GameManager.instance.hero.bodyBase.y;for(var t=0;t<this.magicParts.length;t++)!0===this.magicParts[t].visible&&(this.magicParts[t].x=this.jelly.x,this.magicParts[t].y=this.jelly.y);this.counterMagicParts%2==0&&this.setMagicPart(e.Tools.random(-180,180),1+.5*Math.random()),105===this.counterMagicParts&&(this.activeMagicParts=!1,this.game.physics.box2d.world.SetGravity(new box2d.b2Vec2(0,-500/this.game.physics.box2d.ptmRatio)),this.jelly.destroy())}},i.prototype.setMagicPart=function(t,i){for(var s=this.jelly.x,a=this.jelly.y,n=0;n<this.magicParts.length;n++)if(!1===this.magicParts[n].visible)return this.magicParts[n].visible=!0,this.magicParts[n].x=s,this.magicParts[n].y=a,this.magicParts[n].angle=t,this.magicParts[n].scale.setTo(i),void this.magicParts[n].animations.play("anim");var o=e.GameManager.instance.layerElements.create(s,a,"level2");o.animations.add("anim",Phaser.Animation.generateFrameNames("magicPinkPart instance 1",0,29,"",4),30,!1).onComplete.add(this.magicParComplete,this),o.animations.play("anim"),o.pivot.x=-20,o.angle=t,o.scale.setTo(i),this.magicParts.push(o),o=null},i.prototype.magicParComplete=function(e,t){e.visible=!1},i.prototype.spawnBubble=function(t,i,s){for(var a=0;a<this.bubbles.length;a++)if(!1===this.bubbles[a].visible)return this.bubbles[a].visible=!0,this.bubbles[a].x=t,this.bubbles[a].y=i,this.bubbles[a].scale.setTo(s),void this.bubbles[a].animations.play("anim");var n=e.GameManager.instance.layerUpper.create(t,i,"level2");n.animations.add("anim",Phaser.Animation.generateFrameNames("bubbleWaterPart instance 1",0,9,"",4),30,!1).onComplete.add(this.bubbleComplete,this),n.animations.play("anim"),n.scale.setTo(s),this.bubbles.push(n),n=null},i.prototype.bubbleComplete=function(e,t){e.visible=!1},i.prototype.addGround=function(){var t=new Phaser.Physics.Box2D.Body(this.game,null,108,497,0);t.setRectangle(218,70),(t=new Phaser.Physics.Box2D.Body(this.game,null,793,497,0)).setRectangle(600,70),(t=new Phaser.Physics.Box2D.Body(this.game,null,1e3,462,0)).setRectangle(10,100),(t=new Phaser.Physics.Box2D.Body(this.game,null,230,561,0)).setRectangle(100,42),t.angle=41,(t=new Phaser.Physics.Box2D.Body(this.game,null,302,601,0)).setRectangle(100,42),t.angle=19,(t=new Phaser.Physics.Box2D.Body(this.game,null,361,608,0)).setRectangle(100,42),t.angle=1,(t=new Phaser.Physics.Box2D.Body(this.game,null,431,593,0)).setRectangle(100,42),t.angle=-16,(t=new Phaser.Physics.Box2D.Body(this.game,null,485,555,0)).setRectangle(100,42),t.angle=-45,(t=new Phaser.Physics.Box2D.Body(this.game,null,246,418,0)).setRectangle(10,100),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.goDragon,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,355,523,0)).setRectangle(264,77),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.inWater,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,384,570,0)).setRectangle(36,24),t.setCollisionCategory(e.FilterGroups.CAR2),t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.onTurtle,this),t.setBodyContactCallback(e.GameManager.instance.hero.bodyWheelBack,this.onTurtle,this),t.setBodyContactCallback(e.GameManager.instance.hero.bodyWheelFront,this.onTurtle,this),t=null},i.prototype.goDragon=function(){0===this.counterDragon&&(this.dragon.animations.play("anim"),this.dragon.visible=!0,this.counterDragon=1,e.SoundManager.playSFX("sfx_dragonWings"),this.peasant.showThink1())},i.prototype.inWater=function(){0===this.counterWater&&(this.counterWater=1,e.SoundManager.playSFX("sfx_bubles",!0),this.startSpawningBubbles=!0,this.startDefeat=!0,this.bridge.deactivate(),e.GameManager.instance.hero.bodyBase.angularDamping=1,e.GameManager.instance.hero.setKeepAngle(!1),e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!1,!1))},i.prototype.onTurtle=function(){0===this.counterTurtle&&(this.turtle.animations.play("anim"),this.counterTurtle=1)},i.prototype.free=function(){this.game.physics.box2d.world.SetGravity(new box2d.b2Vec2(0,-500/this.game.physics.box2d.ptmRatio)),t.prototype.free.call(this),this.bridge=null,this.turtle=null,this.questCarLever=null,this.houseLighting=null,this.lighting=null,this.lighting2=null,this.dragon=null,this.peasant=null,this.bubbles=[],this.bubbles=null,this.magicParts=[],this.magicParts=null,this.jelly=null},i}(e.BasicLevel);e.Level2=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.warriorCheckPoint=0,e.start=0,e.counterStart=0,e.maceContacted=!1,e.stopHeroCount=0,e.punchMishenCounter=0,e.stopWarriorCounter=0,e}return __extends(i,t),i.prototype.init=function(){e.SoundManager.playSFX("sfx_villageAmbience",!0),this.weapons=new Array;var t=e.GameManager.instance.layerBackground.create(0,0,"bgLevel3_1");t.cacheAsBitmap=!0,this.roof=new e.Lvl3Roof(this.game),this.updateElements.push(this.roof),(t=e.GameManager.instance.layerBackground.create(0,213,"bgLevel3_2")).cacheAsBitmap=!0,this.mishen=new e.Lvl3Mishen(this.game),this.updateElements.push(this.mishen),this.king=new e.Lvl3King(this.game),this.updateElements.push(this.king),this.mage=new e.Lvl3Mag(this.game),this.updateElements.push(this.mage),this.jester=new e.Lvl3Jester(this.game),this.updateElements.push(this.jester),this.guardLeft=new e.Lvl3Guard(this.game,90,303,-1),this.updateElements.push(this.guardLeft),this.guardRight=new e.Lvl3Guard(this.game,786,309),this.updateElements.push(this.guardRight),(t=e.GameManager.instance.layerBackground.create(315,474,"level3","bgPart1 instance 10000")).cacheAsBitmap=!0,(t=e.GameManager.instance.layerBackground.create(30,283,"level3","weapons instance 10000")).cacheAsBitmap=!0,(t=e.GameManager.instance.layerBackground.create(774,348,"level3","weapons instance 10000")).scale.x=-1,t.cacheAsBitmap=!0,this.createWeapons(),this.swordPanel=new e.Lvl3SwordPanel(this.game),this.updateElements.push(this.swordPanel),(t=e.GameManager.instance.layerBackground.create(43,298,"level3","weaponsPod instance 10000")).cacheAsBitmap=!0,(t=e.GameManager.instance.layerBackground.create(761,363,"level3","weaponsPod instance 10000")).scale.x=-1,t.cacheAsBitmap=!0,this.warrior=new e.Lvl3Warrior(this.game),this.warrior.moveStart(-9),this.updateElements.push(this.warrior),e.GameManager.instance.hero=new e.Hero(this.game,-80,428),e.GameManager.instance.hero.activeClick=!1,e.GameManager.instance.hero.setEnableMotor(!0),(t=e.GameManager.instance.layerUpper.create(0,600,"bgLevel3_3")).anchor.y=1,t.cacheAsBitmap=!0,this.door=new e.Lvl3Door(this.game),this.updateElements.push(this.door),this.dragon=new e.Lvl3Dragon(this.game),this.updateElements.push(this.dragon),this.addQuestWheel(3,159,571,e.GameManager.instance.layerUpper),t=null,this.addGround(),this.game.input.onDown.add(this.mouseDragStart,this),this.game.input.addMoveCallback(this.mouseDragMove,this),this.game.input.onUp.add(this.mouseDragEnd,this)},i.prototype.mouseDragStart=function(){this.game.physics.box2d.mouseDragStart(this.game.input.activePointer.position),this.game.physics.box2d.mouseJoint&&"DragBody"!==this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.mouseDragEnd()},i.prototype.mouseDragMove=function(){this.game.physics.box2d.mouseJoint&&"DragBody"===this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.game.physics.box2d.mouseDragMove(this.game.input.activePointer.position)},i.prototype.mouseDragEnd=function(){this.game.physics.box2d.mouseDragEnd()},i.prototype.customAction=function(t){if(void 0===t&&(t=0),0===t)this.weaponOnhero&&"spear"!==this.weaponOnhero.frameName&&!1===this.swordPanel.active&&this.weaponOnhero.attack();else if(1===t){this.deactivateWeapons();for(var i="",s=0;s<this.weapons.length;s++)if(!0!==this.weapons[s].onHero){if(this.weapons[s].frameName===i){this.warrior.takeWeapon(this.weapons[s]);break}}else this.weaponOnhero=this.weapons[s],i=this.weaponOnhero.frameName;this.start=1,this.jester.matchStart()}else 2===t?(this.roof.crash(),this.king.activate(),this.jester.activate(),this.guardLeft.activate(),this.guardRight.activate(),this.mage.playFear(),e.GameManager.instance.hero.currEyesState=e.EyesState.afraid):3===t?(this.mage.playAttack(),e.GameManager.instance.hero.currEyesState=e.EyesState.idle):4===t?this.mage.explosion():5===t?!1===this.maceContacted&&e.GameManager.instance.hero.bodyBase.x>150&&e.GameManager.instance.hero.bodyBase.x<220&&(this.mage.wakeUp(),this.maceContacted=!0,this.warrior.trowWeapon()):6===t?(this.warrior.transformation(),e.GameManager.instance.hero.setEnableMotor(!1),this.start=5):7===t?(e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!1),this.weaponOnhero.attack(),this.warrior.moveStop(!0),this.warrior.defeatSwordBattle(),this.start=4,this.swordsSparks.destroy(),this.warrior.bodyBase.velocity.x=30,this.warrior.trowWeapon(),this.warrior.bodyBase.x>500&&(this.swordWalls.x=500),this.jester.matchEnd()):8===t?(this.warrior.moveStop(!0),this.warrior.weapon.attack(),e.GameManager.instance.hero.currState=e.HeroState.bumpStars,e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!1),e.GameManager.instance.hero.bodyBase.fixedRotation=!0,e.GameManager.instance.hero.bodyBase.data.ApplyLinearImpulse(new box2d.b2Vec2(15,2),e.GameManager.instance.hero.bodyBase.data.GetPosition()),this.start=3,this.swordsSparks.destroy(),this.warrior.bodyBase.velocity.x=30,this.weaponOnhero.trowWeapon()):9===t&&this.jester.matchEnd()},i.prototype.createWeapons=function(){var t=new e.Lvl3Weapon(this.game,"sword",21,308,0,!0);this.weapons.push(t),this.updateElements.push(t),t=new e.Lvl3Weapon(this.game,"mace",33,340,0,!0),this.weapons.push(t),this.updateElements.push(t),t=new e.Lvl3Weapon(this.game,"spear",24,366,5,!0),this.weapons.push(t),this.updateElements.push(t),t=new e.Lvl3Weapon(this.game,"sword",782,374,0,!1),this.weapons.push(t),this.updateElements.push(t),t=new e.Lvl3Weapon(this.game,"mace",770,406,0,!1),this.weapons.push(t),this.updateElements.push(t),t=new e.Lvl3Weapon(this.game,"spear",779,432,5,!1),this.weapons.push(t),this.updateElements.push(t),t=null},i.prototype.activateWeapons=function(){for(var e=0;e<this.weapons.length;e++)this.weapons[e].activate()},i.prototype.deactivateWeapons=function(){for(var e=0;e<this.weapons.length;e++)this.weapons[e].deactivate()},i.prototype.update=function(){t.prototype.update.call(this),1===this.start?(this.counterStart+=1,40===this.counterStart&&(this.start=2,this.counterStart=0,e.GameManager.instance.hero.setEnableMotor(!0),this.warrior.moveStart(-7))):2===this.start?"sword"===this.weaponOnhero.frameName?e.Tools.distance(e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y,this.warrior.bodyBase.x,this.warrior.bodyBase.y)<130&&(this.start=-1,this.swordWalls.y=420,this.swordPanel.show(),e.GameManager.instance.hero.bodyBase.fixedRotation=!0,this.swordsSparks=e.GameManager.instance.layerElements.create(0,330,"level3"),this.swordsSparks.animations.add("anim",Phaser.Animation.generateFrameNames("swordsSparks instance 1",0,7,"",4),30,!0),this.swordsSparks.animations.play("anim")):"mace"===this.weaponOnhero.frameName?e.Tools.distance(e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y,this.warrior.bodyBase.x,this.warrior.bodyBase.y)<130&&(this.warrior.moveStop(!0),this.warrior.weapon.attack(),this.weaponOnhero.trowWeapon(),e.GameManager.instance.hero.currState=e.HeroState.bumpStars,e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!1),e.GameManager.instance.hero.bodyBase.fixedRotation=!0,e.GameManager.instance.hero.bodyBase.data.ApplyLinearImpulse(new box2d.b2Vec2(15,2),e.GameManager.instance.hero.bodyBase.data.GetPosition()),this.start=3):"spear"===this.weaponOnhero.frameName&&e.Tools.distance(e.GameManager.instance.hero.bodyBase.x,e.GameManager.instance.hero.bodyBase.y,this.warrior.bodyBase.x,this.warrior.bodyBase.y)<150&&(this.warrior.moveStop(!0),this.warrior.weapon.attack(),this.weaponOnhero.trowWeapon(),e.GameManager.instance.hero.currState=e.HeroState.bumpStars,e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!1),e.GameManager.instance.hero.bodyBase.fixedRotation=!0,e.GameManager.instance.hero.bodyBase.data.ApplyLinearImpulse(new box2d.b2Vec2(15,2),e.GameManager.instance.hero.bodyBase.data.GetPosition()),this.start=3):3===this.start?(this.counterStart+=1,80===this.counterStart&&(this.start=-1,this.counterStart=0,e.LevelBuilder.instance.levelFailed())):4===this.start?(this.counterStart+=1,200===this.counterStart&&(this.start=-1,this.counterStart=0,this.dragon.playAppear())):5===this.start&&(this.counterStart+=1,350===this.counterStart&&(this.start=-1,this.counterStart=0,this.dragon.playAppear())),0===this.warriorCheckPoint&&this.warrior.bodyBase.x<730&&(this.warriorCheckPoint=1,this.warrior.moveStop(!0)),1===this.punchMishenCounter&&(this.punchMishenCounter=2,!0===this.mishen.opened&&"spear"===this.weaponOnhero.frameName&&(this.mishen.punch(),this.door.open(),this.weaponOnhero.attack(),e.GameManager.instance.hero.setEnableMotor(!1))),1===this.stopWarriorCounter&&(this.stopWarriorCounter=2,this.warrior.moveStop(),this.start=4,this.jester.matchEnd(),this.warrior.trowWeapon(),e.SoundManager.playSFX("sfx_pitFall")),!0===this.swordPanel.active&&(this.warrior.speed=-7,this.swordPanel.percent>.5?e.GameManager.instance.hero.bodyWheelFront.angularVelocity=e.GameManager.instance.hero.bodyWheelBack.angularVelocity:this.warrior.bodyWheel1.angularVelocity=this.warrior.bodyWheel2.angularVelocity,this.swordsSparks.x=e.GameManager.instance.hero.bodyBase.x-10)},i.prototype.addGround=function(){var t=new Phaser.Physics.Box2D.Body(this.game,null,15,534,0);t.setRectangle(600,120),(t=new Phaser.Physics.Box2D.Body(this.game,null,796,534,0)).setRectangle(600,120),(t=new Phaser.Physics.Box2D.Body(this.game,null,0,354,0)).setRectangle(340,20),t.setCollisionMask(~e.FilterGroups.WALL),(t=new Phaser.Physics.Box2D.Body(this.game,null,335,598,0)).setRectangle(100,48),t.angle=10,(t=new Phaser.Physics.Box2D.Body(this.game,null,130,420,0)).setRectangle(10,100),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.stopHero,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,250,420,0)).setRectangle(10,100),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.punchMishen,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,405,550,0)).setRectangle(100,10),t.sensor=!0,t.setBodyContactCallback(this.warrior.bodyBase,this.stopWarrior,this),t=null,this.swordWalls=new Phaser.Physics.Box2D.Body(this.game,null,405,-100,1),this.swordWalls.setRectangle(10,100,-200),this.swordWalls.addRectangle(10,100,200),this.swordWalls.setCollisionCategory(e.FilterGroups.CAR2)},i.prototype.stopHero=function(){0===this.stopHeroCount&&(this.stopHeroCount=1,this.activateWeapons(),e.GameManager.instance.hero.setEnableMotor(!1))},i.prototype.punchMishen=function(){0===this.punchMishenCounter&&(this.punchMishenCounter=1)},i.prototype.stopWarrior=function(){0===this.stopWarriorCounter&&(this.stopWarriorCounter=1)},i.prototype.free=function(){t.prototype.free.call(this),this.weapons=[],this.weapons=null,this.roof=null,this.door=null,this.mishen=null,this.weaponOnhero=null,this.swordPanel=null,this.king=null,this.mage=null,this.guardRight=null,this.guardLeft=null,this.jester=null,this.dragon=null,this.warrior=null,this.swordWalls=null,this.swordsSparks=null},i}(e.BasicLevel);e.Level3=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.heroHided=!1,e.gameOver=!1,e.bubbles=new Array,e.startSpawningBubbles=!1,e.spawningBubblesCounter=0,e.heroStop=!1,e.gameOverCounter=0,e.dragNow=!1,e.cameraMooved=!1,e.bubleWasCreated=!1,e}return __extends(i,t),i.prototype.init=function(){this.game.world.setBounds(0,0,1600,600);var t=e.GameManager.instance.layerBackground.create(0,0,"bgLevel4_1");t.cacheAsBitmap=!0,t=null;var i=e.GameManager.instance.layerUpper.create(137,516,"level4","water instance 10000");i.cacheAsBitmap=!0,i=null;var s=e.GameManager.instance.layerUpper.create(-15,500,"level4","bgPart instance 10000");s.cacheAsBitmap=!0,s=null,e.GameManager.instance.hero=new e.Hero(this.game,-100,469),e.GameManager.instance.hero.setCollideWorldBounds(!1),this.addGround(),this.addBgElements(),this.addTree(),this.addBridge(),this.addTopCar(),this.addBubbles(),this.addKing(),this.addWardens(),this.addDoor(),this.addQuestWheel(4,887,355,e.GameManager.instance.layerBackground),this.addQuestCar(168,396,e.GameManager.instance.layerBackground,1,-9)},i.prototype.addBgElements=function(){this.waterfall2=new e.Lvl4WaterFall1(this.game),this.updateElements.push(this.waterfall2);var t=new e.Lvl4WaterFall2(this.game);this.updateElements.push(t),this.waterfall3=new e.Lvl4WaterFall3(this.game),this.updateElements.push(this.waterfall3);var i=new e.Lvl4Stone(this.game);this.updateElements.push(i);var s=e.GameManager.instance.layerBackground.create(-78,321,"level4","partBg instance 10000");s.cacheAsBitmap=!0,s=null},i.prototype.addTree=function(){this.tree=e.GameManager.instance.layerBackground.create(-1,333,"level4","tree instance 10001"),this.tree.inputEnabled=!0,this.tree.input.useHandCursor=!0,this.tree.events.onInputDown.add(this.startDrag,this),this.tree.events.onInputUp.add(this.stopDrag,this),this.tree.events.onInputOver.add(this.over,this),this.tree.events.onInputOut.add(this.out,this),this.dragTree=e.GameManager.instance.layerUpper.create(0,0,"level4","dragShrubPart instance 10000"),this.dragTree.anchor.set(.5),this.dragTree.visible=!1},i.prototype.over=function(e){!1===this.dragNow&&(e.frameName="tree instance 10002")},i.prototype.out=function(e){!1===this.dragNow&&(e.frameName="tree instance 10001")},i.prototype.startDrag=function(){!1===this.heroHided&&(this.dragNow=!0,this.dragTree.visible=!0,this.tree.frameName="tree instance 10001")},i.prototype.stopDrag=function(){this.dragNow=!1,this.dragTree.visible=!1},i.prototype.addBridge=function(){this.bridge=new e.Lvl4Bridge(this.game,396,520),this.updateElements.push(this.bridge)},i.prototype.addTopCar=function(){this.topCar=new e.Lvl4TopCar(this.game),this.updateElements.push(this.topCar)},i.prototype.addKing=function(){this.king=new e.Lvl4King(this.game),this.updateElements.push(this.king),this.mage=new e.Lvl4Mage(this.game),this.updateElements.push(this.mage)},i.prototype.addWardens=function(){this.warden1=new e.Lvl4Warden(this.game,464,480,0),this.warden1.setScale(-1),this.warden1.playAnim("idle",-1),this.warden1.addCards(),this.updateElements.push(this.warden1),this.warden2=new e.Lvl4Warden(this.game,687,480,1),this.warden2.addCards(),this.updateElements.push(this.warden2)},i.prototype.addEye=function(){var t=new e.Lvl4Eye(540,375);this.updateElements.push(t)},i.prototype.addMap=function(){var t=new e.Lvl4Map(this.game,1350,350);this.updateElements.push(t)},i.prototype.addBubbles=function(){this.heroBubbles=new e.Lvl4Bubbles,this.updateElements.push(this.heroBubbles)},i.prototype.addDoor=function(){this.door=e.GameManager.instance.layerBackground.create(783,325,"level4","door instance 10000"),this.door.anchor.set(.5);var t=new Phaser.Graphics(this.game,783,453);t.beginFill(0,1),t.drawRect(-25,-70,50,139),t.endFill(),e.GameManager.instance.layerBackground.addChild(t),this.door.mask=t},i.prototype.update=function(){if(t.prototype.update.call(this),!1===this.heroStop&&e.GameManager.instance.hero.bodyBase.x>45&&(this.heroStop=!0,e.GameManager.instance.hero.setEnableMotor(!1)),!0===this.gameOver&&(this.gameOverCounter+=1,60===this.gameOverCounter&&(e.LevelBuilder.instance.levelFailed(),!0===this.bubleWasCreated&&e.SoundManager.playSFX("s_wheelyDrowned",!0))),!1===this.startSpawningBubbles&&e.GameManager.instance.hero.bodyBase.y>550&&(this.gameOver=!0,this.startSpawningBubbles=!0,this.bubleWasCreated=!0,e.SoundManager.playSFX("s_wheelyDrowned",!0),e.GameManager.instance.hero.setEnableMotor(!1,!1),e.GameManager.instance.hero.setClickable(!1)),!0===this.startSpawningBubbles&&(this.spawningBubblesCounter+=1,2===this.spawningBubblesCounter&&(this.spawningBubblesCounter=0,this.spawnBubble(e.GameManager.instance.hero.bodyBase.x+e.Tools.random(-40,40),e.GameManager.instance.hero.bodyBase.y+e.Tools.random(-30,10),.7+.5*Math.random()))),!0===this.dragNow&&(this.dragTree.x=this.game.input.activePointer.x,this.dragTree.y=this.game.input.activePointer.y,e.Tools.distance(this.dragTree.x,this.dragTree.y,e.GameManager.instance.hero.baseGroup.x,e.GameManager.instance.hero.baseGroup.y)<30)){this.heroHided=!0,this.tree.inputEnabled=!1,this.tree.frameName="tree instance 10000",this.stopDrag();var i=this.game.make.sprite(3,-10,"level4","shrubBranch_mc instance 10000");e.GameManager.instance.hero.graphicCar.addChild(i),e.SoundManager.playSFX("s_lvl4_shrub")}!1===this.gameOver&&!1===this.cameraMooved&&e.GameManager.instance.hero.bodyBase.x>750&&(this.cameraMooved=!0,this.game.add.tween(this.door).to({y:452},250,"Linear",!0,1500),this.game.add.tween(this.game.camera).to({x:750},1e3,"Linear",!0,0),e.GameManager.instance.hero.setClickable(!1)),!0===e.GameManager.instance.hero.getEnableMotor()&&e.GameManager.instance.hero.bodyBase.x>1e3&&(e.GameManager.instance.hero.setEnableMotor(!1),this.heroBubbles.start=!0)},i.prototype.spawnBubble=function(t,i,s){for(var a=0;a<this.bubbles.length;a++)if(!1===this.bubbles[a].visible)return this.bubbles[a].reset(t,i),this.bubbles[a].scale.setTo(s),void this.bubbles[a].animations.play("anim");var n=e.GameManager.instance.layerUpper.create(t,i,"level4","bubbleWaterPart instance 10000",!0,0);n.animations.add("anim",Phaser.Animation.generateFrameNames("bubbleWaterPart instance 1",0,9,"",4),30,!1).onComplete.add(this.bubbleComplete,this),n.animations.play("anim"),n.scale.setTo(s),this.bubbles.push(n),n=null},i.prototype.bubbleComplete=function(e,t){e.kill()},i.prototype.addGround=function(){var e=new Phaser.Physics.Box2D.Body(this.game,null,762,531,0);e.setRectangle(754,20),(e=new Phaser.Physics.Box2D.Body(this.game,null,-17,523,0)).setRectangle(300,20),(e=new Phaser.Physics.Box2D.Body(this.game,null,240,628,0)).setRectangle(280,20),(e=new Phaser.Physics.Box2D.Body(this.game,null,385,580,0)).setRectangle(20,76),e=null},i.prototype.free=function(){t.prototype.free.call(this),this.bridge=null,this.topCar=null,this.king=null,this.mage=null,this.warden1=null,this.warden2=null,this.heroBubbles=null,this.bubbles=[],this.bubbles=null,this.tree=null,this.dragTree=null,this.door=null,this.waterfall2=null,this.waterfall3=null},i}(e.BasicLevel);e.Level4=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.wheelyDiedSoon=!1,e.pickArrowCount=0,e.connectArrowGroundCounter=0,e.connectMonsterCount=0,e.connectQuestBagCount=0,e.trollMove=0,e.contactHero1Count=0,e.contactHero2Count=0,e.contactRobinCount=0,e}return __extends(i,t),i.prototype.init=function(){e.SoundManager.playSFX("s_lvl5_ambient",!0),this.arrows=new Array;var t=e.GameManager.instance.layerBackground0.create(0,0,"bgLevel5_1");t.cacheAsBitmap=!0,this.bird2=new e.Lvl5Bird2(this.game),this.updateElements.push(this.bird2),this.updateElements.push(new e.Lvl5Bear(this.game)),(t=e.GameManager.instance.layerBackground.create(256,160,"bgLevel5_2")).cacheAsBitmap=!0,this.treeBranch=new e.Lvl5TreeBranch(this.game),this.updateElements.push(this.treeBranch),this.addQuestCar(607,202,e.GameManager.instance.layerBackground),!1===this.questCarFounded&&(this.questCar.inputEnabled=!1),this.questCarBag=new e.Lvl5QuesCarBag(this.game),this.updateElements.push(this.questCarBag),this.questCarBagBody=new Phaser.Physics.Box2D.Body(this.game,null,605,199,1),this.questCarBagBody.setRectangle(28,26),this.questCarBagBody.setCollisionCategory(e.FilterGroups.CAR2),this.questCarBagSensor=new Phaser.Physics.Box2D.Body(this.game,null,605,199,1),this.questCarBagSensor.setRectangle(34,34),this.questCarBagSensor.angle=98,this.questCarBagSensor.sensor=!0,this.signal=new e.Lvl5Signal(this.game),this.updateElements.push(this.signal),this.door=new e.Lvl5Door(this.game),this.updateElements.push(this.door),e.GameManager.instance.hero=new e.Hero(this.game,55,484),this.robin=new e.Lvl5Robin(this.game),this.updateElements.push(this.robin),(t=e.GameManager.instance.layerBackground.create(466,219,"level5","ropeAxe instance 10000")).anchor.setTo(.5),t.cacheAsBitmap=!0,this.arrowPack=e.GameManager.instance.layerBackground.create(469,128,"level5","arrowPack instance 10002"),this.arrowPack.events.onInputDown.add(this.arrowPackDown,this),this.arrowPack.events.onInputOut.add(this.arrowPackOut,this),this.arrowPack.events.onInputOver.add(this.arrowPackOver,this),this.arrowPack.hitArea=new Phaser.Rectangle(0,0,82,52),(t=e.GameManager.instance.layerBackground.create(448,257,"level5","shield instance 10000")).anchor.setTo(.5),t.angle=-12,t.cacheAsBitmap=!0,this.addQuestWheel(5,213,390,e.GameManager.instance.layerBackground),this.barrier=new e.Lvl5Barrier(this.game),this.updateElements.push(this.barrier),this.monster=new e.Lvl5Monster(this.game),this.updateElements.push(this.monster),(t=e.GameManager.instance.layerUpper.create(0,600,"bgLevel5_3")).anchor.y=1,t.cacheAsBitmap=!0,this.updateElements.push(new e.Finish(this.game,767,487)),this.game.input.onDown.add(this.mouseDragStart,this),this.game.input.addMoveCallback(this.mouseDragMove,this),this.game.input.onUp.add(this.mouseDragEnd,this),this.addGround()},i.prototype.arrowPackDown=function(){if(!this.arrow||"inBow"!==this.arrow.name){this.pickArrowCount=0,this.connectArrowGroundCounter=0,e.SoundManager.playSFX("s_lvl5_takeArrow");for(var t=0;t<this.arrows.length;t++)if("pick"===this.arrows[t].name)return this.arrow=this.arrows[t],this.arrow.body.data.SetUserData("DragBody"),this.arrow.body.x=this.game.input.worldX,this.arrow.body.y=this.game.input.worldY,this.arrow.data.x=this.game.input.worldX+37,this.arrow.data.y=this.game.input.worldY,this.arrow.visible=!0,this.clearArrowVelocity(),this.arrow.body.angle=-45,void this.mouseDragStart();if(3===this.arrows.length)return this.arrows.push(this.arrows.shift()),this.arrow=this.arrows[0],this.arrow.body.data.SetUserData("DragBody"),this.arrow.body.data.SetActive(!0),this.arrow.data.data.SetActive(!0),this.arrow.visible=!0,this.arrow.body.x=this.game.input.worldX,this.arrow.body.y=this.game.input.worldY,this.arrow.data.x=this.game.input.worldX+37,this.arrow.data.y=this.game.input.worldY,this.clearArrowVelocity(),this.arrow.body.angle=-45,this.arrow.name="pick",void this.mouseDragStart();this.arrow=this.game.make.sprite(this.game.input.worldX,this.game.input.worldY,"level5","arrow instance 10000"),this.game.physics.box2d.enable(this.arrow),this.arrow.body.setRectangle(74,14),this.arrow.body.data.SetUserData("DragBody"),this.arrow.name="pick",this.arrow.body.setBodyContactCallback(this.robin.bodyBow,this.pickArrow,this),this.arrow.body.setCollisionCategory(e.FilterGroups.CAR1),this.arrow.body.setCollisionMask(~e.FilterGroups.IGNORE_CAR),e.GameManager.instance.layerUpper.addChildAt(this.arrow,e.GameManager.instance.layerUpper.getChildIndex(this.monster.group));var i=new Phaser.Physics.Box2D.Body(this.game,null,this.arrow.x+37,this.arrow.y,2);i.setCircle(11),i.setCollisionCategory(e.FilterGroups.CAR1),i.setCollisionMask(~e.FilterGroups.IGNORE_CAR),i.setBodyContactCallback(this.ground,this.connectArrowGround,this),i.setBodyContactCallback(this.monster.body,this.connectMonster,this),i.setBodyContactCallback(this.questCarBagSensor,this.connectQuestBag,this),this.game.physics.box2d.revoluteJoint(this.arrow.body,i,37),i.data.SetUserData(this.arrow),this.arrow.data=i,this.arrows.push(this.arrow),this.mouseDragStart()}},i.prototype.clearArrowVelocity=function(){this.arrow.body.velocity.x=0,this.arrow.body.velocity.y=0,this.arrow.body.angularVelocity=0,this.arrow.data.velocity.x=0,this.arrow.data.velocity.y=0,this.arrow.data.angularVelocity=0},i.prototype.blowArrow=function(t,i,s,a){a.length>160&&(a.length=160),this.clearArrowVelocity(),this.arrow.body.x=t,this.arrow.body.y=i,this.arrow.body.angle=s;var n=e.Tools.rotatePointByAngle(t,i,t+37,i,e.Tools.toRad(s));this.arrow.data.x=n.x,this.arrow.data.y=n.y,this.arrow.data.angle=s,this.arrow.visible=!0,this.arrow.body.data.SetActive(!0),this.arrow.data.data.SetActive(!0),this.arrow.body.data.SetUserData(null);var o=a.length;a=(a=a.normalise()).muleq(8*o),this.arrow.data.data.ApplyLinearImpulse(a.getBox2db2Vec2(-.016),this.arrow.body.data.GetPosition()),this.arrow.name="blow";var r=5-5*e.Tools.percentToF(o,80);r<0&&(r=0),this.arrow.body.angle+90<0?this.arrow.body.angularVelocity=-r:this.arrow.body.angularVelocity=r},i.prototype.arrowPackOut=function(){this.arrowPack.frameName="arrowPack instance 10000"},i.prototype.arrowPackOver=function(){this.arrowPack.frameName="arrowPack instance 10001"},i.prototype.mouseDragStart=function(){this.game.physics.box2d.mouseDragStart(this.game.input.activePointer.position),this.game.physics.box2d.mouseJoint&&"DragBody"!==this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.mouseDragEnd()},i.prototype.mouseDragMove=function(){this.game.physics.box2d.mouseJoint&&"DragBody"===this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.game.physics.box2d.mouseDragMove(this.game.input.activePointer.position)},i.prototype.mouseDragEnd=function(){this.game.physics.box2d.mouseDragEnd()},i.prototype.customAction=function(t){void 0===t&&(t=0),1===t?this.robin.wakeUp():2===t?this.door.activate():3===t?this.trollMove=-1:4===t?this.treeBranch.activate():5===t?this.trollMove=1:6===t?(this.robin.die(),this.updateElements.push(new e.Lvl5DirtyCloud(this.game,this.robin.body.x+30,this.robin.body.y-20))):7===t?!1===this.questCarFounded&&(this.questCarBagBody.dynamic=!0,this.questCar.inputEnabled=!0,this.questCar.input.useHandCursor=!0):8===t&&(this.wheelyDiedSoon=!0)},i.prototype.pickArrow=function(){0===this.pickArrowCount&&this.game.physics.box2d.mouseJoint&&(this.pickArrowCount=1)},i.prototype.connectArrowGround=function(t,i,s,a,n){var o=t.data.GetUserData();o||(o=i.data.GetUserData()),0===this.connectArrowGroundCounter&&"blow"===o.name&&(this.flyArrow=o,this.connectArrowGroundCounter=1,e.SoundManager.playSFX("s_lvl5_arrowHit"))},i.prototype.connectMonster=function(t,i,s,a,n){var o=t.data.GetUserData();o||(o=i.data.GetUserData()),0===this.connectMonsterCount&&"blow"===o.name&&(this.connectMonsterCount=1,this.flyArrow=o,e.SoundManager.playSFX("s_lvl5_arrowHit"))},i.prototype.connectQuestBag=function(e,t,i,s,a){var n=e.data.GetUserData();n||(n=t.data.GetUserData()),0===this.connectQuestBagCount&&"blow"===n.name&&(this.connectQuestBagCount=1)},i.prototype.update=function(){t.prototype.update.call(this),1===this.connectArrowGroundCounter&&(this.connectArrowGroundCounter=2,this.flyArrow.body.data.SetActive(!1),this.flyArrow.data.data.SetActive(!1),this.flyArrow.body.y+=5),1===this.connectMonsterCount&&(this.connectMonsterCount=2,this.flyArrow.body.data.SetActive(!1),this.flyArrow.data.data.SetActive(!1),this.flyArrow.visible=!1,this.monster.addArrow(this.flyArrow.body.x,this.flyArrow.body.y,this.flyArrow.body.angle,this.wheelyDiedSoon)),!0===this.questCarBagBody.dynamic&&this.questCar&&!0===this.questCar.visible&&(this.questCar.x=this.questCarBagBody.x,this.questCar.y=this.questCarBagBody.y,this.questCar.angle=this.questCarBagBody.angle),1===this.connectQuestBagCount&&(this.connectQuestBagCount=2,this.questCarBag.activate()),1===this.pickArrowCount&&(this.pickArrowCount=2,this.arrow.name="inBow",this.arrow.visible=!1,this.arrow.body.data.SetActive(!1),this.arrow.data.data.SetActive(!1),this.robin.weapon.takeArrow()),1===this.contactHero1Count&&(this.contactHero1Count=2,this.barrier.activate(),this.signal.activate(),e.GameManager.instance.hero.setEnableMotor(!1),e.GameManager.instance.hero.setClickable(!1),this.barrierBody.sensor=!1),1===this.contactHero2Count&&(this.contactHero2Count=2,this.bird2.activate()),1===this.contactRobinCount?(this.contactRobinCount=2,e.GameManager.instance.hero.setClickable(!0),e.GameManager.instance.hero.currEyesState=e.EyesState.afraidTime,e.GameManager.instance.hero.bodyWheelFront.fixedRotation=!1,e.GameManager.instance.hero.bodyWheelBack.fixedRotation=!1,this.arrowPack.inputEnabled=!0,this.arrowPack.input.useHandCursor=!0,this.arrowPackOut(),this.robin.menace()):2===this.contactRobinCount&&(!0===e.GameManager.instance.hero.getEnableMotor()&&(this.contactRobinCount=3),e.GameManager.instance.hero.bodyWheelBack.angularVelocity=-6),this.updateTrollPosition()},i.prototype.updateTrollPosition=function(){-1===this.trollMove?(this.monster.group.x-=4,this.monster.group.x-this.robin.body.x<250&&(this.trollMove=0,this.monster.attack(),e.SoundManager.playSFX("s_lvl5_trollAttack"))):1===this.trollMove&&(this.monster.group.x+=4,this.monster.group.x-this.robin.body.x>250&&(this.robin.body.velocity.x=240,e.SoundManager.playSFX("s_lvl5_robinFriction",!0)),this.monster.group.x>1200&&(this.trollMove=0,this.monster.destroy(),this.robin.destroy(),e.SoundManager.stopSFXLoop("s_lvl5_robinStars"),e.SoundManager.stopSFXLoop("s_lvl5_robinFriction")))},i.prototype.addGround=function(){this.ground=new Phaser.Physics.Box2D.Body(this.game,null,400,547,0),this.ground.setRectangle(1e3,30);var t=new Phaser.Physics.Box2D.Body(this.game,null,322,480,0);t.setRectangle(12,100),t.sensor=!0,e.GameManager.instance.hero.bodyBase.setBodyContactCallback(t,this.contactHero1,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,516,480,0)).setRectangle(12,100),t.sensor=!0,e.GameManager.instance.hero.bodyBase.setBodyContactCallback(t,this.contactHero2,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1e3,480,0)).setRectangle(10,100),t.setCollisionMask(~e.FilterGroups.CAR2),(t=new Phaser.Physics.Box2D.Body(this.game,null,452,520,0)).setRectangle(100,10),t.sensor=!0,t.setBodyContactCallback(this.robin.body,this.contactRobin,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,610,304,0)).setRectangle(100,14),t.setCollisionCategory(e.FilterGroups.CAR2),t=null,this.barrierBody=new Phaser.Physics.Box2D.Body(this.game,null,12,480,0),this.barrierBody.setRectangle(88,100),this.barrierBody.sensor=!0,this.barrierBody.setCollisionCategory(e.FilterGroups.CAR2)},i.prototype.contactHero1=function(){0===this.contactHero1Count&&(this.contactHero1Count=1)},i.prototype.contactHero2=function(){0===this.contactHero2Count&&(this.contactHero2Count=1)},i.prototype.contactRobin=function(){0===this.contactRobinCount&&(this.contactRobinCount=1)},i.prototype.free=function(){t.prototype.free.call(this),this.treeBranch=null,this.bird2=null,this.questCarBag=null,this.signal=null,this.door=null,this.barrier=null,this.monster=null,this.robin=null,this.barrierBody=null,this.arrowPack=null,this.arrow=null,this.arrows=[],this.arrows=null,this.ground=null,this.questCarBagBody=null,this.questCarBagSensor=null,this.flyArrow=null},i}(e.BasicLevel);e.Level5=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.ground=[[142.25,538.1,89,19,284],[595.65,475.95,89,19,128],[797.1,505.45,102,19,285],[377.85,508.75,-102,19,319],[1152.2,538.05,89,19,455],[1369.75,455.95,179,19,191]],e.swordDown=!1,e.swordShowed=!1,e.gameOver=!1,e.gameOverCounter=0,e}return __extends(i,t),i.prototype.init=function(){this.game.world.resize(800,600);var t=e.GameManager.instance.layerBackground0.create(0,0,"bgLevel6_1");t.cacheAsBitmap=!0,(t=e.GameManager.instance.layerBackground.create(0,32,"bgLevel6_2")).cacheAsBitmap=!0,(t=e.GameManager.instance.layerUpper.create(0,600,"bgLevel6_3")).anchor.y=1,t.cacheAsBitmap=!0,t=null,e.GameManager.instance.hero=new e.Hero(this.game,56,485),e.GameManager.instance.hero.setCollideWorldBounds(!1),e.GameManager.instance.hero.angleKeep=e.Tools.toRad(15);new e.Finish(this.game,780,455);this.addGround(),this.addHouse(),this.addCars(),this.addSword(),this.addFlags(),this.game.input.onDown.add(this.mouseDragStart,this),this.game.input.addMoveCallback(this.mouseDragMove,this),this.game.input.onUp.add(this.mouseDragEnd,this),this.addQuestWheel(6,32,124,e.GameManager.instance.layerUpper)},i.prototype.addFlags=function(){var t=new e.Lvl6Flags(this.game);this.updateElements.push(t)},i.prototype.addChicken=function(){var t=new e.Lvl6Chicken(this.game);this.updateElements.push(t)},i.prototype.addSword=function(){this.sword=e.GameManager.instance.layerElements.create(593,502,"level6","sword12 instance 10000"),this.sword.anchor.set(.5,1),this.sword.angle=-5,this.swordAnim=this.game.add.tween(this.sword).to({angle:5},500,"Linear",!0,0,-1,!0),this.swordUI=new e.Lvl6SwordUI,this.updateElements.push(this.swordUI)},i.prototype.playAnim=function(){this.swordAnim.stop(),this.swordAnim=this.game.add.tween(this.sword).to({angle:5},500,"Linear",!0,0,-1,!0)},i.prototype.showSwordUI=function(){this.swordUI.show(),this.sword.inputEnabled=!0,this.sword.input.useHandCursor=!0,this.sword.events.onInputDown.add(this.down,this),this.sword.events.onInputUp.add(this.up,this),this.sword.events.onInputOut.add(this.out,this)},i.prototype.down=function(){this.swordDown=!0},i.prototype.up=function(){this.swordDown=!1,this.swordUI.up()},i.prototype.out=function(){if(!0===this.swordDown){var t=1;this.game.input.activePointer.x<this.sword.x&&(t=-1),this.game.add.tween(this.sword).to({angle:5*t},100,"Linear",!0),this.swordUI.setProgress(4),!0===this.swordUI.full&&(this.sword.inputEnabled=!1,this.swordDown=!1,this.game.add.tween(this.sword).to({y:this.sword.y-50},500,"Linear",!0).onComplete.add(function(){this.game.add.tween(this.sword).to({x:e.GameManager.instance.hero.bodyBase.x-50,y:e.GameManager.instance.hero.bodyBase.y+20,angle:25},300,"Linear",!0),this.game.add.tween(this.sword.scale).to({x:.6,y:.6},300,"Linear",!0).onComplete.add(this.addCarSword,this)},this))}},i.prototype.addCarSword=function(){this.sword.visible=!1;var t=this.game.make.sprite(15,60,"level6","sword12 instance 10000");t.anchor.set(.5,1),t.angle=25,t.scale.set(.6),e.GameManager.instance.hero.graphicCar.addChild(t),e.GameManager.instance.hero.setEnableMotor(!0)},i.prototype.addHouse=function(){this.house=new e.Lvl6House,this.updateElements.push(this.house)},i.prototype.addCars=function(){this.car1=new e.Lvl6Car1(this.game),this.updateElements.push(this.car1),this.car2=new e.Lvl6Car2(this.game),this.updateElements.push(this.car2),this.car3=new e.Lvl6Car3(this.game),this.updateElements.push(this.car3),this.car4=new e.Lvl6Car4(this.game),this.updateElements.push(this.car4)},i.prototype.moveCars=function(){this.car2.move(),this.car3.move(),this.car4.move()},i.prototype.stopCars=function(){this.car2.stopMove(),this.car3.stopMove(),this.car4.stopMove()},i.prototype.mouseDragStart=function(){this.game.physics.box2d.mouseDragStart(this.game.input.activePointer.position),this.game.physics.box2d.mouseJoint&&"DragBody"!==this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.mouseDragEnd()},i.prototype.mouseDragMove=function(){this.game.physics.box2d.mouseJoint&&"DragBody"===this.game.physics.box2d.mouseJoint.GetBodyB().GetUserData()&&this.game.physics.box2d.mouseDragMove(this.game.input.activePointer.position)},i.prototype.mouseDragEnd=function(){this.game.physics.box2d.mouseDragEnd()},i.prototype.customAction=function(e){void 0===e&&(e=0)},i.prototype.update=function(){t.prototype.update.call(this),!1===this.swordShowed&&e.GameManager.instance.hero.bodyBase.x>590&&(this.swordShowed=!0,this.showSwordUI(),this.swordAnim.stop(),this.sword.angle=0,e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!1)),!0===this.gameOver&&(this.gameOverCounter+=1,60===this.gameOverCounter&&e.LevelBuilder.instance.levelFailed())},i.prototype.addGround=function(){for(var e,t=0;t<this.ground.length;t++)(e=new Phaser.Physics.Box2D.Body(this.game,null,this.ground[t][0],this.ground[t][1],0)).setRectangle(this.ground[t][3],this.ground[t][4]),e.angle=this.ground[t][2],e.friction=1;e=null},i.prototype.free=function(){t.prototype.free.call(this),this.house=null,this.car1=null,this.car2=null,this.car3=null,this.car4=null,this.ground=[],this.ground=null,this.sword=null,this.swordAnim=null,this.swordUI=null},i}(e.BasicLevel);e.Level6=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.stoneVisible=!0,e.heroInWater=!1,e.counterHeroInWater=0,e.magicTransformVisible=!1,e.counterMagicTrans=0,e.startMoveCamera=!1,e.frogTransformed=0,e.heroTransFormed=0,e.spawningBubblesCounter=0,e.playCreakCount=0,e.showDragonCount=0,e}return __extends(i,t),i.prototype.init=function(){this.bubbles=new Array,this.magicTransformAnim=new Array,this.game.world.resize(800,880);var t=e.GameManager.instance.layerBackground.create(0,0,"bgLevel7_1");t.cacheAsBitmap=!0,this.addQuestWheel(7,158,623,e.GameManager.instance.layerBackground),this.bridge=new e.Lvl7Bridge(this.game),this.updateElements.push(this.bridge),this.dragon=new e.Lvl7Dragon(this.game),this.updateElements.push(this.dragon),this.updateElements.push(new e.Lvl7Flowers(this.game)),this.stonePlatform=new e.Lvl7StonePlatform(this.game),this.updateElements.push(this.stonePlatform),this.frog=new e.Lvl7Frog(this.game),this.updateElements.push(this.frog);for(var i,s=0;s<3;s++)(i=new e.SASprite(this.game,0,0,"level7")).anchor.setTo(.5),i.animations.add("anim",Phaser.Animation.generateFrameNames("magicTransform instance 1",0,7,"",4),30,!0),i.visible=!1,e.GameManager.instance.layerUpper.addChild(i),this.magicTransformAnim.push(i);i=null,this.magicBridge=new e.Lvl7MagicBridge(this.game),this.updateElements.push(this.magicBridge),(t=e.GameManager.instance.layerUpper.create(0,880,"bgLevel7_2")).anchor.y=1,t.cacheAsBitmap=!0,this.questTree=new e.Lvl7QuestTree(this.game),this.updateElements.push(this.questTree),this.buttons=new e.Lvl7Buttons(this.game,this),this.updateElements.push(this.buttons),t=null,this.cloudPlatform=new e.Lvl7CloudPlatform(this.game),this.updateElements.push(this.cloudPlatform),e.GameManager.instance.hero=new e.Hero(this.game,70,450),e.GameManager.instance.hero.setCollideWorldBounds(!1),e.GameManager.instance.hero.angleKeep=e.Tools.toRad(20),e.GameManager.instance.hero.bodyBase.linearDamping=1,e.GameManager.instance.hero.bodyBase.angularDamping=10,this.magicBullet=new e.Lvl7MagicBullet(this.game),this.updateElements.push(this.magicBullet),this.magicBullet.body.setBodyContactCallback(this.frog.body,this.transformFrog,this),this.magicBullet.body.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.transformHero,this),this.updateElements.push(new e.Finish(this.game,735,453,!0,e.GameManager.instance.layerBackground)),this.addGround(),this.createWater()},i.prototype.transformFrog=function(){0===this.frogTransformed&&(this.frogTransformed=1)},i.prototype.transformHero=function(){0===this.heroTransFormed&&(this.heroTransFormed=1)},i.prototype.customAction=function(t){void 0===t&&(t=0),1===t?!0===this.stoneVisible?(this.stonePlatform.hide(),this.magicBridge.show()):(this.stonePlatform.show(),this.magicBridge.hide()):2===t?this.cloudPlatform.setActivity():3===t?this.magicBullet.blow():4===t?this.questTree.setBody():5===t?this.stoneVisible=!0:6===t?this.stoneVisible=!1:7===t?this.frog.playAnim("jump"):8===t?0===this.frogTransformed?this.frog.playAnim("eat"):e.LevelBuilder.instance.levelFailed():9===t?this.mosquito.playAnim("anim"):10===t?this.buttons.deactivateButton3():11===t?this.mosquito.eated():12===t?this.magicBridge.activeteBody():13===t?e.GameManager.instance.hero.currEyesState=e.EyesState.afraid:14===t&&(this.updateElements.push(new e.Lvl3MagicExplosion(this.game,420,500)),this.startMoveCamera=!0,this.bridge.crash(),this.buttons.activateButton1(),e.GameManager.instance.hero.setEnableMotor(!1,!1),e.GameManager.instance.hero.clearVelosityX(),e.GameManager.instance.hero.currEyesState=e.EyesState.idle)},i.prototype.update=function(){if(t.prototype.update.call(this),1===this.showDragonCount&&(this.showDragonCount=2,this.dragon.playAppear(),e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!0,!1)),!0===this.startMoveCamera&&(this.game.camera.y+=10,this.game.camera.y>=280&&(this.game.camera.y=280,this.startMoveCamera=!1,e.GameManager.instance.hero.setClickable(!0))),!0===this.heroInWater&&(this.counterHeroInWater+=1,1===this.counterHeroInWater?(e.GameManager.instance.hero.currEyesState=e.EyesState.bumpForEver,e.GameManager.instance.hero.bodyBase.mass=4.5):80===this.counterHeroInWater&&e.LevelBuilder.instance.levelFailed(),this.spawningBubblesCounter+=1,2===this.spawningBubblesCounter&&(this.spawningBubblesCounter=0,this.spawnBubble(e.GameManager.instance.hero.bodyBase.x+e.Tools.random(-40,40),e.GameManager.instance.hero.bodyBase.y+e.Tools.random(-30,10),.7+.5*Math.random()))),1===this.frogTransformed){this.frogTransformed=2,this.magicBullet.deactive(),this.magicTransformAnim[0].x=this.frog.body.x+1-40,this.magicTransformAnim[0].y=this.frog.body.y+5+10,this.magicTransformAnim[1].x=this.frog.body.x+1+40,this.magicTransformAnim[1].y=this.frog.body.y+5+10,this.magicTransformAnim[2].x=this.frog.body.x+1,this.magicTransformAnim[2].y=this.frog.body.y+5-40;for(s=0;s<this.magicTransformAnim.length;s++)this.magicTransformAnim[s].visible=!0,this.magicTransformAnim[s].animations.play("anim"),this.magicTransformAnim[s].scale.setTo(.51),this.magicTransformAnim[s].alpha=0,e.SoundManager.playSFX("sfx_spellTransform");this.magicTransformVisible=!0,this.counterMagicTrans=0}if(1===this.heroTransFormed){this.heroTransFormed=2,this.magicBullet.deactive(),this.magicTransformAnim[0].x=e.GameManager.instance.hero.bodyBase.x+1-40,this.magicTransformAnim[0].y=e.GameManager.instance.hero.bodyBase.y+5+10,this.magicTransformAnim[1].x=e.GameManager.instance.hero.bodyBase.x+1+40,this.magicTransformAnim[1].y=e.GameManager.instance.hero.bodyBase.y+5+10,this.magicTransformAnim[2].x=e.GameManager.instance.hero.bodyBase.x+1,this.magicTransformAnim[2].y=e.GameManager.instance.hero.bodyBase.y+5-40;for(s=0;s<this.magicTransformAnim.length;s++)this.magicTransformAnim[s].visible=!0,this.magicTransformAnim[s].animations.play("anim"),this.magicTransformAnim[s].scale.setTo(.51),this.magicTransformAnim[s].alpha=0,e.SoundManager.playSFX("sfx_spellTransform");this.magicTransformVisible=!0,this.counterMagicTrans=0}if(!0===this.magicTransformVisible)if(this.counterMagicTrans+=1,1===this.counterMagicTrans)for(s=0;s<this.magicTransformAnim.length;s++)this.setSimpleTween(this.magicTransformAnim[s],24,{scX:1,scY:1,alpha:1});else if(25===this.counterMagicTrans)for(s=0;s<this.magicTransformAnim.length;s++){i=e.Tools.random(110,130)/100;this.setSimpleTween(this.magicTransformAnim[s],11,{scX:i,scY:i})}else if(30===this.counterMagicTrans)2===this.frogTransformed&&(this.frog.group.visible=!1,this.frog.activeAnim=!1,this.addQuestCar(this.frog.body.x,this.frog.body.y+23,e.GameManager.instance.layerUpper,e.GameManager.instance.layerUpper.getChildIndex(this.frog.group))),2===this.heroTransFormed&&(e.SoundManager.playSFX("s_lvl10_gnatNoise"),e.GameManager.instance.hero.setEnableMotor(!1,!1),e.GameManager.instance.hero.setActiveBodies(!1),e.GameManager.instance.hero.setVisibility(!1),this.mosquito=new e.Lvl7Mosquito(this.game,this.frog),this.updateElements.push(this.mosquito));else if(36===this.counterMagicTrans)for(s=0;s<this.magicTransformAnim.length;s++){var i=e.Tools.random(140,160)/100;this.setSimpleTween(this.magicTransformAnim[s],19,{scX:i,scY:i,alpha:0})}else if(55===this.counterMagicTrans){this.magicTransformVisible=!1;for(var s=0;s<this.magicTransformAnim.length;s++)this.magicTransformAnim[s].visible=!1,this.magicTransformAnim[s].animations.stop()}},i.prototype.spawnBubble=function(t,i,s){for(var a=0;a<this.bubbles.length;a++)if(!1===this.bubbles[a].visible)return this.bubbles[a].visible=!0,this.bubbles[a].x=t,this.bubbles[a].y=i,this.bubbles[a].scale.setTo(s),void this.bubbles[a].animations.play("anim");var n=e.GameManager.instance.layerUpper.create(t,i,"level7");n.animations.add("anim",Phaser.Animation.generateFrameNames("bubbleWaterPart instance 1",0,9,"",4),30,!1).onComplete.add(this.bubbleComplete,this),n.animations.play("anim"),n.scale.setTo(s),this.bubbles.push(n),n=null},i.prototype.bubbleComplete=function(e,t){e.visible=!1},i.prototype.createWater=function(){this.water=new Phaser.Physics.Box2D.Body(this.game,null,400,865,0);var e=this.water.setRectangle(650,100);e.SetDensity(2),e.SetFriction(.3),e.SetRestitution(0),e=null,this.water.sensor=!0,this.water.setCategoryContactCallback(1,this.onContactWithWater,this),this.m_controller=new box2d.b2BuoyancyController,this.m_controller.normal.SetXY(0,1),this.m_controller.offset=-16.3,this.m_controller.useDensity=!0,this.m_controller.density=2,this.m_controller.linearDrag=3,this.m_controller.angularDrag=2,this.game.physics.box2d.world.AddController(this.m_controller)},i.prototype.onContactWithWater=function(e,t,i,s,a){e!==t&&!0!==t.sensor&&!1!==t.dynamic&&"notWater"!==t.data.GetUserData()&&(!0===a?null===t.data.GetControllerList()&&(this.m_controller.AddBody(t.data),"heroCorpus"===t.data.GetUserData()&&(this.heroInWater=!0)):null!==t.data.GetControllerList()&&this.m_controller.RemoveBody(t.data))},i.prototype.addGround=function(){var t=new Phaser.Physics.Box2D.Body(this.game,null,59,550,0);t.setRectangle(150,100),t.setCollisionMask(~e.FilterGroups.WALL),(t=new Phaser.Physics.Box2D.Body(this.game,null,862,550,0)).setRectangle(360,100),t.setCollisionMask(~e.FilterGroups.WALL),(t=new Phaser.Physics.Box2D.Body(this.game,null,960,450,0)).setRectangle(10,100),(t=new Phaser.Physics.Box2D.Body(this.game,null,91,748,0)).setRectangle(16,312),t.angle=12,(t=new Phaser.Physics.Box2D.Body(this.game,null,203,460,0)).setRectangle(10,100),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.playCreak,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,293,450,0)).setRectangle(10,100),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.showDragon,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,724,747,0)).setRectangle(16,312),t.angle=-8,(t=new Phaser.Physics.Box2D.Body(this.game,null,186,802,0)).setRectangle(100,10),t.setCollisionMask(~e.FilterGroups.WALL),this.game.physics.box2d.prismaticJoint(t,this.frog.body,0,-1,0,0,0,0,0,0,!1,0,200,!0).m_collideConnected=!0,t=null},i.prototype.playCreak=function(){0===this.playCreakCount&&(this.playCreakCount=1,e.SoundManager.playSFX("s_lvl10_bridgeCreak",!0))},i.prototype.showDragon=function(){0===this.showDragonCount&&(this.showDragonCount=1)},i.prototype.free=function(){t.prototype.free.call(this),this.bridge=null,this.buttons=null,this.questTree=null,this.stonePlatform=null,this.frog=null,this.water=null,this.m_controller=null,this.magicBridge=null,this.magicBullet=null,this.mosquito=null,this.cloudPlatform=null,this.dragon=null,this.magicTransformAnim=[],this.magicTransformAnim=null,this.bubbles=[],this.bubbles=null},i}(e.BasicLevel);e.Level7=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.openSecret=!1,e.buttonUse=!1,e.autoWheelRotate=!1,e.gameOver=0,e.gameOverTimer=0,e}return __extends(i,t),i.prototype.init=function(){e.GameManager.instance.layerBackground.create(0,0,"bgLevel8_1").cacheAsBitmap=!0,e.GameManager.instance.layerUpper.create(0,42,"bgLevel8_2").cacheAsBitmap=!0,e.GameManager.instance.hero=new e.Hero(this.game,60,220),e.GameManager.instance.hero.jointBack.SetMaxMotorTorque(4.4),this.addGround(),this.addPlatform(),this.addSecret(),this.addElevator(),this.addRopeArm(),this.addButton(),this.addQuestWheel(8,461,95,e.GameManager.instance.layerBackground);new e.Finish(this.game,730,433,!0,e.GameManager.instance.layerUpper)},i.prototype.customAction=function(t){void 0===t&&(t=0),0===t&&e.GameManager.instance.hero.bodyBase.y>250&&(e.GameManager.instance.hero.getEnableMotor()?(this.autoWheelRotate=!1,!1===this.buttonUse&&e.GameManager.instance.hero.setWheelsRotateAvailable(!0)):e.GameManager.instance.hero.setWheelsRotateAvailable(!1))},i.prototype.addPlatform=function(){var t=new e.Lvl8Platform(this.game);this.updateElements.push(t),t=null},i.prototype.addElevator=function(){this.elevator=new e.Lvl8Elevator(this.game),this.updateElements.push(this.elevator)},i.prototype.addRopeArm=function(){this.ropeArm=new e.Lvl8RopeArm(this.game,429,490),this.updateElements.push(this.ropeArm)},i.prototype.addSecret=function(){e.GameManager.instance.layerBackground.create(732,193,"level8","secretBack instance 10000"),this.addQuestCar(772,242,e.GameManager.instance.layerBackground),this.secretStone=e.GameManager.instance.layerUpper.create(772,235,"level8","secretFront instance 10000"),this.secretStone.anchor.set(.5),this.secretStone.inputEnabled=!0,this.secretWheel=this.game.make.button(743,301,"level8",this.rotateWheel,this,"hiddenWheel instance 10001","hiddenWheel instance 10000","hiddenWheel instance 10000","hiddenWheel instance 10000"),this.secretWheel.anchor.set(.5),this.secretWheel.inputEnabled=!1,e.GameManager.instance.layerUpper.addChild(this.secretWheel),this.blueLamp=this.game.make.sprite(0,0,"level8","blueLamp instance 10000"),this.blueLamp.anchor.set(.5),this.blueLamp.visible=!1,this.secretWheel.addChild(this.blueLamp)},i.prototype.rotateWheel=function(){this.secretWheel.inputEnabled=!1,this.openSecret=!0,this.blueLamp.visible=!1,e.SoundManager.playSFX("s_lvl7_platformMove"),this.game.add.tween(this.secretWheel).to({angle:90},1e3,Phaser.Easing.Linear.None,!0).onComplete.add(this.showCar,this)},i.prototype.showCar=function(){e.SoundManager.playSFX("s_lvl7_armMove"),this.game.add.tween(this.secretStone.scale).to({x:.94,y:.94},200,Phaser.Easing.Linear.None,!0).onComplete.add(function(){this.secretStone.inputEnabled=!1,this.game.add.tween(this.secretStone).to({x:this.secretStone.x+46},700,Phaser.Easing.Linear.None,!0,150)},this)},i.prototype.setWheelRotate=function(e){!1===this.openSecret&&(this.blueLamp.visible=e,this.secretWheel.inputEnabled=e,!0===e&&(this.secretWheel.input.useHandCursor=!0))},i.prototype.addButton=function(){this.redButton=e.GameManager.instance.layerBackground.create(66,423,"level8","button instance 10000"),this.redButton.animations.add("use",Phaser.Animation.generateFrameNames("button instance 1",0,9,"",4),30,!1),this.game.physics.box2d.enable(this.redButton),this.redButton.body.static=!0,this.redButton.body.sensor=!0,this.redButton.body.setBodyContactCallback(e.GameManager.instance.hero.bodyWheelBack,this.useButton,this)},i.prototype.useButton=function(){!1===this.buttonUse&&(this.redButton.play("use"),e.SoundManager.playSFX("s_lvl7_pressButton"),this.buttonUse=!0,this.ropeArm.show())},i.prototype.update=function(){t.prototype.update.call(this),this.elevator.moveTo(this.ropeArm.getDirection()),!1===this.autoWheelRotate&&e.GameManager.instance.hero.bodyBase.x>140&&e.GameManager.instance.hero.bodyBase.y>250&&(this.autoWheelRotate=!0,e.GameManager.instance.hero.setWheelsRotateAvailable(!0)),0===this.gameOver&&e.GameManager.instance.hero.bodyBase.y>600&&(this.gameOver=1,e.SoundManager.playSFX("s_lvl7_wheelyFall")),1===this.gameOver&&(this.gameOverTimer+=1,60===this.gameOverTimer&&(this.gameOver=2,e.LevelBuilder.instance.levelFailed())),this.elevator.platform.body.y>300?this.wall.sensor=!0:this.wall.sensor=!1},i.prototype.addGround=function(){var e=new Phaser.Physics.Box2D.Body(this.game,null,75,281,0);e.setRectangle(150,30),(e=new Phaser.Physics.Box2D.Body(this.game,null,90,443,0)).setRectangle(180,25),(e=new Phaser.Physics.Box2D.Body(this.game,null,440,465,0)).setRectangle(78,268),(e=new Phaser.Physics.Box2D.Body(this.game,null,468,310,0)).setRectangle(70,42),(e=new Phaser.Physics.Box2D.Body(this.game,null,713,493,0)).setRectangle(163,25),(e=new Phaser.Physics.Box2D.Body(this.game,null,-12,364,0)).setRectangle(25,150),(e=new Phaser.Physics.Box2D.Body(this.game,null,730,310,0)).setRectangle(160,25),(e=new Phaser.Physics.Box2D.Body(this.game,null,656,233,0)).setRectangle(25,160),e=null,this.wall=new Phaser.Physics.Box2D.Body(this.game,null,644,400,0),this.wall.setRectangle(25,160)},i.prototype.free=function(){t.prototype.free.call(this),this.secretStone=null,this.secretWheel=null,this.blueLamp=null,this.redButton=null,this.elevator=null,this.ropeArm=null,this.wall=null},i}(e.BasicLevel);e.Level8=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.platformSpeed=70,e.cameraSpeed=2,e.firstCubeMove=!1,e.lastCubeMove=!1,e.wheelyShoked=!1,e.cameraDestinationX=0,e.cameraDestinationY=0,e.insideRoom=0,e.moveCamera=!1,e.initRoom1Count=0,e.initRoom2Count=0,e.initRoom3Count=0,e.initRoom4Count=0,e.initRoom42Count=0,e.initRoom5Count=0,e.initRoom6Count=0,e.initRoom62Count=0,e.initRoom7Count=0,e.initRoom8Count=0,e.initRoom9Count=0,e.contactPoint1Count=0,e.contactPoint2Count=0,e.contactPoint3Count=0,e.contactPoint4Count=0,e.inRoom1Count=0,e.inRoom2Count=0,e.inRoom3Count=0,e.inRoom4Count=0,e.inRoom5Count=0,e.inRoom6Count=0,e.inRoom7Count=0,e.inRoom8Count=0,e.inRoom9Count=0,e}return __extends(i,t),i.prototype.init=function(){this.insideRoom=e.DataManager.getInstance().saveObj.insideRoom,this.insideRoom||(this.insideRoom=0),e.SoundManager.playSFX("s_lvl8_ambient",!0),this.game.world.resize(2860,1196),this.roomSpeed=this.platformSpeed/60,e.GameManager.instance.layerBackground0.fixedToCamera=!0,this.rooms=new Array;var t;if(0===this.insideRoom&&((t=e.GameManager.instance.layerBackground.create(192,160,"level9")).animations.add("anim",Phaser.Animation.generateFrameNames("bgFire instance 1",0,59,"",4),40,!0),t.animations.play("anim"),t.cacheAsBitmap=!0,(t=e.GameManager.instance.layerBackground.create(0,0,"level9","bgPart1 instance 10000")).cacheAsBitmap=!0,(t=e.GameManager.instance.layerUpper.create(0,236,"level9","bgPart2 instance 10000")).cacheAsBitmap=!0),(t=e.GameManager.instance.layerBackground.create(2860,1196,"level9","bgPart3 instance 10000")).anchor.setTo(1),(t=e.GameManager.instance.layerUpper.create(2860,1196,"level9","bgPart4 instance 10000")).anchor.setTo(1),this.addQuestWheel(9,2715,685,e.GameManager.instance.layerUpper),t=null,this.createRooms(),0===this.insideRoom)this.background=new e.Lvl9Background(this.game,0,0),this.platformHero=new e.Lvl9PlatformHero(this.game,390,311),this.updateElements.push(this.platformHero),e.GameManager.instance.hero=new e.Hero(this.game,100,260);else{this.rooms[this.insideRoom-1].show(-1);var i=this.rooms[this.insideRoom-1].x,s=this.rooms[this.insideRoom-1].y,a=s-300;this.game.camera.x=this.cameraDestinationX=i-400,a>0&&(this.game.camera.y=this.cameraDestinationY=a),this.background=new e.Lvl9Background(this.game,-this.game.camera.x/2,-this.game.camera.y/2),this.platformHero=new e.Lvl9PlatformHero(this.game,i,s+46),this.updateElements.push(this.platformHero),e.GameManager.instance.hero=new e.Hero(this.game,i,s-7),e.GameManager.instance.hero.setClickable(!1),this.jointHeroPlatform=this.game.physics.box2d.revoluteJoint(e.GameManager.instance.hero.bodyBase,this.platformHero.body,0,0,0,-53)}this.updateElements.push(new e.Finish(this.game,2712,997)),this.addGround()},i.prototype.createRooms=function(){var t=new e.Lvl9Room1(this.game);this.updateElements.push(t),this.rooms.push(t),this.insideRoom>0&&(t.x=890),t=new e.Lvl9Room2(this.game),this.updateElements.push(t),this.rooms.push(t),t=new e.Lvl9Room3(this.game),this.updateElements.push(t),this.rooms.push(t),t=new e.Lvl9Room4(this.game),this.updateElements.push(t),this.rooms.push(t),t=new e.Lvl9Room5(this.game),this.updateElements.push(t),this.rooms.push(t),t=new e.Lvl9Room6(this.game),this.updateElements.push(t),this.rooms.push(t),t=new e.Lvl9Room7(this.game),this.updateElements.push(t),this.rooms.push(t),t=new e.Lvl9Room8(this.game),this.updateElements.push(t),this.rooms.push(t),t=new e.Lvl9Room9(this.game),this.updateElements.push(t),this.rooms.push(t),t=null},i.prototype.customAction=function(e){void 0===e&&(e=0),1===e?this.move(0,-1):2===e?(9===this.insideRoom&&(this.lastCubeMove=!0),this.move(1,0)):3===e?this.move(0,1):4===e?this.move(-1,0):5===e?this.removeJointHeroPlatform():6===e&&(this.wheelyShoked=!0,this.platformHero.stop())},i.prototype.createJointHeroPlatform=function(){e.GameManager.instance.hero.bodyBase.x=this.platformHero.body.x,e.GameManager.instance.hero.bodyBase.y=this.platformHero.body.y-53,this.jointHeroPlatform=this.game.physics.box2d.revoluteJoint(e.GameManager.instance.hero.bodyBase,this.platformHero.body,0,0,0,-53)},i.prototype.removeJointHeroPlatform=function(){this.game.physics.box2d.world.DestroyJoint(this.jointHeroPlatform)},i.prototype.update=function(){t.prototype.update.call(this),1===this.contactPoint1Count&&(this.contactPoint1Count=2,this.createJointHeroPlatform()),1===this.contactPoint3Count&&(this.contactPoint3Count=2,this.removeJointHeroPlatform(),this.platformHero.stop(),e.GameManager.instance.hero.setEnableMotor(!0),e.GameManager.instance.hero.setCollideWorldBounds(!1)),this.updateCamera()},i.prototype.updateCamera=function(){!0!==this.wheelyShoked&&(!0===this.firstCubeMove&&(this.rooms[0].x+=this.roomSpeed,this.rooms[0].x>890&&(this.rooms[0].x=890,this.firstCubeMove=!1,this.savePoint(1),this.rooms[0].activateDoors(),this.platformHero.stop())),!0===this.lastCubeMove&&(this.rooms[8].x+=this.roomSpeed,this.rooms[8].x>2222&&(this.rooms[8].x=2222,this.lastCubeMove=!1)),!1!==this.moveCamera&&(this.game.camera.x!==this.cameraDestinationX&&(Math.abs(this.game.camera.x-this.cameraDestinationX)<=this.cameraSpeed?(this.game.camera.x=this.cameraDestinationX,this.moveCamera=!1):this.game.camera.x>=2060?(this.cameraDestinationX=this.game.camera.x,this.moveCamera=!1):this.game.camera.x>this.cameraDestinationX?(this.background.move(1,0),this.game.camera.x-=this.cameraSpeed):this.game.camera.x<this.cameraDestinationX&&(this.background.move(-1,0),this.game.camera.x+=this.cameraSpeed)),this.game.camera.y!==this.cameraDestinationY&&(Math.abs(this.game.camera.y-this.cameraDestinationY)<=this.cameraSpeed?(this.game.camera.y=this.cameraDestinationY,this.moveCamera=!1):this.game.camera.y>=596&&this.game.camera.y<this.cameraDestinationY?(this.cameraDestinationY=this.game.camera.y,this.moveCamera=!1):this.game.camera.y>this.cameraDestinationY?(this.game.camera.y-=this.cameraSpeed,this.background.move(0,1)):this.game.camera.y<this.cameraDestinationY&&(this.game.camera.y+=this.cameraSpeed,this.background.move(0,-1)))))},i.prototype.move=function(e,t){this.moveCamera=!0,this.platformHero.move(this.platformSpeed*e,this.platformSpeed*t),this.cameraDestinationX=this.game.camera.x+540*e,this.cameraDestinationY=this.game.camera.y+330*t,this.rooms[this.insideRoom-1].deactivateDoors()},i.prototype.savePoint=function(t){this.insideRoom=t,3!==t&&4!==t&&6!==t&&7!==t&&9!==t&&e.DataManager.getInstance().saveData("insideRoom",t)},i.prototype.initRoom=function(t,i){this.rooms[t-1].show(i),e.SoundManager.playSFX("s_lvl8_openDoors"),this.insideRoom>0&&(-1===(i-=2)?i=3:-2===i&&(i=2),this.rooms[this.insideRoom-1].openDoor(i))},i.prototype.inRoom=function(t){this.insideRoom!==t&&(1===t?(this.firstCubeMove=!0,this.cameraDestinationX=490,this.moveCamera=!0):(e.SoundManager.playSFX("s_lvl8_closeDoors"),this.platformHero.stop(),this.rooms[this.insideRoom-1].hide(!0),this.savePoint(t),this.rooms[this.insideRoom-1].activate()))},i.prototype.addGround=function(){var t;(t=new Phaser.Physics.Box2D.Body(this.game,null,141,332,0)).setRectangle(346,56),(t=new Phaser.Physics.Box2D.Body(this.game,null,241,258,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom1,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,460,261,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.contactPoint1,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,648,252,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.inRoom1,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1101,252,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom2,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,897,377,0)).setRectangle(92,54),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom4,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1495,252,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.inRoom2,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1645,252,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom3,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1413,377,0)).setRectangle(92,54),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom5,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,2040,252,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.inRoom3,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,830,673,0)).setRectangle(12,54),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.inRoom4,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1419,673,0)).setRectangle(92,54),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.inRoom5,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1645,615,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom6,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1215,615,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom42,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1421,740,0)).setRectangle(92,16),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom8,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,2068,613,0)).setRectangle(73,28),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.inRoom6,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,822,997,0)).setRectangle(12,54),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.inRoom7,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1421,1020,0)).setRectangle(92,16),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.inRoom8,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1215,997,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom7,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1645,997,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom9,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,2040,997,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.inRoom9,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,1980,890,0)).setRectangle(92,16),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.initRoom62,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,2330,989,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.contactPoint2,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,2483,989,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.contactPoint3,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,2632,989,0)).setRectangle(16,92),t.sensor=!0,t.setBodyContactCallback(e.GameManager.instance.hero.bodyBase,this.contactPoint4,this),(t=new Phaser.Physics.Box2D.Body(this.game,null,2817,1060,0)).setRectangle(644,56),(t=new Phaser.Physics.Box2D.Body(this.game,null,3084,977,0)).setRectangle(100,100),t=null},i.prototype.initRoom1=function(){0===this.initRoom1Count&&(this.initRoom1Count=1,this.initRoom(1,3))},i.prototype.initRoom2=function(){0===this.initRoom2Count&&(this.initRoom2Count=1,this.initRoom(2,3))},i.prototype.initRoom3=function(){0===this.initRoom3Count&&(this.initRoom3Count=1,this.initRoom(3,3))},i.prototype.initRoom4=function(){0===this.initRoom4Count&&(this.initRoom4Count=1,this.initRoom(4,0))},i.prototype.initRoom42=function(){0===this.initRoom42Count&&(this.initRoom42Count=1,this.initRoom(4,1))},i.prototype.initRoom5=function(){0===this.initRoom5Count&&(this.initRoom5Count=1,this.initRoom(5,0))},i.prototype.initRoom6=function(){0===this.initRoom6Count&&(this.initRoom6Count=1,this.initRoom(6,3))},i.prototype.initRoom62=function(){0===this.initRoom62Count&&(this.initRoom62Count=1,this.initRoom(6,2))},i.prototype.initRoom7=function(){0===this.initRoom7Count&&(this.initRoom7Count=1,this.initRoom(7,1))},i.prototype.initRoom8=function(){0===this.initRoom8Count&&(this.initRoom8Count=1,this.initRoom(8,0))},i.prototype.initRoom9=function(){0===this.initRoom9Count&&(this.initRoom9Count=1,this.initRoom(9,3))},i.prototype.contactPoint1=function(){0===this.contactPoint1Count&&(this.contactPoint1Count=1,this.platformHero.move(this.platformSpeed,0),e.GameManager.instance.hero.setClickable(!1),e.GameManager.instance.hero.setEnableMotor(!1),e.GameManager.instance.hero.clearVelosityX(),this.rooms[0].closeDoor(),e.SoundManager.playSFX("s_lvl8_closeDoors"))},i.prototype.contactPoint2=function(){0===this.contactPoint2Count&&(this.contactPoint2Count=1,this.rooms[8].openDoor(1))},i.prototype.contactPoint3=function(){0===this.contactPoint3Count&&(this.contactPoint3Count=1)},i.prototype.contactPoint4=function(){0===this.contactPoint4Count&&(this.contactPoint4Count=1,this.rooms[this.insideRoom-1].hide(!0))},i.prototype.inRoom1=function(){0===this.inRoom1Count&&(this.inRoom1Count=1,this.inRoom(1))},i.prototype.inRoom2=function(){0===this.inRoom2Count&&(this.inRoom2Count=1,this.inRoom(2))},i.prototype.inRoom3=function(){0===this.inRoom3Count&&(this.inRoom3Count=1,this.inRoom(3))},i.prototype.inRoom4=function(){0===this.inRoom4Count&&(this.inRoom4Count=1,this.inRoom(4))},i.prototype.inRoom5=function(){0===this.inRoom5Count&&(this.inRoom5Count=1,this.inRoom(5))},i.prototype.inRoom6=function(){0===this.inRoom6Count&&(this.inRoom6Count=1,this.inRoom(6))},i.prototype.inRoom7=function(){0===this.inRoom7Count&&(this.inRoom7Count=1,this.inRoom(7))},i.prototype.inRoom8=function(){0===this.inRoom8Count&&(this.inRoom8Count=1,this.inRoom(8))},i.prototype.inRoom9=function(){0===this.inRoom9Count&&(this.inRoom9Count=1,this.inRoom(9))},i.prototype.free=function(){t.prototype.free.call(this)},i}(e.BasicLevel);e.Level9=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e){var i=t.call(this,e)||this;return i.timeShow=300,i.timeHide=400,i.activeUpdate=!1,i.counter=0,i.hideX=i.showX=i.x=400,i.hideY=i.y=850,i.showY=300,i}return __extends(i,t),i.prototype.initPanel=function(e,t,i,s,a,n,o,r,l){void 0===e&&(e=null),this.gear2=this.create(n,o,"ui","gear2 instance 10000"),this.gear2.anchor.setTo(.5),this.gear1=this.create(s,a,"ui","gear instance 10000"),this.gear1.anchor.setTo(.5),this.gear3=this.create(r,l,"ui","gear instance 10000"),this.gear3.anchor.setTo(.5),this.gear3.scale.x=-1,this.bg=this.create(t,i,"ui",e),this.bg.anchor.setTo(.5)},i.prototype.update=function(){!1!==this.activeUpdate&&(this.counter+=1,this.updateGears())},i.prototype.updateGears=function(){this.counter>0&&this.counter<=30?(this.gear1.angle-=1.5,this.gear2.angle-=2.6,this.gear3.angle+=1.5,this.paper&&(this.paper.y+=this.paperSpeed1)):this.counter>30&&this.counter<=40?(this.gear1.angle+=1.8,this.gear2.angle+=2.5,this.gear3.angle-=1.8,this.paper&&(this.paper.y-=this.paperSpeed2)):41===this.counter&&(this.activeUpdate=!1,this.showComplete())},i.prototype.over=function(){e.SoundManager.playSFX("btnOver")},i.prototype.show=function(){this.visible=!0,this.activeUpdate=!0,this.counter=0,this.gear1.angle=0,this.gear2.angle=0,this.gear3.angle=0,this.game.add.tween(this).to({y:this.showY},this.timeShow,Phaser.Easing.Linear.None,!0)},i.prototype.hide=function(){this.game.add.tween(this).to({y:this.hideY},this.timeHide,Phaser.Easing.Linear.None,!0).onComplete.addOnce(this.hideComplete,this)},i.prototype.hideME=function(t){e.PanelManager.getInstance(t).hidePanel(this.name)},i.prototype.hideFastME=function(t){e.PanelManager.getInstance(t).hideFastPanel(this.name)},i.prototype.hideFast=function(){this.y=this.hideY,this.hideComplete()},i.prototype.showComplete=function(){},i.prototype.hideComplete=function(){this.visible=!1},i.prototype.clickOnExit=function(){e.Main.instance.pausedByPanel=!1,e.LevelBuilder.instance.game.paused=!1,e.SoundManager.stopAllSFXLoop(),e.SoundManager.playSFX("btnClick"),e.LevelBuilder.instance.exitGame()},i.prototype.destroy=function(){t.prototype.destroy.call(this),this.bg=null,this.gear1=null,this.gear2=null,this.gear3=null,this.paper=null},i}(Phaser.Group);e.BasicPanel=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this,i)||this;a.name=s,a.initPanel("panelLose instance 10000",-25,50,-185,12,-167,120,135,75);var n;return(n=i.make.button(136,170,"ui",e.LevelBuilder.instance.restartGame,a,"btnBigRestart instance 10001","btnBigRestart instance 10000")).anchor.setTo(.5),a.addChild(n),n.onInputOver.add(a.over,a),(n=i.make.button(-182,5,"ui",a.showWalkthrough,a,"btnWalkthrough2 instance 10001","btnWalkthrough2 instance 10000")).anchor.setTo(.5),a.addChild(n),n.onInputOver.add(a.over,a),n=null,e.SoundManager.playSFX("levelFail"),a.paper=a.create(0,154,"ui","paperLose instance 10000"),a.paper.anchor.setTo(.5,1),a.paperSpeed1=11.6,a.paperSpeed2=1.7,a.createMask(-102,65),a}return __extends(i,t),i.prototype.createMask=function(e,t){var i=this.game.make.graphics(e,t);this.addChild(i),i.beginFill(16711680,.3),i.moveTo(0,0),i.lineTo(32,-80),i.lineTo(172,-80),i.lineTo(202,0),i.lineTo(170,77),i.lineTo(32,77),i.lineTo(0,0),i.endFill(),this.paper.mask=i,i=null},i.prototype.show=function(){t.prototype.show.call(this),this.paper.y=154},i.prototype.showWalkthrough=function(e,t,i){!0===i&&window.op3n(Constants.WALKTHROUGH_URL,"_blank")},i}(e.BasicPanel);e.Lose=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var PanelList;!function(e){e.Pause="Pause",e.Win="Win",e.Lose="Lose"}(PanelList||(PanelList={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e){var i=t.call(this,e,e.world,"PanelManager")||this;return i.timeShow=500,i.timeHide=500,i.black=null,i.game=e,i.game.world.addChild(i),i.stock={},i.fixedToCamera=!0,i}return __extends(i,t),i.getInstance=function(e){return i.instance||(i.instance=new i(e)),i.instance},i.prototype.init=function(){this.black=this.game.add.graphics(0,0,this),this.black.beginFill(0,1),this.black.drawRect(0,0,e.Variables.SW,e.Variables.SH),this.black.endFill(),this.black.alpha=0,this.black.inputEnabled=!0,this.addChild(this.black)},i.prototype.showPanel=function(t){if(null===this.black&&this.init(),void 0===this.stock[t]){var i=e.Tools.getInstance(t,this.game,t);this.stock[t]=this.add(i),i=null}this.game.world.bringToTop("PanelManager"),this.stock[t].show(),this.showBlack()},i.prototype.hidePanel=function(e,t){void 0===t&&(t=!1),void 0!==this.stock[e]&&(this.game.world.sendToBack("PanelManager"),this.stock[e].hide(),!1===t&&this.hideBlack())},i.prototype.hideFastPanel=function(e,t){void 0===t&&(t=!1),void 0!==this.stock[e]&&(this.stock[e].hideFast(),!1===t&&this.hideFastBlack())},i.prototype.showBlack=function(){this.visible=!0,this.game.add.tween(this.black).to({alpha:.7},this.timeShow,Phaser.Easing.Linear.None,!0)},i.prototype.hideBlack=function(){this.game.add.tween(this.black).to({alpha:0},this.timeHide,Phaser.Easing.Linear.None,!0).onComplete.addOnce(this.hideBlackComplete,this)},i.prototype.hideBlackComplete=function(){this.visible=!1},i.prototype.hideFastBlack=function(){this.black.alpha=0,this.hideBlackComplete()},i.prototype.destroy=function(){t.prototype.destroy.call(this),this.black=null,this.stock={},this.stock=null,this.game=null,i.instance=null},i}(Phaser.Group);e.PanelManager=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(e,i){var s=t.call(this,e)||this;return s.name=i,s.initPanel("panelPause instance 10000",-15,50,-180,-22,-175,90,105,20),s.btnExit=e.make.button(-139,146,"ui",s.clickOnExit,s,"btnBigExit instance 10000","btnBigExit instance 10000"),s.btnExit.anchor.setTo(.5),s.addChild(s.btnExit),s.btnExit.onInputOver.add(s.over,s),s.btnResume=e.make.button(110,146,"ui",s.clickOnClose,s,"btnBigClose2 instance 10000","btnBigClose2 instance 10000"),s.btnResume.anchor.setTo(.5),s.addChild(s.btnResume),s.btnResume.onInputOver.add(s.over,s),s.game.input.onDown.add(s.unpause,s),s.paper=s.create(-25,105,"ui","paperPause instance 10000"),s.paper.anchor.setTo(.5,1),s.paperSpeed1=16.7,s.paperSpeed2=1,s.createMask(-127,16),s}return __extends(i,t),i.prototype.createMask=function(e,t){var i=this.game.make.graphics(e,t);this.addChild(i),i.beginFill(16711680,.3),i.moveTo(0,0),i.lineTo(32,-80),i.lineTo(172,-80),i.lineTo(202,0),i.lineTo(170,77),i.lineTo(32,77),i.lineTo(0,0),i.endFill(),this.paper.mask=i,i=null},i.prototype.show=function(){t.prototype.show.call(this),this.paper.y=105},i.prototype.unpause=function(e){!0===this.game.paused&&(this.btnResume.getBounds().contains(this.game.input.x,this.game.input.y)&&this.clickOnClose(),this.btnExit.getBounds().contains(this.game.input.x,this.game.input.y)&&this.clickOnExit())},i.prototype.clickOnClose=function(){this.game.tweens.removeFrom(this),e.SoundManager.playSFX("btnClick"),this.hideFastME(this.game),e.LevelBuilder.instance.game.paused=!1,e.Main.instance.pausedByPanel=!1},i.prototype.showComplete=function(){t.prototype.showComplete.call(this),e.LevelBuilder.instance.game.paused=!0,e.Main.instance.pausedByPanel=!0},i.prototype.hideComplete=function(){t.prototype.hideComplete.call(this),e.LevelBuilder.instance.resumeGame()},i.prototype.destroy=function(){this.btnExit=null,this.btnResume=null,this.game.input.onDown.remove(this.unpause,this),t.prototype.destroy.call(this)},i}(e.BasicPanel);e.Pause=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(i,s){var a=t.call(this,i)||this;a.name=s,a.initPanel("panelWin instance 10000",-15,50,-180,-22,-175,90,105,20),a.star1=i.make.sprite(-70,61,"ui"),a.star1.animations.add("anim",Phaser.Animation.generateFrameNames("winStar instance 1",0,27,"",4),30),a.star1.animations.play("anim"),a.star1.animations.stop("anim"),a.star1.anchor.setTo(.5),a.addChild(a.star1),a.star2=i.make.sprite(-13,61,"ui"),a.star2.animations.add("anim",Phaser.Animation.generateFrameNames("winStar instance 1",0,27,"",4),30),a.star2.animations.play("anim"),a.star2.animations.stop("anim"),a.star2.anchor.setTo(.5),a.addChild(a.star2),a.star3=i.make.sprite(41,61,"ui"),a.star3.animations.add("anim",Phaser.Animation.generateFrameNames("winStar instance 1",0,27,"",4),30),a.star3.animations.play("anim"),a.star3.animations.stop("anim"),a.star3.anchor.setTo(.5),a.addChild(a.star3),a.wheel=i.make.sprite(-98,-16,"ui"),a.wheel.animations.add("anim",Phaser.Animation.generateFrameNames("winWheel instance 1",0,9,"",4),30),a.wheel.animations.play("anim"),a.wheel.animations.stop("anim"),a.wheel.anchor.setTo(.5),a.addChild(a.wheel),a.flag=i.make.sprite(-13,-16,"ui"),a.flag.animations.add("anim",Phaser.Animation.generateFrameNames("winFlag instance 1",0,9,"",4),30),a.flag.animations.play("anim"),a.flag.animations.stop("anim"),a.flag.anchor.setTo(.5),a.addChild(a.flag),a.car=i.make.sprite(64,-18,"ui"),a.car.animations.add("anim",Phaser.Animation.generateFrameNames("winCar instance 1",0,9,"",4),30),a.car.animations.play("anim"),a.car.animations.stop("anim"),a.car.anchor.setTo(.5),a.addChild(a.car);var n;return(n=i.make.button(117,146,"ui",a.showAd,a,"btnBigPlay instance 10001","btnBigPlay instance 10000")).anchor.setTo(.5),a.addChild(n),n.onInputOver.add(a.over,a),(n=i.make.button(-132,143,"ui",a.showWalkthrough,a,"btnWalkthrough2 instance 10001","btnWalkthrough2 instance 10000")).anchor.setTo(.5),a.addChild(n),n.onInputOver.add(a.over,a),n=null,e.DataManager.getInstance().saveData("questFlag"+e.LevelManager.getInstance().currentLevel,1),a}return __extends(i,t),i.prototype.showWalkthrough=function(e,t,i){!0===i&&window.op3n(Constants.WALKTHROUGH_URL,"_blank")},i.prototype.showAd=function(){var t=this;this.game.ads.onContentPaused.addOnce(function(){t.game.analytics.google.sendScreenView("advertisement")}),this.game.ads.onContentResumed.addOnce(function(){e.SoundManager.playSFX("btnClick"),e.LevelBuilder.instance.nextLevel(),t.game.ads.onContentResumed.removeAll(),t.game.ads.onContentPaused.removeAll()}),this.game.ads.showAd()},i.prototype.showComplete=function(){t.prototype.showComplete.call(this),this.star2.animations.play("anim"),this.flag.animations.play("anim"),!0===e.LevelBuilder.instance.panelQuest.wheelFounded&&(this.star1.animations.play("anim"),this.wheel.animations.play("anim")),!0===e.LevelBuilder.instance.panelQuest.carFounded&&(this.star3.animations.play("anim"),this.car.animations.play("anim"))},i.prototype.destroy=function(){t.prototype.destroy.call(this),this.star1=null,this.star2=null,this.star3=null,this.wheel=null,this.flag=null,this.car=null},i}(e.BasicPanel);e.Win=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Name,e}return __extends(i,t),i.prototype.init=function(){var e=this;this.stage.setBackgroundColor(0),this.game.analytics.game.setup(Constants.GAME_KEY,Constants.SECRET_KEY,version,this.game.analytics.game.createUser());var t=Date.now();window.addEventListener("beforeunload",function(){e.game.analytics.game.addEvent(new GA.Events.SessionEnd((Date.now()-t)/1e3)),e.game.analytics.game.sendEvents()}),this.game.analytics.google.setup(Constants.GOOGLE_ID,Constants.GOOGLE_APP_NAME,version),this.input.maxPointers=1,this.game.canvas.oncontextmenu=function(e){e.preventDefault()},this.game.ads.setAdProvider(new PhaserAds.AdProvider.GameDistributionAds(this.game,Constants.GAMEDISTRIBUTION_ID,Constants.GAMEDISTRIBUTION_USER))},i.prototype.preload=function(){this.game.load.cacheBuster="undefined"==typeof version?null:version,e.DataManager.getInstance(this.game).init(),e.LevelManager.getInstance(this.game).init(),this.game.analytics.google.sendScreenView(this.name)},i.prototype.create=function(){var t=this;Fabrique.LoaderHelper.hide(),this.game.state.start(Fabrique.SplashScreen.Preloader.Name,!0,!1,{nextState:e.Menu.Name,mobilePlayClickhandler:function(){Fabrique.LoaderHelper.show(),t.game.ads.onContentPaused.addOnce(function(){Fabrique.LoaderHelper.hide(),t.game.analytics.google.sendScreenView("advertisement")}),t.game.ads.onContentResumed.addOnce(function(){Fabrique.LoaderHelper.hide(),t.game.state.start(SceneList.Menu),t.game.ads.onContentResumed.removeAll(),t.game.ads.onContentPaused.removeAll()}),t.game.ads.showAd()},preloadHandler:function(){t.game.stage.disableVisibilityChange=!1,t.game.load.bitmapFont("mainFont","assets/fonts/mainFont.png","assets/fonts/mainFont.fnt"),t.game.load.bitmapFont("numbers","assets/fonts/numbers.png","assets/fonts/numbers.fnt"),t.game.load.bitmapFont("walkthrough","assets/fonts/walkthrough.png","assets/fonts/walkthrough.fnt");Constants.GAME_SCALE;Images.list.forEach(function(e){t.game.load.image(e,"assets/images/"+e+".png")}),Atlases.list.forEach(function(e){t.game.load.atlas(e,"assets/atlases/"+e+".png","assets/atlases/"+e+".json")}),Sounds.list.forEach(function(e){t.game.device.iOS?t.game.load.audio(e,["assets/sound/"+e+".m4a"]):t.game.load.audio(e,["assets/sound/"+e+".ogg","assets/sound/"+e+".mp3"])}),Fabrique.Branding.preloadImages(t.game)}})},i.Name="boot",i}(Phaser.State);e.Boot=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Name,e.active1=!1,e.counter1=0,e.active2=!1,e.counter2=0,e.active3=!1,e.counter3=0,e.active4=!1,e.counter4=0,e}return __extends(i,t),i.prototype.create=function(){this.game.analytics.google.sendScreenView(SceneList.Comix1),e.SoundManager.playSFX("sfx_filmStart");var t=this.add.graphics(0,0);t.beginFill(16763513),t.drawRect(0,0,Constants.GAME_WIDTH,Constants.GAME_HEIGHT),t.endFill(),t=null,this.createComix1(),this.createComix2(),this.createComix3(),this.btnNext=this.add.button(380,620,"comix1",this.next,this,"btnNext instance 10001","btnNext instance 10000"),this.btnNext.anchor.setTo(.5),this.btnNext.scale.setTo(.78),this.btnNext.inputEnabled=!1,this.btnNext.alpha=0,this.active1=!0,this.counter1=this.counter2=this.counter3=this.counter4=0,this.active2=this.active3=this.active4=!1},i.prototype.createComix1=function(){this.group1=this.add.group(),this.group1.x=400,this.group1.y=138,this.clouds=new Array;var e=this.group1.create(0,0,"comix1","comix1 instance 10000");e.anchor.setTo(.5),e=this.group1.create(-300,-125,"comix1","cloud1 instance 10000"),this.clouds.push(e),e=this.group1.create(-250,-95,"comix1","cloud2 instance 10000"),this.clouds.push(e),e=this.group1.create(-5,-125,"comix1","cloud3 instance 10000"),this.clouds.push(e),e=this.group1.create(-3,-70,"comix1","cloud4 instance 10000"),this.clouds.push(e),e=this.group1.create(35,-100,"comix1","cloud5 instance 10000"),this.clouds.push(e),e=this.group1.create(120,-130,"comix1","cloud6 instance 10000"),this.clouds.push(e),e=null,this.fill1=this.make.graphics(0,0),this.fill1.beginFill(16763513,1),this.fill1.drawRect(-385,-145,770,290),this.fill1.endFill(),this.group1.add(this.fill1)},i.prototype.createComix2=function(){this.group2=this.add.group(),this.group2.x=198,this.group2.y=447;var e=this.group2.create(0,0,"comix1","comix2 instance 10000");e.anchor.setTo(.5);var t=this.group2.create(0,0,"comix1","comix2 instance 10000");t.anchor.setTo(.5),this.scepterCar=this.make.sprite(64,-20,"comix1","scepterCar instance 10000"),this.scepterCar.anchor.setTo(.5),t.addChild(this.scepterCar),(e=this.make.sprite(64,-22,"comix1","scepter2 instance 10000")).anchor.setTo(.5),t.addChild(e),t.addChild(this.make.sprite(17,-20,"comix1","scepter1 instance 10000")),this.pinkSmoke=this.make.sprite(-6,63,"comix1","pinkSmoke instance 10000"),this.pinkSmoke.anchor.setTo(.5),t.addChild(this.pinkSmoke),this.pinkSmokeShine=this.game.make.sprite(0,-20,"comix1","pinkSmokeShine instance 10000"),this.pinkSmokeShine.anchor.setTo(.5),this.pinkSmokeShine.alpha=0,this.pinkSmoke.addChild(this.pinkSmokeShine),this.fill2=this.make.graphics(0,0),this.fill2.beginFill(16763513,1),this.fill2.drawRect(-202,-140,404,280),this.fill2.endFill(),this.group2.add(this.fill2);var i=this.make.graphics(0,0);(i=this.make.graphics(0,0)).beginFill(0,.9),i.moveTo(-187,126),i.bezierCurveTo(-195,80,-198,-90,-187,-129),i.lineTo(193,-129),i.bezierCurveTo(175,-40,163,40,132,126),i.bezierCurveTo(125,133,-170,135,-187,126),i.endFill(),this.group2.add(i),t.mask=i,i=null,e=null,t=null},i.prototype.createComix3=function(){this.group3=this.add.group(),this.group3.x=600,this.group3.y=447,this.bg3=this.group3.create(12,0,"comix1","comix3Bg instance 10000"),this.bg3.anchor.setTo(.5);var e=this.group3.create(0,0,"comix1","comix3 instance 10000");e.anchor.setTo(.5),this.jellyCar=this.group3.create(-45,-30,"comix1","jellycar instance 10000"),this.jellyCar.anchor.setTo(.5),this.jellyCar.angle=30,(e=this.make.sprite(0,0,"comix1")).anchor.setTo(.5),e.animations.add("anim",Phaser.Animation.generateFrameNames("jelly instance 1",0,9,"",4),20,!0),e.animations.play("anim"),this.jellyCar.addChild(e),this.stakanInside=this.group3.create(-37,-9,"comix1","stakanIn instance 10000"),this.stakan=this.group3.create(-50,22,"comix1","stakan instance 10000"),this.group3.create(-175,18,"comix1","chair instance 10000"),this.glasses1=this.group3.create(-70,-30,"comix1","glasses1 instance 10000"),this.glasses2=this.group3.create(28,-15,"comix1","glasses2 instance 10000"),this.fill3=this.make.graphics(0,0),this.fill3.beginFill(16763513,1),this.fill3.moveTo(202,-140),this.fill3.lineTo(202,140),this.fill3.lineTo(-210,140),this.fill3.lineTo(-155,-140),this.fill3.endFill(),this.group3.add(this.fill3);var t=this.make.graphics(0,0);(t=this.make.graphics(0,0)).beginFill(0,.5),t.moveTo(196,-134),t.lineTo(196,134),t.lineTo(-200,134),t.lineTo(-146,-134),t.endFill(),this.group3.add(t),this.bg3.mask=t,t=null,e=null},i.prototype.update=function(){if(!0===this.active1)if(this.counter1+=1,this.counter1>20&&this.counter1<=80){this.counter1<=51?(this.group1.y+=.6,this.fill1.alpha-=.033,this.fill1.alpha<0&&(this.fill1.alpha=0)):61===this.counter1&&(this.active2=!0,this.counter2=0,e.SoundManager.playSFX("sfx_spell"));for(var t=0;t<this.clouds.length;t++)this.clouds[t].x+=.3}else 81===this.counter1&&(this.active1=!1);!0===this.active2&&(this.counter2+=1,this.counter2>0&&this.counter2<=50?(this.counter2<=31?(this.group2.x+=.6,this.fill2.alpha-=.033,this.fill2.alpha<0&&(this.fill2.alpha=0)):41===this.counter2&&(this.active3=!0,this.counter3=0,e.SoundManager.playSFX("sfx_wheelyMagic")),this.scepterCar.rotation-=.007,this.pinkSmoke.scale.x+=.0015,this.pinkSmoke.scale.y=this.pinkSmoke.scale.x,this.counter2>=52&&this.counter2<=76&&(this.pinkSmokeShine.alpha+=.04,this.pinkSmokeShine.alpha>1&&(this.pinkSmokeShine.alpha=1))):51===this.counter2&&(this.active2=!1)),!0===this.active3&&(this.counter3+=1,this.counter3>0&&this.counter3<=60?(this.counter3<=31?(this.group3.x-=.6,this.fill3.alpha-=.033,this.fill3.alpha<0&&(this.fill3.alpha=0)):41===this.counter3&&(this.active4=!0,this.counter4=0),this.bg3.x-=.39,this.jellyCar.x+=.3,this.jellyCar.y-=.5,this.jellyCar.angle-=.6,this.jellyCar.scale.x-=.0035,this.jellyCar.scale.y=this.jellyCar.scale.x,this.glasses1.angle-=.4,this.glasses1.x-=.2,this.glasses2.angle+=.5,this.glasses2.x+=.45,this.glasses2.y-=.75,this.stakan.x+=.12,this.stakan.y-=.25,this.stakan.angle+=.2,this.stakanInside.x+=.3,this.stakanInside.y-=.35,this.stakanInside.angle+=.2):61===this.counter3&&(this.active3=!1)),!0===this.active4&&(this.counter4+=1,this.counter4>0&&this.counter4<=10?(this.btnNext.scale.x+=.027,this.btnNext.scale.y=this.btnNext.scale.x,this.btnNext.alpha+=.1,this.btnNext.y-=5.5):this.counter4>10&&this.counter4<=18?(this.btnNext.scale.x-=.008,this.btnNext.scale.y=this.btnNext.scale.x,this.btnNext.y+=1):19===this.counter4&&(this.active4=!1,this.btnNext.inputEnabled=!0,this.btnNext.input.useHandCursor=!0))},i.prototype.next=function(){e.LevelManager.getInstance().currentLevel=2,this.game.state.start(SceneList.LevelBuilder,!0,!1)},i.prototype.shutdown=function(){this.group1=null,this.fill1=null,this.clouds=[],this.clouds=null,this.group2=null,this.fill2=null,this.scepterCar=null,this.pinkSmoke=null,this.pinkSmokeShine=null,this.group3=null,this.fill3=null,this.bg3=null,this.stakan=null,this.stakanInside=null,this.glasses1=null,this.glasses2=null,this.jellyCar=null,this.btnNext=null},i.Name="Comix1",i}(Phaser.State);e.Comix1=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var i=null!==t&&t.apply(this,arguments)||this;return i.name=e.Comix1.Name,i.active1=!0,i.counter1=0,i.active2=!1,i.counter2=0,i.active4=!1,i.counter4=0,i}return __extends(i,t),i.prototype.create=function(){this.game.analytics.google.sendScreenView(SceneList.Comix2);var e=this.add.graphics(0,0);e.beginFill(16763513),e.drawRect(0,0,Constants.GAME_WIDTH,Constants.GAME_HEIGHT),e.endFill(),e=null,this.createComix1(),this.createComix2(),this.group3=this.add.graphics(0,0),this.group3.beginFill(0,1),this.group3.drawRect(0,0,Constants.GAME_WIDTH,Constants.GAME_HEIGHT),this.group3.endFill(),this.group3.alpha=0,this.btnNext=this.add.button(550,620,"comix2",this.next,this,"btnNext instance 10001","btnNext instance 10000"),this.btnNext.anchor.setTo(.5),this.btnNext.scale.setTo(.78),this.btnNext.inputEnabled=!1,this.btnNext.alpha=0},i.prototype.createComix1=function(){this.group1=this.add.sprite(400,15,"comix2","part1 instance 10000"),this.group1.anchor.x=.5;var e=this.make.group();this.group1.addChild(e);var t=this.make.graphics(0,0);t.beginFill(65280,.5),t.moveTo(-335,17),t.bezierCurveTo(-200,7,200,7,337,17),t.bezierCurveTo(342,50,342,200,337,218),t.bezierCurveTo(200,240,-300,300,-335,297),t.bezierCurveTo(-343,300,-343,50,-335,17),e.addChild(t),e.mask=t,this.orangeCar=e.create(305,270,"comix2","carOrange instance 10000"),this.orangeCar.anchor.setTo(1),this.orangeCar.addChild(this.make.sprite(-215,-257,"comix2","orangeEye1 instance 10000")),this.glass=e.create(338,280,"comix2","glass instance 10000"),this.glass.anchor.setTo(1),this.redCar=e.create(-190,134,"comix2","carRed instance 10000"),this.redCar.anchor.setTo(.5),this.redCar.addChild(this.make.sprite(60,-80,"comix2","carRedEye1 instance 10000")),this.redCarWheel1=this.make.sprite(-106,100,"comix2","redWheel instance 10000"),this.redCarWheel1.anchor.setTo(.5),this.redCar.addChild(this.redCarWheel1),this.redCarWheel2=this.make.sprite(95,100,"comix2","redWheel instance 10000"),this.redCarWheel2.anchor.setTo(.5),this.redCar.addChild(this.redCarWheel2),this.redCarBrown1=this.make.sprite(50,-100,"comix2","redCarBrown1 instance 10000"),this.redCar.addChild(this.redCarBrown1),this.redCarBrown2=this.make.sprite(110,-97,"comix2","redCarBrown2 instance 10000"),this.redCarBrown2.anchor.x=1,this.redCar.addChild(this.redCarBrown2),this.heart=e.create(20,90,"comix2","heart instance 10000"),this.heart.anchor.setTo(.5),this.heart.angle=22,this.heart.alpha=0,this.heart.scale.setTo(.5),e=null,t=null},i.prototype.createComix2=function(){this.group2=this.add.sprite(400,311,"comix2","part2 instance 10000"),this.group2.anchor.x=.5,this.group2.alpha=0,this.pinkEyes=this.make.sprite(-265,83,"comix2","pinkEyes instance 10000"),this.pinkEyes.animations.add("anim",Phaser.Animation.generateFrameNames("pinkEyes instance 1",0,47,"",4),30,!1),this.group2.addChild(this.pinkEyes),this.redEyes=this.make.sprite(-70,64,"comix2","redEyes instance 10000"),this.redEyes.animations.add("anim",Phaser.Animation.generateFrameNames("redEyes instance 1",0,21,"",4),30,!1),this.group2.addChild(this.redEyes),this.orangeEyes=this.make.sprite(152,71,"comix2","orangeEyes instance 10000"),this.orangeEyes.animations.add("anim",Phaser.Animation.generateFrameNames("orangeEyes instance 1",0,43,"",4),30,!1),this.group2.addChild(this.orangeEyes),this.think=this.make.sprite(-150,130,"comix2","think instance 10000"),this.think.animations.add("anim",Phaser.Animation.generateFrameNames("think instance 1",0,20,"",4),30,!1),this.think.anchor.y=1,this.think.scale.setTo(0),this.group2.addChild(this.think)},i.prototype.showCredits=function(){null==this.btnLogo&&(this.btnLogo=this.add.button(20,500,"kiziLogo",this.goLogo,this),this.btnLogo.input.useHandCursor=!1,this.credits=this.add.sprite(200,20,"credits"))},i.prototype.goLogo=function(){e.Utils.openCampaignLink(this.game,"wheely-5","logo")},i.prototype.update=function(){!0===this.active1&&(this.counter1+=1,this.counter1>1&&this.counter1<60&&(this.redCar.x+=.9,this.redCarWheel1.angle+=1,this.redCarWheel2.angle+=1,this.redCarBrown1.angle-=.13,this.redCarBrown2.angle+=.46,this.redCarBrown1.y-=.15,this.redCarBrown2.y-=.15,this.counter1>=20&&this.counter1<=30?(this.heart.angle-=.4,this.heart.alpha+=.1,this.heart.alpha>1&&(this.heart.alpha=1),this.heart.scale.x+=.04,this.heart.scale.y=this.heart.scale.x,this.heart.y-=1):this.counter1>30&&(this.heart.angle-=.4,this.heart.scale.x+=.01,this.heart.scale.y=this.heart.scale.x,this.heart.y-=1),this.counter1>29&&(this.orangeCar.angle+=.1),this.counter1>35&&(this.glass.angle+=.28),47===this.counter1&&(this.active2=!0))),!0===this.active2&&(10===this.counter2&&(this.pinkEyes.animations.play("anim"),this.redEyes.animations.play("anim"),this.orangeEyes.animations.play("anim")),this.counter2+=1,this.counter2>=1&&this.counter2<=21?(this.group2.alpha+=.05,this.group2.alpha>1&&(this.group2.alpha=1),this.group2.y-=1.8):this.counter2>=38&&this.counter2<=58?(this.think.scale.x+=.065,this.think.scale.y=this.think.scale.x):59===this.counter2?this.think.animations.play("anim"):this.counter2>=150&&this.counter2<=157?this.group3.alpha+=.1:158===this.counter2&&(this.active4=!0,this.showCredits())),!0===this.active4&&(this.counter4+=1,this.counter4>0&&this.counter4<=10?(this.btnNext.scale.x+=.027,this.btnNext.scale.y=this.btnNext.scale.x,this.btnNext.alpha+=.1,this.btnNext.y-=5.5):this.counter4>10&&this.counter4<=18?(this.btnNext.scale.x-=.008,this.btnNext.scale.y=this.btnNext.scale.x,this.btnNext.y+=1):19===this.counter4&&(this.active4=!1,this.btnNext.inputEnabled=!0,this.btnNext.input.useHandCursor=!0))},i.prototype.next=function(){e.LevelManager.getInstance().currentMenuScreen=1,this.game.state.start(SceneList.Menu,!0,!1)},i.prototype.shutdown=function(){this.btnNext=null,this.group1=null,this.orangeCar=null,this.glass=null,this.redCar=null,this.redCarWheel1=null,this.redCarWheel2=null,this.redCarBrown1=null,this.redCarBrown2=null,this.heart=null,this.group2=null,this.think=null,this.pinkEyes=null,this.redEyes=null,this.orangeEyes=null,this.group3=null,this.btnLogo=null,this.credits=null},i.Name="Comix2",i}(Phaser.State);e.Comix2=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function t(t,i,s){this.carFounded=!1,this.wheelFounded=!1,this.game=t,this.panelQuest=t.make.sprite(740,30,"ui","panel_quest instance 10000"),this.panelQuest.fixedToCamera=!0,this.panelQuest.anchor.setTo(.5),e.LevelBuilder.instance.UILayer.addChild(this.panelQuest),!0===e.GameManager.instance.level.questCarFounded&&(this.car=this.game.make.sprite(19,0,"ui","winCar instance 10009"),this.car.scale.setTo(.55),this.car.anchor.setTo(.5),this.panelQuest.addChild(this.car),this.carFounded=!0),!0===e.GameManager.instance.level.questWheelFounded&&(this.wheel=this.game.make.sprite(-23,2,"ui","winWheel instance 10009"),this.wheel.scale.setTo(.52),this.wheel.anchor.setTo(.5),this.panelQuest.addChild(this.wheel),this.wheelFounded=!0)}return t.prototype.foundCar=function(){!0!==this.carFounded&&(this.carFounded=!0,this.car=this.game.make.sprite(19,0,"ui"),this.car.animations.add("anim",Phaser.Animation.generateFrameNames("winCar instance 1",0,14,"",4),30).onComplete.addOnce(this.carShowComplete,this),this.car.animations.play("anim"),this.car.scale.setTo(.55),this.car.anchor.setTo(.5),this.panelQuest.addChild(this.car),e.SoundManager.playSFX("questClick"),e.DataManager.getInstance().saveData("questCar"+e.LevelManager.getInstance().currentLevel,1))},t.prototype.carShowComplete=function(){this.game.add.tween(this.car.scale).to({x:.63,y:.63},200,Phaser.Easing.Linear.None,!0,0,2,!0)},t.prototype.foundWheel=function(){!0!==this.wheelFounded&&(this.wheelFounded=!0,this.wheel=this.game.make.sprite(-23,2,"ui"),this.wheel.animations.add("anim",Phaser.Animation.generateFrameNames("winWheel instance 1",0,14,"",4),30).onComplete.addOnce(this.wheelShowComplete,this),this.wheel.animations.play("anim"),this.wheel.scale.setTo(.52),this.wheel.anchor.setTo(.5),this.panelQuest.addChild(this.wheel),e.SoundManager.playSFX("questClick"),e.DataManager.getInstance().saveData("questWheel"+e.LevelManager.getInstance().currentLevel,1))},t.prototype.wheelShowComplete=function(){this.game.add.tween(this.wheel.scale).to({x:.6,y:.6},200,Phaser.Easing.Linear.None,!0,0,2,!0)},t.prototype.free=function(){this.game=null,this.panelQuest=null,this.car=null,this.wheel=null},t}();e.PanelQuest=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.name=i.Name,e.active=!0,e.onePanelAlreadyShowed=!1,e}return __extends(i,t),i.prototype.init=function(){if(null!=i.instance)throw new Error("Error: LevelBuilder already created");i.instance=this,this.onePanelAlreadyShowed=!1,this.active=!0,e.SoundManager.playMusic("main_"+this.game.rnd.between(1,3)),this.game.analytics.google.sendScreenView(SceneList.LevelBuilder)},i.prototype.create=function(){this.game.analytics.game.addEvent(new GA.Events.Progression("Start:Level:"+e.LevelManager.getInstance().currentLevel)),this.gameManager=new e.GameManager,this.UILayer=this.add.group(),this.btnPause=this.make.button(767,569,"ui",this.paused,this,"btnPause instance 10001","btnPause instance 10000","btnPause instance 10002"),this.btnPause.anchor.setTo(.5),this.btnPause.forceOut=!0,this.btnPause.fixedToCamera=!0,this.btnPause.onInputOver.add(this.over,this),this.UILayer.addChild(this.btnPause);var t;(t=new e.ButtonSound(e.SoundType.Music,715,569,"ui",null,null)).fixedToCamera=!0,this.UILayer.addChild(t),(t=new e.ButtonSound(e.SoundType.SFX,663,569,"ui",null,null)).fixedToCamera=!0,this.UILayer.addChild(t),t=null;var i=this.make.button(611,569,"ui",this.restartGame,this,"btnRestart instance 10001","btnRestart instance 10000","btnRestart instance 10002");i.anchor.setTo(.5),i.fixedToCamera=!0,i.onInputOver.add(this.over,this),this.UILayer.addChild(i);var s=new e.ButtonWalkthrough(this.game,400,30);s.fixedToCamera=!0,this.UILayer.addChild(s);var a=this.make.bitmapText(20,25,"mainFont","Level "+e.LevelManager.getInstance().currentLevel,26);a.anchor.setTo(0,.5),a.fixedToCamera=!0,this.UILayer.addChild(a),i=null,s=null,a=null,this.panelQuest=new e.PanelQuest(this.game,740,30)},i.prototype.hideUI=function(){this.UILayer.visible=!1},i.prototype.over=function(){e.SoundManager.playSFX("btnOver")},i.prototype.update=function(){this.gameManager.update()},i.prototype.paused=function(){!1!==this.active&&!0!==this.onePanelAlreadyShowed&&!0!==e.Main.disablePause&&(e.SoundManager.playSFX("btnClick"),this.btnPause.inputEnabled=!1,this.pauseGame(),this.onePanelAlreadyShowed=!0,e.PanelManager.getInstance(this.game).showPanel(PanelList.Pause))},i.prototype.pauseGame=function(e){void 0===e&&(e=!0),this.active=!1},i.prototype.levelComplete=function(){!0!==this.onePanelAlreadyShowed&&(this.pauseGame(!1),this.stopAllSounds(),e.DataManager.getInstance().saveData("pl",e.LevelManager.getInstance().currentLevel),e.DataManager.getInstance().saveLevel(e.LevelManager.getInstance().currentLevel+1),this.game.analytics.game.addEvent(new GA.Events.Progression("Complete:Level:"+e.LevelManager.getInstance().currentLevel)),this.onePanelAlreadyShowed=!0,e.PanelManager.getInstance(this.game).showPanel(PanelList.Win))},i.prototype.levelFailed=function(){!0!==this.onePanelAlreadyShowed&&(this.pauseGame(),this.stopAllSounds(),this.game.analytics.game.addEvent(new GA.Events.Progression("Fail:Level:"+e.LevelManager.getInstance().currentLevel)),this.onePanelAlreadyShowed=!0,e.PanelManager.getInstance(this.game).showPanel(PanelList.Lose))},i.prototype.stopAllSounds=function(){e.SoundManager.stopMusic(),e.SoundManager.stopAllSFXLoop()},i.prototype.resumeGame=function(){this.onePanelAlreadyShowed=!1,this.btnPause.inputEnabled=!0,this.btnPause.input.useHandCursor=!0,this.active=!0},i.prototype.restartGame=function(){e.SoundManager.playSFX("btnClick"),this.game.state.start(SceneList.LevelBuilder,!0,!1)},i.prototype.exitGame=function(){e.LevelManager.getInstance().currentMenuScreen=1,e.DataManager.getInstance().saveData("insideRoom",0),e.NativeChanges.setGraphicsChildrensMask(this.game,!0),this.game.state.start(SceneList.Menu,!0,!1)},i.prototype.nextLevel=function(){e.NativeChanges.setGraphicsChildrensMask(this.game,!0),e.LevelManager.getInstance().currentLevel+=1,e.DataManager.getInstance().saveData("insideRoom",0),2===e.LevelManager.getInstance().currentLevel?this.game.state.start(SceneList.Comix1,!0,!1):17===e.LevelManager.getInstance().currentLevel?(e.LevelManager.getInstance().currentMenuScreen=1,this.game.state.start(SceneList.Menu,!0,!1)):this.game.state.start(SceneList.LevelBuilder,!0,!1)},i.prototype.shutdown=function(){this.game.world.resize(e.Variables.SW,e.Variables.SH),i.instance=null,this.gameManager.free(),this.gameManager=null,this.btnPause=null,this.panelQuest.free(),this.panelQuest=null,this.UILayer=null},i.Name="LevelBuilder",i}(Phaser.State);e.LevelBuilder=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(t){function i(){var e=null!==t&&t.apply(this,arguments)||this;return e.openLevels=0,e}return __extends(i,t),i.prototype.init=function(){this.physics.startSystem(Phaser.Physics.BOX2D),this.physics.box2d.gravity.y=500,this.physics.box2d.debugDraw.joints=!0,this.openLevels=e.DataManager.getInstance().currentLevel,!1===e.Main.instance.soundStarted&&(e.SoundManager.init(this.game),e.Main.instance.soundStarted=!0,e.DataManager.getInstance().saveData("insideRoom",0)),e.SoundManager.playMusic("main_"+this.game.rnd.between(1,3)),this.game.analytics.google.sendScreenView(SceneList.Menu)},i.prototype.create=function(){this.add.sprite(0,0,"menuBg"),this.createMeinMenu(),this.createLevelSelect(),this.showScreen(e.LevelManager.getInstance().currentMenuScreen);var t;t=new e.ButtonSound(e.SoundType.Music,765,35,"ui",null,null),this.add.existing(t),t=new e.ButtonSound(e.SoundType.SFX,705,35,"ui",null,null),this.add.existing(t),t=null},i.prototype.showScreen=function(e){0===e?this.showMainMenu():this.showLS()},i.prototype.createMeinMenu=function(){var e=this;this.groupMM=new Phaser.Group(this.game),this.groupMM.create(125,18,"ui","logo instance 10000"),this.btnPlay=this.make.button(400,650,"ui",this.up,this,"btnMenuPlay instance 10001","btnMenuPlay instance 10000"),this.btnPlay.name="play",this.btnPlay.anchor.setTo(.5),this.btnPlay.forceOut=!0,this.btnPlay.onInputDown.add(this.down,this.btnPlay),this.groupMM.addChild(this.btnPlay),this.btnPlay.onInputOver.add(this.btnPlayOver,this),this.btnPlay.onInputOut.add(this.btnPlayOut,this),this.textPlay=this.game.make.bitmapText(0,2,"mainFont","Play",40),this.textPlay.anchor.setTo(.5),this.btnPlay.addChild(this.textPlay),this.btnLogo=this.make.button(25,500,"kiziLogo",function(){e.goLogo(e.game)},this),this.btnLogo.input.useHandCursor=!1,this.groupMM.addChild(this.btnLogo)},i.prototype.goLogo=function(t){e.Utils.openCampaignLink(this.game,"wheely-4","logo")},i.prototype.btnPlayOver=function(){e.SoundManager.playSFX("btnOver"),this.textPlay.scale.set(1.1,1.1)},i.prototype.btnPlayOut=function(){this.textPlay.scale.set(1,1)},i.prototype.createLevelSelect=function(){var t,i=0,s=0;this.groupLS=new Phaser.Group(this.game);for(var a=0;a<4;a++)for(var n=0;n<4&&(++i<=this.openLevels?s+=(t=new e.LevelSelectButton(i,this.game,275+90*n,120+90*a,"ui",this.up,this,null,"btnLevel instance 10000")).addStars():(t=new e.LevelSelectButton(i,this.game,275+90*n,120+90*a,"ui",null,null,null,"btnLevel instance 10001")).addLock(),this.groupLS.add(t),3!==a||1!==n);n++);t=null;var o=this.make.button(500,408,"ui",this.up,this,"btnBigClose instance 10001","btnBigClose instance 10000","btnBigClose instance 10002");o.name="exit",o.anchor.set(.5,.5),o.onInputDown.add(this.down,o),o.onInputOver.add(this.over,this),this.groupLS.addChild(o),this.groupLS.create(10,10,"ui","star instance 10000"),this.groupLS.add(this.game.make.bitmapText(60,10,"numbers",s+"/42",40))},i.prototype.over=function(){e.SoundManager.playSFX("btnOver")},i.prototype.up=function(t){t.scale.setTo(1),e.SoundManager.playSFX("btnClick"),"exit"===t.name?this.showMainMenu():"play"===t.name?(this.btnPlay.input.enabled=!1,this.add.tween(this.btnPlay).to({y:650},300,Phaser.Easing.Linear.None,!0).onComplete.addOnce(this.playPressed,this)):(e.LevelManager.getInstance().currentLevel=Number(t.name),this.game.state.start(SceneList.LevelBuilder,!0,!1))},i.prototype.playPressed=function(){0===e.DataManager.getInstance().saveObj.pl?(e.DataManager.getInstance().saveData("pl",1),e.DataManager.getInstance().saveData("lvl",1),e.LevelManager.getInstance().currentLevel=1,this.game.state.start(SceneList.LevelBuilder,!0,!1)):(this.showLS(),this.btnPlayOut())},i.prototype.down=function(e){e.scale.setTo(.9)},i.prototype.showMainMenu=function(){this.groupMM.visible=!0,this.groupLS.visible=!1,this.btnPlay.y=650,this.add.tween(this.btnPlay).to({y:350},2e3,Phaser.Easing.Elastic.Out,!0),this.btnPlay.input.enabled=!0},i.prototype.showLS=function(){this.groupMM.visible=!1,this.groupLS.visible=!0},i.prototype.shutdown=function(){this.btnPlay=null,this.btnLogo=null,this.groupLS=null,this.groupMM=null,this.textPlay=null},i.Name="Menu",i}(Phaser.State);e.Menu=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));var Wheely;!function(e){!function(e){var t=function(){function e(){}return e.openCampaignLink=function(e,t,i){if(Fabrique.Utils.isOnDevice(e)||Fabrique.Branding.isContracted(e)||Fabrique.Branding.isSpecial(e))return null;var s=Fabrique.Utils.getSourceSite(),a=i;return window.op3n("http://kizi.com/?utm_source="+s+"&utm_medium=html5&utm_term="+t+"&utm_content="+a+"&utm_campaign=sponsored_games","_blank")},e}();e.Utils=t}(e.Client||(e.Client={}))}(Wheely||(Wheely={}));